Title:
LibTP_Gadget (Crystal Palace library for proxying Nt API calls via Threadpool using call gadgets)

Type:
GitHub Tool

Short Summary (4–8 sentences max):
LibTP_Gadget is a Crystal Palace shared library that proxies Windows APIs—primarily NTAPI calls—through the Windows Threadpool, updated to use a user-supplied `call` gadget for callstack/signature evasion. It generalizes prior work (LibTPLoadLib) to support proxying functions with up to 11 arguments, enabling broader API coverage beyond simple stubs. The project is designed to be drop-in compatible with rasta-mouse’s LibTP via spec files, making it easier to swap proxy backends in Crystal Palace builds. It explicitly requires the operator to locate and patch in a suitable call gadget from a target-available module, including ensuring a sufficiently large stack frame (e.g., `add rsp >= 0x68`). A key limitation is that return values from proxied functions cannot be retrieved, making NTAPI proxying more practical since only `NTSTATUS` is lost. This is mainly useful for red team operators and offensive tool developers building PIC/shellcode with Crystal Palace who want to alter call stacks and reduce EDR callstack-based detections.

Technical Focus:
- Windows Threadpool-based execution/proxying
- NTAPI call proxying (NtOpenProcess, NtAllocateVirtualMemory, NtWriteVirtualMemory, etc.)
- Call-gadget discovery and stack-frame constraints (x64 calling convention/stack args)
- Crystal Palace linking/spec files and aspect-style hooks (attach/optout)
- Position-independent code (COFF → PIC shellcode) build pipeline

Use Cases:
- Building PIC shellcode that performs process injection via proxied NTAPI calls
- Evading callstack/signature-based detections by routing execution through threadpool + gadget
- Swapping LibTP-style proxy specs to a gadget-based proxy implementation in Crystal Palace
- Researching/experimenting with call-gadget constraints and stack manipulation in x64

Keywords:
Crystal Palace, Tradecraft Garden, LibTP, Threadpool, NTAPI, NTDLL, call gadget, ROP gadget, x64 calling convention, stack frame, NtOpenProcess, NtAllocateVirtualMemory, NtWriteVirtualMemory, NtProtectVirtualMemory, NtCreateThreadEx, PIC shellcode, COFF, spec file, EDR evasion, callstack signatures