Title:
Modular PIC C2 Agents (with Crystal Palace PICOs)

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post explores building post-exploitation C2 agents as multiple independent Position-Independent Code Objects (PICOs) instead of a single monolithic reflective DLL/PIC blob.  
- It argues PICOs provide more flexible and less predictable in-memory layouts (e.g., code and data in separate regions; multiple modules scattered across memory), potentially challenging common detection assumptions.  
- The author demonstrates a Crystal Palace reflective loader that locates embedded PICOs, allocates separate code/data regions, loads them, and executes their entry points.  
- It shows inter-PICO composition by patching a function pointer to one PICO’s entry point into another PICO via Crystal Palace’s import/patch mechanism.  
- It also demonstrates link-time data patching (e.g., configuration strings) into a PICO using spec files and `piclink`, enabling modular swapping of comms/evasion components.  
- Useful for red team toolsmiths/malware developers designing modular in-memory agents, and for defenders modeling new memory-resident architectures.

Technical Focus:
- Crystal Palace PICOs (COFF-based position-independent modules)
- Reflective loading of PICOs with split code/data mappings
- Spec files and `piclink` linking workflow (embed/link/export)
- Import-based function pointer patching between PICOs
- Link-time data patching into PICO globals (configuration injection)
- EAT-walking API resolution via hashed exports

Use Cases:
- Build modular C2 agents where comms/tasking/evasion are separate loadable PICOs
- Swap transport/evasion modules without rebuilding the whole agent
- Inject per-deployment configuration at link-time (listener URLs, keys, pipes)
- Prototype in-memory layouts that avoid standard rDLL section/RVA patterns
- Research/detection engineering: develop heuristics for multi-region modular implants

Keywords:
Crystal Palace, Tradecraft Garden, PICO, PICO object, COFF, position-independent code, reflective loader, rDLL, in-memory loading, VirtualAlloc, MEM_TOP_DOWN, EAT walking, export hashing, LoadLibraryA, GetProcAddress, piclink, spec file, function pointer patching, link-time patching, post-exploitation agent architecture