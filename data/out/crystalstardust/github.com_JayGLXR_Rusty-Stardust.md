# https://github.com/JayGLXR/Rusty-Stardust

[Skip to content](https://github.com/JayGLXR/Rusty-Stardust#start-of-content)

You signed in with another tab or window. [Reload](https://github.com/JayGLXR/Rusty-Stardust) to refresh your session.You signed out in another tab or window. [Reload](https://github.com/JayGLXR/Rusty-Stardust) to refresh your session.You switched accounts on another tab or window. [Reload](https://github.com/JayGLXR/Rusty-Stardust) to refresh your session.Dismiss alert

{{ message }}

[JayGLXR](https://github.com/JayGLXR)/ **[Rusty-Stardust](https://github.com/JayGLXR/Rusty-Stardust)** Public

- [Notifications](https://github.com/login?return_to=%2FJayGLXR%2FRusty-Stardust) You must be signed in to change notification settings
- [Fork\\
6](https://github.com/login?return_to=%2FJayGLXR%2FRusty-Stardust)
- [Star\\
59](https://github.com/login?return_to=%2FJayGLXR%2FRusty-Stardust)


A modern Rust implementation of the original Stardust project, providing a sophisticated 32/64-bit shellcode template that features position-independent code development, compile-time string hashing, and raw string embedding capabilities, all while leveraging Rust's safety guarantees and modern tooling for both educational and practical purposes.


[59\\
stars](https://github.com/JayGLXR/Rusty-Stardust/stargazers) [6\\
forks](https://github.com/JayGLXR/Rusty-Stardust/forks) [Branches](https://github.com/JayGLXR/Rusty-Stardust/branches) [Tags](https://github.com/JayGLXR/Rusty-Stardust/tags) [Activity](https://github.com/JayGLXR/Rusty-Stardust/activity)

[Star](https://github.com/login?return_to=%2FJayGLXR%2FRusty-Stardust)

[Notifications](https://github.com/login?return_to=%2FJayGLXR%2FRusty-Stardust) You must be signed in to change notification settings

# JayGLXR/Rusty-Stardust

main

[**1** Branch](https://github.com/JayGLXR/Rusty-Stardust/branches) [**0** Tags](https://github.com/JayGLXR/Rusty-Stardust/tags)

[Go to Branches page](https://github.com/JayGLXR/Rusty-Stardust/branches)[Go to Tags page](https://github.com/JayGLXR/Rusty-Stardust/tags)

Go to file

Code

Open more actions menu

## Folders and files

| Name | Name | Last commit message | Last commit date |
| --- | --- | --- | --- |
| ## Latest commit<br>[![JayGLXR](https://avatars.githubusercontent.com/u/154396700?v=4&size=40)](https://github.com/JayGLXR)[JayGLXR](https://github.com/JayGLXR/Rusty-Stardust/commits?author=JayGLXR)<br>[Update README.md with photo](https://github.com/JayGLXR/Rusty-Stardust/commit/5ede5279847c3865847c54d776718bf8cee868e5)<br>11 months agoMar 17, 2025<br>[5ede527](https://github.com/JayGLXR/Rusty-Stardust/commit/5ede5279847c3865847c54d776718bf8cee868e5) · 11 months agoMar 17, 2025<br>## History<br>[2 Commits](https://github.com/JayGLXR/Rusty-Stardust/commits/main/) <br>Open commit details<br>[View commit history for this file.](https://github.com/JayGLXR/Rusty-Stardust/commits/main/) 2 Commits |
| [asm](https://github.com/JayGLXR/Rusty-Stardust/tree/main/asm "asm") | [asm](https://github.com/JayGLXR/Rusty-Stardust/tree/main/asm "asm") | [Add files via upload](https://github.com/JayGLXR/Rusty-Stardust/commit/15ab72bf965cae87a770adb394e1eb70003ad7af "Add files via upload") | 11 months agoMar 17, 2025 |
| [bin](https://github.com/JayGLXR/Rusty-Stardust/tree/main/bin "bin") | [bin](https://github.com/JayGLXR/Rusty-Stardust/tree/main/bin "bin") | [Add files via upload](https://github.com/JayGLXR/Rusty-Stardust/commit/15ab72bf965cae87a770adb394e1eb70003ad7af "Add files via upload") | 11 months agoMar 17, 2025 |
| [scripts](https://github.com/JayGLXR/Rusty-Stardust/tree/main/scripts "scripts") | [scripts](https://github.com/JayGLXR/Rusty-Stardust/tree/main/scripts "scripts") | [Add files via upload](https://github.com/JayGLXR/Rusty-Stardust/commit/15ab72bf965cae87a770adb394e1eb70003ad7af "Add files via upload") | 11 months agoMar 17, 2025 |
| [src](https://github.com/JayGLXR/Rusty-Stardust/tree/main/src "src") | [src](https://github.com/JayGLXR/Rusty-Stardust/tree/main/src "src") | [Add files via upload](https://github.com/JayGLXR/Rusty-Stardust/commit/15ab72bf965cae87a770adb394e1eb70003ad7af "Add files via upload") | 11 months agoMar 17, 2025 |
| [tests](https://github.com/JayGLXR/Rusty-Stardust/tree/main/tests "tests") | [tests](https://github.com/JayGLXR/Rusty-Stardust/tree/main/tests "tests") | [Add files via upload](https://github.com/JayGLXR/Rusty-Stardust/commit/15ab72bf965cae87a770adb394e1eb70003ad7af "Add files via upload") | 11 months agoMar 17, 2025 |
| [Cargo.lock](https://github.com/JayGLXR/Rusty-Stardust/blob/main/Cargo.lock "Cargo.lock") | [Cargo.lock](https://github.com/JayGLXR/Rusty-Stardust/blob/main/Cargo.lock "Cargo.lock") | [Add files via upload](https://github.com/JayGLXR/Rusty-Stardust/commit/15ab72bf965cae87a770adb394e1eb70003ad7af "Add files via upload") | 11 months agoMar 17, 2025 |
| [Cargo.toml](https://github.com/JayGLXR/Rusty-Stardust/blob/main/Cargo.toml "Cargo.toml") | [Cargo.toml](https://github.com/JayGLXR/Rusty-Stardust/blob/main/Cargo.toml "Cargo.toml") | [Add files via upload](https://github.com/JayGLXR/Rusty-Stardust/commit/15ab72bf965cae87a770adb394e1eb70003ad7af "Add files via upload") | 11 months agoMar 17, 2025 |
| [Dockerfile](https://github.com/JayGLXR/Rusty-Stardust/blob/main/Dockerfile "Dockerfile") | [Dockerfile](https://github.com/JayGLXR/Rusty-Stardust/blob/main/Dockerfile "Dockerfile") | [Add files via upload](https://github.com/JayGLXR/Rusty-Stardust/commit/15ab72bf965cae87a770adb394e1eb70003ad7af "Add files via upload") | 11 months agoMar 17, 2025 |
| [Makefile](https://github.com/JayGLXR/Rusty-Stardust/blob/main/Makefile "Makefile") | [Makefile](https://github.com/JayGLXR/Rusty-Stardust/blob/main/Makefile "Makefile") | [Add files via upload](https://github.com/JayGLXR/Rusty-Stardust/commit/15ab72bf965cae87a770adb394e1eb70003ad7af "Add files via upload") | 11 months agoMar 17, 2025 |
| [README.md](https://github.com/JayGLXR/Rusty-Stardust/blob/main/README.md "README.md") | [README.md](https://github.com/JayGLXR/Rusty-Stardust/blob/main/README.md "README.md") | [Update README.md with photo](https://github.com/JayGLXR/Rusty-Stardust/commit/5ede5279847c3865847c54d776718bf8cee868e5 "Update README.md with photo") | 11 months agoMar 17, 2025 |
| [build.rs](https://github.com/JayGLXR/Rusty-Stardust/blob/main/build.rs "build.rs") | [build.rs](https://github.com/JayGLXR/Rusty-Stardust/blob/main/build.rs "build.rs") | [Add files via upload](https://github.com/JayGLXR/Rusty-Stardust/commit/15ab72bf965cae87a770adb394e1eb70003ad7af "Add files via upload") | 11 months agoMar 17, 2025 |
| [build\_native.sh](https://github.com/JayGLXR/Rusty-Stardust/blob/main/build_native.sh "build_native.sh") | [build\_native.sh](https://github.com/JayGLXR/Rusty-Stardust/blob/main/build_native.sh "build_native.sh") | [Add files via upload](https://github.com/JayGLXR/Rusty-Stardust/commit/15ab72bf965cae87a770adb394e1eb70003ad7af "Add files via upload") | 11 months agoMar 17, 2025 |
| View all files |

## Repository files navigation

# Rusty-Stardust

[Permalink: Rusty-Stardust](https://github.com/JayGLXR/Rusty-Stardust#rusty-stardust)

A modern and easy to use 32/64-bit shellcode template, ported to Rust from the original [Stardust](https://github.com/Cracked5pider/Stardust) project by [C5pider](https://twitter.com/C5pider).

[![8D0BEA19-E728-42F4-A625-797765F4993B_1_201_a](https://private-user-images.githubusercontent.com/154396700/423680480-f687aa32-d9f1-46f0-9216-b139cbe344ac.jpeg?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NzExNDI1MDEsIm5iZiI6MTc3MTE0MjIwMSwicGF0aCI6Ii8xNTQzOTY3MDAvNDIzNjgwNDgwLWY2ODdhYTMyLWQ5ZjEtNDZmMC05MjE2LWIxMzljYmUzNDRhYy5qcGVnP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI2MDIxNSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNjAyMTVUMDc1NjQxWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9ZTBhZWNlMDAyYjc3ZTA0MTg5YzZjMWZhZjhiYzQyZTg1NDcyZWUxYjBhYzBkOTdlZjczM2Q1OWMxMWEwODVjNiZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.8l04wlhgLD7MpR5JA2vMlfNLcRE90G8sesGFzoEAwIc)](https://private-user-images.githubusercontent.com/154396700/423680480-f687aa32-d9f1-46f0-9216-b139cbe344ac.jpeg?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NzExNDI1MDEsIm5iZiI6MTc3MTE0MjIwMSwicGF0aCI6Ii8xNTQzOTY3MDAvNDIzNjgwNDgwLWY2ODdhYTMyLWQ5ZjEtNDZmMC05MjE2LWIxMzljYmUzNDRhYy5qcGVnP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI2MDIxNSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNjAyMTVUMDc1NjQxWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9ZTBhZWNlMDAyYjc3ZTA0MTg5YzZjMWZhZjhiYzQyZTg1NDcyZWUxYjBhYzBkOTdlZjczM2Q1OWMxMWEwODVjNiZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.8l04wlhgLD7MpR5JA2vMlfNLcRE90G8sesGFzoEAwIc)

## About

[Permalink: About](https://github.com/JayGLXR/Rusty-Stardust#about)

This project is a Rust implementation of the Stardust design, which provides a modern approach to position-independent code development. The original Stardust project introduced several key innovations in shellcode design:

- Separation of code and data into distinct sections
- Global instance access in position-independent code
- Raw string embedding capabilities
- Compile-time string hashing for stealth
- Exception handling and debug information stripping

Rusty-Stardust maintains these core features while leveraging Rust's safety guarantees and modern tooling. This implementation serves as both a practical tool and an educational resource for those interested in learning about position-independent code development in Rust.

## Features

[Permalink: Features](https://github.com/JayGLXR/Rusty-Stardust#features)

- Raw string embedding in shellcode
- Compile-time string hashing with fnv1a for both function and module resolution
- No\_std implementation for minimal footprint
- Cross-compilation for both x86 and x64 Windows targets
- Docker-based build environment for cross-platform development
- Position-independent code using RIP-relative addressing
- Exception handling and debug information stripping for minimal footprint
- Proper MinGW toolchain integration for reliable shellcode extraction

## Building

[Permalink: Building](https://github.com/JayGLXR/Rusty-Stardust#building)

### Prerequisites

[Permalink: Prerequisites](https://github.com/JayGLXR/Rusty-Stardust#prerequisites)

- Docker (for cross-compilation)
- Rust (for local development)
- NASM (assembled automatically in Docker)
- MinGW toolchain (provided in Docker environment)

### Building with Docker

[Permalink: Building with Docker](https://github.com/JayGLXR/Rusty-Stardust#building-with-docker)

Build for release:

```
$ make
```

Build for debug mode (with DbgPrint support):

```
$ make debug
```

### Build Outputs

[Permalink: Build Outputs](https://github.com/JayGLXR/Rusty-Stardust#build-outputs)

Output files will be placed in the `bin` directory:

- `stardust.x64.bin`: 64-bit shellcode (586 bytes)
- `stardust.x86.bin`: 32-bit shellcode (8.2KB)

The shellcode is extracted using MinGW's objcopy tool and contains:

- Stack setup code
- DLL loading functionality
- Function resolution code
- Architecture-specific instructions

### Build Configuration

[Permalink: Build Configuration](https://github.com/JayGLXR/Rusty-Stardust#build-configuration)

The project uses several key configurations for reliable shellcode generation:

1. **Linker Script** (`scripts/linker.ld`):
   - Discards exception handling sections (`.pdata`, `.xdata`)
   - Removes debug information (`.debug*`)
   - Strips unnecessary sections (`.eh_frame`, `.note*`, `.comment*`)
2. **Cargo Config** (`.cargo/config.toml`):
   - Position Independent Code (PIC) enabled
   - Structured Exception Handling (SEH) disabled
   - Windows subsystem configuration
   - Custom linker settings for both architectures
3. **Assembly Integration**:
   - Assembly files are compiled with NASM
   - RIP-relative addressing for position independence
   - Proper section alignment and linking

## Usage Example

[Permalink: Usage Example](https://github.com/JayGLXR/Rusty-Stardust#usage-example)

### Module Resolution

[Permalink: Module Resolution](https://github.com/JayGLXR/Rusty-Stardust#module-resolution)

Resolving modules from PEB:

```
// Resolve modules from PEB using hash
let ntdll_hash = hash_str!("ntdll.dll");
let ntdll_handle = resolve::module(ntdll_hash);

let kernel32_hash = hash_str!("kernel32.dll");
let kernel32_handle = resolve::module(kernel32_hash);
```

### API Resolution

[Permalink: API Resolution](https://github.com/JayGLXR/Rusty-Stardust#api-resolution)

Resolving function APIs:

```
// Resolve LoadLibraryA from kernel32
let load_library_fn: *mut FnLoadLibraryA = resolve::api(
    kernel32_handle,
    hash_str!("LoadLibraryA") as usize
);

// Load user32.dll
let user32 = unsafe { (*load_library_fn)(symbol("user32.dll".as_ptr())) };

// Resolve MessageBoxA from user32
let msgbox_fn: *mut FnMessageBoxA = resolve::api(
    user32 as usize,
    hash_str!("MessageBoxA") as usize
);

// Display message box
unsafe {
    (*msgbox_fn)(
        core::ptr::null_mut(),
        symbol("Hello world".as_ptr()),
        symbol("caption".as_ptr()),
        MB_OK
    );
}
```

### Debugging Output

[Permalink: Debugging Output](https://github.com/JayGLXR/Rusty-Stardust#debugging-output)

When built in debug mode:

```
#[cfg(feature = "debug")]
{
    dbg_printf!(instance, "Shellcode @ %p [%d bytes]\n", base_addr, size);
}
```

## Testing

[Permalink: Testing](https://github.com/JayGLXR/Rusty-Stardust#testing)

A test program called "stomper" is included to load and execute the shellcode:

```
$ cd tests
$ cargo build
$ ./target/debug/stomper ../bin/stardust.x64.bin
```

## Architecture

[Permalink: Architecture](https://github.com/JayGLXR/Rusty-Stardust#architecture)

This Rust port maintains the same architecture as the original C++ version:

- Assembly files are kept intact and linked using build.rs
- Memory layouts match the original for PE file parsing
- Windows structures are defined in Rust to match their C/C++ counterparts
- Function resolution uses the same hash-based approach for stealth
- MinGW toolchain integration for reliable shellcode extraction
- Exception handling and debug information stripping for minimal footprint

## Credits

[Permalink: Credits](https://github.com/JayGLXR/Rusty-Stardust#credits)

This project is a Rust implementation of the original Stardust project. Special thanks to:

- [C5pider](https://twitter.com/C5pider) for the original Stardust design and implementation
- [Modexp](https://twitter.com/modexpblog) for his work on Windows PIC
- [Austin Hudson](https://twitter.com/ilove2pwn_) for his work on titanldr-ng
- [Kyle Avery](https://twitter.com/kyleavery_) for his work on AceLdr
- [x86matthew](https://twitter.com/x86matthew) for assembly guidance
- [mrexodia](https://twitter.com/mrexodia) for linker script insights

## License

[Permalink: License](https://github.com/JayGLXR/Rusty-Stardust#license)

This project is licensed under the MIT License - see the [LICENSE](https://github.com/JayGLXR/Rusty-Stardust/blob/main/LICENSE) file for details.

The original Stardust project and its design concepts are the work of [C5pider](https://github.com/Cracked5pider/Stardust). This Rust implementation is provided as an educational resource and alternative implementation for those interested in learning about position-independent code development in Rust.

## About

A modern Rust implementation of the original Stardust project, providing a sophisticated 32/64-bit shellcode template that features position-independent code development, compile-time string hashing, and raw string embedding capabilities, all while leveraging Rust's safety guarantees and modern tooling for both educational and practical purposes.


### Resources

[Readme](https://github.com/JayGLXR/Rusty-Stardust#readme-ov-file)

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/JayGLXR/Rusty-Stardust).

[Activity](https://github.com/JayGLXR/Rusty-Stardust/activity)

### Stars

[**59**\\
stars](https://github.com/JayGLXR/Rusty-Stardust/stargazers)

### Watchers

[**1**\\
watching](https://github.com/JayGLXR/Rusty-Stardust/watchers)

### Forks

[**6**\\
forks](https://github.com/JayGLXR/Rusty-Stardust/forks)

[Report repository](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FJayGLXR%2FRusty-Stardust&report=JayGLXR+%28user%29)

## [Releases](https://github.com/JayGLXR/Rusty-Stardust/releases)

No releases published

## [Packages\  0](https://github.com/users/JayGLXR/packages?repo_name=Rusty-Stardust)

No packages published

## Languages

- [Rust87.4%](https://github.com/JayGLXR/Rusty-Stardust/search?l=rust)
- [Makefile5.8%](https://github.com/JayGLXR/Rusty-Stardust/search?l=makefile)
- [Assembly3.4%](https://github.com/JayGLXR/Rusty-Stardust/search?l=assembly)
- [Shell1.7%](https://github.com/JayGLXR/Rusty-Stardust/search?l=shell)
- [Dockerfile1.7%](https://github.com/JayGLXR/Rusty-Stardust/search?l=dockerfile)

You can’t perform that action at this time.