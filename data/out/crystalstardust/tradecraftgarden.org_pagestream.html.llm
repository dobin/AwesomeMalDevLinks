Title:
Tradecraft Garden – Page Streaming Loader

Type:
Documentation / Proof-of-Concept Loader

Short Summary (4–8 sentences max):
This project demonstrates a Windows reflective DLL loader that “streams” DLL pages into memory on-demand using guard pages and a Vectored Exception Handler (VEH). The loader keeps most of the DLL zeroed/obfuscated at rest, restoring (de-XORing) only the faulting 4KB page when execution or data access triggers a `STATUS_GUARD_PAGE_VIOLATION`. A small FIFO-style queue (`MAXVISIBLE`, default 3) limits how many pages remain visible; older pages are wiped and re-guarded to reduce in-memory exposure of code/resources. The implementation attempts to preserve realistic section permissions (e.g., `PAGE_EXECUTE_READ` for executable sections) and flushes the instruction cache after restoring a page. It’s primarily useful for red teams and malware developers exploring in-memory evasion and payload concealment tradeoffs, and for blue teams studying detection opportunities around anomalous VEH usage and frequent page-protection flips. The repo also includes build specs (Crystal Palace/PICO modules) and a YARA rule targeting the guardexec component.

Technical Focus:
- Vectored Exception Handling (AddVectoredExceptionHandler) for control-flow on page faults
- Guard pages (`PAGE_GUARD`) / page-permission manipulation via `VirtualProtect`
- On-demand page restoration and eviction (4KB streaming, MAXVISIBLE window)
- In-memory obfuscation/deobfuscation (XOR masking of section content)
- Reflective DLL loading (manual mapping: sections, imports, relocations)
- Detection artifacts (YARA signatures; behavioral footprint of VEH + protection flips)

Use Cases:
- Build a reflective loader that minimizes simultaneous in-memory visibility of a DLL
- Prototype “fluctuation”/page-fault-based unpacking or staged decryption techniques
- Experiment with section-permission hygiene (limiting executable pages) during manual mapping
- Develop and test detections for suspicious VEH registration and guard-page activity
- Research stability/performance impacts of page-fault-driven execution (single-thread assumption)

Keywords:
VEH, Vectored Exception Handler, AddVectoredExceptionHandler, PAGE_GUARD, STATUS_GUARD_PAGE_VIOLATION, VirtualProtect, VirtualAlloc, FlushInstructionCache, reflective DLL loader, manual mapping, PE sections, import resolution, relocations, page streaming, memory evasion, in-memory obfuscation, XOR key patching, Crystal Palace, PICO/COFF loader, YARA rule