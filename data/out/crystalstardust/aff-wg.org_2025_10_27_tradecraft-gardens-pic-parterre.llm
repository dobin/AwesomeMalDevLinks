Title:
Tradecraft Garden’s PIC Parterre (Crystal Palace PIC updates)

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post describes new Crystal Palace features in the Tradecraft Garden project aimed at making Windows position-independent code (PIC) more ergonomic and modular, separating “bootstrapping/evasion tradecraft” from the actual capability logic.  
- It revisits Dynamic Function Resolution (DFR) by adding support for multiple resolvers, allowing different API-resolution strategies per module set (e.g., KERNEL32/NTDLL vs everything else) and enabling loaders to handle missing DLLs (e.g., User32) more cleanly.  
- It introduces `fixbss`, a binary-transform feature that restores access to uninitialized global variables (.bss) in PIC by rewriting instructions that reference .bss to call a user-provided function returning stable RW memory (example implementation uses “data caves” in mapped modules).  
- It adds a `remap` primitive to rename COFF symbols, useful for adapting import naming conventions (e.g., mapping `__imp__Function` to `__imp__MODULE$Function`) or selecting between alternate entrypoints (e.g., `go_dll` vs `go_object`) without maintaining separate builds.  
- The key idea is a clearer separation line: helper functions (pointer fixups, .bss restoration, API resolution) become a “service module” that provides bootstrapping, while the PIC payload remains capability-focused.  
- Useful for red teamers, toolsmiths, and offensive researchers building reusable PIC/BOF-like components and experimenting with loader/bootstrapping tradecraft.

Technical Focus:
- Windows PIC binary transformation and disassembly-driven rewriting
- Dynamic Function Resolution (multi-resolver, per-module routing, default resolver)
- Restoring .bss/global variables in PIC via `fixbss` and stable RW backing storage
- Data-cave discovery in mapped PE sections (.data slack space)
- COFF symbol table manipulation (`remap`) for convention/entrypoint adaptation
- Separation of bootstrapping “service modules” from payload capability code

Use Cases:
- Build PIC payloads that can reuse the same codebase as BOF/PICO-style modules
- Implement flexible API resolution strategies (hash-based for core DLLs, string-based + LoadLibrary for others)
- Enable stateful PIC (globals) without converting to a full loader or DLL
- Swap entrypoints or import conventions post-build using spec files instead of multiple Makefiles
- Experiment with different bootstrapping “cocktails” to study detection tradeoffs

Keywords:
Crystal Palace, Tradecraft Garden, PIC, position-independent code, PICO, BOF-like, Dynamic Function Resolution, DFR, GetProcAddress, LoadLibraryA, GetModuleHandleA, KERNEL32, NTDLL, User32, .bss, global variables, fixbss, data cave, PE sections, .data slack space, COFF symbol table, remap, disassembly, binary rewriting, service module, loader tradecraft