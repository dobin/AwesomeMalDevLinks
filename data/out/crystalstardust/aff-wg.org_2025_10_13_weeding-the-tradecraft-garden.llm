Title:
Weeding the Tradecraft Garden

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post announces and explains new Crystal Palace features for transforming compiled x86/x64 programs into ergonomic position-independent code (PIC) aligned with Tradecraft Garden “PICO” conventions.  
- It focuses on reducing manual PIC boilerplate by using a binary transformation framework that disassembles, rewrites, and reassembles code to implement conventions automatically.  
- Key additions include Dynamic Function Resolution (DFR) for PIC (rewriting `__imp_MODULE$Function` references to call a user-supplied resolver using ROR13 hashes or pushed strings), an x86 pointer-fixing transform to eliminate offset/`#ifdef` hacks, and a `+gofirst` option to relocate the `go()` entrypoint to position 0.  
- The release also introduces “shared libraries” (zip bundles of convention-compliant objects) and a first library, LibTCG, providing common Tradecraft Garden functionality (DLL parsing/loading, EAT-based API resolution, PICO running, debug printf).  
- It discusses tradeoffs relevant to offensive use (size, static fingerprints) and positions link-time optimization, code mutation, and function shuffling (“function disco”) as mitigations.  
- Finally, it changes Tradecraft Garden example loaders from GPLv2 to BSD and provides migration guidance (deprecating `make pic64`, recommending DFR, `fixptrs`, `+gofirst`, and LibTCG adoption).  
- Useful for red team toolsmiths, implant/loader developers, and researchers building BOF/PIC-style capabilities who want more reusable, less error-prone PIC workflows.

Technical Focus:
- Binary transformation / disassembly-rewrite-reassembly pipeline
- Position-independent code (x86/x64) conventions and entrypoint layout
- Dynamic Function Resolution (MODULE$Function), resolver injection, ROR13 hashing
- x86 direct addressing remediation via instruction rewriting (“fixptrs”)
- Shared-library packaging of COFF/object code + link-time reachability pruning (LTO)
- Code mutation and function reordering to reduce static fingerprints

Use Cases:
- Building PIC/PICO capabilities without a traditional loader (self-resolving Win32 APIs)
- Porting non-PIC or semi-PIC x86/x64 code into working PIC with fewer manual patches
- Creating reusable offensive “capability libraries” shared across multiple loaders/projects
- Reducing duplicated loader/helper code by merging LibTCG objects and pruning unused code
- Hardening against signature-based detection via mutation and function shuffling

Keywords:
Crystal Palace, Tradecraft Garden, PIC, position-independent code, PICO, COFF, Beacon Object File, BOF, Dynamic Function Resolution, __imp_ symbols, Win32 API resolution, GetProcAddress, GetModuleHandle, Export Address Table, ROR13, x86 direct addressing, x64 RIP-relative addressing, disassembly, binary rewriting, link-time optimization, code mutation, function reordering, shared libraries, LibTCG, BSD license