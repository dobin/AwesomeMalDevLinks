# https://github.com/pard0p/PICO-Implant

[Skip to content](https://github.com/pard0p/PICO-Implant#start-of-content)

You signed in with another tab or window. [Reload](https://github.com/pard0p/PICO-Implant) to refresh your session.You signed out in another tab or window. [Reload](https://github.com/pard0p/PICO-Implant) to refresh your session.You switched accounts on another tab or window. [Reload](https://github.com/pard0p/PICO-Implant) to refresh your session.Dismiss alert

{{ message }}

[pard0p](https://github.com/pard0p)/ **[PICO-Implant](https://github.com/pard0p/PICO-Implant)** Public

- [Notifications](https://github.com/login?return_to=%2Fpard0p%2FPICO-Implant) You must be signed in to change notification settings
- [Fork\\
3](https://github.com/login?return_to=%2Fpard0p%2FPICO-Implant)
- [Star\\
43](https://github.com/login?return_to=%2Fpard0p%2FPICO-Implant)


PICO-Implant is a Proof of Concept C2 implant built using Position-independent Code Objects (PICO) for modular functionality. This project demonstrates that It's possible to build a multi-stage and modular C2 implant made of PICOs.


### License

[MIT license](https://github.com/pard0p/PICO-Implant/blob/main/LICENSE)

[43\\
stars](https://github.com/pard0p/PICO-Implant/stargazers) [3\\
forks](https://github.com/pard0p/PICO-Implant/forks) [Branches](https://github.com/pard0p/PICO-Implant/branches) [Tags](https://github.com/pard0p/PICO-Implant/tags) [Activity](https://github.com/pard0p/PICO-Implant/activity)

[Star](https://github.com/login?return_to=%2Fpard0p%2FPICO-Implant)

[Notifications](https://github.com/login?return_to=%2Fpard0p%2FPICO-Implant) You must be signed in to change notification settings

# pard0p/PICO-Implant

main

[**1** Branch](https://github.com/pard0p/PICO-Implant/branches) [**0** Tags](https://github.com/pard0p/PICO-Implant/tags)

[Go to Branches page](https://github.com/pard0p/PICO-Implant/branches)[Go to Tags page](https://github.com/pard0p/PICO-Implant/tags)

Go to file

Code

Open more actions menu

## Folders and files

| Name | Name | Last commit message | Last commit date |
| --- | --- | --- | --- |
| ## Latest commit<br>[![pard0p](https://avatars.githubusercontent.com/u/79936108?v=4&size=40)](https://github.com/pard0p)[pard0p](https://github.com/pard0p/PICO-Implant/commits?author=pard0p)<br>[Adding image with LibTP + LibGate integration diagram](https://github.com/pard0p/PICO-Implant/commit/36137dbb2dedddbe62d6defe8db047306b9294b0)<br>3 months agoNov 9, 2025<br>[36137db](https://github.com/pard0p/PICO-Implant/commit/36137dbb2dedddbe62d6defe8db047306b9294b0) · 3 months agoNov 9, 2025<br>## History<br>[8 Commits](https://github.com/pard0p/PICO-Implant/commits/main/) <br>Open commit details<br>[View commit history for this file.](https://github.com/pard0p/PICO-Implant/commits/main/) 8 Commits |
| [images](https://github.com/pard0p/PICO-Implant/tree/main/images "images") | [images](https://github.com/pard0p/PICO-Implant/tree/main/images "images") | [Adding image with LibTP + LibGate integration diagram](https://github.com/pard0p/PICO-Implant/commit/36137dbb2dedddbe62d6defe8db047306b9294b0 "Adding image with LibTP + LibGate integration diagram") | 3 months agoNov 9, 2025 |
| [lib](https://github.com/pard0p/PICO-Implant/tree/main/lib "lib") | [lib](https://github.com/pard0p/PICO-Implant/tree/main/lib "lib") | [LibTP + LibGate integration for indirect syscalls with callstack spoo…](https://github.com/pard0p/PICO-Implant/commit/d04a2aed72593486e503e75021f1224067191b5b "LibTP + LibGate integration for indirect syscalls with callstack spoofing/obfuscation") | 3 months agoNov 9, 2025 |
| [src](https://github.com/pard0p/PICO-Implant/tree/main/src "src") | [src](https://github.com/pard0p/PICO-Implant/tree/main/src "src") | [LibTP + LibGate integration for indirect syscalls with callstack spoo…](https://github.com/pard0p/PICO-Implant/commit/d04a2aed72593486e503e75021f1224067191b5b "LibTP + LibGate integration for indirect syscalls with callstack spoofing/obfuscation") | 3 months agoNov 9, 2025 |
| [.gitignore](https://github.com/pard0p/PICO-Implant/blob/main/.gitignore ".gitignore") | [.gitignore](https://github.com/pard0p/PICO-Implant/blob/main/.gitignore ".gitignore") | [Implemented LibTP integration for stealthier API calls from the implant.](https://github.com/pard0p/PICO-Implant/commit/1e55a8355ccf1c8517c3c0a41ba29060ea4b2c90 "Implemented LibTP integration for stealthier API calls from the implant.") | 3 months agoNov 8, 2025 |
| [LICENSE](https://github.com/pard0p/PICO-Implant/blob/main/LICENSE "LICENSE") | [LICENSE](https://github.com/pard0p/PICO-Implant/blob/main/LICENSE "LICENSE") | [Initial commit](https://github.com/pard0p/PICO-Implant/commit/ce42aba6c8e1e9c0cac48370855937f334a59a97 "Initial commit") | 3 months agoNov 7, 2025 |
| [Makefile](https://github.com/pard0p/PICO-Implant/blob/main/Makefile "Makefile") | [Makefile](https://github.com/pard0p/PICO-Implant/blob/main/Makefile "Makefile") | [LibTP + LibGate integration for indirect syscalls with callstack spoo…](https://github.com/pard0p/PICO-Implant/commit/d04a2aed72593486e503e75021f1224067191b5b "LibTP + LibGate integration for indirect syscalls with callstack spoofing/obfuscation") | 3 months agoNov 9, 2025 |
| [README.md](https://github.com/pard0p/PICO-Implant/blob/main/README.md "README.md") | [README.md](https://github.com/pard0p/PICO-Implant/blob/main/README.md "README.md") | [Adding new things to README](https://github.com/pard0p/PICO-Implant/commit/47a39590ca47009ad01136101f094e54623f3486 "Adding new things to README") | 3 months agoNov 9, 2025 |
| [implant\_entry.spec](https://github.com/pard0p/PICO-Implant/blob/main/implant_entry.spec "implant_entry.spec") | [implant\_entry.spec](https://github.com/pard0p/PICO-Implant/blob/main/implant_entry.spec "implant_entry.spec") | [LibTP + LibGate integration for indirect syscalls with callstack spoo…](https://github.com/pard0p/PICO-Implant/commit/d04a2aed72593486e503e75021f1224067191b5b "LibTP + LibGate integration for indirect syscalls with callstack spoofing/obfuscation") | 3 months agoNov 9, 2025 |
| [implant\_obfuscation.spec](https://github.com/pard0p/PICO-Implant/blob/main/implant_obfuscation.spec "implant_obfuscation.spec") | [implant\_obfuscation.spec](https://github.com/pard0p/PICO-Implant/blob/main/implant_obfuscation.spec "implant_obfuscation.spec") | [LibTP + LibGate integration for indirect syscalls with callstack spoo…](https://github.com/pard0p/PICO-Implant/commit/d04a2aed72593486e503e75021f1224067191b5b "LibTP + LibGate integration for indirect syscalls with callstack spoofing/obfuscation") | 3 months agoNov 9, 2025 |
| [stage1.spec](https://github.com/pard0p/PICO-Implant/blob/main/stage1.spec "stage1.spec") | [stage1.spec](https://github.com/pard0p/PICO-Implant/blob/main/stage1.spec "stage1.spec") | [LibTP + LibGate integration for indirect syscalls with callstack spoo…](https://github.com/pard0p/PICO-Implant/commit/d04a2aed72593486e503e75021f1224067191b5b "LibTP + LibGate integration for indirect syscalls with callstack spoofing/obfuscation") | 3 months agoNov 9, 2025 |
| [stage2.spec](https://github.com/pard0p/PICO-Implant/blob/main/stage2.spec "stage2.spec") | [stage2.spec](https://github.com/pard0p/PICO-Implant/blob/main/stage2.spec "stage2.spec") | [LibTP + LibGate integration for indirect syscalls with callstack spoo…](https://github.com/pard0p/PICO-Implant/commit/d04a2aed72593486e503e75021f1224067191b5b "LibTP + LibGate integration for indirect syscalls with callstack spoofing/obfuscation") | 3 months agoNov 9, 2025 |
| View all files |

## Repository files navigation

# PICO-Implant

[Permalink: PICO-Implant](https://github.com/pard0p/PICO-Implant#pico-implant)

PICO-Implant is a Proof of Concept C2 implant built using Position-independent Code Objects (PICO) for modular functionality. This project demonstrates that It's possible to build a multi-stage and modular C2 implant made of PICOs.

[![PICO-Implant Architecture](https://github.com/pard0p/PICO-Implant/raw/main/images/PICO-Implant.png)](https://github.com/pard0p/PICO-Implant/blob/main/images/PICO-Implant.png)

## Key Features

[Permalink: Key Features](https://github.com/pard0p/PICO-Implant#key-features)

- **Multi-stage Architecture**: Three-stage execution flow (Stage 1 → Stage 2 → Implant Core).
- **Position Independent Code**: All modules built as PICOs for maximum flexibility.
- **Modular Design**: Separate modules for communication, entry point and obfuscation.
- **Remote Loading**: Stage 2 remotely loads core implant code.
- **LibTP + LibGate Integration**: Combines LibTP with an enhanced version of LibGate to execute indirect syscalls with callstack spoofing/obfuscation for advanced EDR evasion.

## Architecture Overview

[Permalink: Architecture Overview](https://github.com/pard0p/PICO-Implant#architecture-overview)

**Important Note**: This is not a fully functional implant but rather a Proof of Concept demonstrating the feasibility of building modular C2 implants using PICOs. The implementation focuses on core architectural concepts rather than complete operational functionality.

The PoC consists of three main modules:

### 1\. Communication Module (`transport.c`)

[Permalink: 1. Communication Module (transport.c)](https://github.com/pard0p/PICO-Implant#1-communication-module-transportc)

Provides basic communication between the Team Server and implant. In this PoC implementation:

- Simple health check functionality to demonstrate server communication.

**Note**: In a real implant, this would be significantly more complex with full command parsing, response formatting, and encryption capabilities.

### 2\. Entry Point Module (`entry.c`)

[Permalink: 2. Entry Point Module (entry.c)](https://github.com/pard0p/PICO-Implant#2-entry-point-module-entryc)

Where a real implant would handle task management:

- Basic loop for health check and sleep.

### 3\. Obfuscation Module (`obfuscation.c`)

[Permalink: 3. Obfuscation Module (obfuscation.c)](https://github.com/pard0p/PICO-Implant#3-obfuscation-module-obfuscationc)

Implements sleep obfuscation capabilities using the **Ekko** technique.

## Dependencies

[Permalink: Dependencies](https://github.com/pard0p/PICO-Implant#dependencies)

### Shared Libraries

[Permalink: Shared Libraries](https://github.com/pard0p/PICO-Implant#shared-libraries)

- **LibTCG**: Core Crystal Palace functionality for PIC operations
- **LibWinHTTP**: HTTP/HTTPS communication capabilities

## Usage

[Permalink: Usage](https://github.com/pard0p/PICO-Implant#usage)

### Building the Modules

[Permalink: Building the Modules](https://github.com/pard0p/PICO-Implant#building-the-modules)

```
# Build the entry point module
./piclink ../dev/RemotePICOLoader/implant_entry.spec x64 entry.bin

# Build the obfuscation module
./piclink ../dev/RemotePICOLoader/implant_obfuscation.spec x64 obfuscation.bin

# Build Stage 1 and 2 with environment key
./piclink ../dev/RemotePICOLoader/stage1.spec x64 out.bin ENVKEY=<your_environment_key>
```

### Deployment

[Permalink: Deployment](https://github.com/pard0p/PICO-Implant#deployment)

1. **Host Remote Modules**: Deploy `obfuscation.bin` and `entry.bin` on your web server.
2. **Deploy Stage 1**: Execute `out.bin`.
3. **Automatic Progression**: The code will automatically progress through all stages.

## Execution Flow

[Permalink: Execution Flow](https://github.com/pard0p/PICO-Implant#execution-flow)

### Stage 1: Initial Loader

[Permalink: Stage 1: Initial Loader](https://github.com/pard0p/PICO-Implant#stage-1-initial-loader)

- **Identical to guardrail example**: Decrypts and prepares Stage 2.
- Performs environment validation.
- Sets up execution context.

### Stage 2: Remote Module Loader

[Permalink: Stage 2: Remote Module Loader](https://github.com/pard0p/PICO-Implant#stage-2-remote-module-loader)

- Prepares process memory for PICO loading.
- Loads implant PICOs into memory.
- **Cleanup**: Removes Stage 1 from memory.

### Stage 3: Main Implant Execution

[Permalink: Stage 3: Main Implant Execution](https://github.com/pard0p/PICO-Implant#stage-3-main-implant-execution)

- Executes the main loop.
- **Cleanup**: Removes Stage 2 from memory.

## Future Enhancements

[Permalink: Future Enhancements](https://github.com/pard0p/PICO-Implant#future-enhancements)

- **PICO Management Library**: Development of a shared library for managing PICOs loaded in memory, providing better control and coordination of loaded modules.

# References

[Permalink: References](https://github.com/pard0p/PICO-Implant#references)

- [https://github.com/rasta-mouse/LibTP](https://github.com/rasta-mouse/LibTP)

- [https://github.com/rasta-mouse/LibGate](https://github.com/rasta-mouse/LibGate)

- [https://github.com/pard0p/LibWinHttp](https://github.com/pard0p/LibWinHttp)

- [https://tradecraftgarden.org/simplehook.html](https://tradecraftgarden.org/simplehook.html)

- [https://tradecraftgarden.org/simpleguard.html](https://tradecraftgarden.org/simpleguard.html)

- [https://github.com/Cracked5pider/Ekko](https://github.com/Cracked5pider/Ekko)


## About

PICO-Implant is a Proof of Concept C2 implant built using Position-independent Code Objects (PICO) for modular functionality. This project demonstrates that It's possible to build a multi-stage and modular C2 implant made of PICOs.


### Resources

[Readme](https://github.com/pard0p/PICO-Implant#readme-ov-file)

### License

[MIT license](https://github.com/pard0p/PICO-Implant#MIT-1-ov-file)

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/pard0p/PICO-Implant).

[Activity](https://github.com/pard0p/PICO-Implant/activity)

### Stars

[**43**\\
stars](https://github.com/pard0p/PICO-Implant/stargazers)

### Watchers

[**0**\\
watching](https://github.com/pard0p/PICO-Implant/watchers)

### Forks

[**3**\\
forks](https://github.com/pard0p/PICO-Implant/forks)

[Report repository](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fpard0p%2FPICO-Implant&report=pard0p+%28user%29)

## [Releases](https://github.com/pard0p/PICO-Implant/releases)

No releases published

## [Packages\  0](https://github.com/users/pard0p/packages?repo_name=PICO-Implant)

No packages published

## Languages

- [C96.0%](https://github.com/pard0p/PICO-Implant/search?l=c)
- [Makefile2.9%](https://github.com/pard0p/PICO-Implant/search?l=makefile)
- [Ruby1.1%](https://github.com/pard0p/PICO-Implant/search?l=ruby)

You can’t perform that action at this time.