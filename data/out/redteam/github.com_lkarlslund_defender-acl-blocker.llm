Title:
Defender ACL Blocker

Type:
GitHub Tool

Short Summary (4–8 sentences max):
Defender ACL Blocker is a Go-based tool that prevents Microsoft Defender (and optionally other security services) from starting by manipulating file permissions. It impersonates high-privilege identities (SYSTEM and TrustedInstaller) to modify the DACL on a chosen system DLL (default: `C:\Windows\System32\kernel32.dll`). The tool computes each target service’s Service SID (S-1-5-80-…) and prepends explicit DENY ACEs for those SIDs onto the file’s ACL. Because DENY ACEs take precedence, the Windows loader blocks the service from loading the DLL, causing the user-mode components to fail initialization after reboot. It includes a removal mode to revoke the applied ACL entries and supports custom target files and service lists. This is primarily useful for red teams/malware research to study service identity, ACL enforcement, and a non-traditional Defender disruption technique.

Technical Focus:
- Windows DACL/ACE manipulation (prepend DENY entries)
- Service SIDs (S-1-5-80-*) derivation and targeting
- Token theft/impersonation (SYSTEM via `winlogon.exe`, TrustedInstaller)
- Privilege enabling (`SeDebugPrivilege`)
- Windows loader behavior and DLL load authorization
- Go implementation and optional binary obfuscation (Garble)

Use Cases:
- Disable/impair Defender user-mode services by blocking DLL loads via ACLs
- Research how Service SIDs interact with filesystem ACL enforcement
- Simulate attacker tradecraft for defensive testing (hardening/detections)
- Validate monitoring around DACL changes on protected system binaries
- Build/ship an obfuscated PoC binary for controlled lab exercises

Keywords:
Microsoft Defender, WinDefend, Sense, mpssvc, Windows ACL, DACL, ACE, DENY ACE, Service SID, S-1-5-80, TrustedInstaller, SYSTEM token, token impersonation, SeDebugPrivilege, winlogon.exe, trustedinstaller.exe, kernel32.dll, Windows loader, Go, Garble