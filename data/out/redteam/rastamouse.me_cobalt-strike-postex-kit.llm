Title:
Cobalt Strike Postex Kit (CS 4.10) – building custom post-ex reflective DLL jobs

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post explains Cobalt Strike 4.10’s new Postex Kit and how it enables operators to build custom post-execution reflective DLLs (rDLLs) that integrate with Beacon’s job architecture.  
- It contrasts inline BOF execution (single-threaded and blocking Beacon) with fork & run rDLL execution (runs in a separate thread/process and keeps Beacon responsive), and clarifies the `spawn` vs `explicit` injection variants.  
- The kit provides a Visual Studio template that handles rDLL bootstrapping (DllMain → `PostexMain` → cleanup) and exposes familiar BOF-style APIs for argument parsing and output.  
- It details the named-pipe communication channel between Beacon and the injected rDLL, including reading operator-sent input at runtime.  
- A key operational pitfall is that `jobkill` doesn’t forcibly terminate an infinite loop in the DLL; the post recommends monitoring pipe state (e.g., `PeekNamedPipe` / `ERROR_BROKEN_PIPE`) to exit cleanly.  
- It also covers the new `execute-dll` command and the `beacon_execute_postex_job` Aggressor API for custom callbacks, logging, and sending data to running jobs.  
- Useful for red teamers/pentesters extending Cobalt Strike with long-running background tasks that need job control and interactive I/O.

Technical Focus:
- Cobalt Strike fork & run post-execution (spawn vs explicit)
- Reflective DLL post-ex tasks and Beacon job architecture
- Named pipe IPC between Beacon and injected payload
- BOF-style argument packing/parsing (`bof_pack`, `BeaconDataParse/Extract`)
- Output APIs and chunking over pipes (`BeaconPrintf`/`BeaconOutput`)
- Job control and Aggressor scripting callbacks (`beacon_execute_postex_job`, `bjob_send_data`)

Use Cases:
- Implement long-running post-ex tasks (e.g., keylogging, monitoring, scraping) without blocking Beacon
- Build interactive post-ex modules that accept operator input during runtime
- Integrate custom rDLL output/errors into CS job consoles and data models (e.g., credentials ingestion)
- Customize injection/evasion by combining Postex Kit with UDRL and Process Inject Kit hooks

Keywords:
Cobalt Strike 4.10, Postex Kit, Beacon, fork and run, reflective DLL, rDLL, BOF, inline execution, spawn, explicit injection, named pipe, IPC, DllMain, PostexMain, BeaconPrintf, BeaconOutput, bof_pack, BeaconDataParse, PeekNamedPipe, ERROR_BROKEN_PIPE, execute-dll, Aggressor Script, beacon_execute_postex_job, bjob_send_data, jobkill, UDRL, Process Inject Kit