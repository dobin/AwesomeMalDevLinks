# https://kostas.page/blog/cobalt-strike-defenders-guide-part-1

<!DOCTYPE html><html lang="en" class="dark">

  <body>
    

    <div id="root"><section aria-label="Notifications alt+T" tabindex="-1" aria-live="polite" aria-relevant="additions text" aria-atomic="false"></section><div data-loc="client/src/components/Layout.tsx:28" class="min-h-screen flex flex-col bg-background text-foreground font-sans selection:bg-primary/20 selection:text-primary"><main data-loc="client/src/components/Layout.tsx:117" class="flex-1"><div data-loc="client/src/pages/BlogPost.tsx:114" class="container py-12 md:py-24"><div data-loc="client/src/pages/BlogPost.tsx:115" class="max-w-4xl mx-auto"><div data-loc="client/src/pages/BlogPost.tsx:116" style="opacity: 0; transform: none;"><a data-loc="client/src/pages/BlogPost.tsx:121" href="https://kostas.page/blog"><button data-loc="client/src/pages/BlogPost.tsx:122" data-slot="button" class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*='size-'])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent dark:hover:bg-accent/50 h-9 px-4 py-2 has-[>svg]:px-3 mb-8 font-mono -ml-4"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-left mr-2 h-4 w-4" data-loc="client/src/pages/BlogPost.tsx:123"><path d="m12 19-7-7 7-7"></path><path d="M19 12H5"></path></svg>Back to Blog</button></a><div data-loc="client/src/pages/BlogPost.tsx:128" class="flex flex-wrap gap-2 mb-4"><span data-loc="client/src/pages/BlogPost.tsx:129" data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 font-medium w-fit whitespace-nowrap shrink-0 [&amp;>svg]:size-3 gap-1 [&amp;>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary text-secondary-foreground [a&amp;]:hover:bg-secondary/90 font-mono text-xs">Defense</span><span data-loc="client/src/pages/BlogPost.tsx:131" data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 w-fit whitespace-nowrap shrink-0 [&amp;>svg]:size-3 gap-1 [&amp;>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden [a&amp;]:hover:bg-accent [a&amp;]:hover:text-accent-foreground font-mono text-xs text-muted-foreground font-normal">#Cobalt Strike</span><span data-loc="client/src/pages/BlogPost.tsx:131" data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 w-fit whitespace-nowrap shrink-0 [&amp;>svg]:size-3 gap-1 [&amp;>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden [a&amp;]:hover:bg-accent [a&amp;]:hover:text-accent-foreground font-mono text-xs text-muted-foreground font-normal">#Threat Hunting</span><span data-loc="client/src/pages/BlogPost.tsx:131" data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 w-fit whitespace-nowrap shrink-0 [&amp;>svg]:size-3 gap-1 [&amp;>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden [a&amp;]:hover:bg-accent [a&amp;]:hover:text-accent-foreground font-mono text-xs text-muted-foreground font-normal">#Detection Engineering</span><span data-loc="client/src/pages/BlogPost.tsx:131" data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 w-fit whitespace-nowrap shrink-0 [&amp;>svg]:size-3 gap-1 [&amp;>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden [a&amp;]:hover:bg-accent [a&amp;]:hover:text-accent-foreground font-mono text-xs text-muted-foreground font-normal">#Red Team Tools</span></div><h1 data-loc="client/src/pages/BlogPost.tsx:137" class="text-4xl md:text-5xl font-bold font-mono mb-6">Cobalt Strike, a Defender's Guide</h1><div data-loc="client/src/pages/BlogPost.tsx:141" class="flex flex-wrap items-center gap-6 text-sm text-muted-foreground mb-6 font-mono"><div data-loc="client/src/pages/BlogPost.tsx:142" class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-user h-4 w-4" data-loc="client/src/pages/BlogPost.tsx:143"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg><span data-loc="client/src/pages/BlogPost.tsx:144">Kostas T.</span></div><div data-loc="client/src/pages/BlogPost.tsx:146" class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-calendar h-4 w-4" data-loc="client/src/pages/BlogPost.tsx:147"><path d="M8 2v4"></path><path d="M16 2v4"></path><rect width="18" height="18" x="3" y="4" rx="2"></rect><path d="M3 10h18"></path></svg><span data-loc="client/src/pages/BlogPost.tsx:148">August 28, 2021</span></div><div data-loc="client/src/pages/BlogPost.tsx:150" class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clock h-4 w-4" data-loc="client/src/pages/BlogPost.tsx:151"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg><span data-loc="client/src/pages/BlogPost.tsx:152">15 min read</span></div></div></div><article data-loc="client/src/pages/BlogPost.tsx:157" class="prose prose-invert prose-lg max-w-none mb-12" style="opacity: 0; transform: none;"><h2 data-loc="client/src/pages/BlogPost.tsx:168" class="text-2xl font-bold font-mono mt-8 mb-4">Intro</h2>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">In security research, we expose adversarial Tactics, Techniques and Procedures (TTPs) as well as the tools they use to execute their mission objectives. In most cases, we see the threat actors utilizing Cobalt Strike. Therefore, defenders should know how to detect Cobalt Strike in various stages of its execution. The primary purpose of this post is to expose the most common techniques that we see from the intrusions that we track and provide detections. Having said that, not all of Cobalt Strike's features will be discussed.</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Cobalt Strike is used as a post-exploitation tool with various malware droppers responsible for the initial infection stage. Some of the most common droppers we see are IcedID (a.k.a. BokBot), ZLoader, Qbot (a.k.a. QakBot), Ursnif, Hancitor, Bazar and TrickBot. Cobalt Strike is chosen for the second stage of the attack as it offers enhanced post-exploitation capabilities. Threat actors turn to Cobalt Strike for its ease of use and extensibility.</p>
<h2 data-loc="client/src/pages/BlogPost.tsx:168" class="text-2xl font-bold font-mono mt-8 mb-4">Cobalt Strike Capabilities</h2>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Cobalt Strike has many features, and it is under constant development by a team of developers at <a data-loc="client/src/pages/BlogPost.tsx:209" href="https://www.coresecurity.com/products/cobalt-strike" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">Core Security</a> by Help Systems. Raphael Mudge was the primary maintainer for many years before the acquisition from Core Security. Raphael has an <a data-loc="client/src/pages/BlogPost.tsx:209" href="https://www.youtube.com/playlist?list=PL9HO6M_MU2nfQ4kHSCzAQMqxQxH47d1no" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">extensive playlist on youtube</a> that demonstrates the many features of Cobalt Strike and step-by-step guides on how to use its full potential. His videos are handy to watch if you want to get a glimpse of all the features that Cobalt Strike has to offer in various phases of the intrusion.</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Below are some of the capabilities that we see being used by operators. This is not an exhaustive list of commands available, but it contains most of the built-in features that we encounter in most cases. In the table below, the "Documented Features" correspond to the Cobalt Strike execution commands via the interactive shell as per official <a data-loc="client/src/pages/BlogPost.tsx:209" href="https://www.cobaltstrike.com/help-beacon" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">documentation</a>:</p>
<div data-loc="client/src/pages/BlogPost.tsx:192" class="overflow-x-auto mb-6"><table data-loc="client/src/pages/BlogPost.tsx:193" class="min-w-full border-collapse border border-muted"><thead><tr><th data-loc="client/src/pages/BlogPost.tsx:199" class="border border-muted bg-muted/50 px-4 py-2 text-left font-mono font-semibold">Capabilities</th><th data-loc="client/src/pages/BlogPost.tsx:199" class="border border-muted bg-muted/50 px-4 py-2 text-left font-mono font-semibold">Documented features/commands</th></tr></thead><tbody><tr><td data-loc="client/src/pages/BlogPost.tsx:204" class="border border-muted px-4 py-2 text-muted-foreground">Upload and Download payloads and files</td><td data-loc="client/src/pages/BlogPost.tsx:204" class="border border-muted px-4 py-2 text-muted-foreground">Download <code data-loc="client/src/pages/BlogPost.tsx:177" class="bg-muted px-1.5 py-0.5 rounded text-sm font-mono text-primary" node="[object Object]">&lt;file&gt;</code>, Upload <code data-loc="client/src/pages/BlogPost.tsx:177" class="bg-muted px-1.5 py-0.5 rounded text-sm font-mono text-primary" node="[object Object]">&lt;file&gt;</code></td></tr><tr><td data-loc="client/src/pages/BlogPost.tsx:204" class="border border-muted px-4 py-2 text-muted-foreground">Running Commands</td><td data-loc="client/src/pages/BlogPost.tsx:204" class="border border-muted px-4 py-2 text-muted-foreground">shell <code data-loc="client/src/pages/BlogPost.tsx:177" class="bg-muted px-1.5 py-0.5 rounded text-sm font-mono text-primary" node="[object Object]">&lt;command&gt;</code>, run <code data-loc="client/src/pages/BlogPost.tsx:177" class="bg-muted px-1.5 py-0.5 rounded text-sm font-mono text-primary" node="[object Object]">&lt;command&gt;</code>, powershell <code data-loc="client/src/pages/BlogPost.tsx:177" class="bg-muted px-1.5 py-0.5 rounded text-sm font-mono text-primary" node="[object Object]">&lt;command&gt;</code></td></tr><tr><td data-loc="client/src/pages/BlogPost.tsx:204" class="border border-muted px-4 py-2 text-muted-foreground">Process Injection</td><td data-loc="client/src/pages/BlogPost.tsx:204" class="border border-muted px-4 py-2 text-muted-foreground">inject <code data-loc="client/src/pages/BlogPost.tsx:177" class="bg-muted px-1.5 py-0.5 rounded text-sm font-mono text-primary" node="[object Object]">&lt;pid&gt;</code>, dllinject <code data-loc="client/src/pages/BlogPost.tsx:177" class="bg-muted px-1.5 py-0.5 rounded text-sm font-mono text-primary" node="[object Object]">&lt;pid&gt;</code> <em>(for reflective dll injection)</em>, dllload <code data-loc="client/src/pages/BlogPost.tsx:177" class="bg-muted px-1.5 py-0.5 rounded text-sm font-mono text-primary" node="[object Object]">&lt;pid&gt;</code> <em>(for loading an on-disk DLL to memory)</em>, spawnto <code data-loc="client/src/pages/BlogPost.tsx:177" class="bg-muted px-1.5 py-0.5 rounded text-sm font-mono text-primary" node="[object Object]">&lt;arch&gt;</code> <code data-loc="client/src/pages/BlogPost.tsx:177" class="bg-muted px-1.5 py-0.5 rounded text-sm font-mono text-primary" node="[object Object]">&lt;full-exe-path&gt;</code> <em>(for process hollowing)</em></td></tr><tr><td data-loc="client/src/pages/BlogPost.tsx:204" class="border border-muted px-4 py-2 text-muted-foreground">SOCKS Proxy</td><td data-loc="client/src/pages/BlogPost.tsx:204" class="border border-muted px-4 py-2 text-muted-foreground">socks <code data-loc="client/src/pages/BlogPost.tsx:177" class="bg-muted px-1.5 py-0.5 rounded text-sm font-mono text-primary" node="[object Object]">&lt;port number&gt;</code></td></tr><tr><td data-loc="client/src/pages/BlogPost.tsx:204" class="border border-muted px-4 py-2 text-muted-foreground">Privilege Escalation</td><td data-loc="client/src/pages/BlogPost.tsx:204" class="border border-muted px-4 py-2 text-muted-foreground">getsystem <em>(SYSTEM account impersonation using named pipes)</em>, elevate svc-exe [listener] <em>(creates a services that runs a payload as SYSTEM)</em></td></tr><tr><td data-loc="client/src/pages/BlogPost.tsx:204" class="border border-muted px-4 py-2 text-muted-foreground">Credential and Hash Harvesting</td><td data-loc="client/src/pages/BlogPost.tsx:204" class="border border-muted px-4 py-2 text-muted-foreground">hashdump, logonpasswords <em>(Using Mimikatz)</em>, chromedump <em>(Recover Google Chrome passwords from current user)</em></td></tr><tr><td data-loc="client/src/pages/BlogPost.tsx:204" class="border border-muted px-4 py-2 text-muted-foreground">Network Enumeration</td><td data-loc="client/src/pages/BlogPost.tsx:204" class="border border-muted px-4 py-2 text-muted-foreground">portscan [targets] [ports] [discovery method], net <code data-loc="client/src/pages/BlogPost.tsx:177" class="bg-muted px-1.5 py-0.5 rounded text-sm font-mono text-primary" node="[object Object]">&lt;commands&gt;</code> <em>(commands to find targets on the domain)</em></td></tr><tr><td data-loc="client/src/pages/BlogPost.tsx:204" class="border border-muted px-4 py-2 text-muted-foreground">Lateral Movement</td><td data-loc="client/src/pages/BlogPost.tsx:204" class="border border-muted px-4 py-2 text-muted-foreground">jump psexec <em>(Run service EXE on remote host)</em>, jump psexec_psh <em>(Run a PowerShell one-liner on remote host via a service)</em>, jump winrm <em>(Run a PowerShell script via WinRM on remote host)</em>, remote-exec <code data-loc="client/src/pages/BlogPost.tsx:177" class="bg-muted px-1.5 py-0.5 rounded text-sm font-mono text-primary" node="[object Object]">&lt;any of the above&gt;</code> <em>(Run a single command using the above methods on remote host)</em></td></tr></tbody></table></div>
<h2 data-loc="client/src/pages/BlogPost.tsx:168" class="text-2xl font-bold font-mono mt-8 mb-4">Cobalt Strike Infrastructure</h2>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Changing infrastructure will always be inconvenient for the threat actors, but it is not a difficult task. Additionally, Cobalt Strike is able to make use of "redirectors." Therefore, some of these servers could be a redirector instead of the actual Cobalt Strike C2 server. <a data-loc="client/src/pages/BlogPost.tsx:209" href="https://blog.cobaltstrike.com/2014/01/14/cloud-based-redirectors-for-distributed-hacking/" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">Redirectors</a> are hosts that do what the name implies, redirect traffic to the real C2 server. Threat actors can hide their infrastructure behind an army of redirectors and conceal the actual C2 server. This makes the malicious infrastructure harder for the defenders to discover and block.</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Image taken from the official Cobalt Strike documentation:</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://thedfirreport.com/wp-content/uploads/2021/07/image.png" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer"><img alt="Cobalt Strike Redirectors" src="https://thedfirreport.com/wp-content/uploads/2021/07/image.png"></a></p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Threat Feed services track hundreds of Cobalt Strike servers and other C2 infrastructure:</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><img alt="Cobalt Strike Infrastructure" src="https://thedfirreport.com/wp-content/uploads/2021/08/1-13.png"></p>
<h3 data-loc="client/src/pages/BlogPost.tsx:169" class="text-xl font-bold font-mono mt-6 mb-3">Malleable C2 profiles</h3>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Cobalt Strike has adopted Malleable profiles and allows the threat actors to customize almost every aspect of the C2 framework. This makes life harder for defenders as the footprint can change with each profile modification. The threat actors have the ability to change anything from the network communication (like user agent, headers, default URIs) to individual post-exploitation functions such as process injection and payload obfuscation capabilities.</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Across many investigations the profiles used differ, but you can see that actors do often reuse or patterns emerge among intrusions. Many intrusions make use of the same profile that mimics a legitimate jquery request. The self-signed certificates also often contain the same fake attributes trying to pose as regular jquery traffic.</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Common Cobalt Strike config:</p>
<pre data-loc="client/src/pages/BlogPost.tsx:182" class="bg-muted/50 border rounded-lg p-4 overflow-x-auto mb-6 text-sm"><code data-loc="client/src/pages/BlogPost.tsx:177" class="bg-muted px-1.5 py-0.5 rounded text-sm font-mono text-primary" node="[object Object]">| grab_beacon_config:
| x86 URI Response:
| BeaconType: 0 (HTTP)
| Port: 80
| Polling: 45000
| Jitter: 37
| Maxdns: 255
| C2 Server: 195.123.217.45,/jquery-3.3.1.min.js
| User Agent: Mozilla/5.0 (Windows NT 6.3; Trident/7.0; rv:11.0) like Gecko
| HTTP Method Path 2: /jquery-3.3.2.min.js
| Header1:
| Header2:
| PipeName:
| DNS Idle: J}\xC4q
| DNS Sleep: 0
| Method1: GET
| Method2: POST
| Spawnto_x86: %windir%\syswow64\dllhost.exe
| Spawnto_x64: %windir%\sysnative\dllhost.exe
| Proxy_AccessType: 2 (Use IE settings)
|
|
| x64 URI Response:
| BeaconType: 0 (HTTP)
| Port: 80
| Polling: 45000
| Jitter: 37
| Maxdns: 255
| C2 Server: 195.123.217.45,/jquery-3.3.1.min.js
| User Agent: Mozilla/5.0 (Windows NT 6.3; Trident/7.0; rv:11.0) like Gecko
| HTTP Method Path 2: /jquery-3.3.2.min.js
| Method1: GET
| Method2: POST
| Spawnto_x86: %windir%\syswow64\dllhost.exe
| Spawnto_x64: %windir%\sysnative\dllhost.exe
| Proxy_AccessType: 2 (Use IE settings)
|_
443/tcp open  https
| grab_beacon_config:
| x86 URI Response:
| BeaconType: 8 (HTTPS)
| Port: 443
| Polling: 45000
| Jitter: 37
| Maxdns: 255
| C2 Server: gloomix.com,/jquery-3.3.1.min.js
| User Agent: Mozilla/5.0 (Windows NT 6.3; Trident/7.0; rv:11.0) like Gecko
| HTTP Method Path 2: /jquery-3.3.2.min.js
| Method1: GET
| Method2: POST
| Spawnto_x86: %windir%\syswow64\dllhost.exe
| Spawnto_x64: %windir%\sysnative\dllhost.exe
| Proxy_AccessType: 2 (Use IE settings)
</code></pre>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Example C2 server fingerprints:</p>
<pre data-loc="client/src/pages/BlogPost.tsx:182" class="bg-muted/50 border rounded-lg p-4 overflow-x-auto mb-6 text-sm"><code data-loc="client/src/pages/BlogPost.tsx:177" class="bg-muted px-1.5 py-0.5 rounded text-sm font-mono text-primary" node="[object Object]">195.123.222.23
JARM: 07d14d16d21d21d07c42d41d00041d24a458a375eef0c576d23a7bab9a9fb1
JA3s: ae4edc6faf64d08308082ad26be60767,649d6810e8392f63dc311eecb6b7098b
JA3: 72a589da586844d7f0818ce684948eea,51c64c77e60f3980eea90869b68c58a8,613e01474d42ebe48ef52dff6a20f079,7dd50e112cd23734a310b90f6f44a7cd
Certificate: [79:97:9a:e4:cb:ae:ae:32:d6:4a:e5:0e:f6:73:d0:69:e9:19:c1:54 ]
Not Before: 2020/12/21 04:27:54
Not After: 2021/12/21 04:27:54
Issuer Org: jQuery
Subject Common: jquery.com
Subject Org: jQuery
Public Algorithm: rsaEncryption
</code></pre>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Examples of malleable C2 profiles can be found on <a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/rsmudge/Malleable-C2-Profiles" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">the official GitHub repository</a> of Raphael Mudge. There are a number of GitHub repositories that allow for generation of randomized malleable profiles. These randomized profiles could be either based on completely random values or values based on an existing collection of existing malleable profiles. Two of the most notable repos are:</p>
<ul data-loc="client/src/pages/BlogPost.tsx:171" class="list-disc pl-6 mb-4 space-y-2 text-muted-foreground">
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">Malleable-C2-Randomizer <a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/bluscreenofjeff/Malleable-C2-Randomizer" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">https://github.com/bluscreenofjeff/Malleable-C2-Randomizer</a></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">C2concealer – <a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/FortyNorthSecurity/C2concealer" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">https://github.com/FortyNorthSecurity/C2concealer</a></li>
</ul>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">A couple of very recent examples where threat actors used customized malleable profiles were in the Solarwinds attack as well as in latest campaigns from Nobelium as attributed by <a data-loc="client/src/pages/BlogPost.tsx:209" href="https://www.microsoft.com/security/blog/2021/05/27/new-sophisticated-email-based-attack-from-nobelium/" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">Microsoft</a>.</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><img alt="Nobelium Campaign" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-1-701x1024.png"></p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">In the case of the Solarwinds attack, the threat actors used several customized Cobalt Strike beacons to execute the second-stage payload on their victims. According to Microsoft, <em>"No two Beacon instances shared the same C2 domain name, Watermark, or other aforementioned configuration values. Other than certain internal fields, most Beacon configuration fields are customizable via a Malleable C2 profile."</em> – <a data-loc="client/src/pages/BlogPost.tsx:209" href="https://www.microsoft.com/security/blog/2021/01/20/deep-dive-into-the-solorigate-second-stage-activation-from-sunburst-to-teardrop-and-raindrop/" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">Deep dive into the Solorigate second-stage activation: From SUNBURST to TEARDROP and Raindrop</a>.</p>
<h2 data-loc="client/src/pages/BlogPost.tsx:168" class="text-2xl font-bold font-mono mt-8 mb-4">Cobalt Strike in Action</h2>
<h3 data-loc="client/src/pages/BlogPost.tsx:169" class="text-xl font-bold font-mono mt-6 mb-3">Execution</h3>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">A lot of the Cobalt Strike post-exploitation tools are implemented as windows DLLs. This means that every time a threat actor runs these built-in tools, Cobalt Strike spawns a temporary process and uses rundll32.exe to inject the malicious code into it and communicates the results back to the beacon using named pipes. Defenders should pay close attention to command line events that rundll32 is executing without any arguments.</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Example execution:</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://thedfirreport.com/wp-content/uploads/2021/07/image-2.png" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer"><img alt="Cobalt Strike Execution Example 1" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-2.png"></a></p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://thedfirreport.com/wp-content/uploads/2021/07/image-3.png" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer"><img alt="Cobalt Strike Execution Example 2" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-3.png"></a></p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Named pipes are used to send the output of the post-exploitation tools to the beacon. Cobalt Strike is using default unique pipe names, which defenders can use for detection. However, Cobalt Strike allows the operators to change the name of the pipes to any name of their choosing by configuring the malleable C2 profile accordingly. Even though this is very easy to create, it is an inconvenience for the average attacker, and we do not see it being done often. For more information Cobalt Strike has an extensive documentation on named pipes <a data-loc="client/src/pages/BlogPost.tsx:209" href="https://blog.cobaltstrike.com/2021/02/09/learn-pipe-fitting-for-all-of-your-offense-projects/" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">here</a>.</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">The default Cobalt Strike pipes are (the "*" symbolize the prefix/suffix):</p>
<ul data-loc="client/src/pages/BlogPost.tsx:171" class="list-disc pl-6 mb-4 space-y-2 text-muted-foreground">
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><code data-loc="client/src/pages/BlogPost.tsx:177" class="bg-muted px-1.5 py-0.5 rounded text-sm font-mono text-primary" node="[object Object]">\\postex_*</code></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><code data-loc="client/src/pages/BlogPost.tsx:177" class="bg-muted px-1.5 py-0.5 rounded text-sm font-mono text-primary" node="[object Object]">\\postex_ssh_*</code></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><code data-loc="client/src/pages/BlogPost.tsx:177" class="bg-muted px-1.5 py-0.5 rounded text-sm font-mono text-primary" node="[object Object]">\\status_*</code></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><code data-loc="client/src/pages/BlogPost.tsx:177" class="bg-muted px-1.5 py-0.5 rounded text-sm font-mono text-primary" node="[object Object]">\\msagent_*</code></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><code data-loc="client/src/pages/BlogPost.tsx:177" class="bg-muted px-1.5 py-0.5 rounded text-sm font-mono text-primary" node="[object Object]">\\MSSE-*</code></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><code data-loc="client/src/pages/BlogPost.tsx:177" class="bg-muted px-1.5 py-0.5 rounded text-sm font-mono text-primary" node="[object Object]">\\*-server</code></li>
</ul>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Sysmon event 17 and 18 are able to log named pipes. Note that Sysmon should be explicitly configured to log named pipes. F-Secure Labs created a great write up for detecting Cobalt Strike through named pipes: <a data-loc="client/src/pages/BlogPost.tsx:209" href="https://labs.f-secure.com/blog/detecting-cobalt-strike-default-modules-via-named-pipe-analysis/" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">Detecting Cobalt Strike Default Modules via Named Pipe Analysis</a>.</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Additionally, we commonly see three methods regularly used by threat actors to download and execute the Cobalt Strike beacon.</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><strong>1. Using PowerShell to load and inject shellcode directly into memory</strong></p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Encrypted PowerShell command with embedded Cobalt Strike SMB beacons:</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://thedfirreport.com/wp-content/uploads/2021/07/image-4.png" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer"><img alt="PowerShell Encoded Command" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-4.png"></a></p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">The PowerShell is base64 encoded. Decoding the PowerShell command, we are presented with the shellcode that will be pushed into memory.</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://thedfirreport.com/wp-content/uploads/2021/07/image-5.png" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer"><img alt="Decoded PowerShell Shellcode" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-5.png"></a></p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">For a detailed analysis of this PowerShell stager, you can checkout the helpful blog post from @Paulsec4 <a data-loc="client/src/pages/BlogPost.tsx:209" href="https://newtonpaul.com/analysing-fileless-malware-cobalt-strike-beacon/#Injecting_into_memory_with_PowerShell" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">here</a>.</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><strong>2. Download to disk and execute manually on the target</strong></p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">In this example, you can see the TrickBot process downloading to disk, and then loading the beacon into memory.</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://thedfirreport.com/wp-content/uploads/2021/07/image-6.png" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer"><img alt="TrickBot Download" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-6.png"></a></p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">The event IDs in this case for Sysmon logs are:</p>
<ul data-loc="client/src/pages/BlogPost.tsx:171" class="list-disc pl-6 mb-4 space-y-2 text-muted-foreground">
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">11 – File Creation</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">7 – Image Loaded</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">1 – Process Creation</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">3 – Network Connection</li>
</ul>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">And for windows Security logs:</p>
<ul data-loc="client/src/pages/BlogPost.tsx:171" class="list-disc pl-6 mb-4 space-y-2 text-muted-foreground">
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">4663 – File Creation</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">4688 – Process Creation <em>(Command Line logging should be explicitly configured as it is not on by default)</em></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">5156 – Network Connection</li>
</ul>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">A recent example of this activity: the malicious Hancitor injected process (svchost.exe) downloaded the Cobalt Strike DLL beacon to disk and then proceeded with allocating a new memory region inside the current rundll32.exe process and loaded it into the memory.</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://thedfirreport.com/wp-content/uploads/2021/07/image-8.png" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer"><img alt="Hancitor Download 1" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-8.png"></a></p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://thedfirreport.com/wp-content/uploads/2021/07/image-9.png" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer"><img alt="Hancitor Download 2" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-9.png"></a></p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><strong>3. Executing the beacon in memory via the initial malware infection</strong></p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">This case is a little bit more difficult to capture. Below is an example where IcedID reached out to two Cobalt Strike servers to download and execute the beacons in memory:</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://thedfirreport.com/wp-content/uploads/2021/07/image-7.png" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer"><img alt="IcedID Beacon Download" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-7.png"></a></p>
<h3 data-loc="client/src/pages/BlogPost.tsx:169" class="text-xl font-bold font-mono mt-6 mb-3">Defense Evasion</h3>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">In every intrusion, we see process injection taking place across the environment. It is mainly used to inject malicious code into a remote process and inject it into lsass.exe to extract credentials from memory. By injecting the malicious payload into a remote process, the threat actors are spawning a new session in the user context that the injected process belongs to. There are many ways in which process injection can be used. You can check out a helpful post by <a data-loc="client/src/pages/BlogPost.tsx:209" href="https://boschko.ca/cobalt-strike-process-injection/" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">Boschko</a> that goes through all the various methods that Cobalt Strike uses.</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Detect the Cobalt Strike default process injection with Sysmon by looking for the below EIDs in consecutive order:</p>
<ul data-loc="client/src/pages/BlogPost.tsx:171" class="list-disc pl-6 mb-4 space-y-2 text-muted-foreground">
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">10 – Process accessed</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">8 – CreateRemoteThread detected</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">3/22 – Network query/DNS query</li>
</ul>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Example process injection on remote process (RuntimeBroker.exe):</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://thedfirreport.com/wp-content/uploads/2021/07/image-10.png" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer"><img alt="Process Injection Example" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-10.png"></a></p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">There are other ways to detect this activity. In other methods of process injection, such as process hollowing, EID 8 will not be present. Unfortunately, it is very difficult to detect this process injection activity via security windows logs without Sysmon to monitor for the event IDs above.</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">An example of multiple process injections across the environment using Cobalt Strike Beacons (Sysmon EID 8):</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://thedfirreport.com/wp-content/uploads/2021/07/image-11.png" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer"><img alt="Multiple Process Injections" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-11.png"></a></p>
<h3 data-loc="client/src/pages/BlogPost.tsx:169" class="text-xl font-bold font-mono mt-6 mb-3">Discovery</h3>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">In every Cobalt Strike occasion that we report, we see threat actors executing reconnaissance commands with the help of the "shell" command. The commands are based on native windows utilities such as nltest.exe, whoami.exe, and net.exe to help with discovery. Red Canary has a detailed article which goes through the reasons that adversaries use native windows tools for domain trust discovery, that article can be found <a data-loc="client/src/pages/BlogPost.tsx:209" href="https://redcanary.com/threat-detection-report/techniques/domain-trust-discovery/" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">here</a>.</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Below are some recent examples from Conti infections; however, these commands remain consistent with other intrusions we track.</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Conti operators executing reconnaissance commands through Cobalt Strike:</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://thedfirreport.com/wp-content/uploads/2021/07/image-12.png" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer"><img alt="Conti Discovery Commands" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-12.png"></a></p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">The most used tools for discovery purposes that threat actors are dropping with the help of Cobalt Strike are AdFind and BloodHound. AdFind is by far the most used among those two. It is also worth mentioning that PowerShell is also used for enumerating the network looking for interesting targets. When it comes to PowerShell, unmodified PowerSploit and PowerView modules are a very common method threat actors are using to collect information.</p>
<h3 data-loc="client/src/pages/BlogPost.tsx:169" class="text-xl font-bold font-mono mt-6 mb-3">Privilege Escalation</h3>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">The most common technique that threat actors use to obtain SYSTEM level privileges is the GetSystem method via named-pipe impersonation.</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Example execution on a target system:</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://thedfirreport.com/wp-content/uploads/2021/07/image-13.png" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer"><img alt="GetSystem Example" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-13.png"></a></p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">There are also other methods for elevating privileges with Cobalt Strike, such as using the "<strong>elevate</strong>" command. The elevate command uses two options to escalate privileges. The first one is the <strong>svc-exe</strong>. It attempts to drop an executable under "c:\windows" and creates a service to run the payload as SYSTEM. The second one is the <strong>uac-token-duplication</strong> method, which attempts to spawn a new elevated process under the context of a non-privileged user with a stolen token of an existed elevated process. However, as mentioned above, the most used method is the named pipe impersonation escalation via "<strong>getsystem</strong>" command. A detailed explanation can be found at the bottom of <a data-loc="client/src/pages/BlogPost.tsx:209" href="https://www.cobaltstrike.com/help-beacon" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">this</a> Cobalt Strike official documentation page.</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">As you can see below, Sysmon generates a lot more logs related to the successful privilege escalation using the "elevate svc-exe" option. In this case, spoolsv.exe is the executable that was dropped by Cobalt Strike to run a payload.</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Sysmon Event IDs:</p>
<ul data-loc="client/src/pages/BlogPost.tsx:171" class="list-disc pl-6 mb-4 space-y-2 text-muted-foreground">
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">11 – File Created</li>
</ul>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://thedfirreport.com/wp-content/uploads/2021/07/image-14.png" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer"><img alt="File Created Event" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-14.png"></a></p>
<ul data-loc="client/src/pages/BlogPost.tsx:171" class="list-disc pl-6 mb-4 space-y-2 text-muted-foreground">
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">1 – Process Create</li>
</ul>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://thedfirreport.com/wp-content/uploads/2021/07/image-15.png" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer"><img alt="Process Create Event" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-15.png"></a></p>
<ul data-loc="client/src/pages/BlogPost.tsx:171" class="list-disc pl-6 mb-4 space-y-2 text-muted-foreground">
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">25 – Process tampering</li>
</ul>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://thedfirreport.com/wp-content/uploads/2021/07/image-16.png" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer"><img alt="Process Tampering Event" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-16.png"></a></p>
<ul data-loc="client/src/pages/BlogPost.tsx:171" class="list-disc pl-6 mb-4 space-y-2 text-muted-foreground">
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">12 &amp; 13 – Registry value set</li>
</ul>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Windows Event IDs:</p>
<ul data-loc="client/src/pages/BlogPost.tsx:171" class="list-disc pl-6 mb-4 space-y-2 text-muted-foreground">
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">Service installation: 4697(Security) and 7045(System)</li>
</ul>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://thedfirreport.com/wp-content/uploads/2021/07/image-17.png" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer"><img alt="Service Installation Event" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-17.png"></a></p>
<ul data-loc="client/src/pages/BlogPost.tsx:171" class="list-disc pl-6 mb-4 space-y-2 text-muted-foreground">
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">Process Creation: 4688</li>
</ul>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://thedfirreport.com/wp-content/uploads/2021/07/image-18.png" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer"><img alt="Process Creation 4688" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-18.png"></a></p>
<h3 data-loc="client/src/pages/BlogPost.tsx:169" class="text-xl font-bold font-mono mt-6 mb-3">Credential Access</h3>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">After getting access to the target using Cobalt Strike, one of the first tasks that operators take is to collect credentials and hashes from LSASS. There are a couple of ways to achieve this with Cobalt Strike. The first one uses the "<strong>hashdump</strong>" command to dump password hashes; the second one uses the command "<strong>logonpasswords</strong>" to dump plaintext credentials and NTLM hashes with Mimikatz.</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Here's an example of accessing LSASS to steal credentials from memory using "<strong>hashdump</strong>" command in Cobalt Strike:</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://thedfirreport.com/wp-content/uploads/2021/07/image-19.png" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer"><img alt="Hashdump LSASS Access" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-19.png"></a></p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Sysmon EIDs 1, 8, 10, 17: <em>(Event ID 8 will not always be present depending on the technique used.)</em></p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">As you can see below, the only Event IDs that we manage to capture using this technique are process creation and process termination events.</p>
<ul data-loc="client/src/pages/BlogPost.tsx:171" class="list-disc pl-6 mb-4 space-y-2 text-muted-foreground">
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">4688 – Process Creation (Rundll32.exe is loading the DLL payload upon execution)</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">4689 – Process Termination</li>
</ul>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://thedfirreport.com/wp-content/uploads/2021/07/image-20.png" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer"><img alt="Process Events Credential Access" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-20.png"></a></p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">We have also seen <a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/AlessandroZ/LaZagne" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">Lazagne</a> being used on occasions to extract credentials from various applications on the target system.</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Cobalt Strike has implemented the DCSync functionality as introduced by <a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/gentilkiwi/mimikatz" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">mimikatz</a>. DCSync uses windows APIs for Active Directory replication to retrieve the NTLM hash for a specific user or all users. To achieve this, the threat actors must have access to a privileged account with domain replication rights (usually a Domain Administrator). By running the <a data-loc="client/src/pages/BlogPost.tsx:209" href="https://www.blacklanternsecurity.com/2020-12-04-DCSync" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">DCSync</a> command, threat actors attempt to masquerade as a domain controller to sync with another domain controller to collect credentials.</p>
<h3 data-loc="client/src/pages/BlogPost.tsx:169" class="text-xl font-bold font-mono mt-6 mb-3">Command and Control</h3>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Cobalt Strike is using GET and POST requests to communicate with the C2 server. The threat actors can choose between HTTP, HTTPS and DNS network communication. When it comes to C2, we typically see HTTP and HTTPS beacons. By default, Cobalt Strike will use GET requests to retrieve information and POST requests to send information back to the server. As explained above, all the default configurations can change with the use of malleable profiles. Even though we don't see this very often, the beacon could also be configured to send back information with GET requests in small chunks. If you want a deep dive into detecting Cobalt Strike CnC, this <a data-loc="client/src/pages/BlogPost.tsx:209" href="https://underdefense.com/how-to-detect-cobaltstrike-command-control-communication/" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">article</a> from UnderDefense is a great resource.</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">The metadata is encrypted with a public key that is injected into the beacon.</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Example of a GET request from Conti ransomware intrusion:</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://thedfirreport.com/wp-content/uploads/2021/07/image-21.png" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer"><img alt="Cobalt Strike GET Request" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-21.png"></a></p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Results of executed commands are sent to the server using POST requests:</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://thedfirreport.com/wp-content/uploads/2021/07/image-22.png" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer"><img alt="Cobalt Strike POST Request" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-22.png"></a></p>
<h2 data-loc="client/src/pages/BlogPost.tsx:168" class="text-2xl font-bold font-mono mt-8 mb-4">Lateral Movement</h2>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Once Cobalt Strike beacons are established, usually minutes later, we see operators moving laterally on servers of interest inside the network. Even though they are generally fast at picking their targets, we infer that their decisions are based on the results from the discovery phase. The most frequent techniques that attackers use for pivoting are:</p>
<ul data-loc="client/src/pages/BlogPost.tsx:171" class="list-disc pl-6 mb-4 space-y-2 text-muted-foreground">
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><strong>SMB/WMI executable transfer and exec</strong></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><strong>Pass the Hash</strong></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><strong>RDP</strong></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><strong>Remote service execution</strong></li>
</ul>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Cobalt Strike can facilitate all the above techniques and even RDP using SOCKS proxy.</p>
<h3 data-loc="client/src/pages/BlogPost.tsx:169" class="text-xl font-bold font-mono mt-6 mb-3">SMB/WMI executable transfer and exec</h3>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">According to telemetry, this method is used the most by threat actors. We see them uploading their executable to their desired host with the "upload" Cobalt Strike command and execute it using the "remote-exec" command as documented in the capabilities section above but it can use psexec, winrm or wmi to execute a command and/or a beacon.</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">This is what we see when the beacon is uploaded using the upload command:</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><img alt="Beacon Upload" src="https://thedfirreport.com/wp-content/uploads/2021/08/6.png"></p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">The following EIDs are created when executing remote-exec:</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><img alt="Remote Exec EIDs" src="https://thedfirreport.com/wp-content/uploads/2021/08/1-12.png"></p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">4697: A service was installed in the system</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><img alt="Service Installed" src="https://thedfirreport.com/wp-content/uploads/2021/08/2-1.png"></p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">4624: Account logged on</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><img alt="Account Logged On" src="https://thedfirreport.com/wp-content/uploads/2021/08/3-2.png"></p>
<h3 data-loc="client/src/pages/BlogPost.tsx:169" class="text-xl font-bold font-mono mt-6 mb-3">Pass the Hash</h3>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Cobalt Strike can use Mimikatz to generate and impersonate a token that can later be used to accomplish tasks in the context of that chosen user resource. The Cobalt Strike beacon can also use this token to interact with network resources and run remote commands.</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">As you can see from the below execution example, executing Pass The Hash via Cobalt Strike will run cmd.exe to pass the token back to the beacon process via a named pipe:</p>
<pre data-loc="client/src/pages/BlogPost.tsx:182" class="bg-muted/50 border rounded-lg p-4 overflow-x-auto mb-6 text-sm"><code data-loc="client/src/pages/BlogPost.tsx:177" class="bg-muted px-1.5 py-0.5 rounded text-sm font-mono text-primary" node="[object Object]">C:\Windows\system32\cmd.exe /c echo 0291f1e69dd &gt; \\.\pipe\82afc1
</code></pre>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">We also see that the beacon interacts with LSASS (Sysmon EID 10). There are many detection opportunities that defenders can take advantage of with the proper endpoint visibility.</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://thedfirreport.com/wp-content/uploads/2021/07/image-24.png" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer"><img alt="Pass the Hash Example" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-24.png"></a></p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Pass the hash can also be detected by looking for:</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><img alt="Pass the Hash Detection" src="https://thedfirreport.com/wp-content/uploads/2021/08/1-11.png"></p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Windows EID 4624:</p>
<ul data-loc="client/src/pages/BlogPost.tsx:171" class="list-disc pl-6 mb-4 space-y-2 text-muted-foreground">
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">Logon Type = 9</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">Authentication Package = Negotiate</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">Logon Process = seclogo</li>
</ul>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">You can read more about detecting Pass The Hash <a data-loc="client/src/pages/BlogPost.tsx:209" href="https://stealthbits.com/blog/how-to-detect-pass-the-hash-attacks/" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">here</a> by Stealthbits and <a data-loc="client/src/pages/BlogPost.tsx:209" href="https://hausec.com/2021/07/26/cobalt-strike-and-tradecraft/" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">here</a> by Hausec.</p>
<h3 data-loc="client/src/pages/BlogPost.tsx:169" class="text-xl font-bold font-mono mt-6 mb-3">SMB remote service execution</h3>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">In the below example, the threat actors executed the "jump psexec" command to create a remote service on the remote machine (DC) and execute the service exe beacon. Cobalt Strike specifies an executable to create the remote service. Before it can do that, it will have to transfer the service executable to the target host. The name of the service executable is created with seven random alphanumeric characters, e.g. "&lt;7-alphanumeric-characters&gt;.exe". This was changed after version 4.1 of Cobalt Strike (<a data-loc="client/src/pages/BlogPost.tsx:209" href="https://www.crowdstrike.com/blog/getting-the-bacon-from-cobalt-strike-beacon/" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">Getting the Bacon from the Beacon</a>).</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">The attacker must have administrative privileges to complete this task.</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><img alt="Jump Psexec" src="https://thedfirreport.com/wp-content/uploads/2021/08/1-5.png"></p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">In the screenshots below you can see the Windows Event IDs that are being generated as a result of this execution. The first screenshot was from the security logs. However, defenders should pay close attention to service creation events as they will be created and deleted:</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><img alt="Security Events 1" src="https://thedfirreport.com/wp-content/uploads/2021/08/2.png"></p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><img alt="Security Events 2" src="https://thedfirreport.com/wp-content/uploads/2021/08/3.png"></p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><img alt="Security Events 3" src="https://thedfirreport.com/wp-content/uploads/2021/08/4-2.png"></p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><img alt="Security Events 4" src="https://thedfirreport.com/wp-content/uploads/2021/08/5.png"></p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Event IDs generated:</p>
<ul data-loc="client/src/pages/BlogPost.tsx:171" class="list-disc pl-6 mb-4 space-y-2 text-muted-foreground">
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">4624: Logon</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">4672: Special Logon</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">4673: Sensitive Privilege Use</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">4688: Process Creation</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">5140: File Share</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">4674: Sensitive Privilege Use</li>
</ul>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Service Creation events:</p>
<ul data-loc="client/src/pages/BlogPost.tsx:171" class="list-disc pl-6 mb-4 space-y-2 text-muted-foreground">
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">4697: A service was installed in the system. (security.evtx)</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">7045: A service was installed in the system. (system.evtx)</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">7034: A service terminated unexpectedly</li>
</ul>
<h2 data-loc="client/src/pages/BlogPost.tsx:168" class="text-2xl font-bold font-mono mt-8 mb-4">Aggressor Scripts</h2>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Even though Cobalt Strike has many features out of the box, it is also highly extensible thanks to the <a data-loc="client/src/pages/BlogPost.tsx:209" href="https://www.cobaltstrike.com/aggressor-script/index.html" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">aggressor scripts</a>. Aggressor scripts allows the operators to script and modify many of Cobalt Strike's features. Operators can quickly load various scripts via the GUI console.</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">In most of the cases we are working on, we observe the execution of discovery commands after the first beacon check-in with its C2 server. These events are very likely to be automated by the threat actors. Below is an example as presented in the official Cobalt Strike documentation page to demonstrate this use case:</p>
<pre data-loc="client/src/pages/BlogPost.tsx:182" class="bg-muted/50 border rounded-lg p-4 overflow-x-auto mb-6 text-sm"><code data-loc="client/src/pages/BlogPost.tsx:177" class="bg-muted px-1.5 py-0.5 rounded text-sm font-mono text-primary" node="[object Object]">on beacon_initial {
    $user = beacon_data($1) ["user"];
    bshell = ($1, "net group \"Domain Admins\" /domain")
    bshell = ($1, "nltest /domain_trusts /all_trusts")
    bshell = ($1, "net localgroup \"Administrators\"")
    bshell = ($1, "nltest /dclist")
}
</code></pre>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><em>(NOTE: The "$1" argument is the id for the beacon.)</em></p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">The above script uses the function "on beacon_initial" to run the specified discovery commands upon initial execution of the beacon. Cobalt Strike has comprehensive documentation on all available <a data-loc="client/src/pages/BlogPost.tsx:209" href="https://www.cobaltstrike.com/aggressor-script/functions.html#" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">functions</a>. Another interesting function is the "alias" function. It creates an alias command in the Beacon console, which can override the default Cobalt Strike commands.</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Searching for "Cobalt Strike aggressor scripts" on google will result in multiple GitHub repositories. These repositories contain a collection of aggressor scripts to share with the open-source community. Threat actors are also utilizing these freely available resources for accomplishing their objectives. Some of the most popular are:</p>
<ul data-loc="client/src/pages/BlogPost.tsx:171" class="list-disc pl-6 mb-4 space-y-2 text-muted-foreground">
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/harleyQu1nn/AggressorScripts" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">https://github.com/harleyQu1nn/AggressorScripts</a></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/timwhitez/Cobalt-Strike-Aggressor-Scripts" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">https://github.com/timwhitez/Cobalt-Strike-Aggressor-Scripts</a></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/Und3rf10w/Aggressor-scripts" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">https://github.com/Und3rf10w/Aggressor-scripts</a></li>
</ul>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">The recent Conti leak was a great insight into their tooling, which included the use of aggressor scripts. One of the most notable scripts Conti is using is the <a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/rsmudge/ZeroLogon-BOF/blob/master/dist/zerologon.cna" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">ZeroLogon BOF script</a> created by Raphael Mudge. The script compiles and runs the ZeroLogon exploit in memory.</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">Another file that we noticed was a collection of multiple aggressor scripts into one. This file was named "enhancement_chain.cna" which included some of the most used aggressor scripts available on GitHub, like the <a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/harleyQu1nn/AggressorScripts/blob/master/AVQuery.cna" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">AV_query</a> script by @r3dQu1nn.</p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground"><img alt="Aggressor Scripts" src="https://thedfirreport.com/wp-content/uploads/2021/08/1-6.png"></p>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">You can find the file <a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/tsale/TA_tooling/blob/main/Conti_enhancement_chain.cna" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">here</a>.</p>
<h2 data-loc="client/src/pages/BlogPost.tsx:168" class="text-2xl font-bold font-mono mt-8 mb-4">Awesome Cobalt Strike Defense</h2>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">To combat Cobalt Strike, the InfoSec community has come together to release tooling, research and detection rules. There are too many to add here, but we don't have to, thanks to the <a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/MichaelKoczwara/Awesome-CobaltStrike-Defence" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">Awesome-CobaltStrike-Defence</a> GitHub repository. It contains multiple sources that help defenders hunt, detect and prevent Cobalt Strike. The repository is maintained by <a data-loc="client/src/pages/BlogPost.tsx:209" href="https://twitter.com/MichalKoczwara" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">MichaelKoczwara</a>, <a data-loc="client/src/pages/BlogPost.tsx:209" href="https://twitter.com/wlesicki" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">WojciechLesicki</a> and <a data-loc="client/src/pages/BlogPost.tsx:209" href="https://twitter.com/bh4b3sh" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">d4rk-d4nph3</a>.</p>
<h2 data-loc="client/src/pages/BlogPost.tsx:168" class="text-2xl font-bold font-mono mt-8 mb-4">Useful Open Source Information</h2>
<ul data-loc="client/src/pages/BlogPost.tsx:171" class="list-disc pl-6 mb-4 space-y-2 text-muted-foreground">
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://www.mandiant.com/resources/defining-cobalt-strike-components" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">Defining Cobalt Strike Components So You Can BEA-CONfident in Your Analysis</a></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/JPCERTCC/aa-tools/blob/master/cobaltstrikescan.py" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">Volatility plugin for detecting Cobalt Strike Beacon and extracting its config</a></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://blog.didierstevens.com/2020/11/07/1768-k/" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">Didier Stevens – Python script to decode and dump the config of Cobalt Strike beacon</a></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://redcanary.com/threat-detection-report/threats/cobalt-strike/" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">Detection opportunities by Tony Lambert and Red Canary</a></li>
</ul>
<h2 data-loc="client/src/pages/BlogPost.tsx:168" class="text-2xl font-bold font-mono mt-8 mb-4">Sigma Rules</h2>
<ul data-loc="client/src/pages/BlogPost.tsx:171" class="list-disc pl-6 mb-4 space-y-2 text-muted-foreground">
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/SigmaHQ/sigma/blob/c56cd2dfff6343f3694ef4fd606a305415599737/rules/windows/process_creation/win_meterpreter_or_cobaltstrike_getsystem_service_start.yml" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">Meterpreter or Cobalt Strike Getsystem Service Installation</a></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/pipe_created/sysmon_mal_cobaltstrike.yml" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">CobaltStrike Named Pipe</a></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/SigmaHQ/sigma/blob/c56cd2dfff6343f3694ef4fd606a305415599737/rules/windows/process_creation/win_meterpreter_or_cobaltstrike_getsystem_service_start.yml" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">Meterpreter or Cobalt Strike Getsystem Service Start</a></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_susp_adfind.yml" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">Suspicious AdFind Execution</a></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_susp_powershell_enc_cmd.yml" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">Suspicious Encoded PowerShell Command Line</a></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/sysmon_rundll32_net_connections.yml" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">Rundll32 Internet Connection</a></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/SigmaHQ/sigma/blob/c56cd2dfff6343f3694ef4fd606a305415599737/rules/network/net_dns_c2_detection.yml" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">Possible DNS Tunneling</a></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/SigmaHQ/sigma/blob/c56cd2dfff6343f3694ef4fd606a305415599737/rules/windows/builtin/win_overpass_the_hash.yml" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">Successful Overpass the Hash Attempt</a></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/win_cobaltstrike_service_installs.yml" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">Service Installs</a></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/create_remote_thread/sysmon_cobaltstrike_process_injection.yml" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">Process Injection</a></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/process_creation_cobaltstrike_load_by_rundll32.yml" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">Process Creation Cobalt Strike load by rundll32</a></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry_event/sysmon_cobaltstrike_service_installs.yml" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">Sysmon Cobalt Strike Service Installs</a></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_susp_wmic_proc_create_rundll32.yml" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">Suspicious WMI Execution Using Rundll32</a></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/SigmaHQ/sigma/blob/e7d9f1b4279a235406b61cc9c16fde9d7ab5e3ba/rules/windows/create_remote_thread/sysmon_suspicious_remote_thread.yml" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">Suspicious Remote Thread Created</a></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/SigmaHQ/sigma/blob/7f071d785157dfe185d845fad994aa6ec05ac678/rules/windows/network_connection/sysmon_powershell_network_connection.yml" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">PowerShell Network Connections</a></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rules/windows/process_creation/win_susp_powershell_hidden_b64_cmd.yml" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">Malicious Base64 Encoded PowerShell Keywords in Command Lines</a></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/SigmaHQ/sigma/blob/eb382c4a59b6d87e186ee269805fe2db2acf250e/rules/network/net_susp_dns_b64_queries.yml" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">Suspicious DNS Query with B64 Encoded String</a></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/SigmaHQ/sigma/blob/eb382c4a59b6d87e186ee269805fe2db2acf250e/rules/network/zeek/zeek_default_cobalt_strike_certificate.yml" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">Default Cobalt Strike Certificate</a></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/SigmaHQ/sigma/blob/eb382c4a59b6d87e186ee269805fe2db2acf250e/rules/network/net_high_txt_records_requests_rate.yml" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">High TXT Records Requests Rate</a></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/SigmaHQ/sigma/blob/master/rules/network/net_mal_dns_cobaltstrike.yml" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">Cobalt Strike DNS Beaconing</a></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/SigmaHQ/sigma/blob/master/rules/proxy/proxy_cobalt_amazon.yml" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">CobaltStrike Malleable Amazon Browsing Traffic Profile</a></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/SigmaHQ/sigma/blob/master/rules/proxy/proxy_cobalt_malformed_uas.yml" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">CobaltStrike Malformed UAs in Malleable Profiles</a></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/SigmaHQ/sigma/blob/master/rules/proxy/proxy_cobalt_ocsp.yml" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">CobaltStrike Malleable (OCSP) Profile</a></li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground"><a data-loc="client/src/pages/BlogPost.tsx:209" href="https://github.com/SigmaHQ/sigma/blob/master/rules/proxy/proxy_cobalt_onedrive.yml" class="text-primary hover:underline" target="_blank" rel="noopener noreferrer">CobaltStrike Malleable OneDrive Browsing Traffic Profile</a></li>
</ul>
<h2 data-loc="client/src/pages/BlogPost.tsx:168" class="text-2xl font-bold font-mono mt-8 mb-4">Suricata Rules</h2>
<p data-loc="client/src/pages/BlogPost.tsx:170" class="mb-4 leading-relaxed text-muted-foreground">The following Suricata/ET rules can help detect Cobalt Strike activity:</p>
<ul data-loc="client/src/pages/BlogPost.tsx:171" class="list-disc pl-6 mb-4 space-y-2 text-muted-foreground">
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">ET INFO Suspicious Empty SSL Certificate – Observed in Cobalt Strike</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">ET MALWARE Cobalt Strike Beacon Activity (GET)</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">ET MALWARE Cobalt Strike Malleable C2 Profile wordpress_ Cookie Test</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">ETPRO TROJAN Cobalt Strike Beacon Observed</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">ETPRO TROJAN Cobalt Strike CnC Beacon</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">ETPRO TROJAN Cobalt Strike Covert DNS CnC Channel TXT Lookup (tcp)</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">ETPRO TROJAN Cobalt Strike Covert DNS CnC Channel TXT Lookup (udp)</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">ETPRO TROJAN Cobalt Strike DNS CnC Activity</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">ETPRO TROJAN CobaltStrike Malleable C2 Activity (OCSP Profile)</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">ETPRO TROJAN Cobalt Strike Malleable C2 JQuery Custom Profile</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">ETPRO TROJAN Cobalt Strike Malleable C2 JQuery Custom Profile M2</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">ETPRO TROJAN Cobalt Strike Malleable C2 (Unknown Profile)</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">ETPRO TROJAN Cobalt Strike Malleable JQuery Custom Profile M4</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">ETPRO TROJAN Cobalt Strike Trial HTTP Response Header (EICAR)</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">ETPRO TROJAN Cobalt Strike Trial HTTP Response Header (X-Malware)</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">ET TROJAN Cobalt Strike Activity</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">ET TROJAN Cobalt Strike Beacon Activity</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">ET TROJAN Cobalt Strike Malleable C2 JQuery Custom Profile Response</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">ET TROJAN Cobalt Strike Malleable C2 Amazon Profile</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">ET TROJAN Cobalt Strike Malleable C2 (Meterpreter)</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">ET TROJAN Cobalt Strike Malleable C2 (Microsoft Update GET)</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">ET TROJAN Cobalt Strike Malleable C2 OCSP Profile</li>
<li data-loc="client/src/pages/BlogPost.tsx:173" class="text-muted-foreground">ET TROJAN Cobalt Strike Malleable C2 (OneDrive)</li>
</ul></article><div data-loc="client/src/pages/BlogPost.tsx:219" class="border-t border-b py-8 mb-12" style="opacity: 0; transform: none;"><div data-loc="client/src/pages/BlogPost.tsx:225" class="flex flex-col sm:flex-row items-center justify-between gap-4"><div data-loc="client/src/pages/BlogPost.tsx:226" class="text-center sm:text-left"><p data-loc="client/src/pages/BlogPost.tsx:227" class="text-lg font-mono mb-1">Did you find this article helpful?</p><p data-loc="client/src/pages/BlogPost.tsx:228" class="text-sm text-muted-foreground">Show your appreciation! You can give up to 50 more stars.</p></div><button data-loc="client/src/pages/BlogPost.tsx:235" data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*='size-'])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive border bg-transparent shadow-xs hover:bg-accent dark:bg-transparent dark:border-input dark:hover:bg-input/50 h-10 rounded-md px-6 has-[>svg]:px-4 font-mono gap-2 min-w-[140px]"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-star h-5 w-5 " data-loc="client/src/pages/BlogPost.tsx:242"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon></svg><span data-loc="client/src/pages/BlogPost.tsx:243">15</span></button></div></div><div data-loc="client/src/pages/BlogPost.tsx:253" class="flex justify-center mb-12" style="opacity: 0; transform: none;"><a data-loc="client/src/pages/BlogPost.tsx:259" href="https://www.buymeacoffee.com/kostas.t" target="_blank" rel="noopener noreferrer" class="opacity-80 hover:opacity-100 transition-opacity"><img data-loc="client/src/pages/BlogPost.tsx:260" alt="Buy me a coffee" class="h-10" src="https://img.buymeacoffee.com/button-api/?text=Buy%20me%20a%20coffee&amp;emoji=%E2%98%95&amp;slug=kostas.t&amp;button_colour=5F7FFF&amp;font_colour=ffffff&amp;font_family=Cookie&amp;outline_colour=000000&amp;coffee_colour=FFDD00"></a></div><div data-loc="client/src/pages/BlogPost.tsx:264" style="opacity: 0; transform: translateY(0.467357px);"><div data-loc="client/src/components/NewsletterSignup.tsx:57" data-slot="card" class="text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm bg-primary/5 border-primary/20"><div data-loc="client/src/components/NewsletterSignup.tsx:58" data-slot="card-header" class="@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6 text-center"><div data-loc="client/src/components/NewsletterSignup.tsx:59" class="mx-auto bg-primary/10 rounded-full p-3 w-fit mb-4"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-mail h-6 w-6 text-primary" data-loc="client/src/components/NewsletterSignup.tsx:60"><rect width="20" height="16" x="2" y="4" rx="2"></rect><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path></svg></div><div data-loc="client/src/components/NewsletterSignup.tsx:62" data-slot="card-title" class="font-semibold font-mono text-2xl">Stay Updated</div><div data-loc="client/src/components/NewsletterSignup.tsx:63" data-slot="card-description" class="text-muted-foreground text-sm">Subscribe to get notified when new security articles and tutorials are published.</div></div><div data-loc="client/src/components/NewsletterSignup.tsx:67" data-slot="card-content" class="px-6"><form data-loc="client/src/components/NewsletterSignup.tsx:68" class="space-y-4"><div data-loc="client/src/components/NewsletterSignup.tsx:69" class="flex flex-col sm:flex-row gap-3"><input data-loc="client/src/components/NewsletterSignup.tsx:70" data-slot="input" class="file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive bg-background" placeholder="Your name (optional)" type="text" value=""><input data-loc="client/src/components/NewsletterSignup.tsx:77" data-slot="input" class="file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive bg-background" placeholder="Your email" required="" type="email" value=""></div><button data-loc="client/src/components/NewsletterSignup.tsx:86" data-slot="button" class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*='size-'])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive bg-primary text-primary-foreground hover:bg-primary/90 h-9 px-4 py-2 has-[>svg]:px-3 w-full font-mono" type="submit" disabled="">Subscribe to Newsletter</button><p data-loc="client/src/components/NewsletterSignup.tsx:100" class="text-xs text-center text-muted-foreground">No spam, ever. Unsubscribe at any time.</p></form></div></div></div></div></div></main></div></div>
  


<div id="manus-previewer-root" data-manus-selector-input="true"><div data-loc="src/ContentRoot.tsx:8" id="manus-previewer-content-root" class="z-[999999] relative"></div></div></body></html>