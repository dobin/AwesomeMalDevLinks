Title:
Cheesing Microsoft Attack Surface Reduction rules

Type:
Blog Post

Short Summary (4–8 sentences max):
- The post explains Microsoft Defender Attack Surface Reduction (ASR) rules and focuses on practical ways attackers/red teamers bypass the disruptive rule “Block executable files from running unless they meet a prevalence, age, or trusted list criteria” (01443614-cd74-433a-b99e-2ecdc07bfc25).  
- It highlights how ASR “exclusions” can be abused, especially when exclusions point to user-writable paths or specific filenames.  
- A key technique is enumerating ASR exclusions as a low-privileged user by reading Windows Defender Operational event logs (Event ID 5007), which record registry changes under ASR exclusion keys.  
- It also covers bypassing the rule via DLL sideloading using trusted/signed binaries to load a malicious proxy DLL, and briefly mentions code signing with leaked certificates to satisfy trust/prevalence checks.  
- The author provides a PowerShell-based approach (and references the PrimusASR repo) to automate discovery of enabled rules and exclusions.  
- Useful for red teams/pentesters to regain on-disk execution under ASR, and for blue teams to understand exposure and harden log access and exclusion hygiene.

Technical Focus:
- Microsoft Defender ASR rules and modes (Block/Audit/Warn)
- ASR exclusion abuse (path/filename-based allowlisting)
- Windows Defender Operational event log parsing (Event ID 5007)
- Registry paths for ASR exclusions (Exploit Guard ASR keys)
- DLL sideloading / proxy DLL export forwarding
- Code signing with SignTool and certificate trust/prevalence behavior

Use Cases:
- Identify ASR exclusions without admin rights to run tooling from allowed locations/names
- Rapid host triage to determine which ASR rules are enabled and their enforcement state
- Execute payloads by pairing trusted binaries with malicious sideloaded DLLs
- Assess organizational ASR configuration weaknesses (overbroad/writable exclusions)
- Defensive validation: detect/limit exposure of ASR configuration via event log access

Keywords:
Microsoft Defender, Attack Surface Reduction, ASR, Exploit Guard, 01443614-cd74-433a-b99e-2ecdc07bfc25, ASROnlyExclusions, Event ID 5007, Microsoft-Windows-Windows Defender/Operational, Windows Event Logs, Get-MpPreference, registry, HKLM, allowlist, exclusions, DLL sideloading, proxy DLL, Procmon, code signing, SignTool.exe, leaked certificate