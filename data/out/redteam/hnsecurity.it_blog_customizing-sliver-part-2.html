# https://hnsecurity.it/blog/customizing-sliver-part-2/

<!DOCTYPE html><html class="no-touch webkit chrome chrome142 linux js no-hidpi screen-lg screen-md screen-sm screen-xs screen-xxs orientation_landscape datauri lenis" lang="en-US" xmlns="http://www.w3.org/1999/xhtml">
<body class="wp-singular post-template-default single single-post postid-2543 single-format-standard wp-theme-uncode wp-child-theme-uncode-child style-color-wayh-bg cookies-not-set group-blog hormenu-position-left megamenu-full-submenu hmenu hmenu-position-center header-full-width main-center-align menu-mobile-transparent menu-custom-padding menu-sticky-mobile menu-mobile-centered menu-mobile-off-canvas mobile-parallax-not-allowed ilb-no-bounce unreg qw-body-scroll-disabled megamenu-side-to-side no-qty-fx uncode-accessible wpb-js-composer js-comp-ver-8.7.1.2 vc_responsive uncode-loaded" data-border="0" style="margin-top: 0px; padding-top: 0px;">

		<a href="https://hnsecurity.it/blog/customizing-sliver-part-2/#sections-container" class="screen-reader-shortcut btn btn-hover-nobg btn-accent btn-shadow btn-shadow-lg">Skip to main content</a>
			<div id="vh_layout_help"></div><div class="body-borders" data-border="0"><div class="top-border body-border-shadow"></div><div class="right-border body-border-shadow"></div><div class="bottom-border body-border-shadow"></div><div class="left-border body-border-shadow"></div><div class="top-border style-color-xsdn-bg"></div><div class="right-border style-color-xsdn-bg"></div><div class="bottom-border style-color-xsdn-bg"></div><div class="left-border style-color-xsdn-bg"></div></div>	<div class="box-wrapper">
		<div class="box-container" style="width: 1920px; margin-left: -0.5px;">
		
		<div class="menu-wrapper menu-sticky-mobile menu-no-arrows no-header" style="height: 957px;">
													
													
												</div>			
						<div class="main-wrapper">
				<div class="main-container">
					<div class="page-wrapper" role="main">
						<div class="sections-container" id="sections-container">
<article id="post-2543" class="page-body style-color-xsdn-bg post-2543 post type-post status-publish format-standard has-post-thumbnail hentry category-articles category-tools tag-c2 tag-red-teaming tag-sliver tag-golang tag-windows">
          <div class="post-wrapper">
          	<div class="post-body"><div class="post-content un-no-sidebar-layout"><div data-parent="true" class="vc_row has-bg need-focus style-color-wayh-bg row-container" id="row-unique-0"><div class="row-background background-element">
											<div class="background-wrapper">
												<div class="background-inner srcset-bg srcset-bg-async srcset-bg-init" style="background-repeat: no-repeat; background-position: center top; background-attachment: scroll; background-size: cover; background-image: url(&quot;https://hnsecurity.it/wp-content/uploads/2025/07/195503.jpg&quot;);" data-background-image="https://hnsecurity.it/wp-content/uploads/2025/07/195503.jpg" data-mobile-background-image="https://hnsecurity.it/wp-content/uploads/2025/07/195503-uai-900x507.jpg"></div>
												
											</div>
										</div><div class="row double-top-padding double-bottom-padding single-h-padding limit-width row-parent" data-imgready="true"><div class="wpb_row row-inner"><div class="wpb_column pos-middle pos-center align_center column_parent col-lg-12 single-internal-gutter"><div class="uncol style-light"><div class="uncoltable"><div class="uncell no-block-padding"><div class="uncont"><div class="uncode-single-media  text-center animate_when_almost_visible zoom-in"><div class="single-wrapper" style="max-width: 200px;"><div class="tmb tmb-light  img-circle tmb-bordered tmb-shadowed tmb-shadowed-darker-std tmb-img-ratio tmb-media-first tmb-media-last tmb-content-overlay tmb-no-bg"><div class="t-inside"><div class="t-entry-visual"><div class="t-entry-visual-tc"><div class="uncode-single-media-wrapper img-circle img-thumbnail"><div class="dummy" style="padding-top: 100%;"></div><img decoding="async" class="srcset-auto wp-image-159957 srcset-sizes-done" src="https://hnsecurity.it/wp-content/uploads/2025/09/SILVER-uai-836x836.jpg" width="836" height="836" alt="Silver Framework logo" data-no-bp="" data-bp="720" data-uniqueid="159957-106083" data-guid="https://hnsecurity.it/wp-content/uploads/2025/09/SILVER.jpg" data-path="2025/09/SILVER.jpg" data-width="1600" data-height="836" data-singlew="200" data-singleh="200" data-crop="1" loading="lazy"></div>
					</div>
				</div></div></div></div></div><div class="vc_custom_heading_wrap "><div class="heading-text el-text"><h1 class="h2 text-color-lxmt-color"><span>Customizing Sliver – Part 2</span></h1></div><div class="clear"></div></div></div></div></div></div></div></div></div></div><div data-parent="true" class="vc_row row-container" id="row-unique-1"><div class="row limit-width row-parent" data-imgready="true"><div class="wpb_row row-inner"><div class="wpb_column pos-top pos-center align_left column_parent col-lg-6 single-internal-gutter"><div class="uncol style-light"><div class="uncoltable"><div class="uncell no-block-padding"><div class="uncont"><div class="uncode-info-box  font-weight-500"><span class="date-info">October 24, 2023</span><span class="uncode-ib-separator uncode-ib-separator-symbol">|</span><span class="author-wrap"><a href="https://hnsecurity.it/blog/author/ale98/"><span class="uncode-ib-avatar uncode-ib-avatar-size-md"><img alt="Alessandro Iandoli" src="https://secure.gravatar.com/avatar/644822f5d8329ca419a50c1f39c97de5ccd163d1932e4cdc60a6cc8cb64ed29e?s=40&amp;d=mm&amp;r=g" class="avatar avatar-40 photo" height="40" width="40" loading="lazy" decoding="async"></span></a><span class="author-info">By <a href="https://hnsecurity.it/blog/author/ale98/">Alessandro Iandoli</a></span></span></div></div></div></div></div></div><div class="wpb_column pos-top pos-center align_right align_left_tablet align_left_mobile column_parent col-lg-6 single-internal-gutter"><div class="uncol style-light"><div class="uncoltable"><div class="uncell no-block-padding"><div class="uncont"><div class="uncode-info-box container-text font-weight-500"><span class="category-info"> <a href="https://hnsecurity.it/blog/category/articles/" title="View all posts in Articles" class="">Articles</a>, <a href="https://hnsecurity.it/blog/category/tools/" title="View all posts in Tools" class="">Tools</a></span></div></div></div></div></div></div></div></div></div><div data-parent="true" class="vc_row has-bg need-focus style-color-xsdn-bg row-container" id="row-unique-2"><div class="row no-top-padding double-bottom-padding single-h-padding limit-width row-parent" data-imgready="true"><div class="wpb_row row-inner"><div class="wpb_column pos-top pos-center align_left column_parent col-lg-12 custom-tag-box single-internal-gutter"><div class="uncol style-light"><div class="uncoltable"><div class="uncell  vc_custom_1758437089857 no-block-padding" style="padding-top: 0px ;"><div class="uncont"><div class="uncode_text_column container-text"><p class="graf graf--p">Hello! This is the second part of the three-part blog <a href="https://hnsecurity.it/tag/sliver/">series</a> explaining how to customize <a href="https://github.com/BishopFox/sliver">Sliver C2</a> by adding your own commands.</p>
<p class="graf graf--p">In this part I’m going to provide an <strong>overview of the communication model</strong> in Sliver C2, by examining the flow of function calls performed by the components when an operator launches a command.</p>
<p class="graf graf--p">In <a href="https://hnsecurity.it/blog/customizing-sliver-part-3/">part 3</a>, I’ll provide a tutorial showing how to create the first simple command from scratch in Sliver C2.</p>
<h2 class="graf graf--h3">Communication model overview</h2>
<p class="graf graf--p">As explained <a href="https://github.com/BishopFox/sliver/wiki/Architecture">here</a>, Sliver works in the following way:</p>
<figure class="graf graf--figure">
<p></p><figure style="width: 828px" class="wp-caption aligncenter"><img fetchpriority="high" decoding="async" class="graf-image" src="https://cdn-images-1.medium.com/max/1000/1*yv3zWNq_EK4QPUU9fqAEng.png" alt="" width="828" height="151" data-image-id="1*yv3zWNq_EK4QPUU9fqAEng.png" data-width="828" data-height="151"><figcaption class="wp-caption-text">Communication model diagram</figcaption></figure><figcaption class="imageCaption">1. When the operator types a command in the console, the client serializes the command in a protobuf request and sends it, through gRPC, to the server.<p></p>
<p class="graf graf--p">2. The server processes the message and forwards the protobuf request to the implant, through the <strong class="markup--strong markup--p-strong">communication channel</strong> <strong class="markup--strong markup--p-strong">in use with the implant</strong> (could be HTTP/S, DNS, Wireguard; in the diagram above it’s HTTP).</p>
<p class="graf graf--p">3. The implant <strong class="markup--strong markup--p-strong">unserializes </strong>the protobuf request, executes the specified task, <strong class="markup--strong markup--p-strong">serializes the output</strong> again in a<strong class="markup--strong markup--p-strong"> protobuf message</strong>, and sends it to the server through the <strong class="markup--strong markup--p-strong">same communication channel used at step 2</strong>.</p>
<p class="graf graf--p">4. The server receives the protobuf response and forwards it to the client through <strong class="markup--strong markup--p-strong">gRPC</strong>. At this point the client simply unserializes the <strong class="markup--strong markup--p-strong">protobuf response </strong>and prints the output to the screen.</p>
</figcaption></figure>
<h3 class="graf graf--h4">Client-server communication</h3>
<p>The <strong>services.proto </strong>file, by importing <strong class="markup--strong markup--p-strong">client.proto</strong> and <strong class="markup--strong markup--p-strong">sliver.proto, </strong>defines The<strong class="markup--strong markup--p-strong"> gRPC messages</strong> <strong class="markup--strong markup--p-strong">and methods </strong>exchanged between client and server.</p>
<p class="graf graf--p">The client stores all the commands in <a href="https://github.com/BishopFox/sliver/blob/master/client/command/sliver.go">client/command/sliver.go</a>. All commands stored in the file will call functions defined under <strong class="markup--strong markup--p-strong">client/command/&lt;command folder&gt;/&lt;command_name&gt;.go</strong>. For example, sliver.go defines the command <strong class="markup--strong markup--p-strong">execute-assembly</strong>, that when typed in by the operator, invokes function <strong class="markup--strong markup--p-strong">ExecuteAssemblyCmd()</strong>, defined in <a href="https://github.com/BishopFox/sliver/blob/master/client/command/exec/execute-assembly.go">client/command/exec/execute-assembly.go</a>.</p>
<p class="graf graf--p">All these functions will end up calling <strong class="markup--strong markup--p-strong">gRPC functions</strong> defined in <a href="https://github.com/BishopFox/sliver/blob/master/protobuf/rpcpb/services.proto">services.proto</a>. For example, <strong class="markup--strong markup--p-strong">ExecuteAssemblyCmd() </strong>calls <strong class="markup--strong markup--p-strong">con.Rpc.ExecuteAssembly() </strong>defined in services.proto.</p>
<figure class="graf graf--figure">
<p></p><figure style="width: 1000px" class="wp-caption aligncenter"><img decoding="async" class="graf-image" src="https://cdn-images-1.medium.com/max/1000/1*2DWIHeNftjljtKCLNncPYQ.png" alt="" width="1000" height="370" data-image-id="1*2DWIHeNftjljtKCLNncPYQ.png" data-width="1816" data-height="672"><figcaption class="wp-caption-text">Mapping between con.Rpc.ExecuteAssembly() and definition in services.proto</figcaption></figure></figure>
<p>Actually, <a href="https://github.com/BishopFox/sliver/blob/master/protobuf/rpcpb/services_grpc.pb.go">services_grpc.pb.go</a>&nbsp;defines <strong class="markup--strong markup--p-strong">con.Rpc.ExecuteAssembly()</strong>. <strong>Protoc</strong> automatically builds the file services_grpc.pb.go starting from the definitions inside services.proto.</p>
<p class="graf graf--p"><em class="markup--em markup--p-em">As I’ll outline later, we will only have to </em><strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">modify services.proto, sliver.proto, and client.proto and then rebuild services_grpc.pb.go</em></strong><em class="markup--em markup--p-em"> by just running <strong>m</strong></em><strong><em class="markup--em markup--p-em">ake pb</em></strong><em class="markup--em markup--p-em">&nbsp;, in order to add our custom commands.</em></p>
<p class="graf graf--p">These gRPC functions send protobuf messages to the server through gRPC, where <a href="https://github.com/BishopFox/sliver/tree/master/server/rpc">server/rpc/rpc-*.go</a> defines the corresponding server-side handlers for these gRPC functions. For example, <a href="https://github.com/BishopFox/sliver/blob/master/server/rpc/rpc-tasks.go">server/rpc/rpc-tasks.go</a> defines <a href="https://github.com/BishopFox/sliver/blob/master/server/rpc/rpc-tasks.go#L127">ExecuteAssembly()</a>, the server-side function that handles the <strong class="markup--strong markup--p-strong">con.Rpc.ExecuteAssembly() </strong>request performed by the client.</p>
<p class="graf graf--p">These server functions handling the gRPC requests will perform the required processing and then send the response with the statement:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-go enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-k0">return</span><span class="enlighter-text"> resp, </span><span class="enlighter-e1">nil</span></div></div></div><div class="enlighter-raw">return resp, nil</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="golang">return resp, nil</pre>
<p class="graf graf--p">For the <strong class="markup--strong markup--p-strong">ExecuteAssembly() </strong>handler function, this sends a protobuf message to the implant and then returns the response, as we will see in the following section.</p>
<h3 class="graf graf--h4">Server-implant communication</h3>
<p>The <strong>sliver.proto</strong> file defines the messages that are exchanged between server and implant. Server and implant exchange these messages not through gRPC but through HTTP/S, DNS depending on how the implant was generated, as previously mentioned.</p>
<p class="graf graf--p">Let’s inspect the function <a href="https://github.com/BishopFox/sliver/blob/master/server/rpc/rpc-tasks.go#L127">ExecuteAssembly()</a> in order to explain what the server is going to do in this case:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-go enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-c0">// ExecuteAssembly - Execute a .NET assembly on the remote system in-memory (Windows only)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">func</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">rpc *Server</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-m0">ExecuteAssembly</span><span class="enlighter-g1">(</span><span class="enlighter-text">ctx context.</span><span class="enlighter-m3">Context</span><span class="enlighter-text">, req *sliverpb.</span><span class="enlighter-m3">ExecuteAssemblyReq</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">*sliverpb.</span><span class="enlighter-m3">ExecuteAssembly</span><span class="enlighter-text">, error</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-k2">var</span><span class="enlighter-text"> session *core.</span><span class="enlighter-m3">Session</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-k2">var</span><span class="enlighter-text"> beacon *models.</span><span class="enlighter-m3">Beacon</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-k2">var</span><span class="enlighter-text"> err error</span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-k1">if</span><span class="enlighter-text"> !req.</span><span class="enlighter-m3">Request</span><span class="enlighter-text">.</span><span class="enlighter-m3">Async</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  session = core.</span><span class="enlighter-m3">Sessions</span><span class="enlighter-text">.</span><span class="enlighter-m3">Get</span><span class="enlighter-g1">(</span><span class="enlighter-text">req.</span><span class="enlighter-m3">Request</span><span class="enlighter-text">.</span><span class="enlighter-m3">SessionID</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-k1">if</span><span class="enlighter-text"> session == </span><span class="enlighter-e1">nil</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">   </span><span class="enlighter-k0">return</span><span class="enlighter-text"> </span><span class="enlighter-e1">nil</span><span class="enlighter-text">, ErrInvalidSessionID</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span><span class="enlighter-k1">else</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  beacon, err = db.</span><span class="enlighter-m3">BeaconByID</span><span class="enlighter-g1">(</span><span class="enlighter-text">req.</span><span class="enlighter-m3">Request</span><span class="enlighter-text">.</span><span class="enlighter-m3">BeaconID</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-k1">if</span><span class="enlighter-text"> err != </span><span class="enlighter-e1">nil</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">   tasksLog.</span><span class="enlighter-m3">Errorf</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"%s"</span><span class="enlighter-text">, err</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">   </span><span class="enlighter-k0">return</span><span class="enlighter-text"> </span><span class="enlighter-e1">nil</span><span class="enlighter-text">, ErrDatabaseFailure</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-k1">if</span><span class="enlighter-text"> beacon == </span><span class="enlighter-e1">nil</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">   </span><span class="enlighter-k0">return</span><span class="enlighter-text"> </span><span class="enlighter-e1">nil</span><span class="enlighter-text">, ErrInvalidBeaconID</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> shellcode, err := generate.</span><span class="enlighter-m3">DonutFromAssembly</span><span class="enlighter-g1">(</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  req.</span><span class="enlighter-m3">Assembly</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  req.</span><span class="enlighter-m3">IsDLL</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  req.</span><span class="enlighter-m3">Arch</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  req.</span><span class="enlighter-m3">Arguments</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  req.</span><span class="enlighter-m3">Method</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  req.</span><span class="enlighter-m3">ClassName</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  req.</span><span class="enlighter-m3">AppDomain</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-k1">if</span><span class="enlighter-text"> err != </span><span class="enlighter-e1">nil</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  tasksLog.</span><span class="enlighter-m3">Errorf</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"Execute assembly failed: %s"</span><span class="enlighter-text">, err</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-k0">return</span><span class="enlighter-text"> </span><span class="enlighter-e1">nil</span><span class="enlighter-text">, err</span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> resp := &amp;sliverpb.</span><span class="enlighter-m3">ExecuteAssembly</span><span class="enlighter-g1">{</span><span class="enlighter-text">Response: &amp;commonpb.</span><span class="enlighter-m3">Response</span><span class="enlighter-g1">{}}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-k1">if</span><span class="enlighter-text"> req.</span><span class="enlighter-m3">InProcess</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  tasksLog.</span><span class="enlighter-m3">Infof</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"Executing assembly in-process"</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  invokeInProcExecAssembly := &amp;sliverpb.</span><span class="enlighter-m3">InvokeInProcExecuteAssemblyReq</span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">   Data:       req.</span><span class="enlighter-m3">Assembly</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">   Runtime:    req.</span><span class="enlighter-m3">Runtime</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">   Arguments:  strings.</span><span class="enlighter-m3">Split</span><span class="enlighter-g1">(</span><span class="enlighter-text">req.</span><span class="enlighter-m3">Arguments</span><span class="enlighter-text">, </span><span class="enlighter-s0">" "</span><span class="enlighter-g1">)</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">   AmsiBypass: req.</span><span class="enlighter-m3">AmsiBypass</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">   EtwBypass:  req.</span><span class="enlighter-m3">EtwBypass</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">   Request:    req.</span><span class="enlighter-m3">Request</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  err = rpc.</span><span class="enlighter-m3">GenericHandler</span><span class="enlighter-g1">(</span><span class="enlighter-text">invokeInProcExecAssembly, resp</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span><span class="enlighter-k1">else</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  invokeExecAssembly := &amp;sliverpb.</span><span class="enlighter-m3">InvokeExecuteAssemblyReq</span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">   Data:        shellcode,</span></div></div><div class=""><div><span class="enlighter-text">   Process:     req.</span><span class="enlighter-m3">Process</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">   Request:     req.</span><span class="enlighter-m3">Request</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">   PPid:        req.</span><span class="enlighter-m3">PPid</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">   ProcessArgs: req.</span><span class="enlighter-m3">ProcessArgs</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  err = rpc.</span><span class="enlighter-m3">GenericHandler</span><span class="enlighter-g1">(</span><span class="enlighter-text">invokeExecAssembly, resp</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-k1">if</span><span class="enlighter-text"> err != </span><span class="enlighter-e1">nil</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-k0">return</span><span class="enlighter-text"> </span><span class="enlighter-e1">nil</span><span class="enlighter-text">, err</span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-k0">return</span><span class="enlighter-text"> resp, </span><span class="enlighter-e1">nil</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}&lt;</span><span class="enlighter-text">span class=</span><span class="enlighter-s0">"pre--content"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/span</span><span class="enlighter-g1">&gt;</span></div></div></div><div class="enlighter-raw">// ExecuteAssembly - Execute a .NET assembly on the remote system in-memory (Windows only)
func (rpc *Server) ExecuteAssembly(ctx context.Context, req *sliverpb.ExecuteAssemblyReq) (*sliverpb.ExecuteAssembly, error) {
 var session *core.Session
 var beacon *models.Beacon
 var err error
 if !req.Request.Async {
  session = core.Sessions.Get(req.Request.SessionID)
  if session == nil {
   return nil, ErrInvalidSessionID
  }
 } else {
  beacon, err = db.BeaconByID(req.Request.BeaconID)
  if err != nil {
   tasksLog.Errorf("%s", err)
   return nil, ErrDatabaseFailure
  }
  if beacon == nil {
   return nil, ErrInvalidBeaconID
  }
 }

 shellcode, err := generate.DonutFromAssembly(
  req.Assembly,
  req.IsDLL,
  req.Arch,
  req.Arguments,
  req.Method,
  req.ClassName,
  req.AppDomain,
 )
 if err != nil {
  tasksLog.Errorf("Execute assembly failed: %s", err)
  return nil, err
 }

 resp := &amp;sliverpb.ExecuteAssembly{Response: &amp;commonpb.Response{}}
 if req.InProcess {
  tasksLog.Infof("Executing assembly in-process")
  invokeInProcExecAssembly := &amp;sliverpb.InvokeInProcExecuteAssemblyReq{
   Data:       req.Assembly,
   Runtime:    req.Runtime,
   Arguments:  strings.Split(req.Arguments, " "),
   AmsiBypass: req.AmsiBypass,
   EtwBypass:  req.EtwBypass,
   Request:    req.Request,
  }
  err = rpc.GenericHandler(invokeInProcExecAssembly, resp)
 } else {
  invokeExecAssembly := &amp;sliverpb.InvokeExecuteAssemblyReq{
   Data:        shellcode,
   Process:     req.Process,
   Request:     req.Request,
   PPid:        req.PPid,
   ProcessArgs: req.ProcessArgs,
  }
  err = rpc.GenericHandler(invokeExecAssembly, resp)

 }
 if err != nil {
  return nil, err
 }
 return resp, nil
}&lt;span class="pre--content"&gt; &lt;/span&gt;</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="golang">//&nbsp;ExecuteAssembly&nbsp;-&nbsp;Execute&nbsp;a&nbsp;.NET&nbsp;assembly&nbsp;on&nbsp;the&nbsp;remote&nbsp;system&nbsp;in-memory&nbsp;(Windows&nbsp;only)
func&nbsp;(rpc&nbsp;*Server)&nbsp;ExecuteAssembly(ctx&nbsp;context.Context,&nbsp;req&nbsp;*sliverpb.ExecuteAssemblyReq)&nbsp;(*sliverpb.ExecuteAssembly,&nbsp;error)&nbsp;{
&nbsp;var&nbsp;session&nbsp;*core.Session
&nbsp;var&nbsp;beacon&nbsp;*models.Beacon
&nbsp;var&nbsp;err&nbsp;error
&nbsp;if&nbsp;!req.Request.Async&nbsp;{
&nbsp;&nbsp;session&nbsp;=&nbsp;core.Sessions.Get(req.Request.SessionID)
&nbsp;&nbsp;if&nbsp;session&nbsp;==&nbsp;nil&nbsp;{
&nbsp;&nbsp;&nbsp;return&nbsp;nil,&nbsp;ErrInvalidSessionID
&nbsp;&nbsp;}
&nbsp;}&nbsp;else&nbsp;{
&nbsp;&nbsp;beacon,&nbsp;err&nbsp;=&nbsp;db.BeaconByID(req.Request.BeaconID)
&nbsp;&nbsp;if&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{
&nbsp;&nbsp;&nbsp;tasksLog.Errorf("%s",&nbsp;err)
&nbsp;&nbsp;&nbsp;return&nbsp;nil,&nbsp;ErrDatabaseFailure
&nbsp;&nbsp;}
&nbsp;&nbsp;if&nbsp;beacon&nbsp;==&nbsp;nil&nbsp;{
&nbsp;&nbsp;&nbsp;return&nbsp;nil,&nbsp;ErrInvalidBeaconID
&nbsp;&nbsp;}
&nbsp;}

&nbsp;shellcode,&nbsp;err&nbsp;:=&nbsp;generate.DonutFromAssembly(
&nbsp;&nbsp;req.Assembly,
&nbsp;&nbsp;req.IsDLL,
&nbsp;&nbsp;req.Arch,
&nbsp;&nbsp;req.Arguments,
&nbsp;&nbsp;req.Method,
&nbsp;&nbsp;req.ClassName,
&nbsp;&nbsp;req.AppDomain,
&nbsp;)
&nbsp;if&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{
&nbsp;&nbsp;tasksLog.Errorf("Execute&nbsp;assembly&nbsp;failed:&nbsp;%s",&nbsp;err)
&nbsp;&nbsp;return&nbsp;nil,&nbsp;err
&nbsp;}

&nbsp;resp&nbsp;:=&nbsp;&amp;sliverpb.ExecuteAssembly{Response:&nbsp;&amp;commonpb.Response{}}
&nbsp;if&nbsp;req.InProcess&nbsp;{
&nbsp;&nbsp;tasksLog.Infof("Executing&nbsp;assembly&nbsp;in-process")
&nbsp;&nbsp;invokeInProcExecAssembly&nbsp;:=&nbsp;&amp;sliverpb.InvokeInProcExecuteAssemblyReq{
&nbsp;&nbsp;&nbsp;Data:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;req.Assembly,
&nbsp;&nbsp;&nbsp;Runtime:&nbsp;&nbsp;&nbsp;&nbsp;req.Runtime,
&nbsp;&nbsp;&nbsp;Arguments:&nbsp;&nbsp;strings.Split(req.Arguments,&nbsp;"&nbsp;"),
&nbsp;&nbsp;&nbsp;AmsiBypass:&nbsp;req.AmsiBypass,
&nbsp;&nbsp;&nbsp;EtwBypass:&nbsp;&nbsp;req.EtwBypass,
&nbsp;&nbsp;&nbsp;Request:&nbsp;&nbsp;&nbsp;&nbsp;req.Request,
&nbsp;&nbsp;}
&nbsp;&nbsp;err&nbsp;=&nbsp;rpc.GenericHandler(invokeInProcExecAssembly,&nbsp;resp)
&nbsp;}&nbsp;else&nbsp;{
&nbsp;&nbsp;invokeExecAssembly&nbsp;:=&nbsp;&amp;sliverpb.InvokeExecuteAssemblyReq{
&nbsp;&nbsp;&nbsp;Data:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shellcode,
&nbsp;&nbsp;&nbsp;Process:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;req.Process,
&nbsp;&nbsp;&nbsp;Request:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;req.Request,
&nbsp;&nbsp;&nbsp;PPid:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;req.PPid,
&nbsp;&nbsp;&nbsp;ProcessArgs:&nbsp;req.ProcessArgs,
&nbsp;&nbsp;}
&nbsp;&nbsp;err&nbsp;=&nbsp;rpc.GenericHandler(invokeExecAssembly,&nbsp;resp)

&nbsp;}
&nbsp;if&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{
&nbsp;&nbsp;return&nbsp;nil,&nbsp;err
&nbsp;}
&nbsp;return&nbsp;resp,&nbsp;nil
}<span class="pre--content">&nbsp;</span></pre>
<p class="graf graf--p">The req parameter passed as input corresponds to the protobuf message <strong class="markup--strong markup--p-strong">ExecuteAssemblyReq, </strong>defined in <a href="https://github.com/BishopFox/sliver/blob/master/protobuf/sliverpb/sliver.proto">sliver.proto</a>, in the following way (commonpb.Request is defined in <a href="https://github.com/BishopFox/sliver/blob/master/protobuf/commonpb/common.proto">common.proto </a>but I added it here for clarity):</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-generic enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">common.</span><span class="enlighter-m3">proto</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">...</span></div></div><div class=""><div><span class="enlighter-text">...</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-c0">// Request - Common fields used in all gRPC requests</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">message Request </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  bool Async = </span><span class="enlighter-n1">1</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">  int64 Timeout = </span><span class="enlighter-n1">2</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  string BeaconID = </span><span class="enlighter-n1">8</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">  string SessionID = </span><span class="enlighter-n1">9</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">...</span></div></div><div class=""><div><span class="enlighter-text">...</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">---------------------------------------------------------------------</span></div></div><div class=""><div><span class="enlighter-text">sliver.</span><span class="enlighter-m3">proto</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">...</span></div></div><div class=""><div><span class="enlighter-text">...</span></div></div><div class=""><div><span class="enlighter-text">message ExecuteAssemblyReq </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  bytes Assembly = </span><span class="enlighter-n1">1</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">  string Arguments = </span><span class="enlighter-n1">2</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">  string Process = </span><span class="enlighter-n1">3</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">  bool IsDLL = </span><span class="enlighter-n1">4</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">  string Arch = </span><span class="enlighter-n1">5</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">  string ClassName = </span><span class="enlighter-n1">6</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">  string Method = </span><span class="enlighter-n1">7</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">  string AppDomain = </span><span class="enlighter-n1">8</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">  uint32 PPid = </span><span class="enlighter-n1">10</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">  repeated string ProcessArgs = </span><span class="enlighter-n1">11</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-c0">// In process specific fields</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  bool InProcess = </span><span class="enlighter-n1">12</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">  string Runtime = </span><span class="enlighter-n1">13</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">  bool AmsiBypass = </span><span class="enlighter-n1">14</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">  bool EtwBypass = </span><span class="enlighter-n1">15</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">  commonpb.</span><span class="enlighter-m3">Request</span><span class="enlighter-text"> Request = </span><span class="enlighter-n1">9</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">...</span></div></div><div class=""><div><span class="enlighter-text">...</span></div></div></div><div class="enlighter-raw">common.proto
...
...
// Request - Common fields used in all gRPC requests
message Request {
  bool Async = 1;
  int64 Timeout = 2;

  string BeaconID = 8;
  string SessionID = 9;
}
...
...

---------------------------------------------------------------------
sliver.proto
...
...
message ExecuteAssemblyReq {
  bytes Assembly = 1;
  string Arguments = 2;
  string Process = 3;
  bool IsDLL = 4;
  string Arch = 5;
  string ClassName = 6;
  string Method = 7;
  string AppDomain = 8;
  uint32 PPid = 10;
  repeated string ProcessArgs = 11;
  // In process specific fields
  bool InProcess = 12;
  string Runtime = 13;
  bool AmsiBypass = 14;
  bool EtwBypass = 15;
  commonpb.Request Request = 9;
}
...
...</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">common.proto
...
...
// Request - Common fields used in all gRPC requests
message Request {
  bool Async = 1;
  int64 Timeout = 2;

  string BeaconID = 8;
  string SessionID = 9;
}
...
...

---------------------------------------------------------------------
sliver.proto
...
...
message ExecuteAssemblyReq {
  bytes Assembly = 1;
  string Arguments = 2;
  string Process = 3;
  bool IsDLL = 4;
  string Arch = 5;
  string ClassName = 6;
  string Method = 7;
  string AppDomain = 8;
  uint32 PPid = 10;
  repeated string ProcessArgs = 11;
  // In process specific fields
  bool InProcess = 12;
  string Runtime = 13;
  bool AmsiBypass = 14;
  bool EtwBypass = 15;
  commonpb.Request Request = 9;
}
...
...</pre>
<p class="graf graf--p">So what happens is that the handler performs the following actions:</p>
<ol class="postList">
<li class="graf graf--li">retrieve the implant ID through req.Request.SessionID/req.Request.BeaconID and check if it is valid.</li>
<li>create the go struct <strong class="markup--strong markup--p-strong">sliverpb.ExecuteAssembly</strong> that corresponds to the <strong class="markup--strong markup--p-strong">ExecuteAssembly </strong>protobuf message defined in <strong class="markup--strong markup--p-strong">sliver.proto. This struct will contain the response from the implant</strong>.</li>
<li>create the go struct <strong class="markup--strong markup--p-strong">sliverpb.InvokeInProcExecuteAssemblyReq</strong> that corresponds to the <strong class="markup--strong markup--p-strong">InvokeInProcExecuteAssemblyReq </strong>protobuf message defined in <strong class="markup--strong markup--p-strong">sliver.proto </strong>(we suppose the we executed execute-assembly in process, with the -i flag, otherwise the server will create ExecuteAssemblyReq). <strong class="markup--strong markup--p-strong">The implant will receive this struct as a request to process</strong>.</li>
<li>call <strong class="markup--strong markup--p-strong">rpc.GenericHandler(),</strong> <strong class="markup--strong markup--p-strong">passing as input the request and the response created at steps 2 and 3</strong>.</li>
<li>return <strong class="markup--strong markup--p-strong">resp</strong>, the response struct that the rpc.GenericHandler function populates with the response of the implant.</li>
</ol>
<p>Here’s the body of function <strong class="markup--strong markup--p-strong">rpc.GenericHandler()</strong>, defined inside <a href="https://github.com/BishopFox/sliver/blob/master/server/rpc/rpc.go">server/rpc/rpc.go</a>:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-go enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-c0">// GenericHandler - Pass the request to the Sliver/Session</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">func</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">rpc *Server</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-m0">GenericHandler</span><span class="enlighter-g1">(</span><span class="enlighter-text">req GenericRequest, resp GenericResponse</span><span class="enlighter-g1">)</span><span class="enlighter-text"> error </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-k2">var</span><span class="enlighter-text"> err error</span></div></div><div class=""><div><span class="enlighter-text">    request := req.</span><span class="enlighter-m3">GetRequest</span><span class="enlighter-g1">()</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-k1">if</span><span class="enlighter-text"> request == </span><span class="enlighter-e1">nil</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k0">return</span><span class="enlighter-text"> ErrMissingRequestField</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-k1">if</span><span class="enlighter-text"> request.</span><span class="enlighter-m3">Async</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        err = rpc.</span><span class="enlighter-m3">asyncGenericHandler</span><span class="enlighter-g1">(</span><span class="enlighter-text">req, resp</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k0">return</span><span class="enlighter-text"> err</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-c0">// Sync request</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    session := core.</span><span class="enlighter-m3">Sessions</span><span class="enlighter-text">.</span><span class="enlighter-m3">Get</span><span class="enlighter-g1">(</span><span class="enlighter-text">request.</span><span class="enlighter-m3">SessionID</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-k1">if</span><span class="enlighter-text"> session == </span><span class="enlighter-e1">nil</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k0">return</span><span class="enlighter-text"> ErrInvalidSessionID</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-c0">// Overwrite unused implant fields before re-serializing</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    request.</span><span class="enlighter-m3">SessionID</span><span class="enlighter-text"> = </span><span class="enlighter-s0">""</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    request.</span><span class="enlighter-m3">BeaconID</span><span class="enlighter-text"> = </span><span class="enlighter-s0">""</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    reqData, err := proto.</span><span class="enlighter-m3">Marshal</span><span class="enlighter-g1">(</span><span class="enlighter-text">req</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-k1">if</span><span class="enlighter-text"> err != </span><span class="enlighter-e1">nil</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k0">return</span><span class="enlighter-text"> err</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    data, err := session.</span><span class="enlighter-m3">Request</span><span class="enlighter-g1">(</span><span class="enlighter-text">sliverpb.</span><span class="enlighter-m3">MsgNumber</span><span class="enlighter-g1">(</span><span class="enlighter-text">req</span><span class="enlighter-g1">)</span><span class="enlighter-text">, rpc.</span><span class="enlighter-m3">getTimeout</span><span class="enlighter-g1">(</span><span class="enlighter-text">req</span><span class="enlighter-g1">)</span><span class="enlighter-text">, reqData</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-k1">if</span><span class="enlighter-text"> err != </span><span class="enlighter-e1">nil</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k0">return</span><span class="enlighter-text"> err</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    err = proto.</span><span class="enlighter-m3">Unmarshal</span><span class="enlighter-g1">(</span><span class="enlighter-text">data, resp</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-k1">if</span><span class="enlighter-text"> err != </span><span class="enlighter-e1">nil</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k0">return</span><span class="enlighter-text"> err</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-k0">return</span><span class="enlighter-text"> rpc.</span><span class="enlighter-m3">getError</span><span class="enlighter-g1">(</span><span class="enlighter-text">resp</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">// GenericHandler - Pass the request to the Sliver/Session
func (rpc *Server) GenericHandler(req GenericRequest, resp GenericResponse) error {
    var err error
    request := req.GetRequest()
    if request == nil {
        return ErrMissingRequestField
    }
    if request.Async {
        err = rpc.asyncGenericHandler(req, resp)
        return err
    }

    // Sync request
    session := core.Sessions.Get(request.SessionID)
    if session == nil {
        return ErrInvalidSessionID
    }

    // Overwrite unused implant fields before re-serializing
    request.SessionID = ""
    request.BeaconID = ""

    reqData, err := proto.Marshal(req)
    if err != nil {
        return err
    }

    data, err := session.Request(sliverpb.MsgNumber(req), rpc.getTimeout(req), reqData)
    if err != nil {
        return err
    }
    err = proto.Unmarshal(data, resp)
    if err != nil {
        return err
    }
    return rpc.getError(resp)
}</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="golang">// GenericHandler - Pass the request to the Sliver/Session
func (rpc *Server) GenericHandler(req GenericRequest, resp GenericResponse) error {
    var err error
    request := req.GetRequest()
    if request == nil {
        return ErrMissingRequestField
    }
    if request.Async {
        err = rpc.asyncGenericHandler(req, resp)
        return err
    }

    // Sync request
    session := core.Sessions.Get(request.SessionID)
    if session == nil {
        return ErrInvalidSessionID
    }

    // Overwrite unused implant fields before re-serializing
    request.SessionID = ""
    request.BeaconID = ""

    reqData, err := proto.Marshal(req)
    if err != nil {
        return err
    }

    data, err := session.Request(sliverpb.MsgNumber(req), rpc.getTimeout(req), reqData)
    if err != nil {
        return err
    }
    err = proto.Unmarshal(data, resp)
    if err != nil {
        return err
    }
    return rpc.getError(resp)
}</pre>
<p class="graf graf--p">You may notice that the function retrieves the beacon/session implant, <strong class="markup--strong markup--p-strong">serializes the request, sends the serialized request to the implant</strong>, and finally <strong class="markup--strong markup--p-strong">returns the response from the implant inside the resp input parameter</strong>.</p>
<p class="graf graf--p">On the implant-side, the functions in charge of handling the requests coming from the server are defined inside <strong class="markup--strong markup--p-strong">handlers_&lt;OS&gt;.go</strong> and <strong class="markup--strong markup--p-strong">handlers.go. </strong>The file <strong class="markup--strong markup--p-strong">handlers.go contains handlers for tasks that can be executed on any OS</strong>, while <strong class="markup--strong markup--p-strong">handlers_&lt;OS&gt;.go contains handlers for tasks that can be executed only on a specific OS</strong>. For example, <a href="https://github.com/BishopFox/sliver/blob/master/implant/sliver/handlers/handlers_windows.go">handlers_windows.go</a> contains<strong class="markup--strong markup--p-strong"> impersonateHandler()</strong> that implements the impersonate command that would be <strong class="markup--strong markup--p-strong">useful only with a Windows OS</strong>, while <strong class="markup--strong markup--p-strong">handlers.go contains dirListHandler()</strong> that implements the ls command that is <strong class="markup--strong markup--p-strong">useful with any OS</strong>.</p>
<p class="graf graf--p">Let’s inspect the <strong class="markup--strong markup--p-strong">inProcExecuteAssemblyHandler() </strong>defined in <a href="https://github.com/BishopFox/sliver/blob/master/implant/sliver/handlers/handlers_windows.go">implant/sliver/handlers_windows.go</a>:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-go enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-k0">func</span><span class="enlighter-text"> </span><span class="enlighter-m0">inProcExecuteAssemblyHandler</span><span class="enlighter-g1">(</span><span class="enlighter-text">data </span><span class="enlighter-g1">[]</span><span class="enlighter-k5">byte</span><span class="enlighter-text">, resp RPCResponse</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    execReq := &amp;sliverpb.</span><span class="enlighter-m3">InvokeInProcExecuteAssemblyReq</span><span class="enlighter-g1">{}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    err := proto.</span><span class="enlighter-m3">Unmarshal</span><span class="enlighter-g1">(</span><span class="enlighter-text">data, execReq</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-k1">if</span><span class="enlighter-text"> err != </span><span class="enlighter-e1">nil</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-c0">// {{if .Config.Debug}}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        log.</span><span class="enlighter-m3">Printf</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"error decoding message: %v"</span><span class="enlighter-text">, err</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-c0">// {{end}}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k0">return</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    output, err := taskrunner.</span><span class="enlighter-m3">InProcExecuteAssembly</span><span class="enlighter-g1">(</span><span class="enlighter-text">execReq.</span><span class="enlighter-m3">Data</span><span class="enlighter-text">, execReq.</span><span class="enlighter-m3">Arguments</span><span class="enlighter-text">, execReq.</span><span class="enlighter-m3">Runtime</span><span class="enlighter-text">, execReq.</span><span class="enlighter-m3">AmsiBypass</span><span class="enlighter-text">, execReq.</span><span class="enlighter-m3">EtwBypass</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    execAsm := &amp;sliverpb.</span><span class="enlighter-m3">ExecuteAssembly</span><span class="enlighter-g1">{</span><span class="enlighter-text">Output: </span><span class="enlighter-g1">[]</span><span class="enlighter-k5">byte</span><span class="enlighter-g1">(</span><span class="enlighter-text">output</span><span class="enlighter-g1">)}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-k1">if</span><span class="enlighter-text"> err != </span><span class="enlighter-e1">nil</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        execAsm.</span><span class="enlighter-m3">Response</span><span class="enlighter-text"> = &amp;commonpb.</span><span class="enlighter-m3">Response</span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            Err: err.</span><span class="enlighter-m3">Error</span><span class="enlighter-g1">()</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    data, err = proto.</span><span class="enlighter-m3">Marshal</span><span class="enlighter-g1">(</span><span class="enlighter-text">execAsm</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-m0">resp</span><span class="enlighter-g1">(</span><span class="enlighter-text">data, err</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">func inProcExecuteAssemblyHandler(data []byte, resp RPCResponse) {
    execReq := &amp;sliverpb.InvokeInProcExecuteAssemblyReq{}
    err := proto.Unmarshal(data, execReq)
    if err != nil {
        // {{if .Config.Debug}}
        log.Printf("error decoding message: %v", err)
        // {{end}}
        return
    }
    output, err := taskrunner.InProcExecuteAssembly(execReq.Data, execReq.Arguments, execReq.Runtime, execReq.AmsiBypass, execReq.EtwBypass)
    execAsm := &amp;sliverpb.ExecuteAssembly{Output: []byte(output)}
    if err != nil {
        execAsm.Response = &amp;commonpb.Response{
            Err: err.Error(),
        }
    }
    data, err = proto.Marshal(execAsm)
    resp(data, err)
}</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="golang">func inProcExecuteAssemblyHandler(data []byte, resp RPCResponse) {
    execReq := &amp;sliverpb.InvokeInProcExecuteAssemblyReq{}
    err := proto.Unmarshal(data, execReq)
    if err != nil {
        // {{if .Config.Debug}}
        log.Printf("error decoding message: %v", err)
        // {{end}}
        return
    }
    output, err := taskrunner.InProcExecuteAssembly(execReq.Data, execReq.Arguments, execReq.Runtime, execReq.AmsiBypass, execReq.EtwBypass)
    execAsm := &amp;sliverpb.ExecuteAssembly{Output: []byte(output)}
    if err != nil {
        execAsm.Response = &amp;commonpb.Response{
            Err: err.Error(),
        }
    }
    data, err = proto.Marshal(execAsm)
    resp(data, err)
}</pre>
<p class="graf graf--p">It takes as input <strong class="markup--strong markup--p-strong">data</strong>, the serialized request, as an array of bytes, and <strong class="markup--strong markup--p-strong">resp </strong>corresponding to a<strong class="markup--strong markup--p-strong"> callback</strong>.</p>
<p class="graf graf--p">The function <strong class="markup--strong markup--p-strong">unserializes data in the struct InvokeInProcExecuteAssemblyReq</strong> (this corresponds to the request sent by the server). Now the implant processes the request (the variable <strong class="markup--strong markup--p-strong">execReq</strong>) and calls taskrunner.InProcExecuteAssembly(), passing as input the parameters contained in execReq.</p>
<p class="graf graf--p">At this point, the implant performs the following operations:</p>
<ul>
<li class="graf graf--p">save the output inside a struct of type <strong class="markup--strong markup--p-strong">sliverpb.ExecuteAssembly</strong>, again defined in <strong class="markup--strong markup--p-strong">sliver.proto</strong>.</li>
<li class="graf graf--p">serialize the struct.</li>
<li class="graf graf--p">call the callback resp, passing as input the serialized struct.</li>
</ul>
<p class="graf graf--p">The <strong class="markup--strong markup--p-strong">callback resp </strong>will <strong class="markup--strong markup--p-strong">end up returning the serialized struct to the server</strong>, <strong class="markup--strong markup--p-strong">as a response to the initial request</strong>, through the communication channel in use (that again could be HTTP/S, DNS, WireGuard, etc.).</p>
<p class="graf graf--p">At this point, on the server-side, the <a href="https://github.com/BishopFox/sliver/blob/master/implant/sliver/handlers/handlers_windows.go">rpc.GenericHandler()</a> function receives the response, and returns it to <a href="https://github.com/BishopFox/sliver/blob/master/server/rpc/rpc-tasks.go#L127">ExecuteAssembly()</a>, which finally sends it back to the client through gRPC.</p>
<p class="graf graf--p">In the end, the client receives and processes the response, and prints data on screen for the operator.</p>
<p class="graf graf--p">By now you should have a basic understanding of the internals of Sliver. Be ready for the third and final part of this <a href="https://hnsecurity.it/tag/sliver/">series</a>!</p>
</div><div class="uncode_text_column mt-5"><span class="post-tags"><a class="custom-tag-box" href="https://hnsecurity.it/blog/tag/c2/">c2</a><a class="custom-tag-box" href="https://hnsecurity.it/blog/tag/red-teaming/">red teaming</a><a class="custom-tag-box" href="https://hnsecurity.it/blog/tag/sliver/">sliver</a><a class="custom-tag-box" href="https://hnsecurity.it/blog/tag/golang/">golang</a><a class="custom-tag-box" href="https://hnsecurity.it/blog/tag/windows/">windows</a></span>
</div></div></div></div></div></div></div></div></div><div data-parent="true" class="vc_row has-bg need-focus style-color-lxmt-bg row-container" id="row-unique-3"><div class="row double-top-padding double-bottom-padding single-h-padding full-width row-parent" data-imgready="true"><div class="wpb_row row-inner"><div class="wpb_column pos-top pos-center align_center column_parent col-lg-12 single-internal-gutter"><div class="uncol style-light"><div class="uncoltable"><div class="uncell no-block-padding"><div class="uncont"><div class="owl-carousel-wrapper">
													<div class="owl-carousel-container single-gutter test-init">												<div id="index-177493092" class="owl-carousel owl-element owl-height-equal owl-dots-outside owl-dots-single-block-padding owl-dots-align-center owl-loaded owl-drag showControls" data-dots="true" data-dotsmobile="true" data-navmobile="false" data-navspeed="400" data-autoplay="false" data-stagepadding="0" data-lg="5" data-md="3" data-sm="1" data-vp-height="false"><div class="owl-stage-outer"><div class="owl-stage" style="transform: translate3d(0px, 0px, 0px); transition: all; width: 3456px;"><div class="owl-item active index-active" data-index="1" style="width: 384px;"><div class="tmb tmb-carousel atc-typography-inherit tmb-iso-h33 tmb-round img-round-lg tmb-light tmb-text-showed tmb-overlay-anim tmb-content-left  grid-cat-88 grid-cat-91 tmb-id-161180 tmb-content-under tmb-media-first" style="transition-delay: 120ms; transition-duration: 320ms;"><div class="t-inside style-color-xsdn-bg no-anim srcset-lazy-animations"><div class="t-entry-visual"><div class="t-entry-visual-tc"><div class="t-entry-visual-cont"><div class="dummy" style="padding-top: 52.3%;"></div><a role="button" tabindex="-1" href="https://hnsecurity.it/blog/extending-burp-suite-for-fun-and-profit-the-montoya-way-part-9/?media_link=1" class="pushed" target="_self" data-lb-index="0"><div class="t-entry-visual-overlay"><div class="t-entry-visual-overlay-in style-color-wayh-bg" style="opacity: 0.5;"></div></div><img decoding="async" class="srcset-auto srcset-on-layout wp-image-159898 srcset-sizes-done" src="https://hnsecurity.it/wp-content/uploads/2025/09/BURP.jpg" width="1600" height="836" alt="" data-no-bp="" data-bp="720" data-uniqueid="159898-177232" data-guid="https://hnsecurity.it/wp-content/uploads/2025/09/BURP.jpg" data-path="2025/09/BURP.jpg" data-width="1600" data-height="836" data-singlew="2" data-singleh="33" data-crop="" loading="lazy"></a></div>
					</div>
				</div><div class="t-entry-text">
									<div class="t-entry-text-tc half-block-padding"><div class="t-entry"><p class="t-entry-meta"><span class="t-entry-category t-entry-category-88 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/tools/">Tools</a></span><span class="t-entry-category t-entry-category-91 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/articles/">Articles</a></span></p><p class="t-entry-meta"><span class="t-entry-date">December 10, 2025</span></p><h3 class="t-entry-title h5 title-scale "><a href="https://hnsecurity.it/blog/extending-burp-suite-for-fun-and-profit-the-montoya-way-part-9/" target="_self">Extending Burp Suite for fun and profit – The Montoya way – Part 9</a></h3><div class="t-entry-excerpt " style="transform: translateY(16.001px);"></div></div></div>
							</div></div></div></div><div class="owl-item active index-active" data-index="2" style="width: 384px;"><div class="tmb tmb-carousel atc-typography-inherit tmb-iso-h33 tmb-round img-round-lg tmb-light tmb-text-showed tmb-overlay-anim tmb-content-left  grid-cat-78 grid-cat-91 tmb-id-5100 tmb-content-under tmb-media-first" style="transition-delay: 120ms; transition-duration: 320ms;"><div class="t-inside style-color-xsdn-bg no-anim srcset-lazy-animations"><div class="t-entry-visual"><div class="t-entry-visual-tc"><div class="t-entry-visual-cont"><div class="dummy" style="padding-top: 52.3%;"></div><a role="button" tabindex="-1" href="https://hnsecurity.it/blog/groovy-template-engine-exploitation-part-2/?media_link=1" class="pushed" aria-label="Groovy logo" target="_self" data-lb-index="1"><div class="t-entry-visual-overlay"><div class="t-entry-visual-overlay-in style-color-wayh-bg" style="opacity: 0.5;"></div></div><img decoding="async" class="srcset-auto srcset-on-layout wp-image-159919 srcset-sizes-done" src="https://hnsecurity.it/wp-content/uploads/2025/09/GROOVY.jpg" width="1600" height="836" alt="Groovy logo" data-no-bp="" data-bp="720" data-uniqueid="159919-208660" data-guid="https://hnsecurity.it/wp-content/uploads/2025/09/GROOVY.jpg" data-path="2025/09/GROOVY.jpg" data-width="1600" data-height="836" data-singlew="2" data-singleh="33" data-crop="" loading="lazy"></a></div>
					</div>
				</div><div class="t-entry-text">
									<div class="t-entry-text-tc half-block-padding"><div class="t-entry"><p class="t-entry-meta"><span class="t-entry-category t-entry-category-78 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/exploits/">Exploits</a></span><span class="t-entry-category t-entry-category-91 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/articles/">Articles</a></span></p><p class="t-entry-meta"><span class="t-entry-date">November 11, 2025</span></p><h3 class="t-entry-title h5 title-scale "><a href="https://hnsecurity.it/blog/groovy-template-engine-exploitation-part-2/" target="_self">Groovy Template Engine Exploitation – Notes from a real case scenario, part 2</a></h3><div class="t-entry-excerpt " style="transform: translateY(16.001px);"></div></div></div>
							</div></div></div></div><div class="owl-item active index-active" data-index="3" style="width: 384px;"><div class="tmb tmb-carousel atc-typography-inherit tmb-iso-h33 tmb-round img-round-lg tmb-light tmb-text-showed tmb-overlay-anim tmb-content-left  grid-cat-88 grid-cat-91 tmb-id-161164 tmb-content-under tmb-media-first" style="transition-delay: 120ms; transition-duration: 320ms;"><div class="t-inside style-color-xsdn-bg no-anim srcset-lazy-animations"><div class="t-entry-visual"><div class="t-entry-visual-tc"><div class="t-entry-visual-cont"><div class="dummy" style="padding-top: 52.3%;"></div><a role="button" tabindex="-1" href="https://hnsecurity.it/blog/brida-0-6-released/?media_link=1" class="pushed" aria-label="Brida logo" target="_self" data-lb-index="2"><div class="t-entry-visual-overlay"><div class="t-entry-visual-overlay-in style-color-wayh-bg" style="opacity: 0.5;"></div></div><img decoding="async" class="srcset-auto srcset-on-layout wp-image-161178 srcset-sizes-done" src="https://hnsecurity.it/wp-content/uploads/2025/10/BRIDA_2.png" width="1600" height="836" alt="Brida logo" data-no-bp="" data-bp="720" data-uniqueid="161178-287746" data-guid="https://hnsecurity.it/wp-content/uploads/2025/10/BRIDA_2.png" data-path="2025/10/BRIDA_2.png" data-width="1600" data-height="836" data-singlew="2" data-singleh="33" data-crop="" loading="lazy"></a></div>
					</div>
				</div><div class="t-entry-text">
									<div class="t-entry-text-tc half-block-padding"><div class="t-entry"><p class="t-entry-meta"><span class="t-entry-category t-entry-category-88 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/tools/">Tools</a></span><span class="t-entry-category t-entry-category-91 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/articles/">Articles</a></span></p><p class="t-entry-meta"><span class="t-entry-date">October 28, 2025</span></p><h3 class="t-entry-title h5 title-scale "><a href="https://hnsecurity.it/blog/brida-0-6-released/" target="_self">Brida 0.6 released!</a></h3><div class="t-entry-excerpt " style="transform: translateY(16.0012px);"></div></div></div>
							</div></div></div></div><div class="owl-item active index-active" data-index="4" style="width: 384px;"><div class="tmb tmb-carousel atc-typography-inherit tmb-iso-h33 tmb-round img-round-lg tmb-light tmb-text-showed tmb-overlay-anim tmb-content-left  grid-cat-91 grid-cat-88 tmb-id-161068 tmb-content-under tmb-media-first" style="transition-delay: 120ms; transition-duration: 320ms;"><div class="t-inside style-color-xsdn-bg no-anim srcset-lazy-animations"><div class="t-entry-visual"><div class="t-entry-visual-tc"><div class="t-entry-visual-cont"><div class="dummy" style="padding-top: 52.3%;"></div><a role="button" tabindex="-1" href="https://hnsecurity.it/blog/streamlining-vulnerability-research-with-the-idalib-rust-bindings-for-ida-9-2/?media_link=1" class="pushed" aria-label="hex-rays logo" target="_self" data-lb-index="3"><div class="t-entry-visual-overlay"><div class="t-entry-visual-overlay-in style-color-wayh-bg" style="opacity: 0.5;"></div></div><img decoding="async" class="srcset-auto srcset-on-layout wp-image-161156 srcset-sizes-done" src="https://hnsecurity.it/wp-content/uploads/2025/10/HEX-RAYS_4.png" width="1600" height="836" alt="hex-rays logo" data-no-bp="" data-bp="720" data-uniqueid="161156-211396" data-guid="https://hnsecurity.it/wp-content/uploads/2025/10/HEX-RAYS_4.png" data-path="2025/10/HEX-RAYS_4.png" data-width="1600" data-height="836" data-singlew="2" data-singleh="33" data-crop="" loading="lazy"></a></div>
					</div>
				</div><div class="t-entry-text">
									<div class="t-entry-text-tc half-block-padding"><div class="t-entry"><p class="t-entry-meta"><span class="t-entry-category t-entry-category-91 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/articles/">Articles</a></span><span class="t-entry-category t-entry-category-88 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/tools/">Tools</a></span></p><p class="t-entry-meta"><span class="t-entry-date">October 14, 2025</span></p><h3 class="t-entry-title h5 title-scale "><a href="https://hnsecurity.it/blog/streamlining-vulnerability-research-with-the-idalib-rust-bindings-for-ida-9-2/" target="_self">Streamlining Vulnerability Research with the idalib Rust Bindings for IDA 9.2</a></h3><div class="t-entry-excerpt " style="transform: translateY(16.001px);"></div></div></div>
							</div></div></div></div><div class="owl-item active index-active" data-index="5" style="width: 384px;"><div class="tmb tmb-carousel atc-typography-inherit tmb-iso-h33 tmb-round img-round-lg tmb-light tmb-text-showed tmb-overlay-anim tmb-content-left  grid-cat-91 tmb-id-5879 tmb-content-under tmb-media-first" style="transition-delay: 120ms; transition-duration: 320ms;"><div class="t-inside style-color-xsdn-bg no-anim srcset-lazy-animations"><div class="t-entry-visual"><div class="t-entry-visual-tc"><div class="t-entry-visual-cont"><div class="dummy" style="padding-top: 52.3%;"></div><a role="button" tabindex="-1" href="https://hnsecurity.it/blog/attacking-genai-applications-and-llms-sometimes-all-it-takes-is-to-ask-nicely/?media_link=1" class="pushed" aria-label="LLM Icon" target="_self" data-lb-index="4"><div class="t-entry-visual-overlay"><div class="t-entry-visual-overlay-in style-color-wayh-bg" style="opacity: 0.5;"></div></div><img decoding="async" class="srcset-auto srcset-on-layout wp-image-159933 srcset-sizes-done" src="https://hnsecurity.it/wp-content/uploads/2025/09/LLM.jpg" width="1600" height="836" alt="LLM Icon" data-no-bp="" data-bp="720" data-uniqueid="159933-210397" data-guid="https://hnsecurity.it/wp-content/uploads/2025/09/LLM.jpg" data-path="2025/09/LLM.jpg" data-width="1600" data-height="836" data-singlew="2" data-singleh="33" data-crop="" loading="lazy"></a></div>
					</div>
				</div><div class="t-entry-text">
									<div class="t-entry-text-tc half-block-padding"><div class="t-entry"><p class="t-entry-meta"><span class="t-entry-category t-entry-category-91 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/articles/">Articles</a></span></p><p class="t-entry-meta"><span class="t-entry-date">July 29, 2025</span></p><h3 class="t-entry-title h5 title-scale "><a href="https://hnsecurity.it/blog/attacking-genai-applications-and-llms-sometimes-all-it-takes-is-to-ask-nicely/" target="_self">Attacking GenAI applications and LLMs – Sometimes all it takes is to ask nicely!</a></h3><div class="t-entry-excerpt " style="transform: translateY(16.001px);"></div></div></div>
							</div></div></div></div><div class="owl-item" data-index="6" style="width: 384px;"><div class="tmb tmb-carousel atc-typography-inherit tmb-iso-h33 tmb-round img-round-lg tmb-light tmb-text-showed tmb-overlay-anim tmb-content-left  grid-cat-91 tmb-id-5842 tmb-content-under tmb-media-first" style="transition-delay: 120ms; transition-duration: 320ms;"><div class="t-inside style-color-xsdn-bg no-anim srcset-lazy-animations"><div class="t-entry-visual"><div class="t-entry-visual-tc"><div class="t-entry-visual-cont"><div class="dummy" style="padding-top: 52.3%;"></div><a role="button" tabindex="-1" href="https://hnsecurity.it/blog/fault-injection-follow-the-white-rabbit/?media_link=1" class="pushed" target="_self" data-lb-index="5"><div class="t-entry-visual-overlay"><div class="t-entry-visual-overlay-in style-color-wayh-bg" style="opacity: 0.5;"></div></div><img decoding="async" class="srcset-auto srcset-on-layout wp-image-159901 srcset-sizes-done" src="https://hnsecurity.it/wp-content/uploads/2025/09/CIRCUITI.jpg" width="1600" height="836" alt="" data-no-bp="" data-bp="720" data-uniqueid="159901-121652" data-guid="https://hnsecurity.it/wp-content/uploads/2025/09/CIRCUITI.jpg" data-path="2025/09/CIRCUITI.jpg" data-width="1600" data-height="836" data-singlew="2" data-singleh="33" data-crop="" loading="lazy"></a></div>
					</div>
				</div><div class="t-entry-text">
									<div class="t-entry-text-tc half-block-padding"><div class="t-entry"><p class="t-entry-meta"><span class="t-entry-category t-entry-category-91 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/articles/">Articles</a></span></p><p class="t-entry-meta"><span class="t-entry-date">June 18, 2025</span></p><h3 class="t-entry-title h5 title-scale "><a href="https://hnsecurity.it/blog/fault-injection-follow-the-white-rabbit/" target="_self">Fault Injection – Follow the White Rabbit</a></h3><div class="t-entry-excerpt " style="transform: translateY(16.0012px);"></div></div></div>
							</div></div></div></div><div class="owl-item" data-index="7" style="width: 384px;"><div class="tmb tmb-carousel atc-typography-inherit tmb-iso-h33 tmb-round img-round-lg tmb-light tmb-text-showed tmb-overlay-anim tmb-content-left  grid-cat-76 grid-cat-81 grid-cat-91 tmb-id-5512 tmb-content-under tmb-media-first" style="transition-delay: 120ms; transition-duration: 320ms;"><div class="t-inside style-color-xsdn-bg no-anim srcset-lazy-animations"><div class="t-entry-visual"><div class="t-entry-visual-tc"><div class="t-entry-visual-cont"><div class="dummy" style="padding-top: 52.3%;"></div><a role="button" tabindex="-1" href="https://hnsecurity.it/blog/my-zero-day-quest-bluehat-podcast/?media_link=1" class="pushed" aria-label="ZeroDay logo" target="_self" data-lb-index="6"><div class="t-entry-visual-overlay"><div class="t-entry-visual-overlay-in style-color-wayh-bg" style="opacity: 0.5;"></div></div><img decoding="async" class="srcset-auto srcset-on-layout wp-image-159967 srcset-sizes-done" src="https://hnsecurity.it/wp-content/uploads/2025/09/ZERODAY.jpg" width="1600" height="836" alt="ZeroDay logo" data-no-bp="" data-bp="720" data-uniqueid="159967-191167" data-guid="https://hnsecurity.it/wp-content/uploads/2025/09/ZERODAY.jpg" data-path="2025/09/ZERODAY.jpg" data-width="1600" data-height="836" data-singlew="2" data-singleh="33" data-crop="" loading="lazy"></a></div>
					</div>
				</div><div class="t-entry-text">
									<div class="t-entry-text-tc half-block-padding"><div class="t-entry"><p class="t-entry-meta"><span class="t-entry-category t-entry-category-76 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/events/">Events</a></span><span class="t-entry-category t-entry-category-81 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/vulnerabilities/">Vulnerabilities</a></span><span class="t-entry-category t-entry-category-91 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/articles/">Articles</a></span></p><p class="t-entry-meta"><span class="t-entry-date">May 6, 2025</span></p><h3 class="t-entry-title h5 title-scale "><a href="https://hnsecurity.it/blog/my-zero-day-quest-bluehat-podcast/" target="_self">My Zero Day Quest &amp; BlueHat Podcast</a></h3><div class="t-entry-excerpt " style="transform: translateY(16.0012px);"></div></div></div>
							</div></div></div></div><div class="owl-item" data-index="8" style="width: 384px;"><div class="tmb tmb-carousel atc-typography-inherit tmb-iso-h33 tmb-round img-round-lg tmb-light tmb-text-showed tmb-overlay-anim tmb-content-left  grid-cat-88 grid-cat-91 tmb-id-5276 tmb-content-under tmb-media-first" style="transition-delay: 120ms; transition-duration: 320ms;"><div class="t-inside style-color-xsdn-bg no-anim srcset-lazy-animations"><div class="t-entry-visual"><div class="t-entry-visual-tc"><div class="t-entry-visual-cont"><div class="dummy" style="padding-top: 52.3%;"></div><a role="button" tabindex="-1" href="https://hnsecurity.it/blog/aiding-reverse-engineering-with-rust-and-a-local-llm/?media_link=1" class="pushed" aria-label="Rust logo" target="_self" data-lb-index="7"><div class="t-entry-visual-overlay"><div class="t-entry-visual-overlay-in style-color-wayh-bg" style="opacity: 0.5;"></div></div><img decoding="async" class="srcset-auto srcset-on-layout wp-image-159953 srcset-sizes-done" src="https://hnsecurity.it/wp-content/uploads/2025/09/RUST.jpg" width="1600" height="836" alt="Rust logo" data-no-bp="" data-bp="720" data-uniqueid="159953-122584" data-guid="https://hnsecurity.it/wp-content/uploads/2025/09/RUST.jpg" data-path="2025/09/RUST.jpg" data-width="1600" data-height="836" data-singlew="2" data-singleh="33" data-crop="" loading="lazy"></a></div>
					</div>
				</div><div class="t-entry-text">
									<div class="t-entry-text-tc half-block-padding"><div class="t-entry"><p class="t-entry-meta"><span class="t-entry-category t-entry-category-88 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/tools/">Tools</a></span><span class="t-entry-category t-entry-category-91 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/articles/">Articles</a></span></p><p class="t-entry-meta"><span class="t-entry-date">April 15, 2025</span></p><h3 class="t-entry-title h5 title-scale "><a href="https://hnsecurity.it/blog/aiding-reverse-engineering-with-rust-and-a-local-llm/" target="_self">Aiding reverse engineering with Rust and a local LLM</a></h3><div class="t-entry-excerpt " style="transform: translateY(16.001px);"></div></div></div>
							</div></div></div></div><div class="owl-item" data-index="9" style="width: 384px;"><div class="tmb tmb-carousel atc-typography-inherit tmb-iso-h33 tmb-round img-round-lg tmb-light tmb-text-showed tmb-overlay-anim tmb-content-left  grid-cat-88 grid-cat-91 tmb-id-4418 tmb-content-under tmb-media-first" style="transition-delay: 120ms; transition-duration: 320ms;"><div class="t-inside style-color-xsdn-bg no-anim srcset-lazy-animations"><div class="t-entry-visual"><div class="t-entry-visual-tc"><div class="t-entry-visual-cont"><div class="dummy" style="padding-top: 52.3%;"></div><a role="button" tabindex="-1" href="https://hnsecurity.it/blog/streamlining-vulnerability-research-with-ida-pro-and-rust/?media_link=1" class="pushed" aria-label="Rust logo" target="_self" data-lb-index="8"><div class="t-entry-visual-overlay"><div class="t-entry-visual-overlay-in style-color-wayh-bg" style="opacity: 0.5;"></div></div><img decoding="async" class="srcset-auto srcset-on-layout wp-image-159953 srcset-sizes-done" src="https://hnsecurity.it/wp-content/uploads/2025/09/RUST.jpg" width="1600" height="836" alt="Rust logo" data-no-bp="" data-bp="720" data-uniqueid="159953-646490" data-guid="https://hnsecurity.it/wp-content/uploads/2025/09/RUST.jpg" data-path="2025/09/RUST.jpg" data-width="1600" data-height="836" data-singlew="2" data-singleh="33" data-crop="" loading="lazy"></a></div>
					</div>
				</div><div class="t-entry-text">
									<div class="t-entry-text-tc half-block-padding"><div class="t-entry"><p class="t-entry-meta"><span class="t-entry-category t-entry-category-88 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/tools/">Tools</a></span><span class="t-entry-category t-entry-category-91 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/articles/">Articles</a></span></p><p class="t-entry-meta"><span class="t-entry-date">February 25, 2025</span></p><h3 class="t-entry-title h5 title-scale "><a href="https://hnsecurity.it/blog/streamlining-vulnerability-research-with-ida-pro-and-rust/" target="_self">Streamlining vulnerability research with IDA Pro and Rust</a></h3><div class="t-entry-excerpt " style="transform: translateY(16.001px);"></div></div></div>
							</div></div></div></div></div></div>					<div class="owl-nav disabled"><button type="button" aria-label="Previous" class="owl-prev style-light style-override" style="margin-left: -16px;"><div class="owl-nav-container btn-default btn-hover-nobg" tabindex="0"><i class="fa fa-fw fa-angle-left"></i></div></button><button type="button" aria-label="Next" class="owl-next style-light style-override" style="margin-right: -16px;"><div class="owl-nav-container btn-default btn-hover-nobg" aria-label="Next" tabindex="0"><i class="fa fa-fw fa-angle-right"></i></div></button></div><div class="owl-dots uncode_index-dot_classes limit-width owl-dots-classes"><button class="owl-dot active" aria-label="Slide 1"><span></span></button><button class="owl-dot" aria-label="Slide 2"><span></span></button></div></div>	
	

	</div>				</div>
</div></div></div></div></div></div></div></div></div><div class="post-footer post-footer-light row-container"><div class="row-container">
		  					<div class="row row-parent style-light no-top-padding double-bottom-padding" style="max-width: 804px; margin: auto;">
									<div class="post-share">
	          						<div class="detail-container margin-auto">
													<div class="share-button share-buttons share-inline only-icon sharer-0" style="display: block;"><label class="social-export"><span></span></label></div>
												</div>
											</div>
								</div>
							</div></div></div>
          </div>
        </article>								</div><!-- sections container -->
							</div><!-- page wrapper -->
												
												<div class="overlay-menu-focus style-dark-bg "></div>					</div><!-- main container -->
				</div><!-- main wrapper -->
							</div><!-- box container -->
					</div><!-- box wrapper -->
		<div class="style-light footer-scroll-top footer-scroll-higher"><a href="https://hnsecurity.it/blog/customizing-sliver-part-2/#" class="scroll-top" aria-label="Scroll to top"><i class="fa fa-angle-up fa-stack btn-default btn-hover-nobg"></i></a></div>
	

































		
		
	
		<!-- Cookie Notice plugin v2.5.12 by Hu-manity.co https://hu-manity.co/ -->
		<div id="cookie-notice" role="dialog" class="cookie-notice-hidden cookie-revoke-hidden cn-position-bottom" aria-label="Cookie Notice" style="background-color: rgba(255,255,255,1);"><div class="cookie-notice-container" style="color: #2d2d2d"><span id="cn-notice-text" class="cn-text-container">We use cookies to improve your browsing experience and analyze our traffic. By clicking "Accept all", you consent to the use of cookies.</span><span id="cn-notice-buttons" class="cn-buttons-container"><button id="cn-accept-cookie" data-cookie-set="accept" class="cn-set-cookie cn-button cn-button-custom custom-link btn btn-cookiebanner border-width-0 btn-accent btn-circle" aria-label="Accept All">Accept All</button><button data-link-url="https://hnsecurity.it/privacy-policy/" data-link-target="_blank" id="cn-more-info" class="cn-more-info cn-button cn-button-custom custom-link btn btn-cookiebanner border-width-0 btn-accent btn-circle" aria-label="Privacy policy">Privacy policy</button></span><button type="button" id="cn-close-notice" data-cookie-set="accept" class="cn-close-icon" aria-label="Reject All"></button></div>
			
		</div>
		<!-- / Cookie Notice plugin -->


</body></html><!--
	generated in 1.928 seconds
	111039 bytes batcached for 86400 seconds
-->