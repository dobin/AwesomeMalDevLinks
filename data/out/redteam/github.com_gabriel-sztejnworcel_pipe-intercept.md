# https://github.com/gabriel-sztejnworcel/pipe-intercept

[Skip to content](https://github.com/gabriel-sztejnworcel/pipe-intercept#start-of-content)

You signed in with another tab or window. [Reload](https://github.com/gabriel-sztejnworcel/pipe-intercept) to refresh your session.You signed out in another tab or window. [Reload](https://github.com/gabriel-sztejnworcel/pipe-intercept) to refresh your session.You switched accounts on another tab or window. [Reload](https://github.com/gabriel-sztejnworcel/pipe-intercept) to refresh your session.Dismiss alert

{{ message }}

[gabriel-sztejnworcel](https://github.com/gabriel-sztejnworcel)/ **[pipe-intercept](https://github.com/gabriel-sztejnworcel/pipe-intercept)** Public

- [Notifications](https://github.com/login?return_to=%2Fgabriel-sztejnworcel%2Fpipe-intercept) You must be signed in to change notification settings
- [Fork\\
17](https://github.com/login?return_to=%2Fgabriel-sztejnworcel%2Fpipe-intercept)
- [Star\\
280](https://github.com/login?return_to=%2Fgabriel-sztejnworcel%2Fpipe-intercept)


Intercept Windows Named Pipes communication using Burp or similar HTTP proxy tools


### License

[MIT license](https://github.com/gabriel-sztejnworcel/pipe-intercept/blob/main/LICENSE)

[280\\
stars](https://github.com/gabriel-sztejnworcel/pipe-intercept/stargazers) [17\\
forks](https://github.com/gabriel-sztejnworcel/pipe-intercept/forks) [Branches](https://github.com/gabriel-sztejnworcel/pipe-intercept/branches) [Tags](https://github.com/gabriel-sztejnworcel/pipe-intercept/tags) [Activity](https://github.com/gabriel-sztejnworcel/pipe-intercept/activity)

[Star](https://github.com/login?return_to=%2Fgabriel-sztejnworcel%2Fpipe-intercept)

[Notifications](https://github.com/login?return_to=%2Fgabriel-sztejnworcel%2Fpipe-intercept) You must be signed in to change notification settings

# gabriel-sztejnworcel/pipe-intercept

main

[**4** Branches](https://github.com/gabriel-sztejnworcel/pipe-intercept/branches) [**0** Tags](https://github.com/gabriel-sztejnworcel/pipe-intercept/tags)

[Go to Branches page](https://github.com/gabriel-sztejnworcel/pipe-intercept/branches)[Go to Tags page](https://github.com/gabriel-sztejnworcel/pipe-intercept/tags)

Go to file

Code

Open more actions menu

## Folders and files

| Name | Name | Last commit message | Last commit date |
| --- | --- | --- | --- |
| ## Latest commit<br>[![gabriel-sztejnworcel](https://avatars.githubusercontent.com/u/4405244?v=4&size=40)](https://github.com/gabriel-sztejnworcel)[gabriel-sztejnworcel](https://github.com/gabriel-sztejnworcel/pipe-intercept/commits?author=gabriel-sztejnworcel)<br>[Merge pull request](https://github.com/gabriel-sztejnworcel/pipe-intercept/commit/fa99353e3736ef3975691d365e7104fb02556728) [#6](https://github.com/gabriel-sztejnworcel/pipe-intercept/pull/6) [from gabriel-sztejnworcel/fix-for-new-versions](https://github.com/gabriel-sztejnworcel/pipe-intercept/commit/fa99353e3736ef3975691d365e7104fb02556728)<br>Open commit details<br>5 months agoSep 18, 2025<br>[fa99353](https://github.com/gabriel-sztejnworcel/pipe-intercept/commit/fa99353e3736ef3975691d365e7104fb02556728) · 5 months agoSep 18, 2025<br>## History<br>[56 Commits](https://github.com/gabriel-sztejnworcel/pipe-intercept/commits/main/) <br>Open commit details<br>[View commit history for this file.](https://github.com/gabriel-sztejnworcel/pipe-intercept/commits/main/) 56 Commits |
| [images](https://github.com/gabriel-sztejnworcel/pipe-intercept/tree/main/images "images") | [images](https://github.com/gabriel-sztejnworcel/pipe-intercept/tree/main/images "images") | [change image](https://github.com/gabriel-sztejnworcel/pipe-intercept/commit/13f18274a49722537a362ddbcea97efdeebc27df "change image") | 4 years agoMay 15, 2022 |
| [tests](https://github.com/gabriel-sztejnworcel/pipe-intercept/tree/main/tests "tests") | [tests](https://github.com/gabriel-sztejnworcel/pipe-intercept/tree/main/tests "tests") | [Fix readme](https://github.com/gabriel-sztejnworcel/pipe-intercept/commit/ac6a722b56e10e3119f9bbde45dd87d6d394a6c6 "Fix readme") | 5 months agoSep 18, 2025 |
| [.gitignore](https://github.com/gabriel-sztejnworcel/pipe-intercept/blob/main/.gitignore ".gitignore") | [.gitignore](https://github.com/gabriel-sztejnworcel/pipe-intercept/blob/main/.gitignore ".gitignore") | [Initial commit](https://github.com/gabriel-sztejnworcel/pipe-intercept/commit/c784009db446980f87e65489ead2d798745a1850 "Initial commit") | 4 years agoMay 13, 2022 |
| [LICENSE](https://github.com/gabriel-sztejnworcel/pipe-intercept/blob/main/LICENSE "LICENSE") | [LICENSE](https://github.com/gabriel-sztejnworcel/pipe-intercept/blob/main/LICENSE "LICENSE") | [Create LICENSE](https://github.com/gabriel-sztejnworcel/pipe-intercept/commit/745600e26fcd6c2f4ba71d0b910e0b241bb1b1b6 "Create LICENSE") | 4 years agoMay 15, 2022 |
| [README.md](https://github.com/gabriel-sztejnworcel/pipe-intercept/blob/main/README.md "README.md") | [README.md](https://github.com/gabriel-sztejnworcel/pipe-intercept/blob/main/README.md "README.md") | [Fix readme](https://github.com/gabriel-sztejnworcel/pipe-intercept/commit/ac6a722b56e10e3119f9bbde45dd87d6d394a6c6 "Fix readme") | 5 months agoSep 18, 2025 |
| [\_\_init\_\_.py](https://github.com/gabriel-sztejnworcel/pipe-intercept/blob/main/__init__.py "__init__.py") | [\_\_init\_\_.py](https://github.com/gabriel-sztejnworcel/pipe-intercept/blob/main/__init__.py "__init__.py") | [tests](https://github.com/gabriel-sztejnworcel/pipe-intercept/commit/8cbb296c911a535623c5b54c9d02057193cf5e2b "tests") | 4 years agoMay 21, 2022 |
| [config\_handler.py](https://github.com/gabriel-sztejnworcel/pipe-intercept/blob/main/config_handler.py "config_handler.py") | [config\_handler.py](https://github.com/gabriel-sztejnworcel/pipe-intercept/blob/main/config_handler.py "config_handler.py") | [default port for http proxy, default random port for WebSocket](https://github.com/gabriel-sztejnworcel/pipe-intercept/commit/1ff038d2690251f2cf03d9dfdd7a1622914ef920 "default port for http proxy, default random port for WebSocket") | 4 years agoMay 17, 2022 |
| [pipe\_helper.py](https://github.com/gabriel-sztejnworcel/pipe-intercept/blob/main/pipe_helper.py "pipe_helper.py") | [pipe\_helper.py](https://github.com/gabriel-sztejnworcel/pipe-intercept/blob/main/pipe_helper.py "pipe_helper.py") | [start tests](https://github.com/gabriel-sztejnworcel/pipe-intercept/commit/bbd44fee93c75c571d28c05629263cf7ce8437fa "start tests") | 4 years agoMay 19, 2022 |
| [pipe\_intercept.py](https://github.com/gabriel-sztejnworcel/pipe-intercept/blob/main/pipe_intercept.py "pipe_intercept.py") | [pipe\_intercept.py](https://github.com/gabriel-sztejnworcel/pipe-intercept/blob/main/pipe_intercept.py "pipe_intercept.py") | [Fix for new version of websockets, remove http\_parser dependency in t…](https://github.com/gabriel-sztejnworcel/pipe-intercept/commit/fbf5ec15dd7225bb9edb81a1a297212dc3b11c8a "Fix for new version of websockets, remove http_parser dependency in tests, fix tests to allow running from a virtualenv") | 5 months agoSep 18, 2025 |
| [requirements.txt](https://github.com/gabriel-sztejnworcel/pipe-intercept/blob/main/requirements.txt "requirements.txt") | [requirements.txt](https://github.com/gabriel-sztejnworcel/pipe-intercept/blob/main/requirements.txt "requirements.txt") | [Fix for new version of websockets, remove http\_parser dependency in t…](https://github.com/gabriel-sztejnworcel/pipe-intercept/commit/fbf5ec15dd7225bb9edb81a1a297212dc3b11c8a "Fix for new version of websockets, remove http_parser dependency in tests, fix tests to allow running from a virtualenv") | 5 months agoSep 18, 2025 |
| View all files |

## Repository files navigation

# pipe-intercept

[Permalink: pipe-intercept](https://github.com/gabriel-sztejnworcel/pipe-intercept#pipe-intercept)

#### Intercept Windows Named Pipes communication using Burp or similar HTTP proxy tools

[Permalink: Intercept Windows Named Pipes communication using Burp or similar HTTP proxy tools](https://github.com/gabriel-sztejnworcel/pipe-intercept#intercept-windows-named-pipes-communication-using-burp-or-similar-http-proxy-tools)

Named Pipes are very popular for interprocess communication on Windows. They are used in many applications, including Windows Remote Procedure Call (RPC). The purpose of this tool is to allow security researchers and pentesters to perform security assessment for applications that use named pipes.
This project is inspired by the amazing [MITM\_Intercept](https://github.com/cyberark/MITM_Intercept) project from CyberArk Labs.

### How Does it Work?

[Permalink: How Does it Work?](https://github.com/gabriel-sztejnworcel/pipe-intercept#how-does-it-work)

The tool creates a pipe client/server proxy with a WebSocket client/server bridge. The WebSocket client connects to the WebSocket server through an HTTP proxy such as Burp.

**Important note:** This tool uses win32 api to create the named pipes, so it only works on Windows. Currently it needs to run on the same machine as the target pipe server and the HTTP proxy. I might add an option to use a remote proxy, and an option to relay to a remote pipe server, but the tool will still have to run on Windows.

Flow diagram:

[![Flow Diagram](https://github.com/gabriel-sztejnworcel/pipe-intercept/raw/main/images/pipe-intercept.png)](https://github.com/gabriel-sztejnworcel/pipe-intercept/blob/main/images/pipe-intercept.png)

It's important to understand that this tool works by creating separate pipe server instances, apart from the instances created by the target server application, making the target client application connect to these proxy instances. This means a few things:

1. If the tool runs after the target server application has started and created its pipe server instances, the user running the tool must have enough permissions to create pipe server instances
2. Usually, a server application will always have one pipe server instance waiting for a client connection. Clients connect in FIFO order so it's possible that after you run the tool, the first client will connect to the instance created by the target application, and the next clients will start going through the proxy. Some applications might behave differently, they might not have a listening instance all the time, or they might even have more than one - at the moment you will need to try and understand how your target application works
3. Some applications will check the pipe client/server on the other end (by process ID, username etc.) and use it as an authentication method. In these cases the tool might not work
4. In case the tool creates the first pipe server instance, the target server application might fail to start (if it uses FILE\_FLAG\_FIRST\_PIPE\_INSTANCE)

As you can see from the items above, using this tool could change the behavior of the target application. Please remember that this tool is primarily for security testing, do not use it in production systems.

### Dependencies

[Permalink: Dependencies](https://github.com/gabriel-sztejnworcel/pipe-intercept#dependencies)

The tool was tested with Python version 3.13.7. Setup:

```
python -m venv .venv
.venv\Scripts\activate.bat
pip install -r requirements.txt
```

### Usage

[Permalink: Usage](https://github.com/gabriel-sztejnworcel/pipe-intercept#usage)

```
usage: pipe_intercept.py [-h] --pipe-name PIPE_NAME [--ws-port WS_PORT] [--http-proxy-port HTTP_PROXY_PORT] [--log-level {CRITICAL,ERROR,WARNING,INFO,DEBUG}]

options:
  -h, --help            show this help message and exit
  --pipe-name PIPE_NAME
                        The name of the pipe to be intercepted
  --ws-port WS_PORT     An available port number for the internal WebSocket server (if not specified, a random port will be used)
  --http-proxy-port HTTP_PROXY_PORT
                        The port number of the HTTP proxy (if not specified, the default is 8080)
  --log-level {CRITICAL,ERROR,WARNING,INFO,DEBUG}
                        Log level (if not specified, the default is INFO)
```

### Run Tests

[Permalink: Run Tests](https://github.com/gabriel-sztejnworcel/pipe-intercept#run-tests)

From the root folder (pipe-intercept):

```
pytest
```

### Example

[Permalink: Example](https://github.com/gabriel-sztejnworcel/pipe-intercept#example)

Docker on Windows uses a named pipe to communicate between the client and the docker service. The pipe name is "\\\.\\pipe\\docker\_engine". Let's see how we can intercept this communication. We start by running the tool:

```
C:\pipe-intercept>python pipe_intercept.py --pipe-name docker_engine

INFO:websockets.server:server listening on 127.0.0.1:12037
```

Now we can start Burp, and from another shell create a Windows container:

```
C:\pipe-intercept>docker run -it --name win mcr.microsoft.com/windows:1809-amd64 cmd

Microsoft Windows [Version 10.0.17763.2803]
(c) 2018 Microsoft Corporation. All rights reserved.

C:\>dir
 Volume in drive C has no label.
 Volume Serial Number is 5C09-8FFA

 Directory of C:\

05/07/2020  06:16 AM             5,510 License.txt
04/04/2022  02:57 PM    <DIR>          PerfLogs
04/04/2022  04:13 PM    <DIR>          Program Files
04/04/2022  02:57 PM    <DIR>          Program Files (x86)
04/04/2022  04:17 PM    <DIR>          Users
04/04/2022  04:13 PM    <DIR>          Windows
               1 File(s)          5,510 bytes
               5 Dir(s)  21,188,812,800 bytes free

C:\>
```

Now if we open the WebSocket tab in Burp, we can see the communication:

[![Burp WebSocket History](https://github.com/gabriel-sztejnworcel/pipe-intercept/raw/main/images/burp_ws_history.png)](https://github.com/gabriel-sztejnworcel/pipe-intercept/blob/main/images/burp_ws_history.png)

We can also turn interception on and change the message:

[![Burp Intercept](https://github.com/gabriel-sztejnworcel/pipe-intercept/raw/main/images/burp_intercept.png)](https://github.com/gabriel-sztejnworcel/pipe-intercept/blob/main/images/burp_intercept.png)

```
Microsoft Windows [Version 10.0.17763.2803]
(c) 2018 Microsoft Corporation. All rights reserved.

C:\>dir
 Volume in drive C has no label.
 Volume Serial Number is 5C09-8FFA

 Directory of C:\

05/07/2020  06:16 AM             5,510 License.txt
04/04/2022  02:57 PM    <DIR>          PerfLogs
04/04/2022  04:13 PM    <DIR>          Modified Name
04/04/2022  02:57 PM    <DIR>          Program Files (x86)
04/04/2022  04:17 PM    <DIR>          Users
04/04/2022  04:13 PM    <DIR>          Windows
               1 File(s)          5,510 bytes
               5 Dir(s)  21,188,288,512 bytes free

C:\>
```

## About

Intercept Windows Named Pipes communication using Burp or similar HTTP proxy tools


### Topics

[mitm](https://github.com/topics/mitm "Topic: mitm") [named-pipes](https://github.com/topics/named-pipes "Topic: named-pipes") [windows-internals](https://github.com/topics/windows-internals "Topic: windows-internals") [interception-tools](https://github.com/topics/interception-tools "Topic: interception-tools")

### Resources

[Readme](https://github.com/gabriel-sztejnworcel/pipe-intercept#readme-ov-file)

### License

[MIT license](https://github.com/gabriel-sztejnworcel/pipe-intercept#MIT-1-ov-file)

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/gabriel-sztejnworcel/pipe-intercept).

[Activity](https://github.com/gabriel-sztejnworcel/pipe-intercept/activity)

### Stars

[**280**\\
stars](https://github.com/gabriel-sztejnworcel/pipe-intercept/stargazers)

### Watchers

[**5**\\
watching](https://github.com/gabriel-sztejnworcel/pipe-intercept/watchers)

### Forks

[**17**\\
forks](https://github.com/gabriel-sztejnworcel/pipe-intercept/forks)

[Report repository](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fgabriel-sztejnworcel%2Fpipe-intercept&report=gabriel-sztejnworcel+%28user%29)

## [Releases](https://github.com/gabriel-sztejnworcel/pipe-intercept/releases)

No releases published

## [Packages\  0](https://github.com/users/gabriel-sztejnworcel/packages?repo_name=pipe-intercept)

No packages published

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/gabriel-sztejnworcel/pipe-intercept).

## Languages

- [Python100.0%](https://github.com/gabriel-sztejnworcel/pipe-intercept/search?l=python)

You can’t perform that action at this time.