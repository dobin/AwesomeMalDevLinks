# https://github.com/boku7/Loki

[Skip to content](https://github.com/boku7/Loki#start-of-content)

You signed in with another tab or window. [Reload](https://github.com/boku7/Loki) to refresh your session.You signed out in another tab or window. [Reload](https://github.com/boku7/Loki) to refresh your session.You switched accounts on another tab or window. [Reload](https://github.com/boku7/Loki) to refresh your session.Dismiss alert

{{ message }}

[boku7](https://github.com/boku7)/ **[Loki](https://github.com/boku7/Loki)** Public

- [Notifications](https://github.com/login?return_to=%2Fboku7%2FLoki) You must be signed in to change notification settings
- [Fork\\
212](https://github.com/login?return_to=%2Fboku7%2FLoki)
- [Star\\
1.3k](https://github.com/login?return_to=%2Fboku7%2FLoki)


üßô‚Äç‚ôÇÔ∏è Node.js Command & Control for Script-Jacking Vulnerable Electron Applications


### License

[View license](https://github.com/boku7/Loki/blob/main/LICENSE)

[1.3k\\
stars](https://github.com/boku7/Loki/stargazers) [212\\
forks](https://github.com/boku7/Loki/forks) [Branches](https://github.com/boku7/Loki/branches) [Tags](https://github.com/boku7/Loki/tags) [Activity](https://github.com/boku7/Loki/activity)

[Star](https://github.com/login?return_to=%2Fboku7%2FLoki)

[Notifications](https://github.com/login?return_to=%2Fboku7%2FLoki) You must be signed in to change notification settings

# boku7/Loki

main

[**1** Branch](https://github.com/boku7/Loki/branches) [**4** Tags](https://github.com/boku7/Loki/tags)

[Go to Branches page](https://github.com/boku7/Loki/branches)[Go to Tags page](https://github.com/boku7/Loki/tags)

Go to file

Code

Open more actions menu

## Folders and files

| Name | Name | Last commit message | Last commit date |
| --- | --- | --- | --- |
| ## Latest commit<br>![Bobby Cooke](https://github.githubassets.com/images/gravatars/gravatar-user-420.png?size=40)![Bobby Cooke](https://github.githubassets.com/images/gravatars/gravatar-user-420.png?size=40)<br>Bobby Cooke<br>and<br>Bobby Cooke<br>[Client v2.4.0 - UI enhancements. Dark Mode, task queuing, cancel/modi‚Ä¶](https://github.com/boku7/Loki/commit/fd935148873b93b9d7d8d8ec16f666f38e769064)<br>Open commit details<br>8 months agoJun 17, 2025<br>[fd93514](https://github.com/boku7/Loki/commit/fd935148873b93b9d7d8d8ec16f666f38e769064)¬†¬∑¬†8 months agoJun 17, 2025<br>## History<br>[120 Commits](https://github.com/boku7/Loki/commits/main/) <br>Open commit details<br>[View commit history for this file.](https://github.com/boku7/Loki/commits/main/) 120 Commits |
| [agent](https://github.com/boku7/Loki/tree/main/agent "agent") | [agent](https://github.com/boku7/Loki/tree/main/agent "agent") | [added link and unlink commands to client and agent. TCP agent to agen‚Ä¶](https://github.com/boku7/Loki/commit/337eb5535f8f4b1824e3ae476b99ac8bbbc75fdd "added link and unlink commands to client and agent. TCP agent to agent linking capabilities added\"") | 9 months agoMay 13, 2025 |
| [backdoor](https://github.com/boku7/Loki/tree/main/backdoor "backdoor") | [backdoor](https://github.com/boku7/Loki/tree/main/backdoor "backdoor") | [added link and unlink commands to client and agent. TCP agent to agen‚Ä¶](https://github.com/boku7/Loki/commit/337eb5535f8f4b1824e3ae476b99ac8bbbc75fdd "added link and unlink commands to client and agent. TCP agent to agent linking capabilities added\"") | 9 months agoMay 13, 2025 |
| [client](https://github.com/boku7/Loki/tree/main/client "client") | [client](https://github.com/boku7/Loki/tree/main/client "client") | [Client v2.4.0 - UI enhancements. Dark Mode, task queuing, cancel/modi‚Ä¶](https://github.com/boku7/Loki/commit/fd935148873b93b9d7d8d8ec16f666f38e769064 "Client v2.4.0 - UI enhancements. Dark Mode, task queuing, cancel/modify queued tasks, change agent & dashboard background images, change agent font+fontSize+fontColor, zoom, dashboard functionality enhancements, Agent command history option to prevent laggy agent window statups, agent window now shows loading when loading command history") | 8 months agoJun 17, 2025 |
| [dev](https://github.com/boku7/Loki/tree/main/dev "dev") | [dev](https://github.com/boku7/Loki/tree/main/dev "dev") | [COFFLoader capability added](https://github.com/boku7/Loki/commit/3d45533e762cd7a42f70c488688470e521b5dac6 "COFFLoader capability added") | 10 months agoMay 5, 2025 |
| [docs](https://github.com/boku7/Loki/tree/main/docs "docs") | [docs](https://github.com/boku7/Loki/tree/main/docs "docs") | [added link and unlink commands to client and agent. TCP agent to agen‚Ä¶](https://github.com/boku7/Loki/commit/337eb5535f8f4b1824e3ae476b99ac8bbbc75fdd "added link and unlink commands to client and agent. TCP agent to agent linking capabilities added\"") | 9 months agoMay 13, 2025 |
| [.gitignore](https://github.com/boku7/Loki/blob/main/.gitignore ".gitignore") | [.gitignore](https://github.com/boku7/Loki/blob/main/.gitignore ".gitignore") | [added more info and a table about the c2 commands](https://github.com/boku7/Loki/commit/790a0ef1223c7c3b85939be955da5a6b2e00c928 "added more info and a table about the c2 commands") | 11 months agoApr 4, 2025 |
| [LICENSE](https://github.com/boku7/Loki/blob/main/LICENSE "LICENSE") | [LICENSE](https://github.com/boku7/Loki/blob/main/LICENSE "LICENSE") | [Create LICENSE](https://github.com/boku7/Loki/commit/5601216b8850214b5b60119814095a8ac86f3e20 "Create LICENSE") | 11 months agoApr 3, 2025 |
| [README.md](https://github.com/boku7/Loki/blob/main/README.md "README.md") | [README.md](https://github.com/boku7/Loki/blob/main/README.md "README.md") | [Added Hyper and LM Studio as a target candidate for the c2](https://github.com/boku7/Loki/commit/31a051463c9e55f6e5352f155b6e8314b2871a90 "Added Hyper and LM Studio as a target candidate for the c2") | 9 months agoJun 2, 2025 |
| [create\_agent\_payload.js](https://github.com/boku7/Loki/blob/main/create_agent_payload.js "create_agent_payload.js") | [create\_agent\_payload.js](https://github.com/boku7/Loki/blob/main/create_agent_payload.js "create_agent_payload.js") | [added link and unlink commands to client and agent. TCP agent to agen‚Ä¶](https://github.com/boku7/Loki/commit/337eb5535f8f4b1824e3ae476b99ac8bbbc75fdd "added link and unlink commands to client and agent. TCP agent to agent linking capabilities added\"") | 9 months agoMay 13, 2025 |
| View all files |

## Repository files navigation

# üßô‚Äç‚ôÇÔ∏è Loki Command & Control

[Permalink: üßô‚Äç‚ôÇÔ∏è Loki Command & Control](https://github.com/boku7/Loki#%E2%80%8D%EF%B8%8F-loki-command--control)

Loki is a stage-1 command and control (C2) framework written in Node.js, built to script-jack vulnerable Electron apps _[MITRE ATT&CK T1218.015](https://attack.mitre.org/techniques/T1218/015/)_. Developed for red team operations, Loki enables evasion of security software and bypasses application controls by exploiting trusted, signed Electron apps.

Script-jacking hijacks the execution flow of an Electron app by modifying JavaScript files loaded in at runtime with arbitrary Node.js code. This technique can be leveraged to:

- **Backdoor Electron app**
- **Hollow Electron app**
- Chain execution to another process

_While several tools already address leveraging script-jacking to chain execution to another process, Loki is the first to enable backdooring and hollowing of signed Electron apps without invalidating their code signing signature._

For more details on how Loki works, checkout this blog post:

- [Bypassing Windows Defender Application Control with Loki C2](https://www.ibm.com/think/x-force/bypassing-windows-defender-application-control-loki-c2)

[![](https://github.com/boku7/Loki/raw/main/docs/images/lokiscreencap.png)](https://github.com/boku7/Loki/blob/main/docs/images/lokiscreencap.png)

## üöÄ Contributors

[Permalink: üöÄ Contributors](https://github.com/boku7/Loki#-contributors)

| Name | Contributions |
| --- | --- |
| [Bobby Cooke](https://x.com/0xBoku) | Creator & Maintainer |
| [Dylan Tran](https://x.com/d_tranman) | Creator |
| [Ellis Springe](https://x.com/knavesec) | Alpha Tester |
| [Shawn Jones](https://x.com/anthemtotheego) | Assembly Execution Code |
| [Trusted Sec](https://github.com/trustedsec/COFFLoader) | COFFLoader Code |
| [Simon Exley](https://www.linkedin.com/in/simon-exley-355816194/) | Video Creator |
| [Clinton Elves](https://www.linkedin.com/in/clinton-elves-180ba0148/) | Video Creator |
| [John Hammond](https://x.com/_JohnHammond) | Video Creator |

## Videos

[Permalink: Videos](https://github.com/boku7/Loki#videos)

Check out this video by [John Hammond](https://x.com/_JohnHammond) on backdooring Cursor AI with Loki C2! üé©

- In the video he walks through discovering a new vulnerable Electron application, backdooring it with Loki C2, getting setup with the client GUI, and we even came up with two ways to keep the app running persistently in the background ü™Ñ -- Cursor runs normally from the end users perspective! ü•∑

[![I Backdoored Cursor AI](https://github.com/boku7/Loki/raw/main/docs/images/hammond.png)](https://www.youtube.com/watch?v=FYok3diZY78)

Check out this video by [Simon Exley & Clinton Elves](https://x.com/SimonExley25688) on getting up and running with Loki C2! üßô‚Äç‚ôÇÔ∏è

[![Bypassing Windows Defender Application Control with Loki C2](https://github.com/boku7/Loki/raw/main/docs/images/youtubethumbnail.png)](https://www.youtube.com/watch?v=c8DgrpwJWw0)

## Features & Details

[Permalink: Features & Details](https://github.com/boku7/Loki#features--details)

- Azure Storage Blob C2 channel
  - SAS Token to protect C2 storage account
- AES encrypted C2 messages
- Proxy-aware agent
  - Uses Chromium renderer child processes for agent, shellcode execution, and assembly fork-n-run style execution -- inherits proxy-aware capabilities of Chromium.
- Teamserver-less
  - Unlike traditional C2's where agents send messages to a Teamserver, there is no Teamserver
  - The GUI client & agents both checkin to the same data-store
- Hidden exection -- runs in the background

### Commands

[Permalink: Commands](https://github.com/boku7/Loki#commands)

_All agent commands are written in native Node.JS and do not require additional dependencies or library load events. With the exception of the `scexec` and `assembly` commands which do a library load on `keytar.node` and `assembly.node`_

- All commands accept paths using `/`, `\` in paths will not work.

| Command | Description |
| --- | --- |
| `help` | Display help. Usage: `help` or `help scan` |
| `pwd` | Print working directory |
| `ls` | File and directory listing |
| `cat` | Display contents of a file |
| `env` | Display process environment variables |
| `spawn` | Spawn a child process |
| `drives` | List drives |
| `mv` | Move a file to a new destination |
| `sleep` | Sleep for seconds with jitter |
| `cp` | Copy a source file to a destination |
| `exit-all` | Exits the agent, agent won't callback anymore |
| `load` | Load a node PE file from disk into the process |
| `scexec` | Execute shellcode |
| `assembly` | Execute a .NET assembly and get command output |
| `upload` | Upload a file from your local operator box to the remote agent box |
| `download` | Download a file from remote agent box to local operator box |
| `scan` | Perform TCP network scan across CIDR range with selected ports |
| `dns` | DNS lookup. Leverages systems DNS configuration |
| `set` | Set the Node load paths for assembly node and scexec nodes |
| `bof` | Execute a COFF file and return output |

#### `Set` \- Loading Nodes from Application Control Exclusion Paths

[Permalink: Set - Loading Nodes from Application Control Exclusion Paths](https://github.com/boku7/Loki#set---loading-nodes-from-application-control-exclusion-paths)

- If there are application control rules preventing library loads for the node files you can use the `set` command to change the load paths for `assembly.node` and `scexec.node`.
- By using `ls`, `cat`, `cp` and `mv` you may be able to enumerate the application control rules to discover a writable directory that is an exclusion.
- With this you can put the node files in the exclusion directory and use the `set` command to change their load path to the exclusion directory to bypass the application control.
- For more details on this attack vector see the [CRTO2](https://training.zeropointsecurity.co.uk/courses/red-team-ops-ii) course by [Daniel Duggan (@\_RastaMouse)](https://x.com/_RastaMouse)

```
[04-04-2025 8:50AM MST] advsim$ help set
Set the Node load paths for assembly node and scexec nodes
	set scexec_path C:/Users/user/AppData/ExcludedApp/scexec.node
	set assembly_path C:/Users/user/AppData/ExcludedApp/assembly.node
[04-04-2025 8:51AM MST] advsim$ set scexec_path C:/Users/user/AppData/ExcludedApp/scexec.node
SCEXEC Node Load Path Set to : C:/Users/user/AppData/ExcludedApp/scexec.node
```

### Agent Features

[Permalink: Agent Features](https://github.com/boku7/Loki#agent-features)

[For more information on Agent features click here](https://github.com/boku7/Loki/blob/main/docs/features/agent.md)

### Client Features

[Permalink: Client Features](https://github.com/boku7/Loki#client-features)

[For more information on Client features click here](https://github.com/boku7/Loki/blob/main/docs/features/client.md)

## üßô‚Äç‚ôÇÔ∏è Deploy Illusions

[Permalink: üßô‚Äç‚ôÇÔ∏è Deploy Illusions](https://github.com/boku7/Loki#%E2%80%8D%EF%B8%8F-deploy-illusions)

First you need to identify a vulnerable Electron application which does not do ASAR security integrity checks such as `Microsoft Teams`. Newer applications may have integrity checks preventing backdooring. Older versions of the target app are more likely to be vulnerable.

- [Guide for Discovering Vulnerable Electron Apps](https://github.com/boku7/Loki/blob/main/docs/vulnhunt/electronapps.md)

| Vulnerable | App Name | EXE Name | Version | Discovery Credit |
| --- | --- | --- | --- | --- |
| ‚úÖ | Microsoft Teams | `Teams.exe` | `1.7.00.13456` | Andrew Kisliakov & [mr.d0x](https://twitter.com/@mrd0x) |
| ‚úÖ | Cursor | `cursor.exe` | `0.48.7.0` | [John Hammond](https://x.com/_JohnHammond) |
| ‚úÖ | VS Code | `code.exe` |  | [chompie1337](https://x.com/chompie1337) & [knavesec](https://x.com/knavesec) |
| ‚úÖ | Github Desktop | `GithubDesktop.exe` | `3.4.6.0` | [d\_tranman](https://x.com/d_tranman) & [0xBoku](https://x.com/0xBoku) |
| ‚úÖ | [Postman](https://www.postman.com/downloads/) | `Postman.exe` |  | [clod81](https://github.com/clod81) |
| ‚úÖ | [Obsidian](https://obsidian.md/download) | `Obsidian.exe` |  | [clod81](https://github.com/clod81) |
| ‚úÖ | Joplin | `Joplin.exe` |  | [0xAnom4ly](https://github.com/0xAnom4ly) |
| ‚úÖ | Discord | `Discord.exe` |  | [clod81](https://github.com/clod81) |
| ‚úÖ | [Windsurf](https://windsurf.com/download) | `Windsurf.exe` |  | [nero22k](https://github.com/Nero22k) |
| ‚úÖ | [Figma](https://www.figma.com/downloads/) | `Figma.exe` |  | [WaterBucket](https://x.com/DharaniSanjaiy) |
| ‚úÖ | [RingCentral](https://www.ringcentral.com/download) | `RingCentral.exe` |  | [4y45u45c4](https://x.com/4y45u45c4) |
| ‚úÖ | [ÈòøÈáå‰∫ëÁõò](https://www.alipan.com/) | `aDrive` | `6.8.6` | [Adnnlnistrator](https://github.com/Adnnlnistrator) |
| ‚úÖ | [azuredatastudio](https://azure.microsoft.com/zh-cn/products/data-studio/) | `azuredatastudio.exe` | `1.51.1` | [Adnnlnistrator](https://github.com/Adnnlnistrator) |
| ‚úÖ | [atom](https://atom-editor.cc/) | `atom.exe` | `1.60.0` | [Adnnlnistrator](https://github.com/Adnnlnistrator) |
| ‚úÖ | [Bruno](https://www.usebruno.com/) | `Bruno.exe` | `2.1.0` | Tyler Schultz |
| ‚úÖ | [KeeWeb](https://keeweb.info/) | `KeeWeb.exe` |  | [j0hnZ3RA](https://github.com/j0hnZ3RA) |
| ‚úÖ | [Wordpress](https://apps.wordpress.com/pt-br/d/windows/) | `Wordpress.com.exe` |  | [j0hnZ3RA](https://github.com/j0hnZ3RA) |
| ‚úÖ | [Arduino IDE](https://www.arduino.cc/en/software/) | `Arduino IDE.exe` |  | [j0hnZ3RA](https://github.com/j0hnZ3RA) |
| ‚úÖ | [QRLWallet](https://www.theqrl.org/) | `QRLWallet.exe` | `1.8.1` | [OnlySmrtSumX](https://www.linkedin.com/in/onlysmrtsumx/) & [tideboss](https://www.linkedin.com/in/kursad-dev/) |
| ‚úÖ | [DevHub](https://devhubapp.com/) | `DevHub.exe` | `0.102.0` | [ab4y98](https://github.com/Ab4y98) |
| ‚úÖ | [Asana](https://asana.com/) | `Asana.exe` | `2.3.0` | [syro](https://github.com/0xsyr0) |
| ‚úÖ | [Insomnia](https://insomnia.rest/) | `insomnia-11.0.2.exe` | `11.0.2` | [syro](https://github.com/0xsyr0) |
| ‚úÖ | [Ferdium](https://ferdium.org/) | `Ferdium.exe` | `7.0.1` | [pir4cy](https://github.com/pir4cy) |
| ‚úÖ | [Franz](https://meetfranz.com/) | `Franz.exe` | `5.11.0` | [pir4cy](https://github.com/pir4cy) |
| ‚úÖ | [TIDAL](https://tidal.com/) | `TIDAL.exe` |  | [pir4cy](https://github.com/pir4cy) |
| ‚úÖ | [FACEIT](https://faceit.com/) | `FACEIT.exe` | `2.1.10` | [icheernoom](https://x.com/icheernoom) |
| ‚úÖ | [Unity](https://unity.com/) | `Unity Hub.exe` |  | [Sawyer](https://github.com/SawyersPresent) |
| ‚úÖ | Docker Desktop | `Docker Desktop.exe` | `4.41.2` | [robinx0](https://linkedin.com/in/robinary) |
| ‚úÖ | Git Kraken | `gitkraken.exe` | `11.1.1` | [robinx0](https://linkedin.com/in/robinary) |
| ‚úÖ | Hyper | `hyper.exe` | `3.4.1` | [nahidha5an](https://www.linkedin.com/in/a-m-nahid-hasan-b2602335/) |
| ‚úÖ | LM Studio | `lmstudio.exe` | `0.3.14` | [nahidha5an](https://www.linkedin.com/in/a-m-nahid-hasan-b2602335/) |
| ‚ùå | 1Password | `1Password.exe` |  |  |
| ‚ùå | Signal | `Signal.exe` |  |  |
| ‚ùå | Slack | `slack.exe` |  |  |
| ‚ùå | Notion | `Notion.exe` |  |  |

### Simple Instructions

[Permalink: Simple Instructions](https://github.com/boku7/Loki#simple-instructions)

_You don't need to compile the agent when backdooring Electron apps. Just replace the contents of `{ELECTRONAPP}/resources/app/` with the Loki agent files._

### Detailed Instructions

[Permalink: Detailed Instructions](https://github.com/boku7/Loki#detailed-instructions)

#### Step 1 : Create Azure Storage Blob Account and get SAS Token

[Permalink: Step 1 : Create Azure Storage Blob Account and get SAS Token](https://github.com/boku7/Loki#step-1--create-azure-storage-blob-account-and-get-sas-token)

- [Create Azure Storage Account via Azure Portal](https://github.com/boku7/Loki/blob/main/docs/azure/create-storage-account-portal.md)
- [Create Azure Storage Account via Azure CLI](https://github.com/boku7/Loki/blob/main/docs/azure/create-storage-account-sas-azurecli.md)

#### Step 2 : Create Obfuscated Loki Payload

[Permalink: Step 2 : Create Obfuscated Loki Payload](https://github.com/boku7/Loki#step-2--create-obfuscated-loki-payload)

- Clone this repo and `cd` into it
- Install Node.JS
- Install `javascript-obfuscator` module

```
npm install --save-dev javascript-obfuscator
```

- Run `create_agent_payload.js` script to create a Loki payload with your Storage Account info

```
bobby$ node create_agent_payload.js
[+] Provide Azure storage account information:
        - Enter Storage Account  : 7f7584ty218ba5dba778.blob.core.windows.net
        - Enter SAS Token        : se=2025-05-28T23%3A14%3A48Z&sp=rwdlac&spr=https&sv=2022-11-02&ss=b&srt=sco&sig=5MXQzJ6FDZK8yYiBSgJ6FDZKgQzJMXBSgg6qE4ydrJ6FDZKSgg%3D

[+] Configuration:
        - Storage Account : 7f7584ty218ba5dba778.blob.core.windows.net
        - SAS Token       : se=2025-05-28T23%3A14%3A48Z&sp=rwdlac&spr=https&sv=2022-11-02&ss=b&srt=sco&sig=5MXQzJ6FDZK8yYiBSgJ6FDZKgQzJMXBSgg6qE4ydrJ6FDZKSgg%3D
        - Meta Container  : mllyi2zjmafjm

[+] Updated /Users/bobby/apr2/LokiC2/config.js with storage configuration.
 - Enter into the Loki Client UI
        Loki Client > Configuration

[+] Modifying PE binaries to have new hashes...
        - Payload assembly.node hash : e9d126407264821d3c2d324da0e2d1bc13cbc53e7c56340fe12b07f69b707f02
        - Payload keytar.node   hash : 292c14ffebd6cae3df99d9fbee525e29a5a704f076b82207eb3e650de45b075d

[+] Payload ready!
         - Obfuscated payload in the ./app directory
```

#### Step 3 : Backdoor Electron Application

[Permalink: Step 3 : Backdoor Electron Application](https://github.com/boku7/Loki#step-3--backdoor-electron-application)

- Your obfuscated Loki payload is output to `./app/`
- Change directory to the `{ELECTRONAPP}/resources/`
- Delete everything
- Copy the Loki `./app/` folder to `{ELECTRONAPP}/resources/app/`
- Click the Electron PE file and make sure Loki works

#### Step 4 : Configure Loki Client

[Permalink: Step 4 : Configure Loki Client](https://github.com/boku7/Loki#step-4--configure-loki-client)

- Launch the Loki GUI client

- From the menubar click `Loki Client > Configuration` to open the Settings window

- Enter in your Storage Account details and click `Save`

[![](https://github.com/boku7/Loki/raw/main/docs/images/lokisettings.png)](https://github.com/boku7/Loki/blob/main/docs/images/lokisettings.png)

- The agent should now render in the dashboard

- Click the agent from the dashboard table to open the agent window

- Test to ensure Loki works properly


## Backdooring Electron Apps and Keeping the real Application Working as Normal

[Permalink: Backdooring Electron Apps and Keeping the real Application Working as Normal](https://github.com/boku7/Loki#backdooring-electron-apps-and-keeping-the-real-application-working-as-normal)

The most straightforward way to use Loki is to replace the files in `{ELECTRONAPP}/resources/app/` with the Loki files. This hollows out the app, meaning the app won't function normally -- Loki replaced its functionality.

If you really want to keep the Electron application running and have it also deploy Loki in the background all hope is not lost! [John Hammond](https://x.com/_JohnHammond) and I figured out a way to keep the real Electron application running. We've added the file you will need to `/loki/backdoor/init.js` in this repo.

It is currently setup to work for Cursor, discovered to be vulnerable by [John Hammond](https://x.com/_JohnHammond).

For doing this you will need to:

- Download the Cursor app
- Paste all Loki files except `package.json` to `cursor/resources/app/`
  - Don't replace the real `package.json`
- Copy `/loki/backdoor/init.js` to `cursor/resources/app/`
- Modify contents of `cursor/resources/app/package.json` to:

  - set `"main":"init.js",`
  - delete `"type":"module",`
  - delete `"private":true,`

### How this works

[Permalink: How this works](https://github.com/boku7/Loki#how-this-works)

- With these changes `Cursor.exe` will load in `init.js` on click / execution
- `init.js` reads in `package.json`
- `init.js` changes `"main":"init.js",` -\> `"main":"main.js",`
  - `main.js` is Loki
- `init.js` spawns and disowns a new `Cursor.exe` which points to Loki
- **Loki is spawned in the background**
- `init.js` reads in `package.json` again
- `init.js` changes `"main":"main.js",` -\> `"main":"./out/main.js",`
  - `./out/main.js"` is the real Cursor application
- `init.js` spawns and disowns a new `Cursor.exe` which points to the real Cursor
- **Real Cursor app is spawned, visible and operates as normal**
- When Cursor is exited by the user:
  - `init.js` catches the exit
  - `init.js` reads in `package.json` for a third time
  - `init.js` changes `"main":"./out/main.js",` -\> `"main":"init.js",`

This way the app is persistently backdoored and operates as normal. If the cursor app is exited loki will continue to run in the background.

### Future

[Permalink: Future](https://github.com/boku7/Loki#future)

I'll make a script to automate this in the future.

## Opsec Recommendations

[Permalink: Opsec Recommendations](https://github.com/boku7/Loki#opsec-recommendations)

- [Opsec Recommendations](https://github.com/boku7/Loki/blob/main/docs/opsec/recommendations.md)

## Compilation Guides

[Permalink: Compilation Guides](https://github.com/boku7/Loki#compilation-guides)

These are the compile instructions for building the agents & clients. The instructions cover multiple platforms, including Windows, Linux, and macOS. It is recommended to compile the client on the target platform and architecture.

### Client

[Permalink: Client](https://github.com/boku7/Loki#client)

- [Windows](https://github.com/boku7/Loki/blob/main/docs/compile/client/windows.md)
- [macOS](https://github.com/boku7/Loki/blob/main/docs/compile/client/macos.md)
- [Linux](https://github.com/boku7/Loki/blob/main/docs/compile/client/linux.md)

### Agents

[Permalink: Agents](https://github.com/boku7/Loki#agents)

**If you are backdooring an Electron application then you don't need to compile agents.**

I do not recommend compiling the agent and using it for operations. Agent compile instructions are for development.

- [Windows](https://github.com/boku7/Loki/blob/main/docs/compile/agent/windows.md)
- [Linux](https://github.com/boku7/Loki/blob/main/docs/compile/agent/linux.md)
- [macOS](https://github.com/boku7/Loki/blob/main/docs/compile/agent/macos.md)

## Detection Guidance

[Permalink: Detection Guidance](https://github.com/boku7/Loki#detection-guidance)

- Review the information provided by MITRE for more details, examples, and information about this TTP :
  - [MITRE ATT&CK T1218.015: Electron Applications](https://attack.mitre.org/techniques/T1218/015/)
- Execution of an electron app from a abnormal directory such as `~/Downloads/Teams/Teams.exe`
- Electron apps beaconing to an Azure Storage Blob `*.blob.core.windows.net`
- SAS token usage in network traffic
- Electron apps spawning child processes such as `netstat.exe` or `whoami.exe`
- A directory with the name in the Loki `package.json` will be created in `~/AppData/Roaming/{NAME}` when the Loki JavaScript executes in the Electron process.
- This [LOLBAS Teams](https://lolbas-project.github.io/lolbas/OtherMSBinaries/Teams/) entry covers detections for Electron application backdooring. The detection information has been copied below.
- IOC: `%LOCALAPPDATA%\Microsoft\Teams\current\app` directory created
- IOC: `%LOCALAPPDATA%\Microsoft\Teams\current\app.asar` file created/modified by non-Teams installer/updater
- [SIGMA rule](https://github.com/4y45u45c4/SIGMA/blob/main/loki_c2_channel_established_from_electron_app.yaml) to detect established Loki C2 from electron app
- [SIGMA rule](https://github.com/4y45u45c4/SIGMA/blob/main/hijack_of_electron_app_to_load_C2_framework.yaml) to detect hijacking of Electron's app folder (Teams, VS Code, RingCentral, Postman) to load C2 framework

# References \|\| Acknowledgements \|\| Offensive Electron Research

[Permalink: References || Acknowledgements || Offensive Electron Research](https://github.com/boku7/Loki#references--acknowledgements--offensive-electron-research)

- [Dylan Tran (@d\_tranman)](https://x.com/d_tranman)
  - Cocreator of the Loki agent. Created node modules for shellcode and assembly execution.
- [Valentina Palmiotti (@chompie1337)](https://x.com/chompie1337), [Ellis Springe (@knavesec)](https://x.com/knavesec), and [Ruben Boonen](https://x.com/FuzzySec) for their previous internal work on backdooring Electron applications for persistence
- [Ruben Boonen](https://x.com/FuzzySec)
  - [Wild West Hackin‚Äô Fest talk Statikk Shiv: Leveraging Electron Applications for Post-Exploitation](https://www.youtube.com/watch?v=VXb6lwXhCAc)
- Andrew Kisliakov
  - [Microsoft Teams and other Electron Apps as LOLbins](https://l--k.uk/2022/01/16/microsoft-teams-and-other-electron-apps-as-lolbins/)
- [Shawn Jones](https://x.com/anthemtotheego)
  - For Loki assembly execution Dylan ported Shawn‚Äôs public [InlineExecute-Assembly](https://github.com/anthemtotheego/InlineExecute-Assembly) code
- [mr.d0x (@mrd0x)](https://twitter.com/@mrd0x) for their prior work about leveraging the Teams Electron application to execute arbitrary Node.JS code and publishing their findings to the LOLBAS project.
- Michael Taggart
  - [quASAR project, a tool designed for modifying Electron applications to enable command execution](https://github.com/mttaggart/quasar)
  - [Quasar: Compromising Electron Apps](https://taggart-tech.com/quasar-electron/)
- [Raphael Mudge](https://bsky.app/profile/raphaelmudge.bsky.social)for inspiring me to dive deep into red teaming and supporting the release of this tool

  - [The Security Conversation](https://aff-wg.org/)
- [Fletcher Davis](https://x.com/gymR4T)
  - [BSides : Abusing Electron Applications](https://github.com/gymR4T/presentations/blob/main/BSidesNOVA2022_ElectronApplicationAbuse.pdf)
- [Pavel Tsakalidis](https://x.com/sadreck)
  - [BEEMKA - Electron Exploitation Toolkit](https://github.com/ctxis/beemka)

## License

[Permalink: License](https://github.com/boku7/Loki#license)

This project is licensed under the Business Source License 1.1. Non-commercial use is permitted under the terms of the license. Commercial use requires the author's explicit permission. On April 3, 2030, this license will convert to Apache 2.0. See [LICENSE](https://github.com/boku7/Loki/blob/main/LICENSE) for full details.

## About

üßô‚Äç‚ôÇÔ∏è Node.js Command & Control for Script-Jacking Vulnerable Electron Applications


### Resources

[Readme](https://github.com/boku7/Loki#readme-ov-file)

### License

[View license](https://github.com/boku7/Loki#License-1-ov-file)

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/boku7/Loki).

[Activity](https://github.com/boku7/Loki/activity)

### Stars

[**1.3k**\\
stars](https://github.com/boku7/Loki/stargazers)

### Watchers

[**10**\\
watching](https://github.com/boku7/Loki/watchers)

### Forks

[**212**\\
forks](https://github.com/boku7/Loki/forks)

[Report repository](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fboku7%2FLoki&report=boku7+%28user%29)

## [Releases\  4](https://github.com/boku7/Loki/releases)

[Loki Client v2.4.0\\
Latest\\
\\
on Jun 17, 2025Jun 17, 2025](https://github.com/boku7/Loki/releases/tag/v2.4.0)

[\+ 3 releases](https://github.com/boku7/Loki/releases)

## [Packages\  0](https://github.com/users/boku7/packages?repo_name=Loki)

No packages published

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/boku7/Loki).

## [Contributors\  16](https://github.com/boku7/Loki/graphs/contributors)

- [![@boku7](https://avatars.githubusercontent.com/u/19784872?s=64&v=4)](https://github.com/boku7)
- [![@clod81](https://avatars.githubusercontent.com/u/1020921?s=64&v=4)](https://github.com/clod81)
- [![@pir4cy](https://avatars.githubusercontent.com/u/13626502?s=64&v=4)](https://github.com/pir4cy)
- [![@j0hnZ3RA](https://avatars.githubusercontent.com/u/82909572?s=64&v=4)](https://github.com/j0hnZ3RA)
- [![@Nero22k](https://avatars.githubusercontent.com/u/64486541?s=64&v=4)](https://github.com/Nero22k)
- [![@Robinx0](https://avatars.githubusercontent.com/u/88659091?s=64&v=4)](https://github.com/Robinx0)
- [![@4y45u45c4](https://avatars.githubusercontent.com/u/207280155?s=64&v=4)](https://github.com/4y45u45c4)
- [![@icheernoom](https://avatars.githubusercontent.com/u/5839732?s=64&v=4)](https://github.com/icheernoom)
- [![@nahidha5an](https://avatars.githubusercontent.com/u/25875922?s=64&v=4)](https://github.com/nahidha5an)
- [![@Ab4y98](https://avatars.githubusercontent.com/u/35191867?s=64&v=4)](https://github.com/Ab4y98)
- [![@Adnnlnistrator](https://avatars.githubusercontent.com/u/56180228?s=64&v=4)](https://github.com/Adnnlnistrator)
- [![@0xsyr0](https://avatars.githubusercontent.com/u/67317571?s=64&v=4)](https://github.com/0xsyr0)
- [![@ThanniKudam](https://avatars.githubusercontent.com/u/72503981?s=64&v=4)](https://github.com/ThanniKudam)
- [![@tyleraschultz](https://avatars.githubusercontent.com/u/84467715?s=64&v=4)](https://github.com/tyleraschultz)

[\+ 2 contributors](https://github.com/boku7/Loki/graphs/contributors)

## Languages

- [JavaScript60.2%](https://github.com/boku7/Loki/search?l=javascript)
- [C++17.0%](https://github.com/boku7/Loki/search?l=c%2B%2B)
- [HTML16.0%](https://github.com/boku7/Loki/search?l=html)
- [C6.2%](https://github.com/boku7/Loki/search?l=c)
- [CSS0.3%](https://github.com/boku7/Loki/search?l=css)
- [Assembly0.2%](https://github.com/boku7/Loki/search?l=assembly)
- [Python0.1%](https://github.com/boku7/Loki/search?l=python)

You can‚Äôt perform that action at this time.