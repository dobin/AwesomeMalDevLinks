Title:
GraphSpy — Initial Access and Post-Exploitation Tool for AAD/Entra ID and Microsoft 365 (O365) with a Browser GUI

Type:
GitHub Tool

Short Summary (4–8 sentences max):
GraphSpy is a browser-based GUI tool for initial access and post-exploitation against Microsoft Entra ID (Azure AD) and Microsoft 365 using OAuth tokens and Microsoft Graph–adjacent APIs. It centralizes storage and reuse of access/refresh tokens, supports device code flows (including polling and auto-actions), and enables interactive abuse of M365 services like OneDrive/SharePoint, Outlook, and Teams. A key focus is token-based persistence and session hijacking via Primary Refresh Tokens (PRTs) and generation of browser-importable PRT cookies for Entra SSO. It also includes functionality to enumerate/modify MFA methods (including adding TOTP/FIDO/Authenticator/phones) and to enroll Windows Hello for Business keys to regain PRTs even after password resets. The tool provides Microsoft Search-based keyword hunting across M365 data and a “custom requests” feature for arbitrary API calls with stored tokens. It’s primarily useful for red teams and pentesters performing Entra/M365 compromise simulation and post-compromise operations, and it highlights how powerful token/PRT/WHfB artifacts are for persistence in cloud identity environments.

Technical Focus:
- OAuth2 token operations (access tokens, refresh tokens) and token management
- Device Code authentication flow (phishing-style workflows, polling, automation)
- Primary Refresh Tokens (PRT), PRT cookies, and Entra ID SSO session access
- Windows Hello for Business (WHfB) key enrollment and persistence
- Microsoft Graph / Outlook/Teams/OneDrive/SharePoint API interaction
- MFA method enumeration/modification for persistence (TOTP, FIDO2, Authenticator, SMS/voice)

Use Cases:
- Token-based post-exploitation against M365 (mail, files, Teams messaging)
- Device code flow campaigns and automated follow-on actions after user auth
- Establishing persistence via MFA method addition and/or WHfB/PRT mechanisms
- Generating browser sessions via PRT cookies for interactive access to Entra-integrated apps
- Searching tenant data (emails/files) for sensitive keywords using Microsoft Search API
- Rapid prototyping/testing of arbitrary Graph/API calls with reusable request templates

Keywords:
Microsoft Entra ID, Azure AD, Microsoft 365, Office 365, Microsoft Graph, OAuth2, access token, refresh token, device code flow, device code phishing, Primary Refresh Token, PRT, PRT cookie, SSO, Windows Hello for Business, WHfB, MFA methods, FIDO2, TOTP, Microsoft Authenticator, OneDrive, SharePoint, Outlook, Microsoft Teams, Microsoft Search API, token persistence, post-exploitation