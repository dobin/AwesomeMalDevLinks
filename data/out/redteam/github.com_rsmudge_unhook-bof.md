# https://github.com/rsmudge/unhook-bof

[Skip to content](https://github.com/rsmudge/unhook-bof#start-of-content)

You signed in with another tab or window. [Reload](https://github.com/rsmudge/unhook-bof) to refresh your session.You signed out in another tab or window. [Reload](https://github.com/rsmudge/unhook-bof) to refresh your session.You switched accounts on another tab or window. [Reload](https://github.com/rsmudge/unhook-bof) to refresh your session.Dismiss alert

{{ message }}

[rsmudge](https://github.com/rsmudge)/ **[unhook-bof](https://github.com/rsmudge/unhook-bof)** Public

- [Notifications](https://github.com/login?return_to=%2Frsmudge%2Funhook-bof) You must be signed in to change notification settings
- [Fork\\
62](https://github.com/login?return_to=%2Frsmudge%2Funhook-bof)
- [Star\\
282](https://github.com/login?return_to=%2Frsmudge%2Funhook-bof)


Remove API hooks from a Beacon process.


### License

[BSD-3-Clause license](https://github.com/rsmudge/unhook-bof/blob/master/LICENSE)

[282\\
stars](https://github.com/rsmudge/unhook-bof/stargazers) [62\\
forks](https://github.com/rsmudge/unhook-bof/forks) [Branches](https://github.com/rsmudge/unhook-bof/branches) [Tags](https://github.com/rsmudge/unhook-bof/tags) [Activity](https://github.com/rsmudge/unhook-bof/activity)

[Star](https://github.com/login?return_to=%2Frsmudge%2Funhook-bof)

[Notifications](https://github.com/login?return_to=%2Frsmudge%2Funhook-bof) You must be signed in to change notification settings

# rsmudge/unhook-bof

master

[**1** Branch](https://github.com/rsmudge/unhook-bof/branches) [**0** Tags](https://github.com/rsmudge/unhook-bof/tags)

[Go to Branches page](https://github.com/rsmudge/unhook-bof/branches)[Go to Tags page](https://github.com/rsmudge/unhook-bof/tags)

Go to file

Code

Open more actions menu

## Folders and files

| Name | Name | Last commit message | Last commit date |
| --- | --- | --- | --- |
| ## Latest commit<br>[![rsmudge](https://avatars.githubusercontent.com/u/1174994?v=4&size=40)](https://github.com/rsmudge)[rsmudge](https://github.com/rsmudge/unhook-bof/commits?author=rsmudge)<br>[Merge pull request](https://github.com/rsmudge/unhook-bof/commit/fa3c8d8a397719c5f2310334e6549bea541b209c) [#1](https://github.com/rsmudge/unhook-bof/pull/1) [from physics-sp/master](https://github.com/rsmudge/unhook-bof/commit/fa3c8d8a397719c5f2310334e6549bea541b209c)<br>Open commit details<br>5 years agoMar 6, 2021<br>[fa3c8d8](https://github.com/rsmudge/unhook-bof/commit/fa3c8d8a397719c5f2310334e6549bea541b209c) · 5 years agoMar 6, 2021<br>## History<br>[6 Commits](https://github.com/rsmudge/unhook-bof/commits/master/) <br>Open commit details<br>[View commit history for this file.](https://github.com/rsmudge/unhook-bof/commits/master/) 6 Commits |
| [src](https://github.com/rsmudge/unhook-bof/tree/master/src "src") | [src](https://github.com/rsmudge/unhook-bof/tree/master/src "src") | [ignore the DLL where beacon is](https://github.com/rsmudge/unhook-bof/commit/e33cd26b325bb8f387a7579564799ddbb8db2f51 "ignore the DLL where beacon is") | 5 years agoMar 6, 2021 |
| [LICENSE](https://github.com/rsmudge/unhook-bof/blob/master/LICENSE "LICENSE") | [LICENSE](https://github.com/rsmudge/unhook-bof/blob/master/LICENSE "LICENSE") | [Initial commit of capabilities.](https://github.com/rsmudge/unhook-bof/commit/a1455346d6e0a70cd5961a83d90b1c7479c9ecc1 "Initial commit of capabilities.") | 6 years agoJan 12, 2021 |
| [README](https://github.com/rsmudge/unhook-bof/blob/master/README "README") | [README](https://github.com/rsmudge/unhook-bof/blob/master/README "README") | [ignore the DLL where beacon is](https://github.com/rsmudge/unhook-bof/commit/e33cd26b325bb8f387a7579564799ddbb8db2f51 "ignore the DLL where beacon is") | 5 years agoMar 6, 2021 |
| [make.bat](https://github.com/rsmudge/unhook-bof/blob/master/make.bat "make.bat") | [make.bat](https://github.com/rsmudge/unhook-bof/blob/master/make.bat "make.bat") | [Initial commit of capabilities.](https://github.com/rsmudge/unhook-bof/commit/a1455346d6e0a70cd5961a83d90b1c7479c9ecc1 "Initial commit of capabilities.") | 6 years agoJan 12, 2021 |
| [unhook.cna](https://github.com/rsmudge/unhook-bof/blob/master/unhook.cna "unhook.cna") | [unhook.cna](https://github.com/rsmudge/unhook-bof/blob/master/unhook.cna "unhook.cna") | [ignore the DLL where beacon is](https://github.com/rsmudge/unhook-bof/commit/e33cd26b325bb8f387a7579564799ddbb8db2f51 "ignore the DLL where beacon is") | 5 years agoMar 6, 2021 |
| [unhook.x64.o](https://github.com/rsmudge/unhook-bof/blob/master/unhook.x64.o "unhook.x64.o") | [unhook.x64.o](https://github.com/rsmudge/unhook-bof/blob/master/unhook.x64.o "unhook.x64.o") | [update .o files](https://github.com/rsmudge/unhook-bof/commit/68936634b8898a7e154cfb2992f61b55d2b69220 "update .o files") | 5 years agoMar 6, 2021 |
| [unhook.x86.o](https://github.com/rsmudge/unhook-bof/blob/master/unhook.x86.o "unhook.x86.o") | [unhook.x86.o](https://github.com/rsmudge/unhook-bof/blob/master/unhook.x86.o "unhook.x86.o") | [update .o files](https://github.com/rsmudge/unhook-bof/commit/68936634b8898a7e154cfb2992f61b55d2b69220 "update .o files") | 5 years agoMar 6, 2021 |
| View all files |

## Repository files navigation

```
This is a Beacon Object File to refresh DLLs and remove their hooks. The code is from Cylance's Universal Unhooking research:

https://blogs.blackberry.com/en/2017/02/universal-unhooking-blinding-security-software

To use:

Load unhook.cna into Cobalt Strike via Cobalt Strike -> Script Manager

Run 'unhook' from Beacon

To build:

x86: Open Visual Studio x86 Native Tools Command Prompt and type 'make'
x64: Open Visual Studio x64 Croos Tools Command Prompt and type 'make'

This project derived from:

Reflective DLL Injection
BSD 3-Clause License
Copyright (c) 2011, Stephen Fewer of Harmony Security (www.harmonysecurity.com)
https://github.com/stephenfewer/ReflectiveDLLInjection

ReflectiveDLLRefresher
BSD 3-Clause License
Copyright (c) 2017, Cylance Inc.
https://github.com/CylanceVulnResearch/ReflectiveDLLRefresher

Unhook Meterpreter Extension
BSD-3-Clause License
2006-2018, Rapid7, Inc.
https://github.com/rapid7/metasploit-payloads/commits/master/c/meterpreter/source/extensions/unhook
```

## About

Remove API hooks from a Beacon process.


### Resources

[Readme](https://github.com/rsmudge/unhook-bof#readme-ov-file)

### License

[BSD-3-Clause license](https://github.com/rsmudge/unhook-bof#BSD-3-Clause-1-ov-file)

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/rsmudge/unhook-bof).

[Activity](https://github.com/rsmudge/unhook-bof/activity)

### Stars

[**282**\\
stars](https://github.com/rsmudge/unhook-bof/stargazers)

### Watchers

[**7**\\
watching](https://github.com/rsmudge/unhook-bof/watchers)

### Forks

[**62**\\
forks](https://github.com/rsmudge/unhook-bof/forks)

[Report repository](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Frsmudge%2Funhook-bof&report=rsmudge+%28user%29)

## [Releases](https://github.com/rsmudge/unhook-bof/releases)

No releases published

## [Packages\  0](https://github.com/users/rsmudge/packages?repo_name=unhook-bof)

No packages published

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/rsmudge/unhook-bof).

## [Contributors\  3](https://github.com/rsmudge/unhook-bof/graphs/contributors)

- [![@physics-sec](https://avatars.githubusercontent.com/u/11247943?s=64&v=4)](https://github.com/physics-sec)[**physics-sec** Physics](https://github.com/physics-sec)
- [![@rsmudge](https://avatars.githubusercontent.com/u/1174994?s=64&v=4)](https://github.com/rsmudge)[**rsmudge** Raphael](https://github.com/rsmudge)

## Languages

- [C99.7%](https://github.com/rsmudge/unhook-bof/search?l=c)
- [Batchfile0.3%](https://github.com/rsmudge/unhook-bof/search?l=batchfile)

You can’t perform that action at this time.