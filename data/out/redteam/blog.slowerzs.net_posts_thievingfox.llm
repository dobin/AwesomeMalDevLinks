Title:
ThievingFox – Remotely retrieving credentials from password managers and Windows utilities

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post introduces ThievingFox, a post-exploitation toolkit for capturing credentials from common admin tools (password managers and RDP clients) by forcing target applications to load a malicious library and then hooking credential-handling code in-memory.  
- It addresses limitations of tools like KeeThief and mimikatz (app coverage and the need to “catch” apps while running) by using “passive” injection techniques that trigger when the victim app starts, avoiding noisy polling and common remote-thread injection APIs.  
- The author focuses on more robust hooking by targeting stable exported symbols or COM vtable method addresses rather than fragile byte-pattern signatures.  
- Captured secrets are written to disk encrypted using libsodium sealed boxes (public key embedded in the DLL; private key kept by the operator) and later collected over SMB.  
- Techniques covered include DLL proxying/sideloading (KeePassXC), COM hijacking (mstsc/RDCMan/MobaXTerm/LogonUI/consent.exe), and .NET AppDomainManager injection plus managed-method pointer swapping (KeePass).  
- It’s primarily useful for red teams and pentesters doing workstation/server post-exploitation, and it’s notable for credential capture paths that avoid LSASS dumping and reduce common EDR telemetry.

Technical Focus:
- Passive injection via DLL proxying/sideloading and COM hijacking
- In-memory API/function hooking (MinHook, byte patching)
- COM in-proc servers, vtable inspection, and method hooking (e.g., IMsRdpClient*)
- .NET Framework AppDomainManager injection and JIT/native method pointer swapping
- Credential capture from LogonUI/RDP clients without LSASS access
- Encrypted on-disk staging using libsodium sealed boxes + SMB collection

Use Cases:
- Capture KeePass/KeePassXC master passwords (and keyfile-related material) when databases are unlocked
- Harvest cleartext RDP credentials from mstsc/RDCMan/MobaXTerm during authentication
- Collect credentials entered at the Windows logon/unlock screen (LogonUI) on “poisoned” hosts
- Reduce detection risk versus OpenProcess/WriteProcessMemory/CreateRemoteThread-style injection
- Stage and later retrieve captured secrets in environments where outbound HTTP listeners are impractical

Keywords:
ThievingFox, post-exploitation, credential harvesting, DLL proxying, DLL sideloading, COM hijacking, CLSID, in-proc COM server, vtable hooking, MinHook, byte patching, AppDomainManager, .NET Framework, JIT compilation, method pointer swapping, KeePass, KeePassXC, mstsc.exe, RDCMan, MobaXTerm, LogonUI.exe, consent.exe, IMsRdpClient, put_ClearTextPassword, libsodium, sealed boxes, SMB exfiltration, PROCESS_MITIGATION_BINARY_SIGNATURE_POLICY, SeDebugPrivilege