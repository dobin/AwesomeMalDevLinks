# https://github.com/mattifestation/AntimalwareBlight

[Skip to content](https://github.com/mattifestation/AntimalwareBlight#start-of-content)

You signed in with another tab or window. [Reload](https://github.com/mattifestation/AntimalwareBlight) to refresh your session.You signed out in another tab or window. [Reload](https://github.com/mattifestation/AntimalwareBlight) to refresh your session.You switched accounts on another tab or window. [Reload](https://github.com/mattifestation/AntimalwareBlight) to refresh your session.Dismiss alert

{{ message }}

[mattifestation](https://github.com/mattifestation)/ **[AntimalwareBlight](https://github.com/mattifestation/AntimalwareBlight)** Public

- [Notifications](https://github.com/login?return_to=%2Fmattifestation%2FAntimalwareBlight) You must be signed in to change notification settings
- [Fork\\
19](https://github.com/login?return_to=%2Fmattifestation%2FAntimalwareBlight)
- [Star\\
141](https://github.com/login?return_to=%2Fmattifestation%2FAntimalwareBlight)


Execute PowerShell code at the antimalware-light protection level.


### License

[BSD-3-Clause license](https://github.com/mattifestation/AntimalwareBlight/blob/main/LICENSE)

[141\\
stars](https://github.com/mattifestation/AntimalwareBlight/stargazers) [19\\
forks](https://github.com/mattifestation/AntimalwareBlight/forks) [Branches](https://github.com/mattifestation/AntimalwareBlight/branches) [Tags](https://github.com/mattifestation/AntimalwareBlight/tags) [Activity](https://github.com/mattifestation/AntimalwareBlight/activity)

[Star](https://github.com/login?return_to=%2Fmattifestation%2FAntimalwareBlight)

[Notifications](https://github.com/login?return_to=%2Fmattifestation%2FAntimalwareBlight) You must be signed in to change notification settings

# mattifestation/AntimalwareBlight

main

[**1** Branch](https://github.com/mattifestation/AntimalwareBlight/branches) [**0** Tags](https://github.com/mattifestation/AntimalwareBlight/tags)

[Go to Branches page](https://github.com/mattifestation/AntimalwareBlight/branches)[Go to Tags page](https://github.com/mattifestation/AntimalwareBlight/tags)

Go to file

Code

Open more actions menu

## Folders and files

| Name | Name | Last commit message | Last commit date |
| --- | --- | --- | --- |
| ## Latest commit<br>[![mattifestation](https://avatars.githubusercontent.com/u/1781087?v=4&size=40)](https://github.com/mattifestation)[mattifestation](https://github.com/mattifestation/AntimalwareBlight/commits?author=mattifestation)<br>[Update README.md](https://github.com/mattifestation/AntimalwareBlight/commit/c6e3dddcd079ccbb76648af2ea81fcdb32de5b33)<br>4 years agoDec 13, 2022<br>[c6e3ddd](https://github.com/mattifestation/AntimalwareBlight/commit/c6e3dddcd079ccbb76648af2ea81fcdb32de5b33) · 4 years agoDec 13, 2022<br>## History<br>[5 Commits](https://github.com/mattifestation/AntimalwareBlight/commits/main/) <br>Open commit details<br>[View commit history for this file.](https://github.com/mattifestation/AntimalwareBlight/commits/main/) 5 Commits |
| [AntimalwareBlight](https://github.com/mattifestation/AntimalwareBlight/tree/main/AntimalwareBlight "AntimalwareBlight") | [AntimalwareBlight](https://github.com/mattifestation/AntimalwareBlight/tree/main/AntimalwareBlight "AntimalwareBlight") | [Adding AntimalwareBlight PowerShell module](https://github.com/mattifestation/AntimalwareBlight/commit/00f634a733ff32c61376eebfe5436cd5fa3ca0f3 "Adding AntimalwareBlight PowerShell module") | 4 years agoJun 1, 2022 |
| [LICENSE](https://github.com/mattifestation/AntimalwareBlight/blob/main/LICENSE "LICENSE") | [LICENSE](https://github.com/mattifestation/AntimalwareBlight/blob/main/LICENSE "LICENSE") | [Initial commit](https://github.com/mattifestation/AntimalwareBlight/commit/f725e7e794cba26be36ae7def68ae1e9f771beda "Initial commit") | 4 years agoJun 1, 2022 |
| [README.md](https://github.com/mattifestation/AntimalwareBlight/blob/main/README.md "README.md") | [README.md](https://github.com/mattifestation/AntimalwareBlight/blob/main/README.md "README.md") | [Update README.md](https://github.com/mattifestation/AntimalwareBlight/commit/c6e3dddcd079ccbb76648af2ea81fcdb32de5b33 "Update README.md") | 4 years agoDec 13, 2022 |
| [REcon 2022 - Living Off the Walled Garden\_ Abusing the Features of the Early Launch Antimalware Ecosystem.pdf](https://github.com/mattifestation/AntimalwareBlight/blob/main/REcon%202022%20-%20Living%20Off%20the%20Walled%20Garden_%20Abusing%20the%20Features%20of%20the%20Early%20Launch%20Antimalware%20Ecosystem.pdf "REcon 2022 - Living Off the Walled Garden_ Abusing the Features of the Early Launch Antimalware Ecosystem.pdf") | [REcon 2022 - Living Off the Walled Garden\_ Abusing the Features of the Early Launch Antimalware Ecosystem.pdf](https://github.com/mattifestation/AntimalwareBlight/blob/main/REcon%202022%20-%20Living%20Off%20the%20Walled%20Garden_%20Abusing%20the%20Features%20of%20the%20Early%20Launch%20Antimalware%20Ecosystem.pdf "REcon 2022 - Living Off the Walled Garden_ Abusing the Features of the Early Launch Antimalware Ecosystem.pdf") | [Adding REcon 2022 Slide Deck](https://github.com/mattifestation/AntimalwareBlight/commit/06f9d6611f06229efef63f0ecd4d6026969f2c22 "Adding REcon 2022 Slide Deck") | 4 years agoJun 3, 2022 |
| View all files |

## Repository files navigation

Use this PowerShell module to execute PowerShell code at the antimalware-light protection level. This code was highlighted in the [Living Off the Walled Garden: Abusing the Features of the Early Launch Antimalware Ecosystem](https://cfp.recon.cx/2022/talk/MNTFHS/) REcon talk as well as [Black Hat USA 2022](https://www.youtube.com/watch?v=Upo5I_mK1V4). This module needs to run elevated. The purpose of this module is to highlight how the antimalware-light protection anti-tampering feature is only as strong as the weakest vendor's ELAM driver.

Thank you to the Microsoft Defender research team for working with me on this issue! When in doubt, if MSRC won't fix something because it's not a security boundary, the Defender team still likely cares very much!

Load the module:

```
Import-Module .\AntimalwareBlight.psm1
```

View its exported functions:

```
Get-Command -Module AntimalwareBlight
```

View help for the module's functions:

```
Get-Help Invoke-AntimalwareLightCommand -Full
```

Note: `Invoke-AntimalwareLightCommand` is deliberately not fully weaponized. It is up to the user to locate an overly permissive ELAM driver that permits Microsoft-signed code (TBS hash: `E17764C39F2AFD7114F8528D2F9783D9A591F6679715EECE730A262CF5CFD3B3`)

## About

Execute PowerShell code at the antimalware-light protection level.


### Resources

[Readme](https://github.com/mattifestation/AntimalwareBlight#readme-ov-file)

### License

[BSD-3-Clause license](https://github.com/mattifestation/AntimalwareBlight#BSD-3-Clause-1-ov-file)

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/mattifestation/AntimalwareBlight).

[Activity](https://github.com/mattifestation/AntimalwareBlight/activity)

### Stars

[**141**\\
stars](https://github.com/mattifestation/AntimalwareBlight/stargazers)

### Watchers

[**2**\\
watching](https://github.com/mattifestation/AntimalwareBlight/watchers)

### Forks

[**19**\\
forks](https://github.com/mattifestation/AntimalwareBlight/forks)

[Report repository](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fmattifestation%2FAntimalwareBlight&report=mattifestation+%28user%29)

## [Releases](https://github.com/mattifestation/AntimalwareBlight/releases)

No releases published

## [Packages\  0](https://github.com/users/mattifestation/packages?repo_name=AntimalwareBlight)

No packages published

## Languages

- [PowerShell100.0%](https://github.com/mattifestation/AntimalwareBlight/search?l=powershell)

You can’t perform that action at this time.