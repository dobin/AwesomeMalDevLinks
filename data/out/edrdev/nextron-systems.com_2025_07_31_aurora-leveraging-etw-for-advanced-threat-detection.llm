Title:
AURORA – Leveraging ETW for Advanced Threat Detection

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post explains Nextron’s Aurora endpoint agent, which consumes raw Windows ETW streams, reconstructs them into structured events, and applies Sigma rules/IOCs directly on the endpoint.  
- It focuses on Aurora’s architecture and configuration (minimal→intense presets), detailing which ETW providers/EventLog channels are subscribed and how ETW data is mapped into Sigma logsource categories via YAML mappings.  
- A key differentiator is event enrichment (e.g., GrandparentImage/CommandLine, ProcessTree, full command line, PE metadata) that improves detection fidelity beyond Sysmon/native logs.  
- The post also documents ETW visibility gaps (e.g., named pipes, some registry/value operations, short-lived handles) and recommends a minimal Sysmon config to complement Aurora where ETW is weak.  
- It demonstrates rule engineering workflows using `--trace` to inspect parsed/enriched telemetry and validate Sigma rules, including detections for Shadow Copy “Previous Versions” credential file access and process-lineage-based Meterpreter/IIS exploitation patterns.  
- Useful primarily for detection engineers and blue teams building high-confidence Windows detections, and for red teams who want to understand what ETW-based sensors can observe.

Technical Focus:
- Event Tracing for Windows (ETW) provider subscription and telemetry reconstruction  
- Sigma rule execution on endpoint + logsource/category mapping (YAML)  
- Telemetry enrichment: process ancestry (grandparent), ProcessTree, command line, PE metadata  
- ETW vs Sysmon coverage comparison and hybrid deployment strategy  
- Aurora `--trace` diagnostics for telemetry validation and rule prototyping  
- Custom ETW provider onboarding (sources, keywords, field mappings)

Use Cases:
- Validate whether specific attacker behaviors generate ETW telemetry before writing detections
- Build higher-confidence process creation detections using grandparent/process-tree context
- Detect sensitive file access (e.g., NTDS.dit/SAM) via Shadow Copy “Previous Versions” GUI paths
- Supplement ETW blind spots with targeted Sysmon events (named pipes, registry value changes)
- Extend monitoring by adding custom/proprietary ETW providers and mapping them to Sigma categories
- Export enriched endpoint telemetry as JSON/UDP for downstream collection/testing

Keywords:
Aurora Agent, Nextron, ETW, Event Tracing for Windows, Sigma, IOC, Windows telemetry, Sysmon, Microsoft-Windows-Kernel-File, Microsoft-Windows-Kernel-Process, SystemLogger, process ancestry, GrandparentCommandLine, ProcessTree, PE metadata, kernel file events, tcpip connect, WMI-Activity, AMSI, detection engineering, YAML field mappings, Shadow Copy, @GMT path, NTDS.dit, SAM, Meterpreter, w3wp.exe, CVE-2025-53770, --trace, JSON over UDP