Title:
EtwTi-FluctuationMonitor — Detecting hidden shellcode via ETW Threat-Intelligence PROTECTVM_LOCAL fluctuations

Type:
GitHub Tool

Short Summary (4–8 sentences max):
- This repository provides a Windows monitoring tool that uses Microsoft-Windows-Threat-Intelligence ETW events to detect “hidden shellcode” techniques that repeatedly toggle memory protections to evade scanners.  
- It focuses on violations of the “immutable code page” principle: executable pages should generally transition RW→RX once, not repeatedly flip between executable/non-executable or writable/non-writable states.  
- The tool consumes Threat-Intelligence PROTECTVM_LOCAL events to observe VirtualProtect-style protection changes and flags suspicious regions when the same allocation’s protections fluctuate more than once.  
- It explicitly accounts for false positives from JIT engines (memory reuse) and legitimate API hooking by using frequency-based heuristics rather than single-event alerting.  
- This is useful for defenders/EDR engineers and threat hunters building telemetry-based detections, and for red teams to understand what ETW TI can reveal about memory-hiding tradecraft.  
- The approach is tied to the Black Hat Asia 2023 talk “You Can Run, but You Can’t Hide - Finding the Footprints of Hidden Shellcode.”

Technical Focus:
- ETW Threat-Intelligence provider (Microsoft-Windows-Threat-Intelligence)
- PROTECTVM_LOCAL events and memory protection telemetry
- Detecting shellcode hiding via VirtualProtect/NtProtectVirtualMemory flipping
- Immutable code page principle (RW→RX) and violation detection
- False-positive reduction via frequency/behavioral heuristics
- Windows memory protections (RW/RX, W^X concepts) and private executable memory (JIT)

Use Cases:
- Detect in-memory payloads that “hide” by repeatedly changing page protections
- Build/validate EDR detections around ETW TI PROTECTVM_LOCAL telemetry
- Threat hunting for suspicious executable memory behavior in user-mode processes
- Researching evasion techniques that attempt to defeat periodic memory scanning
- Baseline and tune JIT/hooking-related protection changes to reduce noise

Keywords:
ETW, Microsoft-Windows-Threat-Intelligence, PROTECTVM_LOCAL, VirtualProtect, NtProtectVirtualMemory, memory protection flipping, hidden shellcode, in-memory evasion, executable pages, RWX, RW-to-RX, W^X, JIT, API hooking, behavioral detection, Windows internals, threat hunting, EDR telemetry, Black Hat Asia 2023