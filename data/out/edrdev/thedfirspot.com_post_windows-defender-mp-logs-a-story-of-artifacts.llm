Title:
Windows Defender MP Logs: A Story of Artifacts

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post explains how Microsoft Defender “MP” (Microsoft Protection) support logs can be leveraged as a DFIR artifact to reconstruct file activity on Windows systems.  
- It highlights that MP logs may record full file paths, scan timestamps (local time), hashes (e.g., SHA1), signature/detection details, and sometimes command-line parameters tied to execution context.  
- The author focuses on the `C:\ProgramData\Microsoft\Windows Defender\Support` directory and the most useful files: `MPLog` (scanned files/telemetry) and `MPDetection` (threat detections).  
- It demonstrates pivoting from a detection (e.g., a webshell) into `MPLog` to extract richer context such as cloud/telemetry lookups (“SDN”) and Behavioral Monitoring (“BM Telemetry”) that may reference related processes (e.g., `w3wp.exe`).  
- The key value is using MP logs as an alternate evidence source when other telemetry is missing or tampered with (no Sysmon, limited auditing, deleted artifacts/files).  
- It’s primarily useful for DFIR/Blue Teams and threat hunters, but also valuable for red teams to understand residual artifacts left by Defender scanning.

Technical Focus:
- Microsoft Defender MP support logs (`MPLog`, `MPDetection`) parsing
- File existence and execution evidence via Defender scan events
- Telemetry fields: SDN (cloud), BM Telemetry (Behavioral Monitoring)
- Extraction of hashes, paths, timestamps, file owner, actions taken
- Timeline building and pivoting to OSINT (e.g., VirusTotal) using hashes

Use Cases:
- Validate file existence after attacker cleanup/deletion
- Reconstruct execution context when Sysmon/process auditing is absent
- Pivot from Defender detections to related processes and directories scanned
- Extract hashes for enrichment (VirusTotal/OSINT) and malware analysis
- Add Defender scan events to incident timelines and scoping

Keywords:
Microsoft Defender, Windows Defender, MPLog, MPDetection, Microsoft Protection, C:\ProgramData\Microsoft\Windows Defender\Support, DFIR, incident response, artifact, file scanning, SHA1, command-line arguments, Behavioral Monitoring, BM Telemetry, SDN, cloud telemetry, w3wp.exe, IIS worker process, webshell, VirusTotal