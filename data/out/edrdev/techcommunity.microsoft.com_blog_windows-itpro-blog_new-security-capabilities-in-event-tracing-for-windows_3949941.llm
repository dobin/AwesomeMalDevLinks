Title:
New security capabilities in Event Tracing for Windows

Type:
Blog Post

Short Summary (4–8 sentences max):
- Microsoft describes updates to Windows Event Tracing for Windows (ETW) and Security-Auditing events to better attribute “who initiated” certain security-relevant actions.  
- The problem addressed is event provenance ambiguity (acting deputy vs causal process), where the process writing/logging the event (often SYSTEM/kernel/LSASS) is not the process that triggered the action.  
- Updated event schemas add initiating-process fields to the event payload, specifically Process ID and Process Start Key (a boot-unique sequence identifier), and bump event versions accordingly.  
- The post highlights nine enhanced events covering service installation, scheduled task operations, audit policy changes, and event log clearing, improving correlation and timelines for DFIR and detection engineering.  
- It demonstrates correlating scheduled task creation (4698) with process creation (4688) to validate the initiating process chain (e.g., cmd.exe → schtasks.exe) rather than relying on the header ExecutionProcessID.  
- Useful primarily for Blue Team/DFIR/detection engineers and security product builders collecting Windows telemetry; also relevant to red teams for understanding improved visibility around persistence and log tampering.

Technical Focus:
- ETW event schema/versioning and payload templates  
- Initiating process attribution (ClientProcessID / ParentProcessID) vs ExecutionProcessID  
- Process Start Key (boot-unique process instance identifier)  
- Windows Security Auditing event IDs (4688, 4697–4702, 4719, 1102, 104)  
- Correlation/timelining of security events for provenance validation  
- ETW collection via Event Viewer and Win32 APIs (StartTraceA, EnableTraceEx2)

Use Cases:
- Build higher-fidelity detections for scheduled task persistence and service installation with correct initiating process attribution
- Investigate audit policy changes and event log clearing with better provenance for incident response timelines
- Improve SIEM/EDR parsers to ingest new payload fields and reduce false attribution to SYSTEM/LSASS
- Validate parent/child process chains by correlating 4698 (task created) with 4688 (process creation)

Keywords:
ETW, Event Tracing for Windows, Windows Security Auditing, event provenance, acting deputy, causal process, Process Start Key, ClientProcessID, ParentProcessID, ExecutionProcessID, Event Viewer, StartTraceA, EnableTraceEx2, evntrace.h, event schema versioning, 4688, 4697, 4698, 4699, 4700, 4701, 4702, 4719, 1102, 104, scheduled tasks, schtasks.exe, lsass.exe, audit policy change, log clearing, DFIR, detection engineering, MITRE ATT&CK T1053.005