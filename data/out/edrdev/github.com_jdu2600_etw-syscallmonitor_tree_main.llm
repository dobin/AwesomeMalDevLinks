Title:
Etw-SyscallMonitor — Hunting hidden shellcode via syscall summaries

Type:
GitHub Tool

Short Summary (4–8 sentences max):
Etw-SyscallMonitor is a C# proof-of-concept that uses kernel ETW telemetry to build per-process “syscall summaries” of security-relevant system calls and selected parameters. It aims to detect hidden/injected shellcode and other runtime-only behaviors by profiling what syscalls a process actually performs, analogous to how import tables/ImpHash or capa summarize static capabilities. The tool periodically writes a system-wide `SyscallSummary.json` and per-process profiles keyed by executable and a startup hash, enabling anomaly detection across runs. It emphasizes that user-mode malware cannot avoid making syscalls to accomplish tasks, making syscall-set anomalies a useful footprint even when traditional user-mode anti-analysis is used. The README references the Black Hat Asia 2023 talk “You Can Run, but You Can’t Hide - Finding the Footprints of Hidden Shellcode” for the underlying methodology. Notes indicate best results on Windows 10 and mention using BYOVD to enable PPL to collect Microsoft-Windows-Threat-Intelligence ETW events.

Technical Focus:
- Windows ETW (kernel telemetry) collection and parsing
- Syscall-set profiling / behavioral summarization per process
- Microsoft-Windows-Threat-Intelligence ETW provider usage
- PPL (Protected Process Light) enablement and telemetry access
- BYOVD (Bring Your Own Vulnerable Driver) as an enabler for collection
- Anomaly detection via profile comparison (not full event timeline reconstruction)

Use Cases:
- Hunt for injected/hidden shellcode by spotting unusual syscall sets in benign processes
- Build baseline syscall profiles for enterprise endpoints and flag deviations
- Triage suspicious processes by quickly summarizing runtime capabilities
- Research/validate detection ideas from BHASIA 2023 syscall-footprint methodology
- Generate artifacts (JSON profiles) for offline analysis and correlation

Keywords:
ETW, Event Tracing for Windows, kernel telemetry, syscalls, syscall monitoring, behavioral profiling, anomaly detection, shellcode, process injection, Microsoft-Windows-Threat-Intelligence, PPL, Protected Process Light, BYOVD, Windows 10, C#, JSON, capa, ImpHash, runtime analysis, malware hunting