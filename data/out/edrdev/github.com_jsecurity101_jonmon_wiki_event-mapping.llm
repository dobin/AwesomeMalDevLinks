Title:
JonMon Wiki – Event Mapping

Type:
Documentation

Short Summary (4–8 sentences max):
- This page documents how JonMon maps its internal EventIds to specific Windows telemetry sources and kernel/user-mode collection mechanisms.  
- It solves the “what generated this event?” problem by explicitly tying each event type (process/thread/image, handle access, registry, file/pipe/mailslot, .NET, WMI, RPC, DPAPI, network, AMSI, and TI injection signals) to the underlying callback/ETW provider used.  
- Techniques covered include kernel notify routines (process/thread/image), Object Manager callbacks for handle operations, registry callbacks, minifilter IRP monitoring, and multiple ETW providers (DotNETRuntime, RPC, DPAPI, Kernel-Network, AMSI, Threat-Intelligence).  
- It’s useful for defenders building detections, red teamers validating what activity is observable, and researchers comparing EDR-like telemetry coverage.  
- The inclusion of RPC interface-focused collection (via MSRPC-to-ATTACK) and ETW Threat-Intelligence events for common injection primitives highlights a focus on high-signal behavioral telemetry.

Technical Focus:
- Kernel callbacks: PsSetCreateProcessNotifyRoutine(Ex), PsSetCreateThreadNotifyRoutine, PsSetLoadImageNotifyRoutine  
- Object Manager handle telemetry: ObRegisterCallbacks (handle create/duplicate)  
- Registry monitoring: CmRegisterCallbackEx  
- File system minifilter callbacks: FltRegisterCallback (IRP_MJ_CREATE, named pipe/mailslot)  
- ETW providers: DotNETRuntime, WMI-Activity, RPC, Crypto-DPAPI, Kernel-Network, AMSI, Threat-Intelligence  
- Injection/abuse signals: Read/WriteProcessMemory, VirtualAlloc, QueueUserAPC, token impersonation heuristics

Use Cases:
- Validate which attacker behaviors will be logged by JonMon (process injection, handle abuse, registry persistence, WMI persistence, RPC activity).
- Build or tune detections by mapping alerts to the exact Windows callback/ETW source.
- Compare JonMon telemetry coverage against Sysmon/EDR data sources for gaps and overlaps.
- Research RPC-based tradecraft by focusing on monitored interfaces (MSRPC-to-ATTACK alignment).
- Investigate credential/data access via DPAPI (CryptUnprotectData) and AMSI scanning visibility.

Keywords:
JonMon, EventId mapping, ETW, PsSetCreateProcessNotifyRoutineEx, PsSetCreateThreadNotifyRoutine, PsSetLoadImageNotifyRoutine, ObRegisterCallbacks, CmRegisterCallbackEx, FltRegisterCallback, IRP_MJ_CREATE, named pipes, mailslots, WMI permanent subscription, Microsoft-Windows-RPC, MSRPC-to-ATTACK, Microsoft-Windows-Crypto-DPAPI, CryptUnprotectData, Microsoft-Antimalware-Scan-Interface, Microsoft-Windows-Threat-Intelligence, QueueUserAPC, ReadProcessMemory, WriteProcessMemory, VirtualAlloc, token impersonation