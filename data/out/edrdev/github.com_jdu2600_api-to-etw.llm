Title:
API-To-ETW (DumpEtwWrites Ghidra script)

Type:
GitHub Tool

Short Summary (4â€“8 sentences max):
- This repository provides a Ghidra Java script that reverse-engineers a PE file to map Windows APIs/functions to the ETW events they emit.  
- It extracts ETW write metadata (e.g., EVENT_DESCRIPTOR symbols/IDs and call paths) and leverages public symbols (PDBs) to improve accuracy, addressing the lack of documentation for many ETW providers (notably kernel providers like `Kernel-Audit-API-Calls` where events appear as `task_nn`).  
- The tool automates what was previously a manual reversing workflow by scanning decompiled code for ETW registration/write patterns and outputting results suitable for grep/analysis (example CSV for `ntoskrnl.exe`).  
- It also discusses undocumented-by-design tracing ecosystems such as TraceLogging and WPP, highlighting that these can still be valuable for security telemetry.  
- Useful for detection engineers and blue teams building ETW-based analytics, and for red teams/malware analysts who want to understand what actions generate which ETW signals.  
- Interesting because it bridges Windows internals reversing with practical telemetry engineering, enabling faster discovery of high-signal ETW events tied to sensitive APIs.

Technical Focus:
- ETW internals: providers, EVENT_DESCRIPTORs, event IDs, metadata extraction
- Ghidra decompiler scripting (Java) and p-code/decompilation-driven analysis
- Windows kernel/user-mode PE analysis with PDB symbol loading
- Mapping API call graphs to ETW write sites (call-path reconstruction)
- TraceLogging and WPP provider discovery (undocumented telemetry)
- Handling edge cases in provider handle storage (e.g., GenericTableAvl/AVL patterns)

Use Cases:
- Build a mapping of Windows kernel syscalls/APIs to ETW events for detection content
- Identify which ETW providers/events fire for specific sensitive operations (process/thread, image load, ALPC, symlinks)
- Triage undocumented `task_nn` ETW events by resolving them to concrete APIs
- Reverse-engineer telemetry coverage of a target binary (kernel or user-mode) to inform evasion or monitoring
- Generate reference CSVs for threat hunting and SIEM/EDR ETW pipelines

Keywords:
ETW, Event Tracing for Windows, Microsoft-Windows-Kernel-Audit-API-Calls, EVENT_DESCRIPTOR, TraceLogging, WPP, Ghidra, decompiler, p-code, PDB symbols, ntoskrnl.exe, PE analysis, syscall, call graph, PsSetLoadImageNotifyRoutine, NtOpenProcess, NtTerminateProcess, ALPC, Windows internals, telemetry engineering