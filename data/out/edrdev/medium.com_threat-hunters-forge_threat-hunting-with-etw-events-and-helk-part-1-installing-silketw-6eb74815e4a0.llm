Title:
Threat Hunting with ETW events and HELK — Part 1: Installing SilkETW

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post introduces Event Tracing for Windows (ETW) as a richer Windows telemetry source than standard audit policy event logs, and frames it as input for threat hunting and analytics in HELK (Hunting ELK).  
- It explains the ETW model (controllers, providers, consumers) and demonstrates how to enumerate sessions/providers and query provider metadata using built-in tools like `logman` and `wevtutil`, plus WEPExplorer.  
- A key concept is that only ETW events with an assigned *Channel* can be consumed in real time via Windows Event Log; others require collecting to an `.etl` file and opening it as a saved log.  
- The post walks through manually enabling providers (e.g., WinINet Analytic channel; DotNETRuntime via Data Collector Sets) and selecting provider keyword bitmasks for targeted collection.  
- It then introduces SilkETW (CLI and SilkService) as a practical way to continuously collect ETW from providers without channels (e.g., `Microsoft-Windows-DotNETRuntime`) and write them into a dedicated event log as JSON.  
- Useful for threat hunters/blue teams building telemetry pipelines, and for red teamers/researchers who want to understand what ETW can reveal and how defenders can collect it.

Technical Focus:
- Event Tracing for Windows (ETW) architecture: controllers/providers/consumers
- Enumerating ETW sessions and providers with `logman` and querying metadata
- Event Log channels (Analytic/Debug) vs non-channel ETW providers
- Collecting ETW to `.etl` via Data Collector Sets (Performance tool) and keyword bitmasks
- SilkETW/SilkService: real-time ETW-to-EventLog ingestion and JSON output
- Provider examples: WinINet, Security-Auditing, DotNETRuntime, LDAP-Client

Use Cases:
- Enable and test additional Windows telemetry sources beyond audit policy for hunting
- Collect .NET runtime ETW (JIT/Loader/Interop/NGen keywords) to detect suspicious managed code activity
- Stand up continuous ETW collection via SilkService and centralize via Windows Event Log
- Prototype detections by exploring provider events interactively (CLI) before pipeline integration
- Validate what telemetry is available for specific attacker behaviors (e.g., LDAP queries, web activity)

Keywords:
ETW, Event Tracing for Windows, logman, wevtutil, WEPExplorer, Windows Event Log, Analytic channel, Debug channel, Data Collector Sets, .etl, Microsoft-Windows-DotNETRuntime, Microsoft-Windows-WinINet, Microsoft-Windows-Security-Auditing, Microsoft-Windows-LDAP-Client, SilkETW, SilkService, HELK, keyword bitmask, JSON event output