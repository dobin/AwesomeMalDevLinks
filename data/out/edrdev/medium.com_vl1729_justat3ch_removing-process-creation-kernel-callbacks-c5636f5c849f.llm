Title:
Removing Process Creation Kernel Callbacks

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post describes a kernel-mode evasion technique to disable Windows process creation notification callbacks used by AV/EDR for process monitoring.  
- It assumes an attacker already has arbitrary kernel read/write (demonstrated via a vulnerable driver like MSI Afterburner RTCore64, CVE-2019-16098) and uses that primitive to locate and null out entries in the `PspCreateProcessNotifyRoutine` callback array.  
- The author shows how to resolve `PsSetCreateProcessNotifyRoutine` in the running kernel, then find the internal `PspSetCreateProcessNotifyRoutine` and the callback array address via lightweight signature scanning of invariant instruction patterns (CALL/JMP rel32 and RIP-relative LEA).  
- Once the array is found, the technique iterates entries to identify a target callback and overwrites it with zero, effectively blinding registered security callbacks to new process creation events.  
- The approach is tested across multiple Windows versions (Win7 through Win10/Server 2019) and focuses on x64 instruction decoding details needed to compute RIP-relative targets.  
- It’s primarily useful for red teamers, exploit developers, and malware researchers studying kernel telemetry suppression and EDR bypass tradecraft.

Technical Focus:
- Windows kernel notify routines (`PsSetCreateProcessNotifyRoutine`, `PspCreateProcessNotifyRoutine`)
- Kernel arbitrary read/write via vulnerable signed drivers (BYOVD)
- Signature scanning in kernel code (invariant byte patterns)
- x86-64 instruction decoding (CALL/JMP rel32, RIP-relative LEA, sign extension)
- Locating kernel base / resolving exported routine addresses
- Callback array enumeration and patching (nulling function pointers)

Use Cases:
- Disabling/neutralizing EDR process-creation telemetry after gaining kernel R/W
- Researching robustness of kernel callback-based monitoring across Windows versions
- Building PoCs for BYOVD-driven kernel tampering and telemetry suppression
- Developing detections around callback array integrity and kernel code scanning behavior

Keywords:
Windows kernel, EDR bypass, process creation notify, PsSetCreateProcessNotifyRoutine, PspSetCreateProcessNotifyRoutine, PspCreateProcessNotifyRoutine, kernel callbacks, notify routines, BYOVD, vulnerable driver, RTCore64, CVE-2019-16098, arbitrary kernel read write, signature scanning, RIP-relative LEA, CALL rel32, JMP rel32, x86-64 instruction encoding, kernel base address, callback patching