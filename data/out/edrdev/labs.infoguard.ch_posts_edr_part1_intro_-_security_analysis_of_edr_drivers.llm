Title:
Attacking EDRs Part 1: Intro & Security Analysis of EDR Drivers

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post introduces a research series on attacking the agent-side attack surface of Windows EDR products, focusing specifically on kernel drivers reachable by low-privileged users.  
- It outlines why EDR agents are attractive targets (LPE, stealth/bypass, DoS, potential RCE via scanning engines) and maps common EDR component boundaries and IPC paths (user↔kernel, kernel↔kernel, user↔user).  
- The core contribution is a practical methodology for enumerating EDR drivers, identifying exposed userland interfaces (device objects and minifilter communication ports), and assessing their access control (ACL/SDDL).  
- It combines static RE (spotting APIs like IoCreateDevice/IoCreateDeviceSecure, WdfDeviceCreateDeviceInterface, FltCreateCommunicationPort) with dynamic inspection (WinObj, OSR DeviceTree, WinDbg object manager queries, NtObjectManager).  
- The post explains how accessible interfaces are then analyzed via IOCTL dispatch routines and minifilter message callbacks to find authorization flaws or classic driver bugs.  
- It’s most useful for vulnerability researchers and red teamers assessing EDR self-protection weaknesses, and for defenders/vendors validating driver interface hardening.  
- An important observation is that some EDRs intentionally expose interfaces broadly because injected userland components (often low-privilege processes) must talk to the driver, increasing risk if driver-side authorization is weak.

Technical Focus:
- Windows kernel driver interface enumeration (WDM/KMDF device objects, symbolic links)
- Minifilter FilterCommunicationPort discovery and security descriptors
- IOCTL surface analysis (IRP_MJ_DEVICE_CONTROL dispatch, control codes)
- Object Manager namespace inspection and ACL/SDDL validation
- Static reverse engineering of driver initialization and callback registration
- Kernel debugging workflow (WinDbg/KDNET breakpoints, !object, !sd)

Use Cases:
- Identify low-privileged attack paths into EDR kernel drivers (device objects, IOCTLs, minifilter ports)
- Audit driver object ACLs/SDDL for overly permissive access
- Build a repeatable workflow for RE + dynamic validation of EDR driver IPC
- Triage whether exposed interfaces rely on unsafe “caller PID/process” checks
- Prepare targets and hypotheses for fuzzing IOCTL handlers or minifilter message handlers

Keywords:
EDR, Windows kernel, driver security, WDM, KMDF, minifilter, FltCreateCommunicationPort, FilterCommunicationPort, IoCreateDevice, IoCreateDeviceSecure, WdfDeviceCreateDeviceInterface, IOCTL, IRP_MJ_DEVICE_CONTROL, SDDL, ACL, Object Manager namespace, WinDbg, KDNET, WinObj, NtObjectManager, DriverView, OSR DeviceTree, ALPC, Cortex XDR, Sophos Intercept X, Microsoft Defender for Endpoint, Cynet 360, Tanium