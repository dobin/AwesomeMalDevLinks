Title:
TiEtwAgent – ETW-based process injection detection

Type:
GitHub Tool

Short Summary (4–8 sentences max):
TiEtwAgent is a proof-of-concept Windows detection agent that monitors and detects process/memory injection activity using Event Tracing for Windows (ETW), specifically the Microsoft-Windows-Threat-Intelligence provider. It aims to provide a more stable, kernel-visible alternative to userland API hooking approaches commonly used by EDRs. The repo is designed for researching both detection logic and potential bypass techniques, with detections implemented in code (e.g., `DetectionLogic.cpp`) and extensible event-field parsing via a generic event abstraction. It leverages the `microsoft/krabsetw` library to set up and consume ETW sessions. Deployment is oriented around running as a Protected Process Light (PPL) service, with guidance for test-signing and using an ELAM-capable certificate/driver. It’s useful for red teams and security researchers to understand what TI ETW can surface, and for blue teams to prototype injection detections without relying on fragile hooks.

Technical Focus:
- ETW telemetry collection (Microsoft-Windows-Threat-Intelligence provider)
- Kernel-visible detection of process injection behaviors
- PPL service implementation and protected execution
- ELAM driver/signing requirements for protected startup
- Event parsing/normalization and rule-style detection logic (C/C++)
- Bypass research against ETW-based detections

Use Cases:
- Prototype detections for common injection techniques (e.g., remote thread, memory mapping, RWX transitions)
- Validate what Microsoft Threat Intelligence ETW events expose on specific Windows builds
- Build a lab agent to compare ETW-based visibility vs userland-hook telemetry
- Research and test evasion/bypass strategies against TI-provider-driven detections
- Develop/extend custom detection logic by adding new event fields and handlers

Keywords:
ETW, Event Tracing for Windows, Microsoft-Windows-Threat-Intelligence, process injection, memory injection, krabsetw, kernel telemetry, PPL, Protected Process Light, ELAM, Early Launch Anti-Malware, code signing, test signing, bcdedit, Windows internals, EDR research, event parsing, detection engineering, C++, Windows service