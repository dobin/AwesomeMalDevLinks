Title:
Hunting for Suspicious LDAP Activity with SilkETW and Yara (Hunting for Domain Enumeration)

Type:
Blog Post

Short Summary (4–8 sentences max):
- The post demonstrates a threat-hunting approach to detect Active Directory domain enumeration by monitoring LDAP client activity via ETW.  
- It uses FireEye’s SilkETW to collect events from the `Microsoft-Windows-LDAP-Client` ETW provider and applies Yara rules to match suspicious LDAP query patterns.  
- The author builds detections for privileged group enumeration (e.g., Domain Admins), `adminCount=1` discovery, SPN scanning (often tied to Kerberoasting), and queries for accounts with Kerberos pre-authentication disabled (ASREPRoasting).  
- Validation is done using common enumeration tooling like PowerView and `setspn.exe`, showing the rules triggering on those LDAP queries.  
- It’s primarily useful for Blue Team threat hunters and defenders building endpoint telemetry-based detections, but also informs red teamers about observable LDAP recon artifacts.  
- The post notes potential false positives in larger environments and mentions forwarding telemetry to platforms like Elasticsearch.

Technical Focus:
- Event Tracing for Windows (ETW) telemetry collection
- `Microsoft-Windows-LDAP-Client` provider and LDAP query visibility
- Yara rule matching on ETW event content
- AD enumeration detection logic (groups, attributes, filters)
- Kerberoasting/ASREPRoasting-related LDAP discovery patterns

Use Cases:
- Detect endpoint-driven AD reconnaissance and situational awareness activity
- Build Yara-based hunting rules for suspicious LDAP filters/strings
- Validate detections against PowerView and native Windows enumeration tools
- Forward LDAP telemetry to centralized logging (e.g., Elasticsearch/HELK) for hunting

Keywords:
SilkETW, ETW, Event Tracing for Windows, Microsoft-Windows-LDAP-Client, LDAP, Active Directory, domain enumeration, Yara rules, threat hunting, PowerView, setspn.exe, Domain Admins, adminCount, AdminSDHolder, servicePrincipalName, Kerberoasting, ASREPRoasting, userAccountControl, LDAP filters