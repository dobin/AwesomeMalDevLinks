# https://fluxsec.red/edr-syscall-hooking

<!DOCTYPE html><html lang="en">
<body>
    <div class="container">
        
          <aside class="sidebar left-sidebar">
  <div id="mob-side-section">
      <div class="mobile-header">
        <button class="menu-button">â˜°</button>
    </div>
    <nav class="mobile-menu">
      
      <h2>Intro</h2>
      <ul>
        
          <li class="">
            <a href="https://fluxsec.red/">About Me</a>
          </li>
        
      </ul>
    
      <h2>Sanctum EDR</h2>
      <ul>
        
          <li class="">
            <a href="https://fluxsec.red/sanctum-edr-intro">Intro and plan for the Sanctum EDR</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/rust-windows-driver">Creating a Windows Driver in Rust</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/rust-windows-driver-configuration">Configuring a Rust Windows driver</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/rust-windows-driver-object">Building the Driver Object</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/logging-errors-in-rust">Error logging</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/windows-rust-driver-irql-driver-mutex">Windows Driver IRQL and acquiring a Driver Mutex</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/wdk-mutex-windows-driver-mutex">wdk-mutex: An idiomatic mutex for Rust Windows Kernel Drivers</a>
          </li>
        
          <li class="active">
            <a href="https://fluxsec.red/edr-syscall-hooking">Theory: EDR Syscall hooking and Ghost Hunting, my approach to detection</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/implementing-syscall-hooking-rust">Implementing syscall hooks in Rust</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/communicating-from-hooked-syscall-rust">Communicating from the hooked syscall</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/ghost-hunting-open-process">Ghost hunting OpenProcess</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/edr-hooking-virtual-alloc-ex-rust-malware">Hooking VirtualAllocEx</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/mitigating-broadcast-spoofing-rust-sanctum-edr-ghost-hunting">Mitigating broadcast spoofs with Ghost Hunting</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/creating-a-ppl-protected-process-light-in-rust-windows">Creating a Protected Process Light in Rust for Sanctum EDR</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/event-tracing-for-windows-threat-intelligence-rust-consumer">Reading Event Tracing for Windows Threat Intelligence </a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/improving-the-ghost-hunting-implementation-for-flexibility">Improving the Ghost Hunting implementation for flexibility and speed</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/monitoring-ntdll-for-memory-patching-etw-hacking-bypass-in-rust-EDR">Monitoring NTDLL for in memory patching</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/reverse-engineering-windows-11-kernel">Reverse engineering undocumented Windows Kernel features to work with the EDR</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/full-spectrum-event-tracing-for-windows-detection-in-the-kernel-against-rootkits">Full spectrum Event Tracing for Windows detection in the kernel against rootkits</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/considering-ransomware-edr-defence-strategy">Real-time Ransomware Detection Strategy</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/improving-edr-dll-injection-kernel-callback">Making improvements to the EDR DLL injection</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/early-bird-apc-queue-injection">Strategy for Early Bird APC Queue Injection and improving Ghost Hunting</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/alt-syscalls-for-windows-11">Alt Syscalls for Windows 11</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/improving-EDR-via-windows-driver-apc-injection-rust">Improving consistency with EDR DLL Injection via APCs</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/detecting-vectored-exception-handling-malware-rust-edr-windows-kernel">Detecting Vectored Exception Handling Squared in an EDR</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/simple-ransomware-detection-sanctum-minifilter">Starting point for simple ransomware detection</a>
          </li>
        
      </ul>
    
      <h2>Offensive Development - Rust</h2>
      <ul>
        
          <li class="">
            <a href="https://fluxsec.red/winapi-rust-intro">Introduction to the Windows API in Rust with a DLL Loader</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/rust-dll-windows-api">Building a DLL in Rust</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/remote-process-dll-injection">Remote process DLL injection in Rust</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/rust-edr-evasion-hells-gate">Hells Gate Rust - EDR Evasion with syscalls</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/etw-patching-rust">EDR Evasion ETW patching in Rust</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/apc-queue-injection-rust">EDR Evasion APC Queue Injection in Rust</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/rust-dll-search-order-hijacking">Rust DLL Search Order Hijacking</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/rust-opsec-malware-development">Rust OPSEC for Malware Development</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/hells-hollow-a-new-SSDT-hooking-technique-with-alt-syscalls-rootkit">Hells Hollow: A new SSDT Hooking technique</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/timestomping-pe-compile-time">Timestomping a PE compile timestamp - adversary tradecraft and detection</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/creating-implant-dll-exports-wyrm-c2">Creating a framework in Wyrm C2 to easily configure custom exports of an implant</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/vectored-exception-handling-squared-rust">Vectored Exception Handling Squared</a>
          </li>
        
      </ul>
    
      <h2>Offensive Development - General</h2>
      <ul>
        
          <li class="">
            <a href="https://fluxsec.red/reflective-dll-injection-in-c">Reflective DLL injection and bootstrapping in C </a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/dll-injection-edr-evasion-1">DLL Injection EDR Evasion 1: Hiding an elephant in the closet</a>
          </li>
        
      </ul>
    
      <h2>System Call Integrity Layer</h2>
      <ul>
        
          <li class="">
            <a href="https://fluxsec.red/introducing-system-call-integrity-layer">Introducing System Call Integrity Layer</a>
          </li>
        
      </ul>
    
      <h2>My tools</h2>
      <ul>
        
          <li class="">
            <a href="https://fluxsec.red/chx-copy-hex-dumper">Clipboard Hex Dumper Tool</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/str-crypter">Str Crypter - Payload string encryption with Rust</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/export-resolver">Export Resolver</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/wyrm-c2-localhost-self-signed-certificate-windows">Creating a local self signed certificate for localhost testing of Wyrm C2</a>
          </li>
        
      </ul>
    
      <h2>Misc</h2>
      <ul>
        
          <li class="">
            <a href="https://fluxsec.red/how-I-developed-a-markdown-blog-with-go-and-HTMX">How I developed a markdown blog in Go and HTMX</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/rust-windows-api-winapi-programming-msdn-cheatsheet">Helpful Rust Windows API programming cheat sheet</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/analysing-Iranian-APT-MuddyWater-mobile-spyware-free-vpn-comodo">Inside DCHSpy: Analysing Iranian APT MuddyWater free VPN mobile spyware</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/using-ghidriff-to-examine-heap-buffer-overflow">Using Ghidriff to look at heap buffer overflow example</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/disassembly-notes">Disassembly notes</a>
          </li>
        
          <li class="">
            <a href="https://fluxsec.red/creating-a-rust-application-running-in-vtl1">Creating a Rust VBS Enclave DLL running in VTL1</a>
          </li>
        
      </ul>
    
    </nav>
  </div>

  
    <div id="normal-menu">
      <a href="https://fluxsec.red/"><img src="https://fluxsec.red/static/images/flux.png"></a>

      
    <h2>Intro</h2>
    <ul>
      
        <li class="">
          <a href="https://fluxsec.red/">About Me</a>
        </li>
      
    </ul>
  
    <h2>Sanctum EDR</h2>
    <ul>
      
        <li class="">
          <a href="https://fluxsec.red/sanctum-edr-intro">Intro and plan for the Sanctum EDR</a>
        </li>
      
        <li class="">
          <a href="https://fluxsec.red/rust-windows-driver">Creating a Windows Driver in Rust</a>
        </li>
      
        <li class="">
          <a href="https://fluxsec.red/rust-windows-driver-configuration">Configuring a Rust Windows driver</a>
        </li>
      
        <li class="">
          <a href="https://fluxsec.red/rust-windows-driver-object">Building the Driver Object</a>
        </li>
      
        <li class="">
          <a href="https://fluxsec.red/logging-errors-in-rust">Error logging</a>
        </li>
      
        <li class="">
          <a href="https://fluxsec.red/windows-rust-driver-irql-driver-mutex">Windows Driver IRQL and acquiring a Driver Mutex</a>
        </li>
      
        <li class="">
          <a href="https://fluxsec.red/wdk-mutex-windows-driver-mutex">wdk-mutex: An idiomatic mutex for Rust Windows Kernel Drivers</a>
        </li>
      
        <li class="active">
          <a href="https://fluxsec.red/edr-syscall-hooking">Theory: EDR Syscall hooking and Ghost Hunting, my approach to detection</a>
        </li>
      
        <li class="">
          <a href="https://fluxsec.red/implementing-syscall-hooking-rust">Implementing syscall hooks in Rust</a>
        </li>
      
        <li class="">
          <a href="https://fluxsec.red/communicating-from-hooked-syscall-rust">Communicating from the hooked syscall</a>
        </li>
      
        <li class="">
          <a href="https://fluxsec.red/ghost-hunting-open-process">Ghost hunting OpenProcess</a>
        </li>
      
        <li class="">
          <a href="https://fluxsec.red/edr-hooking-virtual-alloc-ex-rust-malware">Hooking VirtualAllocEx</a>
        </li>
      
        <li class="">
          <a href="https://fluxsec.red/mitigating-broadcast-spoofing-rust-sanctum-edr-ghost-hunting">Mitigating broadcast spoofs with Ghost Hunting</a>
        </li>
      
        <li class="">
          <a href="https://fluxsec.red/creating-a-ppl-protected-process-light-in-rust-windows">Creating a Protected Process Light in Rust for Sanctum EDR</a>
        </li>
      
        <li class="">
          <a href="https://fluxsec.red/event-tracing-for-windows-threat-intelligence-rust-consumer">Reading Event Tracing for Windows Threat Intelligence </a>
        </li>
      
        <li class="">
          <a href="https://fluxsec.red/improving-the-ghost-hunting-implementation-for-flexibility">Improving the Ghost Hunting implementation for flexibility and speed</a>
        </li>
      
        <li class="">
          <a href="https://fluxsec.red/monitoring-ntdll-for-memory-patching-etw-hacking-bypass-in-rust-EDR">Monitoring NTDLL for in memory patching</a>
        </li>
      
        <li class="">
          <a href="https://fluxsec.red/reverse-engineering-windows-11-kernel">Reverse engineering undocumented Windows Kernel features to work with the EDR</a>
        </li>
      
        <li class="">
          <a href="https://fluxsec.red/full-spectrum-event-tracing-for-windows-detection-in-the-kernel-against-rootkits">Full spectrum Event Tracing for Windows detection in the kernel against rootkits</a>
        </li>
      
        <li class="">
          <a href="https://fluxsec.red/considering-ransomware-edr-defence-strategy">Real-time Ransomware Detection Strategy</a>
        </li>
      
        <li class="">
          <a href="https://fluxsec.red/improving-edr-dll-injection-kernel-callback">Making improvements to the EDR DLL injection</a>
        </li>
      
        <li class="">
          <a href="https://fluxsec.red/early-bird-apc-queue-injection">Strategy for Early Bird APC Queue Injection and improving Ghost Hunting</a>
        </li>
      
        <li class="">
          <a href="https://fluxsec.red/alt-syscalls-for-windows-11">Alt Syscalls for Windows 11</a>
        </li>
      
        <li class="">
          <a href="https://fluxsec.red/improving-EDR-via-windows-driver-apc-injection-rust">Improving consistency with EDR DLL Injection via APCs</a>
        </li>
      
        <li class="">
          <a href="https://fluxsec.red/detecting-vectored-exception-handling-malware-rust-edr-windows-kernel">Detecting Vectored Exception Handling Squared in an EDR</a>
        </li>
      
        <li class="">
          <a href="https://fluxsec.red/simple-ransomware-detection-sanctum-minifilter">Starting point for simple ransomware detection</a>
        </li>
      
    </ul>
  
    <h2>Offensive Development - Rust</h2>
    <ul>
      
        </ul></div></aside></div></body></html>