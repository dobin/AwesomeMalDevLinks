Title:
Incorporate Windows ETW in your code using Krabsetw

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post shows how to consume Windows Event Tracing for Windows (ETW) events from C/C++ using Microsoft’s Krabsetw library.  
- It focuses on practical setup (dropping `krabs.hpp` and the `krabs/` directory into a project) and building user-mode or kernel-mode trace sessions (named/unnamed).  
- The author walks through selecting an ETW provider (example: `Microsoft-Windows-Kernel-Network`), using provider manifests to identify event IDs, keywords/masks, and field schemas.  
- It demonstrates filtering by keyword masks and event IDs, then handling events via callbacks that parse event fields (e.g., extracting `PID`) using `krabs::schema` and `krabs::parser`.  
- The example forwards parsed data to custom monitoring logic in a separate thread, noting that trace start is blocking.  
- Useful for defenders building lightweight telemetry/monitoring and for offensive/security researchers who need custom ETW-based instrumentation or situational awareness.

Technical Focus:
- Krabsetw ETW consumption (user_trace vs kernel_trace)
- ETW providers, GUIDs, and manifest-driven schema understanding
- Keyword/mask filtering (`provider.any(...)`)
- Event ID predicates and `krabs::event_filter`
- Callback-based event handling (`EVENT_RECORD`) and field parsing
- Threading considerations for blocking trace sessions

Use Cases:
- Build custom host telemetry collectors without full EDR agents
- Monitor network send events and attribute activity to process IDs
- Prototype detections by inspecting ETW event fields in real time
- Rapidly explore ETW providers/events using manifests and tools like EtwExplorer
- Integrate ETW signals into red team tooling for environment awareness

Keywords:
ETW, Event Tracing for Windows, Krabsetw, krabs.hpp, user_trace, kernel_trace, EVENT_RECORD, ETW provider, provider GUID, manifest XML, keywords mask, event ID, predicates::id_is, event_filter, schema_locator, krabs::schema, krabs::parser, Microsoft-Windows-Kernel-Network, KERNEL_NETWORK_TASK_TCPIPDatasent, PID parsing