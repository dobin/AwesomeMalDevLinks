Title:
Introduction into Microsoft Threat Intelligence Drivers (ETW-TI)

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post explains Microsoft’s Threat Intelligence ETW provider (“ETW-TI”), a kernel-instrumented telemetry source introduced in Windows 10 RS2 that gives Defender visibility into sensitive kernel activity (e.g., memory manager and APC-related operations).  
- It frames ETW-TI as Microsoft’s alternative to fragile user-mode and kernel inline-hooking approaches that became less viable after Kernel Patch Protection (KPP) and SSDT-hooking restrictions.  
- The article highlights that ETW-TI is not a normal public ETW provider: it’s delivered over a “Secure ETW Channel” and is intended to be consumable only by ELAM-signed components and protected antimalware services (PPL).  
- It covers how ETW sessions/providers are enumerated and inspected (e.g., `logman query providers` / session details), and explains key ETW configuration fields like levels, keyword masks, and enable properties.  
- It calls out specific ETW enable properties that are valuable for detection/attribution (SID, TS_ID, PROCESS_START_KEY) and notes limitations around provider-side filtering.  
- Useful for defenders and Windows telemetry researchers; also relevant to red teamers/malware developers to understand what kernel behaviors may be surfaced to Defender via protected telemetry paths.

Technical Focus:
- ETW Threat Intelligence provider (Microsoft-Windows-Threat-Intelligence) and Secure ETW
- ELAM signing, Early Launch EKU, and protected process light (PPL) constraints
- Windows kernel telemetry around Mm* (Memory Manager) and APC activity
- ETW session/provider enumeration and configuration (logman, provider GUIDs, levels/keywords)
- EVENT_ENABLE_PROPERTY_* fields (SID, TS_ID, PROCESS_START_KEY) for correlation
- Post-KPP evolution away from SSDT/inline hooking toward kernel instrumentation

Use Cases:
- Enumerate and analyze ETW-TI provider availability and session configuration on endpoints
- Build/validate detection logic using ETW properties for stronger process correlation
- Assess attacker visibility surface: what kernel behaviors may be reported via ETW-TI
- Research constraints and trust boundaries of Secure ETW vs standard ETW consumers
- Compare telemetry-based detection to hook-based monitoring approaches

Keywords:
ETW-TI, Microsoft-Windows-Threat-Intelligence, Secure ETW Channel, ELAM, Early Launch Anti Malware, Early Launch EKU, PPL, SERVICE_LAUNCH_PROTECTED_ANTIMALWARE_LIGHT, PS_PROTECTED_ANTIMALWARE_LIGHT, Kernel Patch Protection, KPP, SSDT hooking, inline hooking, Memory Manager, Mm*, APC, logman, provider GUID, EVENT_ENABLE_PROPERTY_PROCESS_START_KEY, TdhEnumerateProviderFilters