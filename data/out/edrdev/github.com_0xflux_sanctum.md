# https://github.com/0xflux/sanctum

[Skip to content](https://github.com/0xflux/sanctum#start-of-content)

You signed in with another tab or window. [Reload](https://github.com/0xflux/sanctum) to refresh your session.You signed out in another tab or window. [Reload](https://github.com/0xflux/sanctum) to refresh your session.You switched accounts on another tab or window. [Reload](https://github.com/0xflux/sanctum) to refresh your session.Dismiss alert

{{ message }}

[0xflux](https://github.com/0xflux)/ **[Sanctum](https://github.com/0xflux/Sanctum)** Public

- [Notifications](https://github.com/login?return_to=%2F0xflux%2FSanctum) You must be signed in to change notification settings
- [Fork\\
50](https://github.com/login?return_to=%2F0xflux%2FSanctum)
- [Star\\
499](https://github.com/login?return_to=%2F0xflux%2FSanctum)


Sanctum is an experimental proof-of-concept EDR, designed to detect modern malware techniques, above and beyond the capabilities of antivirus. Built in Rust.


[fluxsec.red/sanctum-edr-intro](https://fluxsec.red/sanctum-edr-intro "https://fluxsec.red/sanctum-edr-intro")

[499\\
stars](https://github.com/0xflux/Sanctum/stargazers) [50\\
forks](https://github.com/0xflux/Sanctum/forks) [Branches](https://github.com/0xflux/Sanctum/branches) [Tags](https://github.com/0xflux/Sanctum/tags) [Activity](https://github.com/0xflux/Sanctum/activity)

[Star](https://github.com/login?return_to=%2F0xflux%2FSanctum)

[Notifications](https://github.com/login?return_to=%2F0xflux%2FSanctum) You must be signed in to change notification settings

# 0xflux/Sanctum

main

[**3** Branches](https://github.com/0xflux/Sanctum/branches) [**0** Tags](https://github.com/0xflux/Sanctum/tags)

[Go to Branches page](https://github.com/0xflux/Sanctum/branches)[Go to Tags page](https://github.com/0xflux/Sanctum/tags)

Go to file

Code

Open more actions menu

## Folders and files

| Name | Name | Last commit message | Last commit date |
| --- | --- | --- | --- |
| ## Latest commit<br>[![0xflux](https://avatars.githubusercontent.com/u/49762827?v=4&size=40)](https://github.com/0xflux)[0xflux](https://github.com/0xflux/Sanctum/commits?author=0xflux)<br>[improve file write signal](https://github.com/0xflux/Sanctum/commit/87de9584104cae609e81b109092c46895245300a)<br>last weekFeb 8, 2026<br>[87de958](https://github.com/0xflux/Sanctum/commit/87de9584104cae609e81b109092c46895245300a)Â Â·Â last weekFeb 8, 2026<br>## History<br>[439 Commits](https://github.com/0xflux/Sanctum/commits/main/) <br>Open commit details<br>[View commit history for this file.](https://github.com/0xflux/Sanctum/commits/main/) 439 Commits |
| [.cargo](https://github.com/0xflux/Sanctum/tree/main/.cargo ".cargo") | [.cargo](https://github.com/0xflux/Sanctum/tree/main/.cargo ".cargo") | [Add driver model to workspace visible toml](https://github.com/0xflux/Sanctum/commit/6b28e9259f034598d5b12c91c5480d0cc4374404 "Add driver model to workspace visible toml") | 4 months agoOct 12, 2025 |
| [.vscode](https://github.com/0xflux/Sanctum/tree/main/.vscode ".vscode") | [.vscode](https://github.com/0xflux/Sanctum/tree/main/.vscode ".vscode") | [Stuff including VEH detection](https://github.com/0xflux/Sanctum/commit/cd400c66a92c65bf73d4eed9dd0c5a566d2d3e70 "Stuff including VEH detection") | last monthJan 11, 2026 |
| [clean\_files](https://github.com/0xflux/Sanctum/tree/main/clean_files "clean_files") | [clean\_files](https://github.com/0xflux/Sanctum/tree/main/clean_files "clean_files") | [Remove username from Users config scan dir](https://github.com/0xflux/Sanctum/commit/d92699c659803c3cb1f567473530d7157daa36f7 "Remove username from Users config scan dir") | 9 months agoMay 29, 2025 |
| [driver](https://github.com/0xflux/Sanctum/tree/main/driver "driver") | [driver](https://github.com/0xflux/Sanctum/tree/main/driver "driver") | [Add ransomware detection minifilter](https://github.com/0xflux/Sanctum/commit/497abb08cb938c9e27cedcc9f0ff9852b319c3f5 "Add ransomware detection minifilter") | last weekFeb 8, 2026 |
| [elam\_installer](https://github.com/0xflux/Sanctum/tree/main/elam_installer "elam_installer") | [elam\_installer](https://github.com/0xflux/Sanctum/tree/main/elam_installer "elam_installer") | [Fix hardcoded paths in file path strings.](https://github.com/0xflux/Sanctum/commit/c2cee20e1a5c3a8b7c5f7c0864a4462096123a89 "Fix hardcoded paths in file path strings.") | 8 months agoJun 12, 2025 |
| [etw\_consumer](https://github.com/0xflux/Sanctum/tree/main/etw_consumer "etw_consumer") | [etw\_consumer](https://github.com/0xflux/Sanctum/tree/main/etw_consumer "etw_consumer") | [Fully spawn PPL service and child process](https://github.com/0xflux/Sanctum/commit/905cc8d809dd454fcc68996b111cd64787a67c3e "Fully spawn PPL service and child process") | last yearFeb 1, 2025 |
| [fs\_minifilter](https://github.com/0xflux/Sanctum/tree/main/fs_minifilter "fs_minifilter") | [fs\_minifilter](https://github.com/0xflux/Sanctum/tree/main/fs_minifilter "fs_minifilter") | [improve file write signal](https://github.com/0xflux/Sanctum/commit/87de9584104cae609e81b109092c46895245300a "improve file write signal") | last weekFeb 8, 2026 |
| [gui](https://github.com/0xflux/Sanctum/tree/main/gui "gui") | [gui](https://github.com/0xflux/Sanctum/tree/main/gui "gui") | [Early Bird APC injection POC added to malware.](https://github.com/0xflux/Sanctum/commit/45487479474a51f78aa4dafeeae0133a8c6e8a50 "Early Bird APC injection POC added to malware.  NOTE: I stupidly did a cargo fmt so theres like a million changes, making it hard to see just the commit changes related to the EDR & malware sample.") | 10 months agoApr 19, 2025 |
| [imgs](https://github.com/0xflux/Sanctum/tree/main/imgs "imgs") | [imgs](https://github.com/0xflux/Sanctum/tree/main/imgs "imgs") | [Update architecture diagram](https://github.com/0xflux/Sanctum/commit/925e3462c437a6811b0b59f921177b27910306f5 "Update architecture diagram") | 6 months agoAug 10, 2025 |
| [injected\_dll](https://github.com/0xflux/Sanctum/tree/main/injected_dll "injected_dll") | [injected\_dll](https://github.com/0xflux/Sanctum/tree/main/injected_dll "injected_dll") | [Revert for 25H2](https://github.com/0xflux/Sanctum/commit/72bc50fd406ee82bbea567e798cc55496a59cda5 "Revert for 25H2") | 3 months agoNov 29, 2025 |
| [malware](https://github.com/0xflux/Sanctum/tree/main/malware "malware") | [malware](https://github.com/0xflux/Sanctum/tree/main/malware "malware") | [Add ransomware detection minifilter](https://github.com/0xflux/Sanctum/commit/497abb08cb938c9e27cedcc9f0ff9852b319c3f5 "Add ransomware detection minifilter") | last weekFeb 8, 2026 |
| [sanctum\_ppl\_runner](https://github.com/0xflux/Sanctum/tree/main/sanctum_ppl_runner "sanctum_ppl_runner") | [sanctum\_ppl\_runner](https://github.com/0xflux/Sanctum/tree/main/sanctum_ppl_runner "sanctum_ppl_runner") | [Remove ETW system, transitioning to Alt Syscalls](https://github.com/0xflux/Sanctum/commit/4d95a80e77d8f5f5f9440a3b0084db99fbb2b40b "Remove ETW system, transitioning to Alt Syscalls") | 6 months agoAug 7, 2025 |
| [server](https://github.com/0xflux/Sanctum/tree/main/server "server") | [server](https://github.com/0xflux/Sanctum/tree/main/server "server") | [Add server root](https://github.com/0xflux/Sanctum/commit/0a34ca9bf69a5a89879a106eaf1ca516165dda8e "Add server root") | 9 months agoMay 11, 2025 |
| [shared\_no\_std](https://github.com/0xflux/Sanctum/tree/main/shared_no_std "shared_no_std") | [shared\_no\_std](https://github.com/0xflux/Sanctum/tree/main/shared_no_std "shared_no_std") | [Stable changes using APC to inject Sanctum DLL into target process.](https://github.com/0xflux/Sanctum/commit/8348962a6ae80bfe17cf745dc492c81c67f47243 "Stable changes using APC to inject Sanctum DLL into target process.  Currently only targeting malware.exe and notepad.exe; targeting wider applications is causing some bugs with regard to the DLL not being correctly signed etc, so that likely needs an environment change and some further testing.. but this works, and in stable!  There is a bug with Ghost Hunting where it is not picking up on some NtOpenProcess calls.. very annoying, and needs investigating.") | 4 months agoOct 11, 2025 |
| [shared\_std](https://github.com/0xflux/Sanctum/tree/main/shared_std "shared_std") | [shared\_std](https://github.com/0xflux/Sanctum/tree/main/shared_std "shared_std") | [Refactor DLL signals to be received in the driver via IOCTL](https://github.com/0xflux/Sanctum/commit/71abbbcd7e0d9b85f848abce6f409a7a57c1a083 "Refactor DLL signals to be received in the driver via IOCTL") | 10 months agoApr 27, 2025 |
| [um\_engine](https://github.com/0xflux/Sanctum/tree/main/um_engine "um_engine") | [um\_engine](https://github.com/0xflux/Sanctum/tree/main/um_engine "um_engine") | [Stable changes using APC to inject Sanctum DLL into target process.](https://github.com/0xflux/Sanctum/commit/8348962a6ae80bfe17cf745dc492c81c67f47243 "Stable changes using APC to inject Sanctum DLL into target process.  Currently only targeting malware.exe and notepad.exe; targeting wider applications is causing some bugs with regard to the DLL not being correctly signed etc, so that likely needs an environment change and some further testing.. but this works, and in stable!  There is a bug with Ghost Hunting where it is not picking up on some NtOpenProcess calls.. very annoying, and needs investigating.") | 4 months agoOct 11, 2025 |
| [.gitignore](https://github.com/0xflux/Sanctum/blob/main/.gitignore ".gitignore") | [.gitignore](https://github.com/0xflux/Sanctum/blob/main/.gitignore ".gitignore") | [Update gitignore](https://github.com/0xflux/Sanctum/commit/4c973cf36b3a6c0fce5c99c7140405fc73d48306 "Update gitignore") | last weekFeb 8, 2026 |
| [Cargo.lock](https://github.com/0xflux/Sanctum/blob/main/Cargo.lock "Cargo.lock") | [Cargo.lock](https://github.com/0xflux/Sanctum/blob/main/Cargo.lock "Cargo.lock") | [Stable changes using APC to inject Sanctum DLL into target process.](https://github.com/0xflux/Sanctum/commit/8348962a6ae80bfe17cf745dc492c81c67f47243 "Stable changes using APC to inject Sanctum DLL into target process.  Currently only targeting malware.exe and notepad.exe; targeting wider applications is causing some bugs with regard to the DLL not being correctly signed etc, so that likely needs an environment change and some further testing.. but this works, and in stable!  There is a bug with Ghost Hunting where it is not picking up on some NtOpenProcess calls.. very annoying, and needs investigating.") | 4 months agoOct 11, 2025 |
| [Cargo.toml](https://github.com/0xflux/Sanctum/blob/main/Cargo.toml "Cargo.toml") | [Cargo.toml](https://github.com/0xflux/Sanctum/blob/main/Cargo.toml "Cargo.toml") | [Alt Syscalls for Windows 11](https://github.com/0xflux/Sanctum/commit/866b9d0d7e27e52ce62869454026c4256c0c6b59 "Alt Syscalls for Windows 11") | 9 months agoMay 11, 2025 |
| [MALWARE.ps1](https://github.com/0xflux/Sanctum/blob/main/MALWARE.ps1 "MALWARE.ps1") | [MALWARE.ps1](https://github.com/0xflux/Sanctum/blob/main/MALWARE.ps1 "MALWARE.ps1") | [IOC file scanning](https://github.com/0xflux/Sanctum/commit/6f43844297d10c0a30251566ccbd73579eba20f4 "IOC file scanning") | 2 years agoOct 24, 2024 |
| [Makefile.toml](https://github.com/0xflux/Sanctum/blob/main/Makefile.toml "Makefile.toml") | [Makefile.toml](https://github.com/0xflux/Sanctum/blob/main/Makefile.toml "Makefile.toml") | [initial commit](https://github.com/0xflux/Sanctum/commit/1e067a54c0397f88f2402931b53d9e6c163a66a2 "initial commit") | 2 years agoOct 12, 2024 |
| [installer\_clean\_vm.ps1](https://github.com/0xflux/Sanctum/blob/main/installer_clean_vm.ps1 "installer_clean_vm.ps1") | [installer\_clean\_vm.ps1](https://github.com/0xflux/Sanctum/blob/main/installer_clean_vm.ps1 "installer_clean_vm.ps1") | [test signing in script](https://github.com/0xflux/Sanctum/commit/581295fa6c1dd83c8347154b20e059bac4d291c2 "test signing in script") | 9 months agoMay 28, 2025 |
| [readme.md](https://github.com/0xflux/Sanctum/blob/main/readme.md "readme.md") | [readme.md](https://github.com/0xflux/Sanctum/blob/main/readme.md "readme.md") | [Update readme](https://github.com/0xflux/Sanctum/commit/0f6a86636a486702363ec404dadcc29f102176aa "Update readme") | 4 months agoOct 11, 2025 |
| [rust-toolchain.toml](https://github.com/0xflux/Sanctum/blob/main/rust-toolchain.toml "rust-toolchain.toml") | [rust-toolchain.toml](https://github.com/0xflux/Sanctum/blob/main/rust-toolchain.toml "rust-toolchain.toml") | [Start cascading refactor of processes API](https://github.com/0xflux/Sanctum/commit/446b21667080c27cab435f3510999874ad92546b "Start cascading refactor of processes API") | last yearMar 6, 2025 |
| [sign\_etw\_consumer.bat](https://github.com/0xflux/Sanctum/blob/main/sign_etw_consumer.bat "sign_etw_consumer.bat") | [sign\_etw\_consumer.bat](https://github.com/0xflux/Sanctum/blob/main/sign_etw_consumer.bat "sign_etw_consumer.bat") | [Fully spawn PPL service and child process](https://github.com/0xflux/Sanctum/commit/905cc8d809dd454fcc68996b111cd64787a67c3e "Fully spawn PPL service and child process") | last yearFeb 1, 2025 |
| [sign\_ppl\_runner.bat](https://github.com/0xflux/Sanctum/blob/main/sign_ppl_runner.bat "sign_ppl_runner.bat") | [sign\_ppl\_runner.bat](https://github.com/0xflux/Sanctum/blob/main/sign_ppl_runner.bat "sign_ppl_runner.bat") | [Remove verification of signing](https://github.com/0xflux/Sanctum/commit/425c052e70b5ddab3a8faee2562622d822523f96 "Remove verification of signing") | 9 months agoMay 30, 2025 |
| View all files |

## Repository files navigation

# Sanctum EDR

[Permalink: Sanctum EDR](https://github.com/0xflux/sanctum#sanctum-edr)

[![Rust Kernel Driver EDR Sanctum](https://github.com/0xflux/Sanctum/raw/main/imgs/evidence/sanctum-cover.webp)](https://github.com/0xflux/Sanctum/blob/main/imgs/evidence/sanctum-cover.webp)

The Sanctum EDR is an ðŸš§ **experimental and in development** ðŸš§ proof of concept for an EDR (Endpoint Detection and Response) tool, fully written in Rust! No
C required in this project baby!

**BREAKING CHANGE NOTIFICATION**: If you are recently updating this project, you now need to put
`sanctum.dll` in `C:\Windows\System32` (documented in below instructions).

I'm documenting this project on my [blog](https://fluxsec.red/)!

Currently, there are some features disabled (via comments, feel free to uncomment them to turn them back on) - this was due to some occasional random stability issues.
I'm currently working on another project, but I will soon be turning my attention back to the EDR.

Up until recently, the readme was in need of some tlc; given how fast the project has grown the readme was out of date and as time went on some fairly specific
configuration requirements have arose. See the Deployment Instructions section for clear details on how to install the project **to a VM**. Do not deploy this
on your host machine, as we are tampering with the kernel (Windows 11), you may encounter system instability.

I am not accepting PR's as a rule; unless your contribution is something small / utility based. This project is primarily for my own learning - and hopefully for
me to teach the concepts to people interested in low level Windows system security / malware devs / defensive engineering / analysts.

That said; as there is more attention on the project, please feel free to raise issues or use the discussions page as you wish. If you want some integrations, let me know
and I will look at building those in!

I'd also recommend opening the driver crate at its crate level from the Developer Command Prompt (e.g. for VSCode: `code driver`) as I have noticed some issues with
`Rust-Analyzer` if not opened in this way.

ðŸš§ Please note: This project is not currently designed for mass consumption; you may encounter teething issues in the deploy process - you can raise an issue
for me to fix; but I provide no guarantee it will work without issue on your deployment. This is a **POC project** first and foremost. There may be some bugs, or incomplete
features on the main branch as I develop it. For bugs, please raise an issue. Incomplete features will be in progress, so please do not raise issues for those.

Stuck trying to build / deploy this? I made a [YouTube video](https://www.youtube.com/watch?v=BFbz6ZjGitA) showing you how!

### Limitations regarding Alt Syscalls on the driver

[Permalink: Limitations regarding Alt Syscalls on the driver](https://github.com/0xflux/sanctum#limitations-regarding-alt-syscalls-on-the-driver)

Thanks to some testing by [Xacone](https://github.com/Xacone), we now know that **HVCI** prevents writing to the `PspServiceDescriptorGroupTable` structure; so this technique is **blocked** by HVCI. From my own
testing, it appears that this is still resistant to both PatchGuard and HyperGuard under VBS. I used [ssde](https://github.com/valinet/ssde/) to load my driver whilst Secure Boot and VBS were enabled, of which it is
my understanding should be enough to test it against HyperGuard. This was done with debug mode off, which should also allow PatchGuard full authority to detect and block (BugCheck) the technique.

#### Contents

[Permalink: Contents](https://github.com/0xflux/sanctum#contents)

- [Structure](https://github.com/0xflux/sanctum#structure)
- [Features](https://github.com/0xflux/sanctum#features)
- [Requirements](https://github.com/0xflux/sanctum#requirements)
- [Deployment Instructions](https://github.com/0xflux/sanctum#deployment-instructions)

## Structure

[Permalink: Structure](https://github.com/0xflux/sanctum#structure)

| Crate | Description |
| --- | --- |
| driver | Contains the code for the Sanctum driver which is required for kernel monitoring |
| um\_engine | The usermode engine of the Sanctum application which communicates with the driver, running processes, and the GUI |
| injected\_dll | A DLL injected into all processes for EDR hooking (note that this is currently phased out, having being replaced with kernel-side hooking after I researched [Alt Syscalls for Windows 11](https://fluxsec.red/alt-syscalls-for-windows-11)). I will leave this in the project for legacy / blog post reasons, I have spent a lot of time hooking functions and writing about it on my blog, so good to keep in |
| gui | A GUI for the Sanctum EDR, using Tauri for rendering |
| shared\_\* | Shared crates for the project, both in `std` and `no_std` environments |
| server | Todo, this is to be the telemetry server which will receive signals from endpoints |

**Deprecated modules**

The following modules (crates) were used in the project, and documented on my
blog, but are now no longer required. If my setup guide refers to these, then
you can swiftly disregard those parts.

| Crate | Description |
| --- | --- |
| etw\_installer | The installer program for creating the ELAM PPL service (installs `sanctum_ppl_runner`) |
| sanctum\_ppl\_runner | A ELAM signed Protected Process Light which monitors Events Tracing for Windows Threat Intelligence provider |
| etw\_consumer | Deprecated; sanctum\_ppl\_runner implements all required features this was intended to solve. Leaving in for learning reasons / linked to my blog post |

## Features

[Permalink: Features](https://github.com/0xflux/sanctum#features)

You can check my [YouTube channel](https://www.youtube.com/@FluxSec) for some POC videos :)

As a **summary** of features:

- [Alt Syscalls](https://fluxsec.red/alt-syscalls-for-windows-11) for kernel-side interception of syscalls
- Events Tracing for Windows: Threat Intelligence telemetry subscription
- Uses [Ghost Hunting](https://fluxsec.red/edr-syscall-hooking) to detect signs of malicious activity
- Detects tampering of NTDLL (thwarts common malware TTPs)
- Detects rootkit tampering in the kernel
- DLL injection of EDR (currently deprecated in favour of Alt Syscalls)

## Requirements:

[Permalink: Requirements:](https://github.com/0xflux/sanctum#requirements)

1. Cargo (obviously..).
2. Nightly.
3. Windows Driver Kit & Developer Console (as admin for building the driver).
4. Cargo make and LLVM tools, see [Microsoft's build instructions](https://github.com/microsoft/windows-drivers-rs?tab=readme-ov-file#build-requirements) for installing these.
5. Tauri build tools, [see the documentation](https://v2.tauri.app/reference/cli/) for official instructions.

## Deployment instructions

[Permalink: Deployment instructions](https://github.com/0xflux/sanctum#deployment-instructions)

The installation instructions are split between your **host** and **guest**. If you are having problems deploying this, please use the discussions page or raise and issue and I will
do my best to help / fix any bugs from the process.

They are split into instructions for a host machine and a guest VM, this is because I advise against developing & building on your deployment VM (if the driver bricks your VM and it cant
boot, then you will lose any development / environment specific setup \[assuming no snapshots\] that went into you being able to build this project).

If you wish to build and deploy on the same machine (VM only to save your host), then I recommend 2 VM's; one to build, one to deploy, in which case, treat the host section below as your 2nd
VM.

As an overview, the driver must be built via `cargo make`, which is a pipeline provided by Microsoft in the Windows Drivers project. The remaining crates for this
project are built via `cargo build`.

### Guest

[Permalink: Guest](https://github.com/0xflux/sanctum#guest)

1. Install a clean Windows 11 VM; do so first with a Gen2 processor, Secure Boot and TPM so you can properly install windows. I would recommend installing W11 Pro when prompted. You can use either a type 1 or type 2 hypervisor.
2. Update Windows etc.
3. Disable Secure Boot and TPM.
4. Boot the VM
5. Copy over the `installer_clean_vm.ps1` script from this repo root.
6. Open PowerShell as admin, and cd into where you dropped the script.
7. Enable running of scripts on your VM via powershell `Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass`
8. Run `./installer_clean_vm.ps1` \- this will initialise the folder structure required, pull down the static files, and enable debug mode and configure your VM for kernel debugging in WinDbg.

Now do the host instructions; we will return to the guest shortly.

### Host

[Permalink: Host](https://github.com/0xflux/sanctum#host)

This is a little involved due to the signing process. But follow along and you should be good.

#### Building and signing the driver

[Permalink: Building and signing the driver](https://github.com/0xflux/sanctum#building-and-signing-the-driver)

01. Ensure you have Visual Studio build tools installed
02. Ensure you have this repo cloned
03. Open Developer Command Prompt as Administrator (I'd recommend running `powershell` from this cmd prompt to upgrade to powershell)
04. CD into the driver crate of this repo
05. Run `.\cert.ps1` which will generate a ELAM compatible code signing certificate called `sanctum.pfx`. The cert will be located in the `driver` crate root.
06. Run `cargo make` \- this will build the driver.
07. Run `.\sign.bat` \- this will sign the driver.
08. Run `certmgr.exe -v target\debug\sanctum_package\sanctum.sys` which will output the certificate information of the driver:

    1. Look for the line (just on top of the half way point of the output) which has the heading: `Content Hash (To-Be-Signed Hash)::`.
    2. Note the hash that is output beneath (will be 2 lines of bytes).
    3. You want to concatenate these bytes into 1 long string. To see an example explanation, check my comment [here](https://github.com/0xflux/Sanctum/discussions/66#discussioncomment-13297486).
    4. Open `driver/build.rs` in your favourite code editor, and change the hash from what is there in your cloned copy to the hash you concatenated in the step above, again, see the above link if that doesn't make sense.
09. Run `cargo clean`.
10. Run `cargo make`.
11. Run `.\sign.bat`.

#### Building and signing your PPL service

[Permalink: Building and signing your PPL service](https://github.com/0xflux/sanctum#building-and-signing-your-ppl-service)

Must be build in release mode to match the signing script - if you wanna build in debug mode make sure to edit `sign_ppl_runner.bat`.

1. Continuing on from above, go up one dir with `cd ../`.
2. Run: `cargo build --release -p sanctum_ppl_runner` \- this will build the PPL service binary in `/target/release/`.
3. Sign the service binary via running `.\sign_ppl_runner.bat`.

#### Building the rest

[Permalink: Building the rest](https://github.com/0xflux/sanctum#building-the-rest)

(Feel free to build these in debug mode if you wish)

1. `cargo build --release -p elam_installer`
2. `cargo build --release -p injected_dll`
3. `cargo build --release -p um_engine`
4. `cargo tauri build --debug`

### Guest

[Permalink: Guest](https://github.com/0xflux/sanctum#guest-1)

Now to finish off, we want to move the binaries into the guest VM and run things!

1. Move `um_engine.exe`, `elam_installer`, `app` (gui) into ~Desktop\\sanctum
2. Move `sanctum.sys` & `sanctum_ppl_runner.exe` into %AppData%\\Sanctum
3. Move `sanctum.dll` into `C:\Windows\System32`
4. In an admin powershell terminal:
1. cd ~Desktop\\sanctum
2. `.\elam_installer.exe` \- this should work and now prompt you to reboot.
5. Reboot
6. In an admin powershell terminal:
1. cd ~Desktop\\sanctum
2. `.\elam_installer.exe` \- this time no prompt to reboot
3. `sc.exe start sanctum_ppl_runner` \- This should run your PPL service. If you have issues, check Event Viewer, or go to Services -> sanctum\_ppl\_runner and start it from there (may give more verbose error messages)
7. Run um\_engine as admin
8. Run the GUI `app.exe` as admin
9. Now you should be good to start the driver from the GUI if all went well!

**Important Note**: `elam_installer.exe` and starting the PPL needs to be run every reboot.

### Deployment problems

[Permalink: Deployment problems](https://github.com/0xflux/sanctum#deployment-problems)

If you have problems with the deployment process, please feel free to submit an issue or discussion and I will try help!

## About

Sanctum is an experimental proof-of-concept EDR, designed to detect modern malware techniques, above and beyond the capabilities of antivirus. Built in Rust.


[fluxsec.red/sanctum-edr-intro](https://fluxsec.red/sanctum-edr-intro "https://fluxsec.red/sanctum-edr-intro")

### Topics

[rust](https://github.com/topics/rust "Topic: rust") [driver](https://github.com/topics/driver "Topic: driver") [kernel-driver](https://github.com/topics/kernel-driver "Topic: kernel-driver") [antivirus](https://github.com/topics/antivirus "Topic: antivirus") [malware-analysis](https://github.com/topics/malware-analysis "Topic: malware-analysis") [malware-research](https://github.com/topics/malware-research "Topic: malware-research") [cyber-security](https://github.com/topics/cyber-security "Topic: cyber-security") [red-team](https://github.com/topics/red-team "Topic: red-team") [windows-driver](https://github.com/topics/windows-driver "Topic: windows-driver") [blue-team](https://github.com/topics/blue-team "Topic: blue-team") [edr](https://github.com/topics/edr "Topic: edr") [tauri](https://github.com/topics/tauri "Topic: tauri") [rust-driver](https://github.com/topics/rust-driver "Topic: rust-driver") [rust-windows](https://github.com/topics/rust-windows "Topic: rust-windows") [windows-rust](https://github.com/topics/windows-rust "Topic: windows-rust") [endpoint-detection-response](https://github.com/topics/endpoint-detection-response "Topic: endpoint-detection-response") [tauri-app](https://github.com/topics/tauri-app "Topic: tauri-app") [antivirus-software](https://github.com/topics/antivirus-software "Topic: antivirus-software") [rust-edr](https://github.com/topics/rust-edr "Topic: rust-edr") [rust-windows-driver](https://github.com/topics/rust-windows-driver "Topic: rust-windows-driver")

### Resources

[Readme](https://github.com/0xflux/sanctum#readme-ov-file)

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/0xflux/sanctum).

[Activity](https://github.com/0xflux/Sanctum/activity)

### Stars

[**499**\\
stars](https://github.com/0xflux/Sanctum/stargazers)

### Watchers

[**8**\\
watching](https://github.com/0xflux/Sanctum/watchers)

### Forks

[**50**\\
forks](https://github.com/0xflux/Sanctum/forks)

[Report repository](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2F0xflux%2FSanctum&report=0xflux+%28user%29)

## [Releases](https://github.com/0xflux/Sanctum/releases)

No releases published

## [Packages\  0](https://github.com/users/0xflux/packages?repo_name=Sanctum)

No packages published

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/0xflux/sanctum).

## [Contributors\  2](https://github.com/0xflux/Sanctum/graphs/contributors)

- [![@0xflux](https://avatars.githubusercontent.com/u/49762827?s=64&v=4)](https://github.com/0xflux)[**0xflux** flux](https://github.com/0xflux)
- [![@lzty](https://avatars.githubusercontent.com/u/3366095?s=64&v=4)](https://github.com/lzty)[**lzty** jacky](https://github.com/lzty)

## Languages

- [Rust92.0%](https://github.com/0xflux/Sanctum/search?l=rust)
- [HTML4.2%](https://github.com/0xflux/Sanctum/search?l=html)
- [C2.2%](https://github.com/0xflux/Sanctum/search?l=c)
- [PowerShell0.6%](https://github.com/0xflux/Sanctum/search?l=powershell)
- [Batchfile0.5%](https://github.com/0xflux/Sanctum/search?l=batchfile)
- [CSS0.4%](https://github.com/0xflux/Sanctum/search?l=css)
- [JavaScript0.1%](https://github.com/0xflux/Sanctum/search?l=javascript)

You canâ€™t perform that action at this time.