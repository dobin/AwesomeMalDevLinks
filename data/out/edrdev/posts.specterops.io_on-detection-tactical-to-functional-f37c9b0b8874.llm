Title:
On Detection: Tactical to Functional (Part 9) — Perception vs. Conception

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post argues that the “operational layer” (operation chains like Process Open → Memory Allocate → Process Write → Thread Create) is the most practical abstraction for building behavioral detections.  
- It frames EDR telemetry as “perception” and detection models as “conception,” emphasizing that detections fail when the model doesn’t match what sensors actually observe.  
- Using classic remote thread injection as an example, it maps each operation to concrete telemetry in Microsoft Defender for Endpoint (MDE) via `DeviceEvents` `ActionType` values (e.g., `OpenProcessApiCall`, `NtAllocateVirtualMemoryRemoteApiCall`, `CreateRemoteThreadApiCall`).  
- It contrasts MDE with Sysmon, showing Sysmon aligns to operations too but has gaps (e.g., lacks explicit memory allocation/write events) while offering configurable filtering.  
- The key takeaway is to engineer detections around observable operations (the “how”) rather than tool identifiers (the “what”), and to understand sensor filtering/coverage limitations.  
- Useful primarily for detection engineers and blue teams, but also valuable for red teams to anticipate which steps in an operation chain are most visible to specific sensors.

Technical Focus:
- Operation chains / operational abstraction for attacker behaviors  
- Process injection (classic remote thread injection) decomposition  
- Mapping Windows operations to EDR telemetry (MDE `DeviceEvents` / `ActionType`)  
- ETW-based telemetry sources (e.g., Threat Intelligence / Thread Intelligence providers) and kernel callback concepts  
- Sensor coverage and filtering differences (MDE vs Sysmon)  
- Kusto Query Language (KQL) hunting patterns

Use Cases:
- Build behavioral detections for process injection by chaining operation-level telemetry
- Evaluate EDR visibility gaps and vendor filtering that can break analytic assumptions
- Create sensor-agnostic detection logic by focusing on operations rather than API names/tools
- Develop KQL hunts in MDE for injection-related sequences
- Compare Sysmon vs EDR telemetry to decide what can/can’t be detected in a given environment

Keywords:
SpecterOps, Jared Atkinson, detection engineering, behavioral analytics, operation chain, operational layer, process injection, remote thread injection, OpenProcess, NtAllocateVirtualMemory, WriteProcessMemory, CreateRemoteThread, Microsoft Defender for Endpoint, MDE, DeviceEvents, ActionType, KQL, Sysmon, Event ID 8, Event ID 10, ETW, Microsoft-Windows-Threat-Intelligence, Microsoft-Windows-Thread-Intelligence, kernel callbacks, telemetry filtering, LSASS, MITRE ATT&CK T1055