Title:
ETW (Event Tracing for Windows) 101

Type:
Blog Post

Short Summary (4â€“8 sentences max):
- This write-up introduces Windows Event Tracing for Windows (ETW) and the core components: providers, keywords, consumers, controllers, and trace sessions.  
- It demonstrates using the built-in `logman.exe` utility as an ETW controller to enumerate providers, inspect provider keywords, create an ETW trace session, and enable specific kernel telemetry.  
- The post uses the `Microsoft-Windows-Kernel-Process` provider to capture process start/stop and image load/unload events by selecting keyword bitmasks and writing results to an `.etl` file viewable in Event Viewer.  
- It also shows how to programmatically consume ETW in C# using `Microsoft.Diagnostics.Tracing` / `TraceEventSession` and `KernelTraceEventParser` to stream process and module-load events in real time.  
- The notes highlight offensive implications (tampering by stopping sessions or removing providers to blind EDR telemetry) and defensive implications (leveraging ETW for richer monitoring and detecting ETW tampering).  
- Useful for red teamers, malware analysts, and defenders building telemetry pipelines or investigating Windows internals.

Technical Focus:
- ETW architecture (providers, consumers, controllers, sessions)
- `logman.exe` ETW session management (create/update/query/stop)
- Kernel ETW provider: `Microsoft-Windows-Kernel-Process` and keyword masks
- `.etl` trace files and Event Viewer analysis
- C# ETW consumption via TraceEvent (`TraceEventSession`, `KernelTraceEventParser`)
- ETW telemetry tampering considerations (provider/session removal)

Use Cases:
- Build lightweight process and module-load monitoring without Sysmon
- Enumerate and inspect ETW providers/keywords available on a host
- Create targeted ETW trace sessions for incident response or forensics
- Develop custom ETW consumers for real-time endpoint telemetry
- Assess/detect EDR evasion attempts via ETW session/provider tampering

Keywords:
ETW, Event Tracing for Windows, logman, ETW provider, ETW consumer, ETW controller, trace session, keywords bitmask, Microsoft-Windows-Kernel-Process, process start, process stop, image load, image unload, .etl, Event Viewer, TraceEventSession, KernelTraceEventParser, Microsoft.Diagnostics.Tracing, ETW tampering, EDR telemetry