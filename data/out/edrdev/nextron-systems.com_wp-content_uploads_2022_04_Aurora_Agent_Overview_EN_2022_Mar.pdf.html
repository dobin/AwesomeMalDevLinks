# https://www.nextron-systems.com/wp-content/uploads/2022/04/Aurora_Agent_Overview_EN_2022_Mar.pdf

<html><body><h1>Aurora Agent</h1>
<p>Your custom Sigma-based EDR</p>
<p>What is Aurora?</p>
<p>A lightweight agent that applies Sigma rules on endpoints</p>
<p>Lightweight agent that applies Sigma rules on log data in real-time on endpoints</p>
<p>Uses ETW (Event Tracing for Windows)</p>
<p>Managed locally via config files or via ASGARD Management Center</p>
<p>Extends the Sigma standard with ‘response’ actions</p>
<p>Kill, KillParent, Suspend, Dump Custom actions</p>
<p>Consider it your custom Sigma-based EDR</p>
<p>Aurora Agent Lite § free, lacks comfort features and modules (e.g. Cobalt Strike beaconing detection)</p>
<p><img src="https://www.nextron-systems.com/wp-content/uploads/2022/04/images/23ff685c674d1e61a011ba8ce3b75ff9719c867ccf537052ce8f5f1d1376b8a5.jpg" alt=""></p>
<h1>Comparison Sysmon / Aurora</h1>
<table><tbody><tr><td rowspan="1" colspan="1"></td><td rowspan="1" colspan="1">Sysmon</td><td rowspan="1" colspan="1">Aurora</td></tr><tr><td rowspan="1" colspan="1">Event Source</td><td rowspan="1" colspan="1">Sysmon Kernel Driver</td><td rowspan="1" colspan="1">ETW (Event Tracing for Windows)</td></tr><tr><td rowspan="1" colspan="1">Sigma Rule Event Coverage</td><td rowspan="1" colspan="1">100%</td><td rowspan="1" colspan="1">95%</td></tr><tr><td rowspan="1" colspan="1">Relative Log Volume</td><td rowspan="1" colspan="1">High</td><td rowspan="1" colspan="1">Low</td></tr><tr><td rowspan="1" colspan="1">Sigma and IOC Matching</td><td rowspan="1" colspan="1">No</td><td rowspan="1" colspan="1">Yes</td></tr><tr><td rowspan="1" colspan="1">Response Actions</td><td rowspan="1" colspan="1">No</td><td rowspan="1" colspan="1">Yes</td></tr><tr><td rowspan="1" colspan="1">Resource Control (CPU Load, Output Throttling)</td><td rowspan="1" colspan="1">No</td><td rowspan="1" colspan="1">Yes</td></tr><tr><td rowspan="1" colspan="1">Output: Eventlog</td><td rowspan="1" colspan="1">Yes</td><td rowspan="1" colspan="1">Yes</td></tr><tr><td rowspan="1" colspan="1">Output: File</td><td rowspan="1" colspan="1">No</td><td rowspan="1" colspan="1">Yes</td></tr><tr><td rowspan="1" colspan="1">Output: TCP / UDP target</td><td rowspan="1" colspan="1">No</td><td rowspan="1" colspan="1">Yes</td></tr><tr><td rowspan="1" colspan="1">Risk: Blue Screen</td><td rowspan="1" colspan="1">Yes</td><td rowspan="1" colspan="1">No</td></tr><tr><td rowspan="1" colspan="1">Risk: High System Load</td><td rowspan="1" colspan="1">Yes</td><td rowspan="1" colspan="1">No</td></tr><tr><td rowspan="1" colspan="1">Risk: Incomplete Data due to Filters</td><td rowspan="1" colspan="1">Yes</td><td rowspan="1" colspan="1">No</td></tr></tbody></table>

<p><img src="https://www.nextron-systems.com/wp-content/uploads/2022/04/images/56effdef716854e1f43b0d3fd5ecebde51ae11f5854cd335adec4bc91dbdf16e.jpg" alt=""></p>
<p><img src="https://www.nextron-systems.com/wp-content/uploads/2022/04/images/f17b2e41220c89b36b9ae3dfa6af22aa43aa1106e7f60e0ee880455ef775a90c.jpg" alt=""></p>
<p><img src="https://www.nextron-systems.com/wp-content/uploads/2022/04/images/ecc3daea85d9c1f2291e632d532d20829e36cd535eb9164b484a1eb989961af6.jpg" alt=""></p>
<h1>100% Transparency</h1>
<p>You always know exactly why a rule triggered and can adjust that rule to your needs. Every rule has descriptions and references that explain the author's intentions. No machine learning magic that generates tons of false positives.</p>
<h1>Highly Customizable</h1>
<p>Create and add your own rules and decide if Aurora should block certain activity. Aurora supports simulated blocks, offers a variety of pre-defined and custom response actions. Let Aurora report into your SIEM or your MDR service provider.</p>
<h1>Minimal Network Load and Storage Costs</h1>
<p>As the matching happens on the endpoint, Aurora transmits only a fraction of the data that other EDRs generate and transmit to their backends. Usually you'll see less than 1% of the usual network load and storage used by log data collected from Aurora agents.</p>
<p><img src="https://www.nextron-systems.com/wp-content/uploads/2022/04/images/7a039315cb1d7b8474eb6703c701452cbea12f4f5bdb1d3e1235b19b461f5361.jpg" alt=""></p>
<p><img src="https://www.nextron-systems.com/wp-content/uploads/2022/04/images/84837d3dfaea61d56f6f8182eef64f20233f75787c1fc58c445ab66164396fc4.jpg" alt=""></p>
<p><img src="https://www.nextron-systems.com/wp-content/uploads/2022/04/images/fef2afd54cf3b2524952b194679a66a3a5769a10767bc94fe5a1c488fe4d2b87.jpg" alt=""></p>
<h1>Completely On-Premises</h1>
<p>Your confidential data never leaves your network.</p>
<h1>Limited Resource Usage</h1>
<p>Aurora allows you to throttle its CPU usage and event output rate. These optional throttling options allow you to set priorities and put your system's stability first.</p>
<h1>Free Version</h1>
<p>Aurora Lite is a limited version of Aurora and free of charge. It's a great way to give it a whirl. All we ask for is a newsletter subscription.</p>
<p>Use Sigma to detect a threat</p>
<p>Add a response action</p>
<p>Predefined</p>
<p>§ Kill a process or parent process</p>
<p>Suspend a process</p>
<p>Dump process memory</p>
<p>Custom</p>
<p>A custom command line that can make use of environment variables and the event’s values e.g. copy %Image% %%ProgramData%%%ProcessId%.bin</p>
<p>Contains threats in less than a second</p>
<p><img src="https://www.nextron-systems.com/wp-content/uploads/2022/04/images/c3aa95840d2877965a93dc2db4b8781b672059de8209f55e8cb21c09a051be90.jpg" alt=""></p>
<h1>Aurora First Steps</h1>
<h1>Aurora Agent Package</h1>
<p><img src="https://www.nextron-systems.com/wp-content/uploads/2022/04/images/84140b2732b857e8f399d53d2d6877d868ab02892c1c0f8de0b3e1cadbef6609.jpg" alt=""></p>
<h1>Let’s just run Aurora a first time to get a feeling for it</h1>
<h1>Steps:</h1>
<p>Start cmd.exe as<br>Administrator<br>Change to the extracted<br>program folder<br>Run:<br>aurora-agent-64.exe</p>
<p>Administrator: Command Prompt - aurora-agent-64.exe</p>
<p>Microsoft Windows [Version 10.0.17763.2565] (c) 2018 Microsoft Corporation. All rights reserved.</p>
<p>C:\Users\Administrator&gt;cd \</p>
<p>C:&gt;cd aurora</p>
<p>C:\aurora&gt;aurora-agent-64.exe</p>
<p>Autoro Agent</p>
<p>Aurora Agent Version 0.5.0 (3c53b080ef722), Signature Revision 2022/02/17-182339 (Sigma 0.20-2949-gcabe5c50) (C) Nextron Systems GmbH, 2022</p>
<p>81::IRAAAuAATV IACTIVULICENEICES_ALIROICESALI0/0/1 RULES9er.Rvi02/0/1-80. cabe5c50)</p>
<p>F81:1:I-7IARORA:InMUL:veDisribuESSAGE:Surovailabls S nAc entLog:Microsoft-Windows-Sysmon/Operational, WinEventLog:MSExchange Management</p>
<h1>Administrator: Command Prompt</h1>
<p>Let’s see what the help has to offer</p>
<p>C:\aurora&gt;aurora-agent-64.exe --help</p>
<p>Steps:</p>
<p>Aurora Agent Version 0.6.0 (62b63beac8336), Signature Revision 2022/03/01-143433 (Sigma 0.20<br>(C) Nextron Systems GmbH, 2022</p>
<p>Usage of aurora-agent-64.exe: --activate-module strings --activate-responses --agent-name string a --auto-reload -config string -cpu-limit int --deactivate-all-consumers --deactivate-module strings --debug --dump-folder string --false-positive-filter string</p>
<p>Activate the given deactivated modules (see --module-i Execute responses that are specified in Sigma rules (e Set a different name for the service, the binary and o Automatically reload the Sigma rules after changes Use parameters from this YAML file</p>
<p>Run: aurora-agent-64.exe --help</p>
<p>CPU usage (as percentage) that the Aurora Agent should Deactivate all consumers, except for those specified by Deactivate the given modules (see --module-info for a Print debugging information</p>
<p>--help<br>-install<br>-ioc-path strings<br>-json<br>-license-path string -log-rotate uint<br>-log-size string</p>
<p>Folder where process dumps should be stored (default " Path to a file containing false positive regexes (one</p>
<p>Install Aurora Agent as a service Folders containing IOC files (default [C:\aurora\signat Write output as JSON instead òf plain text Path to the directory containing the Aurora Agent licen How many log rotations should be retained (default 7) Maximum file size for the log file. It will be rotated Paths to the Sigma log sources that should be loaded (</p>
<p>Don’t worry. We won’t need all options. Looking over the different command line flags will give you a first impression of the feature set and the many customizing options.</p>
<p>etw-log-sources-standard.yml1,C:\aurora\log-sources\etw-log-source-mappings.ym1])</p>
<p>--logfile string--low-prio--match-burst uint</p>
<h1>Show help</h1>
<h1>"medium")</h1>
<p>lt 5) --match-throttling string --minimum-level string</p>
<p>Path to log file (default: no log file) Run Aurora Agent with low process priority (can cause Number of matches for a single rule that are allowed to</p>
<p>Minimum average time between matches. Sigma Rules with Report Sigma matches with rules of this level or higher</p>
<p>--module-info -no-content-enrichment<br>--no-eventlog<br>--no-stdout -output-throttling string</p>
<p>List all available modules and whether they are active Deactivate calculations that rely on disk access (e.g. Don't log matches to the Windows event log Disable logging to the standard output Minimum average time between log messages (Warning: If</p>
<h1>--pprof</h1>
<h1>Install Aurora as a Service</h1>
<h1>Let’s install Aurora as a service</h1>
<h1>Administrator: Command Prompt</h1>
<h1>C:\Users\Administrator&gt;cd \</h1>
<p>C:&gt;cd aurora</p>
<p>C:\aurora&gt;aurora-agent-64.exe --install</p>
<h1>Administrator: Command Prompt</h1>
<p>C:\aurora&gt;aurora-agent-64.exe --status<br>Aurora Agent<br>Version: 0.5.0<br>Build Revision: 3c53b080ef722<br>Signature Revision: 2022/02/17-182339<br>Sigma Revision: 0.20-2949-gcabe5c50<br>Status: running<br>Uptime (in hours): 0</p>
<p><img src="https://www.nextron-systems.com/wp-content/uploads/2022/04/images/df3befde959484b9e21b36851c359404b1daeb114e386744e6d997d8bf348c50.jpg" alt=""></p>
<p>Aurora Agent Version 0.5.0 (3c53b0808d604), Signature Re CNextron Systems GmbH, 2022</p>
<p>′Installing Aurora Agent into "C:\Program Files\Aurora-Age Installing Aurora Agent service ..<br>Creating update tasks<br>Adding installation path to PATH variable<br>Starting Aurora Agent service<br>Parameters: license-path: C:\Program Files\Aurora-Agent, no -Agent\custom-signatures\false-positives.txt, dump-folder: Active modules: LsassDumpDetector, BeaconHunter, EtwCanary raryDriverLoadDetector, ApplyIOCs, Sigma<br>License owner: Florian Roth<br>License expires: 2023/02/11<br>Active outputs: Windows Application Eventlog</p>
<h1>C:\aurora&gt;</h1>
<p>Active Outputs: Windows Application Eventlog: enabled</p>
<h1>Steps:</h1>
<p>Active Modules:<br>LsassDumpDetector<br>BeaconHunter<br>EtwCanary<br>CommandLineMismatchDetector<br>ProcessTamperingDetector<br>TemporaryDriverLoadDetector<br>ApplyIOCs<br>Sigma<br>Start cmd.exe as<br>Administrator<br>Change to the extracted<br>program folder<br>Run:<br>aurora-agent-64.exe --install<br>Check the agents status<br>with:<br>aurora-agent-64.exe --status<br>Rule paths: C:\Program Files\Aurora-Agent\signatures\sigma-rules, C:\Program Fil<br>rules<br>Loaded rules: 1297<br>Number of rule reloads: 0</p>
<h1>Aurora Agent</h1>
<h1>Services (Local)</h1>
<h1>Start the service</h1>
<h1>C:\aurora&gt;</h1>
<p>Description:<br>Real time sigma rule matching for<br>Windows events</p>
<p>Name Description ActiveX Insaller (AxinstSV) Provides Use.. AllJoyn Router Service Routes AllJo... App Readiness Gets apps re... Application Host Helper Seroidesad Application Identity Determines... Application Information Facilitates th... Application Layer Gateway SProvides sup.. Application Management Processes in... AppX Dploment Service ie ASP.NET State Service Provides sup...</p>
<p>Event Statistics:<br>Events observed so far: 52980<br>Events missed so far: 0<br>Sigma matches: 0<br>′Suppressed Sigma matches of those: 0</p>
<p>Response Actions: disabled</p>
<table><tbody><tr><td>Running</td><td>Manual Manual</td><td>Local System Network Se...</td></tr><tr><td></td><td>Automatic</td><td>Local System</td></tr><tr><td rowspan="3"></td><td>Disabled</td><td>Local Service</td></tr><tr><td>Manual (Trigg.</td><td>Local Service</td></tr><tr><td>Manual</td><td>Local System</td></tr></tbody></table>

<h1>Function Tests and Event Review</h1>
<p>Okay, now we verify that Aurora works as expected with a simple function test</p>
<h1>Steps:</h1>
<p>Start cmd.exe as Administrator<br>Run:<br>whoami /priv<br>Open the EventViewer and go to<br>“Application” "I<br>Look for the source “Aurora<br>Agent”<br>Select the “Details” Tab<br>Review the event information</p>
<p><img src="https://www.nextron-systems.com/wp-content/uploads/2022/04/images/c63c895e9117c656ab784b1aafd65535e86f8ac2f4599b97e92bd3342f0c2433.jpg" alt=""></p>
<h1>Update Aurora and Signatures</h1>
<p>When you install Aurora as a service, two scheduled tasks are created to update the program (weekly) and the signatures (daily)</p>
<p>However, you can trigger an update manually using the “aurora-agent-util”</p>
<h1>Steps:</h1>
<p>Start cmd.exe as Administrator<br>Change directory to<br>“C:\Program Files\Aurora-Agent”<br>(service) or the extracted program<br>folder, e.g. “C:\aurora” (standalone)<br>Run<br>aurora-agent-util.exe upgrade<br>Get usage help for all functions of the<br>utility with<br>aurora-agent-util.exe help</p>
<p><img src="https://www.nextron-systems.com/wp-content/uploads/2022/04/images/d58c5c3cdc4eafaa10d8de686b2d72a1dda0928213133120484c8fb3b7a7fb65.jpg" alt=""></p>
<h1>Great! Aurora is up and running.</h1>
<p>Now let’s look at some customization options</p>
<h1>Output Configuration</h1>
<p>Aurora supports 3 different output channels</p>
<p>The Windows Eventlog (Application)<br>deactivate with:<br>--no-eventlog</p>
<p>A log file (automatically rotated) --log-file aurora-events.log</p>
<p>A remote system (UDP, TCP, plain or JSON) --udp-target oursyslog.internal</p>
<p><img src="https://www.nextron-systems.com/wp-content/uploads/2022/04/images/fee01120776c03640172f292cdc464bdea7ed59a4c49ea706fef49ddc59d8cc2.jpg" alt=""></p>
<h1>Configuration Presets</h1>
<p>Aurora includes 4 configuration presets that select different ETW log sources and add/remove different log enrichment modules</p>
<p>Standard (implicitly used – doesn’t have to be specified)</p>
<p>Reduced -c agent-config-reduced.yml<br>TLDR; No process access events, CPU limit to 30%, minimum<br>level “high” Minimal -c agent-config-minimal.yml<br>TLDR; no hash calculations, CPU limit 20%, no LSASS dump check, no Beacon Hunter, no Image load and Create Remote Thread events</p>
<p>Intense -c agent-config-intense.yml TLDR; every reasonable input activated, no limits</p>
<p><img src="https://www.nextron-systems.com/wp-content/uploads/2022/04/images/bf2e2f54542a9715840d1e2536284be87a8b351b0ccfc8ea37e826880726070a.jpg" alt=""></p>
<p>Aurora comes with several presets that help you select the recommended response for a given use case --response-set ransomware.yml --activate-responses</p>
<p>This way you don’t have to review all 1000+ rules and select the ones that you want to see blocked</p>
<p><img src="https://www.nextron-systems.com/wp-content/uploads/2022/04/images/805e6a12257fa3e5b9a786ece76fa730f6ee918207ac757d30e7e5d690874903.jpg" alt=""></p>
<p><img src="https://www.nextron-systems.com/wp-content/uploads/2022/04/images/36e727a1e1592d776928b4911963a520f3899fbc26bd08484db68d17fe779202.jpg" alt=""></p>
<h1>The Cool Stuff</h1>
<p>Features that make Aurora great</p>
<h1>IOC Application</h1>
<h1>Example: Type Filenames</h1>
<p>The effectiveness of filename<br>patterns is highly underrated<br>Malware and attackers use<br>repeating patterns, why shouldn’t<br>we?<br>We apply these patterns in many<br>different events: process creation,<br>file creation, image loads, handle<br>events, driver loads</p>
<p>We also apply: C2 FQDNs, IPs, Named Pipes, Handles, File Hashes</p>
<h1>LSASS Dump Names \lsass[a-zA-Z_-.]{1,16}.(dmp|zip|rar|7z);70 # Programs or scripts in C:\ProgramData folder (no sub folder) :\ProgramData\[^l|]{1,40}.(EXE|DLL|exe|dll|bat|BAT|vbs|VBS|ps1|jar)([^._||]]|$);70 # Archive in suspicious folder :\ProgramData\[\w]{1,6}.(zip|7z|rar)$;40</h1>
<h1>Typical Malware Location - AppData Local / Roaming</h1>
<p>(?i)\AppData\[^|/]{1,64}.exe([^.<em>|||]]|$);75<br>(?i)\AppData|[^|/]{1,64}.(dll|bat|vbs|ps1|js|hta);80<br>(?i)\AppData\Locall[^|/]{1,64}.exe([^.</em>||]]|$);75<br>(?i)\AppData|\Local|[^|/]{1,64}(dll|bat|vbs|ps1|hta);80<br>(?i)\AppData\Roaming\[^|/]{1,64}.exe$;75<br>(?i)\AppData\Roaming\[^|/]{1,64}.(dll|bat|vbs|ps1|hta);80</p>
<h1>Unique New Fields</h1>
<p>Since Aurora generates only a few events, we said:</p>
<p>“Why not add new fields that are helpful in evaluating the event?”</p>
<p>e.g.</p>
<p>The field ProcessTree allows you to write rules like:</p>
<p>”If new process powershell.exe and w3wp.exe somewhere in the process tree.” JI</p>
<p>The field FileAge allows you to write rules like:</p>
<p>“If access to lsass.exe process memory and FileAge starts with 00d00h00m.”</p>
<p>GrandparentCommandLine: c:\windows\system32\inetsrv\w3wp.exe -ap "DefaultAppPool" -v "v4.0" -I "webengine4.dIl" -a |.\pipe\iisipm8ff443c1-cfe8-4a0d-ac14-a9816f37bb80 -h "C:\inetpub\temp\apppools\DefaultAppPool\DefaultAppPool.config" -w ™ -m 0 -t 20 -ta 0 GrandparentImage: C:\Windows\System32\inetsrv\w3wp.exe GrandparentProcessld: 4728</p>
<p>ParentProcessId: 5296<br>ParentUser: IIS APPPOOL\DefaultAppPool<br>Processld: 4400<br>ProcessTree: C:\Windows\System32\wininit.exe|C:\Windows\System32<br>\services.exe|C:\Windows\System32\svchost.exe|C:\Windows\System32<br>\inetsrv\w3wp.exe|C:\Windows\System32\cmd.exe|C:\Windows\System32\whoami.exe<br>Product: Microsoft $\textcircled{8}$ Windows $\textcircled{8}$ Operating System<br>Provider_Guid: {3D6FA8D0-FE05-11D0-9DDA-00C04FD7BA7C}<br>Provider_Name: SystemTraceProvider-Process<br>Field: ImageLoaded<br>FileAge: 00d00h14m12s<br>FileCreationDate: 2022-03-30T06:16:03</p>
<h1>Statistics Reporting</h1>
<p>Reports event statistics at frequent intervals</p>
<p>Allows you to monitor the agents for manipulations</p>
<p>Attacker disables / stops agent Attacker disables ETW Attacker tampers with ETW event channels</p>
<p>The idea: you cannot completely rule out manipulations of the agents – but you can detect them!</p>
<p>Get it as plain text or JSON with “diff” values to last report, e.g.</p>
<p>Microsoft-Windows-Kernel-Audit-API-Calls: 260000 (+4400 since last report)</p>
<p>^ this is great for monitoring ; diff is 0 = tampering with ETW</p>
<table><tbody><tr><td>Event 101, AuroraAgent</td><td></td><td></td></tr><tr><td colspan="2">General Details</td><td></td></tr><tr><td colspan="2">Friendly View XML View</td><td></td></tr><tr><td>+ System EventData Agent status: Running</td><td>Module: Aurora-Agent Aurora_memory: 303636480</td><td></td></tr><tr><td></td><td>Cpu_cores: 8 eiERLILEORDALN, File/KERNEL_FILE_KEYWORD_DELETE_PATH:1640 (+380 since lastreport), WinEventLog:Microsoft-Windows-Kernel- File/KERNEL_FILE_KEYWORD_CREATE:1254105 (+157308since last report), WinEventLog:Microsoft-Windows-Kerne- Lost_events: 0 Process Start From Suspicious Folder: 6 (+0 since last report)</td><td>NE EA A ntnn A S </td></tr></tbody></table>

<p>--report-stats<br>--report-stats-interval string<br>--report-stats-verbose</p>
<h1>Reports Extraordinary Event Producers</h1>
<p>Aurora highlights events producers that are responsible for over 50% of the observed events and recommends an exclusion</p>
<p>Event 107, AuroraAgent   </p>
<table><tbody><tr><td colspan="6">Application Number of events: 2,484</td></tr><tr><td>Level</td><td>Date and Time</td><td>Source</td><td>Event ID Task Category</td><td></td><td rowspan="4">^</td></tr><tr><td>IInformation</td><td>3/30/2022 11:37:11 PM</td><td>AuroraAgent</td><td>107 None</td><td></td></tr><tr><td>Information</td><td>3/30/2022 11:35:11 PM</td><td>Security-SPP</td><td>16384 None</td><td></td></tr><tr><td>Innformation D</td><td>3/30/2022 11:35:11 PM</td><td>AuroraAgent</td><td>102 None</td><td></td></tr></tbody></table>

<p>Friendly ViewXML View + System EventData</p>
<p>A process caused a high amount of observed events. It could be advisable to add a process exclusion for the mentioned process image paths to reduce the CPU and memory load. Module: Aurora-Agent<br>Process: C:\ProgramData\Microsoft\Windows Defender\Platform\4.18.2202.4-0\MsMpEng.exe Process_events: 220983<br>Total_events: 365522</p>
<h1>Diagnostics</h1>
<p>Generate a package with diagnostics data</p>
<p>Can help you</p>
<p>find and exclude top event producers Identify modules that cause higher CPU usage and disable them debug agents that show abnormal behavior</p>
<p><img src="https://www.nextron-systems.com/wp-content/uploads/2022/04/images/6e93275ae05714178b22336fd11f7016e9b293df5e4ee4cae1afbd40625928b2.jpg" alt=""></p>
<table><tbody><tr><td colspan="3">This PC &gt; Local Disk (C:) &gt; aurora-beta &gt; diagnostics</td></tr><tr><td>^</td><td>^ Name</td><td>Date modified</td></tr><tr><td></td><td>cpu.pprof</td><td>30/03/2022 14:46</td></tr><tr><td></td><td>diagnostics.log</td><td>30/03/2022 14:46</td></tr><tr><td></td><td>goroutine.pprof</td><td>30/03/2022 14:46</td></tr><tr><td></td><td>heap.pprof</td><td>30/03/2022 14:46</td></tr><tr><td>{}</td><td>status.json</td><td>30/03/2022 14:46</td></tr><tr><td></td><td>status.txt</td><td>30/03/2022 14:46</td></tr></tbody></table>

<p><img src="https://www.nextron-systems.com/wp-content/uploads/2022/04/images/9859a70e79d555301ab348dc4c1b83a405e1cdd4ca62a4eba2971927b804cd19.jpg" alt=""></p>
<h1>Custom Service Name</h1>
<h1>Choose a service name to hide Aurora’s presence from simple attempts to detect it</h1>
<p>Administrator: Command Prompt</p>
<p>C:\aurora&gt;aurora-agent-64.exe --install --agent-name Fnord</p>
<p><img src="https://www.nextron-systems.com/wp-content/uploads/2022/04/images/19cdb0927a2041b41e233ec2f42a5cde4b28a2fa502845203937a28cdf7d5e5b.jpg" alt=""></p>
<p>Aurora Agent Version 1.0.1 (c7fd171ab216b), Signature Revision 2022/03/29-135547 (Sigma 0.20-3418-g7cd65a73) (C) Nextron Systems GmbH, 2022</p>
<p>Installing Aurora Agent into "C:\Program Files|\Fnord"<br>Installing Aurora Agent service •<br>Creating update tasks<br>Adding installation path to PATH variable<br>Starting Aurora Agent service</p>
<p>Pramricens-path::\ProgramFilesFnoragent-namFnordno-stdoruefalse-positiveilter C:\Program los-c Files\Fnord\config\process-excludes.cfg</p>
<p>Active modules: LsassDumpDetector, BeaconHunter, EtwCanary, CommandLineMismatchDetector, ProcessTamperingDetector, Tempo raryDriverLoadDetector,ApplyIOCs,Rescontrol, SigmETWSource,ETWKerneSource EventlogSurce, PollHandes License owner: Florian Roth</p>
<p><img src="https://www.nextron-systems.com/wp-content/uploads/2022/04/images/a2def1d2584828ca0042c211a5f80f16778f0e895128a3949a4bf9990160a1a2.jpg" alt=""></p>
<h1>Getting Started</h1>
<p>Visit the contact form and mention “Aurora Agent” <a href="https://www.nextron-systems.com/get-started/">https://www.nextron-systems.com/get-started/</a></p>
<h1>Extra Slides</h1>
<p>Used for discussions regarding some of the features</p>
<h1>Independence and Stability</h1>
<p>No specific Windows audit policy required</p>
<p>No Sysmon required</p>
<p>We tap into ETW, recreate 90%* of the events used in Sysmon and apply Sigma rules to them</p>
<p><img src="https://www.nextron-systems.com/wp-content/uploads/2022/04/images/8e5417f3687f1de9d8e599408e70b8103ccef19004b9949e6057a520af6bbb45.jpg" alt=""></p>
<p>No Kernel Driver used (no blue screens)</p>
<p>Disadvantage: we miss some events (NamedPipe events, in some corner cases the CommandLine of a process)</p>
<p><img src="https://www.nextron-systems.com/wp-content/uploads/2022/04/images/004baf39f7ff89ae469e8d93515454e0a56d7015828b6a11240eee7aa228b443.jpg" alt=""></p>
<h1>Reduced Log Volume</h1>
<h1>Endpoint</h1>
<h1>High Volume Events</h1>
<p>e.g.<br>Process Access File Write Access Handle Access Network Connections</p>
<h1>Aurora Agent</h1>
<p>Applies Sigma rules Only sends matches to backend</p>
<p>High Volume of Log Data</p>
<p><img src="https://www.nextron-systems.com/wp-content/uploads/2022/04/images/c9755ebfcdb369de9824150d8c7b47d9e6fc79ba15b31f7d4aacd50669c7a698.jpg" alt=""></p>
<h1>Recreation of Sysmon-like Events in Aurora</h1>
<p><img src="https://www.nextron-systems.com/wp-content/uploads/2022/04/images/c54cfcc16ee7f4743eab9a7f2f8abc75fec9cde5488c0046cb52f9436a0f9aa5.jpg" alt=""></p>
<p>Event ID 1: Process Creation ProcessID Image ParentImage CommandLine Hash</p>
<p>Event ID 2: A process changed a file creation time<br>Event ID 3: Network connection<br>Event ID 4: Sysmon service state change<br>Event ID 5: Process Terminated<br>Event ID 6: Driver loaded ImageLoaded Hashes Signature SignatureStatus</p>
<p>Event ID 1: Process Creation ProcessID Image ParentImage CommandLine Hash</p>
<p>Event ID 2: A process changed a file creation time<br>Event ID 3: Network connection<br>Event ID 4: Sysmon service state change<br>Event ID 5: Process Terminated<br>Event ID 6: Driver loaded ImageLoaded Hashes Signature SignatureStatus</p>
<p>Percentage of Event / Fields</p>
<p>Percentage of<br>Event / Fields<br>used in Sigma Rules</p>
<p>~70% ~95%</p>
<h1>ASGARD and Aurora Agent</h1>
<p>Deploy Aurora with the ASGARD Agent<br>(no installation, Aurora runs as a sub process of our service controller)<br>Manage Sigma rules and updates of these rules Deploy specific rule sets on groups of endpoints Manage the response<br>actions</p>
<p><img src="https://www.nextron-systems.com/wp-content/uploads/2022/04/images/e5b5d0c26b4255b2ab8ae86a049faeec736557000a7e3b241c23c5fe1ebba5f2.jpg" alt=""></p>
<h1>Management in ASGARD</h1>
<p>Comfortable Sigma rule management</p>
<p>Enable / disable rules<br>Create rule sets for different asset groups<br>Manage updates of the rules<br>Identify changes in updated rules and<br>decide to deploy them<br>Define response actions, put them in<br>simulation mode or arm them</p>
<p><img src="https://www.nextron-systems.com/wp-content/uploads/2022/04/images/8e0aeff27e68052341e0b0c2506854d7b1f3e40aa628d5efc5b9ab1f0b6ef900.jpg" alt=""></p>
<p><img src="https://www.nextron-systems.com/wp-content/uploads/2022/04/images/e5fb75cecc1f8bdafbd1fe43386cf085b85716c4177a2ef38f3f19d1ff115fe1.jpg" alt=""></p>
<p>1 Sigma rulesets contain uncompiled changes</p>
<p>Create Ruleset</p>
<p><img src="https://www.nextron-systems.com/wp-content/uploads/2022/04/images/ee7b9dfde617f2f7a21e3b67c11957b302208ac8d216d828cb5f239c02b7b375.jpg" alt=""></p>
<p><img src="https://www.nextron-systems.com/wp-content/uploads/2022/04/images/0f278e19bf2d718c9f7e777e481759d1f0bb7ad861ef8be9f44c3df3eb1994ad.jpg" alt=""></p>
<h1>Action: Kill, Recursive, LowPrivOnly, Ancestors: All</h1>
<p><img src="https://www.nextron-systems.com/wp-content/uploads/2022/04/images/9bfff01390d630c0cc4c23779a22b3152074803eb13b3d26b84925d316aa21ef.jpg" alt=""></p>
</body></html>