# https://www.alteredsecurity.com/post/when-the-hunter-becomes-the-hunted-using-custom-callbacks-to-disable-edrs

<!DOCTYPE html><html lang="en" style="scroll-padding-top: 0px;">
<body class="" style="--scrollbar-width: 15px;">








    <!--pageHtmlEmbeds.bodyStart start-->
    
    
    
    <!--pageHtmlEmbeds.bodyStart end-->















    <!-- domStoreHtml -->
    <svg data-dom-store="" style="display:none"><defs id="dom-store-defs"></defs></svg>
    

<div id="SITE_CONTAINER"><div id="main_MF" class="main_MF"><div id="SCROLL_TO_TOP" class="Vd6aQZ ignore-focus SCROLL_TO_TOP" role="region" tabindex="-1" aria-label="top of page"><span class="mHZSwn">top of page</span></div><div id="BACKGROUND_GROUP" class="BACKGROUND_GROUP"><div id="pageBackground_tvmm2" data-media-height-override-type="" data-media-position-override="false" class="pageBackground_tvmm2 BmZ5pC"><div id="bgLayers_pageBackground_tvmm2" data-hook="bgLayers" data-motion-part="BG_LAYER pageBackground_tvmm2" class="MW5IWV"><div data-testid="colorUnderlay" class="LWbAav Kv1aVt"></div><div id="bgMedia_pageBackground_tvmm2" data-motion-part="BG_MEDIA pageBackground_tvmm2" class="VgO9Yg"></div></div></div></div><div id="site-root" class="site-root"><div id="masterPage" class="mesh-layout masterPage css-editing-scope"><main id="PAGES_CONTAINER" class="PAGES_CONTAINER" tabindex="-1" data-main-content="true"><div id="SITE_PAGES" class="JsJXaX SITE_PAGES"><div id="tvmm2" class="dBAkHi theme-vars tvmm2"><div class="PFkO7r wixui-page" data-testid="page-bg"></div><div class="HT5ybB"><div id="Containertvmm2" class="Containertvmm2 SPY_vo"><div data-mesh-id="Containertvmm2inlineContent" data-testid="inline-content" class=""><div data-mesh-id="Containertvmm2inlineContent-gridContainer" data-testid="mesh-container-content"><section id="comp-lgc6jaat1" tabindex="-1" class="Oqnisf comp-lgc6jaat1 wixui-section" data-block-level-container="ClassicSection"><div id="bgLayers_comp-lgc6jaat1" data-hook="bgLayers" data-motion-part="BG_LAYER comp-lgc6jaat1" class="MW5IWV"><div data-testid="colorUnderlay" class="LWbAav Kv1aVt"></div><div id="bgMedia_comp-lgc6jaat1" data-motion-part="BG_MEDIA comp-lgc6jaat1" class="VgO9Yg"></div></div><div data-mesh-id="comp-lgc6jaat1inlineContent" data-testid="inline-content" class=""><div data-mesh-id="comp-lgc6jaat1inlineContent-gridContainer" data-testid="mesh-container-content"><section id="comp-kx7ja115" class="comp-kx7ja115 CohWsy wixui-column-strip"><div id="bgLayers_comp-kx7ja115" data-hook="bgLayers" data-motion-part="BG_LAYER comp-kx7ja115" class="if7Vw2"><div data-testid="colorUnderlay" class="tcElKx i1tH8h"></div><div id="bgMedia_comp-kx7ja115" data-motion-part="BG_MEDIA comp-kx7ja115" class="wG8dni"></div></div><div data-testid="columns" class="V5AUxf"><div id="comp-kx7ja13n" class="comp-kx7ja13n YzqVVZ wixui-column-strip__column"><div id="bgLayers_comp-kx7ja13n" data-hook="bgLayers" data-motion-part="BG_LAYER comp-kx7ja13n" class="MW5IWV"><div data-testid="colorUnderlay" class="LWbAav Kv1aVt"></div><div id="bgMedia_comp-kx7ja13n" data-motion-part="BG_MEDIA comp-kx7ja13n" class="VgO9Yg"></div></div><div data-mesh-id="comp-kx7ja13ninlineContent" data-testid="inline-content" class=""><div data-mesh-id="comp-kx7ja13ninlineContent-gridContainer" data-testid="mesh-container-content"></div></div></div></div></section><div id="TPAMultiSection_kx7j0qqq" class="TWFxr5  TPAMultiSection_kx7j0qqq"><div class="TPAMultiSection_kx7j0qqq"><div style="--wix-color-29:var(--wix-color-3);--wix-color-37:var(--wix-color-5);--wix-color-38:var(--wix-color-8);--wix-color-39:var(--wix-color-8);--wix-color-40:var(--wix-color-1);--wix-color-41:var(--wix-color-8);--wix-color-42:var(--wix-color-8);--wix-color-43:var(--wix-color-1);--wix-color-44:var(--wix-color-3);--wix-color-45:var(--wix-color-3);--wix-color-46:var(--wix-color-1);--wix-color-47:var(--wix-color-1);--wix-color-48:var(--wix-color-8);--wix-color-49:var(--wix-color-8);--wix-color-50:var(--wix-color-1);--wix-color-51:var(--wix-color-8);--wix-color-52:var(--wix-color-8);--wix-color-53:var(--wix-color-1);--wix-color-54:var(--wix-color-3);--wix-color-55:var(--wix-color-3)" data-hook="tpa-components-provider"><div><div style="--root-width:980px" class="md lt-lg lt-xl gt-xs gt-s gt-sm gt-740 gt-830 gt-886 gt-940 w686-980 lte-w980 lte-banner-w1564 lte-banner-w1425 lte-banner-w1181 lte-banner-w980 lte-category-header-w1364  urT2WH" data-hook="post-page-root"><div class=""><div id="TPAMultiSection_kx7j0qqq.above-header" data-hook="slot-placeholder-TPAMultiSection_kx7j0qqq.above-header" class=""></div></div><div class="L5x0Fp xZVb1s is-desktop app-desktop"><div class="qi0cF2 message" data-hook="message"></div><div class="WmZAIu" id="new-blog-popover-root"></div><div id="content-wrapper"><div class="ZL4A4N" data-hook="post-page"><div class=""><div id="TPAMultiSection_kx7j0qqq.above-content-1" data-hook="slot-placeholder-TPAMultiSection_kx7j0qqq.above-content-1" class=""></div></div><div class=""><div id="TPAMultiSection_kx7j0qqq.above-content-2" data-hook="slot-placeholder-TPAMultiSection_kx7j0qqq.above-content-2" class=""></div></div><div class="HcBlwg"><div class="zp8IQu"><div><div class="EcwjNF"><article class="tgMH9T" data-hook="post"><section class="UYw9XC" data-hook="post-hero-image"></section><div class="HW6ttf"><section class="VQDdIN" data-hook="post-description"><div class="moHCnT"><div class="moHCnT"><div class="fTEXDR" data-rce-version="10.161.1"><div class="keIqh" dir="ltr" style="--ricos-text-color:rgb(var(--textParagraphColor-rgb));--ricos-text-color-tuple:var(--textParagraphColor-rgb);--ricos-action-color:rgb(var(--postButtonBackgroundColor));--ricos-action-color-tuple:var(--postButtonBackgroundColor);--ricos-background-color:rgb(var(--postBackgroundColor));--ricos-background-color-tuple:var(--postBackgroundColor);--ricos-fallback-color:rgb(0, 0, 0);--ricos-fallback-color-tuple:0, 0, 0;--ricos-settings-action-color:rgb(0, 0, 0);--ricos-settings-action-color-tuple:0, 0, 0;--ricos-text-on-action-color:rgb(var(--postButtonTextColor));--ricos-text-on-action-color-tuple:var(--postButtonTextColor);--ricos-action-color-fallback:rgb(0, 0, 0);--ricos-action-color-fallback-tuple:0, 0, 0;--ricos-custom-p-font-weight:var(--textParagraphFont-weight);--ricos-custom-p-font-style:var(--textParagraphFont-style);--ricos-custom-p-line-height:max(calc(var(--textParagraphFont-size) * 1.5), var(--textParagraphFont-line-height));--ricos-custom-p-font-size:var(--textParagraphFont-size);--ricos-custom-p-font-family:var(--textParagraphFont-family);--ricos-custom-p-text-decoration:var(--textParagraphFont-text-decoration);--ricos-custom-p-color:rgb(var(--textParagraphColor));--ricos-custom-h1-font-weight:var(--textH1Font-weight);--ricos-custom-h1-font-style:var(--textH1Font-style);--ricos-custom-h1-line-height:var(--textH1Font-line-height);--ricos-custom-h1-font-size:var(--textH1Font-size);--ricos-custom-h1-font-family:var(--textH1Font-family);--ricos-custom-h1-text-decoration:var(--textH1Font-text-decoration);--ricos-custom-h1-color:rgb(var(--textH1Color));--ricos-custom-h2-font-weight:var(--textH2Font-weight);--ricos-custom-h2-font-style:var(--textH2Font-style);--ricos-custom-h2-line-height:var(--textH2Font-line-height);--ricos-custom-h2-font-size:var(--textH2Font-size);--ricos-custom-h2-font-family:var(--textH2Font-family);--ricos-custom-h2-text-decoration:var(--textH2Font-text-decoration);--ricos-custom-h2-color:rgb(var(--textH2Color));--ricos-custom-h3-font-weight:var(--textH3Font-weight);--ricos-custom-h3-font-style:var(--textH3Font-style);--ricos-custom-h3-line-height:var(--textH3Font-line-height);--ricos-custom-h3-font-size:var(--textH3Font-size);--ricos-custom-h3-font-family:var(--textH3Font-family);--ricos-custom-h3-text-decoration:var(--textH3Font-text-decoration);--ricos-custom-h3-color:rgb(var(--textH3Color));--ricos-custom-h4-font-weight:var(--textH4Font-weight);--ricos-custom-h4-font-style:var(--textH4Font-style);--ricos-custom-h4-line-height:var(--textH4Font-line-height);--ricos-custom-h4-font-size:var(--textH4Font-size);--ricos-custom-h4-font-family:var(--textH4Font-family);--ricos-custom-h4-text-decoration:var(--textH4Font-text-decoration);--ricos-custom-h4-color:rgb(var(--textH4Color));--ricos-custom-h5-font-weight:var(--textH5Font-weight);--ricos-custom-h5-font-style:var(--textH5Font-style);--ricos-custom-h5-line-height:var(--textH5Font-line-height);--ricos-custom-h5-font-size:var(--textH5Font-size);--ricos-custom-h5-font-family:var(--textH5Font-family);--ricos-custom-h5-text-decoration:var(--textH5Font-text-decoration);--ricos-custom-h5-color:rgb(var(--textH5Color));--ricos-custom-h6-font-weight:var(--textH6Font-weight);--ricos-custom-h6-font-style:var(--textH6Font-style);--ricos-custom-h6-line-height:var(--textH6Font-line-height);--ricos-custom-h6-font-size:var(--textH6Font-size);--ricos-custom-h6-font-family:var(--textH6Font-family);--ricos-custom-h6-text-decoration:var(--textH6Font-text-decoration);--ricos-custom-h6-color:rgb(var(--textH6Color));--ricos-custom-quote-line-height:var(--textQuoteFont-line-height);--ricos-custom-quote-font-size:var(--textQuoteFont-size);--ricos-custom-quote-font-style:var(--textQuoteFont-style);--ricos-custom-quote-font-family:var(--textQuoteFont-family);--ricos-custom-quote-font-weight:var(--textQuoteFont-weight);--ricos-custom-quote-text-decoration:var(--textQuoteFont-text-decoration);--ricos-custom-quote-color:rgb(var(--textQuoteColor));--ricos-custom-quote-border-color:rgb(var(--textLinksAndHashtagsColor));--ricos-custom-quote-margin-inline-start:var(--ricosQuoteMarginInlineStart);--ricos-custom-code-block-line-height:1.5;--ricos-custom-link-font-style:inherit;--ricos-custom-link-font-weight:inherit;--ricos-custom-link-text-decoration:inherit;--ricos-custom-link-color:rgb(var(--textLinksAndHashtagsColor));--ricos-custom-hashtag-font-style:inherit;--ricos-custom-hashtag-font-weight:inherit;--ricos-custom-hashtag-text-decoration:inherit;--ricos-custom-hashtag-color:rgb(var(--textLinksAndHashtagsColor));--ricos-custom-footer-toolbar-padding-inline-start:var(--ricosFooterPadding);--ricos-custom-footer-toolbar-padding-inline-end:var(--ricosFooterPadding);--ricos-custom-editor-add-plugin-button-position-inline-start:var(--ricosAddPluginButtonStart);--ricos-breakout-normal-padding-start:var(--ricosNormalPadding);--ricos-breakout-normal-padding-end:var(--ricosNormalPadding);--ricos-breakout-full-width-padding-start:var(--ricosFullWidthPadding);--ricos-breakout-full-width-padding-end:var(--ricosFullWidthPadding)" data-id="content-viewer"><div class="mU3tk"><div type="first" data-hook="rcv-block-first"></div><div class="_0-aF-"><div data-breakout="normal"><h2 class="JP1W3 nAEMg Z7lok X7MWW" dir="auto" id="viewer-foo"><span class="-pTyw"><span>Intro</span></span></h2></div><div type="heading" data-hook="rcv-block1"></div><div data-breakout="normal"><div class="Rc39c HhrTy Z7lok X7MWW" dir="auto" id="viewer-cxd633325"><span class="vMus0"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block2"></div><div data-breakout="normal"><p class="Rc39c HhrTy -N-bn X7MWW" dir="auto" id="viewer-rhke13329"><span class="vMus0 -N-bn"><span>In the ever-evolving landscape of cybersecurity, the race between attackers and defenders is relentless. Security mechanisms, particularly those at the kernel level, are designed to provide robust protection against sophisticated threats. However, as attackers continuously devise new methods to bypass these defenses, the hunters—our trusted Endpoint Detection and Response (EDR) systems—can themselves become the hunted. This blog delves into a chilling demonstration of how a signed rootkit, can leverage the </span><strong style="font-weight:700"><span style="color:#ed3237;text-decoration:inherit"><span>PsSetCreateProcessNotifyRoutine</span></span></strong><span> function to cripple EDR processes. By registering a custom callback, this rootkit effectively blindsides security defenses, preventing critical EDR processes from starting and leaving the system vulnerable to undetected malicious activities. Join us as we explore this advanced threat tactic, emphasizing the urgent need for fortified kernel-level protections to maintain the integrity and effectiveness of our security infrastructure.</span></span></p></div><div type="paragraph" data-hook="rcv-block3"></div><div data-breakout="normal"><div class="Rc39c HhrTy -N-bn X7MWW" dir="auto" id="viewer-lk5tz3356"><span class="vMus0 -N-bn"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block4"></div><div data-breakout="normal"><h2 class="JP1W3 nAEMg -N-bn X7MWW" dir="auto" id="viewer-msf2p3361"><span class="-pTyw -N-bn"><span>How EDR is Detecting Processes once created ?</span></span></h2></div><div type="heading" data-hook="rcv-block5"></div><div data-breakout="normal"><div class="Rc39c HhrTy -N-bn X7MWW" dir="auto" id="viewer-mnq283381"><span class="vMus0 -N-bn"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block6"></div><div data-breakout="normal"><p class="Rc39c HhrTy -N-bn X7MWW" dir="auto" id="viewer-pz1sd3387"><span class="vMus0 -N-bn"><span>When a process, such as </span><strong style="font-weight:700"><span style="color:#ed3237;text-decoration:inherit"><span>malware.exe</span></span></strong><span> with PID 1234, is created, the functions </span><strong style="font-weight:700"><span style="color:#ed3237;text-decoration:inherit"><span>CreateProcessA/W</span></span></strong><span> and </span><strong style="font-weight:700"><span style="color:#ed3237;text-decoration:inherit"><span>NtCreateProcess</span></span></strong><span> are executed, triggering a system call to the Windows kernel. The kernel then invokes registered process creation notify routines by iterating over the </span><strong style="font-weight:700"><span style="color:#ed3237;text-decoration:inherit"><span>nt!PspCallProcessNotifyRoutines</span></span></strong><span> array, which holds pointers to callback functions. These routines include callbacks registered by various drivers.</span></span></p></div><div type="paragraph" data-hook="rcv-block7"></div><div data-breakout="normal"><div class="Rc39c HhrTy -N-bn X7MWW" dir="auto" id="viewer-pupmn3606"><span class="vMus0 -N-bn"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block8"></div><div data-breakout="normal"><p class="Rc39c HhrTy -N-bn X7MWW" dir="auto" id="viewer-9m92w3621"><span class="vMus0 -N-bn"><span>In the image, the red-highlighted entries such as </span><strong style="font-weight:700"><span style="color:#ed3237;text-decoration:inherit"><span>WdFilter.sys</span></span></strong><span> and </span><strong style="font-weight:700"><span style="color:#ed3237;text-decoration:inherit"><span>mssecflt.sys</span></span></strong><span> represent drivers that are part of EDR systems, specifically for Windows Defender and Microsoft Defender for Endpoint (MDE), respectively. These EDR-specific drivers register callbacks to monitor and respond to process creation events. When a process creation event occurs, these callbacks are triggered, allowing the EDR system to inspect the process's details, such as its command line arguments, its executable image, its memory usage, and other relevant information. Additionally, the EDR system might inject a DLL into the process's memory to hook certain APIs, enhancing its ability to monitor and control the process for security purposes.</span></span></p></div><div type="paragraph" data-hook="rcv-block9"></div><div data-breakout="normal"><div class="Rc39c HhrTy -N-bn X7MWW" dir="auto" id="viewer-gwl863796"><span class="vMus0 -N-bn"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block10"></div><div data-breakout="normal"><p class="Rc39c HhrTy -N-bn X7MWW" dir="auto" id="viewer-3l58r3816"><span class="vMus0 -N-bn"><span>By leveraging these callbacks, EDR systems can effectively detect and respond to potential threats in real-time. This mechanism allows them to perform thorough inspections and take appropriate actions, such as blocking malicious processes, alerting security administrators, or collecting forensic data for further analysis. Ensuring the integrity of these callback routines is crucial for maintaining robust security measures and preventing malicious actors from bypassing detection mechanisms.</span></span></p></div><div type="paragraph" data-hook="rcv-block11"></div><div data-breakout="normal"><div class="Rc39c HhrTy Z7lok X7MWW" dir="auto" id="viewer-b99o73953"><span class="vMus0"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block12"></div><div data-breakout="normal"><div class="i5TUk" id="viewer-m7g6a3952"><div class="J9Vi9 mL-Fz"><figure class="OPDJf" data-hook="figure-IMAGE"><div data-hook="image-viewer" class="fnfJM"><div style="--dim-height:963;--dim-width:1524;--ricos-image-default-border-color:unset" id="m7g6a3952" class="_49X-U wNivC _8xVnn" data-hook="image-viewer-m7g6a3952"><wow-image id="c10f5f_3fbcedb5b6a14f4aaa308c0cc46b1f52~mv2.png" class="undefined tKegW" data-image-info="{&quot;containerId&quot;:&quot;m7g6a3952&quot;,&quot;alignType&quot;:&quot;center&quot;,&quot;displayMode&quot;:&quot;fill&quot;,&quot;isLQIP&quot;:true,&quot;isSEOBot&quot;:false,&quot;lqipTransition&quot;:&quot;blur&quot;,&quot;encoding&quot;:&quot;AVIF&quot;,&quot;imageData&quot;:{&quot;width&quot;:1524,&quot;height&quot;:963,&quot;uri&quot;:&quot;c10f5f_3fbcedb5b6a14f4aaa308c0cc46b1f52~mv2.png&quot;,&quot;name&quot;:&quot;&quot;,&quot;displayMode&quot;:&quot;fill&quot;}}" data-motion-part="BG_IMG m7g6a3952" data-bg-effect-name="" data-has-ssr-src="true" data-animate-blur="" data-is-responsive="true" data-transitioned=""><img src="https://static.wixstatic.com/media/c10f5f_3fbcedb5b6a14f4aaa308c0cc46b1f52~mv2.png/v1/fill/w_740,h_468,al_c,q_85,usm_0.66_1.00_0.01,enc_avif,quality_auto/c10f5f_3fbcedb5b6a14f4aaa308c0cc46b1f52~mv2.png" alt="How EDR is detecting and monitoring process creation" style="width:100%;height:100%;object-fit:cover;object-position:50% 50%;max-width:100%;position:absolute;left:0;top:0" data-pin-url="https://www.alteredsecurity.com/post/when-the-hunter-becomes-the-hunted-using-custom-callbacks-to-disable-edrs" data-pin-media="https://static.wixstatic.com/media/c10f5f_3fbcedb5b6a14f4aaa308c0cc46b1f52~mv2.png/v1/fill/w_1524,h_963,al_c,q_90/c10f5f_3fbcedb5b6a14f4aaa308c0cc46b1f52~mv2.png" draggable="false" data-ssr-src-done="true" fetchpriority="high" data-load-done=""></wow-image></div><button class="KxJvA" type="button" data-hook="image-expand-button" aria-label="Expand image"><svg viewBox="0 0 19 19" xmlns="http://www.w3.org/2000/svg" class="C02F9"><path d="M15.071 8.371V4.585l-4.355 4.356a.2.2 0 0 1-.283 0l-.374-.374a.2.2 0 0 1 0-.283l4.356-4.355h-3.786a.2.2 0 0 1-.2-.2V3.2c0-.11.09-.2.2-.2H16v5.371a.2.2 0 0 1-.2.2h-.529a.2.2 0 0 1-.2-.2zm-6.5 6.9v.529a.2.2 0 0 1-.2.2H3v-5.371c0-.11.09-.2.2-.2h.529c.11 0 .2.09.2.2v3.786l4.355-4.356a.2.2 0 0 1 .283 0l.374.374a.2.2 0 0 1 0 .283L4.585 15.07h3.786c.11 0 .2.09.2.2z" fill="#000" fill-rule="nonzero"></path></svg></button></div><div class="i5TUk" id="viewer-m7g6a3952-caption"><div class="_1pWd-"><figcaption class="q-Ags" style="padding-top:16px;padding-bottom:16px"><span>How EDR is detecting and monitoring process creation</span></figcaption></div></div></figure></div></div></div><div type="image" data-hook="rcv-block13"></div><div data-breakout="normal"><div class="Rc39c HhrTy Z7lok X7MWW" dir="auto" id="viewer-gechv3954"><span class="vMus0"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block14"></div><div data-breakout="normal"><h2 class="JP1W3 nAEMg Z7lok X7MWW" dir="auto" id="viewer-6x3314017"><span class="-pTyw"><span>The PspCreateProcessNotifyRoutine array</span></span></h2></div><div type="heading" data-hook="rcv-block15"></div><div data-breakout="normal"><div class="Rc39c HhrTy Z7lok X7MWW" dir="auto" id="viewer-wga6e5739"><span class="vMus0"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block16"></div><div data-breakout="normal"><p class="Rc39c HhrTy -N-bn X7MWW" dir="auto" id="viewer-9vasf5761"><span class="vMus0 -N-bn"><span>EDR (Endpoint Detection and Response) systems, antivirus software (AVs), and Sysmon (System Monitor) register callback routines in callback arrays so they get notified when a process or thread is created or when an image is loaded. These callbacks provide additional information that allows these security tools to detect malware at runtime. Patching or disabling these callbacks can blind EDRs, AVs, and Sysmon, preventing them from obtaining critical information about malware activities.</span></span></p></div><div type="paragraph" data-hook="rcv-block17"></div><div data-breakout="normal"><div class="Rc39c HhrTy Z7lok X7MWW" dir="auto" id="viewer-53sgn5810"><span class="vMus0"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block18"></div><div data-breakout="normal"><p class="Rc39c HhrTy -N-bn X7MWW" dir="auto" id="viewer-ngak55833"><span class="vMus0 -N-bn"><span>Using </span><strong style="font-weight:700"><span style="color:#000000;text-decoration:inherit"><span>WinDbg</span></span></strong><span>, a kernel debugger, I reversed the kernel to examine a specific callback array called </span><strong style="font-weight:700"><span style="color:#ed3237;text-decoration:inherit"><span>PspCreateProcessNotifyRoutine</span></span></strong><span>. This array stores all the process creation notification callbacks registered by various drivers. Security software and EDR systems register their process creation callbacks in this array using functions such as </span><a target="_blank" href="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ntddk/nf-ntddk-pssetcreateprocessnotifyroutine" rel="noopener noreferrer" class="eqTR9 JfUOL" data-hook="web-link"><strong style="font-weight:700"><u style="text-decoration:underline"><span>PsSetCreateProcessNotifyRoutine</span></u></strong></a><span>, </span><a target="_blank" href="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ntddk/nf-ntddk-pssetcreateprocessnotifyroutineex" rel="noopener noreferrer" class="eqTR9 JfUOL" data-hook="web-link"><strong style="font-weight:700"><u style="text-decoration:underline"><span>PsSetCreateProcessNotifyRoutineEx</span></u></strong></a><span>, and </span><a target="_blank" href="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ntddk/nf-ntddk-pssetcreateprocessnotifyroutineex2" rel="noopener noreferrer" class="eqTR9 JfUOL" data-hook="web-link"><u style="text-decoration:underline"><span>PsSetCreateProcessNotifyRoutineEx2</span></u></a><span>. Each of these functions allows drivers to add their specific callbacks to the array, enabling them to monitor process creation events effectively.</span></span></p></div><div type="paragraph" data-hook="rcv-block19"></div><div data-breakout="normal"><div class="Rc39c HhrTy Z7lok X7MWW" dir="auto" id="viewer-2cbyo7766"><span class="vMus0"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block20"></div><div data-breakout="normal"><div class="i5TUk" id="viewer-m2idg7765"><div class="J9Vi9 mL-Fz"><figure class="OPDJf" data-hook="figure-IMAGE"><div data-hook="image-viewer" class="fnfJM"><div style="--dim-height:250;--dim-width:643;--ricos-image-default-border-color:unset" id="m2idg7765" class="_49X-U wNivC _8xVnn" data-hook="image-viewer-m2idg7765"><wow-image id="c10f5f_265277c7358b4dd392b618d939b9cb8d~mv2.png" class="undefined tKegW" data-image-info="{&quot;containerId&quot;:&quot;m2idg7765&quot;,&quot;alignType&quot;:&quot;center&quot;,&quot;displayMode&quot;:&quot;fill&quot;,&quot;isLQIP&quot;:true,&quot;isSEOBot&quot;:false,&quot;lqipTransition&quot;:&quot;blur&quot;,&quot;encoding&quot;:&quot;AVIF&quot;,&quot;imageData&quot;:{&quot;width&quot;:643,&quot;height&quot;:250,&quot;uri&quot;:&quot;c10f5f_265277c7358b4dd392b618d939b9cb8d~mv2.png&quot;,&quot;name&quot;:&quot;&quot;,&quot;displayMode&quot;:&quot;fill&quot;}}" data-motion-part="BG_IMG m2idg7765" data-bg-effect-name="" data-has-ssr-src="true" data-animate-blur="" data-is-responsive="true" data-transitioned=""><img src="https://static.wixstatic.com/media/c10f5f_265277c7358b4dd392b618d939b9cb8d~mv2.png/v1/fill/w_740,h_288,al_c,lg_1,q_85,enc_avif,quality_auto/c10f5f_265277c7358b4dd392b618d939b9cb8d~mv2.png" alt="" style="width:100%;height:100%;object-fit:cover;object-position:50% 50%;max-width:100%;position:absolute;left:0;top:0" data-pin-url="https://www.alteredsecurity.com/post/when-the-hunter-becomes-the-hunted-using-custom-callbacks-to-disable-edrs" data-pin-media="https://static.wixstatic.com/media/c10f5f_265277c7358b4dd392b618d939b9cb8d~mv2.png/v1/fill/w_772,h_300,al_c,lg_1,q_85/c10f5f_265277c7358b4dd392b618d939b9cb8d~mv2.png" draggable="false" data-ssr-src-done="true" fetchpriority="high" data-load-done=""></wow-image></div><button class="KxJvA" type="button" data-hook="image-expand-button" aria-label="Expand image"><svg viewBox="0 0 19 19" xmlns="http://www.w3.org/2000/svg" class="C02F9"><path d="M15.071 8.371V4.585l-4.355 4.356a.2.2 0 0 1-.283 0l-.374-.374a.2.2 0 0 1 0-.283l4.356-4.355h-3.786a.2.2 0 0 1-.2-.2V3.2c0-.11.09-.2.2-.2H16v5.371a.2.2 0 0 1-.2.2h-.529a.2.2 0 0 1-.2-.2zm-6.5 6.9v.529a.2.2 0 0 1-.2.2H3v-5.371c0-.11.09-.2.2-.2h.529c.11 0 .2.09.2.2v3.786l4.355-4.356a.2.2 0 0 1 .283 0l.374.374a.2.2 0 0 1 0 .283L4.585 15.07h3.786c.11 0 .2.09.2.2z" fill="#000" fill-rule="nonzero"></path></svg></button></div><div class="i5TUk" id="viewer-m2idg7765-caption"><div class="_1pWd-"><figcaption class="q-Ags" style="padding-top:16px;padding-bottom:16px"><span>The PspCreateProcessNotifyRoutine array</span></figcaption></div></div></figure></div></div></div><div type="image" data-hook="rcv-block21"></div><div data-breakout="normal"><div class="Rc39c HhrTy Z7lok X7MWW" dir="auto" id="viewer-5r4q37767"><span class="vMus0"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block22"></div><div data-breakout="normal"><p class="Rc39c HhrTy -N-bn X7MWW" dir="auto" id="viewer-5fod78503"><span class="vMus0 -N-bn"><span>To get the actual address of the notification routines, I need to perform a bitwise AND operation on the values in the array with </span><strong style="font-weight:700"><span style="color:#ed3237;text-decoration:inherit"><span>0xFFFFFFFFFFFFFFF8</span></span></strong><span>. This operation aligns the addresses correctly. The result of this operation provides the actual addresses of the callback routines.</span></span></p></div><div type="paragraph" data-hook="rcv-block23"></div><div data-breakout="normal"><div class="Rc39c HhrTy Z7lok X7MWW" dir="auto" id="viewer-r4lcd8829"><span class="vMus0"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block24"></div><div data-breakout="normal"><div class="i5TUk" id="viewer-v1v6q8828"><div class="J9Vi9 mL-Fz"><figure class="OPDJf" data-hook="figure-IMAGE"><div data-hook="image-viewer" class="fnfJM"><div style="--dim-height:78;--dim-width:650;--ricos-image-default-border-color:unset" id="v1v6q8828" class="_49X-U wNivC _8xVnn" data-hook="image-viewer-v1v6q8828"><wow-image id="c10f5f_b05d9d3fe22845d9993cc6ff0f1f2711~mv2.png" class="undefined tKegW" data-image-info="{&quot;containerId&quot;:&quot;v1v6q8828&quot;,&quot;alignType&quot;:&quot;center&quot;,&quot;displayMode&quot;:&quot;fill&quot;,&quot;isLQIP&quot;:true,&quot;isSEOBot&quot;:false,&quot;lqipTransition&quot;:&quot;blur&quot;,&quot;encoding&quot;:&quot;AVIF&quot;,&quot;imageData&quot;:{&quot;width&quot;:650,&quot;height&quot;:78,&quot;uri&quot;:&quot;c10f5f_b05d9d3fe22845d9993cc6ff0f1f2711~mv2.png&quot;,&quot;name&quot;:&quot;&quot;,&quot;displayMode&quot;:&quot;fill&quot;}}" data-motion-part="BG_IMG v1v6q8828" data-bg-effect-name="" data-has-ssr-src="true" data-animate-blur="" data-is-responsive="true"><img src="https://static.wixstatic.com/media/c10f5f_b05d9d3fe22845d9993cc6ff0f1f2711~mv2.png/v1/fill/w_65,h_8,al_c,q_85,usm_0.66_1.00_0.01,blur_2,enc_avif,quality_auto/c10f5f_b05d9d3fe22845d9993cc6ff0f1f2711~mv2.png" alt="" style="width:100%;height:100%;object-fit:cover;object-position:50% 50%;max-width:100%;position:absolute;left:0;top:0" data-pin-url="https://www.alteredsecurity.com/post/when-the-hunter-becomes-the-hunted-using-custom-callbacks-to-disable-edrs" data-pin-media="https://static.wixstatic.com/media/c10f5f_b05d9d3fe22845d9993cc6ff0f1f2711~mv2.png/v1/fill/w_910,h_109,al_c,lg_1,q_85/c10f5f_b05d9d3fe22845d9993cc6ff0f1f2711~mv2.png" draggable="false"></wow-image></div><button class="KxJvA" type="button" data-hook="image-expand-button" aria-label="Expand image"><svg viewBox="0 0 19 19" xmlns="http://www.w3.org/2000/svg" class="C02F9"><path d="M15.071 8.371V4.585l-4.355 4.356a.2.2 0 0 1-.283 0l-.374-.374a.2.2 0 0 1 0-.283l4.356-4.355h-3.786a.2.2 0 0 1-.2-.2V3.2c0-.11.09-.2.2-.2H16v5.371a.2.2 0 0 1-.2.2h-.529a.2.2 0 0 1-.2-.2zm-6.5 6.9v.529a.2.2 0 0 1-.2.2H3v-5.371c0-.11.09-.2.2-.2h.529c.11 0 .2.09.2.2v3.786l4.355-4.356a.2.2 0 0 1 .283 0l.374.374a.2.2 0 0 1 0 .283L4.585 15.07h3.786c.11 0 .2.09.2.2z" fill="#000" fill-rule="nonzero"></path></svg></button></div><div class="i5TUk" id="viewer-v1v6q8828-caption"><div class="_1pWd-"><figcaption class="q-Ags" style="padding-top:16px;padding-bottom:16px"><span>Windows Defender's process creation callback routine's address</span></figcaption></div></div></figure></div></div></div><div type="image" data-hook="rcv-block25"></div><div data-breakout="normal"><div class="Rc39c HhrTy Z7lok X7MWW" dir="auto" id="viewer-r02bg8830"><span class="vMus0"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block26"></div><div data-breakout="normal"><p class="Rc39c HhrTy -N-bn X7MWW" dir="auto" id="viewer-4unex8977"><span class="vMus0 -N-bn"><span>We can see that the </span><strong style="font-weight:700"><span style="color:#000000;text-decoration:inherit"><span>Windows Defender filtering</span></span></strong><span> driver is registering a Process Creation Notification Callback for monitoring or logging process creation events, or for implementing anti-malware protections. This is evidenced by the highlighted </span><span style="color:#ed3237;text-decoration:inherit"><span>WdFilter!MpCreateProcessNotifyRoutineEx</span></span><span> function in the provided WinDbg output. This function is part of the Windows Defender filtering driver, which plays a crucial role in the detection and prevention of malware by monitoring the creation of processes and logging relevant information.</span></span></p></div><div type="paragraph" data-hook="rcv-block27"></div><div data-breakout="normal"><div class="Rc39c HhrTy -N-bn X7MWW" dir="auto" id="viewer-f00bk16457"><span class="vMus0 -N-bn"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block28"></div><div data-breakout="normal"><p class="Rc39c HhrTy -N-bn X7MWW" dir="auto" id="viewer-kw3i816499"><span class="vMus0 -N-bn"><span>If I can patch or remove this entry from the process callbacks array, I would effectively disable runtime detection and prevention mechanisms. This would render the system vulnerable to malware, as the EDR and AV software would no longer receive notifications about new processes being created. However, the specifics of how to patch or remove these entries and the implications of doing so are beyond the scope of this blog. The primary focus here is to highlight </span><u style="text-decoration:underline"><span>Process Creation Kernel Callbacks Registering for EDR Process Starting Preventing</span></u><span>.</span></span></p></div><div type="paragraph" data-hook="rcv-block29"></div><div data-breakout="normal"><div class="Rc39c HhrTy -N-bn X7MWW" dir="auto" id="viewer-lzz7i16888"><span class="vMus0 -N-bn"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block30"></div><div data-breakout="normal"><h2 class="JP1W3 nAEMg -N-bn X7MWW" dir="auto" id="viewer-ccwrs16933"><span class="-pTyw -N-bn"><span>Registering Process creation Notification for Blocking EDR processes creation</span></span></h2></div><div type="heading" data-hook="rcv-block31"></div><div data-breakout="normal"><div class="Rc39c HhrTy -N-bn X7MWW" dir="auto" id="viewer-6jcp117114"><span class="vMus0 -N-bn"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block32"></div><div data-breakout="normal"><p class="Rc39c HhrTy -N-bn X7MWW" dir="auto" id="viewer-e05vw17160"><span class="vMus0 -N-bn"><span>The function </span><a target="_blank" href="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ntddk/nf-ntddk-pssetcreateprocessnotifyroutineex" rel="noopener noreferrer" class="eqTR9 JfUOL" data-hook="web-link"><strong style="font-weight:700"><u style="text-decoration:underline"><span>PsSetCreateProcessNotifyRoutineEx</span></u></strong></a><span> registers a custom callback routine, </span><span style="color:#ed3237;text-decoration:inherit"><span>blockEDR</span></span><span>, which is invoked by the Windows kernel whenever a process is created or terminated. The </span><span style="color:#ed3237;text-decoration:inherit"><span>blockEDR</span></span><span> function adheres to the </span><a target="_blank" href="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ntddk/nc-ntddk-pcreate_process_notify_routine_ex" rel="noopener noreferrer" class="eqTR9 JfUOL" data-hook="web-link"><u style="text-decoration:underline"><span>PCREATE_PROCESS_NOTIFY_ROUTINE_EX </span></u></a><span>prototype, enabling it to receive detailed process creation and deletion events. These events include the process identifier (PID), the image file name, the command line, and other relevant information about the process being created, as detailed in the </span><a target="_blank" href="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ntddk/ns-ntddk-_ps_create_notify_info" rel="noopener noreferrer" class="eqTR9 JfUOL" data-hook="web-link"><u style="text-decoration:underline"><span>PS_CREATE_NOTIFY_INFO </span></u></a><span>structure.</span></span></p></div><div type="paragraph" data-hook="rcv-block33"></div><div data-breakout="normal"><div class="Rc39c HhrTy -N-bn X7MWW" dir="auto" id="viewer-czy7c22049"><span class="vMus0 -N-bn"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block34"></div><div data-breakout="normal"><p class="Rc39c HhrTy -N-bn X7MWW" dir="auto" id="viewer-9db6b22108"><span class="vMus0 -N-bn"><span>Here is an example code snippet demonstrating the registration of the </span><span style="color:#ed3237;text-decoration:inherit"><span>blockEDR</span></span><span> callback:</span></span></p></div><div type="paragraph" data-hook="rcv-block35"></div><div data-breakout="normal"><div class="Rc39c HhrTy -N-bn X7MWW" dir="auto" id="viewer-ddh9y22225"><span class="vMus0 -N-bn"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block36"></div><div data-breakout="normal"><pre class="QIATN LM15Q Z7lok" dir="auto" id="viewer-5kml225306"><span class=""><span>
NTSTATUS status = PsSetCreateProcessNotifyRoutineEx(blockEDR, FALSE);
if (!NT_SUCCESS(status)) {
	DbgPrintEx(0, 0, "[ProcessBlocker] Failed to set process notify routine. Status: 0x%08X\n", status);
	return status;
}
</span></span></pre></div><div type="code_block" data-hook="rcv-block37"></div><div data-breakout="normal"><div class="Rc39c HhrTy -N-bn X7MWW" dir="auto" id="viewer-y4etk24200"><span class="vMus0 -N-bn"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block38"></div><div data-breakout="normal"><p class="Rc39c HhrTy -N-bn X7MWW" dir="auto" id="viewer-v0iqe27851"><span class="vMus0 -N-bn"><span>In this code, the </span><span style="color:#ed3237;text-decoration:inherit"><span>PsSetCreateProcessNotifyRoutineEx</span></span><span> function call attempts to register the </span><span style="color:#ed3237;text-decoration:inherit"><span>blockEDR</span></span><span> callback. The </span><span style="color:#ed3237;text-decoration:inherit"><span>FALSE</span></span><span> parameter indicates that the callback is being registered, not removed. If the registration is successful, </span><span style="color:#ed3237;text-decoration:inherit"><span>status</span></span><span> will reflect a success code. However, if the registration fails, </span><span style="color:#ed3237;text-decoration:inherit"><span>status</span></span><span> will contain an error code, and a debug message will be printed indicating the failure.</span></span></p></div><div type="paragraph" data-hook="rcv-block39"></div><div data-breakout="normal"><div class="Rc39c HhrTy -N-bn X7MWW" dir="auto" id="viewer-4jif729094"><span class="vMus0 -N-bn"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block40"></div><div data-breakout="normal"><p class="Rc39c HhrTy -N-bn X7MWW" dir="auto" id="viewer-zvov929166"><span class="vMus0 -N-bn"><span>To prevent Endpoint Detection and Response (EDR) processes from starting, the </span><span style="color:#ed3237;text-decoration:inherit"><span>blockEDR</span></span><span> function examines the </span><span style="color:#ed3237;text-decoration:inherit"><span>CreateInfo</span></span><span> structure, which contains details about the process being created, including its image file name. It checks the image file name against a predefined list of EDR process names (</span><span style="color:#ed3237;text-decoration:inherit"><span>edrNames</span></span><span>). If a match is found, the process creation is blocked by setting </span><span style="color:#ed3237;text-decoration:inherit"><span>CreateInfo-&gt;CreationStatus</span></span><span> to </span><span style="color:#ed3237;text-decoration:inherit"><span>STATUS_ACCESS_DENIED</span></span><span>. This effectively prevents the specified EDR processes from starting.</span></span></p></div><div type="paragraph" data-hook="rcv-block41"></div><div data-breakout="normal"><div class="Rc39c HhrTy Z7lok X7MWW" dir="auto" id="viewer-bdi5k24201"><span class="vMus0"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block42"></div><div data-breakout="normal"><p class="Rc39c HhrTy Z7lok X7MWW" dir="auto" id="viewer-trfap24162"><span class="vMus0"><span>Here's an example implementation of the `blockEDR` function:</span></span></p></div><div type="paragraph" data-hook="rcv-block43"></div><div data-breakout="normal"><div class="Rc39c HhrTy Z7lok X7MWW" dir="auto" id="viewer-0u3yz30661"><span class="vMus0"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block44"></div><div data-breakout="normal"><pre class="QIATN LM15Q Z7lok" dir="auto" id="viewer-ahibg30745"><span class=""><span>// Process creation notify routine
void blockEDR(PEPROCESS Process, HANDLE ProcessId, PPS_CREATE_NOTIFY_INFO CreateInfo) {
UNREFERENCED_PARAMETER(Process);
UNREFERENCED_PARAMETER(ProcessId);

if (CreateInfo) {
	for (int i = 0; i &lt; sizeof(edrNames) / sizeof(edrNames[0]); ++i) {
 		if (wcsstr(CreateInfo-&gt;ImageFileName-&gt;Buffer, edrNames[i]) != NULL) {
			DbgPrintEx(0, 0, "[ProcessBlocker] Blocking %ws process creation\n", edrNames[i]);
			CreateInfo-&gt;CreationStatus = STATUS_ACCESS_DENIED;
			break;
		   }
		}
	}
}
</span></span></pre></div><div type="code_block" data-hook="rcv-block45"></div><div data-breakout="normal"><div class="Rc39c HhrTy Z7lok X7MWW" dir="auto" id="viewer-hk7ib31024"><span class="vMus0"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block46"></div><div data-breakout="normal"><h2 class="JP1W3 nAEMg Z7lok X7MWW" dir="auto" id="viewer-vel6z39502"><span class="-pTyw"><span>Process Creation Kernel Notification Callbacks Array Before &amp; After the operation</span></span></h2></div><div type="heading" data-hook="rcv-block47"></div><div data-breakout="normal"><div class="Rc39c HhrTy Z7lok X7MWW" dir="auto" id="viewer-81i8g39766"><span class="vMus0"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block48"></div><div data-breakout="normal"><h3 class="CwsM- nAEMg Z7lok X7MWW" dir="auto" id="viewer-qzefw39852"><span class="-pTyw"><span>Before Loading </span><span style="color:#ed3237;text-decoration:inherit"><span>prevent.sys</span></span></span></h3></div><div type="heading" data-hook="rcv-block49"></div><div data-breakout="normal"><div class="Rc39c HhrTy Z7lok X7MWW" dir="auto" id="viewer-tjs4340375"><span class="vMus0"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block50"></div><div data-breakout="normal"><p class="Rc39c HhrTy -N-bn X7MWW" dir="auto" id="viewer-m0lwl40463"><span class="vMus0 -N-bn"><span>Before the signed (</span><u style="text-decoration:underline"><span>"it's not the topic of this blog, it's coming soon on Altered Security how you can get a certificate"</span></u><span>) rootkit </span><span style="color:#ed3237;text-decoration:inherit"><span>prevent.sys</span></span><span> is loaded, the </span><span style="color:#ed3237;text-decoration:inherit"><span>PspCreateProcessNotifyRoutine</span></span><span> array contains a list of callbacks registered by various security drivers. In the provided image, entries from drivers such as </span><span style="color:#ed3237;text-decoration:inherit"><span>WdFilter.sys</span></span><span> (Windows Defender), </span><span style="color:#ed3237;text-decoration:inherit"><span>mssecflt.sys</span></span><span> (Microsoft Security), and others are visible. These drivers are part of the system's EDR infrastructure, which monitors process creation events to detect and mitigate potential threats. By having their callbacks registered, these drivers can inspect the details of newly created processes, analyze their behavior, and take appropriate actions to prevent malicious activities. Using Process Hacker, a search for the keyword "defender" shows that critical EDR processes like </span><span style="color:#ed3237;text-decoration:inherit"><span>MsSense.exe</span></span><span> and other related services  and other processes are actively running, indicating a robust security posture.</span></span></p></div><div type="paragraph" data-hook="rcv-block51"></div><div data-breakout="normal"><div class="Rc39c HhrTy Z7lok X7MWW" dir="auto" id="viewer-vowr143335"><span class="vMus0"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block52"></div><div data-breakout="normal"><div class="i5TUk" id="viewer-fgsoa43334"><div class="J9Vi9 mL-Fz"><figure class="OPDJf" data-hook="figure-IMAGE"><div data-hook="image-viewer" class="fnfJM"><div style="--dim-height:715;--dim-width:1794;--ricos-image-default-border-color:unset" id="fgsoa43334" class="_49X-U wNivC _8xVnn" data-hook="image-viewer-fgsoa43334"><wow-image id="c10f5f_36711f717bfa4fab88cd74536cfdbefc~mv2.png" class="undefined tKegW" data-image-info="{&quot;containerId&quot;:&quot;fgsoa43334&quot;,&quot;alignType&quot;:&quot;center&quot;,&quot;displayMode&quot;:&quot;fill&quot;,&quot;isLQIP&quot;:true,&quot;isSEOBot&quot;:false,&quot;lqipTransition&quot;:&quot;blur&quot;,&quot;encoding&quot;:&quot;AVIF&quot;,&quot;imageData&quot;:{&quot;width&quot;:1794,&quot;height&quot;:715,&quot;uri&quot;:&quot;c10f5f_36711f717bfa4fab88cd74536cfdbefc~mv2.png&quot;,&quot;name&quot;:&quot;&quot;,&quot;displayMode&quot;:&quot;fill&quot;}}" data-motion-part="BG_IMG fgsoa43334" data-bg-effect-name="" data-has-ssr-src="true" data-animate-blur="" data-is-responsive="true"><img src="https://static.wixstatic.com/media/c10f5f_36711f717bfa4fab88cd74536cfdbefc~mv2.png/v1/fill/w_49,h_20,al_c,q_85,usm_0.66_1.00_0.01,blur_2,enc_avif,quality_auto/c10f5f_36711f717bfa4fab88cd74536cfdbefc~mv2.png" alt="" style="width:100%;height:100%;object-fit:cover;object-position:50% 50%;max-width:100%;position:absolute;left:0;top:0" data-pin-url="https://www.alteredsecurity.com/post/when-the-hunter-becomes-the-hunted-using-custom-callbacks-to-disable-edrs" data-pin-media="https://static.wixstatic.com/media/c10f5f_36711f717bfa4fab88cd74536cfdbefc~mv2.png/v1/fill/w_1794,h_715,al_c,q_90/c10f5f_36711f717bfa4fab88cd74536cfdbefc~mv2.png" draggable="false"></wow-image></div><button class="KxJvA" type="button" data-hook="image-expand-button" aria-label="Expand image"><svg viewBox="0 0 19 19" xmlns="http://www.w3.org/2000/svg" class="C02F9"><path d="M15.071 8.371V4.585l-4.355 4.356a.2.2 0 0 1-.283 0l-.374-.374a.2.2 0 0 1 0-.283l4.356-4.355h-3.786a.2.2 0 0 1-.2-.2V3.2c0-.11.09-.2.2-.2H16v5.371a.2.2 0 0 1-.2.2h-.529a.2.2 0 0 1-.2-.2zm-6.5 6.9v.529a.2.2 0 0 1-.2.2H3v-5.371c0-.11.09-.2.2-.2h.529c.11 0 .2.09.2.2v3.786l4.355-4.356a.2.2 0 0 1 .283 0l.374.374a.2.2 0 0 1 0 .283L4.585 15.07h3.786c.11 0 .2.09.2.2z" fill="#000" fill-rule="nonzero"></path></svg></button></div><div class="i5TUk" id="viewer-fgsoa43334-caption"><div class="_1pWd-"><figcaption class="q-Ags" style="padding-top:16px;padding-bottom:16px"><span>Before Loading prevent.sys</span></figcaption></div></div></figure></div></div></div><div type="image" data-hook="rcv-block53"></div><div data-breakout="normal"><div class="Rc39c HhrTy Z7lok X7MWW" dir="auto" id="viewer-zueci43336"><span class="vMus0"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block54"></div><div data-breakout="normal"><h3 class="CwsM- nAEMg Z7lok X7MWW" dir="auto" id="viewer-c9z8344046"><span class="-pTyw"><span>After Loading </span><span style="color:#ed3237;text-decoration:inherit"><span>prevent.sys</span></span></span></h3></div><div type="heading" data-hook="rcv-block55"></div><div data-breakout="normal"><div class="Rc39c HhrTy Z7lok X7MWW" dir="auto" id="viewer-qtqy244150"><span class="vMus0"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block56"></div><div data-breakout="normal"><p class="Rc39c HhrTy -N-bn X7MWW" dir="auto" id="viewer-ndfnb44151"><span class="vMus0 -N-bn"><span style="color:#16163f;text-decoration:inherit"><span>The situation changes dramatically after the rootkit </span></span><span style="color:#ed3237;text-decoration:inherit"><span>prevent.sys</span></span><span style="color:#16163f;text-decoration:inherit"><span> is loaded at boot time. As shown in the second image, </span></span><span style="color:#ed3237;text-decoration:inherit"><span>prevent.sys</span></span><span style="color:#16163f;text-decoration:inherit"><span> registers its </span></span><span style="color:#ed3237;text-decoration:inherit"><span>blockEDR</span></span><span style="color:#16163f;text-decoration:inherit"><span> callback into the </span></span><span style="color:#ed3237;text-decoration:inherit"><span>PspCreateProcessNotifyRoutine</span></span><span style="color:#16163f;text-decoration:inherit"><span> array. This new entry allows the rootkit to intercept process creation events and apply its logic to prevent specific EDR processes from starting. The impact of this is evident in the Process Hacker output; a search for the keyword "defender" now reveals that critical EDR processes like </span></span><span style="color:#ed3237;text-decoration:inherit"><span>MsSense.exe </span></span><span style="color:#16163f;text-decoration:inherit"><span>and other related services and other processes are no longer running. By blocking the creation of these processes, the `</span></span><span style="color:#ed3237;text-decoration:inherit"><span>blockEDR</span></span><span style="color:#16163f;text-decoration:inherit"><span>` function effectively disables key components of the system's security infrastructure. This demonstration underscores the potential danger of rootkits and the necessity for stringent protection of kernel-level structures to ensure that security mechanisms remain effective against sophisticated threats.</span></span></span></p></div><div type="paragraph" data-hook="rcv-block57"></div><div data-breakout="normal"><div class="Rc39c HhrTy -N-bn X7MWW" dir="auto" id="viewer-30sr747387"><span class="vMus0 -N-bn"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block58"></div><div data-breakout="normal"><div class="Rc39c HhrTy Z7lok X7MWW" dir="auto" id="viewer-8uxgb47588"><span class="vMus0"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block59"></div><div data-breakout="normal"><div class="i5TUk" id="viewer-qmoh847587"><div class="J9Vi9 mL-Fz"><figure class="OPDJf" data-hook="figure-IMAGE"><div data-hook="image-viewer" class="fnfJM"><div style="--dim-height:700;--dim-width:1880;--ricos-image-default-border-color:unset" id="qmoh847587" class="_49X-U wNivC _8xVnn" data-hook="image-viewer-qmoh847587"><wow-image id="c10f5f_79763b35d8df4875b55a696b42bcc079~mv2.png" class="undefined tKegW" data-image-info="{&quot;containerId&quot;:&quot;qmoh847587&quot;,&quot;alignType&quot;:&quot;center&quot;,&quot;displayMode&quot;:&quot;fill&quot;,&quot;isLQIP&quot;:true,&quot;isSEOBot&quot;:false,&quot;lqipTransition&quot;:&quot;blur&quot;,&quot;encoding&quot;:&quot;AVIF&quot;,&quot;imageData&quot;:{&quot;width&quot;:1880,&quot;height&quot;:700,&quot;uri&quot;:&quot;c10f5f_79763b35d8df4875b55a696b42bcc079~mv2.png&quot;,&quot;name&quot;:&quot;&quot;,&quot;displayMode&quot;:&quot;fill&quot;}}" data-motion-part="BG_IMG qmoh847587" data-bg-effect-name="" data-has-ssr-src="true" data-animate-blur="" data-is-responsive="true"><img src="https://static.wixstatic.com/media/c10f5f_79763b35d8df4875b55a696b42bcc079~mv2.png/v1/fill/w_49,h_18,al_c,q_85,usm_0.66_1.00_0.01,blur_2,enc_avif,quality_auto/c10f5f_79763b35d8df4875b55a696b42bcc079~mv2.png" alt="" style="width:100%;height:100%;object-fit:cover;object-position:50% 50%;max-width:100%;position:absolute;left:0;top:0" data-pin-url="https://www.alteredsecurity.com/post/when-the-hunter-becomes-the-hunted-using-custom-callbacks-to-disable-edrs" data-pin-media="https://static.wixstatic.com/media/c10f5f_79763b35d8df4875b55a696b42bcc079~mv2.png/v1/fill/w_1880,h_700,al_c,q_90/c10f5f_79763b35d8df4875b55a696b42bcc079~mv2.png" draggable="false"></wow-image></div><button class="KxJvA" type="button" data-hook="image-expand-button" aria-label="Expand image"><svg viewBox="0 0 19 19" xmlns="http://www.w3.org/2000/svg" class="C02F9"><path d="M15.071 8.371V4.585l-4.355 4.356a.2.2 0 0 1-.283 0l-.374-.374a.2.2 0 0 1 0-.283l4.356-4.355h-3.786a.2.2 0 0 1-.2-.2V3.2c0-.11.09-.2.2-.2H16v5.371a.2.2 0 0 1-.2.2h-.529a.2.2 0 0 1-.2-.2zm-6.5 6.9v.529a.2.2 0 0 1-.2.2H3v-5.371c0-.11.09-.2.2-.2h.529c.11 0 .2.09.2.2v3.786l4.355-4.356a.2.2 0 0 1 .283 0l.374.374a.2.2 0 0 1 0 .283L4.585 15.07h3.786c.11 0 .2.09.2.2z" fill="#000" fill-rule="nonzero"></path></svg></button></div><div class="i5TUk" id="viewer-qmoh847587-caption"><div class="_1pWd-"><figcaption class="q-Ags" style="padding-top:16px;padding-bottom:16px"><span>After Loading prevent.sys</span></figcaption></div></div></figure></div></div></div><div type="image" data-hook="rcv-block60"></div><div data-breakout="normal"><div class="Rc39c HhrTy Z7lok X7MWW" dir="auto" id="viewer-tkdsp47589"><span class="vMus0"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block61"></div><div data-breakout="normal"><p class="Rc39c HhrTy -N-bn X7MWW" dir="auto" id="viewer-ro03w48289"><span class="vMus0 -N-bn"><span>The demonstration of using the </span><span style="color:#ed3237;text-decoration:inherit"><span>PsSetCreateProcessNotifyRoutine</span></span><span> function to register a callback routine that prevents Endpoint Detection and Response (EDR) processes from starting at boot time reveals a significant threat in the Windows security architecture. By leveraging a signed rootkit like </span><span style="color:#ed3237;text-decoration:inherit"><span>prevent.sys</span></span><span>, attackers can register a custom callback routine (</span><span style="color:#ed3237;text-decoration:inherit"><span>blockEDR</span></span><span>) that intercepts process creation events and blocks the creation of specified EDR processes. This effectively disables the system's real-time detection and response capabilities, as critical security processes are prevented from starting. The provided image from Microsoft Defender for Endpoint (MDE) clearly shows that no incidents or alerts are detected, confirming that the rootkit has successfully evaded detection. The absence of active security processes and the lack of alerts in the MDE interface underscore the critical need for securing kernel-level structures and ensuring the integrity of security mechanisms to prevent such sophisticated attacks. This scenario illustrates the urgent necessity for robust security practices, including stringent code-signing policies, secure boot mechanisms, and vigilant monitoring to safeguard against advanced threats that aim to undermine system defenses.</span></span></p></div><div type="paragraph" data-hook="rcv-block62"></div><div data-breakout="normal"><div class="Rc39c HhrTy -N-bn X7MWW" dir="auto" id="viewer-sm9kd52632"><span class="vMus0 -N-bn"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block63"></div><div data-breakout="normal"><div class="Rc39c HhrTy Z7lok X7MWW" dir="auto" id="viewer-gqp7b52830"><span class="vMus0"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block64"></div><div data-breakout="normal"><div class="i5TUk" id="viewer-lfvxn52829"><div class="J9Vi9 mL-Fz"><figure class="OPDJf" data-hook="figure-IMAGE"><div data-hook="image-viewer" class="fnfJM"><div style="--dim-height:889;--dim-width:1919;--ricos-image-default-border-color:unset" id="lfvxn52829" class="_49X-U wNivC _8xVnn" data-hook="image-viewer-lfvxn52829"><wow-image id="c10f5f_e6073d4dd4f042c38ded8c96419f7888~mv2.png" class="undefined tKegW" data-image-info="{&quot;containerId&quot;:&quot;lfvxn52829&quot;,&quot;alignType&quot;:&quot;center&quot;,&quot;displayMode&quot;:&quot;fill&quot;,&quot;isLQIP&quot;:true,&quot;isSEOBot&quot;:false,&quot;lqipTransition&quot;:&quot;blur&quot;,&quot;encoding&quot;:&quot;AVIF&quot;,&quot;imageData&quot;:{&quot;width&quot;:1919,&quot;height&quot;:889,&quot;uri&quot;:&quot;c10f5f_e6073d4dd4f042c38ded8c96419f7888~mv2.png&quot;,&quot;name&quot;:&quot;&quot;,&quot;displayMode&quot;:&quot;fill&quot;}}" data-motion-part="BG_IMG lfvxn52829" data-bg-effect-name="" data-has-ssr-src="true" data-animate-blur="" data-is-responsive="true"><img src="https://static.wixstatic.com/media/c10f5f_e6073d4dd4f042c38ded8c96419f7888~mv2.png/v1/fill/w_49,h_23,al_c,q_85,usm_0.66_1.00_0.01,blur_2,enc_avif,quality_auto/c10f5f_e6073d4dd4f042c38ded8c96419f7888~mv2.png" alt="" style="width:100%;height:100%;object-fit:cover;object-position:50% 50%;max-width:100%;position:absolute;left:0;top:0" data-pin-url="https://www.alteredsecurity.com/post/when-the-hunter-becomes-the-hunted-using-custom-callbacks-to-disable-edrs" data-pin-media="https://static.wixstatic.com/media/c10f5f_e6073d4dd4f042c38ded8c96419f7888~mv2.png/v1/fill/w_1919,h_889,al_c,q_90/c10f5f_e6073d4dd4f042c38ded8c96419f7888~mv2.png" draggable="false"></wow-image></div><button class="KxJvA" type="button" data-hook="image-expand-button" aria-label="Expand image"><svg viewBox="0 0 19 19" xmlns="http://www.w3.org/2000/svg" class="C02F9"><path d="M15.071 8.371V4.585l-4.355 4.356a.2.2 0 0 1-.283 0l-.374-.374a.2.2 0 0 1 0-.283l4.356-4.355h-3.786a.2.2 0 0 1-.2-.2V3.2c0-.11.09-.2.2-.2H16v5.371a.2.2 0 0 1-.2.2h-.529a.2.2 0 0 1-.2-.2zm-6.5 6.9v.529a.2.2 0 0 1-.2.2H3v-5.371c0-.11.09-.2.2-.2h.529c.11 0 .2.09.2.2v3.786l4.355-4.356a.2.2 0 0 1 .283 0l.374.374a.2.2 0 0 1 0 .283L4.585 15.07h3.786c.11 0 .2.09.2.2z" fill="#000" fill-rule="nonzero"></path></svg></button></div><div class="i5TUk" id="viewer-lfvxn52829-caption"><div class="_1pWd-"><figcaption class="q-Ags" style="padding-top:16px;padding-bottom:16px"><span>No detection from MDE side</span></figcaption></div></div></figure></div></div></div><div type="image" data-hook="rcv-block65"></div><div data-breakout="normal"><div class="Rc39c HhrTy Z7lok X7MWW" dir="auto" id="viewer-bc3hv52831"><span class="vMus0"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block66"></div><div data-breakout="normal"><h2 class="JP1W3 nAEMg -N-bn X7MWW" dir="auto" id="viewer-momea50928"><span class="-pTyw -N-bn"><span>Demo</span></span></h2></div><div type="heading" data-hook="rcv-block67"></div><div data-breakout="normal"><div class="Rc39c HhrTy Z7lok X7MWW" dir="auto" id="viewer-m13w61013"><span class="vMus0"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block68"></div><div data-breakout="normal"><div class="i5TUk" id="viewer-8uve01012"><div class="J9Vi9 mL-Fz"><figure class="OPDJf" data-hook="figure-VIDEO"><div class="g-m-E" data-hook="video-player"><div><div style="width:100%;height:100%" data-loaded="true" class="mSJq1"><button type="button" style="width:100%;height:100%;background-image:url(https://i.ytimg.com/vi/AJewGkyo4To/sddefault.jpg);background-size:cover;background-position:center;cursor:pointer;border:none;padding:0;display:flex;align-items:center;justify-content:center" class="react-player__preview" tabindex="0" aria-label="Play video"><div style="background:radial-gradient(rgb(0, 0, 0, 0.3), rgba(0, 0, 0, 0) 60%);border-radius:64px;width:64px;height:64px;display:flex;align-items:center;justify-content:center" class="react-player__shadow"><div style="border-style:solid;border-width:16px 0 16px 26px;border-color:transparent transparent transparent white;margin-left:7px" class="react-player__play-icon"></div></div></button></div></div></div></figure></div></div></div><div type="video" data-hook="rcv-block69"></div><div data-breakout="normal"><div class="Rc39c HhrTy Z7lok X7MWW" dir="auto" id="viewer-pzqu01014"><span class="vMus0"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block70"></div><div data-breakout="normal"><div class="Rc39c HhrTy -N-bn X7MWW" dir="auto" id="viewer-cze5l65784"><span class="vMus0 -N-bn"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block71"></div><div data-breakout="normal"><h2 class="JP1W3 nAEMg -N-bn X7MWW" dir="auto" id="viewer-q4c8665910"><span class="-pTyw -N-bn"><span>Credits</span></span></h2></div><div type="heading" data-hook="rcv-block72"></div><div data-breakout="normal"><p class="Rc39c HhrTy Z7lok X7MWW" dir="auto" id="viewer-80izb66035"><span class="vMus0"><span>Thanks for reading this post.</span></span></p></div><div type="paragraph" data-hook="rcv-block73"></div><div data-breakout="normal"><p class="Rc39c HhrTy Z7lok X7MWW" dir="auto" id="viewer-6oue566037"><span class="vMus0"><span>Posted By:</span></span></p></div><div type="paragraph" data-hook="rcv-block74"></div><div data-breakout="normal"><p class="Rc39c HhrTy Z7lok X7MWW" dir="auto" id="viewer-jcy3866039"><span class="vMus0"><span>Saad AHLA (</span><a target="_blank" href="https://www.linkedin.com/in/saad-ahla" rel="noopener noreferrer" class="eqTR9 JfUOL" data-hook="web-link"><u style="text-decoration:underline"><span>@d1rkmtr</span></u></a><span>)</span></span></p></div><div type="paragraph" data-hook="rcv-block75"></div><div data-breakout="normal"><p class="Rc39c HhrTy Z7lok X7MWW" dir="auto" id="viewer-4umcb66041"><span class="vMus0"><span>Security Researcher at Altered Security</span></span></p></div><div type="paragraph" data-hook="rcv-block76"></div><div data-breakout="normal"><div class="Rc39c HhrTy -N-bn X7MWW" dir="auto" id="viewer-6y1ov51057"><span class="vMus0 -N-bn"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block77"></div></div><div type="last" data-hook="rcv-block-last"></div></div></div></div></div></div></section></div></article></div></div></div><div class="zp8IQu zp8s_J"><div><section class="oY1ew3" data-hook="recent-posts" style="--blog-pl-common-padding-top:28px;--blog-pl-common-padding-bottom:25px;--blog-pl-slider-padding-top:16px;--blog-pl-slider-padding-bottom:24px;--blog-pl-header-height:34px;--blog-pl-header-margin-bottom:18px;--blog-pl-footer-content-height:18px;--blog-pl-footer-separator-margin:15px;--blog-pl-footer-padding-top:8px;--blog-pl-common-title-margin:11px;--blog-pl-default-title-margin:10px;--blog-pl-slider-title-margin-top:10px;--blog-pl-category-label-margin-bottom:12px;--blog-pl-slider-category-label-margin-bottom:2px"><section><div class="zHLEBV"><article class="qbu2Gh" data-hook="recent-post-list-item"><div class="dkbPQd"><a aria-label="Calling One RESTful API at a time using BARK Tool (Update to Red Labs Platform) " href="https://www.alteredsecurity.com/post/calling-one-restful-api-at-a-time-using-bark-tool-update-to-red-labs-platform" class="blog-link-hover-color" data-hook="link" tabindex="-1"><div class="kkOpHH"><wow-image class="TI1b5D HNM0p2" data-image-info="{&quot;displayMode&quot;:&quot;fill&quot;,&quot;targetWidth&quot;:450,&quot;targetHeight&quot;:253,&quot;isSEOBot&quot;:false,&quot;encoding&quot;:&quot;AVIF&quot;,&quot;imageData&quot;:{&quot;width&quot;:1142,&quot;height&quot;:541,&quot;uri&quot;:&quot;703974_3d6f56ea6ecd44e9834648ca6354f508~mv2.png&quot;,&quot;name&quot;:&quot;&quot;,&quot;displayMode&quot;:&quot;fill&quot;}}" data-motion-part="BG_IMG undefined" data-bg-effect-name="" data-has-ssr-src="" style="--wix-img-max-width:max(1142px, 100%)"><img alt="Calling One RESTful API at a time using BARK Tool (Update to Red Labs Platform) " data-pin-nopin="true"></wow-image></div></a><div class="ZnRZP5"></div></div></article><article class="qbu2Gh" data-hook="recent-post-list-item"><div class="dkbPQd"><div class="ZnRZP5"><section data-hook="recent-post__description"><div class="f1HgZb"><div class="_4BhfeI post-excerpt"><span class="j1Y_aa" style="display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:4;overflow:hidden;text-overflow:ellipsis"><p class="pAfFB0" data-hook="post-description">Updates to our Azure Red Team Platform</p></span></div></div></section></div></div></article><article class="qbu2Gh" data-hook="recent-post-list-item"><div class="dkbPQd"><a aria-label="Long Live Pass-The-Cert: Reviving the Classical Rendition of Lateral Movement across Entra ID joined Devices" href="https://www.alteredsecurity.com/post/long-live-pass-the-cert-reviving-the-classical-rendition-of-lateral-movement-across-entra-id-joined" class="blog-link-hover-color" data-hook="link" tabindex="-1"><div class="kkOpHH"><wow-image class="TI1b5D HNM0p2" data-image-info="{&quot;displayMode&quot;:&quot;fill&quot;,&quot;targetWidth&quot;:450,&quot;targetHeight&quot;:253,&quot;isSEOBot&quot;:false,&quot;encoding&quot;:&quot;AVIF&quot;,&quot;imageData&quot;:{&quot;width&quot;:974,&quot;height&quot;:488,&quot;uri&quot;:&quot;703974_2a56426fa5a8467ebefbe5fcfe5b8ff2~mv2.png&quot;,&quot;name&quot;:&quot;&quot;,&quot;displayMode&quot;:&quot;fill&quot;}}" data-motion-part="BG_IMG undefined" data-bg-effect-name="" data-has-ssr-src="" style="--wix-img-max-width:max(974px, 100%)"><img alt="Long Live Pass-The-Cert: Reviving the Classical Rendition of Lateral Movement across Entra ID joined Devices" data-pin-nopin="true"></wow-image></div></a><div class="ZnRZP5"></div></div></article></div></section></section></div></div></div></div></div><div data-hook="tooltip-portal"></div></div></div></div></div></div></div></div></div></section></div></div></div></div></div></div></main><div id="pinnedBottomRight" class="pinnedBottomRight"><div id="comp-m5chrl8s-pinned-layer" class="comp-m5chrl8s-pinned-layer big2ZD"><div id="comp-m5chrl8s" class="comp-m5chrl8s" data-semantic-classname="button"><a data-testid="linkElement" href="https://www.alteredsecurity.com/allitems" target="_self" class="StylableButton2545352419__root style-m9ttk3zi__root wixui-button StylableButton2545352419__link" aria-label="cart"><span class="StylableButton2545352419__container"><span class="StylableButton2545352419__label wixui-button__label" data-testid="stylablebutton-label">cart</span><span class="StylableButton2545352419__icon wixui-button__icon" aria-hidden="true" data-testid="stylablebutton-icon"><span><!--?xml version="1.0" encoding="UTF-8"?-->
<svg data-bbox="35.2 62.96 164.26 110.66" viewBox="0 0 250 250" xmlns="http://www.w3.org/2000/svg" data-type="color">
    <g>
        <path fill="#ffffff" d="M35.2 62.96h35.27l33.89 66.4h52.22l24.2-45.99h18.68l-32.16 61.21H93.98L60.44 75.76H35.2V64.35" data-color="1"></path>
        <path fill="#ffffff" d="M111.62 163.25c0 5.727-4.643 10.37-10.37 10.37s-10.37-4.643-10.37-10.37 4.643-10.37 10.37-10.37 10.37 4.643 10.37 10.37" data-color="1"></path>
        <path fill="#ffffff" d="M167.41 163.25c0 5.727-4.643 10.37-10.37 10.37s-10.37-4.643-10.37-10.37 4.643-10.37 10.37-10.37 10.37 4.643 10.37 10.37" data-color="1"></path>
    </g>
</svg>
</span></span></span></a></div></div><div id="comp-m9tshre6-pinned-layer" class="comp-m9tshre6-pinned-layer big2ZD"><div id="comp-m9tshre6" class="comp-m9tshre6" data-semantic-classname="button"><a data-testid="linkElement" href="https://www.alteredsecurity.com/allitems" target="_self" class="StylableButton2545352419__root style-mck4aj2o__root wixui-button StylableButton2545352419__link" aria-label="0"><span class="StylableButton2545352419__container"><span class="StylableButton2545352419__label wixui-button__label" data-testid="stylablebutton-label">0</span><span class="StylableButton2545352419__icon wixui-button__icon" aria-hidden="true" data-testid="stylablebutton-icon"><span><!--?xml version="1.0" encoding="UTF-8"?-->
<svg data-bbox="35.2 62.96 164.26 110.66" viewBox="0 0 250 250" xmlns="http://www.w3.org/2000/svg" data-type="color">
    <g>
        <path fill="#ffffff" d="M35.2 62.96h35.27l33.89 66.4h52.22l24.2-45.99h18.68l-32.16 61.21H93.98L60.44 75.76H35.2V64.35" data-color="1"></path>
        <path fill="#ffffff" d="M111.62 163.25c0 5.727-4.643 10.37-10.37 10.37s-10.37-4.643-10.37-10.37 4.643-10.37 10.37-10.37 10.37 4.643 10.37 10.37" data-color="1"></path>
        <path fill="#ffffff" d="M167.41 163.25c0 5.727-4.643 10.37-10.37 10.37s-10.37-4.643-10.37-10.37 4.643-10.37 10.37-10.37 10.37 4.643 10.37 10.37" data-color="1"></path>
    </g>
</svg>
</span></span></span></a></div></div></div></div></div><div id="SCROLL_TO_BOTTOM" class="Vd6aQZ ignore-focus SCROLL_TO_BOTTOM" role="region" tabindex="-1" aria-label="bottom of page"><span class="mHZSwn">bottom of page</span></div></div></div>


    
    

    
        
    

    <!-- Polyfills check -->
    


<!-- initCustomElements # 1-->






<!-- preloading pre-scripts -->

    
    <link href="https://siteassets.parastorage.com/pages/pages/thunderbolt?appDefinitionIdToSiteRevision=%7B%2213d21c63-b5ec-5912-8397-c3a5ddb27a97%22%3A%22440%22%2C%2214bcded7-0066-7c35-14d7-466cb3f09103%22%3A%221335%22%2C%22d3910eb4-cbff-47e0-a415-687c6cf59405%22%3A%228%22%2C%2214271d6f-ba62-d045-549b-ab972ae1f70e%22%3A%2225%22%2C%221522827f-c56c-a5c9-2ac9-00f9e6ae12d3%22%3A%221903%22%2C%22b976560c-3122-4351-878f-453f337b7245%22%3A%221291%22%7D&amp;beckyExperiments=.DatePickerPortal%2C.DisableDocumentScrollWhenLightBoxOpen%2C.EnableCustomCSSVarsForLoginSocialBar%2C.FreemiumBannerOdeditor%2C.LoginBarEnableLoggingInStateInSSR%2C.TextInputAutoFillFix%2C.UseLoginSocialBarCustomMenu%2C.UseNewLoginSocialBarCustomMenuPositioning%2C.UseNewLoginSocialBarElementStructure%2C.UseNewLoginSocialBarMemberInitialsAvatar%2C.VerticalMenu_uiType_NativeMapper%2C.WixFreeSiteBannerDesktop%2C.WixFreeSiteBannerMobile%2C.addIdAsClassName%2C.buttonUdp%2C.calculateCollapsibleTextLineHeightByFont%2C.disableBuilderWixComponents%2C.dom_store%2C.dynamicSlots%2C.fiveGridLineStudioSkins%2C.imageEncodingAVIF%2C.isClassNameToRootEnabled%2C.motionTimeAnimationsCSS%2C.propsCarmiMappersMigration1%2C.propsCarmiMappersMigration4%2C.propsCarmiMappersMigration5%2C.removeDynamicModelTopologyFromSiteAssets%2C.shouldUseResponsiveImages%2C.svgResolver_2%2C.takeAppDependenciesFromCSM%2C.updateRichTextSemanticClassNamesOnCorvid%2C.useClassnameInResponsiveAppWidget%2C.useImageAvifFormatInNativeProGallery%2C.useResponsiveImgClassicFixed%2C.useSvgLoaderFeature%2C.useSvgLoaderFeatureOnBuilderComps&amp;blocksBuilderManifestGeneratorVersion=1.129.0&amp;contentType=application%2Fjson&amp;deviceType=Desktop&amp;dfCk=6&amp;dfVersion=1.5272.0&amp;disableStaticPagesUrlHierarchy=false&amp;editorName=Unknown&amp;experiments=dm_bgScrubToMotionFixer%2Cdm_masterPageVariablesQueryFixer%2Cdm_migrateOldHoverBoxToNewFixer&amp;externalBaseUrl=https%3A%2F%2Fwww.alteredsecurity.com&amp;fileId=e3c4206a.bundle.min&amp;formFactor=desktop&amp;hasTPAWorkerOnSite=false&amp;hasUserDomainMedia=false&amp;isBuilderComponentModel=false&amp;isHttps=true&amp;isInSeo=false&amp;isMultilingualEnabled=false&amp;isPremiumDomain=true&amp;isTrackClicksAnalyticsEnabled=false&amp;isUrlMigrated=true&amp;isWixCodeOnPage=true&amp;isWixCodeOnSite=true&amp;language=en&amp;languageResolutionMethod=QueryParam&amp;metaSiteId=17d55ce8-425c-4842-8aad-a18ee5d889fb&amp;module=thunderbolt-features&amp;oneDocEnabled=true&amp;originalLanguage=en&amp;pageId=9596c6_f508e6ab2cf1a20f159da246374b07fc_7228.json&amp;pilerExperiments=specs.piler.useEditorReactComponents&amp;quickActionsMenuEnabled=false&amp;registryLibrariesTopology=%5B%7B%22artifactId%22%3A%22editor-elements%22%2C%22namespace%22%3A%22wixui%22%2C%22url%22%3A%22https%3A%2F%2Fstatic.parastorage.com%2Fservices%2Feditor-elements%2F1.14894.0%22%7D%2C%7B%22artifactId%22%3A%22editor-elements%22%2C%22namespace%22%3A%22dsgnsys%22%2C%22url%22%3A%22https%3A%2F%2Fstatic.parastorage.com%2Fservices%2Feditor-elements%2F1.14894.0%22%7D%5D&amp;remoteWidgetStructureBuilderVersion=1.251.0&amp;siteId=327b0294-2ee3-49fa-8e7a-491f22c6d1c0&amp;siteRevision=7229&amp;staticHTMLComponentUrl=https%3A%2F%2Fwww-alteredsecurity-com.filesusr.com%2F&amp;useSandboxInHTMLComp=false&amp;viewMode=desktop" id="features_masterPage" as="fetch" position="post-scripts" rel="preload" crossorigin="anonymous">

    
    <link href="https://siteassets.parastorage.com/pages/pages/thunderbolt?appDefinitionIdToSiteRevision=%7B%2213d21c63-b5ec-5912-8397-c3a5ddb27a97%22%3A%22440%22%2C%2214bcded7-0066-7c35-14d7-466cb3f09103%22%3A%221335%22%2C%22d3910eb4-cbff-47e0-a415-687c6cf59405%22%3A%228%22%2C%2214271d6f-ba62-d045-549b-ab972ae1f70e%22%3A%2225%22%2C%221522827f-c56c-a5c9-2ac9-00f9e6ae12d3%22%3A%221903%22%2C%22b976560c-3122-4351-878f-453f337b7245%22%3A%221291%22%7D&amp;beckyExperiments=.DatePickerPortal%2C.DisableDocumentScrollWhenLightBoxOpen%2C.EnableCustomCSSVarsForLoginSocialBar%2C.FreemiumBannerOdeditor%2C.LoginBarEnableLoggingInStateInSSR%2C.TextInputAutoFillFix%2C.UseLoginSocialBarCustomMenu%2C.UseNewLoginSocialBarCustomMenuPositioning%2C.UseNewLoginSocialBarElementStructure%2C.UseNewLoginSocialBarMemberInitialsAvatar%2C.VerticalMenu_uiType_NativeMapper%2C.WixFreeSiteBannerDesktop%2C.WixFreeSiteBannerMobile%2C.addIdAsClassName%2C.buttonUdp%2C.calculateCollapsibleTextLineHeightByFont%2C.disableBuilderWixComponents%2C.dom_store%2C.dynamicSlots%2C.fiveGridLineStudioSkins%2C.imageEncodingAVIF%2C.isClassNameToRootEnabled%2C.motionTimeAnimationsCSS%2C.propsCarmiMappersMigration1%2C.propsCarmiMappersMigration4%2C.propsCarmiMappersMigration5%2C.removeDynamicModelTopologyFromSiteAssets%2C.shouldUseResponsiveImages%2C.svgResolver_2%2C.takeAppDependenciesFromCSM%2C.updateRichTextSemanticClassNamesOnCorvid%2C.useClassnameInResponsiveAppWidget%2C.useImageAvifFormatInNativeProGallery%2C.useResponsiveImgClassicFixed%2C.useSvgLoaderFeature%2C.useSvgLoaderFeatureOnBuilderComps&amp;blocksBuilderManifestGeneratorVersion=1.129.0&amp;contentType=application%2Fjson&amp;deviceType=Desktop&amp;dfCk=6&amp;dfVersion=1.5272.0&amp;disableStaticPagesUrlHierarchy=false&amp;editorName=Unknown&amp;experiments=dm_bgScrubToMotionFixer%2Cdm_masterPageVariablesQueryFixer%2Cdm_migrateOldHoverBoxToNewFixer&amp;externalBaseUrl=https%3A%2F%2Fwww.alteredsecurity.com&amp;fileId=e3c4206a.bundle.min&amp;formFactor=desktop&amp;hasTPAWorkerOnSite=false&amp;hasUserDomainMedia=false&amp;isBuilderComponentModel=false&amp;isHttps=true&amp;isInSeo=false&amp;isMultilingualEnabled=false&amp;isPremiumDomain=true&amp;isTrackClicksAnalyticsEnabled=false&amp;isUrlMigrated=true&amp;isWixCodeOnPage=true&amp;isWixCodeOnSite=true&amp;language=en&amp;languageResolutionMethod=QueryParam&amp;metaSiteId=17d55ce8-425c-4842-8aad-a18ee5d889fb&amp;module=thunderbolt-features&amp;oneDocEnabled=true&amp;originalLanguage=en&amp;pageId=9596c6_41cf2936b35e56796da4c72c2e515df3_7211.json&amp;pilerExperiments=specs.piler.useEditorReactComponents&amp;quickActionsMenuEnabled=false&amp;registryLibrariesTopology=%5B%7B%22artifactId%22%3A%22editor-elements%22%2C%22namespace%22%3A%22wixui%22%2C%22url%22%3A%22https%3A%2F%2Fstatic.parastorage.com%2Fservices%2Feditor-elements%2F1.14894.0%22%7D%2C%7B%22artifactId%22%3A%22editor-elements%22%2C%22namespace%22%3A%22dsgnsys%22%2C%22url%22%3A%22https%3A%2F%2Fstatic.parastorage.com%2Fservices%2Feditor-elements%2F1.14894.0%22%7D%5D&amp;remoteWidgetStructureBuilderVersion=1.251.0&amp;siteId=327b0294-2ee3-49fa-8e7a-491f22c6d1c0&amp;siteRevision=7229&amp;staticHTMLComponentUrl=https%3A%2F%2Fwww-alteredsecurity-com.filesusr.com%2F&amp;useSandboxInHTMLComp=false&amp;viewMode=desktop" id="features_tvmm2" as="fetch" position="post-scripts" rel="preload" crossorigin="anonymous">

    
    <link href="https://siteassets.parastorage.com/pages/pages/thunderbolt?appDefinitionIdToSiteRevision=%7B%2213d21c63-b5ec-5912-8397-c3a5ddb27a97%22%3A%22440%22%2C%2214bcded7-0066-7c35-14d7-466cb3f09103%22%3A%221335%22%2C%22d3910eb4-cbff-47e0-a415-687c6cf59405%22%3A%228%22%2C%2214271d6f-ba62-d045-549b-ab972ae1f70e%22%3A%2225%22%2C%221522827f-c56c-a5c9-2ac9-00f9e6ae12d3%22%3A%221903%22%2C%22b976560c-3122-4351-878f-453f337b7245%22%3A%221291%22%7D&amp;beckyExperiments=.DatePickerPortal%2C.EnableCustomCSSVarsForLoginSocialBar%2C.FreemiumBannerOdeditor%2C.LoginBarEnableLoggingInStateInSSR%2C.TextInputAutoFillFix%2C.UseLoginSocialBarCustomMenu%2C.UseNewLoginSocialBarCustomMenuPositioning%2C.UseNewLoginSocialBarElementStructure%2C.UseNewLoginSocialBarMemberInitialsAvatar%2C.WixFreeSiteBannerDesktop%2C.WixFreeSiteBannerMobile%2C.addIdAsClassName%2C.buttonUdp%2C.calculateCollapsibleTextLineHeightByFont%2C.disableBuilderWixComponents%2C.dynamicSlots%2C.fiveGridLineStudioSkins%2C.isClassNameToRootEnabled%2C.propsCarmiMappersMigration1%2C.propsCarmiMappersMigration4%2C.propsCarmiMappersMigration5%2C.svgResolver_2%2C.takeAppDependenciesFromCSM%2C.updateRichTextSemanticClassNamesOnCorvid%2C.useClassnameInResponsiveAppWidget%2C.useImageAvifFormatInNativeProGallery&amp;blocksBuilderManifestGeneratorVersion=1.129.0&amp;contentType=application%2Fjson&amp;dfCk=6&amp;dfVersion=1.5272.0&amp;editorName=Unknown&amp;experiments=dm_bgScrubToMotionFixer%2Cdm_masterPageVariablesQueryFixer%2Cdm_migrateOldHoverBoxToNewFixer&amp;externalBaseUrl=https%3A%2F%2Fwww.alteredsecurity.com&amp;fileId=49498e31.bundle.min&amp;formFactor=desktop&amp;hasTPAWorkerOnSite=false&amp;hasUserDomainMedia=false&amp;isBuilderComponentModel=false&amp;isHttps=true&amp;isInSeo=false&amp;isPremiumDomain=true&amp;isUrlMigrated=true&amp;isWixCodeOnPage=true&amp;isWixCodeOnSite=true&amp;language=en&amp;metaSiteId=17d55ce8-425c-4842-8aad-a18ee5d889fb&amp;module=thunderbolt-platform&amp;oneDocEnabled=true&amp;originalLanguage=en&amp;pageId=9596c6_f508e6ab2cf1a20f159da246374b07fc_7228.json&amp;pilerExperiments=specs.piler.useEditorReactComponents&amp;quickActionsMenuEnabled=false&amp;registryLibrariesTopology=%5B%7B%22artifactId%22%3A%22editor-elements%22%2C%22namespace%22%3A%22wixui%22%2C%22url%22%3A%22https%3A%2F%2Fstatic.parastorage.com%2Fservices%2Feditor-elements%2F1.14894.0%22%7D%2C%7B%22artifactId%22%3A%22editor-elements%22%2C%22namespace%22%3A%22dsgnsys%22%2C%22url%22%3A%22https%3A%2F%2Fstatic.parastorage.com%2Fservices%2Feditor-elements%2F1.14894.0%22%7D%5D&amp;remoteWidgetStructureBuilderVersion=1.251.0&amp;siteId=327b0294-2ee3-49fa-8e7a-491f22c6d1c0&amp;siteRevision=7229&amp;staticHTMLComponentUrl=https%3A%2F%2Fwww-alteredsecurity-com.filesusr.com%2F&amp;viewMode=desktop" id="platform_masterPage" as="fetch" position="post-scripts" rel="preload" crossorigin="anonymous">

    
    <link href="https://siteassets.parastorage.com/pages/pages/thunderbolt?appDefinitionIdToSiteRevision=%7B%2213d21c63-b5ec-5912-8397-c3a5ddb27a97%22%3A%22440%22%2C%2214bcded7-0066-7c35-14d7-466cb3f09103%22%3A%221335%22%2C%22d3910eb4-cbff-47e0-a415-687c6cf59405%22%3A%228%22%2C%2214271d6f-ba62-d045-549b-ab972ae1f70e%22%3A%2225%22%2C%221522827f-c56c-a5c9-2ac9-00f9e6ae12d3%22%3A%221903%22%2C%22b976560c-3122-4351-878f-453f337b7245%22%3A%221291%22%7D&amp;beckyExperiments=.DatePickerPortal%2C.EnableCustomCSSVarsForLoginSocialBar%2C.FreemiumBannerOdeditor%2C.LoginBarEnableLoggingInStateInSSR%2C.TextInputAutoFillFix%2C.UseLoginSocialBarCustomMenu%2C.UseNewLoginSocialBarCustomMenuPositioning%2C.UseNewLoginSocialBarElementStructure%2C.UseNewLoginSocialBarMemberInitialsAvatar%2C.WixFreeSiteBannerDesktop%2C.WixFreeSiteBannerMobile%2C.addIdAsClassName%2C.buttonUdp%2C.calculateCollapsibleTextLineHeightByFont%2C.disableBuilderWixComponents%2C.dynamicSlots%2C.fiveGridLineStudioSkins%2C.isClassNameToRootEnabled%2C.propsCarmiMappersMigration1%2C.propsCarmiMappersMigration4%2C.propsCarmiMappersMigration5%2C.svgResolver_2%2C.takeAppDependenciesFromCSM%2C.updateRichTextSemanticClassNamesOnCorvid%2C.useClassnameInResponsiveAppWidget%2C.useImageAvifFormatInNativeProGallery&amp;blocksBuilderManifestGeneratorVersion=1.129.0&amp;contentType=application%2Fjson&amp;dfCk=6&amp;dfVersion=1.5272.0&amp;editorName=Unknown&amp;experiments=dm_bgScrubToMotionFixer%2Cdm_masterPageVariablesQueryFixer%2Cdm_migrateOldHoverBoxToNewFixer&amp;externalBaseUrl=https%3A%2F%2Fwww.alteredsecurity.com&amp;fileId=49498e31.bundle.min&amp;formFactor=desktop&amp;hasTPAWorkerOnSite=false&amp;hasUserDomainMedia=false&amp;isBuilderComponentModel=false&amp;isHttps=true&amp;isInSeo=false&amp;isPremiumDomain=true&amp;isUrlMigrated=true&amp;isWixCodeOnPage=true&amp;isWixCodeOnSite=true&amp;language=en&amp;metaSiteId=17d55ce8-425c-4842-8aad-a18ee5d889fb&amp;module=thunderbolt-platform&amp;oneDocEnabled=true&amp;originalLanguage=en&amp;pageId=9596c6_41cf2936b35e56796da4c72c2e515df3_7211.json&amp;pilerExperiments=specs.piler.useEditorReactComponents&amp;quickActionsMenuEnabled=false&amp;registryLibrariesTopology=%5B%7B%22artifactId%22%3A%22editor-elements%22%2C%22namespace%22%3A%22wixui%22%2C%22url%22%3A%22https%3A%2F%2Fstatic.parastorage.com%2Fservices%2Feditor-elements%2F1.14894.0%22%7D%2C%7B%22artifactId%22%3A%22editor-elements%22%2C%22namespace%22%3A%22dsgnsys%22%2C%22url%22%3A%22https%3A%2F%2Fstatic.parastorage.com%2Fservices%2Feditor-elements%2F1.14894.0%22%7D%5D&amp;remoteWidgetStructureBuilderVersion=1.251.0&amp;siteId=327b0294-2ee3-49fa-8e7a-491f22c6d1c0&amp;siteRevision=7229&amp;staticHTMLComponentUrl=https%3A%2F%2Fwww-alteredsecurity-com.filesusr.com%2F&amp;viewMode=desktop" id="platform_tvmm2" as="fetch" position="post-scripts" rel="preload" crossorigin="anonymous">





  <!-- sentryOnLoad Setup Script -->
  
  <!-- Sentry Loader Script -->
  
  <!-- Sentry's makeMultiplexedTransport -->
  
  <!-- Sentry's moduleMetadataIntegration -->
  



    <!-- Old Browsers Deprecation - must load before async client scripts to block execution -->
    





<!-- Add the rest of the ViewerModel -->


<!-- renderIndicator -->


<!-- versionIndicator -->


<!-- used platform apis start -->


<!-- used platform apis end -->

<!-- Business Manager -->

<!-- initCustomElements #2 -->

    



<!-- initial scripts -->






<!-- lodash script -->

<!-- react -->

<!-- react-dom -->


<!-- scriptTagsToPreload -->
<link href="https://static.parastorage.com/services/communities-blog-ooi/1.3083.0/PostViewerWidgetNoCss.bundle.min.js" rel="preload" as="fetch" crossorigin="anonymous">

<!-- bi -->

<!-- bi -->



    
        
    

    
    









    <!--pageHtmlEmbeds.bodyEnd start-->
    
    
    
    <!--pageHtmlEmbeds.bodyEnd end-->





<!-- warmup data start -->

<!-- warmup data end -->

<!-- presets polyfill -->




<!-- detect browser zoom -->












</body></html>