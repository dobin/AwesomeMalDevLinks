# https://www.safebreach.com/blog/dark-side-of-edr-offensive-tool/

<!DOCTYPE html><html lang="en-US">

<body class="wp-singular resource-template-default single single-resource postid-145802 wp-custom-logo wp-theme-berg-theme wp-child-theme-berg-theme-child mega-menu-top-menu mega-menu-main-menu resource-dark-side-of-edr-offensive-tool notification-added">
    <!-- Google Tag Manager (noscript) -->

<!-- End Google Tag Manager (noscript) -->    
    <main role="main">

                    
<section class="wp-block-e25m-section bs-section bs-section-cbd34f7bdb05e2978ca52711176908d80ca48ac3 bs-section---default bs-section--blog-inner-banner"><div class="container">
<div class="wp-block-e25m-row bs-row row  bs-row---default">
<div class=" bs-column col-sm-12   bs-column-36f30487f5bda5ec35c1fc7a3cfb047ab332daf1 bs-column---default     ">
<div class="post-publish-date-wrapper">
    <p>Apr 19, 2024</p></div>


<h1 class="wp-block-post-title">The Dark Side of EDR: Repurpose EDR as an Offensive Tool</h1>


<p><em>See how a SafeBreach Labs researcher bypassed the anti-tampering mechanism of a leading EDR to execute malicious code within one of the EDR’s own processes and altered the mechanism to gain unique, persistent, and fully undetectable capabilities.</em></p>
</div>
</div>
</div></section>



<section class="wp-block-e25m-section bs-section bs-section-dc04248318c48948210ac47c0ebc46ca7594dcd3 bs-section---default bs-section--press-inner-main-content bs-section--blog-inner-main-content"><div class="container">
<div class="wp-block-e25m-row bs-row row  bs-row---default">
<div class=" bs-column col-sm-12 col-md-1   bs-column-9edf2ff4f266401a97cafb86a2e1539fb8e5272f bs-column---default     "><div class="heateor_sss_sharing_container heateor_sss_horizontal_sharing" data-heateor-ss-offset="0" data-heateor-sss-href="https://www.safebreach.com/blog/dark-side-of-edr-offensive-tool/"><div class="heateor_sss_sharing_ul"><a aria-label="Email" class="heateor_sss_email" href="https://www.safebreach.com/blog/dark-side-of-edr-offensive-tool/" title="Email" rel="noopener" style="font-size:32px!important;box-shadow:none;display:inline-block;vertical-align:middle"><span class="heateor_sss_svg" style="background-color:#649a3f;width:20px;height:20px;display:inline-block;opacity:1;float:left;font-size:32px;box-shadow:none;display:inline-block;font-size:16px;padding:0 4px;vertical-align:middle;background-repeat:repeat;overflow:hidden;padding:0;cursor:pointer;box-sizing:content-box"><svg style="display:block;" focusable="false" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="-.75 -.5 36 36"><path d="M 5.5 11 h 23 v 1 l -11 6 l -11 -6 v -1 m 0 2 l 11 6 l 11 -6 v 11 h -22 v -11" stroke-width="1" fill="#fff"></path></svg></span></a><a aria-label="Linkedin" class="heateor_sss_button_linkedin" href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fwww.safebreach.com%2Fblog%2Fdark-side-of-edr-offensive-tool%2F" title="Linkedin" rel="nofollow noopener" target="_blank" style="font-size:32px!important;box-shadow:none;display:inline-block;vertical-align:middle"><span class="heateor_sss_svg heateor_sss_s__default heateor_sss_s_linkedin" style="background-color:#0077b5;width:20px;height:20px;display:inline-block;opacity:1;float:left;font-size:32px;box-shadow:none;display:inline-block;font-size:16px;padding:0 4px;vertical-align:middle;background-repeat:repeat;overflow:hidden;padding:0;cursor:pointer;box-sizing:content-box"><svg style="display:block;" focusable="false" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 32 32"><path d="M6.227 12.61h4.19v13.48h-4.19V12.61zm2.095-6.7a2.43 2.43 0 0 1 0 4.86c-1.344 0-2.428-1.09-2.428-2.43s1.084-2.43 2.428-2.43m4.72 6.7h4.02v1.84h.058c.56-1.058 1.927-2.176 3.965-2.176 4.238 0 5.02 2.792 5.02 6.42v7.395h-4.183v-6.56c0-1.564-.03-3.574-2.178-3.574-2.18 0-2.514 1.7-2.514 3.46v6.668h-4.187V12.61z" fill="#fff"></path></svg></span></a><a aria-label="Twitter" class="heateor_sss_button_twitter" href="https://twitter.com/intent/tweet?text=The%20Dark%20Side%20of%20EDR%3A%20Repurpose%20EDR%20as%20an%20Offensive%20Tool&amp;url=https%3A%2F%2Fwww.safebreach.com%2Fblog%2Fdark-side-of-edr-offensive-tool%2F" title="Twitter" rel="nofollow noopener" target="_blank" style="font-size:32px!important;box-shadow:none;display:inline-block;vertical-align:middle"><span class="heateor_sss_svg heateor_sss_s__default heateor_sss_s_twitter" style="background-color:#55acee;width:20px;height:20px;display:inline-block;opacity:1;float:left;font-size:32px;box-shadow:none;display:inline-block;font-size:16px;padding:0 4px;vertical-align:middle;background-repeat:repeat;overflow:hidden;padding:0;cursor:pointer;box-sizing:content-box"><svg style="display:block;" focusable="false" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="-4 -4 39 39"><path d="M28 8.557a9.913 9.913 0 0 1-2.828.775 4.93 4.93 0 0 0 2.166-2.725 9.738 9.738 0 0 1-3.13 1.194 4.92 4.92 0 0 0-3.593-1.55 4.924 4.924 0 0 0-4.794 6.049c-4.09-.21-7.72-2.17-10.15-5.15a4.942 4.942 0 0 0-.665 2.477c0 1.71.87 3.214 2.19 4.1a4.968 4.968 0 0 1-2.23-.616v.06c0 2.39 1.7 4.38 3.952 4.83-.414.115-.85.174-1.297.174-.318 0-.626-.03-.928-.086a4.935 4.935 0 0 0 4.6 3.42 9.893 9.893 0 0 1-6.114 2.107c-.398 0-.79-.023-1.175-.068a13.953 13.953 0 0 0 7.55 2.213c9.056 0 14.01-7.507 14.01-14.013 0-.213-.005-.426-.015-.637.96-.695 1.795-1.56 2.455-2.55z" fill="#fff"></path></svg></span></a><a aria-label="Facebook" class="heateor_sss_facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.safebreach.com%2Fblog%2Fdark-side-of-edr-offensive-tool%2F" title="Facebook" rel="nofollow noopener" target="_blank" style="font-size:32px!important;box-shadow:none;display:inline-block;vertical-align:middle"><span class="heateor_sss_svg" style="background-color:#0765FE;width:20px;height:20px;display:inline-block;opacity:1;float:left;font-size:32px;box-shadow:none;display:inline-block;font-size:16px;padding:0 4px;vertical-align:middle;background-repeat:repeat;overflow:hidden;padding:0;cursor:pointer;box-sizing:content-box"><svg style="display:block;" focusable="false" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 32 32"><path fill="#fff" d="M28 16c0-6.627-5.373-12-12-12S4 9.373 4 16c0 5.628 3.875 10.35 9.101 11.647v-7.98h-2.474V16H13.1v-1.58c0-4.085 1.849-5.978 5.859-5.978.76 0 2.072.15 2.608.298v3.325c-.283-.03-.775-.045-1.386-.045-1.967 0-2.728.745-2.728 2.683V16h3.92l-.673 3.667h-3.247v8.245C23.395 27.195 28 22.135 28 16Z"></path></svg></span></a><a class="heateor_sss_more" aria-label="More" title="More" rel="nofollow noopener" style="font-size: 32px!important;border:0;box-shadow:none;display:inline-block!important;font-size:16px;padding:0 4px;vertical-align: middle;display:inline;" href="https://www.safebreach.com/blog/dark-side-of-edr-offensive-tool/"><span class="heateor_sss_svg" style="background-color:#ee8e2d;width:20px;height:20px;display:inline-block!important;opacity:1;float:left;font-size:32px!important;box-shadow:none;display:inline-block;font-size:16px;padding:0 4px;vertical-align:middle;display:inline;background-repeat:repeat;overflow:hidden;padding:0;cursor:pointer;box-sizing:content-box;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="-.3 0 32 32" version="1.1" width="100%" height="100%" style="display:block;" xml:space="preserve"><g><path fill="#fff" d="M18 14V8h-4v6H8v4h6v6h4v-6h6v-4h-6z" fill-rule="evenodd"></path></g></svg></span></a></div><div class="heateorSssClear"></div></div>
</div>



<div class=" bs-column col-sm-12 col-md-11 col-lg-10   bs-column-60bcc83ab680d15e56db87f8d61a192b7aff565b bs-column---default     ">
<div class="wp-block-e25m-div bs-div bs-div-c6d8e61d86eeeac702fbfd8390db51b32b5e699f bs-div---default bs-div--body-large-font-size"><div class="bs-div__inner     ">
<div class="post-author-wrapper">
	<div class="name-wrapper">
		<span class="prefix">Author:&nbsp;</span>
		<span class="display-name">Shmuel Cohen, Sr. Security Researcher</span>	</div>
</div>



<p></p>



<p>Endpoint detection and response (EDR) solutions have become a key component of many enterprise endpoint security strategies, resulting in a forecasted market value close to <a href="https://www.grandviewresearch.com/industry-analysis/endpoint-detection-response-market-report#:~:text=b.-,The%20global%20endpoint%20detection%20and%20response%20(EDR)%20market%20size%20was,USD%203.55%20billion%20by%202023.">$17 billion by 2030</a>. This is due in no small part to the increase in remote work following the COVID-19 pandemic, the resulting bring-your-own-device (BYOD) trend in which employees use personal devices for work-related activities, and the constant evolution of cyber threats.&nbsp;</p>



<p>EDR solutions are designed to monitor end-user devices—like laptops, desktops, and servers—to help organizations better detect and address threats like ransomware and malware. As noted by <a href="https://www.gartner.com/reviews/market/endpoint-detection-and-response-solutions">Gartner</a>, EDR solutions “record and store endpoint-system-level behaviors, use various data analytics techniques to detect suspicious system behavior, provide contextual information, block malicious activity, and provide remediation suggestions to restore affected systems.” To carry out these activities, EDRs often run with the highest privileges, while being “tamper proof” and persistent.&nbsp;&nbsp;</p>



<p>As a security researcher and former malware researcher, I have consistently observed the ongoing race between EDR solutions and ever-evolving malware strains—as one gets more sophisticated, so too does the other. My most recent research project, which I first presented at <a href="https://www.blackhat.com/asia-24/briefings/schedule/#the-dark-side-of-edr-repurpose-edr-as-an-offensive-tool-37846">Black Hat Asia 2024</a>, set out to explore how I could manipulate this relationship between the two to make an EDR a malicious offensive tool. Specifically, I wanted to see if I could create malware that was part of the EDR itself—not just able to bypass it—while remaining persistent, stealthy, and with high privileges. I set my sights on one of the most widely used solutions on the market: Palo Alto Networks <a href="https://www.paloaltonetworks.com/cortex/cortex-xdr">Cortex extended detection and response (XDR) platform</a>.&nbsp;</p>



<p>Below, I’ll first provide a high-level overview of the key findings and takeaways from this research. Next, I’ll dive into the details about the content files that are made available as part of the Cortex XDR installation process and, specifically, the information I uncovered within these files about the functionality of its ransomware protection feature. I’ll provide examples and demonstrations about how I used that information to develop multiple techniques to bypass the XDR. Then, I will explain how my research process identified ways to further exploit the XDR’s behavior, allowing me to develop another bypass and even insert my own malware to run from within one of the XDR’s processes. Finally, I will highlight the vendor response and explain how we are sharing this information with the broader security community to help organizations protect themselves.</p>



<h2 class="wp-block-heading"><strong>Overview&nbsp;</strong></h2>



<h3 class="wp-block-heading"><strong>Key Findings&nbsp;</strong></h3>



<p>As part of the installation process, Cortex XDR includes Lua-based content files containing the underlying logic for its detection mechanisms. It utilizes information from these files to enforce its protection features. By analyzing these content files, I gained insight into the logic behind some of the XDR’s protections. This enabled me to devise methods to evade certain protections, such as:</p>



<ul class="wp-block-list">
<li>Encrypting files within a specified folder while leaving honeypot files unaffected to avoid detection.</li>



<li>Conducting a memory dump of the <em>lsass.exe</em> process, which holds sensitive data like user credentials and security tokens.</li>
</ul>



<p>Throughout my research, I also identified ways to exploit Cortex XDR’s behavior, including:</p>



<ul class="wp-block-list">
<li>Bypassing Cortex’s file anti-tampering protection, ultimately enabling me to load a vulnerable driver (bring-your-own-vulnerable-driver [BYOVD]) and patch Cortex XDR’s management password verification within one of its drivers. This allowed me to change Cortex’s logic to deny any administrator password, thus preventing the administrator the ability to remove the XDR by using the admin’s uninstall password from the Cortex management server or with physical access to the infected machine. I believe a full disk format and reinstall of the operating system and Cortex XDR would be required to remove the malicious code.</li>



<li>Inserting malicious code into one of its processes, granting me high privileges and allowing me to remain undetected and persistent.</li>
</ul>



<h3 class="wp-block-heading"><strong>Takeaways</strong></h3>



<p>We believe the implications of this research—which have the potential to create significant security risks for millions of users—suggest several important takeaways:</p>



<ul class="wp-block-list">
<li>Proactive research to identify security risks in endpoint products may be more valuable than researching security risks in operating systems (OSs). Attackers that exploit risks in the OS must still contend with another guardian: the EDR. However, if attackers breach the highest guardian (i.e., the EDR), they stand to gain unfettered access to a large set of powerful capabilities without having to face any guardian at all.</li>



<li>The logic behind the detection processes of a security product should be closely guarded. This research has proven that, by giving attackers access to this sensitive detection logic via the solution’s content files, they are much more likely to be able to engineer a way around it. We believe endpoint security vendors must ensure that:
<ul class="wp-block-list">
<li>Content files are encrypted while on the disk. While these files will be decrypted in memory at some point, it will make it more difficult to analyze the files and develop bypasses.&nbsp;</li>



<li>Content files must be digitally signed/verified and are not dependent on an external anti-tampering layer that could be bypassed as a single point of failure.&nbsp;</li>
</ul>
</li>



<li>The addition of processes or actions on an “allowlist” or “blocklist” should be based on multiple parameters. More specifically, the parameters should not have the ability to be manipulated by attackers. Adding a process to an “allowlist” based only on its name, which can be easily modified by an attacker, or detecting a process dump based on a command Regex, for instance, is not enough.</li>
</ul>



<h2 class="wp-block-heading"><strong>Background</strong></h2>



<h3 class="wp-block-heading"><strong>Cortex XDR Installation Process</strong></h3>



<p>The Palo Alto Cortex XDR platform offers support for Windows, Mac operating system (OS), and Linux environments. I decided to focus solely on the Windows agent and set out to first understand how it worked. As a starting point, I explored what files were written to the disk during the installation process and noticed there were a number of additional files and folders related to the XDR under the <em>C:\ProgramData\Cyvera</em> folder.&nbsp;</p>


<div class="wp-block-image">
<figure class="aligncenter size-full"><img fetchpriority="high" decoding="async" width="786" height="572" src="https://www.safebreach.com/wp-content/uploads/2024/04/01-EDR.webp" alt="Cortex EDR Research Shmuel Cohen" class="wp-image-145860"></figure></div>


<p>Within that folder, I discovered another folder called <em>content</em>. It seemed to include policy rules and both Lua and Python files that were text-based and easily understood.</p>



<h3 class="wp-block-heading"><strong>Cortex XDR Ransomware Protection&nbsp;</strong></h3>



<p>Upon further inspection of the <em>content</em> folder, I noticed a file called <em>ransom.lua,</em> which gave me a pretty good understanding of how Cortex’s ransomware protections works. Essentially, Cortex hides honeypot files in various locations on a machine to assist with ransomware detection. If a process tries to modify those files, the XDR identifies it as probable ransomware and the process is terminated.</p>



<figure class="wp-block-image size-large"><img decoding="async" width="1024" height="605" src="https://www.safebreach.com/wp-content/uploads/2024/04/02-EDR-1024x605.webp" alt="Cortex EDR Honey pot Shmuel Cohen SafeBreach" class="wp-image-145861"></figure>



<p>Cortex also wants to prevent most legitimate processes from seeing the honeypot files—this is done to prevent them from accidentally modifying the decoy files, resulting in a false alert or termination of the process. To do this, Cortex:&nbsp;</p>



<ul class="wp-block-list">
<li>Holds a list of the legitimate processes that should not be able to see the honeypot files in the <em>ransom.lua</em> file</li>



<li>Uses a mini-filter driver to make the honeypot files invisible to those processes&nbsp;</li>
</ul>



<figure class="wp-block-image size-full"><img decoding="async" width="526" height="506" src="https://www.safebreach.com/wp-content/uploads/2024/04/03-EDR.webp" alt="" class="wp-image-145862"></figure>



<h2 class="wp-block-heading"><strong>The Research Process</strong></h2>



<p>With the information I’d learned about how Cortex XDR’s ransomware protection worked, my research goals were established. I wanted to:&nbsp;</p>



<ul class="wp-block-list">
<li>First, see if I could bypass the XDR’s ransomware protection by abusing the knowledge I gained from reading the <em>ransom.lua</em> file.&nbsp;</li>



<li>Second, see what other malicious actions I could complete using the detection logic within the content files.&nbsp;</li>



<li>Third, identify a technique that would allow me to actually run malware inside the XDR itself, not just bypass it.&nbsp;</li>
</ul>



<p></p>



<!--HubSpot Call-to-Action Code --><span class="hs-cta-wrapper" id="hs-cta-wrapper-79490104-7e76-41ac-9252-46c9b2479ea4"><span class="hs-cta-node hs-cta-79490104-7e76-41ac-9252-46c9b2479ea4" id="hs-cta-79490104-7e76-41ac-9252-46c9b2479ea4"><!--[if lte IE 8]><div id="hs-cta-ie-element"></div><![endif]--><a href="https://cta-redirect.hubspot.com/cta/redirect/43692056/79490104-7e76-41ac-9252-46c9b2479ea4"><img decoding="async" class="hs-cta-img" id="hs-cta-img-79490104-7e76-41ac-9252-46c9b2479ea4" style="border-width:0px;" src="https://no-cache.hubspot.com/cta/default/43692056/79490104-7e76-41ac-9252-46c9b2479ea4.png" alt="Free Guide: Uncover the Power of Continuous Security Validation"></a></span></span><!-- end HubSpot Call-to-Action Code -->



<p></p>



<h2 class="wp-block-heading"><strong>Bypass Techniques</strong></h2>



<h3 class="wp-block-heading"><strong>Cortex XDR Ransomware Protection Bypass</strong></h3>



<p>To begin, I verified that the Cortex XDR was up and running with all of the services and protections enabled. I wrote a very simple ransomware with the name <em>ransom.exe</em> that would encrypt all the files in a given folder for the first test. I ran it on the <em>Documents</em> folder, which contained important files. As expected, Cortex detected this malicious action with its ransomware protection and the files were not encrypted.</p>



<p>For the real test, I picked one of the names of the white listed programs in the <em>ransom.lua</em> file—<em>aaplayer.exe</em>—and renamed the ransomware accordingly. I ran it on the <em>Documents </em>folder again and this time it worked. I was able to encrypt all files there, successfully bypassing Cortex XDR’s ransomware protection.&nbsp;</p>



<p>Why? When ransomware is executed on a specific folder, it lists all of the files within the folder and then encrypts them. By giving my ransomware the same name as one of the white listed processes, I was able to prevent it from seeing/listing the honeypot files within the <em>Documents </em>folder. As a result, it only encrypted the legitimate files in the folder, leaving the honeypot files untouched and allowing it to remain undetected by the XDR.&nbsp;</p>



<p>To see this process in action, check out the demo below.&nbsp;</p>



<figure class="wp-block-video"><video controls="" src="https://www.safebreach.com/wp-content/uploads/2024/04/Ransomware_Bypass_Cortex.mp4"></video></figure>



<h3 class="wp-block-heading"><strong>ProcDump Bypass</strong></h3>



<p>After the successful ransomware protection bypass, I wanted to try more malicious attacks to see how the Cortex XDR would respond. My next test was to try to dump the memory of the <em>lsass.exe</em> process, which holds very sensitive data about the machine it runs on (e.g., data like user credentials and security tokens).</p>



<p>To begin, I used ProcDump to dump the <em>lsass</em> memory into a file called<em> lsass.dmp</em>. ProcDump is a Windows command-line utility that can be used to create process dump files that capture memory snapshots of running processes.&nbsp;</p>


<div class="wp-block-image">
<figure class="aligncenter size-full"><img loading="lazy" decoding="async" width="454" height="29" src="https://www.safebreach.com/wp-content/uploads/2024/04/04-EDR.webp" alt="Cortex EDR Research Shmuel Cohen SafeBreach" class="wp-image-145863"></figure></div>


<p>As expected I received a prevention alert from the XDR. And, it was kind enough to tell me that it was the <em>Regex </em>detection that caught me.</p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="860" src="https://www.safebreach.com/wp-content/uploads/2024/04/05-EDR-1024x860.webp" alt="Dark Side of EDR Cortex Palo Alto" class="wp-image-145864"></figure>



<p>I needed a way to run this command without being caught with the <em>Regex</em> test, so I inserted two quotes into the middle of the command and executed it again. This wouldn’t change the command results, but I hoped it would bypass the Regex detection.</p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="79" src="https://www.safebreach.com/wp-content/uploads/2024/04/06-EDR-1024x79.webp" alt="EDR Shmuel Cohen SafeBreach Labs" class="wp-image-145865"></figure>



<p>This successfully bypassed the “suspicious process creation” rule caused by the Regex detection that prevented me before I modified the command line. However, I received four alerts from a different Cortex prevention module, all of which were related to the <em>mini-dump-write-dump</em> function.&nbsp;</p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="788" src="https://www.safebreach.com/wp-content/uploads/2024/04/07-EDR-1024x788.webp" alt="EDR Offensive tool research SafeBreach" class="wp-image-145866"></figure>



<p>So, I went back to the <em>content</em> files and searched for those prevention rules. I found all of them in a file called <em>dse_rules_config.lua</em>. An example of one of the prevention rules below shows it is called <em>mini-dump-write-dump rpm terminate</em> and the action is to block it.</p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="585" src="https://www.safebreach.com/wp-content/uploads/2024/04/08-EDR-1024x585.webp" alt="EDR Mimikatz Shmuel Cohen SafeBreach" class="wp-image-145867"></figure>



<p>At first, it looked like a dead end and there was nothing I could do to bypass it. However, upon closer inspection, I noticed a list called <em>mimikatz_rpm_process_whitelist </em>within the <em>dse_rules_config.lua </em>file<em>. </em>Since it included the term <em>rpm</em>, which was also included in the prevention rule naming (e.g., <em>mini-dump-write-dump_rpm_terminate</em>), I thought there might be some relation between them.&nbsp;</p>



<p>I tried to rename the <em>ProcDump</em> program to <em>listdlls</em>, which was one of the white-listed programs from the <em>mimikatz_rpm_process_whitelist</em>. I executed the command again and it worked—I was able to dump <em>lsass memory</em>.</p>



<p>To see this process in action, check out the demo below.&nbsp;</p>



<figure class="wp-block-video"><video controls="" src="https://www.safebreach.com/wp-content/uploads/2024/04/LSASS_Dump_Bypass_Cortex.mp4"></video></figure>



<h3 class="wp-block-heading"><strong>Anti-Tampering Bypass</strong></h3>



<p>As a starting point, I began to consider what might happen if I added/removed my own rules to the content files. To figure this out, I needed to understand how Cortex protects its files from file tampering. When I tried to modify the files, even as an administrator, I was blocked with a “File Access Denied” error message.</p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="610" src="https://www.safebreach.com/wp-content/uploads/2024/04/09-EDR-1024x610.webp" alt="EDR Cortex Anti Tampering bypass" class="wp-image-145868"></figure>



<p>This behavior led me to believe that Cortex was probably using a mini-filter driver to enable this type of protection. A mini-filter driver is a known way to intercept—and even block—I\O requests.</p>



<p>Armed with this knowledge, I started to reverse engineer Cortex’s drivers. I found it had multiple drivers running on the system, but one named <em>cyvrfsfd</em> caught my attention. Since <em>fsfd </em>is a known shortcut for file system filter driver, it appeared as though it might be the driver responsible for protecting files on the system. Indeed, I was able to find in this driver a list of the files and folders that this mini-filter was protecting from modification.</p>


<div class="wp-block-image">
<figure class="aligncenter size-full"><img loading="lazy" decoding="async" width="685" height="556" src="https://www.safebreach.com/wp-content/uploads/2024/04/10-EDR.webp" alt="Cortex EDR Shmuel Cohen SafeBreach" class="wp-image-145869"></figure></div>


<p><strong><em>A snippet from IDA while reverse engineering cyvrfsfd driver, showing the list of files and folders that should be protected from tampering.</em></strong></p>



<p>But how was it protecting those files? After a bit more reverse engineering, I found the implementation of the mini-filter that was responsible for file modifications and deduced that it basically compares path names with those of its protected files when someone tries to open a file with write permissions.</p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="199" src="https://www.safebreach.com/wp-content/uploads/2024/04/11-EDR-1024x199.webp" alt="EDR Vulnerability" class="wp-image-145870"></figure>



<p>So, how could I bypass this protection? The protection is carried out with a path check, which isn’t sufficient to check all the ways a file could be changed. There are other methods to change a file and I settled on the idea of linking. Hard links allow the creation of what appears to be a distinct file, but in reality, it’s just another reference to the same data on the disk. This means that when you make changes to a hard-linked file, it directly modifies the original file on the disk.</p>


<div class="wp-block-image">
<figure class="aligncenter size-medium"><img loading="lazy" decoding="async" width="300" height="285" src="https://www.safebreach.com/wp-content/uploads/2024/04/12-EDR-300x285.webp" alt="mklink EDR Cortex" class="wp-image-145871"></figure></div>


<p>I attempted to use the Windows built-in utility <em>mklink </em>to create this hard link—this action required admin privileges. Unfortunately, this was also blocked by the mini-filter. But why? Creating a hardlink requires write permission to the destination file, which the mini-filter blocks us from doing.</p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="602" src="https://www.safebreach.com/wp-content/uploads/2024/04/13-EDR-1024x602.webp" alt="EDR Research Shmuel Cohen SafeBreach Labs" class="wp-image-145872"></figure>



<p>I wondered whether creating a link with <em>mklink</em> was the only way to do it. After searching for an alternative way, I stumbled upon a <em>google-project-zero</em> repository called <em>symboliclink-testing-tools</em>. I saw they implemented hardlinking in a different way than <em>mklink</em>—they were not requesting for write permissions on the target file. When I tested their tool, it worked. I was able to hard-link the files.&nbsp;</p>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="875" height="87" src="https://www.safebreach.com/wp-content/uploads/2024/04/14-EDR.webp" alt="Dark side of EDR Shmuel Cohen" class="wp-image-145873"></figure>



<p>To see what I could accomplish with these write privileges, I tried to remove one of the security rules from the <em>dse_rules_config</em> file: the detection for loading a vulnerable driver (rtcore64.sys driver). If successful, this would allow me to execute a form of bring-your-own-vulnerable-driver (BYOVD) attack, which could be very powerful.</p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="363" src="https://www.safebreach.com/wp-content/uploads/2024/04/15-EDR-1024x363.webp" alt="Repurpose EDR as an Offensive Tool" class="wp-image-145874"></figure>



<p>After removing this rule, I immediately tried to load the rtcore64 vulnerable driver to the system. Unfortunately this was still prevented by the XDR, because it had already loaded the rules when it started up.&nbsp;</p>


<div class="wp-block-image">
<figure class="aligncenter size-full"><img loading="lazy" decoding="async" width="536" height="445" src="https://www.safebreach.com/wp-content/uploads/2024/04/16-EDR.webp" alt="Palo Alto Cortex Repurpose EDR as an Offensive Tool" class="wp-image-145875"></figure></div>


<p>I now needed to figure out a way to force the XDR to load the rules again, after I modified them. When I looked at the agent command line interface (CLI) tool called <em>cytool.exe</em>, I noticed there was an option to do something called “check-in,” which is basically to query the management server for new updates (including policy updates).</p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="708" src="https://www.safebreach.com/wp-content/uploads/2024/04/17-EDR-1024x708.webp" alt="Dark side of EDR Repurpose EDR as an Offensive Tool" class="wp-image-145876"></figure>



<p>But, when I tried to run a check-in, the content files were downloaded again from the management server, so the changes that I made were overwritten.&nbsp;</p>



<p>My solution for that was simply to redirect all traffic from the XDR to <em>localhost</em> by using the <em>hosts</em> file, which is not something that the XDR stops. And, it worked. After running a check-in, my new policy was loaded and the XDR didn’t detect the load of the <em>rtcore64</em> driver.</p>



<p>Next, I exploited a known vulnerability in the rtcore64 driver (<a href="https://nvd.nist.gov/vuln/detail/CVE-2019-16098">CVE-2019-16098</a>), which allows a user-mode process to read/write into kernel memory and, as a result, achieve privilege elevation. I used this vulnerability to patch the management password verification in one of the drivers used by Cortex XDR. I patched it in such a way that any password would work in order to accomplish any task with the XDR. It was also possible to patch it so that no password would work, ever. This would mean that no user—even the most powerful user like the Domain Admin—would be able to remove the XDR from the computer because the XDR was disconnected from the management-server (because of my change in the hosts file) and physical uninstallation would require a password. Since we just patched the driver, no password would work. To make sure we kept the XDR disconnected from the management server, we could even leverage the XDR’s protected file list to protect the hosts file from any modifications.</p>



<p>To see this process in action, check out the demo below.&nbsp;</p>



<figure class="wp-block-video"><video controls="" src="https://www.safebreach.com/wp-content/uploads/2024/04/Password_Bypass_Demo_Cortex.mp4"></video></figure>



<h2 class="wp-block-heading"><strong>Running the XDR as a Malware</strong></h2>



<p>The bypasses I uncovered were significant, as they would allow me to do all sorts of malicious things inside the victim computer. But, they didn’t serve the real goal of running malware inside the EDR itself. So, I continued to consider what an advanced persistent threat (APT) group might do in this situation. Most APT groups are after stealth, persistence, and high privilege.&nbsp;</p>



<p>I began to consider the fact that I could modify the Lua rules. Since Lua is actually a programming language, maybe I could insert my own malicious code to run inside the XDR instead of simply changing the rules. For a sanity test, I tried to insert a very simple piece of code that creates a file on the desktop. After adding the code and running a check-in, it worked.</p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="488" src="https://www.safebreach.com/wp-content/uploads/2024/04/18-EDR-1024x488.webp" alt="Running XDR As malware EDR" class="wp-image-145877"></figure>



<p>Next, I wrote a simple function that would execute my commands. The goal was to see if I could run my own commands within the <em>cyserver</em> process.&nbsp;</p>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="966" height="930" src="https://www.safebreach.com/wp-content/uploads/2024/04/19-EDR.webp" alt="XDR cyserver EDR " class="wp-image-145878"></figure>



<p>But this time something very strange happened—when I tried to run this code, <em>cyserver.exe,</em> which is the main XDR process, crashed completely. The <em>io.popen</em> function is the line that caused that behavior. My assumption was that the code I added invoked an unhandled exception and it caused <em>cyserver.exe</em> to crash.</p>


<div class="wp-block-image">
<figure class="aligncenter size-medium"><img loading="lazy" decoding="async" width="300" height="209" src="https://www.safebreach.com/wp-content/uploads/2024/04/20-EDR-300x209.webp" alt="Repurpose EDR as an Offensive Tool Safebreach" class="wp-image-145879"></figure></div>


<p>I tried many more techniques to run my code using LUA, including loading a malicious dynamic link library (DLL) and using other Lua commands to run my code. Unfortunately, none of those worked. But, this behavior of <em>cyserver</em> crashing would soon come in handy.</p>



<p>During my earlier exploration of the content files, I encountered some Python files as well and wondered where they were being used.&nbsp;</p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="848" src="https://www.safebreach.com/wp-content/uploads/2024/04/21-EDR-1024x848.webp" alt="python files cortex" class="wp-image-145880"></figure>



<p>I knew that I could modify all the content files, including those Python files. If Cortex would run those files, maybe I could manipulate Cortex to run my Python script. I started by taking a look at the processes being run by Cortex. We can see that all of the processes are running with the highest privileges.</p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="254" src="https://www.safebreach.com/wp-content/uploads/2024/04/22-EDR-1024x254.webp" alt="cyserver cortex EDR" class="wp-image-145881"></figure>



<p>I saw the main <em>cyserver</em> process, with some workers under it, and another process with a very interesting name: <em>cortex-xdr-payload.exe</em>. When I looked at the process’s properties, there appeared to be a command line for it, which led me to believe it might be some sort of configuration file. I also noticed that the name contained “service_main.json,” which seemed interesting.&nbsp;</p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="367" src="https://www.safebreach.com/wp-content/uploads/2024/04/23-EDR-1024x367.webp" alt="Dark Side of EDR Black Hat SafeBreach" class="wp-image-145882"></figure>



<p>When I opened the file to see what it contained, it appeared to be a configuration file that described the running arguments for a service called <em>service_main.py</em>.&nbsp;</p>


<div class="wp-block-image">
<figure class="aligncenter size-full"><img loading="lazy" decoding="async" width="557" height="405" src="https://www.safebreach.com/wp-content/uploads/2024/04/24-EDR.webp" alt="Dark Side of EDR Shmuel Cohen Black Hat SafeBreach" class="wp-image-145883"></figure></div>


<p>This script looks like a service that is running in a loop and tries to get pending tasks from some other service and execute them.&nbsp;</p>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="994" height="928" src="https://www.safebreach.com/wp-content/uploads/2024/04/25-EDR.webp" alt="Cortex XDR Payload privileges persistent" class="wp-image-145884"></figure>



<p>The good news was that I knew I could change the content of the file and insert my own malicious code to it. The bad news was that this Python script was already loaded into the <em>cortex-xdr-payload</em> process, meaning that even if I modified this script, it wouldn’t actually affect the <em>cortex-xdr-payload</em> process.</p>



<p>In order to cause the <em>cortex-xdr-payload</em> process to reload this python file, I tried to run the check-in trick that I used earlier, hoping it might cause the process to load the modified Python files again. But it didn’t work; the process stayed alive during check-in and didn’t load the new Python files.&nbsp;</p>



<p>Thinking back to how the <em>io.popen</em> function had previously caused <em>cyserver</em> to crash, I thought I might be able to use that behavior. I modified the Python main service script, caused <em>cyserver </em>to crash, then immediately turn it back on. This caused my code to run, giving me backdoor access to the machine with NT/system permissions—one of the highest privileges possible. Because my malware was inside <em>cyserver</em> and would run from one of its processes, it was undetectable, stealthy, persistent, and high-privileged.&nbsp;&nbsp;&nbsp;</p>



<p>To see this process in action, check out the demo below.&nbsp;</p>



<figure class="wp-block-video"><video controls="" src="https://www.safebreach.com/wp-content/uploads/2024/04/Run_As_Malware_Final_Demo.mp4"></video></figure>



<h2 class="wp-block-heading"><strong>Vendor Response&nbsp;</strong></h2>



<p>All issues were reported to Palo Alto Networks in 2023 and we received the following response in February 2024:</p>



<p>“Security is our highest priority. SafeBreach notified us of its research [10] months ago and at that time we addressed the feature bypasses through automatic content updates to our customers.”&nbsp;&nbsp;</p>



<h2 class="wp-block-heading"><strong>Conclusion&nbsp;&nbsp;</strong></h2>



<p>This research has explored the potential security implications of making the sensitive detection logic of an EDR solution easily accessible. We have shown how malicious actors could exploit this information to reverse engineer a way around the EDR, creating significant security risks for millions of users. To help mitigate the potential impact of the vulnerabilities identified by this research, we have:&nbsp;</p>



<ul class="wp-block-list">
<li>Responsibly disclosed our research findings to Palo Alto Networks and met with them to discuss possible fixes for the issues we found. As noted above, they released a fix. We would strongly encourage all users of the Cortex XDR to ensure their software version is up to date to prevent any vulnerability to this type of attack. We would also strongly encourage other endpoint security vendors to ensure that:
<ul class="wp-block-list">
<li>Content files are encrypted while on the disk. While these files will be decrypted in memory at some point, it will make it more difficult to analyze the files and develop bypasses.&nbsp;</li>



<li>Content files must be digitally signed/verified and are not dependent on an external anti-tampering layer that could be bypassed as a single point of failure.&nbsp;</li>
</ul>
</li>



<li>Shared our research openly with the broader security community here and at our recent <a href="https://www.blackhat.com/asia-24/briefings/schedule/#the-dark-side-of-edr-repurpose-edr-as-an-offensive-tool-37846">Black Hat Asia 2024</a> presentation to raise awareness about these issues.</li>



<li>Provided a <a href="https://github.com/SafeBreach-Labs/CortexVortex">research repository</a> that includes tools that enable the verification of these vulnerabilities and serve as a basis for further research and development.&nbsp;</li>



<li>Added original attack content to the SafeBreach platform that enables our customers to validate their environment against the vulnerabilities outlined in this research to significantly mitigate their risk.</li>
</ul>



<p>For more in-depth information about this research, please:&nbsp;</p>



<ul class="wp-block-list">
<li>Contact your customer success representative if you are a current SafeBreach customer</li>



<li><a href="https://www.safebreach.com/request-a-demo-original-attacks/">Schedule a one-on-one</a> discussion with a SafeBreach expert</li>



<li>Contact <a href="mailto:leslie@kesscomm.com">Kesselring PR</a> for media inquiries&nbsp;</li>
</ul>



<h2 class="wp-block-heading"><strong>About the Researcher</strong></h2>



<p>Shmuel Cohen is a cybersecurity professional with a diverse background. After serving in the Israel Defense Force (IDF) for three years, he pursued a bachelor of science degree in computer science. He had the privilege of working at CheckPoint, where he developed software and worked as a malware security researcher. As his interest grew in vulnerability research, he joined the SafeBreach team, where he has been able to focus his energies on exploring and addressing vulnerabilities in cybersecurity. Since joining SafeBreach Labs, he has had the opportunity to present original research three times at Black Hat and two times at CONfidence.</p>



<!--HubSpot Call-to-Action Code --><span class="hs-cta-wrapper" id="hs-cta-wrapper-55691160-2f49-4759-a30e-2d54c9c71868"><span class="hs-cta-node hs-cta-55691160-2f49-4759-a30e-2d54c9c71868" id="hs-cta-55691160-2f49-4759-a30e-2d54c9c71868"><!--[if lte IE 8]><div id="hs-cta-ie-element"></div><![endif]--><a href="https://cta-redirect.hubspot.com/cta/redirect/43692056/55691160-2f49-4759-a30e-2d54c9c71868"><img decoding="async" class="hs-cta-img" id="hs-cta-img-55691160-2f49-4759-a30e-2d54c9c71868" style="border-width:0px;" src="https://no-cache.hubspot.com/cta/default/43692056/55691160-2f49-4759-a30e-2d54c9c71868.png" alt="CTA - Business Impact of Continuous Security Validation"></a></span></span><!-- end HubSpot Call-to-Action Code -->
</div></div>
</div>
</div>
</div></section>



<section class="wp-block-e25m-section bs-section bs-section-92f291c17c171722c4c489295cad896c03e51465 bs-section---default bs-section--home-resources bs-section--industry-healthcare-resources bs-section--blog-inner-post-block"><div class="container">
<div class="wp-block-e25m-row bs-row row  bs-row---default">
<div class=" bs-column col-sm-12 col-md-0   bs-column-c6e1433ccca98b012fc1a46003db94275a5c7eff bs-column---default     ">
<h2 class="wp-block-heading">You Might Also Be Interested In</h2>
</div>
</div>



<div class="wp-block-e25m-row bs-row row  bs-row---default">
<div class=" bs-column col-sm-12 col-md-4   bs-column-ddb0ca5d1fd73cb3f5e6682823076c9e17e95d12 bs-column---default     ">					<div class="bs-post bs-post-6995995253562 bs-single-post---default bs-single-post--common bs-single-post--no-image-post enable">
			<a class="bs-post__trigger" href="https://www.safebreach.com/blog/prince-of-persia-a-decade-of-an-iranian-nation-state-apt-campaign-activity/" target="_self">			<div class="bs-post__inner">
				<div class="bs-post__image">
                            <figure class="figure">
                                <img src="https://www.safebreach.com/wp-content/uploads/2025/12/25-12-Prince-of-Persia-Blog-Post.webp" class="img-fluid" alt="Prince of Persia" title="Prince of Persia">
                                <figcaption class="figure-caption"></figcaption>
                            </figure>
                        </div><div class="bs-post__details">    <div class="bs-post__category bs-post-taxonomy_resource-type">
        <span>Research</span><span>Blog</span>    </div>
    <div class="bs-post__title">
        <h3>Prince of Persia, Part 1: A Decade of Iranian Nation-State APT Campaign Activity under the Microscope</h3>
    </div>
<div class="bs-post__learn-more">
    <span class="btn learn-more-text bs-post__learn-more-text">Read More</span></div>
</div>			</div>
			</a>		</div>
	</div>



<div class=" bs-column col-sm-12 col-md-4   bs-column-ddb0ca5d1fd73cb3f5e6682823076c9e17e95d12 bs-column---default     ">					<div class="bs-post bs-post-6995995254a9d bs-single-post---default bs-single-post--common bs-single-post--no-image-post enable">
			<a class="bs-post__trigger" href="https://www.safebreach.com/blog/update-on-windows-downdate-downgrade-attacks/" target="_self">			<div class="bs-post__inner">
				<div class="bs-post__image">
                            <figure class="figure">
                                <img src="https://www.safebreach.com/wp-content/uploads/2024/10/24-10-Update-on-Windows-Downdate.webp" class="img-fluid" alt="" title="24-10 Update on Windows Downdate">
                                <figcaption class="figure-caption"></figcaption>
                            </figure>
                        </div><div class="bs-post__details">    <div class="bs-post__category bs-post-taxonomy_resource-type">
        <span>Research</span><span>Blog</span>    </div>
    <div class="bs-post__title">
        <h3>An Update on Windows Downdate</h3>
    </div>
<div class="bs-post__learn-more">
    <span class="btn learn-more-text bs-post__learn-more-text">Read More</span></div>
</div>			</div>
			</a>		</div>
	</div>



<div class=" bs-column col-sm-12 col-md-4   bs-column-ddb0ca5d1fd73cb3f5e6682823076c9e17e95d12 bs-column---default     ">					<div class="bs-post bs-post-6995995256207 bs-single-post---default bs-single-post--common bs-single-post--no-image-post enable">
			<a class="bs-post__trigger" href="https://www.safebreach.com/blog/magicdot-a-hackers-magic-show-of-disappearing-dots-and-spaces/" target="_self">			<div class="bs-post__inner">
				<div class="bs-post__image">
                            <figure class="figure">
                                <img src="https://www.safebreach.com/wp-content/uploads/2024/04/24-04-MagicDot-Research-blog-1.webp" class="img-fluid" alt="" title="24-04 MagicDot Research blog (1)">
                                <figcaption class="figure-caption"></figcaption>
                            </figure>
                        </div><div class="bs-post__details">    <div class="bs-post__category bs-post-taxonomy_resource-type">
        <span>Research</span><span>Blog</span>    </div>
    <div class="bs-post__title">
        <h3>MagicDot: A Hacker’s Magic Show of Disappearing Dots and Spaces</h3>
    </div>
<div class="bs-post__learn-more">
    <span class="btn learn-more-text bs-post__learn-more-text">Read More</span></div>
</div>			</div>
			</a>		</div>
	</div>
</div>
</div></section>



<section class="wp-block-e25m-section bs-section bs-section-152dc48c48f76276b8e59d1241e250f6f8f2d658 bs-section---default bs-section--press-inner-newsletter"><div class="container">
<div class="wp-block-e25m-row bs-row row  bs-row---default">
<div class=" bs-column col-sm-12 col-md-5 col-lg-5 col-xl-5   bs-column-ea1477cd70e80d58d5e8b21de61e7efb79aa38a6 bs-column---default     ">
<h2 class="wp-block-heading has-pure-white-color has-text-color">Get the latest<br>research and news</h2>
</div>



<div class=" bs-column col-sm-12 col-md-7 col-lg-7 col-xl-7   bs-column-fb970c0aaeee301967d24061074d9e24bb53b2a6 bs-column---default     ">
<div class="wp-block-e25m-div bs-div bs-div-24a31fdad168dfc2c1de4b9ea2b72f191f628538 bs-div---default bs-div--footer-form-block bs-div--hubspot-form-block"><div class="bs-div__inner     ">

<div class="bs-embedded-forms bs-embedded-forms---default bs-embedded-forms-2921e7f4e22cdbd4170b201c6740a77c43fe4770" id="bs-embedded-forms-2921e7f4e22cdbd4170b201c6740a77c43fe4770__form" data-hs-forms-root="true"><form id="hsForm_1830aba9-31aa-4bb4-82cc-289210cdc9e9" method="POST" accept-charset="UTF-8" enctype="multipart/form-data" novalidate="" action="https://forms.hsforms.com/submissions/v3/public/submit/formsnext/multipart/43692056/1830aba9-31aa-4bb4-82cc-289210cdc9e9" class="hs-form-private hsForm_1830aba9-31aa-4bb4-82cc-289210cdc9e9 hs-form-1830aba9-31aa-4bb4-82cc-289210cdc9e9 hs-form-1830aba9-31aa-4bb4-82cc-289210cdc9e9_0fdd83e0-ff43-4055-9a77-4cef5dd95b13 hs-form stacked hs-custom-style" target="target_iframe_1830aba9-31aa-4bb4-82cc-289210cdc9e9" data-instance-id="0fdd83e0-ff43-4055-9a77-4cef5dd95b13" data-form-id="1830aba9-31aa-4bb4-82cc-289210cdc9e9" data-portal-id="43692056" data-test-id="hsForm_1830aba9-31aa-4bb4-82cc-289210cdc9e9"><div class="hs_firstname hs-firstname hs-fieldtype-text field hs-form-field"><label id="label-firstname-1830aba9-31aa-4bb4-82cc-289210cdc9e9" class="" for="firstname-1830aba9-31aa-4bb4-82cc-289210cdc9e9"><span>First Name</span><span class="hs-form-required">*</span></label><div class="input"><input id="firstname-1830aba9-31aa-4bb4-82cc-289210cdc9e9" name="firstname" required="" placeholder="First Name" type="text" class="hs-input" inputmode="text" autocomplete="given-name" value=""></div></div><div class="hs_lastname hs-lastname hs-fieldtype-text field hs-form-field"><label id="label-lastname-1830aba9-31aa-4bb4-82cc-289210cdc9e9" class="" for="lastname-1830aba9-31aa-4bb4-82cc-289210cdc9e9"><span>Last Name</span><span class="hs-form-required">*</span></label><div class="input"><input id="lastname-1830aba9-31aa-4bb4-82cc-289210cdc9e9" name="lastname" required="" placeholder="Last Name" type="text" class="hs-input" inputmode="text" autocomplete="family-name" value=""></div></div><div class="hs_company hs-company hs-fieldtype-text field hs-form-field"><label id="label-company-1830aba9-31aa-4bb4-82cc-289210cdc9e9" class="" for="company-1830aba9-31aa-4bb4-82cc-289210cdc9e9"><span>Company name</span><span class="hs-form-required">*</span></label><div class="input"><input id="company-1830aba9-31aa-4bb4-82cc-289210cdc9e9" name="company" required="" placeholder="Company Name" type="text" class="hs-input" inputmode="text" autocomplete="organization" value=""></div></div><div class="hs_email hs-email hs-fieldtype-text field hs-form-field"><label id="label-email-1830aba9-31aa-4bb4-82cc-289210cdc9e9" class="" for="email-1830aba9-31aa-4bb4-82cc-289210cdc9e9"><span>Email Address</span><span class="hs-form-required">*</span></label><div class="input"><input id="email-1830aba9-31aa-4bb4-82cc-289210cdc9e9" name="email" required="" placeholder="Company Email Address" type="email" class="hs-input" inputmode="email" autocomplete="email" value=""></div></div><div class="legal-consent-container"><div><div class="hs-dependent-field"><div class="hs_LEGAL_CONSENT.subscription_type_272483205 hs-LEGAL_CONSENT.subscription_type_272483205 hs-fieldtype-booleancheckbox field hs-form-field"><div class="input"><ul class="inputs-list"><li class="hs-form-booleancheckbox"><label for="LEGAL_CONSENT.subscription_type_272483205-1830aba9-31aa-4bb4-82cc-289210cdc9e9" class="hs-form-booleancheckbox-display"><input id="LEGAL_CONSENT.subscription_type_272483205-1830aba9-31aa-4bb4-82cc-289210cdc9e9" class="hs-input" type="checkbox" name="LEGAL_CONSENT.subscription_type_272483205" value="true"><span>I agree to receive other communications from SafeBreach.</span></label></li></ul></div></div></div><legend class="hs-field-desc checkbox-desc" style="display: none;"></legend></div><div><div class="hs-dependent-field"><div class="hs_LEGAL_CONSENT.processing hs-LEGAL_CONSENT.processing hs-fieldtype-booleancheckbox field hs-form-field"><div class="input"><ul class="inputs-list"><li class="hs-form-booleancheckbox"><label for="LEGAL_CONSENT.processing-1830aba9-31aa-4bb4-82cc-289210cdc9e9" class="hs-form-booleancheckbox-display"><input id="LEGAL_CONSENT.processing-1830aba9-31aa-4bb4-82cc-289210cdc9e9" class="hs-input" type="checkbox" name="LEGAL_CONSENT.processing" value="true"><span><p>I agree that SafeBreach may collect and use my personal data, for providing marketing material, in accordance with the&nbsp;<a href="https://www.safebreach.com/privacy-policy/" target="_blank">SafeBreach privacy policy</a>.</p><span class="hs-form-required">*</span></span></label></li></ul></div></div></div><legend class="hs-field-desc checkbox-desc" style="display: none;"></legend></div></div><div class="hs_submit hs-submit"><div class="hs-field-desc" style="display: none;"></div><div class="actions"><input type="submit" class="hs-button primary large" value="Submit"></div></div><div name="target_iframe_1830aba9-31aa-4bb4-82cc-289210cdc9e9" style="display: none;" data-original-tag="iframe"></div></form></div>
<!-- Incluing form response options -->
</div></div>
</div>
</div>
</div></section>
        
</main>
























    




</body></html>