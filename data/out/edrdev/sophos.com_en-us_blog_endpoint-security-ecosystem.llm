Title:
Standing on the Windows platform, waiting for change

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post summarizes themes from Microsoft’s Windows Endpoint Security Ecosystem Summit following the 2024 CrowdStrike kernel-driver outage, focusing on how endpoint security vendors integrate with Windows and how that could evolve.  
- It explains why Sophos (like other EDR/AV vendors) relies on kernel drivers and user-mode hooking/DLL injection to achieve visibility, prevention, anti-tamper, and performance goals.  
- The author outlines Sophos’ current Windows driver stack (ELAM/AM-PPL, file/process interception, network filtering, ransomware protection) and how events are handled synchronously/asynchronously between kernel and user space.  
- A major emphasis is Safe Deployment Practices: controlled rollouts, feature flags, and rapid disablement mechanisms to reduce blast radius of faulty updates.  
- The post proposes several Windows platform capabilities that could reduce third-party kernel-driver dependence (supported authorize/block APIs for file/registry/process/network, driver-blocking, object context, and a sanctioned alternative to DLL injection/hooking).  
- It draws parallels to Linux (eBPF, fanotify) and macOS (migration away from kexts) as examples of platform-led security interface transitions.  
- Useful for endpoint security engineers, EDR/AV vendors, and defenders evaluating kernel-risk tradeoffs; also relevant to red teams for understanding where enforcement/telemetry lives and where future platform controls may appear.

Technical Focus:
- Windows kernel drivers in endpoint security (minifilters, network filters, ELAM)
- AM-PPL / ELAM trust chain and anti-tamper design
- User-mode hooking and DLL injection for telemetry/enforcement
- Safe Deployment Practices (feature flags, staged rollouts, kill-switches)
- Proposed OS-native authorize/block APIs (file/registry/process/network/driver)
- Cross-platform security instrumentation (eBPF, fanotify, macOS Endpoint Security APIs)

Use Cases:
- Assessing kernel-mode risk and attack surface of EDR/AV architectures
- Designing safer update/rollout pipelines for security agents and drivers
- Mapping where endpoint controls occur (boot-time, kernel callbacks, user-mode hooks)
- Informing Windows platform/API requirements for third-party security tooling
- Threat modeling anti-tamper and protected-process strategies (and their bypass incentives)

Keywords:
Windows endpoint security, kernel driver, ELAM, AM-PPL, Protected Process Light, minifilter, WFP, network filter driver, DLL injection, user-mode hooking, ETW, syscall interception, ransomware blocking, tamper protection, driver blocking, Safe Deployment Practices, feature flags, staged rollout, eBPF, fanotify, macOS kext, Endpoint Security APIs, CrowdStrike incident 2024, ZTNA, OpenVPN TAP, DNS interception