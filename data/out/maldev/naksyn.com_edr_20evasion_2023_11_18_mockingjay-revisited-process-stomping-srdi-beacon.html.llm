Title:
Mockingjay revisited – Process stomping and loading Beacon with sRDI

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post revisits the Mockingjay idea (abusing existing RWX sections) and applies it to executables by introducing “Process Stomping”: writing shellcode into an executable’s mapped RWX section instead of allocating new memory.  
- It targets signed binaries with large RWX sections (example: GlassWire’s `.themida` section) to blend into expected “modified code” noise from packers and reduce reliance on suspicious APIs like `VirtualAlloc(Ex)`/`VirtualProtect`.  
- The technique creates a process suspended, overwrites the RWX section (to avoid mixed `PAGE_EXECUTE_WRITECOPY`/RWX artifacts), writes the payload, repoints the thread entry (`SetThreadContext`), and resumes execution.  
- It combines Cobalt Strike 4.9 “reflective-loaderless” Beacon DLLs with a modified sRDI loader so the Beacon is reflectively mapped directly inside the stomped RWX section (no new allocations; `VirtualProtect` calls removed).  
- Useful for red teams/pentesters and malware researchers exploring injection tradecraft and EDR evasion via section-backed execution rather than private RWX allocations.  
- Interesting because it highlights a less common abuse path (RWX sections in EXEs) and discusses practical memory-permission artifacts defenders can key on.

Technical Focus:
- Process Stomping (EXE section stomping) vs Process Hollowing/Overwriting
- Abusing mapped RWX PE sections (packer sections like `.themida`)
- Thread context manipulation (`SetThreadContext`, suspended process start)
- sRDI modifications (loader behavior, removing `VirtualAlloc`/`VirtualProtect`)
- Reflective-loaderless Cobalt Strike Beacon staging
- Memory permission artifacts (`PAGE_EXECUTE_WRITECOPY` → RWX via overwrite)

Use Cases:
- Injecting shellcode into a target process without `VirtualAllocEx`/`VirtualProtect`
- Hosting an in-memory implant inside an existing mapped RWX section for stealth
- Building PoCs to evaluate EDR detections around suspended-process + context change chains
- Researching detection opportunities around RWX section abuse and WCX→RWX transitions

Keywords:
Mockingjay, Process Stomping, process injection, RWX section, PAGE_EXECUTE_WRITECOPY, CreateProcess CREATE_SUSPENDED, WriteProcessMemory, SetThreadContext, ResumeThread, Process Overwriting, process hollowing, sRDI, Reflective DLL Injection, Cobalt Strike 4.9, reflective-loaderless Beacon, Themida, PE sections, Moneta, Process Hacker, VirtualAllocEx, VirtualProtect