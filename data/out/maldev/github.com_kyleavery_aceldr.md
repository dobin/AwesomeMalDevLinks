# https://github.com/kyleavery/AceLdr

[Skip to content](https://github.com/kyleavery/AceLdr#start-of-content)

You signed in with another tab or window. [Reload](https://github.com/kyleavery/AceLdr) to refresh your session.You signed out in another tab or window. [Reload](https://github.com/kyleavery/AceLdr) to refresh your session.You switched accounts on another tab or window. [Reload](https://github.com/kyleavery/AceLdr) to refresh your session.Dismiss alert

{{ message }}

[kyleavery](https://github.com/kyleavery)/ **[AceLdr](https://github.com/kyleavery/AceLdr)** Public

- [Notifications](https://github.com/login?return_to=%2Fkyleavery%2FAceLdr) You must be signed in to change notification settings
- [Fork\\
177](https://github.com/login?return_to=%2Fkyleavery%2FAceLdr)
- [Star\\
1k](https://github.com/login?return_to=%2Fkyleavery%2FAceLdr)


Cobalt Strike UDRL for memory scanner evasion.


### License

[MIT license](https://github.com/kyleavery/AceLdr/blob/main/LICENSE)

[1k\\
stars](https://github.com/kyleavery/AceLdr/stargazers) [177\\
forks](https://github.com/kyleavery/AceLdr/forks) [Branches](https://github.com/kyleavery/AceLdr/branches) [Tags](https://github.com/kyleavery/AceLdr/tags) [Activity](https://github.com/kyleavery/AceLdr/activity)

[Star](https://github.com/login?return_to=%2Fkyleavery%2FAceLdr)

[Notifications](https://github.com/login?return_to=%2Fkyleavery%2FAceLdr) You must be signed in to change notification settings

# kyleavery/AceLdr

main

[**1** Branch](https://github.com/kyleavery/AceLdr/branches) [**2** Tags](https://github.com/kyleavery/AceLdr/tags)

[Go to Branches page](https://github.com/kyleavery/AceLdr/branches)[Go to Tags page](https://github.com/kyleavery/AceLdr/tags)

Go to file

Code

Open more actions menu

## Folders and files

| Name | Name | Last commit message | Last commit date |
| --- | --- | --- | --- |
| ## Latest commit<br>[![kyleavery](https://avatars.githubusercontent.com/u/9327972?v=4&size=40)](https://github.com/kyleavery)[kyleavery](https://github.com/kyleavery/AceLdr/commits?author=kyleavery)<br>[bug fixes](https://github.com/kyleavery/AceLdr/commit/6ab821a01a4da8bc03c041a6f1c4e2678758db13)<br>3 years agoSep 28, 2023<br>[6ab821a](https://github.com/kyleavery/AceLdr/commit/6ab821a01a4da8bc03c041a6f1c4e2678758db13) · 3 years agoSep 28, 2023<br>## History<br>[5 Commits](https://github.com/kyleavery/AceLdr/commits/main/) <br>Open commit details<br>[View commit history for this file.](https://github.com/kyleavery/AceLdr/commits/main/) 5 Commits |
| [bin](https://github.com/kyleavery/AceLdr/tree/main/bin "bin") | [bin](https://github.com/kyleavery/AceLdr/tree/main/bin "bin") | [Malleable C2 transformations are now applied to the final AceLdr shel…](https://github.com/kyleavery/AceLdr/commit/4812aa68d4e361fbab2e329ab755d78216c6df76 "Malleable C2 transformations are now applied to the final AceLdr shellcode  This solves an issue where string references such as \"beacon.x64.dll\" or \"ReflectiveLoader\" still existed within the process memory whilst beacon was awake even though the transform section within the malleable profile replaced them.") | 4 years agoOct 7, 2022 |
| [scripts](https://github.com/kyleavery/AceLdr/tree/main/scripts "scripts") | [scripts](https://github.com/kyleavery/AceLdr/tree/main/scripts "scripts") | [DC30 Release](https://github.com/kyleavery/AceLdr/commit/7699e24632c1b297384fd110a495afc3ffed9f8f "DC30 Release") | 4 years agoAug 10, 2022 |
| [src](https://github.com/kyleavery/AceLdr/tree/main/src "src") | [src](https://github.com/kyleavery/AceLdr/tree/main/src "src") | [bug fixes](https://github.com/kyleavery/AceLdr/commit/6ab821a01a4da8bc03c041a6f1c4e2678758db13 "bug fixes") | 3 years agoSep 28, 2023 |
| [.gitignore](https://github.com/kyleavery/AceLdr/blob/main/.gitignore ".gitignore") | [.gitignore](https://github.com/kyleavery/AceLdr/blob/main/.gitignore ".gitignore") | [DC30 Release](https://github.com/kyleavery/AceLdr/commit/7699e24632c1b297384fd110a495afc3ffed9f8f "DC30 Release") | 4 years agoAug 10, 2022 |
| [LICENSE](https://github.com/kyleavery/AceLdr/blob/main/LICENSE "LICENSE") | [LICENSE](https://github.com/kyleavery/AceLdr/blob/main/LICENSE "LICENSE") | [DC30 Release](https://github.com/kyleavery/AceLdr/commit/7699e24632c1b297384fd110a495afc3ffed9f8f "DC30 Release") | 4 years agoAug 10, 2022 |
| [Makefile](https://github.com/kyleavery/AceLdr/blob/main/Makefile "Makefile") | [Makefile](https://github.com/kyleavery/AceLdr/blob/main/Makefile "Makefile") | [bug fixes](https://github.com/kyleavery/AceLdr/commit/6ab821a01a4da8bc03c041a6f1c4e2678758db13 "bug fixes") | 3 years agoSep 28, 2023 |
| [README.md](https://github.com/kyleavery/AceLdr/blob/main/README.md "README.md") | [README.md](https://github.com/kyleavery/AceLdr/blob/main/README.md "README.md") | [DC30 Release](https://github.com/kyleavery/AceLdr/commit/7699e24632c1b297384fd110a495afc3ffed9f8f "DC30 Release") | 4 years agoAug 10, 2022 |
| [demo.gif](https://github.com/kyleavery/AceLdr/blob/main/demo.gif "demo.gif") | [demo.gif](https://github.com/kyleavery/AceLdr/blob/main/demo.gif "demo.gif") | [DC30 Release](https://github.com/kyleavery/AceLdr/commit/7699e24632c1b297384fd110a495afc3ffed9f8f "DC30 Release") | 4 years agoAug 10, 2022 |
| [example.profile](https://github.com/kyleavery/AceLdr/blob/main/example.profile "example.profile") | [example.profile](https://github.com/kyleavery/AceLdr/blob/main/example.profile "example.profile") | [c2 profile example (](https://github.com/kyleavery/AceLdr/commit/d4de14439338071527f9e0491d8947c381801a74 "c2 profile example (#4)") [#4](https://github.com/kyleavery/AceLdr/issues/4) [)](https://github.com/kyleavery/AceLdr/commit/d4de14439338071527f9e0491d8947c381801a74 "c2 profile example (#4)") | 4 years agoAug 16, 2022 |
| View all files |

## Repository files navigation

# AceLdr - Avoid Memory Scanners

[Permalink: AceLdr - Avoid Memory Scanners](https://github.com/kyleavery/AceLdr#aceldr---avoid-memory-scanners)

A position-independent reflective loader for Cobalt Strike. Zero results from [Hunt-Sleeping-Beacons](https://github.com/thefLink/Hunt-Sleeping-Beacons), [BeaconHunter](https://github.com/3lp4tr0n/BeaconHunter), [BeaconEye](https://github.com/CCob/BeaconEye), [Patriot](https://github.com/joe-desimone/patriot), [Moneta](https://github.com/forrest-orr/moneta), [PE-sieve](https://github.com/hasherezade/pe-sieve), or [MalMemDetect](https://github.com/waldo-irc/MalMemDetect).
[![AceLdr Demo](https://github.com/kyleavery/AceLdr/raw/main/demo.gif)](https://github.com/kyleavery/AceLdr/blob/main/demo.gif)[![AceLdr Demo](https://github.com/kyleavery/AceLdr/raw/main/demo.gif)](https://github.com/kyleavery/AceLdr/blob/main/demo.gif)[Open AceLdr Demo in new window](https://github.com/kyleavery/AceLdr/blob/main/demo.gif)

## Features

[Permalink: Features](https://github.com/kyleavery/AceLdr#features)

#### Easy to Use

[Permalink: Easy to Use](https://github.com/kyleavery/AceLdr#easy-to-use)

Import a single CNA script before generating shellcode.

#### Dynamic Memory Encryption

[Permalink: Dynamic Memory Encryption](https://github.com/kyleavery/AceLdr#dynamic-memory-encryption)

Creates a new heap for any allocations from Beacon and encrypts entries before sleep.

#### Code Obfuscation and Encryption

[Permalink: Code Obfuscation and Encryption](https://github.com/kyleavery/AceLdr#code-obfuscation-and-encryption)

Changes the memory containing CS executable code to non-executable and encrypts it (FOLIAGE).

#### Return Address Spoofing at Execution

[Permalink: Return Address Spoofing at Execution](https://github.com/kyleavery/AceLdr#return-address-spoofing-at-execution)

Certain WinAPI calls are executed with a spoofed return address (InternetConnectA, NtWaitForSingleObject, RtlAllocateHeap).

#### Sleep Without Sleep

[Permalink: Sleep Without Sleep](https://github.com/kyleavery/AceLdr#sleep-without-sleep)

Delayed execution using WaitForSingleObjectEx.

#### RC4 Encryption

[Permalink: RC4 Encryption](https://github.com/kyleavery/AceLdr#rc4-encryption)

All encryption performed with SystemFunction032.

## Known Issues

[Permalink: Known Issues](https://github.com/kyleavery/AceLdr#known-issues)

- Not compatible with loaders that rely on the shellcode thread staying alive.

## References

[Permalink: References](https://github.com/kyleavery/AceLdr#references)

This project would not have been possible without the following:

- [FOLIAGE](https://github.com/secidiot/FOLIAGE)
- [x64 return address spoofing (source + explanation)](https://www.unknowncheats.me/forum/anti-cheat-bypass/268039-x64-return-address-spoofing-source-explanation.html)

Other features and inspiration were taken from the following:

- [https://www.arashparsa.com/bypassing-pesieve-and-moneta-the-easiest-way-i-could-find/](https://www.arashparsa.com/bypassing-pesieve-and-moneta-the-easiest-way-i-could-find/)
- [https://github.com/secidiot/TitanLdr](https://github.com/secidiot/TitanLdr)
- [https://github.com/JLospinoso/gargoyle](https://github.com/JLospinoso/gargoyle)
- [https://www.forrest-orr.net/post/masking-malicious-memory-artifacts-part-ii-insights-from-moneta](https://www.forrest-orr.net/post/masking-malicious-memory-artifacts-part-ii-insights-from-moneta)
- [https://www.arashparsa.com/hook-heaps-and-live-free/](https://www.arashparsa.com/hook-heaps-and-live-free/)
- [https://blog.f-secure.com/hunting-for-gargoyle-memory-scanning-evasion/](https://blog.f-secure.com/hunting-for-gargoyle-memory-scanning-evasion/)
- [https://www.elastic.co/blog/detecting-cobalt-strike-with-memory-signatures](https://www.elastic.co/blog/detecting-cobalt-strike-with-memory-signatures)

## About

Cobalt Strike UDRL for memory scanner evasion.


### Resources

[Readme](https://github.com/kyleavery/AceLdr#readme-ov-file)

### License

[MIT license](https://github.com/kyleavery/AceLdr#MIT-1-ov-file)

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/kyleavery/AceLdr).

[Activity](https://github.com/kyleavery/AceLdr/activity)

### Stars

[**1k**\\
stars](https://github.com/kyleavery/AceLdr/stargazers)

### Watchers

[**15**\\
watching](https://github.com/kyleavery/AceLdr/watchers)

### Forks

[**177**\\
forks](https://github.com/kyleavery/AceLdr/forks)

[Report repository](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fkyleavery%2FAceLdr&report=kyleavery+%28user%29)

## [Releases\  2](https://github.com/kyleavery/AceLdr/releases)

[v0.2\\
Latest\\
\\
on Sep 28, 2023Sep 28, 2023](https://github.com/kyleavery/AceLdr/releases/tag/v0.2)

[\+ 1 release](https://github.com/kyleavery/AceLdr/releases)

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/kyleavery/AceLdr).

## [Contributors\  2](https://github.com/kyleavery/AceLdr/graphs/contributors)

- [![@kyleavery](https://avatars.githubusercontent.com/u/9327972?s=64&v=4)](https://github.com/kyleavery)[**kyleavery** Kyle Avery](https://github.com/kyleavery)
- [![@CCob](https://avatars.githubusercontent.com/u/3064210?s=64&v=4)](https://github.com/CCob)[**CCob** Ceri Coburn](https://github.com/CCob)

## Languages

- [C99.3%](https://github.com/kyleavery/AceLdr/search?l=c)
- Other0.7%

You can’t perform that action at this time.