Title:
DreamWalkers — Reflective Loader With Registered Unwind Metadata for Clean Call Stacks

Type:
Blog Post

Short Summary (4–8 sentences max):
- DreamWalkers describes a reflective shellcode loader design that preserves believable x64 call stacks even when executing from reflectively loaded (non-standard) modules.  
- The core problem addressed is that typical call stack spoofing breaks in reflective contexts because Windows stack unwinding can’t find valid unwind metadata (.pdata / RUNTIME_FUNCTION) for code that isn’t registered with the loader, causing EDR/debuggers to show broken stacks.  
- The key technique is parsing the in-memory PE and manually registering unwind info using `RtlAddFunctionTable`, enabling `RtlLookupFunctionEntry`/unwinding to work for the reflectively loaded code.  
- The post also covers making MemoryModule position-independent, building a Donut-like shellcode generator/stub, adding custom command-line support, and handling .NET payloads via an intermediate CLR-hosting DLL (plus basic ETW patching).  
- It further combines the unwind-registration approach with module stomping to make the in-memory image appear backed by a legitimate module while still unwinding correctly.  
- Useful for red teamers, implant/tooling developers, and researchers studying stack-walking/EDR visibility and reflective loading tradeoffs.

Technical Focus:
- x64 stack unwinding internals (.pdata, RUNTIME_FUNCTION, unwind metadata)
- `RtlAddFunctionTable` / `RtlLookupFunctionEntry` / stack walking behavior
- Position-independent (PIC) reflective PE loading (MemoryModule-style)
- Shellcode stub generation and manual API resolution (PEB walking)
- Call stack spoofing + module stomping interaction
- .NET in-memory execution via custom CLR hosting (intermediate loader DLL)

Use Cases:
- Building reflective loaders that maintain “clean” call stacks under EDR/debugger scrutiny
- Researching/demonstrating why stack spoofing fails in unregistered in-memory modules
- Generating configurable shellcode loaders (args passing, EXE/DLL loading, .NET support)
- Combining module stomping with correct unwind registration for more plausible telemetry
- Prototyping evasive execution chains that reduce anomalous stack traces

Keywords:
DreamWalkers, reflective loader, MemoryModule, Donut, call stack spoofing, stack unwinding, x64 unwind info, .pdata, RUNTIME_FUNCTION, RtlAddFunctionTable, RtlLookupFunctionEntry, RtlVirtualUnwind, PEB walking, manual GetProcAddress, position-independent code, shellcode generator, module stomping, CLR hosting, Being-A-Good-CLR-Host, ETW patching