Title:
LdrLibraryEx — Minimal x64 in-memory DLL loader (ntdll-only)

Type:
GitHub Tool

Short Summary (4–8 sentences max):
LdrLibraryEx is a small x64 library that manually maps PE/DLL images either from disk or from an in-memory buffer, aiming to emulate key parts of the Windows loader with minimal dependencies (only ntdll). It supports common loader features such as delayed imports, TLS callbacks, SEH, and API set resolution (Win10+). A notable option maps images into private (unbacked) memory to bypass kernel image-load notification callbacks (e.g., PsSetLoadImageNotifyRoutine), which some EDRs use for telemetry. The project exposes a simple `LdrLibrary` API plus an extended `LdrLibraryEx` context that allows hooking/overriding loader-related routines to alter mapping behavior. It’s primarily useful for red teamers, malware developers, and researchers studying Windows loader internals and manual mapping tradeoffs. The author notes it’s optimized for x86_64 MinGW and may not compile under Visual Studio, and it’s archived/read-only.

Technical Focus:
- Manual PE mapping / reflective DLL loading (x64)
- NTDLL-based loader primitives and minimal WinAPI usage
- API Set schema resolution (api-ms-win-*.dll)
- Bypassing image-load callbacks via private/unbacked memory mapping
- Handling PE features: delayed imports, TLS, SEH, entrypoint control
- Loader behavior customization via hookable context (LdrLibraryEx)

Use Cases:
- In-memory loading of tooling modules without standard `LoadLibrary` paths
- Researching/replicating Windows loader behavior for PE mapping
- Evasion experiments against telemetry based on image-load notifications
- Building custom loaders for implants or post-exploitation frameworks
- Testing defensive detections around manual mapping and private mappings

Keywords:
manual mapping, reflective loader, PE loader, DLL in-memory load, ntdll, LdrLoadDll, API set, api-ms-win, PsSetLoadImageNotifyRoutine, image load callbacks, private memory mapping, unbacked memory, TLS callbacks, delayed imports, SEH, entrypoint suppression, x64, MinGW, Windows internals, EDR telemetry