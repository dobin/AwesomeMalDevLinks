Title:
Crystal Kit (Crystal-Kit) — Crystal Palace PICO-based evasion primitives for Cobalt Strike

Type:
GitHub Tool

Short Summary (4–8 sentences max):
Crystal Kit is an evasion kit for Cobalt Strike that experiments with replacing built-in evasion primitives (Sleepmask/BeaconGate) using a Crystal Palace PICO. It targets advanced evasion scenarios by shifting key beacon behaviors into a custom PICO implementation rather than relying on stock CS mechanisms that may be well-profiled by EDR. The repo includes multiple loaders (standard, local, and post-ex) plus an Aggressor script (`crystalkit.cna`) to integrate with the CS client workflow. Usage involves disabling CS sleepmask and stage obfuscation in Malleable C2, adding `crystalpalace.jar` to the client, and loading the CNA script. It’s primarily useful for red teams and offensive security researchers evaluating alternative in-memory tradecraft and detection resistance. It’s interesting as a practical feasibility test of swapping core beacon evasion components with a modular PICO approach.

Technical Focus:
- Cobalt Strike evasion primitives (Sleepmask, BeaconGate) replacement
- Crystal Palace PICO integration and tradecraft modularity
- Loader development (standard/local/post-ex) for in-memory execution
- Malleable C2 configuration changes (stage/post-ex settings)
- API hooking related to WinINet/HTTP (e.g., HttpSendRequestA hook)
- Post-ex DLL compatibility and execution flow

Use Cases:
- Integrate a Crystal Palace PICO to alter/replace beacon evasion behavior
- Test EDR detection differences between stock CS primitives vs custom PICO logic
- Deploy alternative loaders for different execution contexts (local, staged, post-ex)
- Research and prototype new sleep/masking and gating strategies for beacons
- Validate operational compatibility with CS 4.12 and post-ex capabilities

Keywords:
Cobalt Strike, Beacon, evasion, Sleepmask, BeaconGate, Crystal Palace, PICO, Aggressor Script, CNA, Malleable C2, stage obfuscation, post-ex, loader, in-memory execution, API hooking, WinINet, HttpSendRequestA, red team, EDR bypass, tradecraftgarden