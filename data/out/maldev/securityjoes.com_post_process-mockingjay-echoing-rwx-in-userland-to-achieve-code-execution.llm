Title:
Process Mockingjay: Echoing RWX in Userland to Achieve Code Execution

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post presents “Mockingjay,” a Windows process injection approach designed to evade EDR/XDR userland API hooks by avoiding common injection syscalls/APIs (e.g., NtWriteVirtualMemory, NtProtectVirtualMemory).  
- The core idea is to abuse legitimate DLLs that already contain a default RWX PE section, allowing payload placement and execution without allocating new memory, changing protections, or creating a remote thread.  
- The authors describe a filesystem-scanning method to find candidate DLLs and demonstrate a PoC using msys-2.0.dll (bundled with Visual Studio) which has a sizable RWX section and (in their case) no ASLR, enabling stable addressing.  
- Two variants are shown: self-injection (using the RWX section to host code and syscall stubs) and remote injection into a child process (ssh.exe) that loads the vulnerable DLL, where execution occurs as part of normal control flow.  
- The self-injection path also incorporates Hell’s Gate-style syscall stub reconstruction using a clean on-disk NTDLL to bypass inline hooks.  
- It’s useful for red teams and malware developers studying hook evasion and alternative execution primitives, and for defenders as a concrete example of “no-alloc/no-protect/no-thread” injection tradecraft and associated hunting ideas.

Technical Focus:
- Userland EDR inline hooking of NTDLL and syscall interception
- Abusing PE sections with default RWX permissions in trusted DLLs
- Process injection without VirtualAlloc(Ex)/VirtualProtect(Ex)/CreateRemoteThread
- Hell’s Gate syscall stub reconstruction from clean NTDLL on disk
- Remote payload placement via WriteProcessMemory into pre-existing executable memory
- DLL dependency targeting (selecting processes that load the RWX-section DLL)

Use Cases:
- EDR evasion research and development of low-API/noisy-less injection chains
- Red team tradecraft for executing shellcode from existing executable regions
- Threat hunting content: detecting anomalous GNU/ssh.exe activity and suspicious DLL loads
- Auditing enterprise software for misconfigured RWX PE sections and hardening guidance

Keywords:
process injection, Mockingjay, RWX section, PE sections, msys-2.0.dll, Visual Studio 2022, ssh.exe, EDR evasion, XDR, userland hooks, NTDLL.dll, NtProtectVirtualMemory, NtWriteVirtualMemory, Hell’s Gate, syscalls, LoadLibraryW, GetModuleInformation, CreateProcessW, OpenProcess, WriteProcessMemory, MITRE T1055