Title:
Nighthawk 0.2.6 – Three Wise Monkeys

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post announces and explains new evasion and post-exploitation features in MDSec’s Nighthawk C2 (v0.2.6), focused on reducing EDR visibility (“see/hear/speak no evil”).  
- The main addition is API call stack masking to defeat kernel-level call stack telemetry (e.g., ETW Threat Intelligence / kernel call stacks) that can fingerprint syscalls or unbacked memory execution.  
- It argues that direct/indirect syscalls can be more detectable than clean Windows API usage when combined with robust user-mode unhooking, but kernel stack visibility still exposes unbacked frames—hence stack spoofing for all API calls.  
- The release also expands “living off the land” execution by manually mapping local on-host PEs (execute-exe-local) to avoid process creation detections and adds module stomping for PE and COFF/BOF execution to appear disk-backed.  
- Additional operator features include real-time desktop monitoring (screen-watch), a GUI loader generator (NHLoader) with artifact cloning/obfuscation and injection options, and “FireBlock” which uses Windows Filtering Platform rules to block EDR egress rather than loading vulnerable drivers.  
- Useful primarily for red teams/C2 developers evaluating modern EDR telemetry (especially call stack-based detections) and for defenders to understand emerging evasion patterns.

Technical Focus:
- Kernel call stack telemetry & ETW Threat Intelligence (ETW TI) detection
- API call stack spoofing/masking to remove “unbacked memory” frames
- User-mode unhooking vs direct/indirect syscalls tradeoffs
- Manual mapping / in-memory PE execution to avoid process creation telemetry
- Module stomping (disk-backed appearance) for PE and COFF/BOFs
- Windows Filtering Platform (WFP) egress blocking of EDR agents

Use Cases:
- Evading call-stack-based detections during interactive beaconing (sleep 0 scenarios)
- Running LOLBIN-style tooling (e.g., ntdsutil) without spawning new processes
- Executing BOFs/COFFs and PEs with disk-backed stack/module illusions
- Generating customized loaders (EXE/DLL/service) with cloned resources/imports for delivery
- Temporarily suppressing EDR alert reporting by blocking agent network egress via WFP
- Real-time user activity monitoring via periodic screenshot capture

Keywords:
Nighthawk, MDSec, C2, EDR evasion, call stack masking, stack spoofing, ETW Threat Intelligence, kernel call stacks, unbacked memory, user-mode hooks, unhooking, direct syscalls, indirect syscalls, manual mapping, execute-exe-local, process creation telemetry, module stomping, COFF, BOF, Windows Filtering Platform, WFP, Defender for Endpoint, Mimikatz, LSASS, loader, DLL hijacking