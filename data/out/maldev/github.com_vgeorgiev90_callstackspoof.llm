Title:
Windows x64 Call Stack Spoofing (CallStackSpoof)

Type:
GitHub Tool

Short Summary (4–8 sentences max):
- This repository is an educational Windows x64 call stack spoofing implementation in C++ and x64 assembly that constructs synthetic stack frames to make API calls appear to originate from legitimate call chains.  
- It solves the common fragility of “fake stack” approaches by parsing real PE exception/unwind metadata (Exception Directory / RUNTIME_FUNCTION / UNWIND_INFO) and building unwind-consistent frames.  
- The project dynamically discovers and validates a safe jump gadget (e.g., `jmp qword ptr [rbx]`) by checking the gadget’s enclosing function unwind characteristics and rejecting unsafe cases (e.g., frame-pointer based functions).  
- An assembly trampoline pivots to the synthetic stack, invokes the target API without a normal `call`, then restores registers/stack to return cleanly.  
- A PoC demonstrates spoofed calls to `NtAllocateVirtualMemory`, `WriteProcessMemory`, and `CreateThread`, producing a stack that includes `RtlUserThreadStart` and `BaseThreadInitThunk`.  
- Useful for red teamers, malware developers, and Windows internals researchers; also relevant to blue teams studying stack-walk-based detections and their evasion limits.

Technical Focus:
- Windows x64 unwind metadata parsing (IMAGE_DIRECTORY_ENTRY_EXCEPTION, RUNTIME_FUNCTION, UNWIND_INFO/UNWIND_CODE)
- Synthetic stack frame construction aligned with unwinding rules
- Gadget discovery and “unwind-safe” gadget validation
- Assembly trampoline: stack pivot/restore, non-volatile register preservation
- Spoofed API invocation with variadic argument marshaling (x64 calling convention)
- Limitations around UWOP_SET_FPREG, exception-safe unwinding, CFG/CET

Use Cases:
- Building PoCs for stack-walk evasion during indirect syscalls / API execution
- Researching how debuggers/EDRs reconstruct and validate call stacks on x64 Windows
- Creating more realistic execution traces for in-memory loaders (allocation/write/execute chains)
- Testing defensive detections that rely on suspicious call stacks or thread start provenance

Keywords:
Windows x64, call stack spoofing, stack pivot, synthetic frames, PE Exception Directory, IMAGE_DIRECTORY_ENTRY_EXCEPTION, RUNTIME_FUNCTION, UNWIND_INFO, UNWIND_CODE, x64 calling convention, non-volatile registers, RtlUserThreadStart, BaseThreadInitThunk, NtAllocateVirtualMemory, WriteProcessMemory, CreateThread, jump gadget, unwind validation, CFG, CET