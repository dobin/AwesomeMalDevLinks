Title:
Self-Cleaning PICO Loader for Crystal Palace

Type:
GitHub Tool

Short Summary (4–8 sentences max):
This repository provides a position-independent code (PICO) loader variant for the Crystal Palace framework that “self-cleans” by erasing and freeing its own in-memory region after executing a payload. It addresses the common forensic/EDR artifact where injected loaders and RWX regions remain resident in a process after execution. The loader dynamically discovers its own start/end boundaries by using the entrypoint address for the base and an appended empty object/section (`pic_end.o`) as an end marker. It adapts sleep-obfuscation style techniques (Ekko-like timer/ROP-based flow) not to hide during sleep, but to change protections, zero the loader memory, and release it so the process continues without the loader region. The README includes Moneta screenshots comparing default vs self-cleaning behavior to demonstrate reduced in-memory traces. It’s primarily useful for red teams, pentesters, and offensive tool developers working on stealthy in-memory execution; defenders can use it to understand and hunt for self-deleting loader patterns. CFG-enabled targets are noted as requiring a CFG bypass for these ROP/timer-based techniques.

Technical Focus:
- Position-Independent Code (PICO) loaders / Crystal Palace loader spec
- Dynamic self-boundary discovery (start/end address calculation)
- In-memory self-erasure (zeroing + freeing loader region)
- Ekko-inspired timer-based ROP / sleep-obfuscation adaptation
- Memory protection changes (RW/RWX transitions) and artifact reduction
- Control Flow Guard (CFG) constraints and bypass requirement

Use Cases:
- Building in-memory loaders that remove their own footprint post-execution
- Reducing detectable RWX/RW regions left behind after payload run
- Researching/replicating Ekko-style timer/ROP primitives for cleanup actions
- Testing memory forensics tools (e.g., Moneta) against self-deleting implants
- Developing detections for self-modifying/self-freeing injected code patterns

Keywords:
Crystal Palace, PICO loader, position-independent code, in-memory execution, self-cleaning, memory erasure, VirtualProtect, RWX, Moneta, Ekko, sleep obfuscation, timer-based ROP, ROP gadgets, shellcode loader, process injection, CFG, Control Flow Guard bypass, artifact removal, evasive tradecraft