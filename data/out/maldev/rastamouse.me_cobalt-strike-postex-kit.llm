Title:
Cobalt Strike Postex Kit (CS 4.10) – Building Custom Post-Ex Reflective DLL Jobs

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post explains Cobalt Strike 4.10’s new Postex Kit and how it enables operators to build custom post-execution reflective DLLs (rDLLs) that integrate with Beacon’s job architecture.  
- It contrasts inline BOF execution (single-threaded, blocks Beacon) with fork & run rDLL execution (runs in another process/thread, keeps Beacon responsive), including the `spawn` and `explicit` variants.  
- The kit provides a Visual Studio template that handles rDLL bootstrapping (DllMain → `PostexMain` → cleanup) and exposes familiar BOF-style APIs for argument unpacking and output formatting.  
- It details the named-pipe IPC model between Beacon and the injected DLL, including reading operator-sent input at runtime and handling long-running loops safely by detecting broken pipes.  
- It introduces the `execute-dll` command and the `beacon_execute_postex_job` Aggressor function for richer job lifecycle handling, custom callbacks, output control, and sending data to running jobs.  
- Useful for red teamers and tool developers extending Cobalt Strike with long-running or interactive post-ex tasks while leveraging existing CS evasion/injection hooks.

Technical Focus:
- Beacon post-execution models: BOF inline vs fork & run rDLL
- Postex Kit template architecture (DllMain, `PostexMain`, `PostexExit`)
- Named pipe IPC (server in rDLL, client in Beacon) and runtime messaging
- Aggressor scripting job APIs (`beacon_execute_postex_job`, callbacks, `bjob_send_data`)
- Long-running job control and pipe-disconnect detection (`PeekNamedPipe`, `ERROR_BROKEN_PIPE`)
- Integration points with CS evasion/injection (UDRL, Process Inject Kit hooks)

Use Cases:
- Implement long-running Beacon tasks (e.g., keylogger-like loops) without blocking Beacon
- Build interactive post-ex modules that accept operator input during execution
- Create custom job-aware rDLL tooling with structured output/error handling
- Automate parsing of job output into CS data models (e.g., credentials ingestion)
- Customize injection method/UDRL selection via Arsenal Kit hooks

Keywords:
Cobalt Strike 4.10, Postex Kit, Beacon, fork and run, reflective DLL, rDLL, BOF, inline execution, spawn, explicit injection, named pipe, IPC, DllMain, PostexMain, PostexExit, Aggressor Script, beacon_execute_postex_job, execute-dll, bjob_send_data, PeekNamedPipe, ERROR_BROKEN_PIPE, UDRL, Process Inject Kit, jobkill