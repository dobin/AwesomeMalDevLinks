# https://malwaretech.com/2023/12/an-introduction-to-bypassing-user-mode-edr-hooks.html

<!DOCTYPE html><html lang="en" class="hydrated"><body class="is-in"><time datetime="2023-12-25T07:00:00+00:00"></time>
  
   
  
  
   
  
  
  <link rel="alternate" type="application/rss+xml" title="MalwareTech" href="https://malwaretech.com/feed.xml">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Caveat:700%7CBarlow:400,500,600,700&amp;display=swap" rel="stylesheet">
  
  
  <link href="https://malwaretech.com/css/fontawesome.css" rel="stylesheet">
  <link href="https://malwaretech.com/css/all.css" rel="stylesheet">
  
  <!-- Ionicons -->
  
  
  
  
  

  



  <!-- begin header -->

<!-- end header -->

<div class="search">
  <div class="container">
    <div class="row">
      <div class="col col-12">
        <div class="search__box">
          <div class="search__close">
            <ion-icon title="Close" name="close-outline" role="img" class="md hydrated"><div class="icon-inner"><svg xmlns="http://www.w3.org/2000/svg" class="s-ion-icon"></svg></div></ion-icon>
          </div>
          <div class="search__group">
            <label for="js-search-input" class="screen-reader-text">Search for Blog</label>
            <input type="text" id="js-search-input" class="search__text" autocomplete="off" placeholder="Type to search...">
          </div>
          <div id="js-results-container" class="search-results-list"></div>
        </div>
      </div>
    </div>
  </div>
</div>

  <!-- begin content -->
  <main class="content" aria-label="Content">
    <!-- begin hero -->
<div class="container">
  <div class="row">
    <div class="col col-12">
      <div class="hero section">
        <div class="hero__nav">
  <div class="menu-overlay">
    
  </div>
  
</div>
        <div class="hero__inner">
          
        </div>
      </div>
    </div>
  </div>
</div>
<div class="container">
  <div class="row">
    <div class="col col-12 mt-2 mb-2">
      <a href="https://www.threatlocker.com/ztw26?utm_source=malwaretech&amp;utm_medium=sponsor&amp;utm_campaign=zerotrustworld26_q1_26&amp;utm_content=zerotrustworld26&amp;utm_term=display">
        <img class="banner-img xlarge" src="https://malwaretech.com/images/brands/ztw.jpg">
        <img class="banner-img large" src="https://malwaretech.com/images/brands/ztw.jpg">
      </a>
    </div>
  </div>
</div>
<!-- end hero -->

<div class="container">
  <div class="row">
    <div class="col col-8 col-d-12">
      <!-- begin post -->
      <article class="post section">

        <div class="post-head">
          <div class="post__meta">
            <span class="post__date">
              <time datetime="2023-12-25T07:00:00+00:00">Dec 25, 2023</time>
            </span>
            
            <div class="post-tags">
              
              <a href="https://malwaretech.com/tag/programming" class="post-tags__tag">Programming</a>
              
              <a href="https://malwaretech.com/tag/windows-internals" class="post-tags__tag">Windows Internals</a>
              
              <a href="https://malwaretech.com/tag/malware" class="post-tags__tag">Malware</a>
              
            </div>
            
          </div>
          <h1 class="post-title">An Introduction to Bypassing User Mode EDR Hooks</h1>

          <div class="post__author">
            
            <a href="https://marcushutchins.com/" class="article__author-image" style="background-image: url(/images/profile.png);" aria-label="Marcus Hutchins's Picture"></a>
            
            <div class="post__author-footer">
              <a href="https://marcushutchins.com/" class="article__author-link">Marcus Hutchins</a>
            </div>
          </div>
        </div>

        <div class="post__content">
          <h1 id="a-trip-back-in-time">A Trip Back In Time</h1>
<p>Recently I got back into malware research and was going through some of my old notes for an article I’m writing.
While cross-referencing notes against old blog posts, I realized that I never actually published the majority of my work on system calls and user mode hooking.
Since my next article will require that readers be familiar with both concepts, I decided to take the time to polish up and publish the rest of my research.
And hey, who’s to turn down a free extra blog post?</p>

<p>Whilst this article is designed to stand on its own, if you’re interested, you can find my previous articles on these topics <a href="https://malwaretech.com/2015/01/inline-hooking-for-programmers-part-1.html">here</a>, <a href="https://malwaretech.com/2015/04/intercepting-all-system-calls-by.html">here</a>, <a href="https://malwaretech.com/2014/10/usermode-sandboxing.html">here</a> and <a href="https://malwaretech.com/2015/07/windows-10-system-call-stub-changes.html">here</a>.
Surprisingly, despite all this research being over a decade old, it’s still completely relevant today. The more things change, the more they stay the same, I guess?</p>

<h1 id="what-is-a-syscall">What Is a Syscall</h1>
<p>System calls are the standard way to transition from user mode to kernel mode.
They are the modern, faster, version of software interrupts.</p>

<p>The system call interface is extremely complex, but since most of it isn’t relevant to what we’re doing I’m just going to give a higher level summary.
For the most part, you won’t really need an in-depth understanding of how it works to utilize these techniques, but it can be helpful to know.</p>

<p>On Windows, the kernel has a table of functions that are allowed to be called from user mode. 
These functions are sometimes referred to as System Services, Native function, or Nt Functions.
They are the functions that begin with Nt or Zw and are located in ntoskrnl.exe.
The table of system services is known as the System Service Descriptor Table, or SSDT for short.</p>

<p>To call a system service from user mode a system call must be performed, which is done via the <code class="language-plaintext highlighter-rouge">syscall</code> instruction.
The application tells the kernel which system service it wants to call by storing its ID into the eax register.
The System Service ID (often called a System Service Number, System Call Number, or simply SSN), is the index of the function’s entry within the SSDT.
So, setting eax to 0 will call the first function in the SSDT, 1 will call the second, 2 will call the third, and so on…</p>

<p>the lookup looks something like this <code class="language-plaintext highlighter-rouge">entry = nt!KiServiceTable+(SSN * 4)</code>.</p>

<p>The syscall instruction causes the CPU to switch into kernel mode and invoke the system call handler, which takes the SSN from the eax register and calls the corresponding SSDT function.</p>

<p>Let’s say an application calls the <code class="language-plaintext highlighter-rouge">OpenProcess()</code> function from kernel32.dll to open a handle to a process.</p>

<p><img src="https://malwaretech.com/images/syscalls/open_process_k32.png" alt="" data-action="zoom">
<em>A disassembly of kernel32!OpenProcess().</em></p>

<p>As you can see, all the function really does is set up a call to <code class="language-plaintext highlighter-rouge">NtOpenProcess()</code>, which is located in ntdll.dll.</p>

<p>Now, let’s take a look at the <code class="language-plaintext highlighter-rouge">NtOpenProcess()</code> logic.</p>

<p><img src="https://malwaretech.com/images/syscalls/open_process_ntdll.png" alt="" data-action="zoom">
<em>A disassembly of ntdll!OpenProcess().</em></p>

<p>Inside <code class="language-plaintext highlighter-rouge">NtOpenProcess()</code>, there’s hardly any code at all. 
This is because like all functions beginning with Nt or Zw, <code class="language-plaintext highlighter-rouge">NtOpenProcess()</code> is actually located in the kernel. 
The ntdll (user mode) versions of these functions simply perform syscalls to call their kernel mode counterparts, which is why they’re often referred to as system call stubs.</p>

<p>In our case, the SSN for NtOpenProcess is 0x26, but this number changes across Windows version so don’t expect it to be the same for you.</p>

<p>From a simplified high-level view, the call flow looks somewhat like this:</p>

<p><img src="https://malwaretech.com/images/syscalls/windows_call_flow.png" alt="" data-action="zoom">
<em>A simplified x64 system call flow.</em></p>

<p>Here is a more detailed overview of an x86 system call flow from a previous article.</p>

<p><img src="https://malwaretech.com/images/syscalls/x86_syscall_flow.png" alt="" data-action="zoom">
<em>A more detailed x86 system call flow.</em></p>

<p>Note: from user mode, both the Nt and Zw version of a function are identical. From kernel mode the Zw function takes a slightly different path. This is due to the fact that Nt functions are designed to be called from user mode, therefore do more extensive validation of function parameters.</p>

<h1 id="edrs-and-user-mode-hooking">EDRs and User Mode Hooking</h1>
<p>Since Microsoft introduced Kernel Patch Protection (aka PatchGuard) in 2005, many modifications to the kernel are now prevented.
Previously, security products monitored user mode calls from inside the kernel by hooking the SSDT.
Since all Nt/Zw functions are implemented in the kernel, all user mode calls must go through the SSDT, and are therefore subject to SSDT hooks.
Patch guard makes SSDT hooking off-limits, so many EDRs resorted to hooking ntdll.</p>

<p><img src="https://malwaretech.com/images/syscalls/pre_vs_post_ssdt_hooks.png" alt="" data-action="zoom">
<em>A look at where security products place hooks before and after patch guard.</em></p>

<p>Since the SSDT exists in the kernel, user mode applications were not able to interfere with these hooks without loading a kernel driver. Now, the hooks are placed in user mode, alongside the application.</p>

<p>So, what does a user mode hook look like?</p>

<p><img src="https://malwaretech.com/images/syscalls/hook_before_vs_after.png" alt="" data-action="zoom">
<em>An example of a ntdll function before and after hooking.</em></p>

<p>To hook a function in ntdll.dll, most EDRs just overwrite the first 5 bytes of the function’s code with a jmp instruction.
The jmp instruction will redirect code execution to some code within the EDR’s own DLL (which is automatically loaded into every process).
After the CPU has been redirected to the EDR’s DLL, the EDR can perform security checks by inspecting the function parameters and return address.
Once the EDR is done, it can resume the ntdll call by executing the overwritten instructions, then jumping to the location in ntdll right after the hook (jmp instruction).</p>

<p><img src="https://malwaretech.com/images/syscalls/edr_hook_flow.png" alt="" data-action="zoom">
<em>Control flow example for hooked ntdll function.</em></p>

<p>In the above example, NtWriteFile is hooked. The green instructions are the original instructions from NtWriteFile. 
The first 3 instructions of NtWriteFile have been overwritten by the EDR’s hook (a jmp that redirects execution to a function named NtWriteFile in edr.dll).
Whenever the EDR wants to call the real NtWriteFile, it executes the 3 overwritten instructions, then jumps to the 4th instruction of the hooked function to complete the syscall.</p>

<p>Whilst EDR hooks may vary slightly from vendor to vendor, the principal is still the same, and all share the same weakness: they’re located in user mode.
Since both the hooks and the EDR’s DLL have to be placed inside every process’s address space, a malicious process can tamper with them.</p>

<h1 id="bypassing-edr-hooks">Bypassing EDR Hooks</h1>
<p>There are a multitude of ways to bypass EDR hooks, so I’ll cover just the main ones.</p>

<h2 id="edr-unhooking">EDR Unhooking</h2>
<p>Since the hooked ntdll is located in our own process’s memory, we can use <code class="language-plaintext highlighter-rouge">VirtualProtect()</code> to make the memory writable, then overwrite the EDR’s jmp instruction with the original function code.
In order to replace the hooks, we’ll of course need to know what the original assembly instructions were.
The most common way to do this is by reading the ntdll.dll file from disk, then comparing the in-memory version against the disk version.
This assumes the EDR doesn’t detect or prevent manually reading ntdll.dll from disk.</p>

<p>The main drawback of this method is that the EDR could just periodically check the memory of ntdll to see if its hooks have been removed.
If the EDR detects its hooks have been removed, it may write them back, or worse, terminate the process and trigger a detection event.
While the hooks may need to be placed in user mode, checking them can be done from kernel mode, so there’s not much we could do to prevent it.</p>

<h2 id="manually-mapping-dlls">Manually Mapping DLLs</h2>
<p>Instead of reading a clean copy of ntdll from disk to enable us to unhook the original ntdll, we could just load the clean copy into our proccess’s memory and use that instead of the original.
Since functions like <code class="language-plaintext highlighter-rouge">LoadLibrary()</code> and <code class="language-plaintext highlighter-rouge">LdrLoadDll()</code> don’t allow the system to load the same DLL twice, we have to load it manually.
The code for manually mapping DLLs can be extensive and also prone to errors or detection.</p>

<p>DLLs often also perform calls to other DLLs, so we’ll either be restricted to only using functions from our manually loaded ntdll, or loading a second copy of every DLL we need and patching them to only make use of other manually loaded DLLs, which can get pretty messy.
There’s also a good chance of detection if an antivirus does a memory scan and sees multiple copies of every DLL loaded into memory.</p>

<h2 id="direct-syscalls">Direct Syscalls</h2>
<p>As discussed earlier, user mode Nt/Zw functions don’t actually do anything other than execute syscalls. 
So we don’t really need to map an entire new copy of ntdll just to do some syscalls. 
Instead, we can implement the syscall logic directly into our own code.
All we need to do is move the SSN for the function we want to call into the eax register, then execute the syscall instruction.</p>

<p>It’s as simple as</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">__asm</span> <span class="p">{</span>
  <span class="n">mov</span> <span class="n">r10</span><span class="p">,</span> <span class="n">rcx</span>
  <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="mh">0x123</span>
  <span class="n">syscall</span>
  <span class="n">ret</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Unfortunately, because the EDR’s hook typically overwrites the instruction that sets the eax register, we can’t simply just extract it from the hooked function.
But…there’s a few ways we can find out what it is.</p>

<h4 id="reading-a-clean-copy-of-ntdll">Reading a clean copy of ntdll</h4>
<p>You’re probably bored with this idea by now, but we could just read a clean copy of ntdll from disk and extract the SSNs from there.
Since the SSN is always put into the eax register, all we need to do is scan the function we want to call for the <code class="language-plaintext highlighter-rouge">mov eax, imm32</code> instruction.
But, what if we want a method that isn’t just some variation of reading ntdll from disk? Well, do not fear!</p>

<h4 id="calculating-the-system-call-number-based-on-function-order">Calculating the system call number based on function order</h4>
<p>System call ids are indexes, and therefore sequential. 
If the SSN for the function we want to call is 0x18, then the one directly before it will likely be 0x17 and the one directly after, 0x19.
Since the EDR doesn’t hook every Nt function, we can simply grab the SSN from the nearest non-hooked function, then calculate the one we want by adding or subtracting how many functions are between it and our target function.</p>

<p><img src="https://malwaretech.com/images/syscalls/subsequent_system_call_ids.png" alt="" data-action="zoom">
<em>NtAllocateVirtualMemory is hooked by the EDR, but the function before and after it are not. The function before it is system call number 0x17, and the function after it is 0x19. We can easily assume that the SSN we want is 0x18.</em></p>

<p>This method does have one flaw though: we can’t 100% guarantee system call numbers will remain sequential forever, or the DLL won’t skip a few.</p>

<h4 id="hardcoding">Hardcoding</h4>
<p>The simplest method of all, is to just hard code the system call numbers.
Whilst they do change from version to version, they haven’t changed a huge amount in the past. It’s not too much work to detect the OS version and load the correct SSN set.
In fact, j00ru has kindly published a list of <a href="https://j00ru.vexillium.org/syscalls/nt/64/">every system call number for every Windows version</a>.
The only drawback of this method is the code many not automatically work on new Windows version if the system call numbers change.</p>

<h3 id="the-problem-with-direct-syscalls">The problem with direct syscalls</h3>
<p>Direct syscalls have been the go to for bypassing user mode hooks for over a decade. I actually first experimented with this method myself way back in 2012. Unfortunately, much work has been done to try and prevent this kind of bypass.
The most common detection is by having the EDR’s kernel mode driver inspect the callstack.</p>

<p>Although the EDR can no longer hook a lot of places in the kernel, it can use monitoring functionality provided by the operating system, such as:</p>
<ul>
  <li>ETW events</li>
  <li>Kernel Callbacks</li>
  <li>Filter Drivers</li>
</ul>

<p>If we perform a manual syscall, and somewhere along the way the kernel function we call hits any of the above, the EDR could take the opportunity to inspect the callstack of our thread.
By unwinding the call stack and inspecting return addresses, the EDR can see the entire chain of function calls that led to this syscall.</p>

<p>If we were to perform a normal call to, say, <code class="language-plaintext highlighter-rouge">kernel32!VirtualAlloc()</code>, the callstack may look like so:</p>

<p><img src="https://malwaretech.com/images/syscalls/regular_k32_call_unhooked.png" alt="" data-action="zoom">
<em>The callstack of a call to VirtualAlloc().</em></p>

<p>In this case the call to <code class="language-plaintext highlighter-rouge">VirtualAlloc()</code> is initiated by ManualSyscall!main+0x53.
The relevant parts of the callstack in order of call are:</p>
<ol>
  <li>ManualSyscall!main+0x53</li>
  <li>KERNELBASE!VirtualAlloc+0x48</li>
  <li>ntdll!NtAllocateVirtualMemory+0x14</li>
  <li>nt!KiSystemServiceCopyEnd+0x25</li>
</ol>

<p>This tells us (or the EDR) that the executable (ManualSyscall.exe) called <code class="language-plaintext highlighter-rouge">VirtualAlloc()</code>, which called <code class="language-plaintext highlighter-rouge">NtAllocateVirtualMemory()</code>, which then performed a system call to transition into kernel mode.</p>

<p>Now let’s look at the call stack when we do a direct syscall:</p>

<p><img src="https://malwaretech.com/images/syscalls/manual_direct_syscall.png" alt="" data-action="zoom">
<em>the callstack for a direct syscall to NtAllocateVirtualMemory().</em></p>

<p>The relevant parts of this callstack in order are:</p>
<ol>
  <li>ManualSyscall!direct_syscall+0xa</li>
  <li>nt!KiSystemServiceCopyEnd+0x25</li>
</ol>

<p>Here it’s clear the kernel transition was triggered by code inside ManualSyscall.exe and not ntdll. But, what’s the problem with this?</p>

<p>Well, on systems like linux it’s completely normal for application to initiate system calls directly. But remember that I mentioned system call ids change between Windows versions?
As a result it’s highly impractical to write Windows software that relies on direct system calls.
Due to the fact ntdll already implements every system call for you, there’s almost no reason to do a manual syscall. Unless, of course, you’re writing malware to bypass EDR hooks. Are you writing malware to bypass EDR hooks?</p>

<p>Because direct system calls are such a strong indicator of malicious activity, more sophisticated EDRs will log detections for system call that originated outside ntdll.
Truth be told, you can still get away with it a lot of the time, but where’s the fun in that?</p>

<h2 id="indirect-syscalls">Indirect syscalls</h2>
<p>Most EDRs write their hooks at the start of the Nt function, overwriting the SSN but leaving the syscall instruction intact.
This allows us to utilize the syscall instructions already provided by ntdll instead of bringing our own.
We can just set up the r10 and eax registers ourselves, then jump to the syscall instruction inside the hooked ntdll function (which comes after the EDR’s hook).</p>

<p><img src="https://malwaretech.com/images/syscalls/indirect_syscall.png" alt="" data-action="zoom">
<em>Code flow for an indirect syscall.</em></p>

<p>Note: we don’t strictly need the test or jnz instruction, these are just there for backwards compatibility. 
Some ancient CPUs don’t support the syscall instruction and use <code class="language-plaintext highlighter-rouge">int 0x2e</code> instead. 
The test instruction checks if syscalls are enabled, and if not, falls back to software interrupts.
If we wish to support these systems, we could just perform the check ourselves, then jump to the int 0x2e instruction (which is also located within Nt function) if needed.</p>

<p>Just like with direct syscalls, we still need the system call number to put into eax, but we can use all the same techniques previously detailed in the direct syscalls section.</p>

<p>Setting up a system call this way will give us a call stack that look like the following:</p>

<p><img src="https://malwaretech.com/images/syscalls/manual_indirect_syscall.png" alt="" data-action="zoom">
<em>The call stack for an indirect system call.</em></p>

<p>As you can see, the call stack now look as if the call came from the <code class="language-plaintext highlighter-rouge">ntdll!NtAllocateVirtualMemory()</code> insted of our executable, because technically it did.</p>

<p>One issue we could run into is if the EDR hooks or overwrites the syscall instruction part of the Nt call.
I’ve never seen this happen, but it could in theory. 
In this case, we could jump to a syscall instruction inside a different, non-hooked, Nt function.
This would still bypass EDRs which only validate that the call name from ntdll, but would fail any checks verifying that the kernel function called matches the ntdll function the syscall came from.</p>

<p>The larger problem is, what if the EDR checks more than just the first return address.
Not just where the syscall came from, but who called the function that executed the syscall.
If we’re doing indirect syscalls from some shellcode located in dynamically allocated memory, then the EDR is going to see that.
Calls coming from outside a valid PE section (exe or DLL memory) are fairly suspicious.</p>

<p>Furthermore, since the function is hooked by the EDR, the EDR’s hook would be expected to appear in the call stack.
I’m actually not sure which EDRs, if any, check this. But, as you can see here it’s clear from the call stack
that we bypassed the EDR hook.</p>

<p><img src="https://malwaretech.com/images/syscalls/indirect_syscall_vs_hooked_call.png" alt="" data-action="zoom">
<em>The EDR’s hook is visible in the call stack from a regular call but not from an indirect syscall.</em></p>

<p>Ideally, we want to fake more than just the system call return address. 
An interesting solution to this is call stack spoofing, which I’m probably going to cover in a separate article.
With call stack spoofing it’s possible to fake the entire call stack, but it can be challenging to implement without crashing the calling thread.</p>

<p>You can read more about call stack spoofing here:<br>
<a href="https://labs.withsecure.com/publications/spoofing-call-stacks-to-confuse-edrs">Spoofing Call Stacks To Confuse EDRs - WithSecure</a><br>
<a href="https://0xdarkvortex.dev/hiding-in-plainsight/">Long Live Custom Call Stacks - DarkVortex</a></p>

<h1 id="thats-all-for-now">That’s All, For Now</h1>
<p>so there you have it, you now understand the basics of user mode EDR hooks and some common techniques to bypass them. 
This knowledge will be important for my next article, which will go deeper into how EDR hooks work and detail some alternative methods of bypassing them.</p>

<p>Part 2: <a href="https://malwaretech.com/2023/12/silly-edr-bypasses-and-where-to-find-them.html">https://malwaretech.com/2023/12/silly-edr-bypasses-and-where-to-find-them.html</a></p>


        </div>
        
<div class="post__share">
  <div class="share__head">
    <div class="share__title">Share this article</div>
  </div>
  <ul class="share__list list-reset">
    <li class="share__item">
      <a class="share__link share__linkedin" href="https://www.linkedin.com/sharing/share-offsite/?url=https://malwaretech.com/2023/12/an-introduction-to-bypassing-user-mode-edr-hooks.html&amp;title=An%20Introduction%20to%20Bypassing%20User%20Mode%20EDR%20Hooks" title="Share on LinkedIn" rel="nofollow"><i class="fa-brands fa-linkedin"></i><span class="share-name">LinkedIn</span></a>
    </li>
    <ul class="share__list list-reset">
      <li class="share__item">
        <a class="share__link share__linkedin" href="https://bsky.app/intent/compose?text=https://malwaretech.com/2023/12/an-introduction-to-bypassing-user-mode-edr-hooks.html&amp;title=An%20Introduction%20to%20Bypassing%20User%20Mode%20EDR%20Hooks" title="Share on LinkedIn" rel="nofollow"><i class="fa-brands fa-bluesky"></i><span class="share-name">Bluesky</span></a>
      </li>
    </ul>
</ul></div>
        <!--<div class="post__navigation">
  
  <div class="post__prev">
    <a class="prev__image fadein" href="/2023/09/it-might-be-time-to-rethink-phishing-awareness.html"
      style="background-image: url(/images/phishing-awareness/full_cover.png)"></a>
    <div class="prev__box">
      <a class="post__nav post__nav__prev" href="/2023/09/it-might-be-time-to-rethink-phishing-awareness.html"><i class="ion ion-ios-arrow-back"></i> Previous
        Page</a>
      <h4 class="post__nav__title"><a href="/2023/09/it-might-be-time-to-rethink-phishing-awareness.html">It might Be Time to Rethink Phishing Awareness</a></h4>
    </div>
  </div>
  

  
  <div class="post__next">
    <div class="next__box">
      <a class="post__nav post__nav__next" href="/2023/12/silly-edr-bypasses-and-where-to-find-them.html">Next Page <i
          class="ion ion-ios-arrow-forward"></i></a>
      <h4 class="post__nav__title"><a href="/2023/12/silly-edr-bypasses-and-where-to-find-them.html">Silly EDR Bypasses and Where To Find Them</a></h4>
    </div>
    <a class="next__image fadein" href="/2023/12/silly-edr-bypasses-and-where-to-find-them.html"
      style="background-image: url(/images/silly-edr-bypasses-and-where-to-find-them/cover.png)"></a>
  </div>
  
</div>-->

      </article>
      <!-- end post -->
      <!-- begin comments -->
<div id="disqus_thread" class="post__comments section">
  <div class="show-comments animate" style="text-align:center;">
    <button class="button button--dark button--middle" id="show-comments-button">Show Comments</button>
  </div>
  <div id="disqus_empty"></div>
</div>




<!-- end comments -->
    </div>
    <div class="col col-4 col-d-12">
      
<div class="widget-sidebar widget-featured ">
  <div class="widget__head section-top">
    <h4 class="widget__title">Stay Informed</h4>
  </div>
  <div class="row post__meta">
    <div class="col col-12 col-d-12 col-t-12">
      
    </div>
  </div>
</div>

      
<div class="widget-sidebar widget-author">
  
  <div class="widget-image-box">
    <a href="https://marcushutchins.com/" target="_blank" class="widget-author-image" style="background-image: url(/images/profile.png);" aria-label="Marcus Hutchins's Picture"></a>
  </div>
  

  <h5 class="widget-author-name"><a href="https://marcushutchins.com/" target="_blank">Marcus Hutchins</a></h5>
  <div class="widget-author-bio">Threat intelligence analyst, programmer, ex-hacker.</div>

  <div class="widget-author-meta">
    


  </div>
</div>

      


<div class="widget-sidebar widget-featured ">
  <div class="widget__head section-top">
    <h4 class="widget__title">Featured Posts</h4>
  </div>
  
  
  <div class="featured-posts">
    
    <a class="featured-posts__image fadein" href="https://malwaretech.com/2025/10/exif-smuggling.html" style="background-image: url(/images/better-cache-smuggling/cover.png)"></a>
    
    <div class="featured-posts__content">
      <div class="featured-posts__date">
        <time datetime="2025-10-24T19:45:00+00:00">Oct 24, 2025</time>
      </div>
      <h6 class="featured-posts__title"><a href="https://malwaretech.com/2025/10/exif-smuggling.html">Passively Downloading Malware Payloads Via Image Caching</a></h6>
    </div>
  </div>
  
  
  
  <div class="featured-posts">
    
    <a class="featured-posts__image fadein" href="https://malwaretech.com/2025/08/every-reason-why-i-hate-ai.html" style="background-image: url(/images/every-reason-why-i-hate-ai/cover.jpg)"></a>
    
    <div class="featured-posts__content">
      <div class="featured-posts__date">
        <time datetime="2025-08-04T08:12:00+00:00">Aug 4, 2025</time>
      </div>
      <h6 class="featured-posts__title"><a href="https://malwaretech.com/2025/08/every-reason-why-i-hate-ai.html">Every Reason Why I Hate AI and You Should Too</a></h6>
    </div>
  </div>
  
  
  
  <div class="featured-posts">
    
    <a class="featured-posts__image fadein" href="https://malwaretech.com/2025/03/the-us-needs-a-new-cybersecurity-strategy.html" style="background-image: url(/images/the-us-needs-a-new-cybersecurity-strategy/cover.png)"></a>
    
    <div class="featured-posts__content">
      <div class="featured-posts__date">
        <time datetime="2025-03-28T05:23:00+00:00">Mar 28, 2025</time>
      </div>
      <h6 class="featured-posts__title"><a href="https://malwaretech.com/2025/03/the-us-needs-a-new-cybersecurity-strategy.html">The US Needs A New Cybersecurity Strategy: More Offensive Cyber Operations Isn't It</a></h6>
    </div>
  </div>
  
  
  
  <div class="featured-posts">
    
    <a class="featured-posts__image fadein" href="https://malwaretech.com/2024/08/exploiting-CVE-2024-38063.html" style="background-image: url(/images/CVE-2024-38063/cover.png)"></a>
    
    <div class="featured-posts__content">
      <div class="featured-posts__date">
        <time datetime="2024-08-27T06:46:00+00:00">Aug 27, 2024</time>
      </div>
      <h6 class="featured-posts__title"><a href="https://malwaretech.com/2024/08/exploiting-CVE-2024-38063.html">CVE-2024-38063 - Remotely Exploiting The Kernel Via IPv6</a></h6>
    </div>
  </div>
  
  
  
  <div class="featured-posts">
    
    <a class="featured-posts__image fadein" href="https://malwaretech.com/2024/02/bypassing-edrs-with-edr-preload.html" style="background-image: url(/images/bypassing-edrs-with-edr-preload/cover.png)"></a>
    
    <div class="featured-posts__content">
      <div class="featured-posts__date">
        <time datetime="2024-02-13T05:22:00+00:00">Feb 13, 2024</time>
      </div>
      <h6 class="featured-posts__title"><a href="https://malwaretech.com/2024/02/bypassing-edrs-with-edr-preload.html">Bypassing EDRs With EDR-Preloading</a></h6>
    </div>
  </div>
  
  
  
  <div class="featured-posts">
    
    <a class="featured-posts__image fadein" href="https://malwaretech.com/2023/12/silly-edr-bypasses-and-where-to-find-them.html" style="background-image: url(/images/silly-edr-bypasses-and-where-to-find-them/cover.png)"></a>
    
    <div class="featured-posts__content">
      <div class="featured-posts__date">
        <time datetime="2023-12-27T01:40:00+00:00">Dec 27, 2023</time>
      </div>
      <h6 class="featured-posts__title"><a href="https://malwaretech.com/2023/12/silly-edr-bypasses-and-where-to-find-them.html">Silly EDR Bypasses and Where To Find Them</a></h6>
    </div>
  </div>
  
  
  
  <div class="featured-posts">
    
    <a class="featured-posts__image fadein" href="https://malwaretech.com/2023/12/an-introduction-to-bypassing-user-mode-edr-hooks.html" style="background-image: url(/images/syscalls/cover.png)"></a>
    
    <div class="featured-posts__content">
      <div class="featured-posts__date">
        <time datetime="2023-12-25T07:00:00+00:00">Dec 25, 2023</time>
      </div>
      <h6 class="featured-posts__title"><a href="https://malwaretech.com/2023/12/an-introduction-to-bypassing-user-mode-edr-hooks.html">An Introduction to Bypassing User Mode EDR Hooks</a></h6>
    </div>
  </div>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <div class="featured-posts">
    
    <a class="featured-posts__image fadein" href="https://malwaretech.com/2020/12/how-i-found-my-first-ever-zeroday-in-rdp.html" style="background-image: url(/wp-content/uploads/2020/12/thumb-4.png)"></a>
    
    <div class="featured-posts__content">
      <div class="featured-posts__date">
        <time datetime="2020-12-31T23:36:41+00:00">Dec 31, 2020</time>
      </div>
      <h6 class="featured-posts__title"><a href="https://malwaretech.com/2020/12/how-i-found-my-first-ever-zeroday-in-rdp.html">How I Found My First Ever ZeroDay (In RDP)</a></h6>
    </div>
  </div>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <div class="featured-posts">
    
    <a class="featured-posts__image fadein" href="https://malwaretech.com/2018/03/best-programming-languages-to-learn-for-malware-analysis.html" style="background-image: url(/wp-content/uploads/2018/02/documentation.png)"></a>
    
    <div class="featured-posts__content">
      <div class="featured-posts__date">
        <time datetime="2018-03-19T09:44:27+00:00">Mar 19, 2018</time>
      </div>
      <h6 class="featured-posts__title"><a href="https://malwaretech.com/2018/03/best-programming-languages-to-learn-for-malware-analysis.html">Best Languages to Learn for Malware Analysis</a></h6>
    </div>
  </div>
  
  
  
  
  
  
  
  
  
  
  
  <div class="featured-posts">
    
    <a class="featured-posts__image fadein" href="https://malwaretech.com/2017/05/how-to-accidentally-stop-a-global-cyber-attacks.html" style="background-image: url(/wp-content/uploads/2017/05/WannaCrypt.jpg)"></a>
    
    <div class="featured-posts__content">
      <div class="featured-posts__date">
        <time datetime="2017-05-13T12:04:19+00:00">May 13, 2017</time>
      </div>
      <h6 class="featured-posts__title"><a href="https://malwaretech.com/2017/05/how-to-accidentally-stop-a-global-cyber-attacks.html">How to Accidentally Stop a Global Cyber Attacks</a></h6>
    </div>
  </div>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <div class="featured-posts">
    
    <a class="featured-posts__image fadein" href="https://malwaretech.com/2015/04/hard-disk-firmware-hacking-part-1.html" style="background-image: url(/wp-content/uploads/2015/04/HDD_Controller.png)"></a>
    
    <div class="featured-posts__content">
      <div class="featured-posts__date">
        <time datetime="2015-04-13T14:27:00+00:00">Apr 13, 2015</time>
      </div>
      <h6 class="featured-posts__title"><a href="https://malwaretech.com/2015/04/hard-disk-firmware-hacking-part-1.html">Hard Disk Firmware Hacking (Part 1)</a></h6>
    </div>
  </div>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
</div>

      <div class="widget-sidebar widget-tags">
  <div class="widget__head section-top">
    <h4 class="widget__title">Explore Topics</h4>
  </div>
  <div class="widget-tags__inner">
    
    
    <a href="https://malwaretech.com/tag/explainers" class="widget__tag"><h5 class="widget__tag-name">Explainers</h5><span class="widget__tag-count">14</span></a>
    
    
    <a href="https://malwaretech.com/tag/malware" class="widget__tag"><h5 class="widget__tag-name">Malware</h5><span class="widget__tag-count">16</span></a>
    
    
    <a href="https://malwaretech.com/tag/windows-internals" class="widget__tag"><h5 class="widget__tag-name">Windows Internals</h5><span class="widget__tag-count">11</span></a>
    
    
    <a href="https://malwaretech.com/tag/hacking" class="widget__tag"><h5 class="widget__tag-name">Hacking</h5><span class="widget__tag-count">13</span></a>
    
    
    <a href="https://malwaretech.com/tag/vulnerability-research" class="widget__tag"><h5 class="widget__tag-name">Vulnerability Research</h5><span class="widget__tag-count">11</span></a>
    
    
    <a href="https://malwaretech.com/tag/news" class="widget__tag"><h5 class="widget__tag-name">News</h5><span class="widget__tag-count">10</span></a>
    
    
    <a href="https://malwaretech.com/tag/analysis" class="widget__tag"><h5 class="widget__tag-name">Analysis</h5><span class="widget__tag-count">10</span></a>
    
    
    <a href="https://malwaretech.com/tag/malware-analysis" class="widget__tag"><h5 class="widget__tag-name">Malware Analysis</h5><span class="widget__tag-count">16</span></a>
    
    
    <a href="https://malwaretech.com/tag/programming" class="widget__tag"><h5 class="widget__tag-name">Programming</h5><span class="widget__tag-count">4</span></a>
    
    
    <a href="https://malwaretech.com/tag/threat-intelligence" class="widget__tag"><h5 class="widget__tag-name">Threat Intelligence</h5><span class="widget__tag-count">13</span></a>
    
    
    <a href="https://malwaretech.com/tag/opinions" class="widget__tag"><h5 class="widget__tag-name">Opinions</h5><span class="widget__tag-count">12</span></a>
    
    
    <a href="https://malwaretech.com/tag/stories" class="widget__tag"><h5 class="widget__tag-name">Stories</h5><span class="widget__tag-count">3</span></a>
    
    
    <a href="https://malwaretech.com/tag/wannacry" class="widget__tag"><h5 class="widget__tag-name">WannaCry</h5><span class="widget__tag-count">2</span></a>
    
    
    <a href="https://malwaretech.com/tag/videos" class="widget__tag"><h5 class="widget__tag-name">Videos</h5><span class="widget__tag-count">3</span></a>
    
    
    <a href="https://malwaretech.com/tag/artificial-intelligence" class="widget__tag"><h5 class="widget__tag-name">Artificial Intelligence</h5><span class="widget__tag-count">1</span></a>
    
    
    <a href="https://malwaretech.com/tag/technology" class="widget__tag"><h5 class="widget__tag-name">Technology</h5><span class="widget__tag-count">1</span></a>
    
    
    <a href="https://malwaretech.com/tag/offensive-security" class="widget__tag"><h5 class="widget__tag-name">Offensive Security</h5><span class="widget__tag-count">1</span></a>
    
  </div>
</div>
    </div>
  </div>
</div>







<div class="container">
  <div class="related-posts section is-related">
    <div class="section-top">
      <h5 class="section-title">You may also like</h5>
    </div>
    <div class="row grid">
    

      
      

      

      

        <div class="article col col-4 col-d-6 col-t-12 grid__post">
          
          <a class="article__image" href="https://malwaretech.com/2025/10/exif-smuggling.html">
            
            <span class="featured-post"><i class="ion ion-ios-star-outline"></i></span>
            
            <img class="fadein" src="https://malwaretech.com/images/better-cache-smuggling/cover.png" alt="Passively Downloading Malware Payloads Via Image Caching">
          </a>
          
        
          <div class="article__content">
            <div class="article-tags">
              <span class="article__date"><time datetime="2025-10-24T19:45:00+00:00">Oct 24, 2025</time></span>
              
              <div class="article-tags__box">
                
                <a href="https://malwaretech.com/tag/offensive-security" class="article__tag">Offensive Security</a>
                
                <a href="https://malwaretech.com/tag/windows-internals" class="article__tag">Windows Internals</a>
                
                <a href="https://malwaretech.com/tag/malware" class="article__tag">Malware</a>
                
              </div>
              
            </div>
            <h2 class="article__title">
              <a href="https://malwaretech.com/2025/10/exif-smuggling.html">Passively Downloading Malware Payloads Via Image Caching</a>
            </h2>
            <div class="article__meta">
              <div class="article__author">
                
              </div>
            </div>
          </div>
        </div>

        
        
      
    

      
      

      

      
    

      
      

      

      
    

      
      

      

      

        <div class="article col col-4 col-d-6 col-t-12 grid__post">
          
          <a class="article__image" href="https://malwaretech.com/2024/08/exploiting-CVE-2024-38063.html">
            
            <span class="featured-post"><i class="ion ion-ios-star-outline"></i></span>
            
            <img class="fadein" src="https://malwaretech.com/images/CVE-2024-38063/cover.png" alt="CVE-2024-38063 - Remotely Exploiting The Kernel Via IPv6">
          </a>
          
        
          <div class="article__content">
            <div class="article-tags">
              <span class="article__date"><time datetime="2024-08-27T06:46:00+00:00">Aug 27, 2024</time></span>
              
              <div class="article-tags__box">
                
                <a href="https://malwaretech.com/tag/vulnerability-research" class="article__tag">Vulnerability Research</a>
                
                <a href="https://malwaretech.com/tag/windows-internals" class="article__tag">Windows Internals</a>
                
              </div>
              
            </div>
            <h2 class="article__title">
              <a href="https://malwaretech.com/2024/08/exploiting-CVE-2024-38063.html">CVE-2024-38063 - Remotely Exploiting The Kernel Via IPv6</a>
            </h2>
            <div class="article__meta">
              <div class="article__author">
                
              </div>
            </div>
          </div>
        </div>

        
        
      
    

      
      

      

      

        <div class="article col col-4 col-d-6 col-t-12 grid__post">
          
          <a class="article__image" href="https://malwaretech.com/2024/02/bypassing-edrs-with-edr-preload.html">
            
            <span class="featured-post"><i class="ion ion-ios-star-outline"></i></span>
            
            <img class="fadein" src="https://malwaretech.com/images/bypassing-edrs-with-edr-preload/cover.png" alt="Bypassing EDRs With EDR-Preloading">
          </a>
          
        
          <div class="article__content">
            <div class="article-tags">
              <span class="article__date"><time datetime="2024-02-13T05:22:00+00:00">Feb 13, 2024</time></span>
              
              <div class="article-tags__box">
                
                <a href="https://malwaretech.com/tag/programming" class="article__tag">Programming</a>
                
                <a href="https://malwaretech.com/tag/windows-internals" class="article__tag">Windows Internals</a>
                
                <a href="https://malwaretech.com/tag/malware" class="article__tag">Malware</a>
                
              </div>
              
            </div>
            <h2 class="article__title">
              <a href="https://malwaretech.com/2024/02/bypassing-edrs-with-edr-preload.html">Bypassing EDRs With EDR-Preloading</a>
            </h2>
            <div class="article__meta">
              <div class="article__author">
                
              </div>
            </div>
          </div>
        </div>

        
        
          
    </div>
  </div>
</div>
  </main> 
  <!-- end content -->
  
  
  <!-- begin footer -->

<!-- end footer -->
  










<div height="1" width="1" style="position: absolute; top: 0px; left: 0px; border: none; visibility: hidden;" data-original-tag="iframe"></div>

</body></html>