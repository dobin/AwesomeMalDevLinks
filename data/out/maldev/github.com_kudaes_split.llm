Title:
Split — Divide-and-Conquer Remote Process Injection to Confuse EDRs

Type:
GitHub Tool

Short Summary (4–8 sentences max):
Split is a Rust proof-of-concept that applies a “divide and conquer” strategy to EDR evasion by splitting a classic remote process injection chain across multiple processes. Instead of performing NtOpenProcess → NtAllocateVirtualMemory → NtWriteVirtualMemory → NtProtectVirtualMemory → NtCreateThreadEx in a single process, it forks the current process via NtCreateUserProcess after each step so each action occurs in a different process context. Because the forked process inherits memory/handles and continues execution at RIP+1, the injection can proceed while reducing the likelihood that an EDR correlates the full sequence as a single malicious behavior. The author reports that without forking, 2/3 tested EDRs (MDE, CrowdStrike, SentinelOne) alerted on remote injection, while with forking none alerted, despite telemetry still showing cross-process activity. The repo also includes string-literal obfuscation via LITCRYPT (used for Dinvoke_rs-related strings) and notes multiple OPSEC limitations (no syscalls, no unhooking, ETW not patched, plaintext shellcode). It’s primarily useful for red teamers and offensive tool developers exploring behavioral-correlation weaknesses in EDR detections.

Technical Focus:
- Remote process injection via NTAPI (NtOpenProcess, NtAllocateVirtualMemory, NtWriteVirtualMemory, NtProtectVirtualMemory, NtCreateThreadEx)
- Process forking/creation with NtCreateUserProcess and handle inheritance
- Behavioral evasion by breaking attack chains into multiple processes (correlation disruption)
- Rust implementation and dynamic invocation (DInvoke-style)
- String literal obfuscation with LITCRYPT
- EDR telemetry vs alerting gaps (MDE, CrowdStrike, SentinelOne)

Use Cases:
- Testing whether an EDR correlates multi-step injection chains across process boundaries
- Building/experimenting with “split execution” tradecraft for staged operations
- Researching detection engineering improvements for cross-process correlation
- Creating lab PoCs to compare alerting with/without process-splitting

Keywords:
Windows, Rust, EDR evasion, divide and conquer, process injection, remote thread, NTAPI, NtCreateUserProcess, NtOpenProcess, NtAllocateVirtualMemory, NtWriteVirtualMemory, NtProtectVirtualMemory, NtCreateThreadEx, handle inheritance, fork, DInvoke, LITCRYPT, behavioral detection, correlation, Microsoft Defender for Endpoint, CrowdStrike, SentinelOne