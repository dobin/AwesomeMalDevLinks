# https://github.com/trustedsec/CS-Situational-Awareness-BOF

[Skip to content](https://github.com/trustedsec/CS-Situational-Awareness-BOF#start-of-content)

You signed in with another tab or window. [Reload](https://github.com/trustedsec/CS-Situational-Awareness-BOF) to refresh your session.You signed out in another tab or window. [Reload](https://github.com/trustedsec/CS-Situational-Awareness-BOF) to refresh your session.You switched accounts on another tab or window. [Reload](https://github.com/trustedsec/CS-Situational-Awareness-BOF) to refresh your session.Dismiss alert

{{ message }}

[trustedsec](https://github.com/trustedsec)/ **[CS-Situational-Awareness-BOF](https://github.com/trustedsec/CS-Situational-Awareness-BOF)** Public

- [Notifications](https://github.com/login?return_to=%2Ftrustedsec%2FCS-Situational-Awareness-BOF) You must be signed in to change notification settings
- [Fork\\
277](https://github.com/login?return_to=%2Ftrustedsec%2FCS-Situational-Awareness-BOF)
- [Star\\
1.7k](https://github.com/login?return_to=%2Ftrustedsec%2FCS-Situational-Awareness-BOF)


Situational Awareness commands implemented using Beacon Object Files


### License

[GPL-2.0 license](https://github.com/trustedsec/CS-Situational-Awareness-BOF/blob/master/LICENSE)

[1.7k\\
stars](https://github.com/trustedsec/CS-Situational-Awareness-BOF/stargazers) [277\\
forks](https://github.com/trustedsec/CS-Situational-Awareness-BOF/forks) [Branches](https://github.com/trustedsec/CS-Situational-Awareness-BOF/branches) [Tags](https://github.com/trustedsec/CS-Situational-Awareness-BOF/tags) [Activity](https://github.com/trustedsec/CS-Situational-Awareness-BOF/activity)

[Star](https://github.com/login?return_to=%2Ftrustedsec%2FCS-Situational-Awareness-BOF)

[Notifications](https://github.com/login?return_to=%2Ftrustedsec%2FCS-Situational-Awareness-BOF) You must be signed in to change notification settings

# trustedsec/CS-Situational-Awareness-BOF

master

[**3** Branches](https://github.com/trustedsec/CS-Situational-Awareness-BOF/branches) [**4** Tags](https://github.com/trustedsec/CS-Situational-Awareness-BOF/tags)

[Go to Branches page](https://github.com/trustedsec/CS-Situational-Awareness-BOF/branches)[Go to Tags page](https://github.com/trustedsec/CS-Situational-Awareness-BOF/tags)

Go to file

Code

Open more actions menu

## Folders and files

| Name | Name | Last commit message | Last commit date |
| --- | --- | --- | --- |
| ## Latest commit<br>[![freefirex](https://avatars.githubusercontent.com/u/3172440?v=4&size=40)](https://github.com/freefirex)[freefirex](https://github.com/trustedsec/CS-Situational-Awareness-BOF/commits?author=freefirex)<br>[Merge branch 'adcs\_enum\_fix'](https://github.com/trustedsec/CS-Situational-Awareness-BOF/commit/9aa39fcd9b6c25d9b38f779a7b91bab2b41c6864)<br>success<br>last monthJan 5, 2026<br>[9aa39fc](https://github.com/trustedsec/CS-Situational-Awareness-BOF/commit/9aa39fcd9b6c25d9b38f779a7b91bab2b41c6864) · last monthJan 5, 2026<br>## History<br>[451 Commits](https://github.com/trustedsec/CS-Situational-Awareness-BOF/commits/master/) <br>Open commit details<br>[View commit history for this file.](https://github.com/trustedsec/CS-Situational-Awareness-BOF/commits/master/) 451 Commits |
| [.github/workflows](https://github.com/trustedsec/CS-Situational-Awareness-BOF/tree/master/.github/workflows "This path skips through empty directories") | [.github/workflows](https://github.com/trustedsec/CS-Situational-Awareness-BOF/tree/master/.github/workflows "This path skips through empty directories") | [Add github actions build / release of bofs](https://github.com/trustedsec/CS-Situational-Awareness-BOF/commit/a8bc8817af666419ec2b9609636dcecd7c97ee86 "Add github actions build / release of bofs") | 3 months agoNov 10, 2025 |
| [SA](https://github.com/trustedsec/CS-Situational-Awareness-BOF/tree/master/SA "SA") | [SA](https://github.com/trustedsec/CS-Situational-Awareness-BOF/tree/master/SA "SA") | [Merge branch 'ldapsecuritycheck'](https://github.com/trustedsec/CS-Situational-Awareness-BOF/commit/aa9c515e4649763e5b517175fa88b2184bb99191 "Merge branch 'ldapsecuritycheck'") | last monthJan 5, 2026 |
| [src](https://github.com/trustedsec/CS-Situational-Awareness-BOF/tree/master/src "src") | [src](https://github.com/trustedsec/CS-Situational-Awareness-BOF/tree/master/src "src") | [Merge branch 'adcs\_enum\_fix'](https://github.com/trustedsec/CS-Situational-Awareness-BOF/commit/9aa39fcd9b6c25d9b38f779a7b91bab2b41c6864 "Merge branch 'adcs_enum_fix'") | last monthJan 5, 2026 |
| [.gitignore](https://github.com/trustedsec/CS-Situational-Awareness-BOF/blob/master/.gitignore ".gitignore") | [.gitignore](https://github.com/trustedsec/CS-Situational-Awareness-BOF/blob/master/.gitignore ".gitignore") | [Updated .gitignore to ignore .log files](https://github.com/trustedsec/CS-Situational-Awareness-BOF/commit/d2f990cc47110b31d4f6f16cd0b5d09cc7846edd "Updated .gitignore to ignore .log files") | 5 years agoApr 29, 2021 |
| [CONTRIBUTING.md](https://github.com/trustedsec/CS-Situational-Awareness-BOF/blob/master/CONTRIBUTING.md "CONTRIBUTING.md") | [CONTRIBUTING.md](https://github.com/trustedsec/CS-Situational-Awareness-BOF/blob/master/CONTRIBUTING.md "CONTRIBUTING.md") | [Add to Credits and add Contributions guide](https://github.com/trustedsec/CS-Situational-Awareness-BOF/commit/bcf88fe472354d4f9d44c13b659e550f654a978a "Add to Credits and add Contributions guide") | 6 years agoNov 5, 2020 |
| [LICENSE](https://github.com/trustedsec/CS-Situational-Awareness-BOF/blob/master/LICENSE "LICENSE") | [LICENSE](https://github.com/trustedsec/CS-Situational-Awareness-BOF/blob/master/LICENSE "LICENSE") | [Initial Commit](https://github.com/trustedsec/CS-Situational-Awareness-BOF/commit/a84fbf0a746b41a6e8239b566c65af0cca092418 "Initial Commit") | 6 years agoJul 15, 2020 |
| [README.md](https://github.com/trustedsec/CS-Situational-Awareness-BOF/blob/master/README.md "README.md") | [README.md](https://github.com/trustedsec/CS-Situational-Awareness-BOF/blob/master/README.md "README.md") | [Merge branch 'ldapsecuritycheck'](https://github.com/trustedsec/CS-Situational-Awareness-BOF/commit/aa9c515e4649763e5b517175fa88b2184bb99191 "Merge branch 'ldapsecuritycheck'") | last monthJan 5, 2026 |
| [make\_all.sh](https://github.com/trustedsec/CS-Situational-Awareness-BOF/blob/master/make_all.sh "make_all.sh") | [make\_all.sh](https://github.com/trustedsec/CS-Situational-Awareness-BOF/blob/master/make_all.sh "make_all.sh") | [add small bash script to build all BOFs](https://github.com/trustedsec/CS-Situational-Awareness-BOF/commit/17b957ba6d11e8147a30eba4578dcfb8a2d193b4 "add small bash script to build all BOFs") | 5 years agoDec 18, 2021 |
| View all files |

## Repository files navigation

# Situational Awareness BOF

[Permalink: Situational Awareness BOF](https://github.com/trustedsec/CS-Situational-Awareness-BOF#situational-awareness-bof)

This repo intends to serve two purposes. First it provides a nice set of basic situational awareness commands implemented in a Beacon Object File (BOF). This allows you to perform some checks on a host before you begin executing commands that may be more invasive.

Its larger goal is providing a code example and workflow for others to begin making more BOFs. It is a companion document of the blog post made here: [https://www.trustedsec.com/blog/a-developers-introduction-to-beacon-object-files/](https://www.trustedsec.com/blog/a-developers-introduction-to-beacon-object-files/)

## Making a new BOF

[Permalink: Making a new BOF](https://github.com/trustedsec/CS-Situational-Awareness-BOF#making-a-new-bof)

If you want to use the same workflow as this repository, your basic steps are as follows:

1. Make a folder that covers the target topic, for example in this repo we are using SA
2. Copy the base\_template into topic/commandname
3. Modify the Makefile to have your commandname on the first line. This should be the same as the folder name
4. If doing something other then SA, make sure to modify lines 14 and 15 of the makefile as well so its moved to the correct location
5. Make a .cna file in the base of your topic folder and add the commands that you reference. If you followed this format you can take the helper function readbof from SA.cna

Realistically, this could be compressed into a helper script, but those steps were not taken for this effort.

## Available commands

[Permalink: Available commands](https://github.com/trustedsec/CS-Situational-Awareness-BOF#available-commands)

| Commands | Usage | Notes |
| --- | --- | --- |
| adcs\_enum | adcs\_enum | Enumerate CAs and templates in the AD using Win32 functions |
| adcs\_enum\_com | adcs\_enum\_com | Enumerate CAs and templates in the AD using ICertConfig COM object |
| adcs\_enum\_com2 | adcs\_enum\_com2 | Enumerate CAs and templates in the AD using IX509PolicyServerListManager COM object |
| adv\_audit\_policies | adv\_audit\_policies | Retrieve advanced security audit policies |
| arp | arp | List ARP table |
| cacls | cacls \[filepath\] | List user permissions for the specified file, wildcards supported |
| dir | dir \[directory\] \[/s\] | List files in a directory. Supports wildcards (e.g. "C:\\Windows\\S\*") unlike the CobaltStrike `ls` command |
| driversigs | driversigs | Enumerate installed services Imagepaths to check the signing cert against known AV/EDR vendors |
| enum\_filter\_driver | enum\_filter\_driver \[opt:computer\] | Enumerate filter drivers |
| enumLocalSessions | enumLocalSessions | Enumerate currently attached user sessions both local and over RDP |
| env | env | List process environment variables |
| findLoadedModule | findLoadedModule \[modulepart\] \[opt:procnamepart\] | Find what processes \*modulepart\* are loaded into, optionally searching just \*procnamepart\* |
| get\_dpapi\_system | get\_dpapi\_system | Get the DPAPI\_SYSTEM key and bootkey |
| get\_password\_policy | get\_password\_policy \[hostname\] | Get target server or domain's configured password policy and lockouts |
| get\_session\_info | get\_session\_info | prints out information related to the current users logon session |
| ipconfig | ipconfig | List IPv4 address, hostname, and DNS server |
| ldapsearch | ldapsearch \[--attributes\] \[--count\] \[--scope\] \[--hostname\] \[--dn\] \[--ldaps\] | Execute LDAP searches (NOTE: specify \*,ntsecuritydescriptor as attribute parameter if you want all attributes + base64 encoded ACL of the objects, this can then be resolved using BOFHound. Could possibly break pagination, although everything seemed fine during testing.) |
| ldapsecuritycheck | ldapsecuritycheck \[opt:dc\] | Check LDAP signing and LDAPS channel binding requirements on domain controllers. Performs authentication tests to detect security configurations. Auto-discovers the DC when omitted and derives the LDAP SPN automatically. Generates Event ID 2889 when LDAP signing is required but not used. |
| listdns | listdns | List DNS cache entries. Attempt to query and resolve each |
| list\_firewall\_rules | list\_firewall\_rules | List Windows firewall rules |
| listmods | listmods \[opt: pid\] | List process modules (DLL). Target current process if PID is empty. Complement to driversigs to determine if our process was injected by AV/EDR |
| listpipes | listpipes | List named pipes |
| locale | locale | List system locale language, locale ID, date, time, and country |
| netGroupList | netGroupList \[opt: domain\] | List groups from the default or specified domain |
| netGroupListMembers | netGroupListMembers \[groupname\] \[opt: domain\] | List group members from the default or specified domain |
| netLocalGroupList | netLocalGroupList \[opt: server\] | List local groups from the local or specified computer |
| netLocalGroupListMembers | netLocalGroupListMembers \[groupname\] \[opt: server\] | List local groups from the local or specified computer |
| netLocalGroupListMembers2 | netLocalGroupListMembers2 \[opt: groupname\] \[opt: server\] | Modified version of `netLocalGroupListMembers` that supports BOFHound |
| netloggedon | netloggedon \[hostname\] | Return users logged on the local or remote computer |
| netloggedon2 | netloggedon2 \[opt: hostname\] | Modified version of `netloggedon` that supports BOFHound |
| netsession | netsession \[opt:computer\] | Enumerate sessions on the local or specified computer |
| netsession2 | netsession2 \[opt:computer\] \[opt:resolution method\] \[opt:dns server\] | Modified version of `netsession` that supports BOFHound |
| netshares | netshares \[hostname\] | List shares on the local or remote computer |
| netstat | netstat | TCP and UDP IPv4 listing ports |
| nettime | nettime \[hostname\] | Display time on remote computer |
| netuptime | netuptime \[hostname\] | Return information about the boot time on the local or remote computer |
| netuser | netuser \[username\] \[opt: domain\] | Get info about specific user. Pull from domain if a domainname is specified |
| netuse\_add | netuse\_add \[sharename\] \[opt:username\] \[opt:password\] \[opt:/DEVICE:devicename\] \[opt:/PERSIST\] \[opt:/REQUIREPRIVACY\] | Bind a new connection to a remote computer |
| netuse\_delete | netuse\_delete \[device\|\|sharename\] \[opt:/PERSIST\] \[opt:/FORCE\] | Delete the bound device / sharename\] |
| netuse\_list | netuse\_list \[opt:target\] | List all bound share resources or info about target local resource |
| netview | netview | List reachable computers in the current domain |
| nslookup | nslookup \[hostname\] \[opt:dns server\] \[opt: record type\] | Make a DNS query.<br> DNS server is the server you want to query (do not specify or 0 for default) <br>record type is something like A, AAAA, or ANY. Some situations are limited due to observed crashes |
| md5 | md5 \[filename\] | Hash filename using md5 |
| probe | probe \[host\] \[port\] | Check if a specific port is open |
| regsession | regsession \[opt: hostname\] | Return logged on user SIDs by enumerating HKEY\_USERS. BOFHound compatible |
| reg\_query | \[opt:hostname\] \[hive\] \[path\] \[opt: value to query\] | Query a registry value or enumerate a single key |
| reg\_query\_recursive | \[opt:hostname\] \[hive\] \[path\] | Recursively enumerate a key starting at path |
| resources | resources | List memory usage and available disk space on the primary hard drive |
| routeprint | routeprint | List IPv4 routes |
| sc\_enum | sc\_enum \[opt:server\] | Enumerate services for qc, query, qfailure, and qtriggers info |
| sc\_qc | sc\_qc \[service name\] \[opt:server\] | sc qc impelmentation in BOF |
| sc\_qdescription | sc\_qdescription \[service name\] \[opt: server\] | sc qdescription implementation in BOF |
| sc\_qfailure | sc\_qfailure \[service name\] \[opt:server\] | Query a service for failure conditions |
| sc\_qtriggerinfo | sc\_qtriggerinfo \[service name\] \[opt:server\] | Query a service for trigger conditions |
| sc\_query | sc\_query \[opt: service name\] \[opt: server\] | sc query implementation in BOF |
| schtasksenum | schtasksenum \[opt: server\] | Enumerate scheduled tasks on the local or remote computer |
| schtasksquery | schtasksquery \[opt: server\] \[taskpath\] | Query the given task on the local or remote computer |
| sha1 | sha1 \[filename\] | Hash filename using sha1 |
| sha256 | sha256 \[filename\] | Hash filename using sha256 |
| tasklist | tasklist \[opt: server\] | List running processes including PID, PPID, and ComandLine (uses wmi) |
| uptime | uptime | List system boot time and how long it has been running |
| useridletime | useridletime | Shows how long the user as been idle, displayed in seconds, minutes, hours and days. |
| vssenum | vssenum \[hostname\] \[opt:sharename\] | Enumerate Shadow Copies on some Server 2012+ servers |
| whoami | whoami | List whoami /all |
| windowlist | windowlist \[opt:all\] | List visible windows in the current user session |
| wmi\_query | wmi\_query query \[opt: server\] \[opt: namespace\] | Run a wmi query and display results in CSV format |

Note the reason for including reg\_query when CS has a built in reg query(v) command is because this one can target remote computers and has the ability to recursively enumerate a whole key.

#### Credits

[Permalink: Credits](https://github.com/trustedsec/CS-Situational-Awareness-BOF#credits)

The functional code for most of these commands was taken from the reactos project or code examples hosted on MSDN.
The driversigs codebase comes from [https://gist.github.com/jthuraisamy/4c4c751df09f83d3620013f5d370d3b9](https://gist.github.com/jthuraisamy/4c4c751df09f83d3620013f5d370d3b9)

Thanks all of the contributors listed under contributors. Each of you have contributed something meaningful to this repository and dealt with me and my review processes. I appreciate each and every one of you for teaching me and helping make this BOF repository the best it can be!

##### Compiler used

[Permalink: Compiler used](https://github.com/trustedsec/CS-Situational-Awareness-BOF#compiler-used)

BOF's are built against [freefirex2/ts\_bof\_builder:latest](https://hub.docker.com/r/freefirex2/ts_bof_builder)

## System Support

[Permalink: System Support](https://github.com/trustedsec/CS-Situational-Awareness-BOF#system-support)

These BOF's are written with support for Windows Vista+ in mind. A new branch called [winxp\_2003](https://github.com/trustedsec/CS-Situational-Awareness-BOF/tree/winxp_2003) has been created if you need to use the main set of BOF's on those older systems. This branch will remain in a less supported state. It will be functional, but not updated with every new push / feature that we may add.

## Want to Learn More?

[Permalink: Want to Learn More?](https://github.com/trustedsec/CS-Situational-Awareness-BOF#want-to-learn-more)

If you've found these beacon object files helpful and want to write some of your own bofs following a similar style we invite you to check out our [Beacon Object File (BOF) Development](https://learn.trustedsec.com/courses/cd84409a-36af-4507-be2c-ca7ad1e9fd2d) course.

The course gives a breif overview of the history of beacon object files and then dives into a variety of challenge problems that aim to teach you how to leverage a variety of windows technologies when developing your own beacon object files.

## About

Situational Awareness commands implemented using Beacon Object Files


### Topics

[c](https://github.com/topics/c "Topic: c") [cna](https://github.com/topics/cna "Topic: cna") [bof](https://github.com/topics/bof "Topic: bof")

### Resources

[Readme](https://github.com/trustedsec/CS-Situational-Awareness-BOF#readme-ov-file)

### License

[GPL-2.0 license](https://github.com/trustedsec/CS-Situational-Awareness-BOF#GPL-2.0-1-ov-file)

### Contributing

[Contributing](https://github.com/trustedsec/CS-Situational-Awareness-BOF#contributing-ov-file)

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/trustedsec/CS-Situational-Awareness-BOF).

[Activity](https://github.com/trustedsec/CS-Situational-Awareness-BOF/activity)

[Custom properties](https://github.com/trustedsec/CS-Situational-Awareness-BOF/custom-properties)

### Stars

[**1.7k**\\
stars](https://github.com/trustedsec/CS-Situational-Awareness-BOF/stargazers)

### Watchers

[**34**\\
watching](https://github.com/trustedsec/CS-Situational-Awareness-BOF/watchers)

### Forks

[**277**\\
forks](https://github.com/trustedsec/CS-Situational-Awareness-BOF/forks)

[Report repository](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Ftrustedsec%2FCS-Situational-Awareness-BOF&report=trustedsec+%28user%29)

## [Releases\  4](https://github.com/trustedsec/CS-Situational-Awareness-BOF/releases)

[Automated build 2026-01-05\_20-35\\
Latest\\
\\
on Jan 5Jan 5, 2026](https://github.com/trustedsec/CS-Situational-Awareness-BOF/releases/tag/Build_2026-01-05_20-35)

[\+ 3 releases](https://github.com/trustedsec/CS-Situational-Awareness-BOF/releases)

## [Contributors\  39](https://github.com/trustedsec/CS-Situational-Awareness-BOF/graphs/contributors)

- [![@freefirex](https://avatars.githubusercontent.com/u/3172440?s=64&v=4)](https://github.com/freefirex)
- [![@kapn-kaos](https://avatars.githubusercontent.com/u/63302803?s=64&v=4)](https://github.com/kapn-kaos)
- [![@deviousbanana](https://avatars.githubusercontent.com/u/7109813?s=64&v=4)](https://github.com/deviousbanana)
- [![@RemiEscourrou](https://avatars.githubusercontent.com/u/22934796?s=64&v=4)](https://github.com/RemiEscourrou)
- [![@Tw1sm](https://avatars.githubusercontent.com/u/37981031?s=64&v=4)](https://github.com/Tw1sm)
- [![@JohnLaTwC](https://avatars.githubusercontent.com/u/16035087?s=64&v=4)](https://github.com/JohnLaTwC)
- [![@kev169](https://avatars.githubusercontent.com/u/2339235?s=64&v=4)](https://github.com/kev169)
- [![@nickvourd](https://avatars.githubusercontent.com/u/32869078?s=64&v=4)](https://github.com/nickvourd)
- [![@Tycx2ry](https://avatars.githubusercontent.com/u/6139198?s=64&v=4)](https://github.com/Tycx2ry)
- [![@leebaird](https://avatars.githubusercontent.com/u/4013039?s=64&v=4)](https://github.com/leebaird)
- [![@martindube](https://avatars.githubusercontent.com/u/4238786?s=64&v=4)](https://github.com/martindube)
- [![@m0t](https://avatars.githubusercontent.com/u/500273?s=64&v=4)](https://github.com/m0t)
- [![@nowhey2](https://avatars.githubusercontent.com/u/1191760?s=64&v=4)](https://github.com/nowhey2)
- [![@martanne](https://avatars.githubusercontent.com/u/5736493?s=64&v=4)](https://github.com/martanne)

[\+ 25 contributors](https://github.com/trustedsec/CS-Situational-Awareness-BOF/graphs/contributors)

## Languages

- [C98.7%](https://github.com/trustedsec/CS-Situational-Awareness-BOF/search?l=c)
- [Makefile1.3%](https://github.com/trustedsec/CS-Situational-Awareness-BOF/search?l=makefile)

You can’t perform that action at this time.