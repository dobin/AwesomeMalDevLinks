Title:
The Nightmare of Proc Hollow’s Exe

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post explains Windows process hollowing as a defense-evasion/code-injection technique where an attacker creates a benign process in a suspended state, overwrites its entry point with shellcode, and resumes execution so the payload runs under a trusted image (e.g., notepad.exe/svchost.exe).  
- It walks through a practical implementation that combines process hollowing with PPID spoofing to further disguise parent-child relationships.  
- The author details how to locate the remote process PEB, derive the ImageBaseAddress, parse PE headers to find the AddressOfEntryPoint, and overwrite it via remote memory APIs before calling ResumeThread.  
- It highlights why this can bypass superficial inspection and signature-on-disk checks, while still leaving behavioral artifacts (e.g., suspicious outbound network from a “benign” process).  
- Defensive guidance includes telemetry and correlation ideas (Sysmon process access + process creation), entry-point integrity checks, and memory/PEB/VAD consistency analysis, plus example Sigma rules and a Splunk query.  
- Useful for red teams/pentesters implementing or understanding injection tradecraft, and for blue teams building detections around process tampering and suspicious access patterns.

Technical Focus:
- Process hollowing (MITRE ATT&CK T1055.012) and entry-point overwrite
- Suspended process creation (CREATE_SUSPENDED, EXTENDED_STARTUPINFO_PRESENT)
- PEB/ImageBaseAddress discovery via NtQueryInformationProcess/ZwQueryInformationProcess
- PE header parsing (e_lfanew, AddressOfEntryPoint RVA) in remote memory
- Remote memory modification (ReadProcessMemory/WriteProcessMemory) and thread resume (ResumeThread)
- Detection engineering with Sysmon (EID 1/10/25), Sigma, and Splunk correlation

Use Cases:
- Implementing a process-hollowing PoC for operator tradecraft testing
- Combining PPID spoofing + hollowing to evaluate EDR/SIEM visibility gaps
- Building SIEM detections for suspicious process access + suspended child creation
- Memory forensics validation of hollowed processes (entry point/PEB/VAD inconsistencies)
- Threat hunting for anomalous parent-child relationships and unusual call traces

Keywords:
process hollowing, PPID spoofing, CREATE_SUSPENDED, EXTENDED_STARTUPINFO_PRESENT, NtQueryInformationProcess, ZwQueryInformationProcess, PROCESS_BASIC_INFORMATION, PEB, ImageBaseAddress, PE header parsing, e_lfanew, AddressOfEntryPoint, ReadProcessMemory, WriteProcessMemory, ResumeThread, SetThreadContext, Sysmon Event ID 1, Sysmon Event ID 10, Sysmon Event ID 25, Sigma rule, Splunk query, ETW Microsoft-Windows-Kernel-Process, Volatility, HollowFind, Meterpreter shellcode