Title:
CallStackMasker — Dynamically spoofing/masking call stacks with timers (PoC)

Type:
GitHub Tool

Short Summary (4–8 sentences max):
- CallStackMasker is a C++ proof-of-concept that dynamically overwrites a thread’s call stack during “sleep” and restores it before execution resumes, aiming to defeat call-stack-based telemetry and analysis.  
- It uses queued timers to run stack-manipulation routines while the implant thread is in a waiting state, analogous to sleep obfuscation techniques that hide memory during idle periods.  
- The default mode mimics a static call stack pattern taken from `spoolsv.exe`; a `--dynamic` mode enumerates accessible threads, finds one in a target wait state (e.g., `WaitForSingleObjectEx`), and clones its call stack and start address.  
- The repo references prior art (Ekko sleep obfuscation, WithSecureLabs CallStackSpoofer/TickTock) and thread enumeration examples (Hunt-Sleeping-Beacons).  
- Useful for red teamers and malware developers researching evasion against EDR stack-walking and “sleeping beacon” hunting; also relevant to blue teams for understanding and detecting stack spoofing tradecraft.  
- Tested only on Windows 22H2 (19045.2486), with potential fragility across builds due to reliance on low-level behavior.

Technical Focus:
- Call stack spoofing / stack frame manipulation
- Timer-based execution (queued timers) during thread sleep
- Thread enumeration and selecting target wait states
- Mimicking benign process/thread call stacks (e.g., `spoolsv.exe`)
- Sleep obfuscation tradecraft (Ekko-inspired)
- EDR evasion against stack-walking telemetry

Use Cases:
- Implementing or prototyping call-stack masking for sleeping implants/beacons
- Evaluating how EDRs attribute suspicious activity via call stacks
- Building detections for anomalous timer usage + stack inconsistencies
- Researching robustness of stack spoofing across Windows versions/builds

Keywords:
call stack spoofing, call stack masking, timers, queued timers, sleep obfuscation, Ekko, WaitForSingleObjectEx, thread enumeration, stack walking, EDR evasion, spoolsv.exe, start address spoofing, Windows internals, WithSecureLabs CallStackSpoofer, TickTock, Hunt-Sleeping-Beacons, C++, implant sleep, telemetry evasion