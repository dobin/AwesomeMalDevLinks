Title:
Threat Hunting – Suspicious Named Pipes

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post explains Windows named pipes as an IPC mechanism and how attackers abuse them for privilege escalation (impersonation), persistence, and C2 pivoting/lateral movement (often over SMB/IPC$).  
- It provides a practical vulnerable pipe server/client example showing how weak pipe security (e.g., NULL DACL) can let a low-privileged client trigger high-privileged command execution.  
- The author focuses on detection engineering: what telemetry exists (notably Sysmon Event IDs 17/18 for pipe create/connect) and how to pivot into related process/network/service events for investigations.  
- A key deliverable is a curated CSV list (~300) of suspicious named pipe names/patterns mapped to tools/categories/severity/FP risk, intended for SIEM lookups and alerting/hunting.  
- It includes Splunk SPL examples for using the list, plus additional heuristic hunts (unsigned pipe creators, suspicious pipe usage in command lines, pipes from temp paths, uncommon pipe relationships/baselining, IPC$ via Security 5145).  
- Useful primarily for Blue Team threat hunters/detection engineers and DFIR, with indirect value to red teams for understanding what pipe artifacts defenders can monitor.

Technical Focus:
- Windows named pipes internals (CreateNamedPipe/CreateFile/ReadFile/WriteFile) and security descriptors (DACL/SDDL)
- Named pipe impersonation and privilege escalation patterns (Potato-family techniques)
- Sysmon pipe telemetry (Event ID 17/18) and investigative pivots (EID 1/3/7/8/10; Security 4624/5145; Service install events)
- SMB/RPC named pipe usage and IPC$ share artifacts
- SIEM-based hunting with lookups (Splunk) and false-positive management/baselining
- Extraction of pipe indicators from source code via regex

Use Cases:
- Build SIEM detections for known-malicious/suspicious named pipe names and patterns
- Threat hunt for C2 frameworks and lateral movement that pivot via named pipes (local or SMB/IPC$)
- Investigate suspected privilege escalation via pipe impersonation by correlating pipe events with process/service/network logs
- Baseline “normal” pipe relationships per process and alert on uncommon pipe usage
- Enrich malware triage/IOC collection by extracting named pipe artifacts from sandboxes or source code

Keywords:
Windows named pipes, IPC, CreateNamedPipe, CreateFile, ReadFile, WriteFile, DACL, security descriptor, ImpersonateNamedPipeClient, privilege escalation, Potato exploits, RoguePotato, Print Spooler, C2 pivoting, SMB, RPC, IPC$, Sysmon Event ID 17, Sysmon Event ID 18, Splunk SPL, Security Event ID 5145, Security Event ID 4624, Cobalt Strike BeaconGate, PipeViewer, accesschk, pipelist, Sigma rules