Title:
Attacking an EDR – Part 2

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post analyzes the client–server communication channel between an EDR agent (“STRANGETRINITY”) and its cloud tenant to assess whether an attacker with admin on the endpoint can tamper with policy updates.  
- The authors extract agent configuration via an exposed COM method accessible to local Administrators, revealing the tenant URL and an “anti-tampering” setting.  
- By installing a rogue CA and using an intercepting HTTPS proxy (e.g., Burp in invisible mode) plus hosts-file DNS redirection, they intercept the agent’s REST polling traffic and modify JSON configuration in transit.  
- Flipping `anti-tampering` from `TRUE` to `false` is accepted by the agent, effectively disabling protections and enabling stopping services/processes and persisting defeat via registry changes.  
- The write-up highlights weak integrity/authentication of cloud-to-agent configuration messages and insufficient threat modeling for “admin-on-host” adversaries.  
- Useful for red teamers/pentesters assessing EDR tamper resistance and for defenders/vendors designing robust policy delivery and anti-tamper controls.

Technical Focus:
- EDR agent ↔ cloud tenant policy/telemetry channel (REST over HTTPS)
- TLS interception via rogue CA and invisible proxying
- COM class/method discovery and ACL/access control analysis
- Configuration tampering (JSON policy manipulation) and integrity validation failures
- Windows service/process disruption (sc.exe) and registry-based persistence against security tooling

Use Cases:
- Validate whether an EDR’s cloud policy channel is resilient to on-host MITM and config manipulation
- Identify locally exposed management interfaces (COM) that leak sensitive configuration/tenant details
- Develop test cases for “admin can’t disable EDR” assumptions and anti-tamper bypass attempts
- Create vendor hardening requirements: message signing, pinning, replay protection, strict authZ

Keywords:
EDR, anti-tampering, policy tampering, agent-to-tenant communication, REST API, HTTPS, TLS interception, rogue CA, Burp Suite, invisible proxy, hosts file, DNS redirection, COM server, CLSID, Windows ACL, JSON configuration, sc.exe, service stop, registry modification, MITRE ATT&CK T1562.001