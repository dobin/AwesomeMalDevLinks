Title:
Intruders in the Library: Exploring DLL Hijacking

Type:
Blog Post

Short Summary (4–8 sentences max):
This Unit 42 article explains DLL hijacking on Windows, focusing on how attackers coerce legitimate executables into loading malicious DLLs for stealthy code execution. It breaks down the Windows DLL search order (special vs. standard locations) and shows how manipulating search precedence enables defense evasion, persistence, and sometimes privilege escalation. The post covers three common variants: DLL side-loading (most prevalent), DLL search order hijacking (including PATH abuse), and phantom DLL loading (planting a missing DLL expected by a process/service). It provides real-world case studies across APT and cybercrime (ToneShell/Stately Taurus, PlugX via USB/LNK, AsyncRAT phishing using a renamed ESET component, CatB ransomware via MSDTC, and Dridex with persistence mechanisms). The detection section proposes practical heuristics around anomalous DLL properties, unusual load paths, rare hashes, signature mismatches, and “first-seen” load events at scale. It’s useful for both red teams (tradecraft and preconditions) and blue teams (hunting/detections and hardening guidance), especially where signed binaries are abused to blend in.

Technical Focus:
- Windows DLL loader search order (KnownDLLs, SxS manifests, API sets, redirection, PATH)
- DLL side-loading vs. search order hijacking vs. phantom DLL loading
- Persistence and privilege escalation via trusted process execution context
- Telemetry-based hunting for anomalous module loads (rarity, signatures, entropy, timestamps)
- Service/process abuse examples (WSearch/SearchIndexer, MSDTC/msdtc.exe)
- Malware tradecraft case studies (ToneShell, PlugX, AsyncRAT, CatB, Dridex)

Use Cases:
- Hunt for suspicious Image Load events where signed executables load rare/unsigned DLLs from atypical directories
- Validate endpoint detections for DLL hijacking/side-loading behaviors in EDR/XDR
- Identify vulnerable applications that load DLLs without fully qualified paths
- Assess persistence paths created after side-loading (Run keys, Startup LNKs, scheduled tasks)
- Harden software and deployment practices (explicit DLL paths, manifests/redirection, reduce writable search paths)

Keywords:
DLL hijacking, DLL side-loading, search order hijacking, phantom DLL loading, Windows DLL search order, KnownDLLs, SxS manifests, API sets, DLL redirection, PATH environment variable, Image Load telemetry, unsigned DLL, code execution, persistence, privilege escalation, WSearch, SearchIndexer.exe, msdtc.exe, System32, scheduled task, HKCU Run key, PlugX, AsyncRAT, Dridex, ToneShell, CatB ransomware