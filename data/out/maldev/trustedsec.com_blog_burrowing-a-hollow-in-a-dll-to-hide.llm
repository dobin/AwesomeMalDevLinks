Title:
Burrowing a Hollow in a DLL to Hide

Type:
Blog Post

Short Summary (4–8 sentences max):
This post explains “DLL hollowing,” a process injection technique where an attacker loads a legitimate DLL and overwrites its entry point (often DllMain) with shellcode to execute malicious code while appearing benign on disk. It covers two approaches: (1) hollowing a DLL loaded into the current process, and (2) spawning a remote process (with PPID spoofing) and forcing it to LoadLibrary a target DLL, then overwriting the DLL entry point in the remote address space and executing via a new (remote) thread. The author demonstrates implementations in both C and C#, including PE header parsing to locate AddressOfEntryPoint and memory protection changes to enable writing. It also briefly discusses reversing the resulting binaries with Ghidra (C) and dnSpy (C#), noting minimal obfuscation and that Defender flagged the C samples but not the C# ones in testing. Useful for red teams and malware analysts to understand a common stealthy injection pattern and for defenders to reason about anomalous module loads and entry-point tampering.

Technical Focus:
- DLL hollowing (entry point overwrite) vs classic process hollowing
- PE/MZ header parsing to locate AddressOfEntryPoint
- Remote injection primitives (VirtualAllocEx, WriteProcessMemory, CreateRemoteThread)
- Memory protection changes (VirtualProtect) for code overwrite
- PPID spoofing via STARTUPINFOEX / ProcThreadAttributeList
- Module enumeration in remote processes (EnumProcessModules, GetModuleBaseName)

Use Cases:
- Execute shellcode from within a benign DLL’s mapped image to reduce obvious on-disk indicators
- Remote process injection that blends into expected parent/child process trees (PPID spoofing)
- Tradecraft development and testing of EDR/AV detection around module loads and entry-point modification
- Blue-team detection engineering for suspicious LoadLibrary + entry-point writes + thread creation sequences

Keywords:
DLL hollowing, process injection, entry point overwrite, DllMain, PE headers, MZ header, AddressOfEntryPoint, LoadLibraryA, GetProcAddress, VirtualProtect, CreateThread, CreateRemoteThread, VirtualAllocEx, WriteProcessMemory, ReadProcessMemory, EnumProcessModules, GetModuleBaseNameA, PPID spoofing, STARTUPINFOEX, PROC_THREAD_ATTRIBUTE_PARENT_PROCESS, Ghidra, dnSpy, AMSI.dll, Meterpreter shellcode