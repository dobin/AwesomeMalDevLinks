Title:
Creation Of Process (Windows Internals)

Type:
Documentation

Short Summary (4–8 sentences max):
- This write-up walks through how Windows creates a “normal” user-mode process, starting from a simple C++ `CreateProcessW` example and drilling down into the underlying call chain.  
- It explains key `CreateProcessW` parameters and shows how they appear in compiled code via static analysis (Cutter) and dynamic debugging (x64dbg).  
- The core technique is tracing the transition from `CreateProcessW` → `CreateProcessInternalW` (KernelBase) → `NtCreateUserProcess` (ntdll) → syscall into the kernel, clarifying where user-mode ends and kernel-mode begins.  
- It also introduces direct process creation using Native APIs (`NtCreateUserProcess`) and the required supporting structures (`RTL_USER_PROCESS_PARAMETERS`, `PS_CREATE_INFO`, `PS_ATTRIBUTE_LIST`).  
- Useful for red teamers/malware developers who need low-level process creation control (e.g., attributes/flags), and for defenders/researchers who want to understand telemetry points and API layering.

Technical Focus:
- Win32 process creation (`CreateProcessW`) parameterization and behavior
- API call chain: Kernel32/KernelBase → NTDLL → syscalls
- Native process creation: `NtCreateUserProcess`
- Process creation structures: `RTL_USER_PROCESS_PARAMETERS`, `PS_CREATE_INFO`, `PS_ATTRIBUTE_LIST`, `UNICODE_STRING`
- Static and dynamic reverse engineering of process creation (Cutter, x64dbg)
- Process/thread creation flags and attributes (PS attributes, access masks)

Use Cases:
- Reverse engineer how a sample spawns child processes and what APIs it truly reaches
- Build custom process creation code using NT APIs for finer-grained control
- Understand where EDR/user-mode hooks may sit in the process creation stack
- Implement/experiment with process creation attributes (e.g., parent process attribute concepts)
- Debug and validate process creation flows at the assembly/syscall boundary

Keywords:
Windows internals, process creation, CreateProcessW, CreateProcessInternalW, KernelBase.dll, kernel32.dll, ntdll.dll, NtCreateUserProcess, syscall, x64dbg, Cutter, static analysis, dynamic analysis, RTL_USER_PROCESS_PARAMETERS, RtlCreateProcessParametersEx, PS_CREATE_INFO, PS_ATTRIBUTE_LIST, UNICODE_STRING, ACCESS_MASK, PROCESS_ALL_ACCESS, THREAD_ALL_ACCESS, process creation flags, thread creation flags, PS_ATTRIBUTE_IMAGE_NAME