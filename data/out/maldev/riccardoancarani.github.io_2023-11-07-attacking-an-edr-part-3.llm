Title:
Attacking an EDR – Part 3

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post analyzes an EDR product’s update/uninstall workflow and shows how logic flaws in “authorized” maintenance actions can be abused to disable anti-tamper protections.  
- The authors discover an “unshield_from_authorized_process” command by reviewing leftover crashdump/log artifacts, then reverse the gating condition: the EDR only checks the parent process’ vendor signature.  
- They identify a vendor-signed “live response” helper executable that can be run locally with attacker-controlled command lines, effectively acting as a LOLBin to satisfy the parent-signature requirement and approve unshielding.  
- As an alternative path, they demonstrate .NET AppDomain hijacking by dropping a crafted `.config` next to a vendor-signed .NET utility to load a malicious AppDomainManager assembly that launches the unshield command.  
- The result is full anti-tamper disablement, enabling trivial uninstall/tampering, highlighting why update/maintenance paths must be in EDR threat models.  
- Useful for red teams and security researchers assessing EDR self-protection, and for blue teams/vendors hardening update and live-response components.

Technical Focus:
- EDR self-protection / anti-tamper bypass via update/maintenance logic flaws  
- Parent-process code-signing trust and signature-based authorization checks  
- Abuse of vendor “live response” tooling as a LOLBin (command-line injection)  
- .NET AppDomain hijacking via `.exe.config` (AppDomainManagerAssembly/Type)  
- Artifact/log analysis (ProgramData, crash dumps) to discover hidden functionality  
- Process execution telemetry validation (e.g., Sysmon Event ID 1)

Use Cases:
- Identify and exploit weak authorization checks in EDR maintenance/update features
- Turn vendor-signed helper binaries into execution primitives (LOLBin-style)
- Bypass anti-tamper to enable EDR removal, configuration changes, or file/registry tampering
- Assess vendor trust boundaries around code signing and “authorized process” assumptions
- Develop detections for suspicious use of EDR response shells or unexpected `.config` files next to signed utilities

Keywords:
EDR, anti-tamper, self-defense, update mechanism, uninstall protection, code signing, Authenticode, parent process validation, LOLBin, live response, command-line injection, StrangeTrinityResponseShell.exe, StrangeTrinity.exe, unshield_from_authorized_process, Sysmon EventID 1, ProgramData artifacts, crash dump logs, .NET, AppDomain hijacking, AppDomainManagerAssembly, exe.config, assembly probing, csc.exe