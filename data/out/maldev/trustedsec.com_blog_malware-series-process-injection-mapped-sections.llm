Title:
Malware Series: Process Injection Mapped Sections

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post explains a Windows process injection technique that uses shared memory Section Objects (“mapped sections”) to place and execute shellcode inside a remote process.  
- Instead of writing directly into remote memory with APIs like `WriteProcessMemory`, the attacker creates a kernel-backed section via `NtCreateSection`, maps a writable view locally, and maps an executable view into the target process with `NtMapViewOfSection`.  
- Shellcode is copied into the local view (e.g., via `memcpy`), and the contents are automatically mirrored into the remote view because both processes share the same section.  
- Execution is triggered by creating a remote thread (using `RtlCreateUserThread`) that starts at the remote mapped view address.  
- The article includes working C and C# examples (with P/Invoke definitions) and notes practical permission requirements (e.g., RWX due to msfvenom payload self-modifying stubs).  
- Useful for red teamers, pentesters, and malware analysts studying alternative injection primitives and for defenders modeling telemetry around section mapping and remote thread creation.

Technical Focus:
- Windows Section Objects / shared memory (kernel-backed)  
- `NtCreateSection` and `NtMapViewOfSection` injection flow  
- Remote thread creation via `RtlCreateUserThread`  
- Memory protection flags (RW/RX/RWX) and payload self-modification  
- C/C# implementation details (P/Invoke, unsafe code)  

Use Cases:
- Implementing process injection without direct remote writes (mapped-section based)  
- Building PoCs to study EDR detection around section mapping + remote threads  
- Malware analysis/reversing: recognizing mapped-section injection patterns  
- Red team tradecraft experimentation with alternative Windows native APIs  

Keywords:
process injection, mapped sections, Section Object, shared memory, NtCreateSection, NtMapViewOfSection, ZwMapViewOfSection, RtlCreateUserThread, OpenProcess, ntdll.dll, kernel32.dll, PAGE_EXECUTE_READWRITE, SEC_COMMIT, shellcode, msfvenom, remote thread, P/Invoke, C#, Windows internals