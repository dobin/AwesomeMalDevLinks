Title:
Running Cobalt Strike BOFs from Python

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post shows how to execute Cobalt Strike Beacon Object Files (BOFs) from a Python process on Windows by converting BOFs into standalone shellcode and injecting it locally.  
- It combines TrustedSec’s COFFLoader concept (loading COFF/BOF outside Cobalt Strike) with FalconForce’s BOF2Shellcode approach to produce raw shellcode that includes both a loader and the BOF.  
- The author demonstrates a Python injector using `ctypes` to call WinAPI (`HeapCreate`/`HeapAlloc`, `RtlMoveMemory`, `VirtualProtect`, `CreateThread`) and optionally set execute-only permissions for evasion tradeoffs.  
- The workflow includes generating BOF shellcode (e.g., TrustedSec “tasklist” BOF), then embedding it into Python (via msfvenom formatting) and running it inside signed `python.exe`.  
- It’s useful for red teams/pentesters who want to reuse the BOF ecosystem (situational awareness, post-ex modules) in non–Cobalt Strike agents or custom Python-based implants.  
- The interesting angle is leveraging a commonly present, signed interpreter as a host process while importing mature BOF capabilities into other C2 frameworks.

Technical Focus:
- Cobalt Strike BOFs and COFF loading (COFFLoader)
- BOF-to-shellcode conversion (BOF2Shellcode)
- Local shellcode injection in-process via WinAPI
- Memory permissions and evasion tradeoffs (RWX vs RX/X-only)
- Python `ctypes` for direct Windows API invocation

Use Cases:
- Run CS Community Kit / BOF-based post-ex modules from a custom Python agent
- Add BOF execution capability to alternative C2 frameworks without embedding Cobalt Strike
- Execute situational awareness BOFs (e.g., tasklist) from a signed `python.exe` host
- Prototype in-memory execution chains using shellcode + minimal loader logic

Keywords:
Cobalt Strike, BOF, Beacon Object File, COFF, COFFLoader, BOF2Shellcode, Python, ctypes, shellcode, in-memory execution, local injection, HeapCreate, HeapAlloc, RtlMoveMemory, VirtualProtect, CreateThread, PAGE_EXECUTE, signed binary, post-exploitation, Sliver