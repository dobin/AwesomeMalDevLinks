Title:
Detoning Direct/Indirect Syscalls by several approachs

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post analyzes how to detect direct and indirect Windows syscalls commonly used to bypass user-mode EDR hooks (e.g., Hell’s Gate–style stubs and “syscall-jump” indirection).  
- It outlines multiple detection angles: static scanning for the `syscall` opcode, runtime monitoring via Process Instrumentation Callback, call stack validation (return address/caller legitimacy and API-spoofing mismatches), and a guard-page + VEH technique to trap execution at syscall stubs.  
- The author highlights weaknesses in some EDR implementations (example: removing SentinelOne’s instrumentation callback by resetting it with `NtSetInformationProcess`).  
- It also argues for kernel-resident telemetry (ETW-TI and kernel callbacks) as more tamper-resistant visibility than userland-only hooking.  
- Useful primarily for Blue Teams/detection engineers building syscall-evasion detections, and for Red Teams to understand what artifacts their syscall techniques expose.

Technical Focus:
- Direct vs indirect syscalls (SSN setup, syscall stubs, Hell’s Gate-style techniques)
- Static detection of `syscall` opcode (0F 05) and limitations/false positives
- Process Instrumentation Callback (`NtSetInformationProcess`, `ProcessInstrumentationCallback`)
- Call stack analysis (return address validation, unbacked/private RX memory, API spoofing mismatch)
- PAGE_GUARD + VEH-based trapping of syscall stub execution
- ETW Threat Intelligence (ETW-TI) and kernel callbacks (PsSet*NotifyRoutine, ObRegisterCallbacks)

Use Cases:
- Build detections for direct/indirect syscall execution and syscall-stub jumping
- Create call-stack-based rules to identify abnormal syscall callers and API spoofing
- Prototype guard-page/VEH monitoring to catch jumps directly to `syscall` instructions
- Validate EDR coverage and identify bypass opportunities around instrumentation callbacks
- Correlate userland signals with ETW-TI and kernel callback telemetry for higher confidence

Keywords:
Windows, syscalls, direct syscall, indirect syscall, Hell’s Gate, SSN, ntdll, win32u, userland hooking, YARA, 0F 05, Process Instrumentation Callback, NtSetInformationProcess, call stack analysis, return address, API spoofing, PAGE_GUARD, VEH, ETW-TI, ObRegisterCallbacks