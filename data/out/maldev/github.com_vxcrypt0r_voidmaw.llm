Title:
Voidmaw (Improved Voidgate) — Memory Scanner Bypass via On-Demand Instruction Unmasking

Type:
GitHub Tool

Short Summary (4–8 sentences max):
Voidmaw is a Windows userland technique/toolchain to evade memory scanners and YARA-style in-memory signatures by ensuring only a minimal amount of “real” payload code is visible at any time. It consists of two components: **Dismantle** (records which instructions are executed in a payload under PAGE_GUARD/VEH control, then encrypts them and produces a header) and **Voidmaw** (executes a copy of the payload where recorded instructions are replaced with INT3 and dynamically restored on breakpoint exceptions). The approach uses vectored exception handling to trap execution (guard page violations, single-step, and breakpoint/illegal-instruction exceptions) and re-mask instructions after they run, effectively making code transient in memory. It supports multithreaded payloads without hooking thread-creation APIs and is positioned as compatible with common C2 beacons and shellcode-converted PE payloads (e.g., mimikatz via pe_to_shellcode). It’s primarily useful for red team operators, offensive tool developers, and malware researchers studying in-memory evasion and exception-driven execution. The key interest is the “record then replay with per-instruction reveal” model that reduces static in-memory exposure of known-bad code sequences.

Technical Focus:
- Vectored Exception Handler (VEH)–driven execution control
- PAGE_GUARD + STATUS_GUARD_PAGE_VIOLATION instrumentation
- Trap Flag (TF) + EXCEPTION_SINGLE_STEP for re-arming guard pages
- INT3 (0xCC) masking and EXCEPTION_BREAKPOINT handling (or illegal-instruction workaround)
- Per-offset instruction mapping, encryption (XOR), and runtime patching
- Multithreaded payload support without NtCreateThread hooks

Use Cases:
- Generate “transient code” loaders to reduce in-memory signature exposure of beacons/reflective loaders
- Execute known-flagged native payloads (e.g., mimikatz shellcode) with reduced memory-scanner visibility
- Research/PoC development for exception-based unpacking and anti-memory-scanning techniques
- Test and validate defensive memory-scanning/detonation logic against on-demand code restoration

Keywords:
Voidmaw, Voidgate, memory scanner bypass, YARA evasion, Windows, VEH, VectoredExceptionHandler, PAGE_GUARD, STATUS_GUARD_PAGE_VIOLATION, EXCEPTION_SINGLE_STEP, Trap Flag, INT3, EXCEPTION_BREAKPOINT, runtime patching, shellcode, reflective loader, Cobalt Strike beacon, mimikatz, Zydis, Zycore