# https://github.com/Karkas66/EarlyCascadeImprooved

[Skip to content](https://github.com/Karkas66/EarlyCascadeImprooved#start-of-content)

You signed in with another tab or window. [Reload](https://github.com/Karkas66/EarlyCascadeImprooved) to refresh your session.You signed out in another tab or window. [Reload](https://github.com/Karkas66/EarlyCascadeImprooved) to refresh your session.You switched accounts on another tab or window. [Reload](https://github.com/Karkas66/EarlyCascadeImprooved) to refresh your session.Dismiss alert

{{ message }}

[Karkas66](https://github.com/Karkas66)/ **[EarlyCascadeImprooved](https://github.com/Karkas66/EarlyCascadeImprooved)** Public

- [Notifications](https://github.com/login?return_to=%2FKarkas66%2FEarlyCascadeImprooved) You must be signed in to change notification settings
- [Fork\\
3](https://github.com/login?return_to=%2FKarkas66%2FEarlyCascadeImprooved)
- [Star\\
22](https://github.com/login?return_to=%2FKarkas66%2FEarlyCascadeImprooved)


an Improoved Version of 0xNinjaCyclone´s EarlyCascade Code


### License

[MIT license](https://github.com/Karkas66/EarlyCascadeImprooved/blob/main/LICENSE)

[22\\
stars](https://github.com/Karkas66/EarlyCascadeImprooved/stargazers) [3\\
forks](https://github.com/Karkas66/EarlyCascadeImprooved/forks) [Branches](https://github.com/Karkas66/EarlyCascadeImprooved/branches) [Tags](https://github.com/Karkas66/EarlyCascadeImprooved/tags) [Activity](https://github.com/Karkas66/EarlyCascadeImprooved/activity)

[Star](https://github.com/login?return_to=%2FKarkas66%2FEarlyCascadeImprooved)

[Notifications](https://github.com/login?return_to=%2FKarkas66%2FEarlyCascadeImprooved) You must be signed in to change notification settings

# Karkas66/EarlyCascadeImprooved

main

[**1** Branch](https://github.com/Karkas66/EarlyCascadeImprooved/branches) [**0** Tags](https://github.com/Karkas66/EarlyCascadeImprooved/tags)

[Go to Branches page](https://github.com/Karkas66/EarlyCascadeImprooved/branches)[Go to Tags page](https://github.com/Karkas66/EarlyCascadeImprooved/tags)

Go to file

Code

Open more actions menu

## Folders and files

| Name | Name | Last commit message | Last commit date |
| --- | --- | --- | --- |
| ## Latest commit<br>[![Karkas66](https://avatars.githubusercontent.com/u/25013261?v=4&size=40)](https://github.com/Karkas66)[Karkas66](https://github.com/Karkas66/EarlyCascadeImprooved/commits?author=Karkas66)<br>[Update README.md](https://github.com/Karkas66/EarlyCascadeImprooved/commit/cf2c9d81e1f3bf1aeee5b13bdd3883b3bc3c54d2)<br>last yearFeb 20, 2025<br>[cf2c9d8](https://github.com/Karkas66/EarlyCascadeImprooved/commit/cf2c9d81e1f3bf1aeee5b13bdd3883b3bc3c54d2) · last yearFeb 20, 2025<br>## History<br>[7 Commits](https://github.com/Karkas66/EarlyCascadeImprooved/commits/main/) <br>Open commit details<br>[View commit history for this file.](https://github.com/Karkas66/EarlyCascadeImprooved/commits/main/) 7 Commits |
| [EarlyCascade.c](https://github.com/Karkas66/EarlyCascadeImprooved/blob/main/EarlyCascade.c "EarlyCascade.c") | [EarlyCascade.c](https://github.com/Karkas66/EarlyCascadeImprooved/blob/main/EarlyCascade.c "EarlyCascade.c") | [Update EarlyCascade.c](https://github.com/Karkas66/EarlyCascadeImprooved/commit/64afdbdf46b0e47d8db72003c749bc5898a70865 "Update EarlyCascade.c  Minor cleanup") | last yearJan 28, 2025 |
| [EarlyCascade.sln](https://github.com/Karkas66/EarlyCascadeImprooved/blob/main/EarlyCascade.sln "EarlyCascade.sln") | [EarlyCascade.sln](https://github.com/Karkas66/EarlyCascadeImprooved/blob/main/EarlyCascade.sln "EarlyCascade.sln") | [Add files via upload](https://github.com/Karkas66/EarlyCascadeImprooved/commit/399967a3854d3a4c6c2f9c8e4f0ab628927552f5 "Add files via upload") | last yearJan 28, 2025 |
| [EarlyCascade.vcxproj](https://github.com/Karkas66/EarlyCascadeImprooved/blob/main/EarlyCascade.vcxproj "EarlyCascade.vcxproj") | [EarlyCascade.vcxproj](https://github.com/Karkas66/EarlyCascadeImprooved/blob/main/EarlyCascade.vcxproj "EarlyCascade.vcxproj") | [Add files via upload](https://github.com/Karkas66/EarlyCascadeImprooved/commit/399967a3854d3a4c6c2f9c8e4f0ab628927552f5 "Add files via upload") | last yearJan 28, 2025 |
| [LICENSE](https://github.com/Karkas66/EarlyCascadeImprooved/blob/main/LICENSE "LICENSE") | [LICENSE](https://github.com/Karkas66/EarlyCascadeImprooved/blob/main/LICENSE "LICENSE") | [Add files via upload](https://github.com/Karkas66/EarlyCascadeImprooved/commit/399967a3854d3a4c6c2f9c8e4f0ab628927552f5 "Add files via upload") | last yearJan 28, 2025 |
| [README.md](https://github.com/Karkas66/EarlyCascadeImprooved/blob/main/README.md "README.md") | [README.md](https://github.com/Karkas66/EarlyCascadeImprooved/blob/main/README.md "README.md") | [Update README.md](https://github.com/Karkas66/EarlyCascadeImprooved/commit/cf2c9d81e1f3bf1aeee5b13bdd3883b3bc3c54d2 "Update README.md") | last yearFeb 20, 2025 |
| [bintoc.rb](https://github.com/Karkas66/EarlyCascadeImprooved/blob/main/bintoc.rb "bintoc.rb") | [bintoc.rb](https://github.com/Karkas66/EarlyCascadeImprooved/blob/main/bintoc.rb "bintoc.rb") | [Add files via upload](https://github.com/Karkas66/EarlyCascadeImprooved/commit/399967a3854d3a4c6c2f9c8e4f0ab628927552f5 "Add files via upload") | last yearJan 28, 2025 |
| [preview.png](https://github.com/Karkas66/EarlyCascadeImprooved/blob/main/preview.png "preview.png") | [preview.png](https://github.com/Karkas66/EarlyCascadeImprooved/blob/main/preview.png "preview.png") | [Add files via upload](https://github.com/Karkas66/EarlyCascadeImprooved/commit/8256c286ef595abd2ced87ee7869109e8fe9900e "Add files via upload") | last yearJan 28, 2025 |
| [stub.asm](https://github.com/Karkas66/EarlyCascadeImprooved/blob/main/stub.asm "stub.asm") | [stub.asm](https://github.com/Karkas66/EarlyCascadeImprooved/blob/main/stub.asm "stub.asm") | [Add files via upload](https://github.com/Karkas66/EarlyCascadeImprooved/commit/399967a3854d3a4c6c2f9c8e4f0ab628927552f5 "Add files via upload") | last yearJan 28, 2025 |
| View all files |

## Repository files navigation

# EarlyCascade Improved

[Permalink: EarlyCascade Improved](https://github.com/Karkas66/EarlyCascadeImprooved#earlycascade-improved)

[![Logo](https://github.com/Karkas66/EarlyCascadeImprooved/raw/main/preview.png)](https://github.com/Karkas66/EarlyCascadeImprooved/blob/main/preview.png)

> It's a modern and stealthy process injection technique was discovered by [Outflank](https://www.outflank.nl/) that involves injecting and executing code in the early stages of process creation before loading EDRs for their user mode detection measures. EarlyCascade technique forces enabling the Shim engine, allowing to hijack a Shim engine callback.

## Why "improved"

[Permalink: Why "improved"](https://github.com/Karkas66/EarlyCascadeImprooved#why-improved)

The original Code by [0xNinjaCyclone](https://github.com/0xNinjaCyclone/EarlyCascade) had hardcoded Injection Process Name and static plain Shellcode. I wanted to load dynamic Shellcode from files into a process of my choice. To get rid of plain msfvenom shellcode detections by several AVs I made a basic XOR Encryption of the embedded shellcode. I also made a Visual Studio 2022 Template, ready to compile and run.
Did not yet find the problem why not msfvenom shellcode crashes the hosting payload process. So just use msfvenom SC for now. I successfully tested it with meterpreter\_reverse\_tcp

(Original Readme from here)

## About the proof-of-concept

[Permalink: About the proof-of-concept](https://github.com/Karkas66/EarlyCascadeImprooved#about-the-proof-of-concept)

1. Creating a process in suspended mode.
2. Dynamically locating the addresses of enabling flag and callback.
3. Remotely allocating memory for our stub and shellcode.
4. Injecting the stub and shellcode into the target process.
5. Force the shim engine to be enabled.
6. Hijacking a shim engine callback.
7. Triggering the callback by resuming the process thread.

At this point, the stub gets executed, and does the following:

1. Disrupting the initialization of detection measures.
2. Disabling the Shim engine to avoid crash.
3. Queuing an Asynchronous Procedure Call (APC) that executes the shellcode later.

## References

[Permalink: References](https://github.com/Karkas66/EarlyCascadeImprooved#references)

- [Introducing Early Cascade Injection: From Windows Process Creation to Stealthy Injection](https://www.outflank.nl/blog/2024/10/15/introducing-early-cascade-injection-from-windows-process-creation-to-stealthy-injection/)

## About

an Improoved Version of 0xNinjaCyclone´s EarlyCascade Code


### Resources

[Readme](https://github.com/Karkas66/EarlyCascadeImprooved#readme-ov-file)

### License

[MIT license](https://github.com/Karkas66/EarlyCascadeImprooved#MIT-1-ov-file)

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/Karkas66/EarlyCascadeImprooved).

[Activity](https://github.com/Karkas66/EarlyCascadeImprooved/activity)

### Stars

[**22**\\
stars](https://github.com/Karkas66/EarlyCascadeImprooved/stargazers)

### Watchers

[**1**\\
watching](https://github.com/Karkas66/EarlyCascadeImprooved/watchers)

### Forks

[**3**\\
forks](https://github.com/Karkas66/EarlyCascadeImprooved/forks)

[Report repository](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FKarkas66%2FEarlyCascadeImprooved&report=Karkas66+%28user%29)

## [Releases](https://github.com/Karkas66/EarlyCascadeImprooved/releases)

No releases published

## [Packages\  0](https://github.com/users/Karkas66/packages?repo_name=EarlyCascadeImprooved)

No packages published

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/Karkas66/EarlyCascadeImprooved).

## Languages

- [C69.2%](https://github.com/Karkas66/EarlyCascadeImprooved/search?l=c)
- [Assembly29.7%](https://github.com/Karkas66/EarlyCascadeImprooved/search?l=assembly)
- [Ruby1.1%](https://github.com/Karkas66/EarlyCascadeImprooved/search?l=ruby)

You can’t perform that action at this time.