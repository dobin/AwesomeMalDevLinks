Title:
Demystifying AV/EDR Evasion

Type:
Conference Talk (Slide Deck)

Short Summary (4–8 sentences max):
- This slide deck breaks down how AV and EDR products detect payloads and why common C2 “shellcode” techniques often fail under modern telemetry and memory scanning.  
- It focuses on demystifying Metasploit/Meterpreter and Cobalt Strike internals, showing that many “shellcode” payloads are actually reflective DLL loaders (sRDI) that allocate additional memory and execute via ReflectiveLoader/DllMain.  
- The talk contrasts static/dynamic/cloud AV detection with EDR behavioral and memory-based detections, emphasizing that getting a callback is only the first step.  
- It highlights “memory gymnastics” concepts: why unbacked/private executable memory is suspicious, and how module-backed executable regions (e.g., via module stomping and Malleable C2 options like `module_x64`/`userwx`) can reduce detections (example testing referenced with Elastic 8.12.2).  
- It introduces more advanced loader customization via User-Defined Reflective Loaders (UDRL) and related projects (e.g., BokuLoader, AceLoader), including techniques like IAT hooking and return address spoofing.  
- Useful for red team operators and implant/tooling developers who need to understand and modify their tradecraft rather than treating C2 payloads as black boxes.

Technical Focus:
- AV vs EDR detection models (static, dynamic, cloud, telemetry)
- Shellcode loaders and Windows memory allocation/execution flow (RW→RX, thread start)
- Reflective DLL Injection and sRDI (ReflectiveLoader, DllMain, DOS header hotpatch/trampolines)
- Module-backed vs private/unbacked executable memory; module stomping
- Cobalt Strike/Meterpreter payload internals and Malleable C2 memory controls (`userwx`, `module_x64`)
- Custom loaders (UDRL), IAT hooking, return address spoofing

Use Cases:
- Reverse-engineering Meterpreter/Beacon staging and reflective loading behavior
- Building custom shellcode loaders with encrypted payload storage and controlled memory permissions
- Reducing EDR memory-scan hits by moving implants into module-backed executable memory
- Adapting Cobalt Strike via Malleable C2 and/or UDRL to change allocation/execution artifacts
- Developing and testing detection hypotheses in lab EDRs (example: Elastic)

Keywords:
AV, EDR, Defender, AMSI, Metasploit, Meterpreter, Cobalt Strike, Beacon, msfvenom, shellcode loader, NtAllocateVirtualMemory, ZwAllocateVirtualMemory, NtCreateThreadEx, ZwCreateThreadEx, Reflective DLL Injection, ReflectiveLoader, sRDI, DOS header hotpatch, trampoline, module stomping, module-backed memory, RWX, RX, Malleable C2, userwx, module_x64, UDRL, IAT hooking, return address spoofing, Elastic 8.12.2