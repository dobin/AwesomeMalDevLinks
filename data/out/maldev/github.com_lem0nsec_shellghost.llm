Title:
ShellGhost

Type:
GitHub Tool

Short Summary (4–8 sentences max):
ShellGhost is a Windows shellcode self-injection PoC demonstrating a memory-evasion technique intended to keep shellcode “invisible” to common memory scanners throughout execution. It uses Vectored Exception Handling (VEH) and software breakpoints to single-step execution: each breakpoint is replaced on-demand with a small RC4-decrypted instruction chunk, executed, then re-hidden by restoring breakpoints and toggling page protections. A companion “shellcode mapping” Python script disassembles shellcode into per-instruction blobs, encrypts them individually, and generates C arrays plus metadata (RVA + opcode quota) to support correct RC4 decryption lengths. The approach aims to defeat scanners like Moneta and PE-sieve by avoiding long-lived plaintext shellcode in RX private memory, though it acknowledges detectability via breakpoint-filled pages and the inherent need for executable private memory at times. It includes special handling for Metasploit x64 shellcodes where API parameter strings reside inside the shellcode region (e.g., RCX pointing into the allocation during `JMP RAX`). Useful primarily for red teamers and offensive security researchers studying in-memory evasion tradeoffs and detection opportunities.

Technical Focus:
- Vectored Exception Handling (AddVectoredExceptionHandler) for execution control
- Software breakpoints (INT3 / EXCEPTION_BREAKPOINT) as an execution “skeleton”
- Per-instruction shellcode mapping (RIP→RVA resolution) and metadata (quota/RVA)
- RC4 decryption via SystemFunction032 (advapi32) with variable-length buffers
- Memory protection flipping (RW ↔ RX) and private executable memory artifacts
- Metasploit x64 shellcode quirks (register-based API calls, embedded parameter pointers)

Use Cases:
- Researching breakpoint/VEH-driven “just-in-time” shellcode decryption/execution
- Building PoCs to evaluate memory-scanner heuristics (Moneta, PE-sieve) and YARA ideas
- Developing/benchmarking defensive detections for breakpoint-heavy RX private pages
- Adapting shellcode loaders to reduce plaintext dwell time in executable memory

Keywords:
Windows, shellcode, in-memory evasion, Vectored Exception Handling, VEH, EXCEPTION_BREAKPOINT, INT3, software breakpoints, RIP, RVA, RC4, SystemFunction032, USTRING, VirtualProtect, RWX, RX private memory, Metasploit x64, JMP RAX, Moneta, PE-sieve, YARA detection