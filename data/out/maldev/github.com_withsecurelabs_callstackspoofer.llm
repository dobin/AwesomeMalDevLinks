Title:
CallStackSpoofer (WithSecureLabs)

Type:
GitHub Tool

Short Summary (4–8 sentences max):
- This repository is a proof-of-concept for spoofing arbitrary user-mode call stacks when executing Windows system calls (e.g., calling `NtOpenProcess`).  
- The goal is to confuse or evade EDR detections that rely on call stack inspection/stack-walking to attribute suspicious syscalls (such as opening handles to LSASS) to malicious code paths.  
- It provides sample “legitimate-looking” stacks (selectable via `--wmi`, `--rpc`, `--svchost`) derived from Sysmon process access telemetry, and demonstrates how to reproduce those stack shapes during the syscall.  
- The PoC is Windows-build sensitive (tested on Windows 10 21H2 19044.1706) because stack/unwind details and offsets can vary across versions.  
- The README includes practical debugging guidance using WinDbg (`bp ntdll!NtOpenProcess`, `knf`) to validate stack layout, child-SP usage, and per-function stack consumption.  
- Useful primarily for red teamers, offensive tool developers, and security researchers studying stack-based EDR telemetry and syscall attribution.

Technical Focus:
- User-mode call stack spoofing for syscalls (e.g., `ntdll!NtOpenProcess`)
- Windows x64 stack walking, unwind metadata (UNWIND_CODE), and stack size calculation
- EDR/Sysmon call-stack-based detection evasion and syscall attribution
- WinDbg stack analysis (`knf`, breakpoints) and symbol resolution
- Mimicking benign execution chains (WMI/RPC/svchost-like stacks)

Use Cases:
- Building/validating syscall wrappers that present benign-looking call stacks
- Researching how EDRs correlate syscalls with user-mode call stacks
- Reproducing “known-good” stack traces from Sysmon/telemetry to test detections
- Developing and debugging stack spoofing implementations across Windows builds

Keywords:
call stack spoofing, syscall, NtOpenProcess, ntdll, Windows x64, stack walking, unwind info, UNWIND_CODE, Child-SP, WinDbg, knf, Sysmon, process access, LSASS, EDR evasion, RPC, WMI, svchost, KERNELBASE, RPCRT4