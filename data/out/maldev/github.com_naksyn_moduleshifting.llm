Title:
ModuleShifting

Type:
GitHub Tool

Short Summary (4–8 sentences max):
- ModuleShifting is a Windows in-process injection technique/tool that modifies a loaded legitimate DLL’s section to host shellcode or a PE payload, aiming to reduce common memory forensics indicators compared to Module Stomping/Overloading.  
- It avoids allocating new memory (e.g., VirtualAlloc) by reusing an existing module’s mapped image sections, changing protections, writing the payload, executing it, and (for shellcode) restoring the original DLL bytes afterward to erase the modified artifact.  
- The implementation is in Python using ctypes, designed to run fully in-memory via a Python interpreter and the author’s Pyramid framework (reducing reliance on compiled loaders).  
- For PE payloads it includes manual mapping steps such as section copying, relocations, import resolution, TLS callback execution, and restoring native section protections to avoid RWX regions.  
- It’s primarily useful for red teams/pentesters and EDR evasion testing, and is interesting because the “restore original content” cleanup step can significantly reduce post-execution memory IoCs in offline scanners (with the caveat that real-time inspection may still catch the transient modification).

Technical Focus:
- Module stomping / module overloading variants (image section overwrite)
- Memory protection changes (RW → RX) and avoiding RWX
- Shellcode execution via function pointer / callbacks / CreateThread
- PE manual mapping (relocations, import resolution, TLS callbacks)
- In-memory execution via Python ctypes (no compiled loader)
- Memory forensics/IoC reduction vs tools like Moneta and PE-sieve

Use Cases:
- Local process injection for red team tradecraft without VirtualAlloc-based artifacts
- EDR/AV evaluation of transient module-section overwrites and cleanup behavior
- Running staged loaders where initial shellcode is disposable after spawning a self-sustaining payload
- Researching detection strategies for module-section tampering and short-lived memory modifications

Keywords:
ModuleShifting, module stomping, module overloading, DLL section overwrite, LoadLibrary, VirtualProtect, shellcode, manual mapping, PE relocation, import resolution, TLS callbacks, function pointer execution, CreateThread, ctypes, Python in-memory execution, Pyramid, Moneta, PE-sieve, memory IoCs, EDR evasion