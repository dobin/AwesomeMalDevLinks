Title:
Gargoyle — Memory Scanning Evasion Technique (x86 Windows)

Type:
GitHub Tool

Short Summary (4–8 sentences max):
Gargoyle is a 32-bit Windows proof-of-concept that evades memory scanners by ensuring its payload code is only executable for brief windows of time. It uses a ROP gadget plus a stack trampoline and position-independent code (PIC) to transition between non-executable and executable states, typically keeping the payload pages non-executable when idle. The included harness periodically triggers execution (e.g., a message box every 15 seconds) and then tail-calls logic to mark the code non-executable again while waiting on a timer. The project demonstrates how page permissions and control-flow tricks can reduce exposure to snapshot-based memory analysis and some scanning heuristics. It’s primarily useful for red teamers, exploit developers, and malware researchers studying in-memory evasion and ROP/PIC mechanics, and for blue teamers looking to understand and detect such behavior.

Technical Focus:
- Windows memory protection changes (RW/RX toggling, DEP/NX semantics)
- ROP gadget usage and stack trampolines
- Position-independent code (PIC) on x86
- Runtime gadget discovery in mshtml.dll (searching executable sections)
- Timer-based execution windows / “execute only when needed” design

Use Cases:
- Prototype “sleep masking” style concepts using page-permission flipping
- Research and education on x86 ROP chains, trampolines, and PIC loaders
- Evaluate how memory scanners/EDR handle transient RX regions and ROP-based transitions
- Develop detection ideas around frequent VirtualProtect-like transitions and suspicious ROP gadget sourcing

Keywords:
Windows x86, memory scanning evasion, memory analysis, ROP, ROP gadget, stack trampoline, PIC, position-independent code, DEP, NX, page permissions, VirtualProtect, mshtml.dll, executable section scanning, timer-based execution, sleep masking, in-memory payload, NASM, Visual Studio, VMMap