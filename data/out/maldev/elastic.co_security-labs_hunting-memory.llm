Title:
Hunting In Memory

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post surveys common Windows in-memory malware techniques and how to hunt for them at scale with low noise.  
- It breaks down attacker tradecraft including shellcode injection, reflective DLL injection, “memory module” loaders, process hollowing, module overwriting, and the Gargoyle ROP/APC evasion concept.  
- The core detection idea is to identify anomalous threads whose start addresses point to unbacked executable memory (e.g., Private + executable pages rather than Image-backed regions), a strong indicator of injected or mapped code.  
- It highlights practical artifacts like RWX allocations, erased PE headers, suspicious thread call stacks, CREATE_SUSPENDED usage, and memory-vs-disk mismatches for overwritten modules.  
- The article references a PowerShell hunting script (Get-InjectedThreads) that uses NtQueryInformationThread + VirtualQueryEx to flag injected threads, and discusses common false-positive sources (security products, JIT, DRM/packers).  
- Useful primarily for threat hunters, DFIR, and detection engineers building endpoint telemetry and scalable memory-hunting workflows.

Technical Focus:
- Remote thread injection and unbacked executable memory (“floating code”)
- Reflective DLL loading and PE header artifacts/erasure
- Memory-module style loaders (LoadLibrary re-implementation)
- Process hollowing variants (CREATE_SUSPENDED, SetThreadContext, section mapping)
- Module overwriting detection via memory-to-disk comparison
- Thread start-address hunting via NtQueryInformationThread and VirtualQueryEx

Use Cases:
- Hunt endpoints for injected threads starting in Private executable regions
- Triage suspected fileless/in-memory implants (RATs, loaders, post-exploitation beacons)
- Build detection logic for reflective loaders / memory-mapped modules (with/without PE headers)
- Investigate process hollowing by correlating suspended process creation and execution redirection
- Reduce false positives by filtering JIT/DRM/security-product injection patterns

Keywords:
in-memory malware, fileless, shellcode injection, reflective DLL injection, ReflectiveLoader, MemoryModule, process hollowing, module overwriting, Gargoyle, ROP, APC, NtQueryInformationThread, VirtualQueryEx, OpenProcess, VirtualAllocEx, WriteProcessMemory, CreateRemoteThread, SetThreadContext, CREATE_SUSPENDED, unbacked executable memory, RWX pages, PE header wiping, thread start address, Windows internals, EDR detection engineering