Title:
Syscalls-Thread-Hijacking (System calls Thread Hijacking Malwares)

Type:
GitHub Tool

Short Summary (4–8 sentences max):
This repository is a collection of Windows thread-hijacking and shellcode injection samples that use dynamically-resolved direct and indirect syscalls to reduce user-mode API hooking visibility. It focuses on bypassing user-mode AV/EDR hooks by avoiding standard Win32/NtAPI call paths and minimizing static IAT artifacts via manual export parsing of `ntdll.dll`. The code resolves syscall numbers (SSNs) at runtime, builds custom syscall stubs, and performs remote process injection by enumerating processes/threads, allocating RWX memory, writing/decrypting shellcode, and redirecting a thread’s instruction pointer. It includes both EXE-based remote injection variants and a DLL variant that runs inside the host process and spawns a worker thread to avoid loader-lock deadlocks. The author notes it is not “ntdll unhooking” and will not defeat kernel-level telemetry (ETW, callbacks, kernel trampolines) if the syscall instruction itself is instrumented. Useful for red teamers, malware researchers, and defenders studying syscall-based injection tradecraft and its detection boundaries.

Technical Focus:
- Direct syscalls vs indirect syscalls (SSN extraction, syscall stub generation)
- Manual PE export parsing / custom `GetProcAddress` (EAT walking, forwarded exports handling)
- Thread hijacking (suspend, context/IP manipulation, resume)
- Remote process injection workflow (process/thread enumeration, memory allocation, RWX protection)
- Shellcode encryption/decryption and payload staging
- DLL execution patterns (DllMain constraints, loader lock avoidance via new thread)

Use Cases:
- Build and test syscall-based injection PoCs that bypass user-mode hooks
- Study tradeoffs and stability risks of hijacking existing threads vs creating suspended threads
- Develop detections for syscall-stub patterns, manual export walking, and thread-context tampering
- Compare direct vs indirect syscall implementations and their failure modes under EDR instrumentation
- Create lab samples for malware analysis training focused on low-level Windows injection

Keywords:
Windows, ntdll.dll, Native API, direct syscalls, indirect syscalls, SSN, syscall stub, user-mode hooking bypass, EDR evasion, PE parsing, export address table, IMAGE_EXPORT_DIRECTORY, GetProcAddressManualEx, NtQuerySystemInformation, process injection, thread hijacking, SuspendThread, thread context, shellcode loader, DLL injection