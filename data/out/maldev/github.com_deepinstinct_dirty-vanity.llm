Title:
Dirty Vanity (Windows Fork API Injection / EDR Evasion PoC)

Type:
GitHub Tool

Short Summary (4–8 sentences max):
Dirty-Vanity is a proof-of-concept code injection technique that abuses the Windows “fork”/process cloning capability to evade EDR detections commonly tied to classic remote-thread injection patterns. The tool writes position-independent shellcode into a target process, forks (clones) that process into a new process, and then sets the forked process’s start address to the cloned shellcode so execution occurs in the child. The included shellcode is designed to rely on ntdll APIs and is generated via an embedded shellcode template project, with instructions for customizing and extracting the shellcode bytes. This is primarily useful for red teamers, pentesters, and malware researchers exploring alternative injection primitives and telemetry gaps around process creation/cloning. It’s interesting because it shifts execution to a forked process and can bypass detections focused on CreateRemoteThread/WriteProcessMemory-style sequences. The repo references the Black Hat Europe 2022 talk “Dirty Vanity: A New Approach to Code Injection & EDR Bypass.”

Technical Focus:
- Windows process forking / process cloning (fork API)
- Shellcode reflection into a remote process
- Start address manipulation in a forked child process
- ntdll-based shellcode and low-level Windows APIs
- Injection tradecraft aimed at EDR telemetry evasion

Use Cases:
- Testing EDR visibility/detections around process cloning and non-traditional injection flows
- Building/validating alternative injection chains that avoid common remote-thread indicators
- Researching defensive telemetry opportunities for fork/clone + start-address tampering
- Rapid prototyping custom ntdll-based shellcode and reflecting it via a cloned process

Keywords:
Dirty Vanity, Windows fork API, process cloning, code injection, EDR bypass, shellcode reflection, NtCreateUserProcess, ntdll, start address, process fork, remote memory allocation, shellcode template, position-independent code, Windows internals, Black Hat EU 2022, injection technique, telemetry evasion, C++ PoC