Title:
Obfuscating a Mimikatz Downloader to Evade Defender (2024)

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post walks through modifying/obfuscating a C# “Mimikatz downloader” (BetterSafetyKatz) to reduce Microsoft Defender detections.  
- It focuses on changing static indicators in the Visual Studio project (project/assembly naming and strings) and iterating on builds to improve evasion.  
- BetterSafetyKatz is described as fetching the latest precompiled Mimikatz release from gentilkiwi’s GitHub, applying runtime patching for known signatures, and using SharpSploit DInvoke to load/execute in-memory.  
- The author uses the InvisibilityCloak Python toolkit to automatically rename project artifacts and apply simple string obfuscation (e.g., reversing strings).  
- Operational notes are included about avoiding telemetry “burn” (e.g., disabling Defender sample submission and not uploading to VirusTotal).  
- It’s primarily useful for red teamers/pentesters experimenting with AV/Defender-oriented tradecraft around common credential-dumping tooling.

Technical Focus:
- BetterSafetyKatz / SafetyKatz-style Mimikatz delivery and in-memory execution
- C# project/assembly renaming and metadata changes
- String obfuscation to evade static signatures
- D/Invoke (SharpSploit) for indirect Windows API usage
- Runtime patching of known detection points/signatures
- Defender operational considerations (sample submission/telemetry)

Use Cases:
- Rapidly rebranding/obfuscating known offensive C# tooling to test Defender resilience
- Building a customized Mimikatz retrieval/execution wrapper for controlled assessments
- Creating variant builds to evaluate which static indicators trigger detections
- Training/red team lab exercises on AV evasion and signature-driven detections

Keywords:
Mimikatz, BetterSafetyKatz, SafetyKatz, Microsoft Defender, AV evasion, C#, Visual Studio, obfuscation, string reversal, InvisibilityCloak, DInvoke, SharpSploit, in-memory execution, runtime patching, signature-based detection, downloader, gentilkiwi GitHub, telemetry, sample submission, VirusTotal