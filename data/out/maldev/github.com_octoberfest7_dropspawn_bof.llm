Title:
DropSpawn_BOF (DropSpawn) — Cobalt Strike BOF for spawning Beacons via DLL Application Directory Hijacking

Type:
GitHub Tool

Short Summary (4–8 sentences max):
DropSpawn is a Cobalt Strike Beacon Object File (BOF) that spawns new Beacon sessions by abusing DLL search order hijacking, positioned as an alternative to classic remote process injection. The key idea is spoofing the “application directory” used by the Windows loader so even System32 executables (e.g., WerFault.exe) can be coerced into loading an attacker-controlled DLL from a user-writable directory. Operators generate a proxy/hijack DLL that preserves the target DLL’s exports and forwards calls to the real System32 DLL to avoid crashing, while executing the payload on load. The repo includes a Python helper (generate_dll.py) to extract exports and build a forwarding DLL using MinGW, plus guidance for finding candidates with Procmon. It supports cross-arch scenarios (x86↔x64) and optionally uses PPID spoofing for the spawned process. It’s primarily useful for red teams/pentesters seeking lower-IOC process creation-based execution paths compared to remote memory injection chains.

Technical Focus:
- DLL search order / application directory hijacking
- Undocumented NTDLL process creation APIs (RtlCreateUserProcess-related)
- DLL proxying via export forwarding (.def generation)
- Cross-architecture Beacon spawning (x86/x64)
- PPID spoofing during process creation
- Self-deleting/rename-delete technique for loaded DLL cleanup

Use Cases:
- Spawn additional Cobalt Strike Beacons without remote process injection primitives
- Execute payloads by hijacking DLL loads in trusted Windows binaries (e.g., System32 tools)
- Build stable hijack DLLs that forward exports to legitimate System32 DLLs
- Reduce on-host artifacts by self-deleting dropped DLL payloads after load
- Experiment with detection differences between PPID-spoofed vs non-spoofed spawns

Keywords:
Cobalt Strike, BOF, Beacon spawning, DLL hijacking, DLL search order, application directory spoofing, System32, WerFault.exe, Procmon, export forwarding, proxy DLL, .def file, MinGW, RtlCreateUserProcess, NTDLL, PPID spoofing, CreateProcess, sysnative, self-deletion, Microsoft Defender for Endpoint (MDE)