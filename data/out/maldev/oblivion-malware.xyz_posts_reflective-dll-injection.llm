Title:
Reflective DLL Injection

Type:
Blog Post

Short Summary (4â€“8 sentences max):
- This post walks through implementing a reflective DLL loader that maps a PE DLL from memory into a target (or current) process without using the normal Windows loader path (e.g., LoadLibrary).  
- It contrasts reflective loading with standard DLL loading in terms of telemetry/visibility (no normal image-load callbacks, not present in PEB module lists, no on-disk requirement) and discusses common IOC pitfalls like RWX allocations.  
- The author details the full reflective loader pipeline: locating the in-memory DLL base, allocating memory, copying sections, applying base relocations, resolving the Import Address Table, restoring per-section memory protections, executing TLS callbacks, and finally calling DllMain.  
- It includes code for export parsing and dynamic API resolution (including forwarded exports), plus examples of relocation and IAT fixing logic.  
- Useful for red teamers, pentesters, and malware developers building custom in-memory loaders or studying PE manual mapping tradeoffs.  
- Interesting because it emphasizes loader correctness details often skipped (TLS callbacks, section protections, forwarded exports) that affect reliability and detection.

Technical Focus:
- Reflective DLL injection / PE manual mapping
- PE parsing (DOS/NT headers, sections, data directories)
- Base relocations (.reloc) and relocation types (DIR64/HIGHLOW/etc.)
- Import Address Table (IAT) reconstruction and export resolution (incl. forwarded exports)
- Memory protection strategy (VirtualAlloc + VirtualProtect per section; avoiding RWX)
- TLS directory parsing and TLS callback execution; NtFlushInstructionCache

Use Cases:
- Build a custom reflective loader for in-memory DLL execution
- Implement manual-mapped DLL injection that avoids standard loader artifacts (PEB module list)
- Research EDR detection gaps around non-standard image loading and section permission patterns
- Develop/validate PE loader components (relocations, IAT, TLS) for implants or test harnesses

Keywords:
Reflective DLL Injection, manual mapping, PE loader, Windows internals, LoadLibrary, PEB, IMAGE_NT_HEADERS, IMAGE_SECTION_HEADER, IMAGE_DIRECTORY_ENTRY_BASERELOC, IMAGE_BASE_RELOCATION, IMAGE_IMPORT_DESCRIPTOR, IMAGE_THUNK_DATA, IAT fixing, export table parsing, forwarded exports, VirtualAlloc, VirtualProtect, NtFlushInstructionCache, TLS callbacks, DllMain, thread creation injection