# https://github.com/tijme/dittobytes

[Skip to content](https://github.com/tijme/dittobytes#start-of-content)

You signed in with another tab or window. [Reload](https://github.com/tijme/dittobytes) to refresh your session.You signed out in another tab or window. [Reload](https://github.com/tijme/dittobytes) to refresh your session.You switched accounts on another tab or window. [Reload](https://github.com/tijme/dittobytes) to refresh your session.Dismiss alert

{{ message }}

[tijme](https://github.com/tijme)/ **[dittobytes](https://github.com/tijme/dittobytes)** Public

- ### Uh oh!







There was an error while loading. [Please reload this page](https://github.com/tijme/dittobytes).

- [Notifications](https://github.com/login?return_to=%2Ftijme%2Fdittobytes) You must be signed in to change notification settings
- [Fork\\
69](https://github.com/login?return_to=%2Ftijme%2Fdittobytes)
- [Star\\
601](https://github.com/login?return_to=%2Ftijme%2Fdittobytes)


Metamorphic cross-compilation of C++ & C-code to PIC, BOF & EXE.


### License

[MPL-2.0 license](https://github.com/tijme/dittobytes/blob/master/LICENSE.md)

[601\\
stars](https://github.com/tijme/dittobytes/stargazers) [69\\
forks](https://github.com/tijme/dittobytes/forks) [Branches](https://github.com/tijme/dittobytes/branches) [Tags](https://github.com/tijme/dittobytes/tags) [Activity](https://github.com/tijme/dittobytes/activity)

[Star](https://github.com/login?return_to=%2Ftijme%2Fdittobytes)

[Notifications](https://github.com/login?return_to=%2Ftijme%2Fdittobytes) You must be signed in to change notification settings

# tijme/dittobytes

master

[Branches](https://github.com/tijme/dittobytes/branches) [Tags](https://github.com/tijme/dittobytes/tags)

[Go to Branches page](https://github.com/tijme/dittobytes/branches)[Go to Tags page](https://github.com/tijme/dittobytes/tags)

Go to file

Code

Open more actions menu

## Folders and files

| Name | Name | Last commit message | Last commit date |
| --- | --- | --- | --- |
| ## Latest commit<br>## History<br>[193 Commits](https://github.com/tijme/dittobytes/commits/master/) <br>[View commit history for this file.](https://github.com/tijme/dittobytes/commits/master/) 193 Commits |
| [.github](https://github.com/tijme/dittobytes/tree/master/.github ".github") | [.github](https://github.com/tijme/dittobytes/tree/master/.github ".github") |  |  |
| [build](https://github.com/tijme/dittobytes/tree/master/build "build") | [build](https://github.com/tijme/dittobytes/tree/master/build "build") |  |  |
| [code](https://github.com/tijme/dittobytes/tree/master/code "code") | [code](https://github.com/tijme/dittobytes/tree/master/code "code") |  |  |
| [ditto](https://github.com/tijme/dittobytes/tree/master/ditto "ditto") | [ditto](https://github.com/tijme/dittobytes/tree/master/ditto "ditto") |  |  |
| [.gitignore](https://github.com/tijme/dittobytes/blob/master/.gitignore ".gitignore") | [.gitignore](https://github.com/tijme/dittobytes/blob/master/.gitignore ".gitignore") |  |  |
| [Dockerfile](https://github.com/tijme/dittobytes/blob/master/Dockerfile "Dockerfile") | [Dockerfile](https://github.com/tijme/dittobytes/blob/master/Dockerfile "Dockerfile") |  |  |
| [LICENSE.md](https://github.com/tijme/dittobytes/blob/master/LICENSE.md "LICENSE.md") | [LICENSE.md](https://github.com/tijme/dittobytes/blob/master/LICENSE.md "LICENSE.md") |  |  |
| [README.md](https://github.com/tijme/dittobytes/blob/master/README.md "README.md") | [README.md](https://github.com/tijme/dittobytes/blob/master/README.md "README.md") |  |  |
| [makefile](https://github.com/tijme/dittobytes/blob/master/makefile "makefile") | [makefile](https://github.com/tijme/dittobytes/blob/master/makefile "makefile") |  |  |
| View all files |

## Repository files navigation

[![Dittobytes Logo](https://gist.githubusercontent.com/tijme/c77f321c8dacd6d8ce8e0f9e2ab8c719/raw/029692c26cb1dd1c05f1c4544a96d333544b9f3a/dittobytes.svg)](https://gist.githubusercontent.com/tijme/c77f321c8dacd6d8ce8e0f9e2ab8c719/raw/029692c26cb1dd1c05f1c4544a96d333544b9f3a/dittobytes.svg)

[![Latest Dittobytes release](https://camo.githubusercontent.com/1cd0ea515e519415dfcab5378647d0793d188ea60f0e0f36c2727ab512b50ec4/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f762f72656c656173652f74696a6d652f646974746f62797465733f7374796c653d666f722d7468652d6261646765266c6162656c436f6c6f723d38353034343726636f6c6f723d6261303734352663616368653d31)](https://github.com/tijme/dittobytes/releases)[![Latest Dittobytes status](https://camo.githubusercontent.com/ef8b23ae61255eb085956d419c01d26c5edece5fac4b615e6035da4e0ced0640/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f616374696f6e732f776f726b666c6f772f7374617475732f74696a6d652f646974746f62797465732f76616c69646174696f6e2e796d6c3f7374796c653d666f722d7468652d6261646765266c6162656c436f6c6f723d38353034343726636f6c6f723d6261303734352663616368653d31)](https://github.com/tijme/dittobytes/actions)[![Dittobytes license badge](https://camo.githubusercontent.com/6b94880adb038332532292142aebaf0433aac748a5e884ed60ec5ebc3538ff20/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4c6963656e73652d4d504c25323056322e302d6261303734353f7374796c653d666f722d7468652d6261646765266c6162656c436f6c6f723d3835303434372663616368653d31)](https://github.com/tijme/dittobytes/blob/master/LICENSE.md)

[![AMD64 logo](https://gist.githubusercontent.com/tijme/ac043c7360ebcb89ac3be393a152dde0/raw/2f4bfb6f639419b49c9a2e3bfa440fdfd7576949/arch_amd64.svg)](https://gist.githubusercontent.com/tijme/ac043c7360ebcb89ac3be393a152dde0/raw/2f4bfb6f639419b49c9a2e3bfa440fdfd7576949/arch_amd64.svg)[![MacOS logo](https://gist.githubusercontent.com/tijme/7262f114a2e018e323fd97837525f87d/raw/5e58faa4765f054e86e7c774be06bacb6e630b7b/os_macos.svg)](https://gist.githubusercontent.com/tijme/7262f114a2e018e323fd97837525f87d/raw/5e58faa4765f054e86e7c774be06bacb6e630b7b/os_macos.svg)[![Windows logo](https://gist.githubusercontent.com/tijme/7262f114a2e018e323fd97837525f87d/raw/5e58faa4765f054e86e7c774be06bacb6e630b7b/os_windows.svg)](https://gist.githubusercontent.com/tijme/7262f114a2e018e323fd97837525f87d/raw/5e58faa4765f054e86e7c774be06bacb6e630b7b/os_windows.svg)[![Linux logo](https://gist.githubusercontent.com/tijme/7262f114a2e018e323fd97837525f87d/raw/5e58faa4765f054e86e7c774be06bacb6e630b7b/os_linux.svg)](https://gist.githubusercontent.com/tijme/7262f114a2e018e323fd97837525f87d/raw/5e58faa4765f054e86e7c774be06bacb6e630b7b/os_linux.svg)[![ARCH64 logo](https://gist.githubusercontent.com/tijme/a5e815ace37e12dc8e36060cc31cee4d/raw/2f6fba67d2d597294de5ccaec48d1325f0c76354/arch_arm64.svg)](https://gist.githubusercontent.com/tijme/a5e815ace37e12dc8e36060cc31cee4d/raw/2f6fba67d2d597294de5ccaec48d1325f0c76354/arch_arm64.svg)

**Metamorphic cross-compilation of C++ & C-code to PIC, BOF & EXE.**

Built with ♥ by [Tijme Gommers](https://www.linkedin.com/in/tijme/) – Buy me a coffee via [PayPal](https://dittobytes.com/sponsor-via-paypal) or [Bunq](https://dittobytes.com/sponsor-via-bunq).

[Requirements](https://github.com/tijme/dittobytes#-system-requirements)
•
[Getting started](https://github.com/tijme/dittobytes#-getting-started)
•
[Advanced usage](https://github.com/tijme/dittobytes#-advanced-usage)
•
[Metamorphications](https://github.com/tijme/dittobytes#-metamorphications)
•
[Limitations](https://github.com/tijme/dittobytes#-limitations)
•
[Issues](https://github.com/tijme/dittobytes#-issues--requests)
•
[License](https://github.com/tijme/dittobytes#-license--copyright)

* * *

Dittobytes compiles your C-code to truly Position Independent Code (PIC) for Windows, MacOS, and Linux, and both AMD64 and ARM64. It features a [metamorphic engine](https://en.wikipedia.org/wiki/Metamorphic_code) that ensures each compilation produces unique, functional shellcode. It does _not_ rely on the classic decrypt stubs often seen in e.g. polymorphic compilations, and additionally it does _not_ require reflective loaders such as Donut or sRDI as it can compile your C-code directly to PIC. A subsequent advantage is that the output size of the shellcode is extremely small (almost no overhead), and remains very simple.

|     |     |     |
| --- | --- | --- |
| Original |  | Metamorphicated (example) |
| ```<br># push    rbp<br># mov     rbp, rsp<br>- push    r15<br>- push    r11<br>- sub     rsp, 40h<br>- xor     rax, rax<br>- mov     [rbp+var_1B], rax<br>``` | → | ```<br># push    rbp<br># mov     rbp, rsp<br>+ push    r9<br>+ push    r15<br>+ sub     rsp, 38h<br>+ mov     rdx, 0<br>+ mov     [rbp+var_33], rdx<br>``` |

Illustration 1: Example metamorphications by Dittobytes (left and right are functionally equivalent).

Dittobytes uses a custom LLVM build with two transpilers. Any compilation of your code using Dittobytes is done with this LLVM build. The first transpiler uses a modern [LLVM Function Pass](https://llvm.org/docs/WritingAnLLVMNewPMPass.html) (on intermediate level) to inline constant variables otherwise located in e.g. `.rodata` segments (this aids the development of Position Independent Code). The second one is the machine transpiler that uses a legacy [LLVM MachineFunction Pass](https://llvm.org/docs/WritingAnLLVMPass.html#the-machinefunctionpass-class) to perform the metamorphic transformations (e.g. instruction substitutions), introducing randomness in the assembly code during compilation. Check the [roadmap](https://github.com/tijme/dittobytes#-metamorphications) for all implemented (and yet to implement) metamorphic transformations.

The pre-shippped minimal C-code file (`./code/beacon.c`) can cross-compile to all supported platforms (Windows, Linux & MacOS), architectures (AMD64 & ARM64) and formats (PIC, BOF, EXE). Additionally, Dittobytes ships with loaders (for each platform and architecture) that can be used for testing purposes.

# [![](https://gist.githubusercontent.com/tijme/c77f321c8dacd6d8ce8e0f9e2ab8c719/raw/b74e2cd4679ddc3dc6e14c0651d1489cddfd1ea8/logo-heading.svg)](https://gist.githubusercontent.com/tijme/c77f321c8dacd6d8ce8e0f9e2ab8c719/raw/b74e2cd4679ddc3dc6e14c0651d1489cddfd1ea8/logo-heading.svg) System requirements

[Permalink:  System requirements](https://github.com/tijme/dittobytes#-system-requirements)

The build environment itself works best (and is tested) on Linux (AMD64 & ARM64). Use Docker for an easy setup.

System requirements if you use **Docker**

Difficulty: **easy**

* * *

A custom version of [LLVM](https://github.com/tijme/forked-dittobytes-llvm-project/tree/release/18.x) needs to be built from source, which requires quite some memory and disk space to be allocated by Docker. The build takes around 2.5 hours. I got it to work with the following Docker resource configuration.


> ⚠️ If Docker cannot allocate enough resources, the build might fail with an error like `ResourceExhausted: cannot allocate memory`.

- Set CPU limit to: `8`.
- Set memory limit to: `10 GB`.
- Set swap to: `2 GB`.
- Set disk usage limit: `1 TB` (though this can likely be much lower).

* * *

System requirements if you use **Windows Subsystem for Linux**

Difficulty: **intermediate**

* * *

A custom version of [LLVM](https://github.com/tijme/forked-dittobytes-llvm-project/tree/release/18.x) needs to be built from source. Quite some memory and disk space is required. The build takes around 2.5 hours. I got it to work with the following resources.


- CPU cores: `8`.
- Memory: `10 GB`.
- Disk space: `1 TB` (though this can likely be much lower).

* * *

System requirements if you directly use **your host**

Difficulty: **advanced**

* * *

A custom version of [LLVM](https://github.com/tijme/forked-dittobytes-llvm-project/tree/release/18.x) needs to be built from source. Quite some memory and disk space is required. The build takes around 2.5 hours. I got it to work with the following resources.


- CPU cores: `8`.
- Memory: `10 GB`.
- Disk space: `1 TB` (though this can likely be much lower).

* * *

# [![](https://gist.githubusercontent.com/tijme/c77f321c8dacd6d8ce8e0f9e2ab8c719/raw/b74e2cd4679ddc3dc6e14c0651d1489cddfd1ea8/logo-heading.svg)](https://gist.githubusercontent.com/tijme/c77f321c8dacd6d8ce8e0f9e2ab8c719/raw/b74e2cd4679ddc3dc6e14c0651d1489cddfd1ea8/logo-heading.svg) Getting started

[Permalink:  Getting started](https://github.com/tijme/dittobytes#-getting-started)

### Presentation

[Permalink: Presentation](https://github.com/tijme/dittobytes#presentation)

This research has been presented at OrangeCon 2025. [The slides](https://github.com/tijme/dittobytes/blob/master/.github/presentation/In%20Memory%20of%20In-Memory%20Detection.pdf) are available on GitHub and a [recording](https://www.youtube.com/watch?v=9tCT2ItbPD4) can be found on YouTube.

### Overview

[Permalink: Overview](https://github.com/tijme/dittobytes#overview)

Directory structure

* * *

```
dittobytes/
├── code/                               # Your C-code that will compile to shellcode.
│   ├── beacon.c                        # Example file that you can compile using Dittobytes.
├── build/                              # Build dir containing loaders and your shellcodes.
│   ├── beacon-[platform]-[arch].raw    # Your C-code compiled to raw shellcode (.text segment only).
│   ├── beacon-[platform]-[arch].obj    # Your C-code compiled to BOF/COFF format.
│   ├── beacon-[platform]-[arch].exe    # Your C-code compiled to executable format.
│   ├── loader-[platform]-[arch]        # Pre-built raw shellcode loaders for testing purposes.
│   └── ...
└── ditto/                              # Internal files supporting the Dittobytes project.
    ├── loaders/                        # Simple shellcode loaders for testing purposes (pre-built).
    │   └── [platform]/
    │       ├── src/
    │       │   └── main.c
    │       └── lib/
    │           └── ...
    ├── scripts/                        # Helper scripts used by the makefile(s).
    │   ├── extract-text-segment.py
    │   └── ...
    ├── tests/                          # C-code files used for feature testing.
    │   ├── [feature-test].c
    │   └── ...
    └── transpilers/                    # The LLVM plugins that act as metamorphic engine.
        ├── intermediate/
        │   └── src/
        │       ├── IntermediateTranspiler.cpp
        │       └── ...
        └── machine/
            └── src/
                ├── MachineTranspiler.cpp
                └── ...
```

* * *

### Preparing

[Permalink: Preparing](https://github.com/tijme/dittobytes#preparing)

Cloning the repository

* * *

- Clone this repository using Git:




```
git clone https://github.com/tijme/dittobytes.git
```

- Manually [review](https://github.com/tijme/dittobytes/blob/master/.github/laughing.gif) the code so you know what you're compiling and running.
- Finally, move into the project directory and start developing:




```
cd ./dittobytes/
```


* * *

Configuring the build environment in a **Docker** container

Difficulty: **easy**

* * *

The easiest way to use Dittobytes is via Docker. For this, you need to build a Docker image using the provided `Dockerfile`.


- Build the Docker image:




```
docker buildx build -t dittobytes .
```

- Building the image will take around 2.5 hours as LLVM needs to be built from source.

* * *

Configuring the build environment in a **Windows Subsystem for Linux** container instead

Difficulty: **intermediate**

* * *

If you are on Windows, a more performant option to build the build tools is to use Windows Subsystem for Linux (WSL). However, in contrast to Docker, the installation of the build tools is a manual process.


- First of all, install a Debian WSL container:




```
wsl --install -d Debian
```

- Then start & enter the container:




```
wsl -d Debian
```


Custom versions of Clang and LLVM are eventually used to cross-compile your code, the loaders and the transpilers. Performing this compilation in WSL requires you to configure your WSL the same way as the Docker container is configured. Take a look at the [Dockerfile](https://github.com/tijme/dittobytes/blob/master/Dockerfile) or [GitHub Workflow](https://github.com/tijme/dittobytes/blob/master/.github/workflows/validation.yml) for reference. Follow the exact same steps as in one of those files. For now, there is no further documentation on setting up the environment in WSL.


* * *

Configuring the build environment on **your host** instead

Difficulty: **advanced**

* * *

Custom versions of Clang and LLVM are used to cross-compile your code, the loaders and the transpilers. If you want to perform this compilation on your host machine, configure your host the same way as the Docker container is configured. Take a look at the [Dockerfile](https://github.com/tijme/dittobytes/blob/master/Dockerfile) or [GitHub Workflow](https://github.com/tijme/dittobytes/blob/master/.github/workflows/validation.yml) for reference. Follow the exact same steps as in one of those files. And please make sure you're on a Linux host. For now, there is no further documentation on setting up the environment on your host machine.


* * *

### Developing

[Permalink: Developing](https://github.com/tijme/dittobytes#developing)

The basics

* * *

You can modify `./code/beacon.c` however you like. Just keep the following in mind:


- The first function in your code must be named `EntryFunction`.
- `EntryFunction` must literally (in order) be the first function in your code.
- You cannot use global variables (PIC limitation).
- You cannot use any data from other segments (PIC limitation).
- You must resolve any API function you want to use by yourself (PIC limitation).

The following example may give you some guidance. It simulates global variables by using a context struct that you would need to pass to any function you call. It initializes a string by using a `char[]` array. It calls another function by defining its definition first (as the other function needs to be defined before you can call it, but it cannot be the first function in your code).


[Example 'The Basics' (`example-basics.c`)](https://github.com/tijme/dittobytes/blob/master/code/examples/example-basics/example-basics.c)

* * *

A hello world

* * *

A hello world requires printing to the console, thus requiring an OS API call to e.g. `puts`. This is OS specific. For example, for Windows it would require loading `KERNEL32.dll`, ultimately resolving `LoadLibraryA` and `GetProcAddress`. With these two functions resolved, you can then load any function address, such as the address of `puts`.


An example would become quite large, thus for now I'd like to forward you to example file below. It is a Position Independent Code (PIC) for Windows AMD64 & ARM64 which pops a calculator as example.


[Example 'Popping Calc' (`example-calc.c`)](https://github.com/tijme/dittobytes/blob/master/code/examples/example-calc/example-calc.c)

* * *

### Compiling

[Permalink: Compiling](https://github.com/tijme/dittobytes#compiling)

Compile your code

* * *

- If using Docker, run the Dittobytes container (or use an equivalent command for your build environment):




```
docker run --rm -v ".:/tmp/workdir" -it dittobytes
```

- Compile your code (for all platforms, architectures & formats):




```
make
```

- You can also create specific builds: `make beacon-[platform]-[arch]-[format]`.

  - Options:
    - Platforms: `win`,`lin`,`mac`.
    - Architectures: `amd64`,`arm64`.
    - Formats: `exe`,`raw`,`bof`.
  - Examples:
    - `make beacon-win-amd64-bof` (compile your code to Windows AMD64 BOF/COFF).
    - `make beacon-mac-arm64-raw` (compile your code to MacOS ARM64 raw shellcode).
    - `make beacon-lin-all-raw` (compile your shellcode to raw shellcode for Linux and any architecture).
    - `make beacon-all-all-raw` (compile your shellcode to raw shellcode for any platform and architecture).
    - `make beacon-all-all-all` (compile your shellcode to any format any platform and any architecture).

* * *

### Outputs

[Permalink: Outputs](https://github.com/tijme/dittobytes#outputs)

Position Independent Code (`.raw`)

* * *

Dittobytes was originally designed to output Truly Position Independent Code (PIC). Simply put, PIC consists of the executable assembly instructions from the `.text` segment of an executable binary, without any reference to other segments or absolute memory addresses.

Dittobytes generates `.raw` files for Windows, Linux and MacOS (and both AMD64 and ARM64).

* * *

Beacon Object File (`.obj`)

* * *

In the process of creating Position Independent Code, Dittobytes creates an `.obj` file (COFF/ELF format). This file is later used to extract the `.text` segment (`.raw`) from, or create the executable format (`.exe`) with. However, the `.obj` file itself can be used as Cobalt Strike (or any other C&C framework) Beacon Object File (BOF) as well.

Dittobytes generates `.obj` files for Windows, Linux and MacOS (and both AMD64 and ARM64).

* * *

Executable/Clickable (`.exe`)

* * *

Dittobytes uses the generated Position Independent Code (PIC) in the `.obj` file to eventually generate an executable/clickable file format (`.exe`). This means that all executables generated by Dittobytes solely contain Position Independent Code (PIC). For example, constants are inlined instead of stored in the `.rodata` segment.

Dittobytes generates `.exe` files for Windows, Linux and MacOS (and both AMD64 and ARM64).

* * *

### Testing

[Permalink: Testing](https://github.com/tijme/dittobytes#testing)

Running your shellcode

* * *

- Run and test your shellcode using the pre-shipped shellcode loader:





```
./build/loader-[os]-[arch].[ext] ./build/beacon-[os]-[arch].raw
```


* * *

Running feature tests

* * *

Dittobytes comes pre-shipped with feature tests. A feature test is similar to a unit test, but tests from a large feature perspective, instead of a specific code unit perspective. Currently, you can only run feature tests for shellcodes that are compiled for the platform you are running the tests on. For example, in the Docker container only the Linux shellcode would be tested & verified.


- If using Docker, run a Dittobytes container:




```
docker run --rm -v ".:/tmp/workdir" -it dittobytes
```

- Build the tests:




```
make test-suite-build
```

- Run the tests:




```
make test-suite-test
```


* * *

# [![](https://gist.githubusercontent.com/tijme/c77f321c8dacd6d8ce8e0f9e2ab8c719/raw/b74e2cd4679ddc3dc6e14c0651d1489cddfd1ea8/logo-heading.svg)](https://gist.githubusercontent.com/tijme/c77f321c8dacd6d8ce8e0f9e2ab8c719/raw/b74e2cd4679ddc3dc6e14c0651d1489cddfd1ea8/logo-heading.svg) Advanced usage

[Permalink:  Advanced usage](https://github.com/tijme/dittobytes#-advanced-usage)

Using C++ instead of C for your code

* * *

You can easily utilize functionality of C++ by renaming your code file from `./code/beacon.c` to `./code/beacon.cpp`. Just make sure to prepend the `EntryFunction` in the file with `extern "C"`. Also ensure that the `SOURCE_PATH` option in the `makefile` points to the new filename. Do note that you **cannot** use functionality from external libraries such as `libstdc++` or `libc++`. This means you **cannot** make use of e.g. `std::string`⚠️.


[Example 'C++ instead of C-code' (`example-cpp.c`)](https://github.com/tijme/dittobytes/blob/master/code/examples/example-cpp/example-cpp.cpp)

Compiling C++ code in Dittobytes works exactly the same as compiling regular C-code.

- If using Docker, run a Dittobytes container:




```
docker run --rm -v ".:/tmp/workdir" -it dittobytes
```

- Then compile your code:




```
make
```


* * *

Compiling a Cobalt Strike Beacon Object File (BOF)

* * *

To compile a Beacon Object File (BOF) for Cobalt Strike or any other Command & Control framework, copy `./code/examples/example-bof/example-bof.c` to `./code/beacon.c`. Then adjust the source code to your needs.


[Example 'Beacon Object File' (`example-bof.c`)](https://github.com/tijme/dittobytes/blob/master/code/examples/example-bof/example-bof.c)

Remember to solely compile to the `BOF/COFF` format using the `make` command (see below example) ⚠️.

- If using Docker, run a Dittobytes container:




```
docker run --rm -v ".:/tmp/workdir" -it dittobytes
```

- Then compile your code:




```
make beacon-win-amd64-bof
```


* * *

Modification & compilation of the pre-shipped loaders

* * *

You can modify the pre-shipped loaders by editing the code in `./ditto/loaders/[platform]/src/main.c`, after which you can compile them using the following commands in the root of the Dittobytes project:


- If using Docker, run a Dittobytes container:




```
docker run --rm -v ".:/tmp/workdir" -it dittobytes
```

- Compile the loaders:




```
make ditto-loaders
```


* * *

Modification & compilation of the pre-shipped transpilers

* * *

You can modify the pre-shipped transpiler(s) by editing the code in `./ditto/transpilers/[type]/src/[type].cpp`, after which you can compile them using the following commands in the root of the Dittobytes project:


- If using Docker, run a Dittobytes container:




```
docker run --rm -v ".:/tmp/workdir" -it dittobytes
```

- Compile the transpilers:




```
make ditto-transpilers
```


Dittobytes ships with two transpilers. The first one is the intermediate transpiler that uses a modern [LLVM Function Pass](https://llvm.org/docs/WritingAnLLVMNewPMPass.html) to inline constant variables otherwise located in `.rodata` segments. The second one is the machine transpiler that uses a legacy [LLVM MachineFunction Pass](https://llvm.org/docs/WritingAnLLVMPass.html#the-machinefunctionpass-class) to perform the metamorphism.


* * *

Compiling & running one specific feature test

* * *

The test-suite commands in the makefile usually compile and test all feature tests (cross-os and cross-architecture). If you want to test just one specific feature test, or if you want to to test build artifacts for a specific os or architecture, use the commands below. You can adjust the `TEST_*` arguments to your needs.


- If using Docker, run a Dittobytes container:




```
docker run --rm -v ".:/tmp/workdir" -it dittobytes
```

- Build the test(s):




```
make TEST_OS=win TEST_ARCH=arm64 TEST_SOURCE_PATH=./ditto/tests/all/all/3_metamorphication_010_transform_nullifications.c TEST_METAMORPHICATION=transform_nullifications test-suite-build
```

- Run the test(s):




```
make TEST_OS=win TEST_ARCH=arm64 TEST_SOURCE_PATH=./ditto/tests/all/all/3_metamorphication_010_transform_nullifications.c TEST_METAMORPHICATION=transform_nullifications test-suite-test
```


The above example would build the feature test `3_metamorphication_010_transform_nullifications.c` for Windows ARM64. This may result in many build artifacts (`[amount of feature tests] × [amount of os's] × [amount of arch's] × [amount of metamorphications]`), in this case 1 (`1 × 1 × 1 × 1`). The second command verifies the build artifacts based on the `@verify` statements in the feature test source code file(s).


* * *

# [![](https://gist.githubusercontent.com/tijme/c77f321c8dacd6d8ce8e0f9e2ab8c719/raw/b74e2cd4679ddc3dc6e14c0651d1489cddfd1ea8/logo-heading.svg)](https://gist.githubusercontent.com/tijme/c77f321c8dacd6d8ce8e0f9e2ab8c719/raw/b74e2cd4679ddc3dc6e14c0651d1489cddfd1ea8/logo-heading.svg) Metamorphications

[Permalink:  Metamorphications](https://github.com/tijme/dittobytes#-metamorphications)

There is no specific planning, so this might be more of a to-do or progress list.

✅ Randomize register allocation

Implemented in release 1.0.0.

Randomizes the allocation order of CPU registers, causing different registers to be used each compile.

|     |     |     |     |
| --- | --- | --- | --- |
| Original |  | Metamorphicated (sample 1) | Metamorphicated (sample 2) |
| ```<br>- mov     rcx, 3Eh<br>- mov     rdx, 4Fh<br>- lea     r8, [rbp+var]<br>``` | → | ```<br>+ mov     r11, 3Eh<br>+ mov     r10, 4Fh<br>+ lea     r9, [rbp+var]<br>``` | ```<br>+ mov     r9, 3Eh<br>+ mov     r12, 4Fh<br>+ lea     rdi, [rbp+var]<br>``` |

* * *

✅ Transform ```mov reg, imm```

Implemented in release 1.0.0.

Substitutes instructions that move an immediate value to a register in various ways each compile.

|     |     |     |     |
| --- | --- | --- | --- |
| Original |  | Metamorphicated (sample 1) | Metamorphicated (sample 2) |
| ```<br>- mov     rcx, BAh<br>``` | → | ```<br>+ mov     rax, EFh<br>+ mov     rcx, 55h<br>+ xor     rcx, rax<br>``` | ```<br>+ mov     rax, 3Bh<br>+ mov     rcx, 7Fh<br>+ add     rcx, rax<br>``` |

* * *

✅ Transform ```mov [reg+var], imm```

Implemented in release 1.0.9.

Substitutes instructions that move an immediate value to the stack in various ways each compile.

|     |     |     |     |
| --- | --- | --- | --- |
| Original |  | Metamorphicated (sample 1) | Metamorphicated (sample 2) |
| ```<br>- mov     [rcx+var_8], 83h<br>``` | → | ```<br>+ mov     rax, D9h<br>+ mov     [rcx+var_8], AAh<br>+ add     [rcx+var_8], rax<br>``` | ```<br>+ mov     rax, 11h<br>+ mov     [rcx+var_8], 92h<br>+ xor     [rcx+var_8], rax<br>``` |

* * *

✅ Transform nullifications

Implemented in release 1.0.2.

Substitutes various instructions that nullify a register each compile.

|     |     |     |     |
| --- | --- | --- | --- |
| Original |  | Metamorphicated (sample 1) | Metamorphicated (sample 2) |
| ```<br>- xor     r12, r12<br>``` | → | ```<br>+ mov     r12, 0<br>``` | ```<br>! Yet to be implemented<br>+ sub     r12, r12<br>``` |

* * *

⏳ Insert semantic noise (meaningful dead code)

To be implemented.

Insertion of opaque instructions or basic blocks (from trusted software) that do not affect code functionality.

|     |     |     |     |
| --- | --- | --- | --- |
| Original |  | Metamorphicated (sample 1) | Metamorphicated (sample 2) |
| ```<br>- mov     rax, 1<br>``` | → | ```<br>+ mov     rax, 1<br>+ mov     rbx, [false_flag]<br>+ cmp     rbx, 1<br>+ -- more instructions --<br>+ je      skip_next_instr<br>+ -- more instructions --<br>+ mov     rax, 42<br>``` | ```<br>+ mov     rax, 1<br>+ -- more instructions --<br>+ mov     rbx, [false_flag]<br>+ -- more instructions --<br>+ cmp     rbx, 0<br>+ je      skip_next_instr<br>+ mov     rax, 1<br>+ -- more instructions --<br>``` |

* * *

⏳ Transform ```mov reg, reg```

To be implemented.

Substitutes instructions that move a register value to another register in various ways each compile.

|     |     |     |     |
| --- | --- | --- | --- |
| Original |  | Metamorphicated (sample 1) | Metamorphicated (sample 2) |
| ```<br>- mov     rax, r8<br>``` | → | ```<br>+ push    r8<br>+ pop     rax<br>``` | ```<br>+ xor rax, rax<br>+ add rax, r8<br>``` |

* * *

⏳ Swap simple math

To be implemented.

Transform mathematical instructions with equivalents each compile.

|     |     |     |     |
| --- | --- | --- | --- |
| Original |  | Metamorphicated (sample 1) | Metamorphicated (sample 2) |
| ```<br>- sub reg, imm<br>``` | → | ```<br>+ add reg, -imm<br>``` | ```<br>+ lea reg, [reg - imm]<br>``` |

* * *

⏳ Transform ```mov reg, reg```

To be implemented.

Substitutes instructions that move a register value to another register in various ways each compile.

|     |     |     |     |
| --- | --- | --- | --- |
| Original |  | Metamorphicated (sample 1) | Metamorphicated (sample 2) |
| ```<br>- mov     rax, r8<br>``` | → | ```<br>+ push    r8<br>+ pop     rax<br>``` | ```<br>+ xor rax, rax<br>+ add rax, r8<br>``` |

* * *

# [![](https://gist.githubusercontent.com/tijme/c77f321c8dacd6d8ce8e0f9e2ab8c719/raw/b74e2cd4679ddc3dc6e14c0651d1489cddfd1ea8/logo-heading.svg)](https://gist.githubusercontent.com/tijme/c77f321c8dacd6d8ce8e0f9e2ab8c719/raw/b74e2cd4679ddc3dc6e14c0651d1489cddfd1ea8/logo-heading.svg) Limitations

[Permalink:  Limitations](https://github.com/tijme/dittobytes#-limitations)

There are currently two known limitation in the use of Dittobytes.

- LLVM cannot inline compile `float`'s and `double`'s, causing them to end up in the `.rodata` segment. As a result, these types do not work when compiled with Dittobytes.
- C++ exceptions are not yet supported as they generate exception tables outside the `.text` segment.

# [![](https://gist.githubusercontent.com/tijme/c77f321c8dacd6d8ce8e0f9e2ab8c719/raw/b74e2cd4679ddc3dc6e14c0651d1489cddfd1ea8/logo-heading.svg)](https://gist.githubusercontent.com/tijme/c77f321c8dacd6d8ce8e0f9e2ab8c719/raw/b74e2cd4679ddc3dc6e14c0651d1489cddfd1ea8/logo-heading.svg) Issues & requests

[Permalink:  Issues & requests](https://github.com/tijme/dittobytes#-issues--requests)

Issues or new feature requests can be reported via the [issue tracker](https://github.com/tijme/dittobytes/issues). Please make sure your issue or feature has not yet been reported by anyone else before submitting a new one.

# [![](https://gist.githubusercontent.com/tijme/c77f321c8dacd6d8ce8e0f9e2ab8c719/raw/b74e2cd4679ddc3dc6e14c0651d1489cddfd1ea8/logo-heading.svg)](https://gist.githubusercontent.com/tijme/c77f321c8dacd6d8ce8e0f9e2ab8c719/raw/b74e2cd4679ddc3dc6e14c0651d1489cddfd1ea8/logo-heading.svg) License & copyright

[Permalink:  License & copyright](https://github.com/tijme/dittobytes#-license--copyright)

Copyright © 2025 Tijme Gommers. Dittobytes is released under the Mozilla Public License Version 2.0. View [LICENSE.md](https://github.com/tijme/dittobytes/blob/master/LICENSE.md) for the full license. Dittobytes depends on various open-source components which all have their own license and copyright.

## About

Metamorphic cross-compilation of C++ & C-code to PIC, BOF & EXE.


### Topics

[windows](https://github.com/topics/windows "Topic: windows") [macos](https://github.com/topics/macos "Topic: macos") [linux](https://github.com/topics/linux "Topic: linux") [obfuscation](https://github.com/topics/obfuscation "Topic: obfuscation") [llvm](https://github.com/topics/llvm "Topic: llvm") [polymorphic](https://github.com/topics/polymorphic "Topic: polymorphic") [malware](https://github.com/topics/malware "Topic: malware") [pic](https://github.com/topics/pic "Topic: pic") [clang](https://github.com/topics/clang "Topic: clang") [obfuscator](https://github.com/topics/obfuscator "Topic: obfuscator") [shellcode](https://github.com/topics/shellcode "Topic: shellcode") [polymorphism](https://github.com/topics/polymorphism "Topic: polymorphism") [evasion](https://github.com/topics/evasion "Topic: evasion") [metamorphic](https://github.com/topics/metamorphic "Topic: metamorphic") [redteam](https://github.com/topics/redteam "Topic: redteam") [metamorphism](https://github.com/topics/metamorphism "Topic: metamorphism") [position-independent-code](https://github.com/topics/position-independent-code "Topic: position-independent-code") [beacon-object-file](https://github.com/topics/beacon-object-file "Topic: beacon-object-file") [metamorphic-engine](https://github.com/topics/metamorphic-engine "Topic: metamorphic-engine")

### Resources

[Readme](https://github.com/tijme/dittobytes#readme-ov-file)

### License

[MPL-2.0 license](https://github.com/tijme/dittobytes#MPL-2.0-1-ov-file)

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/tijme/dittobytes).

[Activity](https://github.com/tijme/dittobytes/activity)

### Stars

[**601**\\
stars](https://github.com/tijme/dittobytes/stargazers)

### Watchers

[**7**\\
watching](https://github.com/tijme/dittobytes/watchers)

### Forks

[**69**\\
forks](https://github.com/tijme/dittobytes/forks)

[Report repository](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Ftijme%2Fdittobytes&report=tijme+%28user%29)

## [Releases\  11](https://github.com/tijme/dittobytes/releases)

[Release 1.0.10\\
Latest\\
\\
Aug 5, 2025](https://github.com/tijme/dittobytes/releases/tag/release-1.0.10)

[\+ 10 releases](https://github.com/tijme/dittobytes/releases)

## Sponsor this project

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/tijme/dittobytes).

- [dittobytes.com/sponsor-via-paypal](http://dittobytes.com/sponsor-via-paypal)
- [dittobytes.com/sponsor-via-bunq](http://dittobytes.com/sponsor-via-bunq)

[Learn more about GitHub Sponsors](https://github.com/sponsors)

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/tijme/dittobytes).

## [Contributors\  2](https://github.com/tijme/dittobytes/graphs/contributors)

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/tijme/dittobytes).

## Languages

- [C++38.0%](https://github.com/tijme/dittobytes/search?l=c%2B%2B)
- [C32.7%](https://github.com/tijme/dittobytes/search?l=c)
- [Python14.1%](https://github.com/tijme/dittobytes/search?l=python)
- [Makefile14.1%](https://github.com/tijme/dittobytes/search?l=makefile)
- Other1.1%

You can’t perform that action at this time.