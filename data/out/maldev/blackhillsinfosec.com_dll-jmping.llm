Title:
DLL Jmping: Old Hollow Trampolines in Windows DLL Land

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post presents a variation of DLL hollowing that “backdoors” the in-memory `.text` sections of selected Windows DLLs to create a trampoline chain that ultimately transfers execution to shellcode.  
- It targets the problem that classic DLL hollowing and memory-backed payload staging are increasingly constrained by mitigations like CFG/XFG and policy controls like WDAC.  
- The technique dynamically enumerates DLLs under `C:\Windows\System32`, loads candidates with `LoadLibraryEx(..., DONT_RESOLVE_DLL_REFERENCES)`, rejects DLLs compiled with CFG, and locates each DLL’s `.text` section for patching.  
- It writes a small `mov rax, <addr>; call rax` stub at the start of each `.text` section, chaining through multiple DLLs so a thread start address appears to originate from a legitimate DLL region (e.g., in Process Hacker).  
- The author demonstrates execution with a MessageBox payload and shows that the chained approach reduces static detections versus a direct shellcode call in a simple VirusTotal comparison.  
- It’s primarily useful for red team/offensive tool developers and malware researchers interested in thread-origin spoofing and in-memory execution tradecraft under modern Windows mitigations.

Technical Focus:
- DLL hollowing variants using `.text` section patching
- CFG-aware DLL selection (IMAGE_DLLCHARACTERISTICS_GUARD_CF)
- `LoadLibraryEx` with `DONT_RESOLVE_DLL_REFERENCES` (avoid `DllMain`)
- PE parsing (DOS/NT headers, section enumeration)
- Trampoline/JOP-style call chaining and thread start spoofing
- In-memory payload staging and basic AV/ML evasion implications

Use Cases:
- Building memory-backed shellcode loaders that avoid obvious direct-call patterns
- Spoofing thread start addresses to appear inside legitimate DLL memory regions
- Dynamically selecting “safe” (non-CFG) system DLLs for code-staging on a target host
- Researching detection opportunities around `.text` tampering and anomalous DLL mappings

Keywords:
DLL hollowing, CFG, XFG, WDAC, LoadLibraryEx, DONT_RESOLVE_DLL_REFERENCES, PE headers, IMAGE_NT_HEADERS, IMAGE_SECTION_HEADER, .text section, thread start address spoofing, Process Hacker, trampoline, JOP, CreateThread, shellcode, in-memory patching, System32 enumeration, VirusTotal, Windows internals