Title:
Reflective DLL Injection v1.0 (Stephen Fewer)

Type:
Documentation

Short Summary (4–8 sentences max):
This paper describes “Reflective DLL Injection,” a Windows DLL injection technique where the DLL contains a minimal PE loader and loads itself from memory inside a target process. It addresses the problem of reliably loading a DLL without using the normal Windows loader path (e.g., LoadLibrary) and without registering the module in the target’s module lists. The core technique is an exported `ReflectiveLoader` function that finds its own in-memory image, resolves `LoadLibraryA`, `GetProcAddress`, and `VirtualAlloc` by parsing exports, allocates new memory, copies headers/sections, fixes imports and relocations, then calls `DllMain`. It emphasizes a small bootstrap shellcode that transfers execution to `ReflectiveLoader`, reducing staging footprint and avoiding touching disk. Detection discussion focuses on the absence of PEB module registration and the remaining artifacts (RWX memory regions and threads executing from non-module memory). It’s primarily useful for red teams, exploit developers, and malware authors, and secondarily for defenders building memory-based detection.

Technical Focus:
- In-memory PE loading (manual mapping) and reflective loaders  
- Windows DLL injection and remote code execution staging  
- PE structures: headers, sections, import table, relocation table, export table  
- API resolution via export parsing (kernel32)  
- Memory allocation/protections (VirtualAlloc, RWX regions)  
- Detection considerations: PEB module lists, thread call traces, memory scanning

Use Cases:
- Fileless post-exploitation payload staging (inject DLL without writing to disk)
- Building custom in-memory implants that avoid standard module enumeration
- Metasploit payload staging for DLL-based capabilities (e.g., VNC DLL stage)
- Researching/implementing manual-map loaders and reflective PE techniques
- Developing defensive detections for non-module executable memory and anomalous thread execution

Keywords:
Reflective DLL Injection, ReflectiveLoader, manual mapping, in-memory PE loader, DLL injection, Windows, kernel32.dll, LoadLibraryA, GetProcAddress, VirtualAlloc, PEB, module enumeration, import resolution, base relocations, DllMain, RWX memory, thread call stack tracing, Metasploit stage, shellcode bootstrap, fileless payload