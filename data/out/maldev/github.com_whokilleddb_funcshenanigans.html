# https://github.com/whokilleddb/funcshenanigans

<!DOCTYPE html><html lang="en" data-color-mode="auto" data-light-theme="light" data-dark-theme="dark" data-a11y-animated-images="system" data-a11y-link-underlines="true" class="js-focus-visible" data-js-focus-visible="" data-turbo-loaded="">

  <body class="logged-out env-production page-responsive" style="overflow-wrap: break-word; --dialog-scrollgutter: 31px;" data-dialog-scroll-optimized="">
    <div data-turbo-body="" class="logged-out env-production page-responsive" style="word-wrap: break-word;">
      <div id="__primerPortalRoot__" role="region" style="z-index: 1000; position: absolute; width: 100%;" data-turbo-permanent=""></div>
      

    <div class="position-relative header-wrapper js-header-wrapper ">
      <a href="https://github.com/whokilleddb/funcshenanigans#start-of-content" data-skip-target-assigned="false" class="px-2 py-4 color-bg-accent-emphasis color-fg-on-emphasis show-on-focus js-skip-to-content">Skip to content</a>

      <span data-view-component="true" class="progress-pjax-loader Progress position-fixed width-full">
    <span style="width: 0%;" data-view-component="true" class="Progress-item progress-pjax-loader-bar left-0 top-0 color-bg-accent-emphasis"></span>
</span>      
      
      <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-react-css.09a94c9db6a9e074.module.css">
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/keyboard-shortcuts-dialog.0205351a430dbeb5.module.css">

<react-partial partial-name="keyboard-shortcuts-dialog" data-ssr="false" data-attempted-ssr="false" data-react-profiling="true" data-catalyst="" class="loaded">
  
  
  <div data-target="react-partial.reactRoot"><div class="d-none"></div></div>
</react-partial>





      

          

              








      <div data-view-component="true" class="js-stale-session-flash stale-session-flash flash flash-warn flash-full">
  
        <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
        <span class="js-stale-session-flash-signed-in">You signed in with another tab or window. <a class="Link--inTextBlock" href="https://github.com/whokilleddb/funcshenanigans">Reload</a> to refresh your session.</span>
        <span class="js-stale-session-flash-signed-out">You signed out in another tab or window. <a class="Link--inTextBlock" href="https://github.com/whokilleddb/funcshenanigans">Reload</a> to refresh your session.</span>
        <span class="js-stale-session-flash-switched">You switched accounts on another tab or window. <a class="Link--inTextBlock" href="https://github.com/whokilleddb/funcshenanigans">Reload</a> to refresh your session.</span>

    <button id="icon-button-841b6772-e4a3-41db-8c1a-06e0c9001e54" aria-labelledby="tooltip-a47e6470-df2e-46fc-999e-a374e78915f4" type="button" data-view-component="true" class="Button Button--iconOnly Button--invisible Button--medium flash-close js-flash-close">  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x Button-visual">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
</button><tool-tip id="tooltip-a47e6470-df2e-46fc-999e-a374e78915f4" for="icon-button-841b6772-e4a3-41db-8c1a-06e0c9001e54" popover="manual" data-direction="s" data-type="label" data-view-component="true" class="sr-only position-absolute" aria-hidden="true" role="tooltip"><slot></slot>Dismiss alert</tool-tip>


  
</div>
    </div>

  <div id="start-of-content" class="show-on-focus"></div>








    <div id="js-flash-container" class="flash-container" data-turbo-replace="">




  
    
<div class="flash flash-full   {{ className }}">
  <div>
    <button autofocus="" class="flash-close js-flash-close" type="button" aria-label="Dismiss this message">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
    </button>
    <div aria-atomic="true" role="alert" class="js-flash-alert">
      
      <div>{{ message }}</div>

    </div>
  </div>
</div>
  
</div>


    






  <div class="application-main " data-commit-hovercards-enabled="" data-discussion-hovercards-enabled="" data-issue-and-pr-hovercards-enabled="" data-project-hovercards-enabled="">
        <div itemscope="" itemtype="http://schema.org/SoftwareSourceCode" class="">
    <main id="js-repo-pjax-container">
      
  





    






  

  <div id="repository-container-header" class="pt-3 hide-full-screen" style="background-color: var(--page-header-bgColor, var(--color-page-header-bg));" data-turbo-replace="">

      <div class="d-flex flex-nowrap flex-justify-end mb-3  px-3 px-lg-5" style="gap: 1rem;">

        <div class="flex-auto min-width-0 width-fit">
            
  <div class=" d-flex flex-wrap flex-items-center wb-break-word f3 text-normal">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-repo color-fg-muted mr-2">
    <path d="M2 2.5A2.5 2.5 0 0 1 4.5 0h8.75a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h1.75v-2h-8a1 1 0 0 0-.714 1.7.75.75 0 1 1-1.072 1.05A2.495 2.495 0 0 1 2 11.5Zm10.5-1h-8a1 1 0 0 0-1 1v6.708A2.486 2.486 0 0 1 4.5 9h8ZM5 12.25a.25.25 0 0 1 .25-.25h3.5a.25.25 0 0 1 .25.25v3.25a.25.25 0 0 1-.4.2l-1.45-1.087a.249.249 0 0 0-.3 0L5.4 15.7a.25.25 0 0 1-.4-.2Z"></path>
</svg>
    
    <span class="author flex-self-stretch" itemprop="author">
      <a class="url fn" rel="author" data-hovercard-type="user" data-hovercard-url="/users/whokilleddb/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/whokilleddb" aria-keyshortcuts="Alt+ArrowUp">
        whokilleddb
</a>    </span>
    <span class="mx-1 flex-self-stretch color-fg-muted">/</span>
    <strong itemprop="name" class="mr-2 flex-self-stretch">
      <a data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" href="https://github.com/whokilleddb/funcshenanigans">funcshenanigans</a>
    </strong>

    <span></span><span class="Label Label--secondary v-align-middle mr-1">Public</span>
  </div>


        </div>

        <div id="repository-details-container" class="flex-shrink-0" data-turbo-replace="" style="max-width: 70%;">
            <ul class="pagehead-actions flex-shrink-0 d-none d-md-inline" style="padding: 2px 0;">
    
      

  <li>
            <a href="https://github.com/login?return_to=%2Fwhokilleddb%2Ffuncshenanigans" rel="nofollow" id="repository-details-watch-button" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;notification subscription menu watch&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;LOG_IN&quot;,&quot;originating_url&quot;:&quot;https://github.com/whokilleddb/funcshenanigans&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="370589e0ef508673af3c6c1c1f8197883c64e5075983c9c2e2b65e86a9407a4a" aria-label="You must be signed in to change notification settings" data-view-component="true" class="btn-sm btn" aria-describedby="tooltip-062a5718-058f-45c5-a70b-bcfe1d9218e7">    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-bell mr-2">
    <path d="M8 16a2 2 0 0 0 1.985-1.75c.017-.137-.097-.25-.235-.25h-3.5c-.138 0-.252.113-.235.25A2 2 0 0 0 8 16ZM3 5a5 5 0 0 1 10 0v2.947c0 .05.015.098.042.139l1.703 2.555A1.519 1.519 0 0 1 13.482 13H2.518a1.516 1.516 0 0 1-1.263-2.36l1.703-2.554A.255.255 0 0 0 3 7.947Zm5-3.5A3.5 3.5 0 0 0 4.5 5v2.947c0 .346-.102.683-.294.97l-1.703 2.556a.017.017 0 0 0-.003.01l.001.006c0 .002.002.004.004.006l.006.004.007.001h10.964l.007-.001.006-.004.004-.006.001-.007a.017.017 0 0 0-.003-.01l-1.703-2.554a1.745 1.745 0 0 1-.294-.97V5A3.5 3.5 0 0 0 8 1.5Z"></path>
</svg>Notifications
</a>    <tool-tip id="tooltip-062a5718-058f-45c5-a70b-bcfe1d9218e7" for="repository-details-watch-button" popover="manual" data-direction="s" data-type="description" data-view-component="true" class="sr-only position-absolute" role="tooltip"><slot></slot>You must be signed in to change notification settings</tool-tip>

  </li>

  <li>
          <a icon="repo-forked" id="fork-button" href="https://github.com/login?return_to=%2Fwhokilleddb%2Ffuncshenanigans" rel="nofollow" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;repo details fork button&quot;,&quot;repository_id&quot;:997811929,&quot;auth_type&quot;:&quot;LOG_IN&quot;,&quot;originating_url&quot;:&quot;https://github.com/whokilleddb/funcshenanigans&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="f481d9c21b48130234b016cb48329c5f253508c06b0fc9fb7ad178091d951a41" data-view-component="true" class="btn-sm btn">    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-repo-forked mr-2">
    <path d="M5 5.372v.878c0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75v-.878a2.25 2.25 0 1 1 1.5 0v.878a2.25 2.25 0 0 1-2.25 2.25h-1.5v2.128a2.251 2.251 0 1 1-1.5 0V8.5h-1.5A2.25 2.25 0 0 1 3.5 6.25v-.878a2.25 2.25 0 1 1 1.5 0ZM5 3.25a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Zm6.75.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Zm-3 8.75a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Z"></path>
</svg>Fork
    <span id="repo-network-counter" data-pjax-replace="true" data-turbo-replace="true" title="3" data-view-component="true" class="Counter">3</span>
</a>
  </li>

  <li>
        <div data-view-component="true" class="BtnGroup d-flex">
        <a href="https://github.com/login?return_to=%2Fwhokilleddb%2Ffuncshenanigans" rel="nofollow" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;star button&quot;,&quot;repository_id&quot;:997811929,&quot;auth_type&quot;:&quot;LOG_IN&quot;,&quot;originating_url&quot;:&quot;https://github.com/whokilleddb/funcshenanigans&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="37338b277fa3ee90328722160036f38797659128c1e2f069c441e332fd351ef5" aria-label="You must be signed in to star a repository" data-view-component="true" class="tooltipped tooltipped-sw btn-sm btn">    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-star v-align-text-bottom d-inline-block mr-2">
    <path d="M8 .25a.75.75 0 0 1 .673.418l1.882 3.815 4.21.612a.75.75 0 0 1 .416 1.279l-3.046 2.97.719 4.192a.751.751 0 0 1-1.088.791L8 12.347l-3.766 1.98a.75.75 0 0 1-1.088-.79l.72-4.194L.818 6.374a.75.75 0 0 1 .416-1.28l4.21-.611L7.327.668A.75.75 0 0 1 8 .25Zm0 2.445L6.615 5.5a.75.75 0 0 1-.564.41l-3.097.45 2.24 2.184a.75.75 0 0 1 .216.664l-.528 3.084 2.769-1.456a.75.75 0 0 1 .698 0l2.77 1.456-.53-3.084a.75.75 0 0 1 .216-.664l2.24-2.183-3.096-.45a.75.75 0 0 1-.564-.41L8 2.694Z"></path>
</svg><span data-view-component="true" class="d-inline">
          Star
</span>          <span id="repo-stars-counter-star" aria-label="37 users starred this repository" data-singular-suffix="user starred this repository" data-plural-suffix="users starred this repository" data-turbo-replace="true" title="37" data-view-component="true" class="Counter js-social-count">37</span>
</a></div>
  </li>

</ul>

        </div>
      </div>

        <div id="responsive-meta-container" data-turbo-replace="">
      <div class="d-block d-md-none mb-2 px-3 px-md-4 px-lg-5">
      <p class="f4 mb-3 ">
        A bunch of shenanigans using functions, VEH and more
      </p>

    

    <div class="mb-3">
        <a class="Link--secondary no-underline mr-3" href="https://github.com/whokilleddb/funcshenanigans/stargazers">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-star mr-1">
    <path d="M8 .25a.75.75 0 0 1 .673.418l1.882 3.815 4.21.612a.75.75 0 0 1 .416 1.279l-3.046 2.97.719 4.192a.751.751 0 0 1-1.088.791L8 12.347l-3.766 1.98a.75.75 0 0 1-1.088-.79l.72-4.194L.818 6.374a.75.75 0 0 1 .416-1.28l4.21-.611L7.327.668A.75.75 0 0 1 8 .25Zm0 2.445L6.615 5.5a.75.75 0 0 1-.564.41l-3.097.45 2.24 2.184a.75.75 0 0 1 .216.664l-.528 3.084 2.769-1.456a.75.75 0 0 1 .698 0l2.77 1.456-.53-3.084a.75.75 0 0 1 .216-.664l2.24-2.183-3.096-.45a.75.75 0 0 1-.564-.41L8 2.694Z"></path>
</svg>
          <span class="text-bold">37</span>
          stars
</a>        <a class="Link--secondary no-underline mr-3" href="https://github.com/whokilleddb/funcshenanigans/forks">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-repo-forked mr-1">
    <path d="M5 5.372v.878c0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75v-.878a2.25 2.25 0 1 1 1.5 0v.878a2.25 2.25 0 0 1-2.25 2.25h-1.5v2.128a2.251 2.251 0 1 1-1.5 0V8.5h-1.5A2.25 2.25 0 0 1 3.5 6.25v-.878a2.25 2.25 0 1 1 1.5 0ZM5 3.25a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Zm6.75.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Zm-3 8.75a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Z"></path>
</svg>
          <span class="text-bold">3</span>
          forks
</a>        <a class="Link--secondary no-underline mr-3 d-inline-block" href="https://github.com/whokilleddb/funcshenanigans/branches">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-git-branch mr-1">
    <path d="M9.5 3.25a2.25 2.25 0 1 1 3 2.122V6A2.5 2.5 0 0 1 10 8.5H6a1 1 0 0 0-1 1v1.128a2.251 2.251 0 1 1-1.5 0V5.372a2.25 2.25 0 1 1 1.5 0v1.836A2.493 2.493 0 0 1 6 7h4a1 1 0 0 0 1-1v-.628A2.25 2.25 0 0 1 9.5 3.25Zm-6 0a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0Zm8.25-.75a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5ZM4.25 12a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Z"></path>
</svg>
          <span>Branches</span>
</a>        <a class="Link--secondary no-underline d-inline-block" href="https://github.com/whokilleddb/funcshenanigans/tags">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-tag mr-1">
    <path d="M1 7.775V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.752 1.752 0 0 1 1 7.775Zm1.5 0c0 .066.026.13.073.177l6.25 6.25a.25.25 0 0 0 .354 0l5.025-5.025a.25.25 0 0 0 0-.354l-6.25-6.25a.25.25 0 0 0-.177-.073H2.75a.25.25 0 0 0-.25.25ZM6 5a1 1 0 1 1 0 2 1 1 0 0 1 0-2Z"></path>
</svg>
          <span>Tags</span>
</a>        <a class="Link--secondary no-underline d-inline-block" href="https://github.com/whokilleddb/funcshenanigans/activity">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-pulse mr-1">
    <path d="M6 2c.306 0 .582.187.696.471L10 10.731l1.304-3.26A.751.751 0 0 1 12 7h3.25a.75.75 0 0 1 0 1.5h-2.742l-1.812 4.528a.751.751 0 0 1-1.392 0L6 4.77 4.696 8.03A.75.75 0 0 1 4 8.5H.75a.75.75 0 0 1 0-1.5h2.742l1.812-4.529A.751.751 0 0 1 6 2Z"></path>
</svg>
          <span>Activity</span>
</a>    </div>
      <div class="d-flex flex-wrap gap-2">
        <div class="flex-1">
            <div data-view-component="true" class="BtnGroup d-flex">
        <a href="https://github.com/login?return_to=%2Fwhokilleddb%2Ffuncshenanigans" rel="nofollow" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;star button&quot;,&quot;repository_id&quot;:997811929,&quot;auth_type&quot;:&quot;LOG_IN&quot;,&quot;originating_url&quot;:&quot;https://github.com/whokilleddb/funcshenanigans&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="37338b277fa3ee90328722160036f38797659128c1e2f069c441e332fd351ef5" aria-label="You must be signed in to star a repository" data-view-component="true" class="tooltipped tooltipped-sw btn-sm btn btn-block">    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-star v-align-text-bottom d-inline-block mr-2">
    <path d="M8 .25a.75.75 0 0 1 .673.418l1.882 3.815 4.21.612a.75.75 0 0 1 .416 1.279l-3.046 2.97.719 4.192a.751.751 0 0 1-1.088.791L8 12.347l-3.766 1.98a.75.75 0 0 1-1.088-.79l.72-4.194L.818 6.374a.75.75 0 0 1 .416-1.28l4.21-.611L7.327.668A.75.75 0 0 1 8 .25Zm0 2.445L6.615 5.5a.75.75 0 0 1-.564.41l-3.097.45 2.24 2.184a.75.75 0 0 1 .216.664l-.528 3.084 2.769-1.456a.75.75 0 0 1 .698 0l2.77 1.456-.53-3.084a.75.75 0 0 1 .216-.664l2.24-2.183-3.096-.45a.75.75 0 0 1-.564-.41L8 2.694Z"></path>
</svg><span data-view-component="true" class="d-inline">
          Star
</span>
</a></div>
        </div>
        <div class="flex-1">
                <a href="https://github.com/login?return_to=%2Fwhokilleddb%2Ffuncshenanigans" rel="nofollow" id="files-overview-watch-button" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;notification subscription menu watch&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;LOG_IN&quot;,&quot;originating_url&quot;:&quot;https://github.com/whokilleddb/funcshenanigans&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="370589e0ef508673af3c6c1c1f8197883c64e5075983c9c2e2b65e86a9407a4a" aria-label="You must be signed in to change notification settings" data-view-component="true" class="btn-sm btn btn-block" aria-describedby="tooltip-1d6b182f-4ce9-4dbc-8680-3f4da21b2c75">    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-bell mr-2">
    <path d="M8 16a2 2 0 0 0 1.985-1.75c.017-.137-.097-.25-.235-.25h-3.5c-.138 0-.252.113-.235.25A2 2 0 0 0 8 16ZM3 5a5 5 0 0 1 10 0v2.947c0 .05.015.098.042.139l1.703 2.555A1.519 1.519 0 0 1 13.482 13H2.518a1.516 1.516 0 0 1-1.263-2.36l1.703-2.554A.255.255 0 0 0 3 7.947Zm5-3.5A3.5 3.5 0 0 0 4.5 5v2.947c0 .346-.102.683-.294.97l-1.703 2.556a.017.017 0 0 0-.003.01l.001.006c0 .002.002.004.004.006l.006.004.007.001h10.964l.007-.001.006-.004.004-.006.001-.007a.017.017 0 0 0-.003-.01l-1.703-2.554a1.745 1.745 0 0 1-.294-.97V5A3.5 3.5 0 0 0 8 1.5Z"></path>
</svg>Notifications
</a>    <tool-tip id="tooltip-1d6b182f-4ce9-4dbc-8680-3f4da21b2c75" for="files-overview-watch-button" popover="manual" data-direction="s" data-type="description" data-view-component="true" class="sr-only position-absolute" role="tooltip"><slot></slot>You must be signed in to change notification settings</tool-tip>

        </div>
        <span>
          

        </span>
      </div>
  </div>

</div>


          

  </div>
  



<turbo-frame id="repo-content-turbo-frame" target="_top" data-turbo-action="advance" class="">
    <div id="repo-content-pjax-container" class="repository-content ">
    



    
      
  <h1 class="sr-only">whokilleddb/funcshenanigans</h1>
  <div class="clearfix container-xl px-md-4 px-lg-5 px-3">
    <div>

  <div style="max-width: 100%" data-view-component="true" class="Layout Layout--flowRow-until-md react-repos-overview-margin Layout--sidebarPosition-end Layout--sidebarPosition-flowRow-end">
  <div data-view-component="true" class="Layout-main">      <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-react-css.09a94c9db6a9e074.module.css">
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/49396.5ba3f08869efa1a6.module.css">
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/81900.e59e483fa290c79c.module.css">

<react-partial partial-name="repos-overview" data-ssr="true" data-attempted-ssr="true" data-react-profiling="true" data-catalyst="" class="loaded">
  
  
  <div data-target="react-partial.reactRoot"> <!-- --> <!-- --> <div class="OverviewContent-module__Box__PF75K"><div class="OverviewHeader-module__Box__cC1RH"></div><div class="OverviewContent-module__Box_1__MPS0U"><div class="OverviewContent-module__Box_2__Di8Pb"><div class="OverviewContent-module__Box_3__wzlJx"><button type="button" aria-haspopup="true" aria-expanded="false" tabindex="0" style="min-width:0" aria-label="main branch" data-testid="anchor-button" class="prc-Button-ButtonBase-9n-Xk overview-ref-selector width-full RefSelectorAnchoredOverlay-module__RefSelectorOverlayBtn__a3WK3" data-loading="false" data-size="medium" data-variant="default" id="ref-picker-repos-header-ref-selector" data-hotkey="w"><span data-component="buttonContent" data-align="center" class="prc-Button-ButtonContent-Iohp5"><span data-component="text" class="prc-Button-Label-FWkx3"><div class="RefSelectorAnchoredOverlay-module__RefSelectorOverlayContainer__yaf4p"><div class="RefSelectorAnchoredOverlay-module__RefSelectorOverlayHeader__XtXRG"><svg aria-hidden="true" focusable="false" class="octicon octicon-git-branch" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M9.5 3.25a2.25 2.25 0 1 1 3 2.122V6A2.5 2.5 0 0 1 10 8.5H6a1 1 0 0 0-1 1v1.128a2.251 2.251 0 1 1-1.5 0V5.372a2.25 2.25 0 1 1 1.5 0v1.836A2.493 2.493 0 0 1 6 7h4a1 1 0 0 0 1-1v-.628A2.25 2.25 0 0 1 9.5 3.25Zm-6 0a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0Zm8.25-.75a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5ZM4.25 12a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Z"></path></svg></div><div class="ref-selector-button-text-container RefSelectorAnchoredOverlay-module__RefSelectorBtnTextContainer__Di3rk"><span class="RefSelectorAnchoredOverlay-module__RefSelectorText__w_fmP">&nbsp;<!-- -->main</span></div></div></span><span data-component="trailingVisual" class="prc-Button-Visual-YNt2F prc-Button-VisualWrap-E4cnq"><svg aria-hidden="true" focusable="false" class="octicon octicon-triangle-down" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="m4.427 7.427 3.396 3.396a.25.25 0 0 0 .354 0l3.396-3.396A.25.25 0 0 0 11.396 7H4.604a.25.25 0 0 0-.177.427Z"></path></svg></span></span></button><button data-testid="ref-selector-hotkey-button" data-hotkey-scope="read-only-cursor-text-area" data-hotkey="w"></button></div><div class="OverviewContent-module__Box_4__qf73o"><a type="button" href="https://github.com/whokilleddb/funcshenanigans/branches" class="prc-Button-ButtonBase-9n-Xk OverviewContent-module__Button___Uotu" data-loading="false" data-size="medium" data-variant="invisible"><span data-component="buttonContent" data-align="center" class="prc-Button-ButtonContent-Iohp5"><span data-component="leadingVisual" class="prc-Button-Visual-YNt2F prc-Button-VisualWrap-E4cnq"><svg aria-hidden="true" focusable="false" class="octicon octicon-git-branch" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M9.5 3.25a2.25 2.25 0 1 1 3 2.122V6A2.5 2.5 0 0 1 10 8.5H6a1 1 0 0 0-1 1v1.128a2.251 2.251 0 1 1-1.5 0V5.372a2.25 2.25 0 1 1 1.5 0v1.836A2.493 2.493 0 0 1 6 7h4a1 1 0 0 0 1-1v-.628A2.25 2.25 0 0 1 9.5 3.25Zm-6 0a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0Zm8.25-.75a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5ZM4.25 12a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Z"></path></svg></span><span data-component="text" class="prc-Button-Label-FWkx3"><span><strong class="color-fg-default">1 </strong>Branch</span></span></span></a><a type="button" href="https://github.com/whokilleddb/funcshenanigans/tags" class="prc-Button-ButtonBase-9n-Xk OverviewContent-module__Button___Uotu" data-loading="false" data-size="medium" data-variant="invisible"><span data-component="buttonContent" data-align="center" class="prc-Button-ButtonContent-Iohp5"><span data-component="leadingVisual" class="prc-Button-Visual-YNt2F prc-Button-VisualWrap-E4cnq"><svg aria-hidden="true" focusable="false" class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M1 7.775V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.752 1.752 0 0 1 1 7.775Zm1.5 0c0 .066.026.13.073.177l6.25 6.25a.25.25 0 0 0 .354 0l5.025-5.025a.25.25 0 0 0 0-.354l-6.25-6.25a.25.25 0 0 0-.177-.073H2.75a.25.25 0 0 0-.25.25ZM6 5a1 1 0 1 1 0 2 1 1 0 0 1 0-2Z"></path></svg></span><span data-component="text" class="prc-Button-Label-FWkx3"><span><strong class="color-fg-default">0 </strong>Tags</span></span></span></a></div><div class="OverviewContent-module__Box_5__Zc3i7"><a type="button" aria-label="Go to Branches page" href="https://github.com/whokilleddb/funcshenanigans/branches" class="prc-Button-ButtonBase-9n-Xk OverviewContent-module__Button_1__vmS6D" data-loading="false" data-no-visuals="true" data-size="medium" data-variant="invisible"><svg aria-hidden="true" focusable="false" class="octicon octicon-git-branch" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M9.5 3.25a2.25 2.25 0 1 1 3 2.122V6A2.5 2.5 0 0 1 10 8.5H6a1 1 0 0 0-1 1v1.128a2.251 2.251 0 1 1-1.5 0V5.372a2.25 2.25 0 1 1 1.5 0v1.836A2.493 2.493 0 0 1 6 7h4a1 1 0 0 0 1-1v-.628A2.25 2.25 0 0 1 9.5 3.25Zm-6 0a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0Zm8.25-.75a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5ZM4.25 12a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Z"></path></svg></a><a type="button" aria-label="Go to Tags page" href="https://github.com/whokilleddb/funcshenanigans/tags" class="prc-Button-ButtonBase-9n-Xk OverviewContent-module__Button_1__vmS6D" data-loading="false" data-no-visuals="true" data-size="medium" data-variant="invisible"><svg aria-hidden="true" focusable="false" class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M1 7.775V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.752 1.752 0 0 1 1 7.775Zm1.5 0c0 .066.026.13.073.177l6.25 6.25a.25.25 0 0 0 .354 0l5.025-5.025a.25.25 0 0 0 0-.354l-6.25-6.25a.25.25 0 0 0-.177-.073H2.75a.25.25 0 0 0-.25.25ZM6 5a1 1 0 1 1 0 2 1 1 0 0 1 0-2Z"></path></svg></a></div></div><div class="OverviewContent-module__Box_6__Y_Yb_"><div class="OverviewContent-module__Box_7__JuRXo"><div class="OverviewContent-module__Box_8__UZCZh"><div class="Box-sc-62in7e-0 OverviewContent-module__FileResultsList__EjrTH"><span class="TextInput__StyledTextInput-sc-ttxlvl-0 d-flex FileResultsList-module__FilesSearchBox__ivVkc TextInput-wrapper prc-components-TextInputWrapper-Hpdqi prc-components-TextInputBaseWrapper-wY-n0" data-leading-visual="true" data-trailing-visual="true" aria-busy="false"><span class="TextInput-icon" id="_r_4_" aria-hidden="true"><svg aria-hidden="true" focusable="false" class="octicon octicon-search" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align: text-bottom;"><path d="M10.68 11.74a6 6 0 0 1-7.922-8.982 6 6 0 0 1 8.982 7.922l3.04 3.04a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215ZM11.5 7a4.499 4.499 0 1 0-8.997 0A4.499 4.499 0 0 0 11.5 7Z"></path></svg></span><input aria-label="Go to file" role="combobox" aria-controls="file-results-list" aria-expanded="false" aria-haspopup="dialog" autocorrect="off" spellcheck="false" placeholder="Go to file" aria-describedby="_r_4_ _r_5_" data-component="input" class="prc-components-Input-IwWrt" type="text" value=""><span class="TextInput-icon" id="_r_5_" aria-hidden="true"></span></span></div></div><div class="OverviewContent-module__Box_9__bqMPw"><button type="button" class="prc-Button-ButtonBase-9n-Xk" data-loading="false" data-no-visuals="true" data-size="medium" data-variant="default"><span data-component="buttonContent" data-align="center" class="prc-Button-ButtonContent-Iohp5"><span data-component="text" class="prc-Button-Label-FWkx3">Go to file</span></span></button></div></div><button type="button" aria-haspopup="true" aria-expanded="false" tabindex="0" class="prc-Button-ButtonBase-9n-Xk" data-loading="false" data-size="medium" data-variant="primary" id="_R_75ab_"><span data-component="buttonContent" data-align="center" class="prc-Button-ButtonContent-Iohp5"><span data-component="leadingVisual" class="prc-Button-Visual-YNt2F prc-Button-VisualWrap-E4cnq"><svg aria-hidden="true" focusable="false" class="octicon octicon-code hide-sm" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="m11.28 3.22 4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734L13.94 8l-3.72-3.72a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215Zm-6.56 0a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042L2.06 8l3.72 3.72a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L.47 8.53a.75.75 0 0 1 0-1.06Z"></path></svg></span><span data-component="text" class="prc-Button-Label-FWkx3">Code</span><span data-component="trailingVisual" class="prc-Button-Visual-YNt2F prc-Button-VisualWrap-E4cnq"><svg aria-hidden="true" focusable="false" class="octicon octicon-triangle-down" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="m4.427 7.427 3.396 3.396a.25.25 0 0 0 .354 0l3.396-3.396A.25.25 0 0 0 11.396 7H4.604a.25.25 0 0 0-.177.427Z"></path></svg></span></span></button><div class="OverviewContent-module__Box_10__mGSb4"><button data-component="IconButton" type="button" aria-haspopup="true" aria-expanded="false" tabindex="0" class="prc-Button-ButtonBase-9n-Xk prc-Button-IconButton-fyge7" data-loading="false" data-no-visuals="true" data-size="medium" data-variant="default" aria-labelledby="_R_7p5ab_" id="_R_95ab_"><svg aria-hidden="true" focusable="false" class="octicon octicon-kebab-horizontal" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M8 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3ZM1.5 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Zm13 0a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"></path></svg></button><span class="prc-TooltipV2-Tooltip-tLeuB" data-direction="n" aria-hidden="true" id="_R_7p5ab_" popover="auto">Open more actions menu</span></div></div></div><div class="OverviewContent-module__Box_11__F19kY"><div data-hpc="true"><button data-testid="focus-next-element-button" data-hotkey="j"></button><button data-testid="focus-previous-element-button" data-hotkey="k"></button><h2 class="sr-only ScreenReaderHeading-module__userSelectNone__rwWIk prc-Heading-Heading-MtWFE" data-testid="screen-reader-heading" id="folders-and-files">Folders and files</h2><table class="Table-module__Box__HZKiQ" aria-labelledby="folders-and-files"><thead class="DirectoryContent-module__OverviewHeaderRow__hOrKy Table-module__Box_1__VacXC"><tr class="Table-module__Box_2__PBp9s"><th colspan="2" class="DirectoryContent-module__Box__iC_5e"><span class="text-bold">Name</span></th><th colspan="1" class="DirectoryContent-module__Box_1__fuSBO"><span class="text-bold">Name</span></th><th class="hide-sm"><div class="width-fit prc-Truncate-Truncate-2G1eo" data-inline="true" title="Last commit message" style="--truncate-max-width:125px"><span class="text-bold">Last commit message</span></div></th><th colspan="1" class="DirectoryContent-module__Box_2__Ccrx7"><div class="width-fit prc-Truncate-Truncate-2G1eo" data-inline="true" title="Last commit date" style="--truncate-max-width:125px"><span class="text-bold">Last commit date</span></div></th></tr></thead><tbody><tr class="DirectoryContent-module__Box_3__gl6dE"><td colspan="3" class="bgColor-muted p-1 rounded-top-2"><div class="LatestCommit-module__Box__B25ZT"><h2 class="sr-only ScreenReaderHeading-module__userSelectNone__rwWIk prc-Heading-Heading-MtWFE" data-testid="screen-reader-heading">Latest commit</h2><div data-testid="latest-commit" class="LatestCommit-module__Box_1__YkEgg"><div class="CommitAttribution-module__CommitAttributionContainer__I_rfs"><div data-testid="author-avatar" class="Box-sc-62in7e-0 AuthorAvatar-module__AuthorAvatarContainer__n0MVc"><img data-component="Avatar" class="Box-sc-62in7e-0 kglDHV AuthorAvatar-module__authorAvatarImage__a3R8x prc-Avatar-Avatar-0xaUi" alt="author" width="20" height="20" data-testid="github-avatar" aria-label="author" src="https://github.githubassets.com/images/gravatars/gravatar-user-420.png?size=40" style="--avatarSize-regular: 20px;"><div class="AuthorDisplayName-module__truncate__d1MRu prc-Truncate-Truncate-2G1eo" data-inline="true" title="DB" style="--truncate-max-width: 125px;"><span class="Text__StyledText-sc-1klmep6-0 jZXqMA AuthorDisplayName-module__Text__OP5Q9 prc-Text-Text-9mHv3">DB</span></div></div><span class=""></span></div><div class="d-none d-sm-flex LatestCommit-module__Box_2__pSPKJ"><div class="Truncate flex-items-center f5"><span class="Text__StyledText-sc-1klmep6-0 Truncate-text prc-Text-Text-9mHv3" data-testid="latest-commit-html"><a href="https://github.com/whokilleddb/funcshenanigans/commit/72b98f04b8aeb3158010a8a8231d06ce82c3127c" class="Link--secondary" data-pjax="true" data-hovercard-url="/whokilleddb/funcshenanigans/commit/72b98f04b8aeb3158010a8a8231d06ce82c3127c/hovercard" aria-keyshortcuts="Alt+ArrowUp">spellcheck</a></span></div></div><span class="d-flex d-sm-none fgColor-muted f6"><relative-time tense="past" datetime="2025-06-08T20:52:54.000Z" title="Jun 8, 2025, 4:52 PM EDT">8 months agoJun 8, 2025</relative-time></span></div><div class="d-flex flex-shrink-0 gap-2"><div data-testid="latest-commit-details" class="d-none d-sm-flex flex-items-center"><span class="d-flex flex-nowrap fgColor-muted f6"><a class="Link--secondary prc-Link-Link-9ZwDx" aria-label="Commit 72b98f0" data-hovercard-url="/whokilleddb/funcshenanigans/commit/72b98f04b8aeb3158010a8a8231d06ce82c3127c/hovercard" data-hovercard-type="commit" octo-click="hovercard-link-click" octo-dimensions="link_type:self" aria-keyshortcuts="Alt+ArrowUp" href="https://github.com/whokilleddb/funcshenanigans/commit/72b98f04b8aeb3158010a8a8231d06ce82c3127c" data-discover="true">72b98f0</a>&nbsp;Â·&nbsp;<relative-time tense="past" datetime="2025-06-08T20:52:54.000Z" title="Jun 8, 2025, 4:52 PM EDT">8 months agoJun 8, 2025</relative-time></span></div><div class="d-flex gap-2"><h2 class="sr-only ScreenReaderHeading-module__userSelectNone__rwWIk prc-Heading-Heading-MtWFE" data-testid="screen-reader-heading">History</h2><a href="https://github.com/whokilleddb/funcshenanigans/commits/main/" class="prc-Button-ButtonBase-9n-Xk d-none d-lg-flex LinkButton-module__linkButton__nFnov flex-items-center fgColor-default" data-loading="false" data-size="small" data-variant="invisible"><span data-component="buttonContent" data-align="center" class="prc-Button-ButtonContent-Iohp5"><span data-component="leadingVisual" class="prc-Button-Visual-YNt2F prc-Button-VisualWrap-E4cnq"><svg aria-hidden="true" focusable="false" class="octicon octicon-history" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="m.427 1.927 1.215 1.215a8.002 8.002 0 1 1-1.6 5.685.75.75 0 1 1 1.493-.154 6.5 6.5 0 1 0 1.18-4.458l1.358 1.358A.25.25 0 0 1 3.896 6H.25A.25.25 0 0 1 0 5.75V2.104a.25.25 0 0 1 .427-.177ZM7.75 4a.75.75 0 0 1 .75.75v2.992l2.028.812a.75.75 0 0 1-.557 1.392l-2.5-1A.751.751 0 0 1 7 8.25v-3.5A.75.75 0 0 1 7.75 4Z"></path></svg></span><span data-component="text" class="prc-Button-Label-FWkx3"><span class="fgColor-default">6 Commits</span></span></span></a><div class="d-sm-none"><button data-component="IconButton" type="button" aria-pressed="false" aria-expanded="false" data-testid="latest-commit-details-toggle" class="prc-Button-ButtonBase-9n-Xk LatestCommit-module__IconButton__mkJr_ prc-Button-IconButton-fyge7" data-loading="false" data-no-visuals="true" data-size="small" data-variant="invisible" aria-labelledby="_r_a_"><svg aria-hidden="true" focusable="false" class="octicon octicon-ellipsis" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align: text-bottom;"><path d="M0 5.75C0 4.784.784 4 1.75 4h12.5c.966 0 1.75.784 1.75 1.75v4.5A1.75 1.75 0 0 1 14.25 12H1.75A1.75 1.75 0 0 1 0 10.25ZM12 7a1 1 0 1 0 0 2 1 1 0 0 0 0-2ZM7 8a1 1 0 1 0 2 0 1 1 0 0 0-2 0ZM4 7a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z"></path></svg></button><span class="prc-TooltipV2-Tooltip-tLeuB" data-direction="s" aria-hidden="true" id="_r_a_" popover="auto">Open commit details</span></div><div class="d-flex d-lg-none"><a aria-label="View commit history for this file." href="https://github.com/whokilleddb/funcshenanigans/commits/main/" class="prc-Button-ButtonBase-9n-Xk LinkButton-module__linkButton__nFnov flex-items-center fgColor-default" data-loading="false" data-size="small" data-variant="invisible" aria-describedby="_R_iqj8pab_"><span data-component="buttonContent" data-align="center" class="prc-Button-ButtonContent-Iohp5"><span data-component="leadingVisual" class="prc-Button-Visual-YNt2F prc-Button-VisualWrap-E4cnq"><svg aria-hidden="true" focusable="false" class="octicon octicon-history" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="m.427 1.927 1.215 1.215a8.002 8.002 0 1 1-1.6 5.685.75.75 0 1 1 1.493-.154 6.5 6.5 0 1 0 1.18-4.458l1.358 1.358A.25.25 0 0 1 3.896 6H.25A.25.25 0 0 1 0 5.75V2.104a.25.25 0 0 1 .427-.177ZM7.75 4a.75.75 0 0 1 .75.75v2.992l2.028.812a.75.75 0 0 1-.557 1.392l-2.5-1A.751.751 0 0 1 7 8.25v-3.5A.75.75 0 0 1 7.75 4Z"></path></svg></span></span></a><span class="prc-TooltipV2-Tooltip-tLeuB" data-direction="s" role="tooltip" aria-hidden="true" id="_R_iqj8pab_" popover="auto">6 Commits</span></div></div></div></div></td></tr><tr class="react-directory-row undefined" id="folder-row-0"><td class="react-directory-row-name-cell-small-screen" colspan="2"><div class="react-directory-filename-column"><svg aria-hidden="true" focusable="false" class="octicon octicon-file-directory-fill icon-directory" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M1.75 1A1.75 1.75 0 0 0 0 2.75v10.5C0 14.216.784 15 1.75 15h12.5A1.75 1.75 0 0 0 16 13.25v-8.5A1.75 1.75 0 0 0 14.25 3H7.5a.25.25 0 0 1-.2-.1l-.9-1.2C6.07 1.26 5.55 1 5 1H1.75Z"></path></svg><div class="overflow-hidden"><div class="react-directory-filename-cell"><div class="react-directory-truncate"><a title="imgs" aria-label="imgs, (Directory)" class="Link--primary" href="https://github.com/whokilleddb/funcshenanigans/tree/main/imgs" data-discover="true">imgs</a></div></div></div></div></td><td class="react-directory-row-name-cell-large-screen" colspan="1"><div class="react-directory-filename-column"><svg aria-hidden="true" focusable="false" class="octicon octicon-file-directory-fill icon-directory" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M1.75 1A1.75 1.75 0 0 0 0 2.75v10.5C0 14.216.784 15 1.75 15h12.5A1.75 1.75 0 0 0 16 13.25v-8.5A1.75 1.75 0 0 0 14.25 3H7.5a.25.25 0 0 1-.2-.1l-.9-1.2C6.07 1.26 5.55 1 5 1H1.75Z"></path></svg><div class="overflow-hidden"><div class="react-directory-filename-cell"><div class="react-directory-truncate"><a title="imgs" aria-label="imgs, (Directory)" class="Link--primary" href="https://github.com/whokilleddb/funcshenanigans/tree/main/imgs" data-discover="true">imgs</a></div></div></div></div></td><td class="react-directory-row-commit-cell"><div><div class="react-directory-commit-message"><a data-pjax="true" title="Updated README.md" class="Link--secondary" href="https://github.com/whokilleddb/funcshenanigans/commit/477a1dd3fd0e566e6e0b5593e7d803408d1180aa">Updated README.md</a></div></div></td><td><div class="react-directory-commit-age"><relative-time tense="past" datetime="2025-06-08T20:47:49.000Z" title="Jun 8, 2025, 4:47 PM EDT">8 months agoJun 8, 2025</relative-time></div></td></tr><tr class="react-directory-row undefined" id="folder-row-1"><td class="react-directory-row-name-cell-small-screen" colspan="2"><div class="react-directory-filename-column"><svg aria-hidden="true" focusable="false" class="octicon octicon-file-directory-fill icon-directory" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M1.75 1A1.75 1.75 0 0 0 0 2.75v10.5C0 14.216.784 15 1.75 15h12.5A1.75 1.75 0 0 0 16 13.25v-8.5A1.75 1.75 0 0 0 14.25 3H7.5a.25.25 0 0 1-.2-.1l-.9-1.2C6.07 1.26 5.55 1 5 1H1.75Z"></path></svg><div class="overflow-hidden"><div class="react-directory-filename-cell"><div class="react-directory-truncate"><a title="includes" aria-label="includes, (Directory)" class="Link--primary" href="https://github.com/whokilleddb/funcshenanigans/tree/main/includes" data-discover="true">includes</a></div></div></div></div></td><td class="react-directory-row-name-cell-large-screen" colspan="1"><div class="react-directory-filename-column"><svg aria-hidden="true" focusable="false" class="octicon octicon-file-directory-fill icon-directory" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M1.75 1A1.75 1.75 0 0 0 0 2.75v10.5C0 14.216.784 15 1.75 15h12.5A1.75 1.75 0 0 0 16 13.25v-8.5A1.75 1.75 0 0 0 14.25 3H7.5a.25.25 0 0 1-.2-.1l-.9-1.2C6.07 1.26 5.55 1 5 1H1.75Z"></path></svg><div class="overflow-hidden"><div class="react-directory-filename-cell"><div class="react-directory-truncate"><a title="includes" aria-label="includes, (Directory)" class="Link--primary" href="https://github.com/whokilleddb/funcshenanigans/tree/main/includes" data-discover="true">includes</a></div></div></div></div></td><td class="react-directory-row-commit-cell"><div><div class="react-directory-commit-message"><a data-pjax="true" title="Updated README" class="Link--secondary" href="https://github.com/whokilleddb/funcshenanigans/commit/f2bbe76de700d0c64beb3a57358c8cad7419a24a">Updated README</a></div></div></td><td><div class="react-directory-commit-age"><relative-time tense="past" datetime="2025-06-08T19:20:41.000Z" title="Jun 8, 2025, 3:20 PM EDT">8 months agoJun 8, 2025</relative-time></div></td></tr><tr class="react-directory-row undefined" id="folder-row-2"><td class="react-directory-row-name-cell-small-screen" colspan="2"><div class="react-directory-filename-column"><svg aria-hidden="true" focusable="false" class="octicon octicon-file-directory-fill icon-directory" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M1.75 1A1.75 1.75 0 0 0 0 2.75v10.5C0 14.216.784 15 1.75 15h12.5A1.75 1.75 0 0 0 16 13.25v-8.5A1.75 1.75 0 0 0 14.25 3H7.5a.25.25 0 0 1-.2-.1l-.9-1.2C6.07 1.26 5.55 1 5 1H1.75Z"></path></svg><div class="overflow-hidden"><div class="react-directory-filename-cell"><div class="react-directory-truncate"><a title="src" aria-label="src, (Directory)" class="Link--primary" href="https://github.com/whokilleddb/funcshenanigans/tree/main/src" data-discover="true">src</a></div></div></div></div></td><td class="react-directory-row-name-cell-large-screen" colspan="1"><div class="react-directory-filename-column"><svg aria-hidden="true" focusable="false" class="octicon octicon-file-directory-fill icon-directory" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M1.75 1A1.75 1.75 0 0 0 0 2.75v10.5C0 14.216.784 15 1.75 15h12.5A1.75 1.75 0 0 0 16 13.25v-8.5A1.75 1.75 0 0 0 14.25 3H7.5a.25.25 0 0 1-.2-.1l-.9-1.2C6.07 1.26 5.55 1 5 1H1.75Z"></path></svg><div class="overflow-hidden"><div class="react-directory-filename-cell"><div class="react-directory-truncate"><a title="src" aria-label="src, (Directory)" class="Link--primary" href="https://github.com/whokilleddb/funcshenanigans/tree/main/src" data-discover="true">src</a></div></div></div></div></td><td class="react-directory-row-commit-cell"><div><div class="react-directory-commit-message"><a data-pjax="true" title="spellcheck" class="Link--secondary" href="https://github.com/whokilleddb/funcshenanigans/commit/72b98f04b8aeb3158010a8a8231d06ce82c3127c">spellcheck</a></div></div></td><td><div class="react-directory-commit-age"><relative-time tense="past" datetime="2025-06-08T20:52:54.000Z" title="Jun 8, 2025, 4:52 PM EDT">8 months agoJun 8, 2025</relative-time></div></td></tr><tr class="react-directory-row undefined" id="folder-row-3"><td class="react-directory-row-name-cell-small-screen" colspan="2"><div class="react-directory-filename-column"><svg aria-hidden="true" focusable="false" class="octicon octicon-file color-fg-muted" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M2 1.75C2 .784 2.784 0 3.75 0h6.586c.464 0 .909.184 1.237.513l2.914 2.914c.329.328.513.773.513 1.237v9.586A1.75 1.75 0 0 1 13.25 16h-9.5A1.75 1.75 0 0 1 2 14.25Zm1.75-.25a.25.25 0 0 0-.25.25v12.5c0 .138.112.25.25.25h9.5a.25.25 0 0 0 .25-.25V6h-2.75A1.75 1.75 0 0 1 9 4.25V1.5Zm6.75.062V4.25c0 .138.112.25.25.25h2.688l-.011-.013-2.914-2.914-.013-.011Z"></path></svg><div class="overflow-hidden"><div class="react-directory-filename-cell"><div class="react-directory-truncate"><a title=".gitignore" aria-label=".gitignore, (File)" class="Link--primary" href="https://github.com/whokilleddb/funcshenanigans/blob/main/.gitignore" data-discover="true">.gitignore</a></div></div></div></div></td><td class="react-directory-row-name-cell-large-screen" colspan="1"><div class="react-directory-filename-column"><svg aria-hidden="true" focusable="false" class="octicon octicon-file color-fg-muted" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M2 1.75C2 .784 2.784 0 3.75 0h6.586c.464 0 .909.184 1.237.513l2.914 2.914c.329.328.513.773.513 1.237v9.586A1.75 1.75 0 0 1 13.25 16h-9.5A1.75 1.75 0 0 1 2 14.25Zm1.75-.25a.25.25 0 0 0-.25.25v12.5c0 .138.112.25.25.25h9.5a.25.25 0 0 0 .25-.25V6h-2.75A1.75 1.75 0 0 1 9 4.25V1.5Zm6.75.062V4.25c0 .138.112.25.25.25h2.688l-.011-.013-2.914-2.914-.013-.011Z"></path></svg><div class="overflow-hidden"><div class="react-directory-filename-cell"><div class="react-directory-truncate"><a title=".gitignore" aria-label=".gitignore, (File)" class="Link--primary" href="https://github.com/whokilleddb/funcshenanigans/blob/main/.gitignore" data-discover="true">.gitignore</a></div></div></div></div></td><td class="react-directory-row-commit-cell"><div><div class="react-directory-commit-message"><a data-pjax="true" title="Updated README" class="Link--secondary" href="https://github.com/whokilleddb/funcshenanigans/commit/f2bbe76de700d0c64beb3a57358c8cad7419a24a">Updated README</a></div></div></td><td><div class="react-directory-commit-age"><relative-time tense="past" datetime="2025-06-08T19:20:41.000Z" title="Jun 8, 2025, 3:20 PM EDT">8 months agoJun 8, 2025</relative-time></div></td></tr><tr class="react-directory-row undefined" id="folder-row-4"><td class="react-directory-row-name-cell-small-screen" colspan="2"><div class="react-directory-filename-column"><svg aria-hidden="true" focusable="false" class="octicon octicon-file color-fg-muted" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M2 1.75C2 .784 2.784 0 3.75 0h6.586c.464 0 .909.184 1.237.513l2.914 2.914c.329.328.513.773.513 1.237v9.586A1.75 1.75 0 0 1 13.25 16h-9.5A1.75 1.75 0 0 1 2 14.25Zm1.75-.25a.25.25 0 0 0-.25.25v12.5c0 .138.112.25.25.25h9.5a.25.25 0 0 0 .25-.25V6h-2.75A1.75 1.75 0 0 1 9 4.25V1.5Zm6.75.062V4.25c0 .138.112.25.25.25h2.688l-.011-.013-2.914-2.914-.013-.011Z"></path></svg><div class="overflow-hidden"><div class="react-directory-filename-cell"><div class="react-directory-truncate"><a title="Makefile" aria-label="Makefile, (File)" class="Link--primary" href="https://github.com/whokilleddb/funcshenanigans/blob/main/Makefile" data-discover="true">Makefile</a></div></div></div></div></td><td class="react-directory-row-name-cell-large-screen" colspan="1"><div class="react-directory-filename-column"><svg aria-hidden="true" focusable="false" class="octicon octicon-file color-fg-muted" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M2 1.75C2 .784 2.784 0 3.75 0h6.586c.464 0 .909.184 1.237.513l2.914 2.914c.329.328.513.773.513 1.237v9.586A1.75 1.75 0 0 1 13.25 16h-9.5A1.75 1.75 0 0 1 2 14.25Zm1.75-.25a.25.25 0 0 0-.25.25v12.5c0 .138.112.25.25.25h9.5a.25.25 0 0 0 .25-.25V6h-2.75A1.75 1.75 0 0 1 9 4.25V1.5Zm6.75.062V4.25c0 .138.112.25.25.25h2.688l-.011-.013-2.914-2.914-.013-.011Z"></path></svg><div class="overflow-hidden"><div class="react-directory-filename-cell"><div class="react-directory-truncate"><a title="Makefile" aria-label="Makefile, (File)" class="Link--primary" href="https://github.com/whokilleddb/funcshenanigans/blob/main/Makefile" data-discover="true">Makefile</a></div></div></div></div></td><td class="react-directory-row-commit-cell"><div><div class="react-directory-commit-message"><a data-pjax="true" title="Function Fluctuation" class="Link--secondary" href="https://github.com/whokilleddb/funcshenanigans/commit/12aa29ab94cbc0803f2e83c0ae1b528ec4c36650">Function Fluctuation</a></div></div></td><td><div class="react-directory-commit-age"><relative-time tense="past" datetime="2025-06-08T16:43:34.000Z" title="Jun 8, 2025, 12:43 PM EDT">8 months agoJun 8, 2025</relative-time></div></td></tr><tr class="react-directory-row undefined" id="folder-row-5"><td class="react-directory-row-name-cell-small-screen" colspan="2"><div class="react-directory-filename-column"><svg aria-hidden="true" focusable="false" class="octicon octicon-file color-fg-muted" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M2 1.75C2 .784 2.784 0 3.75 0h6.586c.464 0 .909.184 1.237.513l2.914 2.914c.329.328.513.773.513 1.237v9.586A1.75 1.75 0 0 1 13.25 16h-9.5A1.75 1.75 0 0 1 2 14.25Zm1.75-.25a.25.25 0 0 0-.25.25v12.5c0 .138.112.25.25.25h9.5a.25.25 0 0 0 .25-.25V6h-2.75A1.75 1.75 0 0 1 9 4.25V1.5Zm6.75.062V4.25c0 .138.112.25.25.25h2.688l-.011-.013-2.914-2.914-.013-.011Z"></path></svg><div class="overflow-hidden"><div class="react-directory-filename-cell"><div class="react-directory-truncate"><a title="README.md" aria-label="README.md, (File)" class="Link--primary" href="https://github.com/whokilleddb/funcshenanigans/blob/main/README.md" data-discover="true">README.md</a></div></div></div></div></td><td class="react-directory-row-name-cell-large-screen" colspan="1"><div class="react-directory-filename-column"><svg aria-hidden="true" focusable="false" class="octicon octicon-file color-fg-muted" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M2 1.75C2 .784 2.784 0 3.75 0h6.586c.464 0 .909.184 1.237.513l2.914 2.914c.329.328.513.773.513 1.237v9.586A1.75 1.75 0 0 1 13.25 16h-9.5A1.75 1.75 0 0 1 2 14.25Zm1.75-.25a.25.25 0 0 0-.25.25v12.5c0 .138.112.25.25.25h9.5a.25.25 0 0 0 .25-.25V6h-2.75A1.75 1.75 0 0 1 9 4.25V1.5Zm6.75.062V4.25c0 .138.112.25.25.25h2.688l-.011-.013-2.914-2.914-.013-.011Z"></path></svg><div class="overflow-hidden"><div class="react-directory-filename-cell"><div class="react-directory-truncate"><a title="README.md" aria-label="README.md, (File)" class="Link--primary" href="https://github.com/whokilleddb/funcshenanigans/blob/main/README.md" data-discover="true">README.md</a></div></div></div></div></td><td class="react-directory-row-commit-cell"><div><div class="react-directory-commit-message"><a data-pjax="true" title="spellcheck" class="Link--secondary" href="https://github.com/whokilleddb/funcshenanigans/commit/72b98f04b8aeb3158010a8a8231d06ce82c3127c">spellcheck</a></div></div></td><td><div class="react-directory-commit-age"><relative-time tense="past" datetime="2025-06-08T20:52:54.000Z" title="Jun 8, 2025, 4:52 PM EDT">8 months agoJun 8, 2025</relative-time></div></td></tr><tr class="d-none DirectoryContent-module__Box_4__RhIsE" data-testid="view-all-files-row"><td colspan="3" class="DirectoryContent-module__Box_5__GaE8N"><div><button class="prc-Link-Link-9ZwDx">View all files</button></div></td></tr></tbody></table></div><div class="OverviewRepoFiles-module__Box_1__OXeac"><div class="OverviewRepoFiles-module__Box_2__zsLGk"><div itemscope="" itemtype="https://schema.org/abstract" class="OverviewRepoFiles-module__Box_3__bBU1C"><h2 class="prc-src-InternalVisuallyHidden-2YaI6">Repository files navigation</h2><button type="button" aria-label="Outline" aria-haspopup="true" aria-expanded="false" tabindex="0" class="prc-Button-ButtonBase-9n-Xk OverviewRepoFiles-module__ActionMenu_Button__OKDYV" data-loading="false" data-size="medium" data-variant="invisible" id="_R_r9ab_"><svg aria-hidden="true" focusable="false" class="octicon octicon-list-unordered" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M5.75 2.5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5Zm0 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5Zm0 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5ZM2 14a1 1 0 1 1 0-2 1 1 0 0 1 0 2Zm1-6a1 1 0 1 1-2 0 1 1 0 0 1 2 0ZM2 4a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg></button></div><div class="Box-sc-62in7e-0 js-snippet-clipboard-copy-unpositioned DirectoryRichtextContent-module__SharedMarkdownContent__hHXUL" data-hpc="true"><article class="markdown-body entry-content container-lg" itemprop="text"><div class="markdown-heading" dir="auto"><h1 tabindex="-1" class="heading-element" dir="auto">FuncShenanigans</h1><a id="user-content-funcshenanigans" class="anchor" aria-label="Permalink: FuncShenanigans" href="https://github.com/whokilleddb/funcshenanigans#funcshenanigans"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">This research was inspired by the <a href="https://github.com/mgeeky/ShellcodeFluctuation">Shellcode Fluctuation</a> technique along with <a href="https://ephemeral.cx/2013/12/writing-a-self-mutating-x86_64-c-program/" rel="nofollow">this blog about a self mutating program</a>. So far we have seen the fluctuation technique be used for things like Shellcode and entire PEs, but I wanted to try and use this technique for something simpler - fluctuating just one function.</p>
<p dir="auto">The goal was to experiment with function bounds, memory protection and VEHs. This repository documents the results of such experiments in a very rough way, documenting the techniques as we go.</p>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">Pre-requisites</h2><a id="user-content-pre-requisites" class="anchor" aria-label="Permalink: Pre-requisites" href="https://github.com/whokilleddb/funcshenanigans#pre-requisites"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li>Mingw Compiler</li>
<li>Make</li>
</ul>
<p dir="auto">Note that all the C code discussed here is very Mingw specific, but I am sure there is a way to make this work with MSVC compiler as well.</p>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">Bounding functions</h2><a id="user-content-bounding-functions" class="anchor" aria-label="Permalink: Bounding functions" href="https://github.com/whokilleddb/funcshenanigans#bounding-functions"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Looking at <code>bound.c</code> you will see that it contains the following functions:</p>
<div class="highlight highlight-source-c notranslate position-relative overflow-auto" dir="auto"><pre>__attribute__((<span class="pl-en">aligned</span>(<span class="pl-c1">FUNC_SIZE</span>)))
<span class="pl-smi">VOID</span> <span class="pl-en">fluctuate</span>() {
	<span class="pl-k">for</span> (<span class="pl-smi">int</span> <span class="pl-s1">i</span> <span class="pl-c1">=</span> <span class="pl-c1">0</span>; <span class="pl-s1">i</span> <span class="pl-c1">&lt;</span> <span class="pl-c1">5</span>; <span class="pl-s1">i</span><span class="pl-c1">++</span>) {
		<span class="pl-smi">SYSTEMTIME</span> <span class="pl-s1">st</span> <span class="pl-c1">=</span> { <span class="pl-c1">0</span> };
		<span class="pl-en">GetLocalTime</span>(<span class="pl-c1">&amp;</span><span class="pl-s1">st</span>);
		<span class="pl-en">printf</span>(<span class="pl-s">"\tCurrent Time: %02d:%02d:%02d\n"</span>, <span class="pl-s1">st</span>.<span class="pl-c1">wHour</span>, <span class="pl-s1">st</span>.<span class="pl-c1">wMinute</span>, <span class="pl-s1">st</span>.<span class="pl-c1">wSecond</span>);
		<span class="pl-en">Sleep</span>(<span class="pl-c1">1000</span>);
	}
  <span class="pl-en">printf</span>(<span class="pl-s">"\n"</span>);
}

<span class="pl-c">// Boundary function to mark the end bound of the function to fluctuate</span>
__attribute__((<span class="pl-en">aligned</span>(<span class="pl-c1">FUNC_SIZE</span>)))
<span class="pl-smi">void</span> <span class="pl-en">__boundary_func</span>() {}</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="__attribute__((aligned(FUNC_SIZE)))
VOID fluctuate() {
	for (int i = 0; i < 5; i++) {
		SYSTEMTIME st = { 0 };
		GetLocalTime(&amp;st);
		printf(&quot;\tCurrent Time: %02d:%02d:%02d\n&quot;, st.wHour, st.wMinute, st.wSecond);
		Sleep(1000);
	}
  printf(&quot;\n&quot;);
}

// Boundary function to mark the end bound of the function to fluctuate
__attribute__((aligned(FUNC_SIZE)))
void __boundary_func() {}" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<p dir="auto">There are two functions here: <code>fluctuate()</code> and <code>__boundary_func()</code>:</p>
<ul dir="auto">
<li><code>fluctuate()</code> contains the actual code which we want to <em>fluctuate</em> (or experiment with)</li>
<li><code>__boundary_func()</code> is an empty function which marks the "end" of the <code>fluctuate()</code> function. We use this function address to mark the beginning of the next <em>page</em> in memory (more on this later).</li>
</ul>
<p dir="auto">Now the next thing, both functions have the <code>__attribute__((aligned(FUNC_SIZE)))</code> where <code>FUNC_SIZE</code> is set to 4096 which is the size of one page of memory on Windows (page size on Windows is 4KB = 4*1024 bytes). Having the consecutive functions aligned to 4096 bytes ensures that the <code>fluctuate()</code> function occupies the whole page as the next <code>__boundary_func()</code> needs to be aligned to 4096 bytes as well, ensuring that it starts at the very next page of memory.</p>
<p dir="auto">This arrangement is required for this technique to work -  that our functions are confided to a single page (it can be more than one page - but this is a simple PoC so we are not going to dip into that can of worms).</p>
<p dir="auto">Therefore, after compilation, the code should look something like:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto"><pre class="notranslate"><code>+++++++++++++++++++++++ Page start
|                     |  
|     fluctuate()     | &lt; One page of memory &gt;
|                     |   
+++++++++++++++++++++++ End of function 
|                     |
|     Garbage Data    |
|                     |
+++++++++++++++++++++++ Next page start
|                     |
|  __boundary_func()  |
|                     |
+++++++++++++++++++++++ 
</code></pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="+++++++++++++++++++++++ Page start
|                     |  
|     fluctuate()     | < One page of memory >
|                     |   
+++++++++++++++++++++++ End of function 
|                     |
|     Garbage Data    |
|                     |
+++++++++++++++++++++++ Next page start
|                     |
|  __boundary_func()  |
|                     |
+++++++++++++++++++++++ " tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<p dir="auto">We need the <code>fluctuate()</code> function to occupy one page of memory because when we change the memory permissions of a region of memory, we change the memory permissions of the page as a whole. Having other data or functions in that memory region might cause unexpected behaviour.</p>
<p dir="auto">We can also make sure that the <code>fluctuate()</code> function starts at the beginning of a new page by using <code>VirtualQuery()</code> (see <code>get_mem_base_address()</code> function in <code>common.c</code>).</p>
<p dir="auto">We can also verify this setup in windbg as:</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/whokilleddb/funcshenanigans/blob/main/imgs/align.png"><img src="https://github.com/whokilleddb/funcshenanigans/raw/main/imgs/align.png" alt="" style="max-width: 100%;"></a></p>
<p dir="auto">We see that after the code for the <code>fluctuate()</code> function ends, the page is filled with a nop sled till the beginning of the next page who's start is marked by the address of the <code>__boundary_func()</code>, showing that our code works as intended.</p>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">Experiment 1: Replacing functionality</h2><a id="user-content-experiment-1-replacing-functionality" class="anchor" aria-label="Permalink: Experiment 1: Replacing functionality" href="https://github.com/whokilleddb/funcshenanigans#experiment-1-replacing-functionality"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">See: <code>replace.c</code></p>
</blockquote>
<p dir="auto">My first thought with this, inspired from <a href="https://ephemeral.cx/2013/12/writing-a-self-mutating-x86_64-c-program/" rel="nofollow">this blog about a self mutating program</a> was: "What if I replace the functionality of the code?"</p>
<p dir="auto">My initial idea was to have a benign function, but then use some VEH magic to replace it's functionality at runtime to run malicious code. And that's what I did!</p>
<p dir="auto">Let's look at the main function:</p>
<div class="highlight highlight-source-c notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-smi">int</span> <span class="pl-en">main</span>() {	
	<span class="pl-en">printf</span>(<span class="pl-s">"[+] Function Addr: \t\t0x%p\n"</span>, <span class="pl-s1">fluctuate</span>);
	<span class="pl-en">printf</span>(<span class="pl-s">"[+] End Bound:     \t\t0x%p\n\n"</span>, <span class="pl-s1">__boundary_func</span>);

    <span class="pl-en">get_mem_base_address</span>((<span class="pl-smi">LPVOID</span>)<span class="pl-s1">fluctuate</span>);

	<span class="pl-c">// Register VEH </span>
	<span class="pl-smi">PVOID</span> <span class="pl-s1">p_veh_h</span> <span class="pl-c1">=</span> <span class="pl-en">AddVectoredExceptionHandler</span>(<span class="pl-c1">1</span>, (<span class="pl-smi">PVECTORED_EXCEPTION_HANDLER</span>)<span class="pl-s1">replacer_veh</span>);
	<span class="pl-k">if</span> (<span class="pl-s1">p_veh_h</span> <span class="pl-c1">==</span> <span class="pl-c1">NULL</span>) {
		<span class="pl-en">printf</span>(<span class="pl-s">"[-] AddVectoredExceptionHandler() failed\n"</span>);
		<span class="pl-k">return</span> <span class="pl-c1">-1</span>;
	}
	<span class="pl-en">printf</span>(<span class="pl-s">"\n[+] Registered VEH\n"</span>);

	<span class="pl-en">printf</span>(<span class="pl-s">"[+] Calling function without fluctuation:\n\n"</span>);
	<span class="pl-en">fluctuate</span>();

    <span class="pl-c">// Convert Page into RW </span>
    <span class="pl-smi">DWORD</span> <span class="pl-s1">oldp</span> <span class="pl-c1">=</span> <span class="pl-c1">0</span>;

    <span class="pl-k">do</span> {
        <span class="pl-en">printf</span>(<span class="pl-s">"[+] Pre-shenanigans function hexdump(first 16 bytes):\n\n"</span>);
        <span class="pl-en">hexdump</span>(<span class="pl-s1">fluctuate</span>, <span class="pl-c1">FUNC_SIZE</span>/<span class="pl-c1">256</span>);
        <span class="pl-en">printf</span>(<span class="pl-s">"\n"</span>);

        <span class="pl-c">// Change Page to RW</span>
        <span class="pl-k">if</span> (!<span class="pl-en">VirtualProtect</span>((<span class="pl-smi">LPVOID</span>)<span class="pl-s1">fluctuate</span>, <span class="pl-c1">FUNC_SIZE</span>, <span class="pl-c1">PAGE_READWRITE</span>, <span class="pl-c1">&amp;</span><span class="pl-s1">oldp</span>)) {
            <span class="pl-en">eprint</span>(<span class="pl-s">"VirtualProtect"</span>);
            <span class="pl-k">break</span>;
        }

        <span class="pl-c">// XOR it</span>
        <span class="pl-en">byte_xor</span>((<span class="pl-smi">unsigned <span class="pl-smi">char</span></span> <span class="pl-c1">*</span>)<span class="pl-s1">fluctuate</span>, <span class="pl-c1">FUNC_SIZE</span>, <span class="pl-c1">XOR_BYTE</span>);

        <span class="pl-en">printf</span>(<span class="pl-s">"[+] Post encryption function hexdump(first 16 bytes):\n\n"</span>);
        <span class="pl-en">hexdump</span>(<span class="pl-s1">fluctuate</span>, <span class="pl-c1">FUNC_SIZE</span>/<span class="pl-c1">256</span>);
        <span class="pl-en">printf</span>(<span class="pl-s">"\n"</span>);

        <span class="pl-c">// Change permission to NO_ACCESS</span>
        <span class="pl-k">if</span> (!<span class="pl-en">VirtualProtect</span>((<span class="pl-smi">LPVOID</span>)<span class="pl-s1">fluctuate</span>, <span class="pl-c1">FUNC_SIZE</span>, <span class="pl-c1">PAGE_NOACCESS</span>, <span class="pl-c1">&amp;</span><span class="pl-s1">oldp</span>)) {
            <span class="pl-en">eprint</span>(<span class="pl-s">"VirtualProtect"</span>);
            <span class="pl-k">break</span>;
        }
        
        <span class="pl-en">fluctuate</span>();
        <span class="pl-en">printf</span>(<span class="pl-s">"---------------------------------------------------------------------------\n"</span>);

    } <span class="pl-k">while</span>(FALSE);
	
	
	<span class="pl-k">if</span> (<span class="pl-s1">p_veh_h</span>) <span class="pl-en">RemoveVectoredExceptionHandler</span>(<span class="pl-s1">p_veh_h</span>); 
	<span class="pl-k">return</span> <span class="pl-c1">0</span>;
}</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="int main() {	
	printf(&quot;[+] Function Addr: \t\t0x%p\n&quot;, fluctuate);
	printf(&quot;[+] End Bound:     \t\t0x%p\n\n&quot;, __boundary_func);

    get_mem_base_address((LPVOID)fluctuate);

	// Register VEH 
	PVOID p_veh_h = AddVectoredExceptionHandler(1, (PVECTORED_EXCEPTION_HANDLER)replacer_veh);
	if (p_veh_h == NULL) {
		printf(&quot;[-] AddVectoredExceptionHandler() failed\n&quot;);
		return -1;
	}
	printf(&quot;\n[+] Registered VEH\n&quot;);

	printf(&quot;[+] Calling function without fluctuation:\n\n&quot;);
	fluctuate();

    // Convert Page into RW 
    DWORD oldp = 0;

    do {
        printf(&quot;[+] Pre-shenanigans function hexdump(first 16 bytes):\n\n&quot;);
        hexdump(fluctuate, FUNC_SIZE/256);
        printf(&quot;\n&quot;);

        // Change Page to RW
        if (!VirtualProtect((LPVOID)fluctuate, FUNC_SIZE, PAGE_READWRITE, &amp;oldp)) {
            eprint(&quot;VirtualProtect&quot;);
            break;
        }

        // XOR it
        byte_xor((unsigned char *)fluctuate, FUNC_SIZE, XOR_BYTE);

        printf(&quot;[+] Post encryption function hexdump(first 16 bytes):\n\n&quot;);
        hexdump(fluctuate, FUNC_SIZE/256);
        printf(&quot;\n&quot;);

        // Change permission to NO_ACCESS
        if (!VirtualProtect((LPVOID)fluctuate, FUNC_SIZE, PAGE_NOACCESS, &amp;oldp)) {
            eprint(&quot;VirtualProtect&quot;);
            break;
        }
        
        fluctuate();
        printf(&quot;---------------------------------------------------------------------------\n&quot;);

    } while(FALSE);
	
	
	if (p_veh_h) RemoveVectoredExceptionHandler(p_veh_h); 
	return 0;
}" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<p dir="auto">The first interesting thing to note here is that we register a VEH called <code>replacer_veh</code>. We will get to that later. Next up, inside the <code>do-while</code> loop, we first print the first 16 bytes of the <code>fluctuate</code> function just so that we can compare our results later.</p>
<p dir="auto">Next, we use <code>VirtualProtect()</code> to change the page permissions of <code>fluctuate</code> to RW and use a single byte XOR encryption to encrypt the memory of the function (pardon my use of single byte XOR - I am lazy).</p>
<p dir="auto">Once the memory region is encrypted, we again print the first 16 bytes to demonstrate that the XOR was successful. Finally, we change the page permission to <code>PAGE_NOACCESS</code> to prevent any sort of R/W operations at all. So, now the page not only lacks RX permissions, it is also full of garbage code.</p>
<p dir="auto">Finally, we call the <code>fluctuate()</code> function again. Since we have the function's page set to RW, an exception is triggered and out VEH aka <code>replacer_veh()</code> is called. Let's look at the VEH code:</p>
<div class="highlight highlight-source-c notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-smi">LONG</span> <span class="pl-c1">WINAPI</span> <span class="pl-en">replacer_veh</span>(<span class="pl-smi">PEXCEPTION_POINTERS</span> <span class="pl-s1">pExceptionInfo</span>) {
	<span class="pl-smi">PVOID</span> <span class="pl-s1">p_exec_addr</span> <span class="pl-c1">=</span> <span class="pl-s1">pExceptionInfo</span><span class="pl-c1">-&gt;</span><span class="pl-c1">ExceptionRecord</span><span class="pl-c1">-&gt;</span><span class="pl-c1">ExceptionAddress</span>;

  	<span class="pl-c">// Check if Exception if within our boundary </span>
    <span class="pl-k">if</span> ((<span class="pl-s1">p_exec_addr</span> <span class="pl-c1">&gt;</span> (<span class="pl-smi">PVOID</span>)<span class="pl-s1">__boundary_func</span>) <span class="pl-c1">||</span> (<span class="pl-s1">p_exec_addr</span> <span class="pl-c1">&lt;</span> (<span class="pl-smi">PVOID</span>)<span class="pl-s1">fluctuate</span>)) {
        <span class="pl-en">printf</span>(<span class="pl-s">"[-] Unhandled Exception Occured at: 0x%p\n"</span>, <span class="pl-s1">p_exec_addr</span>);        
        <span class="pl-k">return</span> <span class="pl-c1">EXCEPTION_CONTINUE_SEARCH</span>;  
    }

	<span class="pl-k">if</span> (<span class="pl-s1">pExceptionInfo</span><span class="pl-c1">-&gt;</span><span class="pl-c1">ExceptionRecord</span><span class="pl-c1">-&gt;</span><span class="pl-c1">ExceptionCode</span> <span class="pl-c1">!=</span> <span class="pl-c1">EXCEPTION_ACCESS_VIOLATION</span>) {
		<span class="pl-en">printf</span>(<span class="pl-s">"[+] Invalid Exception code found: 0x%lx\n"</span>, <span class="pl-s1">pExceptionInfo</span><span class="pl-c1">-&gt;</span><span class="pl-c1">ExceptionRecord</span><span class="pl-c1">-&gt;</span><span class="pl-c1">ExceptionCode</span>);
		<span class="pl-k">return</span> <span class="pl-c1">EXCEPTION_CONTINUE_SEARCH</span>;  
	}
    <span class="pl-en">printf</span>(<span class="pl-s">"[-] Exception Code: 0x%lx\n"</span>, <span class="pl-s1">pExceptionInfo</span><span class="pl-c1">-&gt;</span><span class="pl-c1">ExceptionRecord</span><span class="pl-c1">-&gt;</span><span class="pl-c1">ExceptionCode</span>);
    
    <span class="pl-c">// Change function permission to RW </span>
    <span class="pl-smi">DWORD</span> <span class="pl-s1">oldp</span> <span class="pl-c1">=</span> <span class="pl-c1">0</span>;
    <span class="pl-k">if</span> (!<span class="pl-en">VirtualProtect</span>((<span class="pl-smi">LPVOID</span>)<span class="pl-s1">fluctuate</span>, <span class="pl-c1">FUNC_SIZE</span>, <span class="pl-c1">PAGE_READWRITE</span>, <span class="pl-c1">&amp;</span><span class="pl-s1">oldp</span>)) {
        <span class="pl-en">eprint</span>(<span class="pl-s">"VirtualProtect"</span>);
        <span class="pl-k">return</span> <span class="pl-c1">EXCEPTION_CONTINUE_SEARCH</span>;  
    }
    
    <span class="pl-smi">unsigned <span class="pl-smi">char</span></span> <span class="pl-s1">shellcode</span>[] <span class="pl-c1">=</span> {
        <span class="pl-c1">&lt;</span><span class="pl-s1">hello</span> <span class="pl-s1">world</span> <span class="pl-s1">shellcode</span><span class="pl-c1">&gt;</span>
    };

    <span class="pl-c">// Write payload to function </span>
    <span class="pl-smi">SIZE_T</span> <span class="pl-s1">b_written</span> <span class="pl-c1">=</span> <span class="pl-c1">0</span>;
    <span class="pl-k">if</span> (!<span class="pl-en">WriteProcessMemory</span>((<span class="pl-c1">HANDLE</span>)<span class="pl-c1">-</span><span class="pl-c1">1</span>, (<span class="pl-smi">LPVOID</span>)<span class="pl-s1">fluctuate</span>, <span class="pl-s1">shellcode</span>, <span class="pl-k">sizeof</span>(<span class="pl-s1">shellcode</span>), <span class="pl-c1">&amp;</span><span class="pl-s1">b_written</span>)) {
        <span class="pl-en">eprint</span>(<span class="pl-s">"WriteProcessMemory"</span>);
        <span class="pl-k">return</span> <span class="pl-c1">EXCEPTION_CONTINUE_SEARCH</span>;  
    }
    <span class="pl-en">printf</span>(<span class="pl-s">"[+] Replaced function with shellcode!\n"</span>);

    <span class="pl-k">if</span> (!<span class="pl-en">VirtualProtect</span>((<span class="pl-smi">LPVOID</span>)<span class="pl-s1">fluctuate</span>, <span class="pl-c1">FUNC_SIZE</span>, <span class="pl-c1">PAGE_EXECUTE_READ</span>, <span class="pl-c1">&amp;</span><span class="pl-s1">oldp</span>)) {
        <span class="pl-en">eprint</span>(<span class="pl-s">"VirtualProtect"</span>);
        <span class="pl-k">return</span> <span class="pl-c1">EXCEPTION_CONTINUE_SEARCH</span>;  
    }
    <span class="pl-en">printf</span>(<span class="pl-s">"[+] Continuing function call as normal:\n\n"</span>);

	<span class="pl-k">return</span> <span class="pl-c1">EXCEPTION_CONTINUE_EXECUTION</span>;
}</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="LONG WINAPI replacer_veh(PEXCEPTION_POINTERS pExceptionInfo) {
	PVOID p_exec_addr = pExceptionInfo->ExceptionRecord->ExceptionAddress;

  	// Check if Exception if within our boundary 
    if ((p_exec_addr > (PVOID)__boundary_func) || (p_exec_addr < (PVOID)fluctuate)) {
        printf(&quot;[-] Unhandled Exception Occured at: 0x%p\n&quot;, p_exec_addr);        
        return EXCEPTION_CONTINUE_SEARCH;  
    }

	if (pExceptionInfo->ExceptionRecord->ExceptionCode != EXCEPTION_ACCESS_VIOLATION) {
		printf(&quot;[+] Invalid Exception code found: 0x%lx\n&quot;, pExceptionInfo->ExceptionRecord->ExceptionCode);
		return EXCEPTION_CONTINUE_SEARCH;  
	}
    printf(&quot;[-] Exception Code: 0x%lx\n&quot;, pExceptionInfo->ExceptionRecord->ExceptionCode);
    
    // Change function permission to RW 
    DWORD oldp = 0;
    if (!VirtualProtect((LPVOID)fluctuate, FUNC_SIZE, PAGE_READWRITE, &amp;oldp)) {
        eprint(&quot;VirtualProtect&quot;);
        return EXCEPTION_CONTINUE_SEARCH;  
    }
    
    unsigned char shellcode[] = {
        <hello world shellcode>
    };

    // Write payload to function 
    SIZE_T b_written = 0;
    if (!WriteProcessMemory((HANDLE)-1, (LPVOID)fluctuate, shellcode, sizeof(shellcode), &amp;b_written)) {
        eprint(&quot;WriteProcessMemory&quot;);
        return EXCEPTION_CONTINUE_SEARCH;  
    }
    printf(&quot;[+] Replaced function with shellcode!\n&quot;);

    if (!VirtualProtect((LPVOID)fluctuate, FUNC_SIZE, PAGE_EXECUTE_READ, &amp;oldp)) {
        eprint(&quot;VirtualProtect&quot;);
        return EXCEPTION_CONTINUE_SEARCH;  
    }
    printf(&quot;[+] Continuing function call as normal:\n\n&quot;);

	return EXCEPTION_CONTINUE_EXECUTION;
}" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<p dir="auto">Its a very easy to understand function. First, when an exception is occurred, we check if it originates from the page containing the <code>fluctuate()</code> function and is of the type <code>EXCEPTION_ACCESS_VIOLATION</code> . If not, we return a <code>EXCEPTION_CONTINUE_SEARCH</code>.</p>
<p dir="auto">However, if these conditions are satisfied, we proceed to use <code>VirtualProtect()</code> to make it writeable and use <code>WriteProcessMemory</code> to overwrite the function code with our shellcode. Finally, we mark the page as executable and return the flow of execution back to the program with <code>EXCEPTION_CONTINUE_EXECUTION</code>.</p>
<p dir="auto">So just to put it everything together:</p>
<ul dir="auto">
<li>We register a VEH to handle the exception we would throw in the future</li>
<li>We make the page containing the code of <code>fluctuate()</code> as RW, encrypt it and then again change the memory permissions to <code>PAGE_NOACCESS</code></li>
<li>Calling <code>fluctuate()</code> now causes an access <code>ACCESS VIOLATION</code> exception</li>
<li>Our VEH verifies the exception was raise within the page bounds and is of the right type</li>
<li>It then marks the page as RW, writes our shellcode to it, marks the page as executable, and continues execution like nothing happened</li>
<li>Profit!</li>
</ul>
<p dir="auto">With everything put together, it should look something like this:</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/whokilleddb/funcshenanigans/blob/main/imgs/replace.png"><img src="https://github.com/whokilleddb/funcshenanigans/raw/main/imgs/replace.png" alt="" style="max-width: 100%;"></a></p>
<p dir="auto">A couple of things to note here:</p>
<ul dir="auto">
<li>You <em>technically</em> dont need to encrypt the memory for this to work, but it helps with the PoC and would be more relevant later</li>
<li>Any code placed after the second/tampered <code>fluctuate()</code> code is never guaranteed to work</li>
<li>You can also fetch the shellcode remotely at runtime to be more evasive</li>
</ul>
<p dir="auto">However, this experiment was not novel. We also dont get to actually use the functionality exposed by <code>fluctuate()</code> for that matter, which brings us to the next experiment. With the knowledge about page boundaries and some more, we can move onto the next experiment where we actually <em>fluctuate</em> the function.</p>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">Experiment 2: Actually Fluctuating It</h2><a id="user-content-experiment-2-actually-fluctuating-it" class="anchor" aria-label="Permalink: Experiment 2: Actually Fluctuating It" href="https://github.com/whokilleddb/funcshenanigans#experiment-2-actually-fluctuating-it"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">See: <code>fluctuator.c</code></p>
</blockquote>
<p dir="auto">This time, we want to <em>fluctuate</em> our function for real, so that it is encrypted in memory until it is called, and goes back to being encrypted when it's done. For that, first lets take a look at the main function and some globals:</p>
<div class="highlight highlight-source-c notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-c">// Globals</span>
<span class="pl-smi">HANDLE</span> <span class="pl-s1">g_htimer_queue</span> <span class="pl-c1">=</span> <span class="pl-c1">NULL</span>;
<span class="pl-smi">HANDLE</span> <span class="pl-s1">g_htimer</span> <span class="pl-c1">=</span> <span class="pl-c1">NULL</span>;

<span class="pl-smi">int</span> <span class="pl-en">main</span>() {
	<span class="pl-en">printf</span>(<span class="pl-s">"[+] Function Addr: \t\t0x%p\n"</span>, <span class="pl-s1">fluctuate</span>);
	<span class="pl-en">printf</span>(<span class="pl-s">"[+] End Bound:     \t\t0x%p\n\n"</span>, <span class="pl-s1">__boundary_func</span>);

    <span class="pl-en">get_mem_base_address</span>((<span class="pl-smi">LPVOID</span>)<span class="pl-s1">fluctuate</span>);

    <span class="pl-c">// Register VEH </span>
	<span class="pl-smi">PVOID</span> <span class="pl-s1">p_veh_h</span> <span class="pl-c1">=</span> <span class="pl-en">AddVectoredExceptionHandler</span>(<span class="pl-c1">1</span>, (<span class="pl-smi">PVECTORED_EXCEPTION_HANDLER</span>)<span class="pl-s1">fluctuator_veh</span>);
	<span class="pl-k">if</span> (<span class="pl-s1">p_veh_h</span> <span class="pl-c1">==</span> <span class="pl-c1">NULL</span>) {
		<span class="pl-en">printf</span>(<span class="pl-s">"[-] AddVectoredExceptionHandler() failed\n"</span>);
		<span class="pl-k">return</span> <span class="pl-c1">-1</span>;
	}
	<span class="pl-en">printf</span>(<span class="pl-s">"\n[+] Registered VEH\n"</span>);

    <span class="pl-k">do</span> {        
        <span class="pl-en">printf</span>(<span class="pl-s">"[+] Calling function without fluctuation:\n\n"</span>);
       
        <span class="pl-en">fluctuate</span>();

        <span class="pl-c">// Create Timer queue</span>
        <span class="pl-k">if</span> (!<span class="pl-s1">g_htimer_queue</span>) {
            <span class="pl-s1">g_htimer_queue</span> <span class="pl-c1">=</span> <span class="pl-en">CreateTimerQueue</span>();
            <span class="pl-k">if</span> (<span class="pl-s1">g_htimer_queue</span> <span class="pl-c1">==</span> <span class="pl-c1">NULL</span>) {
                <span class="pl-en">eprint</span>(<span class="pl-s">"CreateTimerQueue"</span>);
                <span class="pl-k">break</span>;
            }
        }

        <span class="pl-k">if</span> (!<span class="pl-en">CreateTimerQueueTimer</span>(<span class="pl-c1">&amp;</span><span class="pl-s1">g_htimer</span>, <span class="pl-s1">g_htimer_queue</span>, (<span class="pl-smi">WAITORTIMERCALLBACK</span>)<span class="pl-s1">encryptor_wrapper</span>, <span class="pl-c1">NULL</span>, <span class="pl-c1">0</span>, <span class="pl-c1">0x00</span>, <span class="pl-c1">0x00</span>)) {
            <span class="pl-en">eprint</span>(<span class="pl-s">"CreateTimerQueue"</span>);
            <span class="pl-k">break</span>;
        }

        <span class="pl-en">printf</span>(<span class="pl-s">"[+] Created Timer to encrypt function\n"</span>);
        
        <span class="pl-c">// Make sure function is encrypted</span>
        <span class="pl-en">Sleep</span>(<span class="pl-c1">FLUCT_DURATION</span>);

        <span class="pl-en">printf</span>(<span class="pl-s">"[+] Calling fluctuating function:\n\n"</span>);
       
        <span class="pl-en">fluctuate</span>();
        <span class="pl-en">printf</span>(<span class="pl-s">"[============================== END ==============================]\n"</span>);

    } <span class="pl-k">while</span>(FALSE);

    <span class="pl-k">if</span> (<span class="pl-s1">p_veh_h</span>) <span class="pl-en">RemoveVectoredExceptionHandler</span>(<span class="pl-s1">p_veh_h</span>); 

    <span class="pl-k">return</span> <span class="pl-c1">0</span>;
}</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="// Globals
HANDLE g_htimer_queue = NULL;
HANDLE g_htimer = NULL;

int main() {
	printf(&quot;[+] Function Addr: \t\t0x%p\n&quot;, fluctuate);
	printf(&quot;[+] End Bound:     \t\t0x%p\n\n&quot;, __boundary_func);

    get_mem_base_address((LPVOID)fluctuate);

    // Register VEH 
	PVOID p_veh_h = AddVectoredExceptionHandler(1, (PVECTORED_EXCEPTION_HANDLER)fluctuator_veh);
	if (p_veh_h == NULL) {
		printf(&quot;[-] AddVectoredExceptionHandler() failed\n&quot;);
		return -1;
	}
	printf(&quot;\n[+] Registered VEH\n&quot;);

    do {        
        printf(&quot;[+] Calling function without fluctuation:\n\n&quot;);
       
        fluctuate();

        // Create Timer queue
        if (!g_htimer_queue) {
            g_htimer_queue = CreateTimerQueue();
            if (g_htimer_queue == NULL) {
                eprint(&quot;CreateTimerQueue&quot;);
                break;
            }
        }

        if (!CreateTimerQueueTimer(&amp;g_htimer, g_htimer_queue, (WAITORTIMERCALLBACK)encryptor_wrapper, NULL, 0, 0x00, 0x00)) {
            eprint(&quot;CreateTimerQueue&quot;);
            break;
        }

        printf(&quot;[+] Created Timer to encrypt function\n&quot;);
        
        // Make sure function is encrypted
        Sleep(FLUCT_DURATION);

        printf(&quot;[+] Calling fluctuating function:\n\n&quot;);
       
        fluctuate();
        printf(&quot;[============================== END ==============================]\n&quot;);

    } while(FALSE);

    if (p_veh_h) RemoveVectoredExceptionHandler(p_veh_h); 

    return 0;
}" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<p dir="auto">Just like before, the first interesting thing we do is register a VEH <code>fluctuator_veh</code> which we will talk about later. The next interesting part of the code is:</p>
<div class="highlight highlight-source-c notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-s1">g_htimer_queue</span> <span class="pl-c1">=</span> <span class="pl-en">CreateTimerQueue</span>();
<span class="pl-en">CreateTimerQueueTimer</span>(<span class="pl-c1">&amp;</span><span class="pl-s1">g_htimer</span>, <span class="pl-s1">g_htimer_queue</span>, (<span class="pl-smi">WAITORTIMERCALLBACK</span>)<span class="pl-s1">fluctuator</span>, <span class="pl-c1">NULL</span>, <span class="pl-c1">0</span>, <span class="pl-c1">0x00</span>, <span class="pl-c1">0x00</span>);</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="g_htimer_queue = CreateTimerQueue();
CreateTimerQueueTimer(&amp;g_htimer, g_htimer_queue, (WAITORTIMERCALLBACK)fluctuator, NULL, 0, 0x00, 0x00);" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<p dir="auto">We create a a queue for timers using <a href="https://learn.microsoft.com/en-us/windows/win32/api/threadpoollegacyapiset/nf-threadpoollegacyapiset-createtimerqueue" rel="nofollow"><code>CreateTimerQueue()</code></a> and then add a timer to it using <a href="https://learn.microsoft.com/en-us/windows/win32/api/threadpoollegacyapiset/nf-threadpoollegacyapiset-createtimerqueuetimer" rel="nofollow"><code>CreateTimerQueueTimer()</code></a>. Essentially what we are doing here is creating a timer which would execute the <code>encryptor_wrapper()</code> function after 0 milliseconds.</p>
<p dir="auto">We then sleep for <code>FLUCT_DURATION</code>(which has been set to 1s=1000 milliseconds in our case) to make sure that the <code>encryptor_wrapper()</code> has done its jobs and the we call the <code>fluctuate()</code> function again.</p>
<p dir="auto">Now, before we take a look at the rest of the functions, we first take a look at the <code>protect()</code> function:</p>
<div class="highlight highlight-source-c notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-smi">void</span> <span class="pl-en">protect</span>(<span class="pl-smi">BOOL</span> <span class="pl-s1">encrypt</span>) {
    <span class="pl-smi">DWORD</span> <span class="pl-s1">oldp</span> <span class="pl-c1">=</span> <span class="pl-c1">0</span>;
    <span class="pl-k">if</span> (!<span class="pl-en">VirtualProtect</span>((<span class="pl-smi">LPVOID</span>)<span class="pl-s1">fluctuate</span>, <span class="pl-c1">FUNC_SIZE</span>, <span class="pl-c1">PAGE_READWRITE</span>, <span class="pl-c1">&amp;</span><span class="pl-s1">oldp</span>)) {
        <span class="pl-en">eprint</span>(<span class="pl-s">"VirtualProtect"</span>);
        <span class="pl-en">ExitProcess</span>(<span class="pl-c1">0</span>);
    }

    <span class="pl-en">byte_xor</span>((<span class="pl-smi">unsigned <span class="pl-smi">char</span></span> <span class="pl-c1">*</span>)<span class="pl-s1">fluctuate</span>, <span class="pl-c1">FUNC_SIZE</span>, <span class="pl-c1">XORKEY</span>);

    <span class="pl-k">if</span> (!<span class="pl-en">VirtualProtect</span>((<span class="pl-smi">LPVOID</span>)<span class="pl-s1">fluctuate</span>, <span class="pl-c1">FUNC_SIZE</span>, <span class="pl-s1">encrypt</span><span class="pl-c1">==</span>TRUE? <span class="pl-c1">PAGE_NOACCESS</span>:<span class="pl-c1">PAGE_EXECUTE_READ</span>, <span class="pl-c1">&amp;</span><span class="pl-s1">oldp</span>)) {
        <span class="pl-en">eprint</span>(<span class="pl-s">"VirtualProtect"</span>);
        <span class="pl-en">ExitProcess</span>(<span class="pl-c1">0</span>);
    }
}</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="void protect(BOOL encrypt) {
    DWORD oldp = 0;
    if (!VirtualProtect((LPVOID)fluctuate, FUNC_SIZE, PAGE_READWRITE, &amp;oldp)) {
        eprint(&quot;VirtualProtect&quot;);
        ExitProcess(0);
    }

    byte_xor((unsigned char *)fluctuate, FUNC_SIZE, XORKEY);

    if (!VirtualProtect((LPVOID)fluctuate, FUNC_SIZE, encrypt==TRUE? PAGE_NOACCESS:PAGE_EXECUTE_READ, &amp;oldp)) {
        eprint(&quot;VirtualProtect&quot;);
        ExitProcess(0);
    }
}" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<p dir="auto">This simple function takes one parameter, <code>encrypt</code> which dictates whether the function would encrypt the target memory or decrypt it. Either ways, the function first marks the page containing the <code>fluctuate()</code> as writeable, xor the bytes of the memory (since XOR is symmetric, we need to do this irrespective of encryption or decryption. In an ideal world, stronger encryption/decryption methods would be used and handled separately). Finally, we call <code>VirtualProtect()</code> one last time, and if the <code>encrypt</code> flag is set to true, we change the memory permissions to <code>PAGE_NOACCESS</code> else we mark the page as RX to allow code execution.</p>
<p dir="auto">Now coming to the <code>encryptor_wrapper()</code> function. It is just a wrapper function which calls <code>protect()</code> with <code>encrypt</code> set to <code>TRUE</code>:</p>
<div class="highlight highlight-source-c notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-smi">VOID</span> <span class="pl-c1">CALLBACK</span> <span class="pl-en">encryptor_wrapper</span>(<span class="pl-smi">IN</span> <span class="pl-c1">PVOID</span> <span class="pl-s1">lpParameter</span>, <span class="pl-smi">IN</span> <span class="pl-c1">BOOLEAN</span> <span class="pl-s1">TimerOrWaitFired</span>) {
    <span class="pl-en">protect</span>(TRUE);
}</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="VOID CALLBACK encryptor_wrapper(IN PVOID lpParameter, IN BOOLEAN TimerOrWaitFired) {
    protect(TRUE);
}" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<p dir="auto">So, when we set the timer to call this function, it essentially encrypts the function and changes the page memory protection to <code>PAGE_NOACCESS</code>. Therefore when we call the <code>fluctuate()</code> function after, it causes an <code>ACCESS VIOLATION</code> and our VEH is called into action. Time to look into <code>fluctuator_veh()</code> function:</p>
<div class="highlight highlight-source-c notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-smi">LONG</span> <span class="pl-c1">WINAPI</span> <span class="pl-en">fluctuator_veh</span>(<span class="pl-smi">PEXCEPTION_POINTERS</span> <span class="pl-s1">pExceptionInfo</span>) {
    <span class="pl-c">// Check if Exception if within our boundary </span>
    <span class="pl-smi">PVOID</span> <span class="pl-s1">p_exec_addr</span> <span class="pl-c1">=</span> <span class="pl-s1">pExceptionInfo</span><span class="pl-c1">-&gt;</span><span class="pl-c1">ExceptionRecord</span><span class="pl-c1">-&gt;</span><span class="pl-c1">ExceptionAddress</span>;

    <span class="pl-k">if</span> ((<span class="pl-s1">p_exec_addr</span> <span class="pl-c1">&gt;</span> (<span class="pl-smi">PVOID</span>)<span class="pl-s1">__boundary_func</span>) <span class="pl-c1">||</span> (<span class="pl-s1">p_exec_addr</span> <span class="pl-c1">&lt;</span> (<span class="pl-smi">PVOID</span>)<span class="pl-s1">fluctuate</span>)) {
        <span class="pl-en">printf</span>(<span class="pl-s">"[-] Unhandled Exception occurred at: 0x%p as 0x%lx\n"</span>, <span class="pl-s1">p_exec_addr</span>, <span class="pl-s1">pExceptionInfo</span><span class="pl-c1">-&gt;</span><span class="pl-c1">ExceptionRecord</span><span class="pl-c1">-&gt;</span><span class="pl-c1">ExceptionCode</span>);      
        <span class="pl-en">ExitProcess</span>(<span class="pl-c1">0</span>);  
        <span class="pl-k">return</span> <span class="pl-c1">EXCEPTION_CONTINUE_SEARCH</span>;  
	}

	<span class="pl-k">if</span> (<span class="pl-s1">pExceptionInfo</span><span class="pl-c1">-&gt;</span><span class="pl-c1">ExceptionRecord</span><span class="pl-c1">-&gt;</span><span class="pl-c1">ExceptionCode</span> <span class="pl-c1">!=</span> <span class="pl-c1">EXCEPTION_ACCESS_VIOLATION</span>) {
		<span class="pl-en">printf</span>(<span class="pl-s">"[-] Invalid Exception code found: 0x%lx\n"</span>, <span class="pl-s1">pExceptionInfo</span><span class="pl-c1">-&gt;</span><span class="pl-c1">ExceptionRecord</span><span class="pl-c1">-&gt;</span><span class="pl-c1">ExceptionCode</span>);
		<span class="pl-k">return</span> <span class="pl-c1">EXCEPTION_CONTINUE_SEARCH</span>;  
	}

    <span class="pl-k">if</span> ((<span class="pl-s1">g_htimer</span> <span class="pl-c1">==</span> <span class="pl-c1">NULL</span>)  <span class="pl-c1">||</span> (<span class="pl-s1">g_htimer_queue</span> <span class="pl-c1">==</span> <span class="pl-c1">NULL</span>)) {
        <span class="pl-en">printf</span>(<span class="pl-s">"[-] Globals aren't initialized\n"</span>);
        <span class="pl-en">ExitProcess</span>(<span class="pl-c1">0</span>);
    }

    <span class="pl-en">Sleep</span>(<span class="pl-c1">2000</span>);

    <span class="pl-c">// Decrypt the function</span>
    <span class="pl-en">protect</span>(FALSE);

    <span class="pl-k">if</span> (!<span class="pl-en">CreateTimerQueueTimer</span>(<span class="pl-c1">&amp;</span><span class="pl-s1">g_htimer</span>, <span class="pl-s1">g_htimer_queue</span>, (<span class="pl-smi">WAITORTIMERCALLBACK</span>)<span class="pl-s1">encryptor_wrapper</span>, <span class="pl-c1">NULL</span>, <span class="pl-c1">FLUCT_DURATION</span>, <span class="pl-c1">0x00</span>, <span class="pl-c1">0x00</span>)) {
        <span class="pl-en">eprint</span>(<span class="pl-s">"CreateTimerQueue"</span>);
        <span class="pl-en">ExitProcess</span>(<span class="pl-c1">0</span>);
    }

    <span class="pl-k">return</span> <span class="pl-c1">EXCEPTION_CONTINUE_EXECUTION</span>;
}</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="LONG WINAPI fluctuator_veh(PEXCEPTION_POINTERS pExceptionInfo) {
    // Check if Exception if within our boundary 
    PVOID p_exec_addr = pExceptionInfo->ExceptionRecord->ExceptionAddress;

    if ((p_exec_addr > (PVOID)__boundary_func) || (p_exec_addr < (PVOID)fluctuate)) {
        printf(&quot;[-] Unhandled Exception occurred at: 0x%p as 0x%lx\n&quot;, p_exec_addr, pExceptionInfo->ExceptionRecord->ExceptionCode);      
        ExitProcess(0);  
        return EXCEPTION_CONTINUE_SEARCH;  
	}

	if (pExceptionInfo->ExceptionRecord->ExceptionCode != EXCEPTION_ACCESS_VIOLATION) {
		printf(&quot;[-] Invalid Exception code found: 0x%lx\n&quot;, pExceptionInfo->ExceptionRecord->ExceptionCode);
		return EXCEPTION_CONTINUE_SEARCH;  
	}

    if ((g_htimer == NULL)  || (g_htimer_queue == NULL)) {
        printf(&quot;[-] Globals aren't initialized\n&quot;);
        ExitProcess(0);
    }

    Sleep(2000);

    // Decrypt the function
    protect(FALSE);

    if (!CreateTimerQueueTimer(&amp;g_htimer, g_htimer_queue, (WAITORTIMERCALLBACK)encryptor_wrapper, NULL, FLUCT_DURATION, 0x00, 0x00)) {
        eprint(&quot;CreateTimerQueue&quot;);
        ExitProcess(0);
    }

    return EXCEPTION_CONTINUE_EXECUTION;
}" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<p dir="auto">The VEH does the usual checks about the origin of the exception and the code, just like before, and if all checks pass, we proceed. We make sure that the globals are properly initialized and then sleep for 2s to delay execution while the function remains encrypted. We then call the <code>protect()</code> function again, but this time <code>encrypt</code> set to <code>FALSE</code>. This decrypts the function and marks the function as RX making it suitable for execution.</p>
<p dir="auto">Before passing the execution to the function again, we call <code>CreateTimerQueueTimer()</code> again to set a timer which again calls the <code>encryptor_wrapper</code> function but this time after a delay of <code>FLUCT_DURATION</code> milliseconds. Once the timer is registered, we pass the program flow back to the <code>fluctuate()</code> function. With the timer registered, it means that <code>fluctuate()</code> only has a time period of <code>FLUCT_DURATION</code> milliseconds before it is encrypted again and marked as <code>PAGE_NOACCESS</code>, therefore continuing the cycle.</p>
<p dir="auto">Therefore, if our calculations are correct, the intervals in the <code>fluctuate()</code> function should go from 1s to roughly 3s (2s of sleep and the original 1s). Compiling and running our code gives us the following output:</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/whokilleddb/funcshenanigans/blob/main/imgs/fluctuate.png"><img src="https://github.com/whokilleddb/funcshenanigans/raw/main/imgs/fluctuate.png" alt="" style="max-width: 100%;"></a></p>
<p dir="auto">We can clearly see that the time difference went up by 3s (ignore the first one). Note that during for 2 out of those 3s, the function remains encrypted and any memory scanners wont be picking up on it. Also, any functions called after <code>fluctuate()</code> will be called normally and while <code>fluctuate()</code> can stay encrypted in memory with <code>PAGE_NOACCESS</code> unless it is accessed again.</p>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">Conclusion</h2><a id="user-content-conclusion" class="anchor" aria-label="Permalink: Conclusion" href="https://github.com/whokilleddb/funcshenanigans#conclusion"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Even though <em>fluctation</em> as a concept isnt new, this technique can be a good-to-have tool in your arsenal. You can even create code caves and switch out the function with valid benign instructions when the function is not in use(something worth looking into: like <a href="https://learn.microsoft.com/en-us/windows/win32/trusted-execution/enclaves" rel="nofollow">enclaves</a>?). Either ways, this was a fun PoC to experiment with.</p>
<p dir="auto">For comments/discussions feel free to reach out to me at <a href="https://x.com/whokilleddb" rel="nofollow">@whokilleddb</a> or open PRs!</p>
<p dir="auto">Happy Hacking.</p>
<p dir="auto">Praise the sun!</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/bb0bb284fcc6700c78ff0af794be0eb999250924139f4c5c0e93898d27e1e748/68747470733a2f2f692e7974696d672e636f6d2f76692f7637704163422d4d585f632f6d617872657364656661756c742e6a7067"><img src="https://camo.githubusercontent.com/bb0bb284fcc6700c78ff0af794be0eb999250924139f4c5c0e93898d27e1e748/68747470733a2f2f692e7974696d672e636f6d2f76692f7637704163422d4d585f632f6d617872657364656661756c742e6a7067" alt="" data-canonical-src="https://i.ytimg.com/vi/v7pAcB-MX_c/maxresdefault.jpg" style="max-width: 100%;"></a></p>
</article></div></div></div></div></div> <!-- --> <!-- --> </div>
</react-partial>


      
</div>
  <div data-view-component="true" class="Layout-sidebar">      

<div class="BorderGrid about-margin">
  <div class="BorderGrid-row">
    <div class="BorderGrid-cell">
      <div class="hide-sm hide-md">
  <h2 class="mb-3 h4">About</h2>

      <p class="f4 my-3">
        A bunch of shenanigans using functions, VEH and more
      </p>


    <h3 class="sr-only">Resources</h3>
    <div class="mt-2">
      <a class="Link--muted" data-analytics-event="{&quot;category&quot;:&quot;Repository Overview&quot;,&quot;action&quot;:&quot;click&quot;,&quot;label&quot;:&quot;location:sidebar;file:readme&quot;}" href="https://github.com/whokilleddb/funcshenanigans#readme-ov-file">
        <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-book mr-2">
    <path d="M0 1.75A.75.75 0 0 1 .75 1h4.253c1.227 0 2.317.59 3 1.501A3.743 3.743 0 0 1 11.006 1h4.245a.75.75 0 0 1 .75.75v10.5a.75.75 0 0 1-.75.75h-4.507a2.25 2.25 0 0 0-1.591.659l-.622.621a.75.75 0 0 1-1.06 0l-.622-.621A2.25 2.25 0 0 0 5.258 13H.75a.75.75 0 0 1-.75-.75Zm7.251 10.324.004-5.073-.002-2.253A2.25 2.25 0 0 0 5.003 2.5H1.5v9h3.757a3.75 3.75 0 0 1 1.994.574ZM8.755 4.75l-.004 7.322a3.752 3.752 0 0 1 1.992-.572H14.5v-9h-3.495a2.25 2.25 0 0 0-2.25 2.25Z"></path>
</svg>
        Readme
</a>    </div>

  





  <include-fragment src="/whokilleddb/funcshenanigans/hovercards/citation/sidebar_partial?tree_name=main" data-nonce="v2:8fcfc6de-a219-b8a0-04a0-d1b1e40c4ad5" data-view-component="true" class="is-error"><slot></slot>
  

  <div data-show-on-forbidden-error="">
    <div class="Box">
  <div class="blankslate-container">
    <div data-view-component="true" class="blankslate blankslate-spacious color-bg-default rounded-2">
      

      <h3 data-view-component="true" class="blankslate-heading">        Uh oh!
</h3>
      <p data-view-component="true">        </p><p class="color-fg-muted my-2 mb-2 ws-normal">There was an error while loading. <a class="Link--inTextBlock" data-turbo="false" href="https://github.com/whokilleddb/funcshenanigans" aria-label="Please reload this page">Please reload this page</a>.</p>
<p></p>

</div>  </div>
</div>  </div>
</include-fragment>
    <div class="mt-2">
      <a href="https://github.com/whokilleddb/funcshenanigans/activity" data-view-component="true" class="Link Link--muted"><svg text="gray" aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-pulse mr-2">
    <path d="M6 2c.306 0 .582.187.696.471L10 10.731l1.304-3.26A.751.751 0 0 1 12 7h3.25a.75.75 0 0 1 0 1.5h-2.742l-1.812 4.528a.751.751 0 0 1-1.392 0L6 4.77 4.696 8.03A.75.75 0 0 1 4 8.5H.75a.75.75 0 0 1 0-1.5h2.742l1.812-4.529A.751.751 0 0 1 6 2Z"></path>
</svg>
        <span class="color-fg-muted">Activity</span></a>    </div>


    <h3 class="sr-only">Stars</h3>
    <div class="mt-2">
      <a href="https://github.com/whokilleddb/funcshenanigans/stargazers" data-view-component="true" class="Link Link--muted"><svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-star mr-2">
    <path d="M8 .25a.75.75 0 0 1 .673.418l1.882 3.815 4.21.612a.75.75 0 0 1 .416 1.279l-3.046 2.97.719 4.192a.751.751 0 0 1-1.088.791L8 12.347l-3.766 1.98a.75.75 0 0 1-1.088-.79l.72-4.194L.818 6.374a.75.75 0 0 1 .416-1.28l4.21-.611L7.327.668A.75.75 0 0 1 8 .25Zm0 2.445L6.615 5.5a.75.75 0 0 1-.564.41l-3.097.45 2.24 2.184a.75.75 0 0 1 .216.664l-.528 3.084 2.769-1.456a.75.75 0 0 1 .698 0l2.77 1.456-.53-3.084a.75.75 0 0 1 .216-.664l2.24-2.183-3.096-.45a.75.75 0 0 1-.564-.41L8 2.694Z"></path>
</svg>
        <strong>37</strong>
        stars</a>    </div>

    <h3 class="sr-only">Watchers</h3>
    <div class="mt-2">
      <a href="https://github.com/whokilleddb/funcshenanigans/watchers" data-view-component="true" class="Link Link--muted"><svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-eye mr-2">
    <path d="M8 2c1.981 0 3.671.992 4.933 2.078 1.27 1.091 2.187 2.345 2.637 3.023a1.62 1.62 0 0 1 0 1.798c-.45.678-1.367 1.932-2.637 3.023C11.67 13.008 9.981 14 8 14c-1.981 0-3.671-.992-4.933-2.078C1.797 10.83.88 9.576.43 8.898a1.62 1.62 0 0 1 0-1.798c.45-.677 1.367-1.931 2.637-3.022C4.33 2.992 6.019 2 8 2ZM1.679 7.932a.12.12 0 0 0 0 .136c.411.622 1.241 1.75 2.366 2.717C5.176 11.758 6.527 12.5 8 12.5c1.473 0 2.825-.742 3.955-1.715 1.124-.967 1.954-2.096 2.366-2.717a.12.12 0 0 0 0-.136c-.412-.621-1.242-1.75-2.366-2.717C10.824 4.242 9.473 3.5 8 3.5c-1.473 0-2.825.742-3.955 1.715-1.124.967-1.954 2.096-2.366 2.717ZM8 10a2 2 0 1 1-.001-3.999A2 2 0 0 1 8 10Z"></path>
</svg>
        <strong>0</strong>
        watching</a>    </div>

    <h3 class="sr-only">Forks</h3>
    <div class="mt-2">
      <a href="https://github.com/whokilleddb/funcshenanigans/forks" data-view-component="true" class="Link Link--muted"><svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-repo-forked mr-2">
    <path d="M5 5.372v.878c0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75v-.878a2.25 2.25 0 1 1 1.5 0v.878a2.25 2.25 0 0 1-2.25 2.25h-1.5v2.128a2.251 2.251 0 1 1-1.5 0V8.5h-1.5A2.25 2.25 0 0 1 3.5 6.25v-.878a2.25 2.25 0 1 1 1.5 0ZM5 3.25a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Zm6.75.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Zm-3 8.75a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Z"></path>
</svg>
        <strong>3</strong>
        forks</a>    </div>


    <div class="mt-2">
      <a class="Link--muted" href="https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fwhokilleddb%2Ffuncshenanigans&amp;report=whokilleddb+%28user%29">
          Report repository
</a>    </div>
</div>

    </div>
  </div>

  
      <div class="BorderGrid-row">
        <div class="BorderGrid-cell">
          <h2 class="h4 mb-3" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame">
  <a href="https://github.com/whokilleddb/funcshenanigans/releases" data-view-component="true" class="Link--primary no-underline Link" data-turbo-frame="repo-content-turbo-frame">Releases</a></h2>

    <div class="text-small color-fg-muted">No releases published</div>

        </div>
      </div>

  
  
      <div class="BorderGrid-row">
        <div class="BorderGrid-cell">
          
  <h2 class="h4 mb-3">
  <a href="https://github.com/users/whokilleddb/packages?repo_name=funcshenanigans" data-view-component="true" class="Link--primary no-underline Link d-flex flex-items-center">Packages
      <span title="0" data-view-component="true" class="Counter ml-1">0</span></a></h2>


      <div class="text-small color-fg-muted">
        No packages published <br>
      </div>



        </div>
      </div>

  
  
  
  
      <div class="BorderGrid-row">
        <div class="BorderGrid-cell">
          <h2 class="h4 mb-3">Languages</h2>
<div class="mb-2">
  <span data-view-component="true" class="Progress">
    <span style="background-color:#555555 !important;;width: 98.2%;" itemprop="keywords" data-view-component="true" class="Progress-item color-bg-success-emphasis"></span>
    <span style="background-color:#427819 !important;;width: 1.8%;" itemprop="keywords" data-view-component="true" class="Progress-item color-bg-success-emphasis"></span>
</span></div>
<ul class="list-style-none">
    <li class="d-inline">
        <a class="d-inline-flex flex-items-center flex-nowrap Link--secondary no-underline text-small mr-3" href="https://github.com/whokilleddb/funcshenanigans/search?l=c" data-ga-click="Repository, language stats search click, location:repo overview">
          <svg style="color:#555555;" aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-dot-fill mr-2">
    <path d="M8 4a4 4 0 1 1 0 8 4 4 0 0 1 0-8Z"></path>
</svg>
          <span class="color-fg-default text-bold mr-1">C</span>
          <span>98.2%</span>
        </a>
    </li>
    <li class="d-inline">
        <a class="d-inline-flex flex-items-center flex-nowrap Link--secondary no-underline text-small mr-3" href="https://github.com/whokilleddb/funcshenanigans/search?l=makefile" data-ga-click="Repository, language stats search click, location:repo overview">
          <svg style="color:#427819;" aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-dot-fill mr-2">
    <path d="M8 4a4 4 0 1 1 0 8 4 4 0 0 1 0-8Z"></path>
</svg>
          <span class="color-fg-default text-bold mr-1">Makefile</span>
          <span>1.8%</span>
        </a>
    </li>
</ul>

        </div>
      </div>

  </div>

</div>
  
</div></div>

  </div>


  </div>

</turbo-frame>


    </main>
  </div>

  </div>

          



    <ghcc-consent id="ghcc" class="position-fixed bottom-0 left-0" style="z-index: 999999" data-locale="en" data-initial-cookie-consent-allowed="" data-cookie-consent-required="false" data-catalyst=""></ghcc-consent>




  <div id="ajax-error-message" class="ajax-error-message flash flash-error">
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
    <button type="button" class="flash-close js-ajax-error-dismiss" aria-label="Dismiss error">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
    </button>
    You canât perform that action at this time.
  </div>

    
  <details class="details-reset details-overlay details-overlay-dark lh-default color-fg-default hx_rsm" open="">
    <summary role="button" aria-label="Close dialog"></summary>
    <details-dialog class="Box Box--overlay d-flex flex-column anim-fade-in fast hx_rsm-dialog hx_rsm-modal">
      <button class="Box-btn-octicon m-0 btn-octicon position-absolute right-0 top-0" type="button" aria-label="Close dialog" data-close-dialog="">
        <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
      </button>
      <div class="octocat-spinner my-6 js-details-dialog-spinner"></div>
    </details-dialog>
  </details>


    <div class="Popover js-hovercard-content position-absolute" style="display: none; outline: none;">
  <div class="Popover-message Popover-message--bottom-left Popover-message--large Box color-shadow-large" style="width:360px;"></div>
</div>

    
  <div class="zeroclipboard-container position-absolute right-0 top-0">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn js-clipboard-copy m-2 p-0" data-copy-feedback="Copied!" data-tooltip-direction="w">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon m-2">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none m-2">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div>


  <div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div>





    </div>
    <div id="js-global-screen-reader-notice" class="sr-only mt-n1" aria-live="polite" aria-atomic="true"></div>
    <div id="js-global-screen-reader-notice-assertive" class="sr-only mt-n1" aria-live="assertive" aria-atomic="true"></div>
  


</body></html>