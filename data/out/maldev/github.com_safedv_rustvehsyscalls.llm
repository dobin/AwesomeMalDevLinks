Title:
RustVEHSyscalls

Type:
GitHub Tool

Short Summary (4–8 sentences max):
- RustVEHSyscalls is a Rust port of White Knight Labs’ LayeredSyscall technique for performing indirect Windows syscalls while preserving “legitimate-looking” user-mode call stacks.  
- It targets user-land EDR/API hooking by making syscalls appear to originate from normal Win32 API call paths rather than direct syscall stubs.  
- The project abuses Vectored Exception Handling (VEH) plus hardware breakpoints to capture a real API call stack frame and then redirect execution into an `ntdll.dll` syscall wrapper.  
- It includes setup/teardown routines to register vectored exception handlers and a `syscall!` macro to resolve syscall addresses and System Service Numbers (SSNs).  
- SSN and syscall stub resolution is done by walking the PEB to find `ntdll.dll` and parsing PE structures (Exception Directory and Export Address Table).  
- Useful for red teamers, pentesters, and offensive tool developers researching syscall-based evasion and call stack spoofing; also relevant for blue teams studying detection gaps around VEH/hardware breakpoint abuse.

Technical Focus:
- Vectored Exception Handling (VEH) abuse for control-flow redirection  
- Hardware breakpoints (debug registers) for syscall interception  
- Indirect syscalls via `ntdll.dll` syscall wrappers  
- PEB walking and `ntdll.dll` discovery  
- PE parsing: Exception Directory + Export Address Table for SSN resolution  
- Call stack frame “legitimization” / stack spoofing concepts

Use Cases:
- Building syscall-capable loaders/implants in Rust that avoid common user-mode hooks  
- Researching call stack–based EDR detections and bypass strategies  
- Prototyping stealthier invocation of sensitive NT syscalls (e.g., process creation)  
- Developing and testing defensive detections for VEH registration and debug-register breakpoint patterns

Keywords:
Rust, Windows, Vectored Exception Handling, VEH, hardware breakpoint, debug registers, indirect syscall, ntdll.dll, syscall stub, System Service Number, SSN, PEB, PE parsing, Exception Directory, Export Address Table, userland hooks, EDR bypass, call stack spoofing, NtCreateUserProcess, LayeredSyscall