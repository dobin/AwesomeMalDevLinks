Title:
Achieving DLL Side-Loading in the Original Process

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post describes a practical methodology to perform DLL side-loading while executing payload code inside the *original signed process* without relying on `DllMain`.  
- It addresses the common stability/OPSEC issue of “loader lock” restrictions in `DllMain`, which can deadlock or hang when shellcode (e.g., C2 beacons) tries to load additional DLLs during initialization.  
- The author shows how to identify side-loadable signed binaries using Process Monitor by spotting missing DLL loads searched from the application directory.  
- It then demonstrates finding which exported functions the target process resolves/calls (via API Monitor observing `LoadLibrary`/`GetProcAddress`) and hijacking the earliest-called export to trigger execution safely after initialization.  
- An example payload is implemented in Nim by mimicking the legitimate export signature (e.g., `GetFileVersionInfoSizeW`) and executing code when that export is invoked.  
- The post also covers a build “gotcha” where toolchains may block exporting names that collide with existing headers, and a workaround by temporarily modifying MinGW headers.  
- Useful primarily for red teamers/pentesters building stealthier, more reliable side-loading implants and for defenders understanding a common tradecraft refinement.

Technical Focus:
- Windows DLL side-loading / search order abuse
- Loader Lock constraints and avoiding `DllMain`
- Exported function hijacking (matching signatures/ABI)
- Procmon-based discovery of missing DLL loads
- API call tracing (`LoadLibrary`, `GetProcAddress`) to identify invoked exports
- Nim + MinGW-w64 cross-compilation/export issues

Use Cases:
- Building stable DLL side-load payloads that execute in-process without `DllMain`
- Selecting portable signed binaries that are practical side-load candidates
- Determining the earliest callable export to minimize reimplementation of legitimate DLL behavior
- Troubleshooting export-name collisions during cross-compilation (Linux → Windows)
- Defensive validation: reproducing side-load chains to create detections around suspicious DLL loads/exports

Keywords:
DLL side-loading, DLL hijacking, Windows loader, Loader Lock, DllMain, signed binary proxying, export forwarding, GetProcAddress, LoadLibrary, Process Monitor, Procmon, API Monitor, VerQueryValueW, GetFileVersionInfoSizeW, GetFileVersionInfoW, winver.dll, Nim, MinGW-w64, in-process execution, OPSEC