Title:
Caro-Kann — Encrypted Shellcode Injection to Avoid Kernel-Triggered Memory Scans

Type:
GitHub Tool

Short Summary (4–8 sentences max):
- Caro-Kann is a PoC injector that aims to evade EDR memory scanning triggered by common injection/execute primitives and kernel callbacks (e.g., ETW TI / thread creation notifications).  
- It splits payload delivery into two stages: an encrypted “known-malicious” payload stored in RW memory and a small “unknown” loader shellcode placed in RX memory.  
- A remote thread is created to run the loader, which sleeps to outlast immediate scan windows, decrypts the real payload, flips memory protections from RW→RX, and then jumps into the decrypted payload.  
- The project highlights how certain Windows API combinations (e.g., remote thread creation) can trigger scans, and how keeping recognizable payload bytes non-executable until just-in-time can reduce detections.  
- It’s primarily useful for red teamers, pentesters, and malware developers experimenting with injection tradecraft and EDR evasion assumptions; it also provides defenders insight into a common “staged decrypt + protect + execute” pattern.

Technical Focus:
- Staged shellcode injection (RW encrypted payload + RX loader)
- Just-in-time decryption and memory protection changes (RW→RX)
- Remote thread creation as an execution primitive
- EDR scan triggers from userland hooks vs kernel callbacks (ETW TI / notify routines)
- API resolving / PIC shellcode building and extraction (mingw-w64, asm, ld)

Use Cases:
- Building PoC loaders that reduce static in-memory signatures prior to execution
- Testing EDR behavior around kernel-triggered memory scans on injection events
- Developing/benchmarking staged payload execution (sleep → decrypt → VirtualProtect → jump)
- Creating training material for detection engineering around late-decrypt execution chains

Keywords:
shellcode injection, encrypted payload, XOR encryption, RW to RX, VirtualProtect, NtCreateThreadEx, remote thread, ETW TI, kernel callbacks, PsSetCreateThreadNotifyRoutine, memory scanning, EDR evasion, staged loader, PIC shellcode, API hashing/resolving, Nim, winim, mingw-w64, module stomping, indirect syscalls