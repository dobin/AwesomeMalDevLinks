Title:
EDR Detection Engines (Defender)

Type:
Blog Post

Short Summary (4–8 sentences max):
- The post outlines a practical model of how Microsoft Defender (and similar EDRs) detect malware using four analysis engines: signature, sandbox/emulation, memory scanning, and behavior monitoring.  
- It explains detection points across the lifecycle: on-disk/pre-execution scanning, short emulation with a time cutoff, memory inspection of the emulated process, and runtime behavior correlation.  
- The author emphasizes that behavior detections are largely driven by telemetry (notably ETW) and may trigger additional memory scans when suspicious activity is observed.  
- It connects these ideas to prior maldev/EDR-evade research and frames evasion as needing to bypass each engine rather than relying on “fancy” techniques that re-trigger detections.  
- Useful for red teamers, pentesters, and malware researchers who want a mental model for why payloads get caught at different stages and what class of countermeasure maps to each stage.

Technical Focus:
- Static signature/heuristic detection (hashes, imphash, YARA-like rules)
- Sandbox/emulation with execution time cutoffs
- Memory scanning of (emulated and live) process memory
- Behavior detection via ETW telemetry (and legacy syscall hooking)
- Detection caching / pre-execution reputation decisions

Use Cases:
- Mapping why a payload is detected (disk vs emulation vs memory vs behavior) to choose the right mitigation
- Designing staged loaders to reduce static indicators and delay high-risk actions past emulator cutoffs
- Testing and tuning obfuscation/string encryption to avoid signature and memory-scan hits
- Building detection hypotheses for blue teams (which telemetry/engine likely fired) during incident triage

Keywords:
Microsoft Defender, EDR, detection engines, signature detection, heuristics, hash, imphash, YARA, sandbox, emulation, time cutoff, memory scanning, runtime scanning, behavior detection, ETW, syscall hooks, loader, string obfuscation, anti-emulation, deconditioning