Title:
Adaptive DLL Hijacking (Advanced DLL Hijacking Techniques)

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post explains advanced, “real-world stable” DLL hijacking approaches on Windows beyond basic side-loading examples.  
- It reviews Windows loader protections and behavior (KnownDLLs, SafeDllSearchMode, module search order) and why many naive hijacks crash due to missing exports or loader-lock issues.  
- Two main execution “sinks” are discussed: static resolution via the Import Address Table (IAT) and dynamic loading via LoadLibrary/GetProcAddress.  
- It covers techniques to preserve application functionality while executing attacker code, including export table cloning/proxy DLLs, export forwarding, and dynamic IAT patching after the DLL is loaded.  
- The article also highlights stability pitfalls in DllMain (loader lock) and suggests moving complex actions to a new thread and/or using hooks for post-load execution control.  
- It references tooling for discovery/exploitation (Siofra, DLLSpy, Robber) and an export-cloning workflow using NetClone (Koppeling project).  
- Useful for red teamers, pentesters, and malware developers focused on stealthy execution and persistence via legitimate processes; also relevant to defenders modeling DLL load abuse.

Technical Focus:
- Windows DLL search order, KnownDLLs, SafeDllSearchMode
- Export Address Table (EAT) / export table cloning and proxy DLLs
- Import Address Table (IAT) parsing and runtime patching
- LoadLibrary/GetProcAddress interception and function proxying
- Loader lock / DllMain constraints and stability engineering
- PE structure concepts (imports, exports, relocations) and reflective-style reconstruction

Use Cases:
- Identify binaries/services vulnerable to DLL search-order hijacking
- Build proxy DLLs that preserve exports/resources while running payloads
- Runtime interception of imported API calls via IAT patching
- More reliable DLL side-loading for persistence or privilege-context execution
- UAC-bypass hunting via auto-elevated binaries (via Siofra-style scanning)

Keywords:
DLL hijacking, DLL side-loading, DLL search order, KnownDLLs, SafeDllSearchMode, HKEY_LOCAL_MACHINE, Session Manager, Export Address Table, EAT, IAT, Import Address Table, PE headers, LoadLibrary, GetProcAddress, DllMain, loader lock, export forwarding, proxy DLL, dynamic IAT patching, Siofra, DLLSpy, Robber, NetClone, Koppeling project, Windows internals, UAC bypass