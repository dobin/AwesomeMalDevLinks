Title:
BOF Spawn – Process Injection (Cobalt Strike BOF)

Type:
GitHub Tool

Short Summary (4–8 sentences max):
- BOF Spawn is a Cobalt Strike Beacon Object File that spawns a new process (often suspended) and injects either a Beacon payload or arbitrary shellcode using a “fork & run” style workflow.  
- It focuses on evasion by combining indirect syscalls (to reduce userland hook interference) with Draugr synthetic stack frames (to spoof call stacks and hinder stack-based detections).  
- The tool supports PPID spoofing and process mitigation policy tweaks (e.g., BlockDLL, disabling CFG) to influence monitoring and execution constraints.  
- Multiple execution methods are implemented, ranging from direct RIP hijacking to gadget-based jumps (JMP RAX/RBX in ntdll) and callback-based execution (e.g., EnumResourceTypesW).  
- The README also documents realistic detection surfaces (ETW-TI for context changes, kernel callbacks for process creation and memory protections), making it useful for both offensive tradecraft and defensive validation.  
- Intended primarily for red teams/pentesters and malware developers working on Windows x64 post-exploitation and injection tradeoffs.

Technical Focus:
- Cobalt Strike BOF + CNA integration (beacon_inline_execute)
- NtCreateUserProcess-based spawning (NT path usage)
- Indirect syscalls / syscall resolution (VxTable-style)
- Draugr synthetic stack frames (stack spoofing)
- Thread context manipulation (NtGetContextThread/NtSetContextThread) and gadget-based execution
- Process mitigation policies (BlockDLL, CFG disable) and memory permission strategies (RW→RX vs RWX)

Use Cases:
- Execute Beacon in a newly spawned process with reduced userland-hook visibility
- Inject and run custom shellcode with selectable execution primitives (RIP hijack, gadgets, callbacks)
- PPID spoofing to shape process tree telemetry during post-exploitation
- Tradecraft testing against EDR detections (ETW-TI, kernel callbacks, memory scanning)
- Lab research on stack spoofing + indirect syscall combinations in real tooling

Keywords:
Cobalt Strike, BOF, Beacon Object File, CNA, process injection, fork and run, NtCreateUserProcess, NT path, indirect syscalls, syscall resolution, VxTable, Draugr, synthetic stack frames, stack spoofing, PPID spoofing, NtGetContextThread, NtSetContextThread, RIP hijacking, ntdll gadget, JMP RAX, JMP RBX, EnumResourceTypesW, callback execution, CFG, BlockDLL, RWX, RW to RX, ETW-TI, PsSetCreateProcessNotifyRoutine