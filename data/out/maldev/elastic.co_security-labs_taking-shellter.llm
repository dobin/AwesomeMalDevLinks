Title:
Taking SHELLTER: a commercial evasion framework abused in-the-wild

Type:
Blog Post

Short Summary (4â€“8 sentences max):
- Elastic Security Labs reports multiple 2025 infostealer campaigns using an illicit copy of the commercial evasion framework Shellter Elite v11.0 as a loader/packer for post-exploitation payload delivery.  
- The write-up details how SHELLTER-protected binaries evade static and dynamic detection via polymorphic/self-modifying code, module unhooking, indirect syscalls, call stack corruption, and runtime memory-permission games.  
- It documents payload protection (LZNT1 compression + AES-128-CBC encryption with embedded or server-fetched key/IV), API resolution obfuscation (time-seeded hashing using KUSER_SHARED_DATA), and multiple anti-analysis features (VM/sandbox and debugger checks).  
- The research highlights AMSI bypass approaches (in-memory patching, COM/ATL object-map sabotage, and IAntimalware vtable patching) plus a VEH-based API proxy mechanism that uses deliberate access violations as control-flow indirection.  
- Campaign coverage includes LUMMA, RHADAMANTHYS, and ARECHCLIENT2/SECTOP RAT distribution via lures (YouTube/MediaFire, creator sponsorship phishing) and notes a consistent embedded license-expiry timestamp used as a detection pivot.  
- Elastic releases a dynamic unpacker for SHELLTER-protected samples and provides YARA/detection guidance, making the work useful for malware analysts and blue teams, and for red teams to understand what defenders can now key on.

Technical Focus:
- Polymorphic/self-modifying shellcode and junk-code insertion
- User-mode unhooking via clean ntdll mapping (NtCreateSection/NtMapViewOfSection, KnownDLLs)
- Indirect syscalls + call stack truncation/corruption
- AES-128-CBC + LZNT1 payload packing and staged extraction
- AMSI bypass (patching, COM/ATL CLSID sabotage, vtable patching)
- VEH-based API proxying using controlled access violations (RtlAddVectoredExceptionHandler)

Use Cases:
- Triage and identify SHELLTER-protected malware using YARA/license-expiry artifacts
- Unpack and extract embedded payload stages for reverse engineering and IOC generation
- Build detections for unhooking behavior, indirect syscalls, and suspicious memory permission flipping
- Analyze/replicate AMSI bypass and VEH proxy patterns in controlled research environments
- Threat hunting for infostealer delivery chains leveraging MediaFire/YouTube lure infrastructure

Keywords:
SHELLTER, Shellter Elite v11.0, infostealer, LUMMA, RHADAMANTHYS, ARECHCLIENT2, SECTOP RAT, polymorphic shellcode, self-modifying code, NtCreateSection, NtMapViewOfSection, KnownDLLs, ntdll.dll unhooking, indirect syscalls, syscall trampoline, call stack spoofing, KUSER_SHARED_DATA, API hashing ROR13, AES-128-CBC, LZNT1, AMSI bypass, CLSID_Antimalware, ATL object map, IAntimalware vtable patch, RtlAddVectoredExceptionHandler, YARA, dynamic unpacker, BITS C2