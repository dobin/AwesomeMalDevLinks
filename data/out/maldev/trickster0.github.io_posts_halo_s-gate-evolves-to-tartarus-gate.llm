Title:
Halo’s Gate Evolves -> Tartarus’ Gate

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post explains why Hell’s Gate/Halo’s Gate style direct-syscall resolution can fail against certain EDR userland hooking implementations and introduces an extension called “Tartarus’ Gate.”  
- Hell’s Gate derives syscall numbers by locating `ntdll.dll` via the PEB loader lists and parsing exports, but it breaks when EDRs hook/unhook or otherwise modify the syscall stubs.  
- Halo’s Gate detects common hooks by checking the expected syscall-stub prologue bytes (e.g., `4c 8b d1 b8`) and, if a `jmp` (`e9`) is found, walks to neighboring stubs to infer the correct syscall number.  
- The author observed an EDR hook pattern where the stub begins with `4c 8b d1 e9` (the `jmp` appears at the 4th byte), which bypasses Halo’s initial check and causes failures.  
- Tartarus’ Gate adds an additional check for `e9` at the 4th byte and applies the same neighbor-walking logic to recover syscall IDs.  
- Useful for red teamers, pentesters, and malware developers building direct-syscall loaders/injectors that must survive varied EDR inline-hook patterns.

Technical Focus:
- PEB traversal and `InMemoryOrderModuleList` to locate `ntdll.dll`
- Parsing `ntdll` exports to resolve NTAPI syscall stubs
- Userland inline hooking detection via stub byte-pattern checks
- Syscall number inference by scanning adjacent syscall stubs (Halo’s Gate technique)
- EDR hook-variant handling (`e9` at different offsets) and robustness issues

Use Cases:
- Building direct-syscall execution paths to reduce userland API hooking visibility
- Adapting syscall-stub validation logic to different EDR inline-hook styles
- Researching/triaging why syscall-resolvers fail on specific endpoint products
- Developing more reliable injection chains that avoid hooked WinAPI/NTAPI entrypoints

Keywords:
Hell’s Gate, Halo’s Gate, Tartarus’ Gate, direct syscalls, Windows, ntdll.dll, PEB, InMemoryOrderModuleList, NTAPI, syscall stub, syscall number, export parsing, inline hook, EDR, unhooking, JMP e9, 4c8bd1b8, 4c8bd1e9, CreateRemoteThread, process injection