Title:
al-khaser (Anti-analysis / Anti-VM / Anti-debugging PoC)

Type:
GitHub Tool

Short Summary (4–8 sentences max):
- al-khaser is a Windows PoC “malware” application intended to stress-test anti-malware, sandbox, and analysis environments by executing many real-world anti-analysis techniques.  
- It helps defenders and researchers validate whether their sandbox/VM artifacts are detectable and whether their monitoring/debugging stack is exposed.  
- The repo implements broad categories of checks: anti-debugging (PEB flags, NtQueryInformationProcess, breakpoints, TLS callbacks), anti-VM/emulation (registry/files/WMI/SMBIOS/ACPI/CPUID artifacts across VMware/VirtualBox/Hyper-V/KVM/QEMU/Xen/Wine/Parallels), timing-based evasion, and analysis-tool detection.  
- It also includes anti-injection/module-hiding detection logic and showcases common code injection primitives (e.g., CreateRemoteThread, APC, NtCreateThreadEx, RunPE).  
- Useful for Blue Teams building stealthier sandboxes/EDR labs, malware analysts hardening detonation environments, and Red Teams/malware devs studying common anti-analysis patterns and their detection surface.  
- Interesting because it consolidates many “in-the-wild” checks into a single, configurable harness for repeatable testing and regression.

Technical Focus:
- Windows anti-debugging (PEB, NtQueryInformationProcess, HideThreadFromDebugger, breakpoint/SEH tricks)
- Anti-VM / anti-emulation artifact discovery (registry, filesystem, processes, devices, MAC OUIs)
- Firmware/CPU virtualization detection (CPUID hypervisor leafs, SMBIOS/ACPI table inspection)
- Timing/sleep evasion (RDTSC, NtDelayExecution, timer APIs, wait APIs)
- Anti-injection / hidden module enumeration (Toolhelp, PSAPI, LdrEnumerateLoadedModules, memory walking)
- Analysis tool and hook detection (process/DLL indicators, module-bounds hook checks)

Use Cases:
- Validate whether a sandbox/VM build leaks common virtualization artifacts (VMware/VirtualBox/Hyper-V/KVM/QEMU/Xen/Wine/Parallels).
- Regression-test EDR/sandbox hardening changes against known anti-analysis checks.
- Build detections for anti-analysis behavior (API usage patterns, WMI queries, CPUID/RDTSC sequences).
- Train malware analysts on common evasion techniques and how to mitigate them in lab environments.
- Compare module enumeration approaches to spot injected/hidden modules in a process.

Keywords:
Windows, anti-analysis, anti-debugging, anti-VM, sandbox evasion, IsDebuggerPresent, CheckRemoteDebuggerPresent, PEB BeingDebugged, NtQueryInformationProcess, ProcessDebugPort, HideThreadFromDebugger, TLS callbacks, RDTSC, CPUID hypervisor, SMBIOS, ACPI, WMI Win32_BIOS, VirtualBox, VMware, Hyper-V, KVM, QEMU, Xen, Wine, module enumeration, LdrEnumerateLoadedModules, CreateRemoteThread, QueueUserAPC, NtCreateThreadEx, RunPE