Title:
DeepSleep

Type:
GitHub Tool

Short Summary (4–8 sentences max):
DeepSleep is an x64 “Gargoyle”-style proof-of-concept that hides in-memory artifacts by changing its own memory protections while the implant is sleeping. It builds a ROP chain (VirtualProtect → Sleep → VirtualProtect) to mark the payload’s pages as inaccessible (N/A / PAGE_NOACCESS) during idle time, then restores executable permissions when active. The implementation is position-independent code (PIC) and avoids APC-based execution, aiming to reduce common injection/sleep-hook artifacts and make page enumeration simpler. The repo demonstrates bypassing memory scanners like Moneta (at the time of writing) when injected such that the executing thread’s base address doesn’t point to private committed memory. It’s primarily useful for red teams, implant developers, and researchers studying in-memory evasion and “sleep masking” tradeoffs. It also documents a detection angle: suspicious call stacks for threads in DelayExecution that include VirtualProtect and unknown/tampered regions.

Technical Focus:
- Sleep masking via memory protection flipping (VirtualProtect + Sleep)
- ROP-only execution flow (x64 ROP chains, gadget selection in ntdll)
- Position-independent code (PIC) payload design
- Memory scanner evasion (Moneta / PE-sieve-style heuristics)
- Injection validation using Early Bird APC injection
- Detection via thread call stack analysis during DelayExecution

Use Cases:
- Implementing/experimenting with sleep-masking in custom implants
- Evaluating how memory scanners detect “sleeping beacons” and protection changes
- Researching ROP-based control flow to avoid direct API call patterns
- Building test cases for defensive tooling that inspects thread stacks and memory protections

Keywords:
DeepSleep, Gargoyle, sleep masking, ROP chain, x64, PIC, VirtualProtect, Sleep, PAGE_NOACCESS, ntdll.dll, ROP gadgets, Moneta, PE-sieve, memory artifact evasion, Early Bird APC, process injection, DelayExecution, call stack inspection, Hunt-Sleeping-Beacons, Windows 10 19044