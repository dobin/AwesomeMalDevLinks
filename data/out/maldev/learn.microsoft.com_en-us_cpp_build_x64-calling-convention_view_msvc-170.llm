Title:
x64 calling convention (MSVC / Windows x64 ABI)

Type:
Documentation

Short Summary (4–8 sentences max):
- This Microsoft documentation describes the Windows x64 (MSVC) calling convention and ABI rules governing how callers and callees pass arguments, return values, and preserve registers.  
- It explains the default four-register fastcall scheme (RCX/RDX/R8/R9 for integer/pointers and XMM0–XMM3 for floating point) and the required 32-byte “shadow space” reserved by the caller.  
- The article details stack alignment requirements (notably 16-byte alignment), how aggregates and vector types are passed (often by reference), and special handling for varargs/unprototyped functions (including duplicating FP args into GPRs).  
- It covers unwindability constraints on prolog/epilog code and the role of pdata/xdata unwind metadata used for exception handling and stack walking.  
- It enumerates volatile vs nonvolatile registers (including SIMD/AVX/AVX-512/AMX considerations) and notes rules for preserving FPCSR/MXCSR control state.  
- This is most useful for exploit developers, reverse engineers, malware developers, and low-level Windows tooling authors who need correct interop with compiled code, reliable stack unwinding, or custom assembly stubs.

Technical Focus:
- Windows x64 ABI / MSVC calling convention
- Register-based parameter passing + shadow space
- Stack alignment and stack argument layout
- Unwind metadata (pdata/xdata) and prolog/epilog constraints
- Volatile vs nonvolatile register preservation (GPR/SIMD/AVX/AMX)
- Varargs/unprototyped function calling rules and return-value conventions

Use Cases:
- Writing reliable x64 shellcode/assembly stubs that call WinAPI correctly
- Building hooks/trampolines and detours without corrupting register/stack state
- Implementing ROP/JOP chains and understanding argument placement
- Debugging crashes by interpreting stack frames and unwind info
- Developing custom exception/unwind-aware instrumentation or loaders

Keywords:
Windows x64 ABI, MSVC, calling convention, RCX, RDX, R8, R9, XMM0, XMM1, XMM2, XMM3, shadow space, stack alignment, volatile registers, nonvolatile registers, prolog, epilog, unwind, pdata, xdata, MXCSR, FPCSR, varargs, setjmp, longjmp, __m128, __vectorcall, AVX512, AMX