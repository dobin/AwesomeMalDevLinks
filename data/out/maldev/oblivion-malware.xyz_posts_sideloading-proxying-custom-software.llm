Title:
Sideloading + Proxying in Custom Software

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post demonstrates DLL sideloading combined with DLL proxying to execute a payload while keeping a target application stable.  
- It explains how Windows DLL search order (SafeDllSearchMode) and writable execution directories enable hijacking, with the caveat that KnownDLLs cannot be hijacked.  
- A C-based proof-of-concept “Custom_Software.exe” loads a DLL and calls an exported function; the attacker replaces the DLL with a malicious one that either forwards exports via a .def file or manually loads the real DLL and proxies the call.  
- Two proxying approaches are compared: export forwarding (payload mainly in DllMain) versus non-forwarding (payload in DllMain and/or inside the proxied export).  
- The post also notes a path-hijacking variant using absolute paths and suggests validating missing-DLL load attempts with Process Monitor (“NAME NOT FOUND”).  
- Useful for red teamers, pentesters, and malware developers building reliable DLL hijacks that preserve application functionality.

Technical Focus:
- Windows DLL loader behavior and SafeDllSearchMode search order  
- DLL sideloading / DLL search order hijacking  
- DLL proxying via export forwarding (.def) vs manual proxy stubs  
- DllMain execution (DLL_PROCESS_ATTACH) vs payload in exported functions  
- LoadLibraryA / GetProcAddress API usage  
- KnownDLLs limitation and operational prerequisites (write access to app directory)

Use Cases:
- Building stable DLL hijacks that avoid crashing legitimate applications
- Creating proxy DLLs that transparently pass through to original functionality
- Testing/teaching DLL search order abuse with a minimal C PoC
- Validating hijack opportunities using ProcMon “NAME NOT FOUND” traces
- Developing tradecraft for signed-binary execution with malicious DLL side-loading

Keywords:
DLL sideloading, DLL proxying, export forwarding, module-definition file, .def, SafeDllSearchMode, KnownDLLs, DLL search order hijacking, LoadLibraryA, GetProcAddress, DllMain, DLL_PROCESS_ATTACH, Windows loader, proxy DLL, Process Monitor, NAME NOT FOUND, System32, path hijacking, C PoC, Windows internals