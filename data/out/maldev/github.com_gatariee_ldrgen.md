# https://github.com/gatariee/ldrgen

[Skip to content](https://github.com/gatariee/ldrgen#start-of-content)

You signed in with another tab or window. [Reload](https://github.com/gatariee/ldrgen) to refresh your session.You signed out in another tab or window. [Reload](https://github.com/gatariee/ldrgen) to refresh your session.You switched accounts on another tab or window. [Reload](https://github.com/gatariee/ldrgen) to refresh your session.Dismiss alert

{{ message }}

[gatariee](https://github.com/gatariee)/ **[ldrgen](https://github.com/gatariee/ldrgen)** Public

- [Notifications](https://github.com/login?return_to=%2Fgatariee%2Fldrgen) You must be signed in to change notification settings
- [Fork\\
8](https://github.com/login?return_to=%2Fgatariee%2Fldrgen)
- [Star\\
80](https://github.com/login?return_to=%2Fgatariee%2Fldrgen)


Template-based generation of shellcode loaders


[80\\
stars](https://github.com/gatariee/ldrgen/stargazers) [8\\
forks](https://github.com/gatariee/ldrgen/forks) [Branches](https://github.com/gatariee/ldrgen/branches) [Tags](https://github.com/gatariee/ldrgen/tags) [Activity](https://github.com/gatariee/ldrgen/activity)

[Star](https://github.com/login?return_to=%2Fgatariee%2Fldrgen)

[Notifications](https://github.com/login?return_to=%2Fgatariee%2Fldrgen) You must be signed in to change notification settings

# gatariee/ldrgen

main

[**1** Branch](https://github.com/gatariee/ldrgen/branches) [**2** Tags](https://github.com/gatariee/ldrgen/tags)

[Go to Branches page](https://github.com/gatariee/ldrgen/branches)[Go to Tags page](https://github.com/gatariee/ldrgen/tags)

Go to file

Code

Open more actions menu

## Folders and files

| Name | Name | Last commit message | Last commit date |
| --- | --- | --- | --- |
| ## Latest commit<br>[![gatariee](https://avatars.githubusercontent.com/u/79693291?v=4&size=40)](https://github.com/gatariee)[gatariee](https://github.com/gatariee/ldrgen/commits?author=gatariee)<br>[Merge pull request](https://github.com/gatariee/ldrgen/commit/5f913d4e1cdbc2994e88cbf3221fe07ce776a57d) [#2](https://github.com/gatariee/ldrgen/pull/2) [from winterrdog/main](https://github.com/gatariee/ldrgen/commit/5f913d4e1cdbc2994e88cbf3221fe07ce776a57d)<br>Open commit details<br>2 years agoApr 20, 2024<br>[5f913d4](https://github.com/gatariee/ldrgen/commit/5f913d4e1cdbc2994e88cbf3221fe07ce776a57d) · 2 years agoApr 20, 2024<br>## History<br>[107 Commits](https://github.com/gatariee/ldrgen/commits/main/) <br>Open commit details<br>[View commit history for this file.](https://github.com/gatariee/ldrgen/commits/main/) 107 Commits |
| [profiles](https://github.com/gatariee/ldrgen/tree/main/profiles "profiles") | [profiles](https://github.com/gatariee/ldrgen/tree/main/profiles "profiles") | [Update ebapc.json](https://github.com/gatariee/ldrgen/commit/c7a97d047a68632ef150f68968ba4ec4d44136fd "Update ebapc.json") | 2 years agoMar 1, 2024 |
| [src](https://github.com/gatariee/ldrgen/tree/main/src "src") | [src](https://github.com/gatariee/ldrgen/tree/main/src "src") | [more cleanup](https://github.com/gatariee/ldrgen/commit/4ed4ce2a5d4186dc0643832dc360f24dcff93b99 "more cleanup") | 2 years agoMar 1, 2024 |
| [templates](https://github.com/gatariee/ldrgen/tree/main/templates "templates") | [templates](https://github.com/gatariee/ldrgen/tree/main/templates "templates") | [fix: include `windows.h` before any other windows header files](https://github.com/gatariee/ldrgen/commit/ba785a197a179924f3b3832fbe62c1df5be19f3b "fix: include `windows.h` before any other windows header files  not including `windows.h` before any other windows-related header files can lead to compilation errors whereby the compiler can't locate Windows Data types like `ULONG_PTR`, `WINBOOL` or `HANDLE`") | 2 years agoApr 19, 2024 |
| [.gitattributes](https://github.com/gatariee/ldrgen/blob/main/.gitattributes ".gitattributes") | [.gitattributes](https://github.com/gatariee/ldrgen/blob/main/.gitattributes ".gitattributes") | [Initial commit](https://github.com/gatariee/ldrgen/commit/91042431fa0997b130fa8ed971c799552d70b507 "Initial commit") | 3 years agoDec 26, 2023 |
| [README.md](https://github.com/gatariee/ldrgen/blob/main/README.md "README.md") | [README.md](https://github.com/gatariee/ldrgen/blob/main/README.md "README.md") | [Update README.md](https://github.com/gatariee/ldrgen/commit/8b8386c444e74724950c4a2024190396546c4700 "Update README.md") | 2 years agoMar 1, 2024 |
| [go.work](https://github.com/gatariee/ldrgen/blob/main/go.work "go.work") | [go.work](https://github.com/gatariee/ldrgen/blob/main/go.work "go.work") | [cleaning up dev stuff](https://github.com/gatariee/ldrgen/commit/d9176022e849dd41fcec3c53fd67e475b202ea8c "cleaning up dev stuff") | 2 years agoFeb 22, 2024 |
| [go.work.sum](https://github.com/gatariee/ldrgen/blob/main/go.work.sum "go.work.sum") | [go.work.sum](https://github.com/gatariee/ldrgen/blob/main/go.work.sum "go.work.sum") | [lots and lots of fixes](https://github.com/gatariee/ldrgen/commit/3a0a3a17ba8448888507b233516921d26f972dfa "lots and lots of fixes") | 2 years agoFeb 22, 2024 |
| [makefile](https://github.com/gatariee/ldrgen/blob/main/makefile "makefile") | [makefile](https://github.com/gatariee/ldrgen/blob/main/makefile "makefile") | [bins](https://github.com/gatariee/ldrgen/commit/57b890794ee4be5944e282cbbd1f5307cf52abed "bins") | 2 years agoMar 1, 2024 |
| View all files |

## Repository files navigation

# ldrgen

[Permalink: ldrgen](https://github.com/gatariee/ldrgen#ldrgen)

**ldrgen** allows operators to generate shellcode loaders from a set of pre-defined templates and profiles with the aim of hopefully streamlining development and reducing the time it takes to get a new loader out the door.

## Getting Started

[Permalink: Getting Started](https://github.com/gatariee/ldrgen#getting-started)

There are available binaries on the [releases](https://github.com/gatariee/ldrgen/releases) page, or you can build from source for the latest version.

### Usage

[Permalink: Usage](https://github.com/gatariee/ldrgen#usage)

```
ldrgen profile --profile [path_to_profile] --shellcode [path_to_shellcode]
```

[![hmm](https://camo.githubusercontent.com/32bdc6c7fc8c4dffe7777d7b2a2634c2ea620aae640d47a4abebe883ea2ac8a3/68747470733a2f2f692e6779617a6f2e636f6d2f39623230633065323639393534323236386564353161656362613665656432642e706e67)](https://camo.githubusercontent.com/32bdc6c7fc8c4dffe7777d7b2a2634c2ea620aae640d47a4abebe883ea2ac8a3/68747470733a2f2f692e6779617a6f2e636f6d2f39623230633065323639393534323236386564353161656362613665656432642e706e67)

### How does it work?

[Permalink: How does it work?](https://github.com/gatariee/ldrgen#how-does-it-work)

- Source files (`*.c`) or loaders are saved as templates in the `templates` directory, placeholders are also supported to be templated during generation.
- The template configuration is saved as [`config.yaml`](https://github.com/gatariee/ldrgen/blob/main/templates/config.yaml) in the `templates` directory, this contains information about the loader, what source files it requires and whether any substitutions are required.
- Profiles are saved in the `profiles` directory, these can be used and customized to your personal preference to utilize the templates you've created.

#### Source

[Permalink: Source](https://github.com/gatariee/ldrgen#source)

These are your loaders, most of the time these are the artifacts that get caught by AV. Put some effort into making some of these in your own time, and you'll have a nice collection of loaders to use!

[CreateThread\_Xor.c](https://github.com/gatariee/ldrgen/blob/main/templates/Source/CreateThread_Xor.c) is a good example of a simple loader that uses `CreateThread` to execute shellcode. It also has a `xorShellcode` function that will decrypt the shellcode before execution.

```
...

    xorShellcode( shellcode, shellcode_size, "${KEY}" );

...
```

#### Templates

[Permalink: Templates](https://github.com/gatariee/ldrgen#templates)

The ${KEY} placeholder is explicitly defined in the `config.yaml` file, and is used to substitute the key used to decrypt the shellcode. This is a simple example of how to use placeholders in your templates.

```
  - token: "createthread_xor"
    key_required: true
    enc_type: "xor"
    method: "VirtualAlloc, xorShellcode, memcpy, CreateThread, WaitForSingleObject"
    files:
      - sourcePath: "Source/CreateThread_Xor.c"
        outputPath: "Main.c"
        substitutions:
          key: "${KEY}"

      - sourcePath: "Source/Xor.c"
        outputPath: "Xor.c"

      - sourcePath: "Include/Xor.h"
        outputPath: "Xor.h"

      - sourcePath: "makefile"
        outputPath: "makefile"
```

#### Profiles

[Permalink: Profiles](https://github.com/gatariee/ldrgen#profiles)

These are malleable configurations that can be used to generate a loader from a template.

```
{
    "name": "Default Loader, but with XOR (CreateThread)",
    "author": "@gatari",
    "description": "A simple shellcode loader that uses CreateThread with XOR encrypted shellcode.",
    "template": {
        "path": "/opt/tools/ldrgen/templates/config.yaml",
        "token": "CreateThread_Xor",
        "enc_type": "xor",
        "substitutions": {
            "key": "as@&(!L@J#JKsn"
        }
    },
    "arch": "x64",
    "compile": {
        "automatic": true,
        "make": "make",
        "gcc": {
            "x64": "x86_64-w64-mingw32-gcc",
            "x86": "i686-w64-mingw32-gcc"
        },
        "strip": {
            "i686": "strip",
            "x86_64": "strip"
        }
    },
    "output_dir": "./createthreadxor"
}
```

### Releases

[Permalink: Releases](https://github.com/gatariee/ldrgen#releases)

Standalone binaries are available, however `templates` and `profiles` will be ingested by `ldrgen`. The latest release should have these included.

### Building from Source

[Permalink: Building from Source](https://github.com/gatariee/ldrgen#building-from-source)

```
cd ldrgen
make build
```

### Design Principles

[Permalink: Design Principles](https://github.com/gatariee/ldrgen#design-principles)

This tool is **not** designed to be turing complete by any means, it's designed to **streamline** the process of developing loaders- it is ultimately up to the operator to develop their own loaders and templates should they wish to do so.

`ldrgen` started as a personal project for encrypting beacon shellcode, then parsing it into a header file for use in a stageless loader. It was a pain to do this manually, so I decided to automate it- and it built from there.

### Contributing

[Permalink: Contributing](https://github.com/gatariee/ldrgen#contributing)

If you'd like to contribute, feel free to open a PR or an issue. I'm always open to suggestions and improvements. However, before you make an issue, do remember that the objective of this tool is to streamline the process of developing loaders, not to be provide a cheat code for bypassing AV.

## About

Template-based generation of shellcode loaders


### Resources

[Readme](https://github.com/gatariee/ldrgen#readme-ov-file)

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/gatariee/ldrgen).

[Activity](https://github.com/gatariee/ldrgen/activity)

### Stars

[**80**\\
stars](https://github.com/gatariee/ldrgen/stargazers)

### Watchers

[**2**\\
watching](https://github.com/gatariee/ldrgen/watchers)

### Forks

[**8**\\
forks](https://github.com/gatariee/ldrgen/forks)

[Report repository](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fgatariee%2Fldrgen&report=gatariee+%28user%29)

## [Releases\  1](https://github.com/gatariee/ldrgen/releases)

[v1.0.0\\
Latest\\
\\
on Mar 1, 2024Mar 1, 2024](https://github.com/gatariee/ldrgen/releases/tag/v1.0.0)

## [Packages\  0](https://github.com/users/gatariee/packages?repo_name=ldrgen)

No packages published

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/gatariee/ldrgen).

## [Contributors\  2](https://github.com/gatariee/ldrgen/graphs/contributors)

- [![@gatariee](https://avatars.githubusercontent.com/u/79693291?s=64&v=4)](https://github.com/gatariee)[**gatariee** gatari](https://github.com/gatariee)
- [![@winterrdog](https://avatars.githubusercontent.com/u/87463258?s=64&v=4)](https://github.com/winterrdog)[**winterrdog** winterrdog](https://github.com/winterrdog)

## Languages

- [C94.3%](https://github.com/gatariee/ldrgen/search?l=c)
- [Go5.3%](https://github.com/gatariee/ldrgen/search?l=go)
- Other0.4%

You can’t perform that action at this time.