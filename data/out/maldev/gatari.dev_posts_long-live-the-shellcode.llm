Title:
Long Live the Shellcode — Demystifying AV/EDR Evasion (sRDI, Reflective Loading, Meterpreter)

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post explains why “shellcode” generated by many C2 frameworks (and Meterpreter) is often not traditional PIC shellcode, but a reflectively-loaded DLL packaged to behave like shellcode via sRDI.  
- It walks through debugging a common VirtualAlloc/RtlCopyMemory/CreateThread loader and highlights that additional memory allocations come from the payload itself because it performs reflective loading in-memory.  
- The author breaks down Reflective DLL Injection (ReflectiveLoader responsibilities: relocations, imports, section mapping, entrypoint) and how sRDI adds a small stub so execution can start at the buffer base without computing the loader offset externally.  
- Meterpreter is used as a concrete example: its “shellcode” contains a hotpatched DOS header stub that jumps to ReflectiveLoader at a baked-in RVA.  
- The key operational takeaway is that EDR detections often focus on memory allocation and “unbacked” executable regions, and these behaviors may be driven by the reflective loader inside the payload, not just the external loader.  
- Useful for red teamers/pentesters troubleshooting payload detections and for defenders understanding what telemetry to expect from reflective-loading implants.

Technical Focus:
- Reflective DLL Injection (Stephen Fewer ReflectiveLoader)
- Shellcode Reflective DLL Injection (sRDI) stubs and RVA-based jumps
- Windows memory allocation/execution patterns (VirtualAlloc/NtAllocateVirtualMemory, RWX, unbacked memory)
- Meterpreter payload internals (reflective DLL + hotpatched DOS header)
- Debugging shellcode/implants to attribute memory behavior to loader vs payload
- EDR detection concepts around module-backed vs non-module-backed memory

Use Cases:
- Diagnose why a “simple” shellcode loader still triggers EDR due to payload self-allocation/reflective mapping
- Modify/replace reflective loaders (e.g., Cobalt Strike UDRL, Havoc) to change allocation/protection patterns
- Build better implant telemetry expectations during dynamic analysis (breakpoints on NtAllocateVirtualMemory, etc.)
- Create detection logic focused on reflective loading artifacts (unbacked RX regions, reflective import resolution patterns)

Keywords:
sRDI, Reflective DLL Injection, ReflectiveLoader, Meterpreter, msfvenom, CreateThread, VirtualAlloc, NtAllocateVirtualMemory, RtlCopyMemory, LoadLibraryA, VirtualAllocEx, WriteProcessMemory, CreateRemoteThread, unbacked memory, module-backed memory, EDR evasion, Cobalt Strike UDRL, Havoc C2, PIC payload, DOS header hotpatching