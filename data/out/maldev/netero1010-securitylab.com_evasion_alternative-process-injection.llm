Title:
Alternative Process Injection (Shellcode injection into already loaded DLL .text / MEM_IMAGE)

Type:
Blog Post

Short Summary (4–8 sentences max):
This post describes an alternative Windows process injection approach intended to reduce common EDR detections tied to classic CreateRemoteThread shellcode injection. Instead of allocating new executable private memory (MEM_PRIVATE) via VirtualAllocEx/NtAllocateVirtualMemory, it overwrites bytes inside the .text section of an already loaded DLL (e.g., msvcp_win.dll) so the new thread start address resides in a MEM_IMAGE region with plausible RX permissions. The author outlines a method to scan loaded modules to find a “safe” .text page with enough space that can be overwritten without crashing the target process, then uses VirtualProtectEx → WriteProcessMemory → VirtualProtectEx → CreateRemoteThread to execute. The technique aims to evade detections like Get-InjectedThread that flag threads starting in private executable memory, but it introduces a different artifact: “modified code” where patched image pages become private/modified and can be detected by tools like Moneta. It’s mainly useful for red teamers and malware developers studying EDR telemetry (ETW TI, kernel callbacks) and tradecraft tradeoffs, and for defenders to understand alternate injection IOCs.

Technical Focus:
- EDR telemetry sources (ETW Threat Intelligence, kernel callbacks, API monitoring) and injection detection logic
- MEM_PRIVATE vs MEM_IMAGE thread start address heuristics (Get-InjectedThread-style detections)
- Overwriting DLL .text sections in remote processes (code modification in image-backed memory)
- Windows APIs: VirtualProtectEx, WriteProcessMemory, CreateRemoteThread, VirtualQueryEx
- Stability/OPSEC tradeoffs and “modified code” memory forensics (Moneta)

Use Cases:
- Execute shellcode with a thread start address inside MEM_IMAGE to bypass “private RX” heuristics
- Evaluate EDR detection coverage against non-allocating injection variants
- Build/validate memory-forensics detections for image-page modification (“modified code”)
- Red team tradecraft experimentation in C# for process injection and module enumeration

Keywords:
process injection, CreateRemoteThread, WriteProcessMemory, VirtualProtectEx, ETW Threat Intelligence, PsSetCreateProcessNotifyRoutine, Sysmon, API hooking, Get-InjectedThread, MEM_PRIVATE, MEM_IMAGE, DLL .text section, code cave, module enumeration, VirtualQueryEx, msvcp_win.dll, Moneta, modified code, DLL hollowing, Windows internals