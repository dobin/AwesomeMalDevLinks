# https://hadess.io/adaptive-dll-hijacking/

<!DOCTYPE html><html lang="en"><body class="wp-singular post-template-default single single-post postid-8744 single-format-standard wp-theme-newsmatic theme--newsmatic newsmatic-title-two newsmatic-image-hover--effect-two site-full-width--layout newsmatic_site_block_border_top right-sidebar newsmatic_main_body newsmatic_font_typography nekit elementor-default elementor-kit-6" itemtype="https://schema.org/Blog" itemscope="itemscope">

<div class="hd-mobile">
    <div class="hd-mob-inner">
        
        <form class="hd-mob-search" action="https://hadess.io/" method="get">
            <input type="text" name="s" placeholder="Search...">
            <button type="submit" aria-label="Search">
                <svg viewBox="0 0 24 24"><circle cx="10.5" cy="10.5" r="7.5"></circle><path d="M21 21l-5.2-5.2"></path></svg>
            </button>
        </form>
        
        <div class="hd-mob-item">
            <div class="hd-mob-head">Research<svg viewBox="0 0 16 16"><line x1="1" y1="8" x2="15" y2="8"></line><line x1="8" y1="1" x2="8" y2="15"></line></svg></div>
            <div class="hd-mob-sub">
                <a href="https://hadess.io/blog/">Blog</a>
                <a href="https://hadess.io/category/white-paper/">White Papers</a>
                <a href="https://hadess.io/category/case-study/">Case Studies</a>
                <a href="https://hadess.io/category/offensive/">Offensive Security</a>
                <a href="https://hadess.io/category/soc/">SOC</a>
                <a href="https://hadess.io/category/grc/">GRC</a>
                <a href="https://hadess.io/category/advisory/">Advisory</a>
            </div>
        </div>
        <div class="hd-mob-item">
            <div class="hd-mob-head">Guides<svg viewBox="0 0 16 16"><line x1="1" y1="8" x2="15" y2="8"></line><line x1="8" y1="1" x2="8" y2="15"></line></svg></div>
            <div class="hd-mob-sub">
                <a href="https://blog.redteamguides.com/">Red Team Guide</a>
                <a href="http://blog.devsecopsguides.com/">DevSecOps Guides</a>
                <a href="http://hazardlab.ninja/">Vulnerability Research</a>
            </div>
        </div>
        <div class="hd-mob-item"><a href="https://hadess.io/" class="hd-mob-head">About Us</a></div>
        <a href="https://hadess.io/blog/" class="hd-mob-cta">Blog</a>
    </div>
</div>



		
		


<!-- Google tag (gtag.js) -->

<link rel="icon" href="https://hadess.io/wp-content/uploads/2022/06/cropped-favicon-32x32.png" sizes="32x32">
<link rel="icon" href="https://hadess.io/wp-content/uploads/2022/06/cropped-favicon-192x192.png" sizes="192x192">
<link rel="apple-touch-icon" href="https://hadess.io/wp-content/uploads/2022/06/cropped-favicon-180x180.png">


		
		




			<button type="button" aria-controls="rmp-container-9038" aria-label="Menu Trigger" id="rmp_menu_trigger-9038" class="rmp_menu_trigger rmp-menu-trigger-boring">
								<span class="rmp-trigger-box">
									<span class="responsive-menu-pro-inner"></span>
								</span>
					</button>
						<div id="rmp-container-9038" class="rmp-container rmp-container rmp-slide-left">
							<div id="rmp-menu-title-9038" class="rmp-menu-title">
									<a href="https://hadess.io/" target="_self" class="rmp-menu-title-link" id="rmp-menu-title-link">
										<span>HADESS</span>					</a>
							</div>
						<div id="rmp-menu-additional-content-9038" class="rmp-menu-additional-content">
					Cyber Security Magic				</div>
			<div id="rmp-menu-wrap-9038" class="rmp-menu-wrap"><ul id="rmp-menu-9038" class="rmp-menu" role="menubar" aria-label="Main"><li id="rmp-menu-item-8918" class=" menu-item menu-item-type-custom menu-item-object-custom rmp-menu-item rmp-menu-top-level-item" role="none"><a href="https://hadess.io/" class="rmp-menu-item-link" role="menuitem">Home</a></li><li id="rmp-menu-item-6917" class=" menu-item menu-item-type-custom menu-item-object-custom rmp-menu-item rmp-menu-top-level-item" role="none"><a href="https://hadess.io/" class="rmp-menu-item-link" role="menuitem">Resources</a></li><li id="rmp-menu-item-6918" class=" menu-item menu-item-type-custom menu-item-object-custom rmp-menu-item rmp-menu-top-level-item" role="none"><a class="rmp-menu-item-link" role="menuitem">Reports</a></li><li id="rmp-menu-item-6919" class=" menu-item menu-item-type-custom menu-item-object-custom rmp-menu-item rmp-menu-top-level-item" role="none"><a class="rmp-menu-item-link" role="menuitem">Solutions</a></li><li id="rmp-menu-item-6920" class=" menu-item menu-item-type-custom menu-item-object-custom rmp-menu-item rmp-menu-top-level-item" role="none"><a class="rmp-menu-item-link" role="menuitem">About Us</a></li></ul></div>			<div id="rmp-search-box-9038" class="rmp-search-box">
					<form action="https://hadess.io/" class="rmp-search-form" role="search">
						<input type="search" name="s" title="Search" placeholder="Search" class="rmp-search-box">
					</form>
				</div>
						</div>
			<div id="page" class="site">
	<a class="skip-link screen-reader-text" href="https://hadess.io/adaptive-dll-hijacking/#primary">Skip to content</a>
				<div class="newsmatic_ovelay_div"></div>
						
			<!-- #masthead -->
			
			        <div class="after-header header-layout-banner-two">
            <div class="newsmatic-container">
                <div class="row">
                                    <div class="ads-banner">
                    <a href="https://hadess.io/adaptive-dll-hijacking/" target="_self"><img src="https://hadess.io/wp-content/uploads/2024/12/ppid.png"></a>
                </div><!-- .ads-banner -->
                            </div>
            </div>
        </div>
        	<div id="theme-content">
		            <div class="newsmatic-container">
                <div class="row">
                                <div class="newsmatic-breadcrumb-wrap">
                                    </div>
                        </div>
            </div>
            		<main id="primary" class="site-main">
			<div class="newsmatic-container">
				<div class="row">
					<div class="secondary-left-sidebar">
											</div>
					<div class="primary-content">
												<div class="post-inner-wrapper">
							<article itemtype="https://schema.org/Article" itemscope="itemscope" id="post-8744" class="post-8744 post type-post status-publish format-standard has-post-thumbnail hentry category-hot category-offensive category-white-paper">
	<div class="post-inner">
		<!-- .entry-header -->

		<div itemprop="articleBody" class="entry-content">
			
<p>DLL hijacking is a technique where an attacker exploits the way applications load Dynamic Link Libraries (DLLs) in Windows. When an application is launched, it searches for necessary DLLs in specific directories. If an attacker places a malicious DLL with the same name as a legitimate one in a directory that’s searched first, the application may load the malicious DLL instead of the legitimate one, allowing the attacker to execute arbitrary code. Terms such as DLL Search Order Hijacking , DLL Load Order Hijacking , DLL Spoofing, DLL Injection and DLL Side-Loading are often mistakenly used to say the same. There are several Techniques that can be used to Hijack the DLL</p>



<h1 class="wp-block-heading">Known DLLs and Safe Search</h1>



<h2 class="wp-block-heading">Known DLLs</h2>



<p>Windows has a list of “Known DLL” names maintained in the registry. these are a set of system DLLs that Windows applications load by default. The Known DLLs list is maintained in the Windows Registry under the <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\KnownDLLs</code> key. This list includes essential DLLs that the system can trust and ensures they are loaded from a secure, predefined location (typically the system directory).</p>



<p><strong><em>How does it Work ?</em></strong></p>



<p>When an application attempts to load a DLL, Windows checks if the DLL name is in the Known DLLs list. If it is, Windows bypasses the usual search order and loads the DLL from the system directory, thus avoiding the risk of DLL hijacking.</p>



<h2 class="wp-block-heading">Safe Search</h2>



<p>Safe DLL search is a mechanism in Windows to improve the security of DLL loading processes. By default, Windows uses a specific search order to locate and load DLLs. Safe DLL search mode changes the search order to prioritize secure locations over potentially vulnerable directories.</p>



<h4 class="wp-block-heading"><strong><em>How Does it Work ?</em></strong></h4>



<p>These are the search Order that is being followed if <code>SafeDllSearchMode</code> is Enable / Disable:</p>



<figure class="wp-block-image size-full"><img fetchpriority="high" decoding="async" width="910" height="581" src="https://hadess-127191vg6c.live-website.com/wp-content/uploads/2024/07/image.png" alt="" class="wp-image-8745"></figure>



<p>Safe DLL search mode is enabled by default in modern versions of Windows (e.g., Windows 10, Windows Server 2016 and later). but can also be Enabled if its not it can be enable by creating on DWORD value name SafeDllSearchMode at HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager and set it to 1 to enable it .</p>



<h1 class="wp-block-heading">Export table cloning : Cloning Export Function</h1>



<h2 class="wp-block-heading">What is Export Table</h2>



<p>Every DLL has an export table which lists all the functions and data that other modules (executables or other DLLs) can call. Each function in the export table has a name and an address pointing to its location in memory.</p>



<h2 class="wp-block-heading">How Export Table Cloning Process Work</h2>



<h4 class="wp-block-heading">1. Identifying Target DLL</h4>



<p>The attacker identifies a DLL that is loaded by a target application and contains functions they wish to hijack.</p>



<h4 class="wp-block-heading">2. Creating the Malicious DLL</h4>



<p>They create a malicious DLL with the same filename as the legitimate one.</p>



<h4 class="wp-block-heading">3. Extracting Export Table</h4>



<p>Using tools (like <code>NetClone</code> from <code>Koppeling</code> project) or manual analysis, the attacker extracts the export table from the legitimate DLL. This includes copying the EAT, ENPT, and ordinal table entries to malicious dll</p>



<h4 class="wp-block-heading">4. Modifying Function Addresses</h4>



<p>The attacker replaces the addresses in the EAT with addresses pointing to their malicious code. This step is crucial as it redirects legitimate function calls to malicious code.</p>



<p>Attacker can implement proxying also to maintain the original functionality of the application while also running the malicious code.</p>



<h1 class="wp-block-heading">Implementation</h1>



<p>Prepare a hijack scenario with an incorrect DLL, which will give intentional error :</p>



<figure class="wp-block-image size-full"><img decoding="async" width="905" height="335" src="https://hadess-127191vg6c.live-website.com/wp-content/uploads/2024/07/image-1.png" alt="" class="wp-image-8746"></figure>



<p>Now use the NetClone.exe to clone the wkscli.dll functions to kernell32.dll and output them as wkscli.dll . which will act as as proxy to actual wkscli.dll.</p>



<figure class="wp-block-image size-full"><img decoding="async" width="908" height="168" src="https://hadess-127191vg6c.live-website.com/wp-content/uploads/2024/07/image-2.png" alt="" class="wp-image-8747"></figure>



<h2 class="wp-block-heading">Dynamic IAT patching: Modifying the Import Address Table</h2>



<p>Dynamic Import Address Table (IAT) patching is a technique used in DLL hijacking to intercept and modify function calls made by an application to a DLL. The goal is to redirect these calls to malicious functions while maintaining the application’s original functionality. But unlike Export Function Cloning , this technique work after the DLL is loaded in memory.</p>



<h2 class="wp-block-heading">How Dynamic IAT Patching works ?</h2>



<h4 class="wp-block-heading">1. <strong>Application Startup</strong></h4>



<ul class="wp-block-list">
<li>The vulnerable application starts and begins loading its required DLLs.</li>
</ul>



<h4 class="wp-block-heading">2. <strong>DLL Search Order and Loading</strong></h4>



<ul class="wp-block-list">
<li>The application finds and loads <code>malicious_example.dll</code> instead of the legitimate <code>example.dll</code> due to search order and naming conventions.</li>
</ul>



<h4 class="wp-block-heading">3. <strong>Load Original DLL within Malicious DLL</strong></h4>



<ul class="wp-block-list">
<li>Inside <code>malicious_example.dll</code>, use <code>LoadLibrary</code> to load the original <code>example.dll</code>.</li>



<li>Store the handle and use <code>GetProcAddress</code> to retrieve the addresses of the original functions.</li>
</ul>



<h4 class="wp-block-heading">4. <strong>Locate and Patch IAT</strong></h4>



<ul class="wp-block-list">
<li>Parse the PE headers of the application to locate the IAT.</li>



<li>Overwrite the entries in the IAT that point to the original <code>example.dll</code> functions with addresses pointing to functions in <code>malicious_example.dll</code>.</li>
</ul>



<pre class="wp-block-code"><code>Example: IAT Entry for FunctionA originally -&gt; Address: 0x12345678 (example.dll!FunctionA) 

Patched IAT Entry for FunctionA -&gt; Address: 0xabcdef12 (malicious_example.dll!FunctionA)</code></pre>



<h4 class="wp-block-heading">5. <strong>Function Call Redirection</strong></h4>



<ul class="wp-block-list">
<li>When the application calls <code>FunctionA</code>, it now jumps to <code>malicious_example.dll!FunctionA</code>.</li>
</ul>



<h4 class="wp-block-heading">6. <strong>Malicious Code Execution and Proxying</strong></h4>



<ul class="wp-block-list">
<li>Inside <code>malicious_example.dll!FunctionA</code>:
<ul class="wp-block-list">
<li>Execute any malicious actions (e.g., logging data, modifying parameters).</li>



<li>Call the original <code>FunctionA</code> in <code>example.dll</code> using the stored address obtained from <code>GetProcAddress</code>.</li>
</ul>
</li>
</ul>



<h4 class="wp-block-heading">7. <strong>Return Results to Application</strong></h4>



<ul class="wp-block-list">
<li>The results from the original <code>FunctionA</code> are returned to the application, maintaining expected behavior and functionality.</li>
</ul>



<h3 class="wp-block-heading">Advantages of Dynamic IAT Patching</h3>



<ul class="wp-block-list">
<li><strong>Stealth</strong>: By modifying the IAT at runtime, the technique is less likely to be detected by static analysis tools.</li>



<li><strong>Persistence</strong>: The malicious DLL remains active, continually intercepting and redirecting function calls.</li>



<li><strong>Functionality</strong>: Ensures the application continues to operate normally, reducing the chance of detection by users or security mechanisms.</li>
</ul>



<h3 class="wp-block-heading">Example Code Snippet (Simplified)</h3>



<p>Here is a simplified conceptual example in C++ to illustrate the process:</p>



<pre class="wp-block-code"><code>// Inside malicious_example.dll

// Load the original DLL
HMODULE hOriginal = LoadLibrary("example.dll");

// Get the address of the original FunctionA
typedef void (*OriginalFunctionA)();
OriginalFunctionA pOriginalFunctionA = (OriginalFunctionA)GetProcAddress(hOriginal, "FunctionA");

// Malicious implementation of FunctionA
extern "C" __declspec(dllexport) void FunctionA() {
    // Execute malicious actions
    // ...

    // Call the original FunctionA
    pOriginalFunctionA();
}

// Code to patch the IAT (simplified for illustration purposes)
void PatchIAT(HMODULE hModule, const char* originalDLLName, const char* functionName, void* newFunction) {
    // Locate and parse the IAT of hModule
    // Overwrite the IAT entry for functionName to point to newFunction
    // ...
}</code></pre>



<h1 class="wp-block-heading">Common Tool for Used in DLL</h1>



<h2 class="wp-block-heading"><strong>Siofra</strong></h2>



<p><strong>Siofra</strong> is a tool designed to identify and exploit DLL hijacking vulnerabilities :</p>



<p>It is able to simulate the Windows loader in order to give<br>visibility into all of the dependencies (and corresponding vulnerabilities) of<br>a PE on disk, or alternatively an image file in memory corresponding to an active<br>process.</p>



<p>More significantly, the tool has the ability to easily generate DLLs to<br>exploit these types of vulnerabilities via PE infection with dynamic shellcode creation.<br>These infected DLLs retain the code (DllMain, exported functions) as well as the<br>resources of a DLL to seamlessly preserve the functionality of the application loading<br>them, while at the same time allowing the researcher to specify an executable payload<br>to be either run as a separate process or loaded into the target as a module.</p>



<p>The tool contains automated methods of combining UAC auto-elevation criteria with<br>the aforementioned functionality in order to scan for UAC bypass vulnerabilities.</p>



<p>Here is one example for <strong>Windows Defender</strong> Binary on <strong>windows 10 x64 Home/Pro</strong> :</p>



<pre class="wp-block-code"><code>Siofra64.exe --mode file-scan -f "c:\Program Files\Windows Defender\MpCmdRun.exe" 
--enum-dependency --dll-hijack

======== c:\Program Files\Windows Defender\MpCmdRun.exe [64-bit PE] ========
MpCmdRun.exe
    msvcrt.dll [KnownDLL]
    KERNEL32.dll [KnownDLL]
    OLEAUT32.dll [KnownDLL]
        msvcp_win.dll [Base]
            api-ms-win-crt-string-l1-1-0.dll [API set]
                ucrtbase.dll [Base]
        combase.dll [KnownDLL]
            RPCRT4.dll [KnownDLL]
            bcryptPrimitives.dll [Base]
    ADVAPI32.dll [KnownDLL]
        api-ms-win-eventing-controller-l1-1-0.dll [API set]
            sechost.dll [KnownDLL]
    OLE32.dll [KnownDLL]
        GDI32.dll [KnownDLL]
            api-ms-win-gdi-internal-uap-l1-1-0.dll [API set]
                gdi32full.dll [Base]
                    USER32.dll [KnownDLL]
                        win32u.dll [Base]
    SspiCli.dll [!]
    mpclient.dll [!]
        CRYPT32.dll [Base]
            MSASN1.dll [Base]
    WINTRUST.dll [Base]

[!] Module SspiCli.dll vulnerable at c:\Program Files\Windows Defender\SspiCli.dll 
(real path: C:\WINDOWS\system32\SspiCli.dll)</code></pre>



<p>You can find more details at : <code>https://github.com/Cybereason/siofra</code></p>



<h2 class="wp-block-heading"><strong>DLLSpy</strong></h2>



<p>DLLSpy is again tool that detects DLL hijacking in running processes, services and in their binaries.</p>



<p>DllSpy Uses Engines for its functionality :</p>



<p><strong>Dynamic</strong> – First, scan the loaded modules by iterating the process loaded module list. Then checks if any of those modules could be hijacked by trying to write to their file location on disk and by checking if they could be overwritten. This is done after duplicating the access token of explorer.exe, which is a weak token. We do that in order to test whether we have write permission to the DLL location and the DLL itself as a regular user.</p>



<p>Static – Locate all strings that contain a DLL name or DLL Path in the binary files of running processes.</p>



<p>Recursive – Statically scan all the DLLs of the processes previously examined. The goal is to find more DLLs that are loaded by those DLLs and see if they are vulnerable to hijacking</p>



<pre class="wp-block-code"><code>C:\Users\john\Desktop\DLLSpy.exe
 ______   _        _        _______  _______
(  __  \ ( \      ( \      (  ____ \(  ____ )|\     /|
| (  \  )| (      | (      | (    \/| (    )|( \   / )
| |   ) || |      | |      | (_____ | (____)| \ (_) /
| |   | || |      | |      (_____  )|  _____)  \   /
| |   ) || |      | |            ) || (         ) (
| (__/  )| (____/\| (____/\/\____) || )         | |
(______/ (_______/(_______/\_______)|/          \_/

Usage: DLLSpy.exe
-d [mandatory] Find DLL hijacking in all running processes and services.
-s [optional] Search for DLL references in the binary files of current running processes and services.
-r n [optional] Recursion search for DLL references in found DLL files privous scan.
   n is the number is the level of the recursion
-o [optional] Output path for the results in csv format of
               By ommiting this option, a defulat result file would be created on the desktop of the current user.
               Named after the name of the computer .csv</code></pre>



<h2 class="wp-block-heading">Robbers</h2>



<p>Robber is open source tool for finding executables prone to DLL hijacking.</p>



<p><strong>Robber</strong>&nbsp;use simple mechanism to figure out DLLs that prone to hijacking :</p>



<ol class="wp-block-list">
<li>Scan import table of executable and find out DLLs that linked to executable</li>



<li>Search for DLL files placed inside executable that match with linked DLL (current working directory of the executable has highest priority)</li>



<li>If any DLL found, scan the export table of theme</li>



<li>Compare import table of executable with export table of DLL and if any matching was found, the executable and matched common functions flag as DLL hijack candidate.</li>
</ol>



<p>Here are its features :</p>



<ul class="wp-block-list">
<li>Ability to select scan type (signed/unsigned applications)</li>



<li>Determine executable signer</li>



<li>Determine wich referenced DLLs candidate for hijacking</li>



<li>Determine exported method names of candidate DLLs</li>



<li>Configure rules to determine which hijacks is best or good choice for use and show theme in different colors</li>



<li>Ability to check write permission of executable directory that is a good candidate for hijacking</li>
</ul>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="907" height="562" src="https://hadess-127191vg6c.live-website.com/wp-content/uploads/2024/07/image-3.png" alt="" class="wp-image-8748"></figure>



<h1 class="wp-block-heading">Importance of understanding this attack vector</h1>



<p>This attack method allows malicious actors to introduce harmful code into legitimate processes, granting them persistent and often elevated access to compromised systems. Defense against this attack vector requires a deep understanding of how it actually works. Furthermore this knowledge helps develop mitigation strategies against DLL hijacking.</p>



<h2 class="wp-block-heading">Explanation of module search order</h2>



<p>In order to find the appropriate DLL when importing it in the program, the system searches for it in the following order:</p>



<ol class="wp-block-list">
<li>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\KnownDLLs</li>



<li>Application Directory</li>



<li>C:\Windows\System32</li>



<li>C:\Windows\System</li>



<li>C:\Windows</li>



<li>Current Directory</li>



<li>PATH variables directory</li>
</ol>



<h2 class="wp-block-heading">Stack walking: Manipulating the call stack</h2>



<p>Stack walking is the process of traversing the call stack to examine the sequence of function calls.</p>



<p>Before talking about it in detail, let’s recap the call stack:</p>



<p>A stack data structure uses the LIFO mechanism and stores information about functions. When a function is executed, the local variables, parameters, and return addresses are pushed onto the stack creating a stack frame. When a function returns, its stack frame is popped off as well.</p>



<h3 class="wp-block-heading">Manipulating the Call Stack</h3>



<p>Manipulating the call stack can lead to various outcomes, including:</p>



<ul class="wp-block-list">
<li>Return-Oriented Programming (ROP):</li>



<li>Reusing existing code snippets (gadgets) to execute arbitrary code.</li>



<li>Involves carefully crafting a sequence of return addresses to control program flow.</li>



<li>Often used in exploitation scenarios.</li>



<li>Stack Buffer Overflows:</li>



<li>Overwriting data on the stack to modify return addresses or corrupt other data.</li>



<li>Can lead to arbitrary code execution.</li>



<li>Exception Handling Hijacking:</li>



<li>Interfering with the normal exception handling process.</li>



<li>Can be used to bypass security checks or execute malicious code.</li>



<li>Debugger and Profiler Functionality:</li>



<li>These tools manipulate the call stack to inspect program state and performance.</li>
</ul>



<h2 class="wp-block-heading">Run-time table reconstruction: Rebuilding tables during execution</h2>



<p>To reflectively load DLLs in memory, the program must reconstruct and rebuild the necessary tables like IAT and relocation.</p>



<p>The IAT is a crucial component of a DLL as it maps function calls within the DLL to their corresponding addresses in external libraries. When a DLL is loaded reflectively, it lacks a predefined base address. Therefore, the DLL must dynamically resolve these addresses. This involves:</p>



<ul class="wp-block-list">
<li>Locating the IAT: The DLL’s PE header contains information about the IAT’s location within the DLL’s data section.</li>



<li>Parsing Import Descriptors: The IAT consists of import descriptors, which contain information about imported libraries and function names. These descriptors are parsed to identify the required libraries and their exported functions.</li>



<li>Loading Dependent Libraries: The reflective DLL must explicitly load the necessary libraries using functions like LoadLibrary.</li>



<li>Resolving Import Addresses: For each imported function, the DLL must obtain the function’s address from the loaded library using functions like GetProcAddress. The resolved addresses are then written back to the IAT.</li>
</ul>



<p>Relocation Handling: Relocations are adjustments made to memory addresses within a DLL to accommodate different loading addresses. In a reflectively loaded DLL, the loading address is unknown beforehand, necessitating relocation processing. This involves:</p>



<ul class="wp-block-list">
<li>Locating the Relocation Table: The PE header points to the relocation table, which contains information about memory locations that require adjustments.</li>



<li>Applying Relocations: The DLL iterates through the relocation table, calculating the address offset based on the DLL’s actual loading address. The necessary adjustments are made to the target memory locations.</li>
</ul>



<p>By successfully rebuilding the IAT and handling relocations, the reflective DLL becomes self-sufficient, capable of functioning independently within the target process’s memory space. This level of control makes it a potent tool for both legitimate and malicious purposes. However, it also significantly increases the complexity of the DLL’s implementation and makes it a challenging target for analysis and detection.</p>



<h3 class="wp-block-heading">Adaptive DLL Hijacking Techniques</h3>



<p>DLL hijacking has been a cornerstone in the arsenal of many penetration testers and malicious actors for years. Its effectiveness lies in its ability to manipulate how applications load DLLs, often leading to code execution in privileged contexts. This post dives deep into advanced DLL hijacking techniques, addressing common pitfalls and providing solutions for stability and execution control. If you’ve struggled with DLL hijacking in the real world, this guide is for you.</p>



<h4 class="wp-block-heading"><strong>Refresher</strong></h4>



<p>This guide assumes familiarity with the basics of DLL hijacking, such as module search order, KnownDLLs, and “safe search.” If you need a refresher, check out these resources:</p>



<ul class="wp-block-list">
<li><a href="https://resources.infosecinstitute.com/dll-hijacking-attacks-revisited/">DLL Hijacking Attacks Revisited</a></li>



<li><a href="https://pentestlab.blog/2017/03/27/dll-hijacking/">DLL Hijacking</a></li>



<li><a href="https://astr0baby.wordpress.com/2018/09/08/understanding-how-dll-hijacking-works/">Understanding How DLL Hijacking Works</a></li>



<li><a href="https://posts.specterops.io/lateral-movement-scm-and-dll-hijacking-primer-d2f61e8ab992">Lateral Movement: SCM and DLL Hijacking Primer</a></li>
</ul>



<p>Tools for discovering and exploiting DLL hijacks:</p>



<ul class="wp-block-list">
<li><a href="https://github.com/cys3c/Siofra">Siofra</a></li>



<li><a href="https://github.com/cyberark/DLLSpy">DLLSpy</a></li>



<li><a href="https://github.com/MojtabaTajik/Robber">Robber</a></li>
</ul>



<h4 class="wp-block-heading"><strong>Basic DLL Hijack Example</strong></h4>



<p>Here’s a simple DLL hijack example:</p>



<pre class="wp-block-code"><code>void BeUnsafe() {
    HMODULE module = LoadLibrary("functions.dll");
    // ...
}

BOOL WINAPI DllMain(HINSTANCE instance, DWORD reason, LPVOID reserved)
{
    if (reason != DLL_PROCESS_ATTACH)
        return TRUE;
    // Execute malicious code
    system("start calc.exe");
    return TRUE;
}</code></pre>



<p>This basic example is easy to exploit but often fails in real-world scenarios due to process instability and the complexity of maintaining proper functionality.</p>



<h3 class="wp-block-heading"><strong>Advanced Techniques</strong></h3>



<h4 class="wp-block-heading"><strong>Execution Sinks</strong></h4>



<p>Two primary sinks from which DLL execution can originate:</p>



<ul class="wp-block-list">
<li><strong>Static Sink (IAT)</strong>: Occurs during process initialization or dynamic loading. The subsystem calculates dependencies and initializes them sequentially, verifying the export table.</li>



<li><strong>Dynamic Sink (LoadLibrary)</strong>: Active code requests a new module without specifying required functions, often followed by <code>GetProcAddress</code>.</li>
</ul>



<h4 class="wp-block-heading"><strong>Function Proxying</strong></h4>



<p>To maintain process stability, proxy functionality to the real DLL:</p>



<ul class="wp-block-list">
<li><strong>Export Forwarding</strong>: Redirect exports to another module.</li>
</ul>



<pre class="wp-block-code"><code>#pragma comment(linker, "/export:ReadThing=real.ReadThing")
#pragma comment(linker, "/export:WriteThing=real.WriteThing")</code></pre>



<ul class="wp-block-list">
<li><strong>Stack Patching</strong>: Walk backward from <code>DllMain</code> and replace the return value for <code>LoadLibrary</code> with a different module handle.</li>
</ul>



<pre class="wp-block-code"><code>HMODULE hRealDll = LoadLibrary("real.dll");
HMODULE hCurrentDll = NULL;
__asm {
    mov eax, [ebp+4]
    mov hCurrentDll, eax
}
if (hCurrentDll == hOurDll) {
    __asm {
        mov eax, hRealDll
        mov [ebp+4], eax
    }
}</code></pre>



<ul class="wp-block-list">
<li><strong>Run-Time Linking</strong>: Remap function pointers dynamically in <code>DllMain</code>.</li>
</ul>



<pre class="wp-block-code"><code>BOOL WINAPI DllMain(HINSTANCE instance, DWORD reason, LPVOID reserved)
{
    if (reason != DLL_PROCESS_ATTACH)
        return TRUE;

    HMODULE hRealDll = LoadLibrary("real.dll");
    if (!hRealDll)
        return FALSE;

    FARPROC realFunction = GetProcAddress(hRealDll, "FunctionName");
    if (!realFunction)
        return FALSE;

    // Code to patch function pointers dynamically
    return TRUE;
}</code></pre>



<ul class="wp-block-list">
<li><strong>Run-Time Generation</strong>: Rebuild the entire export address table at runtime.</li>
</ul>



<pre class="wp-block-code"><code>BOOL WINAPI DllMain(HINSTANCE instance, DWORD reason, LPVOID reserved)
{
    if (reason != DLL_PROCESS_ATTACH)
        return TRUE;

    HMODULE hRealDll = FindModule(instance);
    if (!hRealDll)
        return FALSE;

    ProxyExports(hRealDll);
    return TRUE;
}</code></pre>



<h4 class="wp-block-heading"><strong>Loader Lock</strong></h4>



<p>The loader lock can cause deadlocks or crashes if not handled correctly. Avoid calling functions like <code>LoadLibrary</code>, <code>CreateThread</code>, or synchronization functions within <code>DllMain</code>. Use threading to execute complex code outside <code>DllMain</code>.</p>



<pre class="wp-block-code"><code>BOOL WINAPI DllMain(HINSTANCE instance, DWORD reason, LPVOID reserved)
{
    if (reason != DLL_PROCESS_ATTACH)
        return TRUE;

    DWORD dwThreadId;
    HANDLE hThread = CreateThread(NULL, 0, ThreadFunc, NULL, 0, &amp;dwThreadId);
    if (hThread == NULL)
        return FALSE;

    CloseHandle(hThread);
    return TRUE;
}

DWORD WINAPI ThreadFunc(LPVOID lpParam)
{
    // Complex code here
    return 0;
}</code></pre>



<h4 class="wp-block-heading"><strong>Function Hooking for Stability</strong></h4>



<p>Implement hooks to maintain stability and ensure execution control after the loader finishes.</p>



<pre class="wp-block-code"><code>BOOL WINAPI DllMain(HINSTANCE instance, DWORD reason, LPVOID reserved)
{
    if (reason != DLL_PROCESS_ATTACH)
        return TRUE;

    // Implement hooks to maintain stability
    HookFunction();

    return TRUE;
}

void HookFunction()
{
    // Code to hook functions and ensure execution control
}</code></pre>



<h2 class="wp-block-heading">Security Research</h2>



<p><a href="https://www.linkedin.com/in/ACoAACMUPk8BjjkCwMk2KYJZ3WNyiTYgjXAzmgk">Amirhossein Gholizadeh</a>,&nbsp;<a href="https://www.linkedin.com/in/ACoAADZqFYEBRzUOWIJMQWUgqHHfNHf0tydlb4U">Surya Dev Singh</a></p>
		</div><!-- .entry-content -->

		<!-- .entry-footer -->
		
		</div>
	
<div id="comments" class="comments-area">

		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://hadess.io/adaptive-dll-hijacking/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://hadess.io/wp-comments-post.php" method="post" id="commentform" class="comment-form"><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> <span class="required-field-message">Required fields are marked <span class="required">*</span></span></p><p class="comment-form-comment"><label for="comment">Comment <span class="required">*</span></label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required=""></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" autocomplete="name" required=""></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" autocomplete="email" required=""></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" autocomplete="url"></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes"> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment"> 

</p><p style="display: none !important;" class="akismet-fields-container" data-prefix="ak_"><label>Δ<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label></p></form>	</div><!-- #respond -->
	
</div><!-- #comments -->
</article><!-- #post-8744 -->
            <div class="single-related-posts-section-wrap layout--list">
                <div class="single-related-posts-section">
                    <a class="related_post_close">
                        <i class="fas fa-times-circle"></i>
                    </a>
                    <h2 class="newsmatic-block-title"><span>Related News</span></h2><div class="single-related-posts-wrap">                                <article post-id="post-8892" class="post-8892 post type-post status-publish format-standard has-post-thumbnail hentry category-grc category-soc category-white-paper">
                                                                            <figure class="post-thumb-wrap ">
                                            			<div class="post-thumbnail">
				<img width="597" height="850" src="https://hadess.io/wp-content/uploads/2025/02/kpis-cyber.png" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="KPIs for Cyber Security" decoding="async">				<span class="thumb-caption">KPIs for Cyber Security</span>
			</div><!-- .post-thumbnail -->
		                                        </figure>
                                                                        <div class="post-element">
                                        <h2 class="post-title"><a href="https://hadess.io/kpis-for-cyber-security/">KPIs for Cyber Security</a></h2>
                                        <div class="post-meta">
                                            <span class="byline"> <span class="author vcard"><a class="url fn n author_name" href="https://hadess.io/author/hadess/">hadess</a></span></span><span class="post-date posted-on published"><a href="https://hadess.io/kpis-for-cyber-security/" rel="bookmark"><time class="entry-date published" datetime="2025-02-14T14:03:14-01:00">1 year ago</time><time class="updated" datetime="2025-04-29T19:33:49+00:00">10 months ago</time></a></span>                                            <a href="https://hadess.io/kpis-for-cyber-security/#comments"><span class="post-comment">0</span></a>
                                        </div>
                                    </div>
                                </article>
                                                            <article post-id="post-8868" class="post-8868 post type-post status-publish format-standard has-post-thumbnail hentry category-soc category-white-paper">
                                                                            <figure class="post-thumb-wrap ">
                                            			<div class="post-thumbnail">
				<img width="662" height="950" src="https://hadess.io/wp-content/uploads/2024/12/memory-forensic-cover.png" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="Memory Forensics: A Comprehensive Technical Guide" decoding="async">				<span class="thumb-caption">Memory Forensics: A Comprehensive Technical Guide</span>
			</div><!-- .post-thumbnail -->
		                                        </figure>
                                                                        <div class="post-element">
                                        <h2 class="post-title"><a href="https://hadess.io/memory-forensic-a-comprehensive-technical-guide/">Memory Forensic: A Comprehensive Technical Guide</a></h2>
                                        <div class="post-meta">
                                            <span class="byline"> <span class="author vcard"><a class="url fn n author_name" href="https://hadess.io/author/hadess/">hadess</a></span></span><span class="post-date posted-on published"><a href="https://hadess.io/memory-forensic-a-comprehensive-technical-guide/" rel="bookmark"><time class="entry-date published" datetime="2024-12-25T13:55:39-01:00">1 year ago</time><time class="updated" datetime="2025-04-29T19:34:13+00:00">10 months ago</time></a></span>                                            <a href="https://hadess.io/memory-forensic-a-comprehensive-technical-guide/#comments"><span class="post-comment">0</span></a>
                                        </div>
                                    </div>
                                </article>
                                                            <article post-id="post-8851" class="post-8851 post type-post status-publish format-standard has-post-thumbnail hentry category-offensive category-white-paper">
                                                                            <figure class="post-thumb-wrap ">
                                            			<div class="post-thumbnail">
				<img width="587" height="820" src="https://hadess.io/wp-content/uploads/2024/10/win-down-cover.jpg" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="Windows Downdate: Downgrade Attacks Using Windows Updates and Beyond" decoding="async">				<span class="thumb-caption">Windows Downdate: Downgrade Attacks Using Windows Updates and Beyond</span>
			</div><!-- .post-thumbnail -->
		                                        </figure>
                                                                        <div class="post-element">
                                        <h2 class="post-title"><a href="https://hadess.io/windows-downdate-downgrade-attacks-using-windows-updates-and-beyond/">Windows Downdate: Downgrade Attacks Using Windows Updates and Beyond</a></h2>
                                        <div class="post-meta">
                                            <span class="byline"> <span class="author vcard"><a class="url fn n author_name" href="https://hadess.io/author/hadess/">hadess</a></span></span><span class="post-date posted-on published"><a href="https://hadess.io/windows-downdate-downgrade-attacks-using-windows-updates-and-beyond/" rel="bookmark"><time class="entry-date published" datetime="2024-10-31T12:23:18-01:00">1 year ago</time><time class="updated" datetime="2025-04-29T19:34:24+00:00">10 months ago</time></a></span>                                            <a href="https://hadess.io/windows-downdate-downgrade-attacks-using-windows-updates-and-beyond/#comments"><span class="post-comment">0</span></a>
                                        </div>
                                    </div>
                                </article>
                                                            <article post-id="post-8842" class="post-8842 post type-post status-publish format-standard has-post-thumbnail hentry category-offensive category-white-paper">
                                                                            <figure class="post-thumb-wrap ">
                                            			<div class="post-thumbnail">
				<img width="487" height="680" src="https://hadess.io/wp-content/uploads/2024/10/post-exploit.jpg" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="Art of Post-Exploitation" decoding="async">				<span class="thumb-caption">Art of Post-Exploitation</span>
			</div><!-- .post-thumbnail -->
		                                        </figure>
                                                                        <div class="post-element">
                                        <h2 class="post-title"><a href="https://hadess.io/art-of-post-exploitation/">Art of Post-Exploitation</a></h2>
                                        <div class="post-meta">
                                            <span class="byline"> <span class="author vcard"><a class="url fn n author_name" href="https://hadess.io/author/hadess/">hadess</a></span></span><span class="post-date posted-on published"><a href="https://hadess.io/art-of-post-exploitation/" rel="bookmark"><time class="entry-date published" datetime="2024-10-18T14:25:26+00:00">1 year ago</time><time class="updated" datetime="2025-04-29T19:34:32+00:00">10 months ago</time></a></span>                                            <a href="https://hadess.io/art-of-post-exploitation/#comments"><span class="post-comment">0</span></a>
                                        </div>
                                    </div>
                                </article>
                            </div>                </div>
            </div>
    						</div>
					</div>
					<div class="secondary-sidebar">
						
<!-- #secondary -->					</div>
				</div>
			</div>
		</main><!-- #main -->
	</div><!-- #theme-content -->
	<!-- #colophon -->
	</div><!-- #page -->


		
		<div id="wa" class="wa__widget_container"><div class="wa__btn_popup" style="left: unset; right: 10px; bottom: 20px;"><div class="wa__btn_popup_txt" style="display: none; left: unset; right: 100%; margin-right: 7px; margin-left: 0px; width: 70px;"><span><strong>Support</strong></span></div><div class="wa__btn_popup_icon" style="background: rgb(179, 193, 48);"></div></div><div class="wa__popup_chat_box" style="left: unset; right: 10px; bottom: 92px;"><div class="wa__popup_heading" style="background: rgb(179, 193, 48);"><div class="wa__popup_title" style="color: rgb(0, 0, 0); font-size: 18px;">Start a Conversation</div><div class="wa__popup_intro" style="color: rgb(0, 0, 0); opacity: 0.8; font-size: 12px;"><strong>We Respectfully Answer Your Questions As Soon As Possible!</strong></div></div><div class="wa__popup_content wa__popup_content_left"><div class="wa__popup_notice" style="font-size: 11px;"></div><div class="wa__popup_content_list"><div class="wa__popup_content_item"><a target="_blank" href="https://api.whatsapp.com/send?phone=989362181112" rel="nofollow noopener noreferrer" class="wa__stt wa__stt_online"><div class="wa__popup_avatar nta-default-avt"><svg width="48px" height="48px" class="nta-whatsapp-default-avatar" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512;" xml:space="preserve">
            <path style="fill:#EDEDED;" d="M0,512l35.31-128C12.359,344.276,0,300.138,0,254.234C0,114.759,114.759,0,255.117,0
            S512,114.759,512,254.234S395.476,512,255.117,512c-44.138,0-86.51-14.124-124.469-35.31L0,512z"></path>
            <path style="fill:#55CD6C;" d="M137.71,430.786l7.945,4.414c32.662,20.303,70.621,32.662,110.345,32.662
            c115.641,0,211.862-96.221,211.862-213.628S371.641,44.138,255.117,44.138S44.138,137.71,44.138,254.234
            c0,40.607,11.476,80.331,32.662,113.876l5.297,7.945l-20.303,74.152L137.71,430.786z"></path>
            <path style="fill:#FEFEFE;" d="M187.145,135.945l-16.772-0.883c-5.297,0-10.593,1.766-14.124,5.297
            c-7.945,7.062-21.186,20.303-24.717,37.959c-6.179,26.483,3.531,58.262,26.483,90.041s67.09,82.979,144.772,105.048
            c24.717,7.062,44.138,2.648,60.028-7.062c12.359-7.945,20.303-20.303,22.952-33.545l2.648-12.359
            c0.883-3.531-0.883-7.945-4.414-9.71l-55.614-25.6c-3.531-1.766-7.945-0.883-10.593,2.648l-22.069,28.248
            c-1.766,1.766-4.414,2.648-7.062,1.766c-15.007-5.297-65.324-26.483-92.69-79.448c-0.883-2.648-0.883-5.297,0.883-7.062
            l21.186-23.834c1.766-2.648,2.648-6.179,1.766-8.828l-25.6-57.379C193.324,138.593,190.676,135.945,187.145,135.945"></path>
        </svg></div><div class="wa__popup_txt"><div class="wa__member_name" style="font-size:14px"></div><div class="wa__member_duty" style="font-size:11px">Support Team</div></div></a></div></div></div></div></div>			
		
					
			
































<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="position:absolute;left: -100%;" height="0" width="0"><symbol id="icon-anwp-pg-calendar" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M13 2h-1v1.5c0 .28-.22.5-.5.5h-2c-.28 0-.5-.22-.5-.5V2H6v1.5c0 .28-.22.5-.5.5h-2c-.28 0-.5-.22-.5-.5V2H2c-.55 0-1 .45-1 1v11c0 .55.45 1 1 1h11c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zm0 12H2V5h11v9zM5 3H4V1h1v2zm6 0h-1V1h1v2zM6 7H5V6h1v1zm2 0H7V6h1v1zm2 0H9V6h1v1zm2 0h-1V6h1v1zM4 9H3V8h1v1zm2 0H5V8h1v1zm2 0H7V8h1v1zm2 0H9V8h1v1zm2 0h-1V8h1v1zm-8 2H3v-1h1v1zm2 0H5v-1h1v1zm2 0H7v-1h1v1zm2 0H9v-1h1v1zm2 0h-1v-1h1v1zm-8 2H3v-1h1v1zm2 0H5v-1h1v1zm2 0H7v-1h1v1zm2 0H9v-1h1v1z"></path></symbol><symbol id="icon-anwp-pg-chevron-left" viewBox="0 0 24 24"><path d="M15 18l-6-6 6-6"></path></symbol><symbol id="icon-anwp-pg-chevron-right" viewBox="0 0 24 24"><path d="M9 18l6-6-6-6"></path></symbol><symbol id="icon-anwp-pg-clock" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M8 8h3v2H7c-.55 0-1-.45-1-1V4h2v4zM7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 011.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7z"></path></symbol><symbol id="icon-anwp-pg-comment-discussion" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M15 1H6c-.55 0-1 .45-1 1v2H1c-.55 0-1 .45-1 1v6c0 .55.45 1 1 1h1v3l3-3h4c.55 0 1-.45 1-1V9h1l3 3V9h1c.55 0 1-.45 1-1V2c0-.55-.45-1-1-1zM9 11H4.5L3 12.5V11H1V5h4v3c0 .55.45 1 1 1h3v2zm6-3h-2v1.5L11.5 8H6V2h9v6z"></path></symbol><symbol id="icon-anwp-pg-device-camera" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M15 3H7c0-.55-.45-1-1-1H2c-.55 0-1 .45-1 1-.55 0-1 .45-1 1v9c0 .55.45 1 1 1h14c.55 0 1-.45 1-1V4c0-.55-.45-1-1-1zM6 5H2V4h4v1zm4.5 7C8.56 12 7 10.44 7 8.5S8.56 5 10.5 5 14 6.56 14 8.5 12.44 12 10.5 12zM13 8.5c0 1.38-1.13 2.5-2.5 2.5S8 9.87 8 8.5 9.13 6 10.5 6 13 7.13 13 8.5z"></path></symbol><symbol id="icon-anwp-pg-eye" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6C13 14 16 8 16 8s-3-6-7.94-6zM8 12c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4zm2-4c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z"></path></symbol><symbol id="icon-anwp-pg-pencil" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M17.263 2.177a1.75 1.75 0 012.474 0l2.586 2.586a1.75 1.75 0 010 2.474L19.53 10.03l-.012.013L8.69 20.378a1.75 1.75 0 01-.699.409l-5.523 1.68a.75.75 0 01-.935-.935l1.673-5.5a1.75 1.75 0 01.466-.756L14.476 4.963l2.787-2.786zm-2.275 4.371l-10.28 9.813a.25.25 0 00-.067.108l-1.264 4.154 4.177-1.271a.25.25 0 00.1-.059l10.273-9.806-2.94-2.939zM19 8.44l2.263-2.262a.25.25 0 000-.354l-2.586-2.586a.25.25 0 00-.354 0L16.061 5.5 19 8.44z"></path></symbol><symbol id="icon-anwp-pg-person" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M12 2.5a5.5 5.5 0 00-3.096 10.047 9.005 9.005 0 00-5.9 8.18.75.75 0 001.5.045 7.5 7.5 0 0114.993 0 .75.75 0 101.499-.044 9.005 9.005 0 00-5.9-8.181A5.5 5.5 0 0012 2.5zM8 8a4 4 0 118 0 4 4 0 01-8 0z"></path></symbol><symbol id="icon-anwp-pg-play" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M14 8A7 7 0 110 8a7 7 0 0114 0zm-8.223 3.482l4.599-3.066a.5.5 0 000-.832L5.777 4.518A.5.5 0 005 4.934v6.132a.5.5 0 00.777.416z"></path></symbol><symbol id="icon-anwp-pg-tag" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7.685 1.72a2.49 2.49 0 00-1.76-.726H3.48A2.5 2.5 0 00.994 3.48v2.456c0 .656.269 1.292.726 1.76l6.024 6.024a.99.99 0 001.402 0l4.563-4.563a.99.99 0 000-1.402L7.685 1.72zM2.366 7.048a1.54 1.54 0 01-.467-1.123V3.48c0-.874.716-1.58 1.58-1.58h2.456c.418 0 .825.159 1.123.467l6.104 6.094-4.702 4.702-6.094-6.114zm.626-4.066h1.989v1.989H2.982V2.982h.01z"></path></symbol><symbol id="icon-anwp-pg-trash" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M16 1.75V3h5.25a.75.75 0 010 1.5H2.75a.75.75 0 010-1.5H8V1.75C8 .784 8.784 0 9.75 0h4.5C15.216 0 16 .784 16 1.75zm-6.5 0a.25.25 0 01.25-.25h4.5a.25.25 0 01.25.25V3h-5V1.75z"></path><path d="M4.997 6.178a.75.75 0 10-1.493.144L4.916 20.92a1.75 1.75 0 001.742 1.58h10.684a1.75 1.75 0 001.742-1.581l1.413-14.597a.75.75 0 00-1.494-.144l-1.412 14.596a.25.25 0 01-.249.226H6.658a.25.25 0 01-.249-.226L4.997 6.178z"></path><path d="M9.206 7.501a.75.75 0 01.793.705l.5 8.5A.75.75 0 119 16.794l-.5-8.5a.75.75 0 01.705-.793zm6.293.793A.75.75 0 1014 8.206l-.5 8.5a.75.75 0 001.498.088l.5-8.5z"></path></symbol></svg>
</body></html>