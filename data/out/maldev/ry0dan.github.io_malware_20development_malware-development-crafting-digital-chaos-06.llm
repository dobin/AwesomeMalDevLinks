Title:
Malware Development: Crafting Digital Chaos (06) — Process Enumeration & Exfiltration via Winsock

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post demonstrates a basic data exfiltration technique by enumerating running processes on a Windows host and sending process names/PIDs to a C2 listener over a TCP socket.  
- It uses PSAPI functions (`EnumProcesses`, `OpenProcess`, `EnumProcessModules`, `GetModuleBaseName`) to collect process metadata, then transmits results using Winsock (`WSAStartup`, `getaddrinfo`, `socket`, `connect`, `send`).  
- The article highlights practical implementation details like required access rights (`PROCESS_QUERY_INFORMATION | PROCESS_VM_READ`) and handling WOW64 limitations where `EnumProcessModules` can fail with `ERROR_PARTIAL_COPY` when a 32-bit enumerator targets 64-bit processes.  
- It includes end-to-end sample code: initialize networking, connect to a hardcoded server/port, send process count and per-process entries, then cleanly `shutdown` and close the socket.  
- Useful for malware developers and red teamers building simple host reconnaissance and exfil channels; also relevant to blue teamers for understanding common API-level telemetry and network behaviors to detect.

Technical Focus:
- Windows process enumeration via PSAPI (`EnumProcesses`, `EnumProcessModules`)
- Process handle access rights and `OpenProcess` usage
- Module/name resolution with `GetModuleBaseName`
- Winsock TCP client setup (`WSAStartup`, `getaddrinfo`, `connect`, `send`)
- WOW64 / 32-bit vs 64-bit enumeration edge cases (`ERROR_PARTIAL_COPY`)

Use Cases:
- Implement host reconnaissance (process inventory) in an implant
- Prototype a simple TCP-based exfiltration channel to a C2 listener
- Validate EDR/SIEM detections around process enumeration + outbound connections
- Build lab exercises for Windows API telemetry and network monitoring

Keywords:
Windows malware development, process enumeration, PSAPI, EnumProcesses, OpenProcess, EnumProcessModules, GetModuleBaseName, PROCESS_QUERY_INFORMATION, PROCESS_VM_READ, WOW64, ERROR_PARTIAL_COPY, Winsock, WSAStartup, getaddrinfo, socket, connect, send, TCP C2, data exfiltration, host reconnaissance