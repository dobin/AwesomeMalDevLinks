Title:
Cobalt Strike, a Defender’s Guide (Part 1)

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post breaks down common Cobalt Strike tradecraft observed in real intrusions and maps it to practical detection opportunities.  
- It covers how Cobalt Strike is typically deployed as a second-stage framework after initial access via commodity malware (e.g., IcedID, Qbot, TrickBot) and why its extensibility complicates detection.  
- The author details infrastructure patterns (redirectors, Malleable C2 profiles) and shows how beacon configs and TLS/cert artifacts (JA3/JA3S, JARM, fake “jQuery” cert fields) can be used for hunting.  
- On-host behaviors are emphasized: rundll32-based execution of post-ex DLLs, named-pipe IPC defaults, common beacon delivery methods (fileless PowerShell stagers, download-to-disk, in-memory execution by droppers), and process injection telemetry.  
- It also summarizes frequent post-ex actions (discovery via LOLBins, privilege escalation via getsystem/service creation, credential theft from LSASS, lateral movement via psexec/wmi/winrm, pass-the-hash) with relevant Windows/Sysmon event IDs.  
- Useful for Blue Teams, detection engineers, and threat hunters building endpoint/network detections; also valuable for red teams to understand defensive visibility and common detection choke points.

Technical Focus:
- Malleable C2 profiles and C2 infrastructure (redirectors, HTTP/HTTPS/DNS beaconing)
- Beacon fingerprinting (JA3/JA3S, JARM, TLS certificate artifacts)
- Windows telemetry for post-execution (Sysmon EIDs, Security/System event IDs)
- Named pipe detection and default Cobalt Strike pipe patterns
- Process injection / remote thread creation / process hollowing detection signals
- Lateral movement via remote service creation (psexec), WMI/WinRM, pass-the-hash indicators

Use Cases:
- Build hunting queries for Cobalt Strike beacons using Sysmon + Windows Security logs
- Detect default CS post-ex modules via named pipe creation (Sysmon 17/18)
- Identify suspicious rundll32 execution patterns tied to CS post-ex DLLs
- Network-based detection using TLS fingerprints and malleable-profile HTTP patterns
- Monitor for service creation/deletion and remote exec artifacts (4697/7045/4688/5140)
- Create Sigma/Suricata rule coverage for common CS behaviors and C2 profiles

Keywords:
Cobalt Strike, Beacon, Malleable C2, redirectors, JA3, JA3S, JARM, TLS certificate, Sysmon, Windows Event ID 4688, Sysmon EID 8, Sysmon EID 10, named pipes, rundll32.exe, process injection, CreateRemoteThread, getsystem, Mimikatz, LSASS, DCSync, pass-the-hash, psexec, WMI, WinRM, SOCKS proxy, AdFind, BloodHound, PowerShell encoded command, Sigma rules, Suricata ET rules