Title:
nimvoke — Indirect syscalls + DInvoke made simple (Nim)

Type:
GitHub Tool

Short Summary (4–8 sentences max):
- nimvoke is a Nim library intended to be imported into offensive tooling to simplify DInvoke-style dynamic API resolution and indirect system calls on Windows.  
- It abstracts delegate declarations and syscall invocation via Nim macros, aiming to reduce static imports and improve operational security.  
- The project hashes function/library names at compile time, parses ntdll’s Export Address Table (EAT) at runtime to enumerate syscalls, and derives System Service Numbers (SSNs) by sorting syscall stub addresses to remain resilient to userland hooks.  
- Syscalls are executed through a single “arg-shifting” trampoline (inspired by FreshyCalls) that jumps to the correct `syscall` instruction inside `ntdll.dll`, with the trampoline allocated on a private heap.  
- It’s primarily useful for red teamers, pentesters, and malware developers building Nim-based loaders/injectors who want cleaner syscall/DInvoke plumbing without re-implementing internals.  
- The repo also documents important limitations (e.g., Nim runtime core imports remain) and notes future work like x86 support and stack-frame spoofing.

Technical Focus:
- DInvoke-style dynamic API resolution (LoadLibraryA/GetProcAddress via Nim `dynlib`)
- Indirect syscalls via ntdll EAT parsing and syscall stub discovery
- SSN derivation by sorting syscall addresses (hook-resilient enumeration)
- Compile-time hashing of API/module names
- Syscall trampoline (“arg shifting”) and private heap allocation
- Nim macros for generating delegates and syscall wrappers

Use Cases:
- Building Nim-based shellcode loaders/injectors using `NtAllocateVirtualMemory`/related syscalls
- Reducing static Win32 imports in custom tooling via runtime API resolution
- Bypassing/mitigating userland API hooks by jumping to clean `syscall` instructions in ntdll
- Rapid prototyping of syscall-based tradecraft in Nim without hand-rolling stubs
- Embedding op-sec friendly syscall initialization into larger implants

Keywords:
Nim, Windows, DInvoke, indirect syscalls, ntdll.dll, EAT parsing, Export Address Table, SSN, System Service Number, syscall trampoline, FreshyCalls, GetProcAddress, LoadLibraryA, dynlib, ZwAllocateVirtualMemory, NtAllocateVirtualMemory, API hashing, userland hooks, EDR evasion, winim