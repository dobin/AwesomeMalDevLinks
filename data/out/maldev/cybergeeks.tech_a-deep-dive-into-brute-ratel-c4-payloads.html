# https://cybergeeks.tech/a-deep-dive-into-brute-ratel-c4-payloads/

<!DOCTYPE html><html lang="en-US">

<body data-rsssl="1" itemtype="https://schema.org/Blog" itemscope="itemscope" class="wp-singular post-template-default single single-post postid-4664 single-format-standard wp-embed-responsive wp-theme-astra ast-desktop ast-plain-container ast-right-sidebar astra-4.12.3 ast-header-custom-item-inside group-blog ast-blog-single-style-1 ast-single-post ast-mobile-inherit-site-logo ast-inherit-site-logo-transparent ast-normal-title-enabled wpdiscuz_7.6.46" style="">

<a class="skip-link screen-reader-text" href="https://cybergeeks.tech/a-deep-dive-into-brute-ratel-c4-payloads/#content">
		Skip to content</a>

<div class="hfeed site" id="page">
			<!-- #masthead -->
			<div id="content" class="site-content">
		<div class="ast-container">
		

	<div id="primary" class="content-area primary">

		
					<main id="main" class="site-main">
				

<article class="post-4664 post type-post status-publish format-standard hentry category-malwareanalysis ast-article-single" id="post-4664" itemtype="https://schema.org/CreativeWork" itemscope="itemscope">

	
	
<div class="ast-post-format- ast-no-thumb single-layout-1">

	
	
		<!-- .entry-header -->

	
	
	<div class="entry-content clear" itemprop="text">

		
		
<p style="font-size:25px">Summary</p>



<p><a href="https://bruteratel.com/">Brute Ratel C4</a> is a Red Team &amp; Adversary Simulation software that can be considered an alternative to Cobalt Strike. In this blog post, we’re presenting a technical analysis of a Brute Ratel badger/agent that doesn’t implement all the recent features of the framework. There aren’t a lot of Brute Ratel samples available in the wild. The malware implements the API hashing technique and comes up with a configuration that contains the C2 server, the user-agent used during the network communications, a password used for authentication with the C2 server, and a key used for encrypting data transmitted to the C2 server. The badger takes control of the infected machine by executing 63 different commands issued by the C2 server. The first 20 commands will be described in this blog post, while the rest of them will be detailed in an upcoming blog post.</p>



<p style="font-size:25px">Technical analysis</p>



<p>SHA256: d71dc7ba8523947e08c6eec43a726fe75aed248dfd3a7c4f6537224e9ed05f6f</p>



<p>This is a 64-bit executable. The malware pushes the code to be executed on the stack in order to evade Antivirus and EDR software:</p>



<figure class="wp-block-image aligncenter size-full"><img fetchpriority="high" decoding="async" width="485" height="313" src="https://cybergeeks.tech/wp-content/uploads/2023/08/1.jpg" alt="" class="wp-image-4667"><figcaption class="wp-element-caption">Figure 1</figcaption></figure>



<p>It implements the API hashing technique, which uses the “ROR EDI,0xD” instruction to compute 4-byte hashes that are compared with pre-computed ones (Figure 2).</p>



<figure class="wp-block-image aligncenter size-full"><img decoding="async" width="710" height="595" src="https://cybergeeks.tech/wp-content/uploads/2023/08/2.jpg" alt="" class="wp-image-4670"><figcaption class="wp-element-caption">Figure 2</figcaption></figure>



<p>The VirtualAllocEx API is used to allocate a new memory area that will store a DLL file (0x3000 = <strong>MEM_COMMIT</strong> | <strong>MEM_RESERVE</strong>, 0x40 = <strong>PAGE_EXECUTE_READWRITE</strong>):</p>



<figure class="wp-block-image aligncenter size-large"><img decoding="async" width="1024" height="107" src="https://cybergeeks.tech/wp-content/uploads/2023/08/3-1024x107.jpg" alt="" class="wp-image-4671"><figcaption class="wp-element-caption">Figure 3</figcaption></figure>



<p>The Brute Ratel C4 configuration is stored in clear text however, in recent versions, the config is <a href="https://unit42.paloaltonetworks.com/brute-ratel-c4-tool/">encrypted and Base64-encoded</a>. It contains the C2 IP address and port number, the user-agent used during the network communications, a password used to authenticate with the C2 server, a key used to encrypt data transmitted to the C2 server, and the URI:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="220" src="https://cybergeeks.tech/wp-content/uploads/2023/08/4-1024x220.jpg" alt="" class="wp-image-4672"><figcaption class="wp-element-caption">Figure 4</figcaption></figure>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="204" src="https://cybergeeks.tech/wp-content/uploads/2023/08/5-1024x204.jpg" alt="" class="wp-image-4673"><figcaption class="wp-element-caption">Figure 5</figcaption></figure>



<p>A thread that executes the entry point of the new DLL is created via a function call to CreateRemoteThread:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="128" src="https://cybergeeks.tech/wp-content/uploads/2023/08/6-1024x128.jpg" alt="" class="wp-image-4674"><figcaption class="wp-element-caption">Figure 6</figcaption></figure>



<p>The process extracts a pointer to the PEB from gs:[0x60] and another one to the <a href="https://learn.microsoft.com/en-us/windows/win32/api/winternl/ns-winternl-peb_ldr_data">PEB_LDR_DATA </a>structure (+0x18), which contains information about the loaded DLLs. The InMemoryOrderModuleList doubly-linked list contains the loaded DLLs for the current process:</p>



<figure class="wp-block-image aligncenter size-full"><img loading="lazy" decoding="async" width="745" height="253" src="https://cybergeeks.tech/wp-content/uploads/2023/08/7.jpg" alt="" class="wp-image-4675"><figcaption class="wp-element-caption">Figure 7</figcaption></figure>



<p>The malicious binary allocates new memory for another DLL that implements the main functionality using VirtualAlloc:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="89" src="https://cybergeeks.tech/wp-content/uploads/2023/08/8-1024x89.jpg" alt="" class="wp-image-4676"><figcaption class="wp-element-caption">Figure 8</figcaption></figure>



<p>LoadLibraryA is utilized to load multiple DLLs into the address space of the current process:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="72" src="https://cybergeeks.tech/wp-content/uploads/2023/08/9-1024x72.jpg" alt="" class="wp-image-4677"><figcaption class="wp-element-caption">Figure 9</figcaption></figure>



<p>The malware retrieves the address of relevant functions by calling the GetProcAddress method:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="65" src="https://cybergeeks.tech/wp-content/uploads/2023/08/10-1024x65.jpg" alt="" class="wp-image-4678"><figcaption class="wp-element-caption">Figure 10</figcaption></figure>



<p>The binary flushes the instruction cache for the current process using the NtFlushInstructionCache function (see Figure 11).</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="75" src="https://cybergeeks.tech/wp-content/uploads/2023/08/11-1024x75.jpg" alt="" class="wp-image-4679"><figcaption class="wp-element-caption">Figure 11</figcaption></figure>



<p>Finally, the malware passes the execution flow to the newly constructed DLL:</p>



<figure class="wp-block-image aligncenter size-full"><img loading="lazy" decoding="async" width="845" height="336" src="https://cybergeeks.tech/wp-content/uploads/2023/08/12.jpg" alt="" class="wp-image-4680"><figcaption class="wp-element-caption">Figure 12</figcaption></figure>



<p>As we can see below, one of the export functions of the DLL is called “badger_http_1”, which reveals a Brute Ratel agent/badger.</p>



<figure class="wp-block-image aligncenter size-full"><img loading="lazy" decoding="async" width="608" height="100" src="https://cybergeeks.tech/wp-content/uploads/2023/08/13.jpg" alt="" class="wp-image-4681"><figcaption class="wp-element-caption">Figure 13</figcaption></figure>



<figure class="wp-block-image aligncenter size-full"><img loading="lazy" decoding="async" width="466" height="419" src="https://cybergeeks.tech/wp-content/uploads/2023/08/14.jpg" alt="" class="wp-image-4682"><figcaption class="wp-element-caption">Figure 14</figcaption></figure>



<p>The FreeConsole&nbsp;method is used to detach the process from its console:</p>



<figure class="wp-block-image aligncenter size-full"><img loading="lazy" decoding="async" width="849" height="48" src="https://cybergeeks.tech/wp-content/uploads/2023/08/15.jpg" alt="" class="wp-image-4685"><figcaption class="wp-element-caption">Figure 15</figcaption></figure>



<p>The DLL repeats the process of finding functions address, as highlighted in Figure 16.</p>



<figure class="wp-block-image aligncenter size-full"><img loading="lazy" decoding="async" width="452" height="598" src="https://cybergeeks.tech/wp-content/uploads/2023/08/16.jpg" alt="" class="wp-image-4686"><figcaption class="wp-element-caption">Figure 16</figcaption></figure>



<p>The process extracts the system time and passes the result to the srand function:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="44" src="https://cybergeeks.tech/wp-content/uploads/2023/08/17-1024x44.jpg" alt="" class="wp-image-4687"><figcaption class="wp-element-caption">Figure 17</figcaption></figure>



<p>The atoi method is utilized to convert the port number to integer:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="45" src="https://cybergeeks.tech/wp-content/uploads/2023/08/18-1024x45.jpg" alt="" class="wp-image-4688"><figcaption class="wp-element-caption">Figure 18</figcaption></figure>



<p>The malicious process creates an unnamed mutex object by calling the CreateMutexA API, as displayed in Figure 19.</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="179" src="https://cybergeeks.tech/wp-content/uploads/2023/08/19-1024x179.jpg" alt="" class="wp-image-4689"><figcaption class="wp-element-caption">Figure 19</figcaption></figure>



<p>GetUserNameW is used to obtain the username associated with the current thread:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="66" src="https://cybergeeks.tech/wp-content/uploads/2023/08/20-1024x66.jpg" alt="" class="wp-image-4690"><figcaption class="wp-element-caption">Figure 20</figcaption></figure>



<p>GetComputerNameExW is used to obtain the NetBIOS name associated with the local machine:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="74" src="https://cybergeeks.tech/wp-content/uploads/2023/08/21-1024x74.jpg" alt="" class="wp-image-4692"><figcaption class="wp-element-caption">Figure 21</figcaption></figure>



<p>The badger retrieves a pseudo handle for the current process using GetCurrentProcess:</p>



<figure class="wp-block-image aligncenter size-full"><img loading="lazy" decoding="async" width="848" height="46" src="https://cybergeeks.tech/wp-content/uploads/2023/08/22.jpg" alt="" class="wp-image-4693"><figcaption class="wp-element-caption">Figure 22</figcaption></figure>



<p>The OpenProcessToken API is utilized to open the access token associated with the process (0x8 = <strong>TOKEN_QUERY</strong>):</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="73" src="https://cybergeeks.tech/wp-content/uploads/2023/08/23-1024x73.jpg" alt="" class="wp-image-4695"><figcaption class="wp-element-caption">Figure 23</figcaption></figure>



<p>The malware verifies if the token is elevated using the GetTokenInformation method (0x14 = <strong>TokenElevation</strong>):</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="109" src="https://cybergeeks.tech/wp-content/uploads/2023/08/24-1024x109.jpg" alt="" class="wp-image-4696"><figcaption class="wp-element-caption">Figure 24</figcaption></figure>



<p>It obtains the current process ID via a function call to GetCurrentProcessId:</p>



<figure class="wp-block-image aligncenter size-full"><img loading="lazy" decoding="async" width="850" height="47" src="https://cybergeeks.tech/wp-content/uploads/2023/08/25.jpg" alt="" class="wp-image-4697"><figcaption class="wp-element-caption">Figure 25</figcaption></figure>



<p>GetModuleFileNameW is utilized to extract the path of the executable file of the process:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="83" src="https://cybergeeks.tech/wp-content/uploads/2023/08/26-1024x83.jpg" alt="" class="wp-image-4698"><figcaption class="wp-element-caption">Figure 26</figcaption></figure>



<p>The above path is Base64-encoded using the CryptBinaryToStringW API (0x40000001 = <strong>CRYPT_STRING_NOCRLF</strong> | <strong>CRYPT_STRING_BASE64</strong>):</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="101" src="https://cybergeeks.tech/wp-content/uploads/2023/08/27-1024x101.jpg" alt="" class="wp-image-4699"><figcaption class="wp-element-caption">Figure 27</figcaption></figure>



<p>The process retrieves version information about the current operating system using RtlGetVersion:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="44" src="https://cybergeeks.tech/wp-content/uploads/2023/08/28-1024x44.jpg" alt="" class="wp-image-4700"><figcaption class="wp-element-caption">Figure 28</figcaption></figure>



<p>The WSAStartup function initiates the use of the Winsock DLL by the current process:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="55" src="https://cybergeeks.tech/wp-content/uploads/2023/08/29-1024x55.jpg" alt="" class="wp-image-4701"><figcaption class="wp-element-caption">Figure 29</figcaption></figure>



<p>The badger constructs a JSON that stores the password extracted from the configuration, the computer name, the OS version, the Base64-encoded executable path, the username, and the process ID:</p>



<figure class="wp-block-image aligncenter size-full"><img loading="lazy" decoding="async" width="579" height="225" src="https://cybergeeks.tech/wp-content/uploads/2023/08/30-1.jpg" alt="" class="wp-image-4768"><figcaption class="wp-element-caption">Figure 30</figcaption></figure>



<p>The JSON is encrypted using the XOR operator (key = “abcd@123” from configuration) and transformed by other operations:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="89" src="https://cybergeeks.tech/wp-content/uploads/2023/08/31-1024x89.jpg" alt="" class="wp-image-4703"><figcaption class="wp-element-caption">Figure 31</figcaption></figure>



<figure class="wp-block-image aligncenter size-full"><img loading="lazy" decoding="async" width="848" height="202" src="https://cybergeeks.tech/wp-content/uploads/2023/08/32.jpg" alt="" class="wp-image-4704"><figcaption class="wp-element-caption">Figure 32</figcaption></figure>



<figure class="wp-block-image aligncenter size-full"><img loading="lazy" decoding="async" width="577" height="58" src="https://cybergeeks.tech/wp-content/uploads/2023/08/33.jpg" alt="" class="wp-image-4705"><figcaption class="wp-element-caption">Figure 33</figcaption></figure>



<p>The user-agent passed to the InternetOpenW&nbsp;function seems to indicate that the product was used by Deloitte China (Figure 34).</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="117" src="https://cybergeeks.tech/wp-content/uploads/2023/08/34-1024x117.jpg" alt="" class="wp-image-4708"><figcaption class="wp-element-caption">Figure 34</figcaption></figure>



<p>The process connects to the C2 server on port 80 by calling the InternetConnectW function:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1291" height="170" src="https://cybergeeks.tech/wp-content/uploads/2023/08/35-1024x135.jpg" alt="" class="wp-image-4709"><figcaption class="wp-element-caption">Figure 35</figcaption></figure>



<p>It creates a POST request to the “/content.php” resource using HttpOpenRequestW, as displayed below.</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="160" src="https://cybergeeks.tech/wp-content/uploads/2023/08/36-1024x160.jpg" alt="" class="wp-image-4710"><figcaption class="wp-element-caption">Figure 36</figcaption></figure>



<p>The security flags for the handle are changed using the InternetSetOptionW API (0x1100 = <strong>SECURITY_FLAG_IGNORE_CERT_CN_INVALID </strong>| <strong>SECURITY_FLAG_IGNORE_UNKNOWN_CA</strong>):</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="90" src="https://cybergeeks.tech/wp-content/uploads/2023/08/37-1024x90.jpg" alt="" class="wp-image-4711"><figcaption class="wp-element-caption">Figure 37</figcaption></figure>



<p>HttpAddRequestHeadersW can be used to add one or more HTTP request headers to the handle however, the second parameter is NULL during malware’s execution (0x20000000 = <strong>HTTP_ADDREQ_FLAG_ADD</strong>):</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="92" src="https://cybergeeks.tech/wp-content/uploads/2023/08/38-1024x92.jpg" alt="" class="wp-image-4712"><figcaption class="wp-element-caption">Figure 38</figcaption></figure>



<p>The process encodes the encrypted JSON using Base64 and exfiltrates the resulting data using HttpSendRequestW:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="176" src="https://cybergeeks.tech/wp-content/uploads/2023/08/39-1024x176.jpg" alt="" class="wp-image-4713"><figcaption class="wp-element-caption">Figure 39</figcaption></figure>



<p>It verifies whether the C2 server sends any data back via a function call to InternetQueryDataAvailable:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="102" src="https://cybergeeks.tech/wp-content/uploads/2023/08/40-1024x102.jpg" alt="" class="wp-image-4714"><figcaption class="wp-element-caption">Figure 40</figcaption></figure>



<p>The C2 server’s response is read using InternetReadFile:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="134" src="https://cybergeeks.tech/wp-content/uploads/2023/08/41-1024x134.jpg" alt="" class="wp-image-4715"><figcaption class="wp-element-caption">Figure 41</figcaption></figure>



<p>The response is Base64-decoded and decrypted using the same key that was previously mentioned. The “auth” field is set to the decrypted information, and another request is made to the C2 server, asking for commands:</p>



<figure class="wp-block-image aligncenter size-full"><img loading="lazy" decoding="async" width="579" height="82" src="https://cybergeeks.tech/wp-content/uploads/2023/08/42.jpg" alt="" class="wp-image-4716"><figcaption class="wp-element-caption">Figure 42</figcaption></figure>



<p><a href="https://github.com/mandiant/flare-fakenet-ng">FakeNet-NG</a> was used to simulate the network communications with the C2 server. After decoding and decrypting the response, the first 2 bytes represent the command to be executed followed by additional parameters if necessary. A new thread handles the commands execution:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="144" src="https://cybergeeks.tech/wp-content/uploads/2023/08/43-1024x144.jpg" alt="" class="wp-image-4717"><figcaption class="wp-element-caption">Figure 43</figcaption></figure>



<p>We’ll now describe the commands that can be issued by the C2 server.</p>



<p><strong>0x2C74 ID </strong>– Exfiltrate file content to the C2 server</p>



<p>The PathFileExistsA API is utilized to confirm if the target file exists on the system:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1291" height="55" src="https://cybergeeks.tech/wp-content/uploads/2023/08/44-1024x44.jpg" alt="" class="wp-image-4721"><figcaption class="wp-element-caption">Figure 44</figcaption></figure>



<p>The file is opened via a function call to CreateFileA (0x80000000 = <strong>GENERIC_READ</strong>, 0x1 = <strong>FILE_SHARE_READ</strong>, 0x3 = <strong>OPEN_EXISTING</strong>):</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="127" src="https://cybergeeks.tech/wp-content/uploads/2023/08/45-1024x127.jpg" alt="" class="wp-image-4723"><figcaption class="wp-element-caption">Figure 45</figcaption></figure>



<p>The content is read by calling the ReadFile method, as shown in Figure 46.</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="108" src="https://cybergeeks.tech/wp-content/uploads/2023/08/46-1024x108.jpg" alt="" class="wp-image-4724"><figcaption class="wp-element-caption">Figure 46</figcaption></figure>



<p>The data is sent to the C2 server along with the “[+] Download complete” message or the message shown in the figure below.</p>



<figure class="wp-block-image aligncenter size-full"><img loading="lazy" decoding="async" width="584" height="372" src="https://cybergeeks.tech/wp-content/uploads/2023/08/47.jpg" alt="" class="wp-image-4725"><figcaption class="wp-element-caption">Figure 47</figcaption></figure>



<p><strong>0xA905 ID</strong> – Copy files</p>



<p>The malware copies an existing file to a new file using CopyFileA:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="74" src="https://cybergeeks.tech/wp-content/uploads/2023/08/48-1024x74.jpg" alt="" class="wp-image-4726"><figcaption class="wp-element-caption">Figure 48</figcaption></figure>



<p><strong>0x9B84 ID</strong> – Move files</p>



<p>The process moves an existing file to another using the MoveFileA function (Figure 49).</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="55" src="https://cybergeeks.tech/wp-content/uploads/2023/08/49-1024x55.jpg" alt="" class="wp-image-4727"><figcaption class="wp-element-caption">Figure 49</figcaption></figure>



<p><strong>0x13A1 ID</strong> – Create files and populate them with content received from the C2 server</p>



<p>Firstly, the file is created via a function call to CreateFileA:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="126" src="https://cybergeeks.tech/wp-content/uploads/2023/08/50-1024x126.jpg" alt="" class="wp-image-4728"><figcaption class="wp-element-caption">Figure 50</figcaption></figure>



<p>The received data is Base64-decoded using CryptStringToBinaryA and written to the file:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="110" src="https://cybergeeks.tech/wp-content/uploads/2023/08/51-1024x110.jpg" alt="" class="wp-image-4729"><figcaption class="wp-element-caption">Figure 51</figcaption></figure>



<p><strong>0xE993 ID</strong> – Delete files</p>



<p>DeleteFileA is used to delete the target files, as highlighted below:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="44" src="https://cybergeeks.tech/wp-content/uploads/2023/08/52-1024x44.jpg" alt="" class="wp-image-4730"><figcaption class="wp-element-caption">Figure 52</figcaption></figure>



<p><strong>0x0605 ID</strong> – Close handles</p>



<p>The badger closes an object handle (i.e. file, process) using the CloseHandle API:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="63" src="https://cybergeeks.tech/wp-content/uploads/2023/08/53-1024x63.jpg" alt="" class="wp-image-4731"><figcaption class="wp-element-caption">Figure 53</figcaption></figure>



<p><strong>0x3F61 ID</strong> – Create directories</p>



<p>The malicious binary has the ability to create directories using the CreateDirectoryA method:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="56" src="https://cybergeeks.tech/wp-content/uploads/2023/08/54-1024x56.jpg" alt="" class="wp-image-4732"><figcaption class="wp-element-caption">Figure 54</figcaption></figure>



<p><strong>0x1139 ID</strong> – Change the current directory for the process</p>



<p>SetCurrentDirectoryA is utilized to perform the desired operation (see Figure 55).</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="45" src="https://cybergeeks.tech/wp-content/uploads/2023/08/55-1024x45.jpg" alt="" class="wp-image-4733"><figcaption class="wp-element-caption">Figure 55</figcaption></figure>



<p><strong>0x3C9F ID</strong> – Obtain the current directory for the process</p>



<p>The malware extracts the current directory for the process by calling the GetCurrentDirectoryW API:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="64" src="https://cybergeeks.tech/wp-content/uploads/2023/08/56-1024x64.jpg" alt="" class="wp-image-4735"><figcaption class="wp-element-caption">Figure 56</figcaption></figure>



<p><strong>0x8F40 ID</strong> – Delete directories</p>



<p>The process deletes a target directory only if it’s empty using RemoveDirectoryA:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="45" src="https://cybergeeks.tech/wp-content/uploads/2023/08/57-1024x45.jpg" alt="" class="wp-image-4737"><figcaption class="wp-element-caption">Figure 57</figcaption></figure>



<p><strong>0x0A32 ID</strong> – Retrieve the Last-Write time for files/directories</p>



<p>The files are enumerated in the current directory using the FindFirstFileW and FindNextFileW functions:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="57" src="https://cybergeeks.tech/wp-content/uploads/2023/08/58-1024x57.jpg" alt="" class="wp-image-4738"><figcaption class="wp-element-caption">Figure 58</figcaption></figure>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="56" src="https://cybergeeks.tech/wp-content/uploads/2023/08/59-1024x56.jpg" alt="" class="wp-image-4739"><figcaption class="wp-element-caption">Figure 59</figcaption></figure>



<p>For each of the file or directory that matches the pattern, the binary calls the CreateFileW API:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="126" src="https://cybergeeks.tech/wp-content/uploads/2023/08/60-1024x126.jpg" alt="" class="wp-image-4740"><figcaption class="wp-element-caption">Figure 60</figcaption></figure>



<p>The process retrieves the Last-Write time via a function call to GetFileTime:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="98" src="https://cybergeeks.tech/wp-content/uploads/2023/08/61-1024x98.jpg" alt="" class="wp-image-4741"><figcaption class="wp-element-caption">Figure 61</figcaption></figure>



<p>The file time is converted to system time format using FileTimeToSystemTime:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="75" src="https://cybergeeks.tech/wp-content/uploads/2023/08/62-1024x75.jpg" alt="" class="wp-image-4742"><figcaption class="wp-element-caption">Figure 62</figcaption></figure>



<p>Finally, the above time is converted to the currently active time zone:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="71" src="https://cybergeeks.tech/wp-content/uploads/2023/08/63-1024x71.jpg" alt="" class="wp-image-4743"><figcaption class="wp-element-caption">Figure 63</figcaption></figure>



<p><strong>0x3D1D ID</strong> – Change the Desktop wallpaper</p>



<p>The malicious process opens the “TranscodedWallpaper” file that contains the Desktop wallpaper:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="203" src="https://cybergeeks.tech/wp-content/uploads/2023/08/64-1024x203.jpg" alt="" class="wp-image-4744"><figcaption class="wp-element-caption">Figure 64</figcaption></figure>



<p>The above file is filled in with content received from the C2 server (Figure 65).</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="108" src="https://cybergeeks.tech/wp-content/uploads/2023/08/65-1024x108.jpg" alt="" class="wp-image-4745"><figcaption class="wp-element-caption">Figure 65</figcaption></figure>



<p>The SystemParametersInfoA&nbsp;method is utilized to change the Desktop wallpaper (0x14 = <strong>SPI_SETDESKWALLPAPER</strong>, 0x1 = <strong>SPIF_UPDATEINIFILE</strong>):</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="90" src="https://cybergeeks.tech/wp-content/uploads/2023/08/66-1024x90.jpg" alt="" class="wp-image-4746"><figcaption class="wp-element-caption">Figure 66</figcaption></figure>



<p><strong>0xD53F ID</strong> – Retrieve the username </p>



<p>This command is used to obtain the username associated with the current thread:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="64" src="https://cybergeeks.tech/wp-content/uploads/2023/08/67-1024x64.jpg" alt="" class="wp-image-4747"><figcaption class="wp-element-caption">Figure 67</figcaption></figure>



<p><strong>0x0609 ID</strong> – Retrieve the available disk drives</p>



<p>The malware extracts a bitmask that contains the available disk drives by calling the GetLogicalDrives API, as shown in Figure 68.</p>



<figure class="wp-block-image aligncenter size-full"><img loading="lazy" decoding="async" width="850" height="48" src="https://cybergeeks.tech/wp-content/uploads/2023/08/68.jpg" alt="" class="wp-image-4748"><figcaption class="wp-element-caption">Figure 68</figcaption></figure>



<p><strong>0xC144 ID</strong> – Extract all device drivers</p>



<p>EnumDeviceDrivers is utilized to obtain the load address for all device drivers:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="75" src="https://cybergeeks.tech/wp-content/uploads/2023/08/69-1024x75.jpg" alt="" class="wp-image-4749"><figcaption class="wp-element-caption">Figure 69</figcaption></figure>



<p>Using the above address, the process retrieves the name of the device driver by calling the GetDeviceDriverBaseNameA method:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="80" src="https://cybergeeks.tech/wp-content/uploads/2023/08/70-1024x80.jpg" alt="" class="wp-image-4750"><figcaption class="wp-element-caption">Figure 70</figcaption></figure>



<p><strong>0x0A01 ID</strong> – Compute the number of minutes that have elapsed since the system was started</p>



<p>The GetTickCount function is used to extract the number of milliseconds and a simple calculation is performed (see Figure 71).</p>



<figure class="wp-block-image aligncenter size-full"><img loading="lazy" decoding="async" width="850" height="123" src="https://cybergeeks.tech/wp-content/uploads/2023/08/71.jpg" alt="" class="wp-image-4751"><figcaption class="wp-element-caption">Figure 71</figcaption></figure>



<p><strong>0x73E6 ID</strong> – Argument Spoofing</p>



<p>The badger has the ability to hide the arguments by modifying the process environment block (PEB):</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="48" src="https://cybergeeks.tech/wp-content/uploads/2023/08/72-1024x48.jpg" alt="" class="wp-image-4752"><figcaption class="wp-element-caption">Figure 72</figcaption></figure>



<p><strong>0x8AFA ID</strong> – Parent PID Spoofing</p>



<p>This command can be used to spoof the parent process ID in order to evade EDR software or other solutions:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="48" src="https://cybergeeks.tech/wp-content/uploads/2023/08/73-1024x48.jpg" alt="" class="wp-image-4753"><figcaption class="wp-element-caption">Figure 73</figcaption></figure>



<p><strong>0xC929 ID</strong> – Extract child process name</p>



<p>The binary could spawn multiple processes that can be displayed using this command (Figure 74).</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="56" src="https://cybergeeks.tech/wp-content/uploads/2023/08/74-1024x56.jpg" alt="" class="wp-image-4754"><figcaption class="wp-element-caption">Figure 74</figcaption></figure>



<p><strong>0x9E72 ID</strong> – Display pipes name</p>



<p>The malware displays the name of a previously created pipe:</p>



<figure class="wp-block-image aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="56" src="https://cybergeeks.tech/wp-content/uploads/2023/08/75-1024x56.jpg" alt="" class="wp-image-4755"><figcaption class="wp-element-caption">Figure 75</figcaption></figure>



<p>The other 30 relevant commands will be detailed in a second blog post.</p>



<p style="font-size:25px">INDICATORS OF COMPROMISE</p>



<p>SHA256: d71dc7ba8523947e08c6eec43a726fe75aed248dfd3a7c4f6537224e9ed05f6f</p>



<p>C2 server: 45.77.172.28</p>



<p>User-agent: trial@deloitte.com.cn</p>



<p style="font-size:25px">References</p>



<p>MSDN:&nbsp;<a href="https://docs.microsoft.com/en-us/windows/win32/api/">https://docs.microsoft.com/en-us/windows/win32/api/</a></p>



<p>FakeNet-NG: <a href="https://github.com/mandiant/flare-fakenet-ng">https://github.com/mandiant/flare-fakenet-ng</a></p>



<p>Unit42: <a href="https://unit42.paloaltonetworks.com/brute-ratel-c4-tool/">https://unit42.paloaltonetworks.com/brute-ratel-c4-tool/</a></p>



<p></p>



<p></p>



<p></p>



<p></p>



<p></p>



<p></p>



<p></p>



<p></p>



<p></p>



<p></p>



<p></p>



<p></p>



<p></p>



<p></p>



<p></p>



<p></p>



<p></p>



<p></p>



<p></p>



<p></p>



<p></p>



<p></p>

		
		
			</div><!-- .entry-content .clear -->
</div>

	
</article><!-- #post-## -->

    <div class="wpdiscuz_top_clearing"></div>
    <div id="comments" class="comments-area"><div id="respond" style="width: 0;height: 0;clear: both;margin: 0;padding: 0;"></div><div id="wpd-post-rating" class="wpd-not-rated">
            <div class="wpd-rating-wrap">
            <div class="wpd-rating-left"></div>
            <div class="wpd-rating-data">
                <div class="wpd-rating-value">
                    <span class="wpdrv">4.7</span>
                    <span class="wpdrc">7</span>
                    <span class="wpdrt">votes</span></div>
                <div class="wpd-rating-title">Article Rating</div>
                <div class="wpd-rating-stars"><svg xmlns="https://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"></path><path class="wpd-star wpd-active" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg><svg xmlns="https://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"></path><path class="wpd-star wpd-active" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg><svg xmlns="https://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"></path><path class="wpd-star wpd-active" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg><svg xmlns="https://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"></path><path class="wpd-star wpd-active" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg><svg xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink" viewBox="0 0 24 24"><defs><path id="a" d="M0 0h24v24H0V0z"></path></defs><clipPath id="b"><use xlink:href="#a" overflow="visible"></use></clipPath><path class="wpd-star wpd-active" clip-path="url(#b)" d="M22 9.24l-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4V6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z"></path></svg></div><div class="wpd-rate-starts"><svg xmlns="https://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"></path><path class="wpd-star" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg><svg xmlns="https://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"></path><path class="wpd-star" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg><svg xmlns="https://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"></path><path class="wpd-star" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg><svg xmlns="https://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"></path><path class="wpd-star" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg><svg xmlns="https://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"></path><path class="wpd-star" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></div></div>
            <div class="wpd-rating-right"></div></div></div>    <div id="wpdcom" class="wpdiscuz_unauth wpd-default wpd-layout-2 wpd-comments-closed">
                    <div id="wpd-threads" class="wpd-thread-wrapper">
                <div class="wpd-thread-head">
                    <div class="wpd-thread-info " data-comments-count="2">
                        <span class="wpdtc" title="2">2</span> Comments                    </div>
                                        <div class="wpd-space"></div>
                    <div class="wpd-thread-filter">
                                                    <div class="wpd-filter wpdf-reacted wpd_not_clicked " wpd-tooltip="Most reacted comment">
                                <i class="fas fa-bolt"></i></div>
                                                        <div class="wpd-filter wpdf-hottest wpd_not_clicked " wpd-tooltip="Hottest comment thread">
                                <i class="fas fa-fire"></i></div>
                                                        <div class="wpd-filter wpdf-sorting ">
                                                                        <span class="wpdiscuz-sort-button wpdiscuz-date-sort-asc wpdiscuz-sort-button-active" data-sorting="oldest">Oldest</span>
                                                                        <i class="fas fa-sort-down"></i>
                                <div class="wpdiscuz-sort-buttons">
                                                                            <span class="wpdiscuz-sort-button wpdiscuz-date-sort-desc" data-sorting="newest">Newest</span>
                                                                                <span class="wpdiscuz-sort-button wpdiscuz-vote-sort-up" data-sorting="by_vote">Most Voted</span>
                                                                        </div>
                            </div>
                                                </div>
                </div>
                <div class="wpd-comment-info-bar">
                    <div class="wpd-current-view"><i class="fas fa-quote-left"></i> Inline Feedbacks                    </div>
                    <div class="wpd-filter-view-all">View all comments</div>
                </div>
                                <div class="wpd-thread-list">
                    <div id="wpd-comm-166_0" class="comment even thread-even depth-1 wpd-comment wpd_comment_level-1"><div class="wpd-comment-wrap wpd-blog-guest">
    <div id="comment-166" class="wpd-comment-right">
    <div class="wpd-comment-header">
    <div class="wpd-avatar ">
    <img alt="JavadYassarii" src="https://secure.gravatar.com/avatar/990b5b5bfed4d782bb677e15be6fef4feef26e39459bd05b9fe6daa11814a38a?s=64&amp;d=mm&amp;r=g" class="avatar avatar-64 photo" height="64" width="64" loading="lazy" decoding="async">
</div>
    <div class="wpd-user-info">
    <div class="wpd-uinfo-top">
    <div class="wpd-comment-author ">
    JavadYassarii
</div>
    
    
    <div class="wpd-comment-share wpd-hidden wpd-tooltip wpd-top">
    <i class="fas fa-share-alt" aria-hidden="true"></i>
    <div class="wpd-tooltip-content">
        <a class="wc_tw" rel="noreferrer" target="_blank" href="https://twitter.com/intent/tweet?text=nicewaiting%20for%20next%20partit%20would%20be%20good%20to%20check%20Night...%20&amp;url=https%3A%2F%2Fcybergeeks.tech%2Fa-deep-dive-into-brute-ratel-c4-payloads%2F%23comment-166" title="Share On X"><i class="wpf-cta" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"></path></svg></i></a>
    </div>
</div>
    <div class="wpd-space"></div>
</div>
    <div class="wpd-uinfo-bottom">
    
    
    <div class="wpd-comment-date" title="September 5, 2023 7:44 am">
    <i class="far fa-clock" aria-hidden="true"></i>
    2 years ago
</div>
</div>
</div>
    <div class="wpd-comment-link wpd-hidden">
    <span wpd-tooltip="Comment Link" wpd-tooltip-position="left"><i class="fas fa-link" aria-hidden="true" data-wpd-clipboard="https://cybergeeks.tech/a-deep-dive-into-brute-ratel-c4-payloads/#comment-166"></i></span>
</div>
</div>
    <div class="wpd-comment-text">
    <p>nice<br>
waiting for next part<br>
it would be good to check NightHawk samples too</p>

</div>
    <div class="wpd-comment-footer">
    <div class="wpd-vote">
    <div class="wpd-vote-up wpd_not_clicked">
        <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="plus" class="svg-inline--fa fa-plus fa-w-14" role="img" xmlns="https://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"></path></svg>
    </div>
    <div class="wpd-vote-result" title="0">0</div>
    <div class="wpd-vote-down wpd_not_clicked">
        <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="minus" class="svg-inline--fa fa-minus fa-w-14" role="img" xmlns="https://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 208H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"></path></svg>
    </div>
</div>
    
    <div class="wpd-space"></div>
    
    
</div>
</div>
</div><div id="wpdiscuz_form_anchor-166_0"></div></div><div id="wpd-comm-167_0" class="pingback odd alt thread-odd thread-alt depth-1 wpd-comment wpd_comment_level-1"><div class="wpd-comment-wrap wpd-blog-guest">
    <div id="comment-167" class="wpd-comment-right">
    <div class="wpd-comment-header">
    <div class="wpd-avatar ">
    <img class="avatar avatar-64 photo" width="64" height="64" src="https://cybergeeks.tech/wp-content/plugins/wpdiscuz/assets/img/trackback.png" alt="trackback">
</div>
    <div class="wpd-user-info">
    <div class="wpd-uinfo-top">
    <div class="wpd-comment-author ">
    <a href="https://cert.bournemouth.ac.uk/a-deep-dive-into-brute-ratel-c4-payloads/" rel="noreferrer ugc nofollow" target="_blank">A DEEP DIVE INTO BRUTE RATEL C4 PAYLOADS – BU-CERT</a>
</div>
    
    
    <div class="wpd-comment-share wpd-hidden wpd-tooltip wpd-top">
    <i class="fas fa-share-alt" aria-hidden="true"></i>
    <div class="wpd-tooltip-content">
        <a class="wc_tw" rel="noreferrer" target="_blank" href="https://twitter.com/intent/tweet?text=[%E2%80%A6]%20Read%20more%E2%80%A6%20[%E2%80%A6]&amp;url=https%3A%2F%2Fcybergeeks.tech%2Fa-deep-dive-into-brute-ratel-c4-payloads%2F%23comment-167" title="Share On X"><i class="wpf-cta" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"></path></svg></i></a>
    </div>
</div>
    <div class="wpd-space"></div>
</div>
    <div class="wpd-uinfo-bottom">
    
    
    <div class="wpd-comment-date" title="September 7, 2023 8:34 am">
    <i class="far fa-clock" aria-hidden="true"></i>
    2 years ago
</div>
</div>
</div>
    <div class="wpd-comment-link wpd-hidden">
    <span wpd-tooltip="Comment Link" wpd-tooltip-position="left"><i class="fas fa-link" aria-hidden="true" data-wpd-clipboard="https://cybergeeks.tech/a-deep-dive-into-brute-ratel-c4-payloads/#comment-167"></i></span>
</div>
</div>
    <div class="wpd-comment-text">
    <p>[…] Read more… […]</p>

</div>
    <div class="wpd-comment-footer">
    <div class="wpd-vote">
    <div class="wpd-vote-up wpd_not_clicked">
        <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="plus" class="svg-inline--fa fa-plus fa-w-14" role="img" xmlns="https://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"></path></svg>
    </div>
    <div class="wpd-vote-result wpd-up" title="2">2</div>
    <div class="wpd-vote-down wpd_not_clicked">
        <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="minus" class="svg-inline--fa fa-minus fa-w-14" role="img" xmlns="https://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 208H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"></path></svg>
    </div>
</div>
    
    <div class="wpd-space"></div>
    
    
</div>
</div>
</div><div id="wpdiscuz_form_anchor-167_0"></div></div><!-- // From wpDiscuz's Caches // -->                    <div class="wpdiscuz-comment-pagination">
                                            </div>
                </div>
            </div>
                </div>
        </div>
    <div id="wpdiscuz-loading-bar" class="wpdiscuz-loading-bar-unauth"></div>
    <div id="wpdiscuz-comment-message" class="wpdiscuz-comment-message-unauth"></div>
    			</main><!-- #main -->
			
		
	</div><!-- #primary -->


	<div class="widget-area secondary" id="secondary" itemtype="https://schema.org/WPSideBar" itemscope="itemscope">
	<div class="sidebar-main">
		
		
		
	</div><!-- .sidebar-main -->
</div><!-- #secondary -->


	</div> <!-- ast-container -->
	</div><!-- #content -->

		<!-- #colophon -->
			</div><!-- #page -->

<!-- Matomo -->
<!-- End Matomo Code --><span id="wpdUserContentInfoAnchor" style="display:none;" rel="#wpdUserContentInfo" data-wpd-lity="">wpDiscuz</span><div id="wpdUserContentInfo" style="overflow:auto;background:#FDFDF6;padding:20px;width:600px;max-width:100%;border-radius:6px;" class="lity-hide"></div><div id="wpd-editor-source-code-wrapper-bg"></div><div id="wpd-editor-source-code-wrapper"><textarea id="wpd-editor-source-code"></textarea><button id="wpd-insert-source-code">Insert</button></div>			
			













	

<div id="cboxOverlay" style="display: none;"></div><div id="colorbox" class="" role="dialog" tabindex="-1" style="display: none;"><div id="cboxWrapper"><div><div id="cboxTopLeft" style="float: left;"></div><div id="cboxTopCenter" style="float: left;"></div><div id="cboxTopRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxMiddleLeft" style="float: left;"></div><div id="cboxContent" style="float: left;"><div id="cboxTitle" style="float: left;"></div><div id="cboxCurrent" style="float: left;"></div><button type="button" id="cboxPrevious"></button><button type="button" id="cboxNext"></button><button type="button" id="cboxSlideshow"></button><div id="cboxLoadingOverlay" style="float: left;"></div><div id="cboxLoadingGraphic" style="float: left;"></div></div><div id="cboxMiddleRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxBottomLeft" style="float: left;"></div><div id="cboxBottomCenter" style="float: left;"></div><div id="cboxBottomRight" style="float: left;"></div></div></div><div style="position: absolute; width: 9999px; visibility: hidden; display: none; max-width: none;"></div></div></body></html>