Title:
Change a Signed Executable (Appending Data Without Breaking Authenticode)

Type:
Blog Post

Short Summary (4–8 sentences max):
This post explains a quirk in Microsoft Authenticode where certain regions of a PE file are excluded from the signature hash, allowing modifications without invalidating the signature. Specifically, it shows that arbitrary data can be appended after the embedded digital certificate as long as the Certificate Table length fields are updated correctly. The author details which PE fields are not hashed (checksum, Certificate Table directory entry, and the certificate blob itself) and provides step-by-step offsets for updating the relevant headers. The technique was tested on Windows 2000/XP/Vista and relies on Windows ignoring extra trailing data beyond the certificate structure. It’s useful for red teams, malware analysts, and defenders studying signed-binary abuse and file format edge cases. It’s interesting because it demonstrates a practical way to “carry” extra payload/data inside a signed executable while preserving signature validity.

Technical Focus:
- PE/COFF format and Optional Header parsing
- Authenticode hashing exclusions (Certificate Table behavior)
- IMAGE_DATA_DIRECTORY (Security/Certificate Table) fields
- WIN_CERTIFICATE / PKCS#7 length handling (dwLength)
- Appending data to signed binaries and alignment constraints
- PE checksum considerations

Use Cases:
- Embed configuration/data inside a legitimately signed PE without breaking signature validation
- Create signed-looking droppers/containers that carry extra appended content
- Test and validate defensive tooling that inspects signed binaries for trailing data
- Forensics/reverse engineering: detect hidden appended blobs in signed executables

Keywords:
Authenticode, PE, Portable Executable, PE/COFF, Certificate Table, IMAGE_DATA_DIRECTORY, WIN_CERTIFICATE, PKCS#7, dwLength, checksum, optional header, signature validation, appended data, trailing overlay, signed binary abuse, Windows loader, x86 offsets, 64-bit alignment