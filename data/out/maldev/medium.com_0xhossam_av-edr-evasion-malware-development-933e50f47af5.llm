Title:
AV/EDR Evasion | Malware Development

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post is an introductory walkthrough on how AV/EDR products detect malware and common evasion categories, ending with a basic Windows shellcode loader example in C.  
- It frames detection into signature-, heuristic-, and behavior-based approaches, then maps evasion ideas to “on-disk” (packers/obfuscators/protectors) versus “in-memory” techniques.  
- The author briefly describes popular injection concepts such as remote process injection, reflective DLL injection (manual mapping), process hollowing, and inline hooking.  
- A practical section shows generating shellcode with `msfvenom`, allocating RWX memory with `VirtualAlloc`, copying bytes with `RtlMoveMemory`, and executing via `CreateThread`.  
- It then demonstrates simple XOR shellcode encryption/decryption (Python generator + C decrypt routine) and notes that naïve loaders remain detectable due to suspicious APIs and patterns.  
- Useful for red teamers and malware dev learners as a baseline primer before deeper EDR bypass topics (the post links to later parts in the series).

Technical Focus:
- AV detection models: signature vs heuristic vs behavioral
- On-disk evasion: packing, obfuscation, protectors
- In-memory tradecraft: process injection, reflective loading/manual mapping
- Shellcode loaders on Windows (RWX allocation + thread execution)
- Basic payload encryption (XOR) and runtime decryption
- Suspicious/blacklisted Win32 APIs and basic obfuscation motivation

Use Cases:
- Building a minimal Windows shellcode loader for lab testing
- Demonstrating why common loader patterns trigger AV/EDR detections
- Teaching introductory malware analysis concepts (static vs dynamic)
- Comparing on-disk vs in-memory evasion approaches at a high level
- Creating simple encrypted shellcode blobs for controlled experiments

Keywords:
AV evasion, EDR, malware development, static analysis, dynamic analysis, signature-based detection, heuristic detection, behavioral detection, packers, obfuscation, process injection, reflective DLL injection, manual mapping, process hollowing, inline hooking, shellcode loader, msfvenom, Metasploit, VirtualAlloc, RtlMoveMemory, CreateThread, WaitForSingleObject, PAGE_EXECUTE_READWRITE, XOR encryption