# https://www.elastic.co/security-labs/the-elastic-container-project

<!DOCTYPE html><html lang="en"><body><div id="__next"><main class="__variable_0351a5 __variable_a475ec __variable_ead7f7 flex flex-col min-h-screen"><div class="scroll-percentage-container"><div class="scroll-percentage-bar" style="width:0%"></div></div><div class="UtilityHeader_utilityHeader__T_Eto"><div class="UtilityHeader_utilityHeader__container__exgwf"></div></div><main class="mb-20 flex-1 flex flex-col"><div class="h-48 md:h-64" style="will-change: transform; transform: translateY(87.624px);"><div class="after:absolute after:block after:bg-blue-400 after:blur-3xl after:content-[' '] after:h-96 after:opacity-5 after:right-0 after:rounded-full after:top-20 after:w-1/2 after:z-0 before:absolute before:block before:blur-3xl before:bg-orange-400 before:content-[' '] before:h-96 before:left-0 before:opacity-5 before:rounded-full before:w-1/2 before:z-0 w-full h-full relative"><div class="relative z-10 w-full h-[125%] -top-[25%] bg-no-repeat bg-cover bg-bottom flex items-center justify-center" style="background-image:url(/security-labs/grid.svg)"></div></div></div><article class="px-4"><div class="max-w-7xl mx-auto relative z-10 flex flex-col space-y-4"><div class="eyebrow break-words"><time class="block mb-2 md:mb-0 md:inline-block article-published-date" datetime="2023-03-01T00:00:00.000Z">28 February 2023</time><span class="hidden md:inline-block md:mx-2">•</span><a class="hover:text-blue-400 text-xs md:text-sm whitespace-nowrap author-name" href="https://www.elastic.co/security-labs/author/andrew-pease">Andrew Pease</a><span class="mx-2">•</span><a class="hover:text-blue-400 text-xs md:text-sm whitespace-nowrap author-name" href="https://www.elastic.co/security-labs/author/colson-wilhoit">Colson Wilhoit</a><span class="mx-2">•</span><a class="hover:text-blue-400 text-xs md:text-sm whitespace-nowrap author-name" href="https://www.elastic.co/security-labs/author/derek-ditch">Derek Ditch</a></div><h1 class="font-bold leading-tighter text-3xl md:text-5xl"><span>The Elastic Container Project for Security&nbsp;Research</span></h1><p class="text-zinc-200 text-base md:text-xl">Using Docker to stand up the Elastic Stack</p><div class="flex items-center mt-4 text-zinc-200 text-sm space-x-4 border-t border-white/25 pt-4"><span class="flex items-center space-x-1"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="h-4 w-4 text-zinc-400"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span>17 min read</span></span><span class="flex items-center space-x-1"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="h-4 w-4 text-zinc-400"><path stroke-linecap="round" stroke-linejoin="round" d="M9.568 3H5.25A2.25 2.25 0 003 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 005.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 009.568 3z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M6 6h.008v.008H6V6z"></path></svg><span><a class="hover:text-blue-400 whitespace-nowrap" href="https://www.elastic.co/security-labs/category/detection-engineering">Detection Engineering</a>, </span><span><a class="hover:text-blue-400 whitespace-nowrap" href="https://www.elastic.co/security-labs/category/enablement">Enablement</a>, </span><span><a class="hover:text-blue-400 whitespace-nowrap" href="https://www.elastic.co/security-labs/category/tools">Tools</a></span></span></div></div><div class="max-w-7xl mx-auto"><div class="bg-zinc-900 border border-zinc-800 drop-shadow-lg p-5 sm:p-8 md:p-10 rounded-3xl mt-5 md:mt-10"><div class="relative w-full rounded-lg overflow-hidden aspect-video"><img alt="The Elastic Container Project for Security Research" fetchpriority="high" decoding="async" data-nimg="fill" class="object-cover absolute h-full w-full" style="position:absolute;height:100%;width:100%;left:0;top:0;right:0;bottom:0;color:transparent" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2Fblog-thumb-container-barge.jpg&amp;w=3840&amp;q=75"><div class="absolute border border-white/50 inset-0 mix-blend-overlay rounded-lg z-10"></div></div></div></div><div class="lg:max-w-7xl mx-auto relative mt-12 lg:grid lg:grid-cols-4 lg:gap-8 items-start"><div class="flex justify-center lg:col-span-3"><div class="prose lg:prose-lg prose-invert w-full article-content"><div><h2 class="font-bold text-2xl md:text-4xl relative"><span id="preamble" class="absolute -top-32"></span>Preamble</h2>
<p>The Elastic Stack is a modular data analysis ecosystem. While this allows for engineering flexibility, it can be cumbersome to stand up a development instance for testing. The easiest way to stand up the Elastic Stack, is to use <a href="https://cloud.elastic.co/">Elastic Cloud</a> - it’s completely turnkey. However, there could be situations where Elastic Cloud won’t work for your testing environment. To help with this, this blog will provide you with the necessary information required in order to quickly and painlessly stand up a local, fully containerized, TLS-secured, Elastic Stack with Fleet and the Detection Engine enabled. You will be able to create a Fleet policy, install an Elastic Agent on a local host or VM, and send the data into your stack for monitoring or analysis.</p>
<p>This blog will cover the following:</p>
<ul>
<li>The Elastic Stack</li>
<li>The Elastic Container project</li>
<li>How to use the Elastic Container project</li>
<li>How to navigate Kibana and use its related features for security research</li>
</ul>
<blockquote>
<p>The Elastic Container Project is not sponsored or maintained by the company, Elastic. Design and implementation considerations for the project may not reflect Elastic’s guidance on deploying a production-ready stack.</p>
</blockquote>
<h2 class="font-bold text-2xl md:text-4xl relative"><span id="the-elastic-stack" class="absolute -top-32"></span>The Elastic Stack</h2>
<p>The Elastic Stack is made up of several different components, each of which provide a distinct capability that can be utilized across a wide variety of use cases.</p>
<h3 class="font-bold leading-tight text-xl md:text-3xl relative"><span id="elasticsearch" class="absolute -top-32"></span>Elasticsearch</h3>
<p>Elasticsearch is a distributed, RESTful search and analytics engine. As the heart of the Elastic Stack, it centrally stores your data for lightning-fast search, fine-tuned relevancy, and powerful analytics that scale with ease.</p>
<h3 class="font-bold leading-tight text-xl md:text-3xl relative"><span id="kibana" class="absolute -top-32"></span>Kibana</h3>
<p>Kibana is the user interface that lets you visualize your Elasticsearch data and manage the Elastic Stack.</p>
<h3 class="font-bold leading-tight text-xl md:text-3xl relative"><span id="the-elastic-agent" class="absolute -top-32"></span>The Elastic Agent</h3>
<p>The Elastic Agent is the modular agent that allows you to collect data from an endpoint or act as a vehicle to ship data from 3rd party sources, like threat feeds. The Elastic Security integration for endpoints prevents ransomware and malware, detects advanced threats, and arms responders with vital investigative context.</p>
<h2 class="font-bold text-2xl md:text-4xl relative"><span id="the-elastic-container-project" class="absolute -top-32"></span>The Elastic Container Project</h2>
<p></p><figure style="display: flex; flex-direction: column; align-items: center;"><img alt="The Elastic Container Project" loading="lazy" width="350" height="341" decoding="async" data-nimg="1" class="cursor-zoom-in" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2Felastic-container.png&amp;w=750&amp;q=90" style="object-fit: contain; position: relative;"><figcaption style="color: lightgray; font-style: italic;">The Elastic Container Project</figcaption></figure><p></p>
<p>As mentioned above, the Elastic Stack is modular which makes it very flexible for a wide variety of use cases but this can add complexity to the implementation.</p>
<p>The Elastic Container project is an open source project that uses Docker Compose as a way to stand up a fully-functional Elastic Stack for use in non-production environments. This project is not sponsored or maintained by the Elastic company.</p>
<h3 class="font-bold leading-tight text-xl md:text-3xl relative"><span id="introduction" class="absolute -top-32"></span>Introduction</h3>
<p>The <a href="https://github.com/peasead/elastic-container">Elastic Container Project</a> includes three main components:</p>
<ul>
<li>Elasticsearch</li>
<li>Kibana</li>
<li>the Elastic Agent</li>
</ul>
<p>The project leverages <a href="https://docs.docker.com/compose/">Docker Compose</a>, which is a tool to build, integrate, and manage multiple Docker containers.</p>
<p>To simplify the management of the containers, the project includes a shell script that allows for the staging, starting, stopping, and destroying of the containers.</p>
<p>Additionally, the project makes use of self-signed TLS certificates between Elasticsearch and Kibana, Kibana and your web browser, the Elastic Agent and Elasticsearch, and the Elastic Agent and Kibana.</p>
<h3 class="font-bold leading-tight text-xl md:text-3xl relative"><span id="prerequisites" class="absolute -top-32"></span>Prerequisites</h3>
<p>The project was built and tested on Linux and macOS operating systems. If you are using Windows, you’ll not be able to use the included shell script, but you can still run native Docker Compose commands and manually perform post-deployment steps.</p>
<p>While not thoroughly tested, it is recommended that you contribute 4 cores and 8 GB of RAM to Docker.</p>
<p>There are only a few packages you need to install:</p>
<ul>
<li>Docker</li>
<li>Docker Compose</li>
<li>jq</li>
<li>Git</li>
<li>cURL</li>
</ul>
<h4 class="font-bold leading-tight text-lg md:text-2xl relative"><span id="macos" class="absolute -top-32"></span>macOS</h4>
<p>If you’re running on macOS, you can install the prerequisites using <a href="https://brew.sh/">Homebrew</a>, which is an open-source package management system for macOS. Check out the Homebrew site for information on installing it if needed.</p>
<pre><code>**brew install jq git**
**brew install --cask docker**</code></pre>
<h4 class="font-bold leading-tight text-lg md:text-2xl relative"><span id="linux" class="absolute -top-32"></span>Linux</h4>
<p>If you’re running on Linux, you can install the prerequisites using your package management system ( <strong>DNF</strong> , <strong>Yum</strong> , or <strong>APT</strong> ).</p>
<p><strong>RPM-based distributions</strong></p>
<pre><code>**dnf install jq git curl**</code></pre>
<p><strong>Ubuntu</strong></p>
<pre><code>**apt-get install jq git curl**</code></pre>
<p>You'll also need the Docker suite (including the <strong>docker-compose-plugin</strong> ). Check out Docker's <a href="https://docs.docker.com/engine/install/">installation instructions</a> for your OS'</p>
<h3 class="font-bold leading-tight text-xl md:text-3xl relative"><span id="cloning-the-project-repository" class="absolute -top-32"></span>Cloning the project repository</h3>
<p>The Elastic Container project is stored on Github. As long as you have Git installed, you can collect it from your CLI of choice.</p>
<pre><code>**git clone https://github.com/peasead/elastic-container.git**
**cd elastic-container**</code></pre>
<p>This repository includes everything needed to stand up the Elastic Stack containers using a single shell script.</p>
<h3 class="font-bold leading-tight text-xl md:text-3xl relative"><span id="setting-credentials" class="absolute -top-32"></span>Setting credentials</h3>
<p>Before proceeding, ensure you update the credentials for the Elastic and Kibana accounts in the <strong>.env</strong> file located in the root directory of the repository from their defaults of <strong>changeme</strong>.</p>
<h3 class="font-bold leading-tight text-xl md:text-3xl relative"><span id="the-shell-script" class="absolute -top-32"></span>The shell script</h3>
<p>As mentioned above, the project includes a shell script that will simplify the management of the containers.</p>
<pre><code>**usage: ./elastic-container.sh [-v] (stage|start|stop|restart|status|help)**
**actions:**
 **stage downloads all necessary images to local storage**
 **start creates network and starts containers**
 **stop stops running containers without removing them**
 **destroy stops and removes the containers, the network and volumes created**
 **restart simply restarts all the stack containers**
 **status check the status of the stack containers**
 **help print this message**
 **flags:**
 **-v enable verbose output**</code></pre>
<h4 class="font-bold leading-tight text-lg md:text-2xl relative"><span id="stage" class="absolute -top-32"></span>Stage</h4>
<p>This option downloads all of the containers from the Elastic Docker hub. This is useful if you are going to be building the project on a system that does not always have Internet access. This is not required, you can skip this option and move directly to the start option, which will download the containers.</p>
<pre><code>**$ ./elastic-container.sh stage**
**8.3.0: Pulling from elasticsearch/elasticsearch**
**7aabcb84784a: Already exists**
**e3f44495617d: Downloading [====\\&gt;] 916.5kB/11.26MB**
**52008db3f842: Download complete**
**551b59c59fdc: Downloading [\\&gt;] 527.4kB/366.9MB**
**25ee26aa662e: Download complete**
**7a85d02d9264: Download complete**
**…**</code></pre>
<h4 class="font-bold leading-tight text-lg md:text-2xl relative"><span id="start" class="absolute -top-32"></span>Start</h4>
<p>This opinion will create the container network, download all of the required containers, set up the TLS certificates, and start and connect Elasticsearch, Kibana, and the Fleet server containers together. This option is a “quick start” to get the Elastic Stack up and running. If you have not changed your credentials in the .env file from the defaults, the script will exit.</p>
<pre><code>**$ ./elastic-container.sh start**

**Starting Elastic Stack network and containers**
**[+] Running 7/8**
 **⠿ Network elastic-container\_default Created 0.0s**
 **⠿ Volume "elastic-container\_certs" Created 0.0s**
 **⠿ Volume "elastic-container\_esdata01" Created 0.0s**
 **⠿ Volume "elastic-container\_kibanadata" Created 0.0s**
 **⠿ Container elasticsearch-security-setup Waiting 2.0s**
 **⠿ Container elasticsearch Created 0.0s**
**…**</code></pre>
<h4 class="font-bold leading-tight text-lg md:text-2xl relative"><span id="stop" class="absolute -top-32"></span>Stop</h4>
<p>This option will stop all running containers in the project, but will not remove them.</p>
<pre><code>**$ ./elastic-container.sh stop**

**Stopping running containers.**
**[+] Running 4/4**
 **⠿ Container elastic-agent Stopped 0.0s**
 **⠿ Container kibana Stopped 0.0s**
 **⠿ Container elasticsearch Stopped 0.0s**
 **⠿ Container elasticsearch-security-setup Stopped**
**…**</code></pre>
<h4 class="font-bold leading-tight text-lg md:text-2xl relative"><span id="destroy" class="absolute -top-32"></span>Destroy</h4>
<p>This option will stop all running containers in the project, remove the container network, remove all data volumes, and remove all containers.</p>
<pre><code>**$ ./elastic-container.sh destroy**

**#####**
**Stopping and removing the containers, network, and volumes created.**
**#####**
**[+] Running 8/4**
 **⠿ Container elastic-agent Removed 0.0s**
 **⠿ Container kibana Removed 0.0s**
 **⠿ Container elasticsearch Removed 0.0s**
 **⠿ Container elasticsearch-security-setup Removed 0.3s**
 **⠿ Volume elastic-container\_esdata01 Removed 0.0s**
 **⠿ Network elastic-container\_default Removed 0.1s**
**…**</code></pre>
<h4 class="font-bold leading-tight text-lg md:text-2xl relative"><span id="restart" class="absolute -top-32"></span>Restart</h4>
<p>This option restarts all of the project containers.</p>
<pre><code>**$ ./elastic-container.sh restart

#####
Restarting all Elastic Stack components.
#####
Name Command State Ports
---------------------------
elasticsearch /bin/tini -- /usr/local/bi ... Up (healthy) 0.0.0.0:9200-\\&gt;9200/tcp, 9300/tcp
fleet-server /usr/bin/tini -- /usr/loca ... Up 0.0.0.0:8220-\\&gt;8220/tcp
kibana /bin/tini -- /usr/local/bi ... Up (healthy) 0.0.0.0:5601-\\&gt;5601/tcp**</code></pre>
<h4 class="font-bold leading-tight text-lg md:text-2xl relative"><span id="status" class="absolute -top-32"></span>Status</h4>
<p>This option returns the status of the project containers.</p>
<pre><code>**$ ./elastic-container.sh status**
**Name Command State Ports**
**---------------------------**
**elasticsearch /bin/tini -- /usr/local/bi ... Up (healthy) 0.0.0.0:9200-\\&gt;9200/tcp, 9300/tcp**
**fleet-server /usr/bin/tini -- /usr/loca ... Up 0.0.0.0:8220-\\&gt;8220/tcp**
**kibana /bin/tini -- /usr/local/bi ... Up (healthy) 0.0.0.0:5601-\\&gt;5601/tcp**</code></pre>
<h4 class="font-bold leading-tight text-lg md:text-2xl relative"><span id="clear" class="absolute -top-32"></span>Clear</h4>
<p>This option clears all documents in the logs and metrics indices.</p>
<pre><code>**$ ./elastic-container.sh clear**

**Successfully cleared logs data stream**
**Successfully cleared metrics data stream**</code></pre>
<h4 class="font-bold leading-tight text-lg md:text-2xl relative"><span id="help" class="absolute -top-32"></span>Help</h4>
<p>This option provides instructions on using the shell script.</p>
<pre><code>**$ ./elastic-container.sh help**

**usage: ./elastic-container.sh [-v] (stage|start|stop|restart|status|help)**
**actions:**
 **stage downloads all necessary images to local storage**
 **start creates a container network and starts containers**
 **stop stops running containers without removing them**
 **destroy stops and removes the containers, the network and volumes created**
 **restart simply restarts all the stack containers**
 **status check the status of the stack containers**
**clear all documents in logs and metrics indexes**
 **help print this message**
**flags:**
 **-v enable verbose output**</code></pre>
<h2 class="font-bold text-2xl md:text-4xl relative"><span id="getting-started" class="absolute -top-32"></span>Getting Started</h2>
<p>Now that we’ve walked through the project overview and the shell script, let’s go through the process of standing up your own stack.</p>
<h3 class="font-bold leading-tight text-xl md:text-3xl relative"><span id="updating-variables" class="absolute -top-32"></span>Updating variables</h3>
<p>All of the variables are controlled in an environment file ( <strong>.env</strong> ) that is at the root of the repository. The only things that you must change are the default usernames and passwords for <strong>elastic</strong> and <strong>kibana</strong>.</p>
<p>Open the <strong>.env</strong> file with whatever text editor you’re most comfortable with and update the <strong>ELASTIC_PASSWORD</strong> and <strong>KIBANA_PASSWORD</strong> variables from <strong>changeme</strong> to something secure. If you do not update the credentials from the defaults in the <strong>.env</strong> file, the script will exit.</p>
<p>If you want to change the other variables (such as the stack version), you can do so in this file.</p>
<h3 class="font-bold leading-tight text-xl md:text-3xl relative"><span id="starting-the-elastic-stack" class="absolute -top-32"></span>Starting the Elastic Stack</h3>
<p>Starting the project containers is as simple as running the <strong>elastic-container.sh</strong> shell script with the start option.</p>
<pre><code>**$ ./elastic-container.sh start**

**Starting Elastic Stack network and containers
[+] Running 7/8
⠿ Network elastic-container\_default Created 0.0s
⠿ Volume "elastic-container\_certs" Created 0.0s
⠿ Volume "elastic-container\_esdata01" Created 0.0s
⠿ Volume "elastic-container\_kibanadata" Created 0.0s
⠿ Container elasticsearch-security-setup Waiting 2.0s
⠿ Container elasticsearch Created 0.0s
⠿ Container kibana Created 0.1s
⠿ Container fleet-server Created 0.2s

Attempting to enable the Detection Engine and Prebuilt-Detection Rules
Kibana is up. Proceeding
Detection engine enabled. Installing prepackaged rules.
Prepackaged rules installed!
Waiting 40 seconds for Fleet Server setup
Populating Fleet Settings
READY SET GO!

Browse to https://localhost:5601
Username: elastic
Passphrase: you-changed-me-from-the-default-right?**</code></pre>
<h3 class="font-bold leading-tight text-xl md:text-3xl relative"><span id="accessing-the-elastic-stack" class="absolute -top-32"></span>Accessing the Elastic Stack</h3>
<p>Once the containers have all downloaded and started, you’ll get an output that tells you to browse to <strong><a href="https://localhost:5601/">https://localhost:5601</a></strong>.</p>
<p><strong>Note:</strong> You’ll need to accept the self-signed TLS certificate.</p>
<h2 class="font-bold text-2xl md:text-4xl relative"><span id="enabling-the-platinum-features" class="absolute -top-32"></span>Enabling the Platinum Features</h2>
<p>Enabling the Platinum license features are completely optional. Security features, like anti-malware, EDR, EPP, etc. are included in the Basic license. Memory, behavior, and ransomware protections are Platinum license features. If you want to change your license, we can do that with the <strong>.env</strong> file or from within Kibana. You can update to Elastic Platinum for 30-days.</p>
<p>If you want to use the <strong>.env</strong> file so that the features are enabled when the stack is built, change <strong>LICENSE=basic</strong> to <strong>LICENSE=trial</strong> and then start the project as normal.</p>
<p>If you prefer to use Kibana, click on the hamburger menu, and then click on Stack Management.</p>
<p></p><figure style="display: flex; flex-direction: column; align-items: center;"><img alt="Access Stack Management from Kibana" loading="lazy" width="510" height="1276" decoding="async" data-nimg="1" class="cursor-zoom-in" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2Fimage5.jpg&amp;w=1080&amp;q=90" style="object-fit: contain; position: relative;"><figcaption style="color: lightgray; font-style: italic;">Access Stack Management from Kibana</figcaption></figure><p></p>
<p>Click on License Management and then “Start a 30-day trial”.</p>
<p></p><figure style="display: flex; flex-direction: column; align-items: center;"><img alt="Start a 30-day trial" loading="lazy" width="1440" height="1217" decoding="async" data-nimg="1" class="cursor-zoom-in" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2Fimage24.png&amp;w=3840&amp;q=90" style="object-fit: contain; position: relative;"><figcaption style="color: lightgray; font-style: italic;">Start a 30-day trial</figcaption></figure><p></p>
<h2 class="font-bold text-2xl md:text-4xl relative"><span id="creating-a-fleet-policy" class="absolute -top-32"></span>Creating a Fleet policy</h2>
<p>Now that we have the entire Elastic Stack up and running, we can make a <a href="https://www.elastic.co/guide/en/kibana/current/fleet.html">Fleet</a> policy. Fleet is a subroutine of an <a href="https://www.elastic.co/elastic-agent">Elastic Agent</a> (which was built when we ran the <strong>start</strong> option in the shell script) that enables you to manage other Elastic Agents, policies, and integrations.</p>
<blockquote>
<p>Fleet is managed in Kibana, the UI that allows you to interact with data stored in Elasticsearch and manage your Elastic stack. If you’re interested in learning more about Kibana, check out the <a href="https://www.elastic.co/training/free#quick-starts">free</a> <a href="https://www.elastic.co/training/free#how-to">training</a> <a href="https://www.elastic.co/training/free#fundamentals">videos</a>.</p>
</blockquote>
<p>Log into your Kibana instance and click on the “hamburger” menu on the top left, and navigate down to “Fleet”, under the “Management” section.</p>
<p></p><figure style="display: flex; flex-direction: column; align-items: center;"><img alt="Accessing Fleet" loading="lazy" width="496" height="1268" decoding="async" data-nimg="1" class="cursor-zoom-in" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2Fimage17.jpg&amp;w=1080&amp;q=90" style="object-fit: contain; position: relative;"><figcaption style="color: lightgray; font-style: italic;">Accessing Fleet</figcaption></figure><p></p>
<p>Next, click on the “Agent policies” tab and then the “Create agent policy” button.</p>
<p></p><figure style="display: flex; flex-direction: column; align-items: center;"><img alt="Create agent policy" loading="lazy" width="1440" height="501" decoding="async" data-nimg="1" class="cursor-zoom-in" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2Fimage27.png&amp;w=3840&amp;q=90" style="object-fit: contain; position: relative;"><figcaption style="color: lightgray; font-style: italic;">Create agent policy</figcaption></figure><p></p>
<p>Give your new policy a name and a description (optional). Normally, we uncheck the “Collect agent logs” and “Collect agent metrics” options because it’s additional data going to the stack that we generally don’t need for our specific use-case. If you’re doing troubleshooting or interested in what’s happening behind the scenes, this data can help you understand that.</p>
<p></p><figure style="display: flex; flex-direction: column; align-items: center;"><img alt="Defining the agent policy" loading="lazy" width="804" height="1440" decoding="async" data-nimg="1" class="cursor-zoom-in" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2FAgent_policies_-_Fleet_-_Elastic.jpg&amp;w=1920&amp;q=90" style="object-fit: contain; position: relative;"><figcaption style="color: lightgray; font-style: italic;">Defining the agent policy</figcaption></figure><p></p>
<p>Next, click on your new policy and the blue “Add integration” button.</p>
<p></p><figure style="display: flex; flex-direction: column; align-items: center;"><img alt="Open the Fleet policy" loading="lazy" width="1440" height="509" decoding="async" data-nimg="1" class="cursor-zoom-in" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2Fimage15.png&amp;w=3840&amp;q=90" style="object-fit: contain; position: relative;"><figcaption style="color: lightgray; font-style: italic;">Open the Fleet policy</figcaption></figure><p></p>
<p></p><figure style="display: flex; flex-direction: column; align-items: center;"><img alt="Add integrations" loading="lazy" width="1440" height="866" decoding="async" data-nimg="1" class="cursor-zoom-in" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2Fimage3.jpg&amp;w=3840&amp;q=90" style="object-fit: contain; position: relative;"><figcaption style="color: lightgray; font-style: italic;">Add integrations</figcaption></figure><p></p>
<p>There are hundreds of integrations, but the ones that we’re most interested in for this blog are for Elastic Security.</p>
<p>To install Elastic Security, simply click on the tile on the main integrations page or search for “security”.</p>
<p></p><figure style="display: flex; flex-direction: column; align-items: center;"><img alt="Endpoint and Cloud Security integration" loading="lazy" width="1440" height="532" decoding="async" data-nimg="1" class="cursor-zoom-in" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2Fimage16.png&amp;w=3840&amp;q=90" style="object-fit: contain; position: relative;"><figcaption style="color: lightgray; font-style: italic;">Endpoint and Cloud Security integration</figcaption></figure><p></p>
<p>Next, click the “Add Endpoint and Cloud Security” button to install this integration into the policy we just created.</p>
<p></p><figure style="display: flex; flex-direction: column; align-items: center;"><img alt="Add Endpoint and Cloud Security" loading="lazy" width="1440" height="751" decoding="async" data-nimg="1" class="cursor-zoom-in" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2Fimage4.jpg&amp;w=3840&amp;q=90" style="object-fit: contain; position: relative;"><figcaption style="color: lightgray; font-style: italic;">Add Endpoint and Cloud Security</figcaption></figure><p></p>
<p>Name the integration and click the blue “Save and continue” button.</p>
<p></p><figure style="display: flex; flex-direction: column; align-items: center;"><img alt="Save the integration to the policy" loading="lazy" width="1300" height="1440" decoding="async" data-nimg="1" class="cursor-zoom-in" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2Fimage1.jpg&amp;w=3840&amp;q=90" style="object-fit: contain; position: relative;"><figcaption style="color: lightgray; font-style: italic;">Save the integration to the policy</figcaption></figure><p></p>
<blockquote>
<p>While the Endpoint and Cloud Security and System integrations will collect security related logs, if you’re using Sysmon on a Windows host, you may want to add the “Windows” integration to collect those logs.</p>
</blockquote>
<p>Once the integration is installed, you’ll be prompted to add more Agents or to do that later. Select the “Add Elastic Agent later” option so we can make a few more changes to our policy.</p>
<p></p><figure style="display: flex; flex-direction: column; align-items: center;"><img alt="Add Elastic Agents later" loading="lazy" width="1440" height="359" decoding="async" data-nimg="1" class="cursor-zoom-in" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2Fimage19.jpg&amp;w=3840&amp;q=90" style="object-fit: contain; position: relative;"><figcaption style="color: lightgray; font-style: italic;">Add Elastic Agents later</figcaption></figure><p></p>
<p>Now we’ll be dropped back to our policy page.</p>
<p>We should have two integrations for our policy: <strong>security</strong> and <strong>system-1</strong>.</p>
<p></p><figure style="display: flex; flex-direction: column; align-items: center;"><img alt="Reviewing the Windows policy" loading="lazy" width="804" height="1440" decoding="async" data-nimg="1" class="cursor-zoom-in" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2FAgent_policies_-_Fleet_-_Elastic.jpg&amp;w=1920&amp;q=90" style="object-fit: contain; position: relative;"><figcaption style="color: lightgray; font-style: italic;">Reviewing the Windows policy</figcaption></figure><p></p>
<p>Before we add any agents, we’ll want to set our Elastic Agent to Detect (so that it allows the malware to completely execute), register the Elastic Agent as a trusted AV solution (Windows only), and instruct the Endpoint and Cloud Security integration to collect memory samples from security events. This is tremendously helpful for “fileless” malware that injects directly into memory, like Cobalt Strike.</p>
<blockquote>
<p>If you want to learn more about extracting malware beacons from events generated by the Elastic Agent, check out our other <a href="https://www.elastic.co/security-labs/collecting-cobalt-strike-beacons-with-the-elastic-stack">publications</a> and <a href="https://github.com/elastic/malware-exquacker">repositories</a>.</p>
</blockquote>
<p>To allow the malware to continue to execute, on your “Windows” policy page, click on the name of the integration (“security” in our example), set the Protection level to “Detect”.</p>
<p></p><figure style="display: flex; flex-direction: column; align-items: center;"><img alt="Setting the Protection level to Detect" loading="lazy" width="1440" height="633" decoding="async" data-nimg="1" class="cursor-zoom-in" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2Fimage25.jpg&amp;w=3840&amp;q=90" style="object-fit: contain; position: relative;"><figcaption style="color: lightgray; font-style: italic;">Setting the Protection level to Detect</figcaption></figure><p></p>
<p>Repeat these steps for the Ransomware, Memory threat protections, and Malicious behavior sections.</p>
<blockquote>
<p>We’re setting the Elastic Agent to Detect so that the malware we’re detonating will run completely so that we can analyze the entire execution chain. If you want the malware to be stopped, you can leave this in Prevent mode.</p>
</blockquote>
<p>Next, scroll to the bottom and select the “Register as antivirus” toggle and click on the “Show advanced settings” hyperlink.</p>
<p></p><figure style="display: flex; flex-direction: column; align-items: center;"><img alt="Register as antivirus" loading="lazy" width="1307" height="1440" decoding="async" data-nimg="1" class="cursor-zoom-in" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2Fimage18.jpg&amp;w=3840&amp;q=90" style="object-fit: contain; position: relative;"><figcaption style="color: lightgray; font-style: italic;">Register as antivirus</figcaption></figure><p></p>
<p>Scroll down to <strong>windows.advanced.memory_protection.shellcode_collect_sample</strong> , <strong>windows.advanced.memory_protection.memory_scan_collect_sample</strong> , and <strong>windows.advanced.memory_protection.shellcode_enhanced_pe_parsing</strong> options and set the value to <strong>true</strong>.</p>
<p></p><figure style="display: flex; flex-direction: column; align-items: center;"><img alt="Enabling sample collection" loading="lazy" width="1440" height="452" decoding="async" data-nimg="1" class="cursor-zoom-in" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2Fimage26.jpg&amp;w=3840&amp;q=90" style="object-fit: contain; position: relative;"><figcaption style="color: lightgray; font-style: italic;">Enabling sample collection</figcaption></figure><p></p>
<blockquote>
<p>As mentioned above, these steps are for labs, sandboxes, testing, etc. These settings can generate a lot of data, so setting these for production will need resourcing and sizing considerations.</p>
</blockquote>
<p>If you’re making a policy for Linux or macOS, repeat these for the proper OS.</p>
<p>Once we’re done with all of the post-installation configurations, we can click the blue Save integration button.</p>
<h2 class="font-bold text-2xl md:text-4xl relative"><span id="enabling-elastics-prebuilt-detection-rules" class="absolute -top-32"></span>Enabling Elastic’s Prebuilt Detection Rules</h2>
<p>Now that we have created our Fleet agent policy we need to enable the set of pre-built detection rules associated with the OS or platform we will be deploying on (e.g Windows). To do this you will need to go to the Alerts page within the security app.</p>
<p>Click on the hamburger menu and select Alerts, under the Security solution.</p>
<p></p><figure style="display: flex; flex-direction: column; align-items: center;"><img alt="Access the Alerts section" loading="lazy" width="492" height="1302" decoding="async" data-nimg="1" class="cursor-zoom-in" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2FHome_-_Elastic.jpg&amp;w=1080&amp;q=90" style="object-fit: contain; position: relative;"><figcaption style="color: lightgray; font-style: italic;">Access the Alerts section</figcaption></figure><p></p>
<p>Next, click on the blue Manage Rules button.</p>
<p></p><figure style="display: flex; flex-direction: column; align-items: center;"><img alt="Access the Manage rules interface" loading="lazy" width="1440" height="537" decoding="async" data-nimg="1" class="cursor-zoom-in" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2FAlerts_-_Kibana.jpg&amp;w=3840&amp;q=90" style="object-fit: contain; position: relative;"><figcaption style="color: lightgray; font-style: italic;">Access the Manage rules interface</figcaption></figure><p></p>
<p>Once on the Rules page you can update all of the prebuilt rules provided by Elastic by clicking on the “Update Elastic prebuilt rules” button. The update framework is enabled when you go into the “Manage rules” section for the first time, if the “Update Elastic prebuilt rules” button isn’t present, refresh the screen.</p>
<p></p><figure style="display: flex; flex-direction: column; align-items: center;"><img alt="Update Elastic prebuilt rules" loading="lazy" width="1440" height="655" decoding="async" data-nimg="1" class="cursor-zoom-in" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2FRules_-_Kibana.jpg&amp;w=3840&amp;q=90" style="object-fit: contain; position: relative;"><figcaption style="color: lightgray; font-style: italic;">Update Elastic prebuilt rules</figcaption></figure><p></p>
<p>Once the rules have been updated, you can browse the available detection rules, search them by a number of different patterns or simply filter by tag, which is what we will do here by searching for Windows rules.</p>
<p></p><figure style="display: flex; flex-direction: column; align-items: center;"><img alt="Filter for Windows rules" loading="lazy" width="1440" height="287" decoding="async" data-nimg="1" class="cursor-zoom-in" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2FRules_-_Kibana-2.jpg&amp;w=3840&amp;q=90" style="object-fit: contain; position: relative;"><figcaption style="color: lightgray; font-style: italic;">Filter for Windows rules</figcaption></figure><p></p>
<p>Now we can select all of the Windows rules.</p>
<p></p><figure style="display: flex; flex-direction: column; align-items: center;"><img alt="Selecting all Windows rules" loading="lazy" width="1428" height="426" decoding="async" data-nimg="1" class="cursor-zoom-in" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2FRules_-_Kibana-3.jpg&amp;w=3840&amp;q=90" style="object-fit: contain; position: relative;"><figcaption style="color: lightgray; font-style: italic;">Selecting all Windows rules</figcaption></figure><p></p>
<p>Once all of the rules have been selected, we can bulk enable them.</p>
<p></p><figure style="display: flex; flex-direction: column; align-items: center;"><img alt="Bulk enable Windows rules" loading="lazy" width="698" height="894" decoding="async" data-nimg="1" class="cursor-zoom-in" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2FRules_-_Kibana-4.jpg&amp;w=1920&amp;q=90" style="object-fit: contain; position: relative;"><figcaption style="color: lightgray; font-style: italic;">Bulk enable Windows rules</figcaption></figure><p></p>
<blockquote>
<p>As the Elastic Container Project runs completely inside single Docker containers, performance impacts could be noticed if you enable all of the rules available. Explore the different rules and enable or disable them based on your infrastructure and use cases.</p>
</blockquote>
<p>After we have enabled these rules they will be live and will be run against the data your endpoint agent sends into your stack. When the Detection Engine rules are triggered, they will be raised in the Alerts page in the Security Solution.</p>
<h2 class="font-bold text-2xl md:text-4xl relative"><span id="enrolling-an-elastic-agent" class="absolute -top-32"></span>Enrolling an Elastic Agent</h2>
<p>Still in Fleet, we have several ways to add an Elastic Agent. The most straightforward is from within the policy that we want to enroll an Elastic Agent into (otherwise you have to specify which policy you want to use). It doesn’t really matter which approach you use, but clicking on the Actions button and then Add agent works from just about anywhere in Fleet.</p>
<p></p><figure style="display: flex; flex-direction: column; align-items: center;"><img alt="Adding Elastic Agent" loading="lazy" width="394" height="396" decoding="async" data-nimg="1" class="cursor-zoom-in" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2Fimage8.jpg&amp;w=828&amp;q=90" style="object-fit: contain; position: relative;"><figcaption style="color: lightgray; font-style: italic;">Adding Elastic Agent</figcaption></figure><p></p>
<p>Scroll down and click on the OS that you’re going to be installing the Elastic Agent on, and copy/paste the instructions directly into a terminal window on the host you’re going to be installing the agent onto. Note, if you’re using Windows, use a Powershell CLI that is running as (or elevated to) an account with administrative entitlements.</p>
<p></p><figure style="display: flex; flex-direction: column; align-items: center;"><img alt="Powershell commands to add an Elastic Agent" loading="lazy" width="1440" height="782" decoding="async" data-nimg="1" class="cursor-zoom-in" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2Fimage22.png&amp;w=3840&amp;q=90" style="object-fit: contain; position: relative;"><figcaption style="color: lightgray; font-style: italic;">Powershell commands to add an Elastic Agent</figcaption></figure><p></p>
<p>Of note, because all of our TLS certificates are self-signed, we need to append the <strong>–insecure</strong> flag. This is unnecessary if you are using trusted certificates.</p>
<pre><code>**.\elastic-agent.exe install --url=https://[stack-ip]:8220 --enrollment-token=[token] --insecure**</code></pre>
<p></p><figure style="display: flex; flex-direction: column; align-items: center;"><img alt="Enrolling the Elastic Agent into Fleet" loading="lazy" width="1440" height="448" decoding="async" data-nimg="1" class="cursor-zoom-in" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2Fimage23.jpg&amp;w=3840&amp;q=90" style="object-fit: contain; position: relative;"><figcaption style="color: lightgray; font-style: italic;">Enrolling the Elastic Agent into Fleet</figcaption></figure><p></p>
<p>Back in Kibana, we can see confirmation that the Elastic Agent installed on the host and that data is being recorded into Elasticsearch.</p>
<p></p><figure style="display: flex; flex-direction: column; align-items: center;"><img alt="Verifying Elastic Agent enrollment" loading="lazy" width="1440" height="1325" decoding="async" data-nimg="1" class="cursor-zoom-in" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2Fimage2.jpg&amp;w=3840&amp;q=90" style="object-fit: contain; position: relative;"><figcaption style="color: lightgray; font-style: italic;">Verifying Elastic Agent enrollment</figcaption></figure><p></p>
<p>We can see that the Elastic Agent is reporting into Fleet and is healthy.</p>
<p></p><figure style="display: flex; flex-direction: column; align-items: center;"><img alt="Verify Elastic Agent health" loading="lazy" width="1440" height="542" decoding="async" data-nimg="1" class="cursor-zoom-in" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2Fimage28.png&amp;w=3840&amp;q=90" style="object-fit: contain; position: relative;"><figcaption style="color: lightgray; font-style: italic;">Verify Elastic Agent health</figcaption></figure><p></p>
<p>If we go into the Discover tab, we can see various event types reporting into Elasticsearch. We can generate some test data by opening <strong>notepad.exe</strong> , <strong>calc.exe</strong> , and <strong>ping.exe -t <a href="http://www.elastic.co/">www.elastic.co</a></strong> on the host. From Discover, we can make a simple query to validate that we’re seeing the data:</p>
<pre><code>**process.name.caseless : (notepad.exe or ping.exe or calc.exe)**</code></pre>
<p></p><figure style="display: flex; flex-direction: column; align-items: center;"><img alt="Verifying data is being sent to Elasticsearch" loading="lazy" width="1440" height="606" decoding="async" data-nimg="1" class="cursor-zoom-in" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2Fimage7.png&amp;w=3840&amp;q=90" style="object-fit: contain; position: relative;"><figcaption style="color: lightgray; font-style: italic;">Verifying data is being sent to Elasticsearch</figcaption></figure><p></p>
<p>Now that we’ve validated that we’re seeing data. Let's fire some malware!</p>
<h2 class="font-bold text-2xl md:text-4xl relative"><span id="test-fire-some-malware" class="absolute -top-32"></span>Test fire some malware</h2>
<p>There are a lot of places you can download malware from, but for this test, we’ll simply use the industry standard <a href="https://www.eicar.org/download-anti-malware-testfile/">EICAR anti malware test file</a> to check the functionality.</p>
<p>The EICAR test is a file that is universally identified by security vendors and is used to test the operation of anti malware software and platforms. It contains a single string and is non-malicious.</p>
<p>From within the Windows host, we’ll use Powershell to download the EICAR file.</p>
<pre><code>**Invoke-WebRequest -Uri "https://secure.eicar.org/eicar.com.txt" -OutFile "eicar.txt"**</code></pre>
<p>As expected, the event was immediately identified by the Elastic Agent’s security integration.</p>
<p></p><figure style="display: flex; flex-direction: column; align-items: center;"><img alt="Elastic Security detected the EICAR test file" loading="lazy" width="761" height="284" decoding="async" data-nimg="1" class="cursor-zoom-in" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2Fimage29.jpg&amp;w=1920&amp;q=90" style="object-fit: contain; position: relative;"><figcaption style="color: lightgray; font-style: italic;">Elastic Security detected the EICAR test file</figcaption></figure><p></p>
<p>After a few minutes, the events are recorded into the Security Solution within Kibana. You can get there by clicking on the hamburger menu and then clicking on the Alerts section.</p>
<p></p><figure style="display: flex; flex-direction: column; align-items: center;"><img alt="Viewing Security alerts" loading="lazy" width="496" height="530" decoding="async" data-nimg="1" class="cursor-zoom-in" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2Fimage9.jpg&amp;w=1080&amp;q=90" style="object-fit: contain; position: relative;"><figcaption style="color: lightgray; font-style: italic;">Viewing Security alerts</figcaption></figure><p></p>
<p>Here we can see the alert populated.</p>
<p></p><figure style="display: flex; flex-direction: column; align-items: center;"><img alt="Alert in the Security Solution" loading="lazy" width="1440" height="532" decoding="async" data-nimg="1" class="cursor-zoom-in" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2Fimage11.png&amp;w=3840&amp;q=90" style="object-fit: contain; position: relative;"><figcaption style="color: lightgray; font-style: italic;">Alert in the Security Solution</figcaption></figure><p></p>
<p>If we click on the Analyzer button, we can dig into the event to identify the process that generated the event.</p>
<p></p><figure style="display: flex; flex-direction: column; align-items: center;"><img alt="Analyzer button" loading="lazy" width="754" height="262" decoding="async" data-nimg="1" class="cursor-zoom-in" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2Fimage12.jpg&amp;w=1920&amp;q=90" style="object-fit: contain; position: relative;"><figcaption style="color: lightgray; font-style: italic;">Analyzer button</figcaption></figure><p></p>
<p>In our example, we can see <strong>powershell.exe</strong> generated the event and this includes the correlated network events - <strong>secure.eicar.org</strong> , which is where the EICAR test file was downloaded from.</p>
<p></p><figure style="display: flex; flex-direction: column; align-items: center;"><img alt="Analyzer view" loading="lazy" width="1440" height="989" decoding="async" data-nimg="1" class="cursor-zoom-in" src="https://www.elastic.co/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Fthe-elastic-container-project%2Fimage13.jpg&amp;w=3840&amp;q=90" style="object-fit: contain; position: relative;"><figcaption style="color: lightgray; font-style: italic;">Analyzer view</figcaption></figure><p></p>
<h2 class="font-bold text-2xl md:text-4xl relative"><span id="summary" class="absolute -top-32"></span>Summary</h2>
<p>In this publication, we introduced you to the Elastic Stack and an open source project that can be used to quickly and securely stand up the entire stack for testing, labs, and security research.</p>
<p>Kibana and the Security Solution are powerful tools that are built by incident responders, threat hunters, and intelligence analysts with security practitioners in mind. To learn more about how to use these tools, <a href="https://www.elastic.co/training/">Elastic has some great (free and paid) training</a> that can help learn how to use Kibana for threat hunting.</p></div></div></div><div class="hidden lg:flex lg:col-span-1 text-sm lg:flex-col lg:space-y-6"><div class="toc"><h4 class="font-bold leading-tight text-lg md:text-2xl mb-3">Jump to section</h4><ul class="flex flex-col space-y-2"><li><a class="flex items-center space-x-1 hover:text-white" href="https://www.elastic.co/security-labs/the-elastic-container-project#preamble"><span>Preamble</span></a></li><li><a class="flex items-center space-x-1 hover:text-white" href="https://www.elastic.co/security-labs/the-elastic-container-project#the-elastic-stack"><span>The Elastic&nbsp;Stack</span></a></li><li><a class="flex items-center space-x-1 hover:text-white ml-4" href="https://www.elastic.co/security-labs/the-elastic-container-project#elasticsearch"><span>Elasticsearch</span></a></li><li><a class="flex items-center space-x-1 hover:text-white ml-4" href="https://www.elastic.co/security-labs/the-elastic-container-project#kibana"><span>Kibana</span></a></li><li><a class="flex items-center space-x-1 hover:text-white ml-4" href="https://www.elastic.co/security-labs/the-elastic-container-project#the-elastic-agent"><span>The Elastic&nbsp;Agent</span></a></li><li><a class="flex items-center space-x-1 hover:text-white" href="https://www.elastic.co/security-labs/the-elastic-container-project#the-elastic-container-project"><span>The Elastic Container&nbsp;Project</span></a></li><li><a class="flex items-center space-x-1 hover:text-white ml-4" href="https://www.elastic.co/security-labs/the-elastic-container-project#introduction"><span>Introduction</span></a></li><li><a class="flex items-center space-x-1 hover:text-white ml-4" href="https://www.elastic.co/security-labs/the-elastic-container-project#prerequisites"><span>Prerequisites</span></a></li><li><a class="flex items-center space-x-1 hover:text-white ml-8" href="https://www.elastic.co/security-labs/the-elastic-container-project#macos"><span>macOS</span></a></li><li><a class="flex items-center space-x-1 hover:text-white ml-8" href="https://www.elastic.co/security-labs/the-elastic-container-project#linux"><span>Linux</span></a></li></ul><button class="border-t border-white/20 w-full mt-3 py-2 flex items-center space-x-1 text-xs font-medium uppercase tracking-wide hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" class="w-3 h-3"><path d="M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"></path></svg><span>Show more</span></button></div><div class="bg-zinc-900 border border-zinc-800 drop-shadow-lg p-5 md:p-2 sm:p-4 md:px-6 md:py-4 rounded-xl"><h4 class="font-bold leading-tight text-lg md:text-2xl mb-3">Elastic Security Labs&nbsp;Newsletter</h4><div><a target="_blank" class="button inline-flex" href="https://www.elastic.co/elastic-security-labs/newsletter?utm_source=security-labs">Sign Up</a></div></div></div></div><div class="bg-zinc-900 border border-zinc-800 drop-shadow-lg p-5 md:p-2 sm:p-4 md:px-6 md:py-4 rounded-xl my-5 md:my-10 max-w-3xl mx-auto flex flex-col items-center shadow-2xl"><h4 class="font-bold leading-tight text-lg md:text-2xl">Share this article</h4><div class="flex flex-wrap items-center justify-center mt-4 space-x-4"><a class="flex items-center space-x-2 button" href="https://twitter.com/intent/tweet?text=The%20Elastic%20Container%20Project%20for%20Security%20Research&amp;url=https://www.elastic.co/security-labs/the-elastic-container-project" target="_blank" rel="noopener noreferrer" aria-label="Share this article on X" title="Share this article on X"><svg class="w-4 h-4" viewBox="0 0 24 24"><path fill="currentColor" d="M23.954 4.569c-.885.389-1.83.653-2.825.772a4.98 4.98 0 002.187-2.746 9.955 9.955 0 01-3.157 1.204 4.98 4.98 0 00-8.49 4.54A14.128 14.128 0 011.69 3.05a4.98 4.98 0 001.54 6.638A4.94 4.94 0 011.2 8.62v.06a4.98 4.98 0 004 4.87 4.94 4.94 0 01-2.24.086 4.98 4.98 0 004.64 3.45A9.97 9.97 0 010 20.35a14.075 14.075 0 007.59 2.22c9.16 0 14.17-7.583 14.17-14.17 0-.217-.005-.434-.015-.65a10.128 10.128 0 002.485-2.58l-.001-.001z"></path></svg><span>X</span></a><a class="flex items-center space-x-2 button" href="https://www.facebook.com/sharer/sharer.php?u=https://www.elastic.co/security-labs/the-elastic-container-project" target="_blank" rel="noopener noreferrer" aria-label="Share this article on Facebook" title="Share this article on Facebook"><svg class="w-4 h-4" viewBox="0 0 24 24"><path fill="currentColor" d="M22.5 12c0-5.799-4.701-10.5-10.5-10.5S1.5 6.201 1.5 12c0 5.301 3.901 9.699 9 10.401V14.4h-2.7v-2.7h2.7v-2.1c0-2.7 1.8-4.2 4.2-4.2 1.2 0 2.1.1 2.4.2v2.4h-1.5c-1.2 0-1.5.6-1.5 1.5v1.8h3l-.3 2.7h-2.7V22C18.599 21.3 22.5 17.301 22.5 12z"></path></svg><span>Facebook</span></a><a class="flex items-center space-x-2 button" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.elastic.co/security-labs/the-elastic-container-project&amp;title=The%20Elastic%20Container%20Project%20for%20Security%20Research" target="_blank" rel="noopener noreferrer" aria-label="Share this article on LinkedIn" title="Share this article on LinkedIn"><svg class="w-4 h-4" viewBox="0 0 24 24"><path fill="currentColor" d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"></path></svg><span>LinkedIn</span></a><a class="flex items-center space-x-2 button" href="https://reddit.com/submit?url=https://www.elastic.co/security-labs/the-elastic-container-project&amp;title=The%20Elastic%20Container%20Project%20for%20Security%20Research" target="_blank" rel="noopener noreferrer" aria-label="Share this article on Reddit" title="Share this article on Reddit"><svg class="w-4 h-4" viewBox="0 0 24 24"><path fill-rule="evenodd" clip-rule="evenodd" d="M24 12C24 18.6274 18.6274 24 12 24C5.37258 24 0 18.6274 0 12C0 5.37258 5.37258 0 12 0C18.6274 0 24 5.37258 24 12ZM19.6879 11.0584C19.8819 11.3352 19.9916 11.6622 20.004 12C20.0091 12.3306 19.9205 12.656 19.7485 12.9384C19.5765 13.2208 19.3281 13.4488 19.032 13.596C19.0455 13.7717 19.0455 13.9483 19.032 14.124C19.032 16.812 15.9 18.996 12.036 18.996C8.172 18.996 5.04 16.812 5.04 14.124C5.02649 13.9483 5.02649 13.7717 5.04 13.596C4.80919 13.49 4.6042 13.335 4.43923 13.1419C4.27427 12.9487 4.15327 12.722 4.08462 12.4775C4.01598 12.2329 4.00133 11.9764 4.04169 11.7256C4.08205 11.4748 4.17646 11.2358 4.31837 11.0251C4.46028 10.8145 4.6463 10.6372 4.86354 10.5056C5.08078 10.3739 5.32404 10.2911 5.57646 10.2629C5.82889 10.2346 6.08444 10.2616 6.32541 10.3419C6.56638 10.4222 6.78701 10.5539 6.972 10.728C8.35473 9.79023 9.98146 9.27718 11.652 9.252L12.54 5.088C12.55 5.03979 12.5694 4.99405 12.5972 4.95341C12.625 4.91277 12.6605 4.87805 12.7018 4.85127C12.7431 4.82448 12.7894 4.80615 12.8378 4.79735C12.8862 4.78855 12.9359 4.78945 12.984 4.8L15.924 5.388C16.0676 5.14132 16.2944 4.9539 16.5637 4.85937C16.833 4.76484 17.1272 4.7694 17.3934 4.87222C17.6597 4.97505 17.8806 5.1694 18.0164 5.42041C18.1523 5.67141 18.1942 5.96262 18.1348 6.24177C18.0753 6.52092 17.9182 6.76972 17.6918 6.94352C17.4654 7.11732 17.1845 7.20473 16.8995 7.19006C16.6144 7.1754 16.3439 7.05962 16.1366 6.8635C15.9292 6.66738 15.7985 6.40378 15.768 6.12L13.2 5.58L12.42 9.324C14.0702 9.3594 15.6749 9.87206 17.04 10.8C17.2839 10.566 17.5902 10.4074 17.9221 10.3436C18.254 10.2797 18.5973 10.3132 18.9106 10.4401C19.2239 10.5669 19.4939 10.7817 19.6879 11.0584ZM8.20624 12.5333C8.07438 12.7307 8.004 12.9627 8.004 13.2C8.004 13.5183 8.13043 13.8235 8.35547 14.0485C8.58051 14.2736 8.88574 14.4 9.204 14.4C9.44134 14.4 9.67335 14.3296 9.87068 14.1978C10.068 14.0659 10.2218 13.8785 10.3127 13.6592C10.4035 13.4399 10.4272 13.1987 10.3809 12.9659C10.3346 12.7331 10.2204 12.5193 10.0525 12.3515C9.8847 12.1836 9.67089 12.0694 9.43811 12.0231C9.20533 11.9768 8.96405 12.0005 8.74478 12.0913C8.52551 12.1822 8.33809 12.336 8.20624 12.5333ZM12.012 17.424C13.0771 17.4681 14.1246 17.1416 14.976 16.5V16.548C15.0075 16.5173 15.0327 16.4806 15.05 16.4402C15.0674 16.3997 15.0766 16.3563 15.0772 16.3122C15.0777 16.2682 15.0696 16.2245 15.0533 16.1837C15.0369 16.1428 15.0127 16.1055 14.982 16.074C14.9513 16.0425 14.9146 16.0173 14.8742 16C14.8337 15.9826 14.7903 15.9734 14.7462 15.9728C14.7022 15.9723 14.6585 15.9804 14.6177 15.9967C14.5768 16.0131 14.5395 16.0373 14.508 16.068C13.7797 16.5904 12.895 16.8487 12 16.8C11.1061 16.8399 10.2255 16.5732 9.504 16.044C9.44182 15.993 9.36289 15.9669 9.28256 15.9708C9.20222 15.9748 9.12622 16.0085 9.06935 16.0653C9.01247 16.1222 8.97879 16.1982 8.97484 16.2786C8.97089 16.3589 8.99697 16.4378 9.048 16.5C9.89937 17.1416 10.9469 17.4681 12.012 17.424ZM14.0933 14.2458C14.2907 14.3776 14.5227 14.448 14.76 14.448L14.748 14.496C14.9107 14.4978 15.0721 14.4664 15.2223 14.4038C15.3725 14.3413 15.5084 14.2488 15.6218 14.1321C15.7352 14.0154 15.8236 13.8768 15.8818 13.7248C15.9399 13.5728 15.9665 13.4106 15.96 13.248C15.96 13.0107 15.8896 12.7787 15.7578 12.5813C15.6259 12.384 15.4385 12.2302 15.2192 12.1393C14.9999 12.0485 14.7587 12.0248 14.5259 12.0711C14.2931 12.1174 14.0793 12.2316 13.9115 12.3995C13.7436 12.5673 13.6294 12.7811 13.5831 13.0139C13.5368 13.2467 13.5605 13.4879 13.6513 13.7072C13.7422 13.9265 13.896 14.1139 14.0933 14.2458Z" fill="currentColor"></path></svg><span>Reddit</span></a></div></div></article></main></main></div><next-route-announcer><p aria-live="assertive" id="__next-route-announcer__" role="alert" style="border: 0px; clip: rect(0px, 0px, 0px, 0px); height: 1px; margin: -1px; overflow: hidden; padding: 0px; position: absolute; top: 0px; width: 1px; white-space: nowrap; overflow-wrap: normal;"></p></next-route-announcer></body></html>