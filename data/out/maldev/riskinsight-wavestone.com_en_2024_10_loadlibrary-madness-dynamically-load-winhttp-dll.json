"title='LoadLibrary madness: dynamically load WinHTTP.dll - RiskInsight' description='For the last few weeks, I was developing a full custom Command and Control (C2). This C2 uses several Windows DLL for network communication and specially the WINHTTP.DLL one to handle HTTP requests used for the HTTP and HTTPS listener.As everyone knows, when developing a C2 and the corresponding agent, OPSEC must be the priority, so the agent code must rise as few (ETW) events as possible.The most common way to increase OPSEC when using external DLL is to perform dynamic loading to avoid getting the loaded DLL name in the source code. This can be done using the LoadLibrary Win32 API.' url='https://www.riskinsight-wavestone.com/en/2024/10/loadlibrary-madness-dynamically-load-winhttp-dll/' language='en-US' keywords=None robots='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' og_title='LoadLibrary madness: dynamically load WinHTTP.dll - RiskInsight' og_description='For the last few weeks, I was developing a full custom Command and Control (C2). This C2 uses several Windows DLL for network communication and specially the WINHTTP.DLL one to handle HTTP requests used for the HTTP and HTTPS listener.As everyone knows, when developing a C2 and the corresponding agent, OPSEC must be the priority, so the agent code must rise as few (ETW) events as possible.The most common way to increase OPSEC when using external DLL is to perform dynamic loading to avoid getting the loaded DLL name in the source code. This can be done using the LoadLibrary Win32 API.' og_url='https://www.riskinsight-wavestone.com/en/2024/10/loadlibrary-madness-dynamically-load-winhttp-dll/' og_image='https://www.riskinsight-wavestone.com/wp-content/uploads/2024/10/Fond.jpg' og_audio=None og_determiner=None og_locale='en_US' og_locale_alternate=None og_site_name='RiskInsight' og_video=None favicon='https://www.riskinsight-wavestone.com/wp-content/uploads/2024/02/Blogs-2024_RI-39x39.png' dc_terms_created=None dc_date_created=None dc_date=None dc_terms_type=None dc_type=None dc_terms_audience=None dc_terms_subject=None dc_subject=None dc_description=None dc_terms_keywords=None modified_time='2024-10-30T15:55:09+00:00' published_time='2024-10-30T15:52:37+00:00' article_tag=None article_section=None source_url='https://www.riskinsight-wavestone.com/en/2024/10/loadlibrary-madness-dynamically-load-winhttp-dll/' status_code=200 scrape_id='019c605b-410e-71a8-aa63-a54c49926707' num_pages=None content_type='text/html; charset=UTF-8' proxy_used='basic' timezone='America/New_York' cache_state='miss' cached_at=None credits_used=1 concurrency_limited=False concurrency_queue_duration_ms=None error=None viewport='width=device-width, initial-scale=1' twitter:label2='Est. reading time' og:url='https://www.riskinsight-wavestone.com/en/2024/10/loadlibrary-madness-dynamically-load-winhttp-dll/' og:image='https://www.riskinsight-wavestone.com/wp-content/uploads/2024/10/Fond.jpg' og:title='LoadLibrary madness: dynamically load WinHTTP.dll - RiskInsight' author='Yoann DEQUEKER' og:site_name='RiskInsight' twitter:data1='Yoann DEQUEKER' article:modified_time='2024-10-30T15:55:09+00:00' msapplication-TileImage='https://www.riskinsight-wavestone.com/wp-content/uploads/2024/02/Blogs-2024_RI.png' twitter:label1='Written by' generator='WPML ver:4.8.1 stt:1,4;' og:locale='en_US' og:type='article' og:description='For the last few weeks, I was developing a full custom Command and Control (C2). This C2 uses several Windows DLL for network communication and specially the WINHTTP.DLL one to handle HTTP requests used for the HTTP and HTTPS listener.As everyone knows, when developing a C2 and the corresponding agent, OPSEC must be the priority, so the agent code must rise as few (ETW) events as possible.The most common way to increase OPSEC when using external DLL is to perform dynamic loading to avoid getting the loaded DLL name in the source code. This can be done using the LoadLibrary Win32 API.' og:image:type='image/jpeg' og:image:height='1125' og:image:width='1688' twitter:data2='16 minutes' article:published_time='2024-10-30T15:52:37+00:00' indexId='af7590ff-8a39-4172-a74c-ee1ddc8b79b4'"