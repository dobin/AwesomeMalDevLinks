Title:
The Pool Party You Will Never Forget: New Process Injection Techniques Using Windows Thread Pools

Type:
Blog Post

Short Summary (4–8 sentences max):
- SafeBreach Labs presents “Pool Party,” a set of eight novel Windows process injection techniques that abuse user-mode thread pool internals to execute attacker-controlled code inside remote processes.  
- The work targets a gap in common EDR detection logic: allocation and write primitives are often tolerated, while detections focus heavily on classic execution primitives (e.g., CreateRemoteThread).  
- The techniques achieve execution by overwriting or inserting thread pool–related structures (worker factory start routine, task queue items, I/O completion–backed work items, and timer queue items) so that normal thread pool activity triggers shellcode.  
- Several variants are triggered by legitimate-looking actions (file I/O completion, ALPC activity, job assignment, event signaling, timer expiry), complicating behavioral detection and attribution.  
- The authors report 100% bypass success in testing against five major EDRs (Cortex, SentinelOne, CrowdStrike, MDE, Cybereason) at the time of research and performed responsible disclosure.  
- Useful for red teams and malware developers for stealthy execution primitives, and for blue teams/EDR engineers to build detections around thread pool/worker factory abuse and anomalous handle duplication.

Technical Focus:
- Windows user-mode thread pool internals (TP_POOL, work queues, helper structures)
- Worker Factory objects and syscalls (NtCreateWorkerFactory, NtQueryInformationWorkerFactory, NtSetInformationWorkerFactory)
- Remote handle duplication and object access (DuplicateHandle)
- Remote work item insertion (TP_WORK/TP_TASK, TP_DIRECT, TP_TIMER)
- I/O completion ports/queues abuse (NtSetIoCompletion, completion keys)
- Execution triggering via legitimate OS actions (I/O completion, ALPC, job objects, waits, timers)

Use Cases:
- Stealthy process injection in arbitrary Windows processes via thread pool primitives
- Building new execution primitives that avoid CreateRemoteThread-style telemetry
- Adversary emulation for validating EDR coverage on thread pool/worker factory abuse
- Detection engineering: hunting for anomalous worker factory/thread pool manipulation and suspicious handle duplication
- Research baseline for developing mitigations and telemetry around TP_* structure tampering

Keywords:
Windows thread pool, process injection, EDR bypass, worker factory, NtQueryInformationWorkerFactory, NtSetInformationWorkerFactory, NtCreateWorkerFactory, DuplicateHandle, TP_POOL, TP_WORK, TP_TASK, TP_IO, TP_DIRECT, TP_TIMER, I/O completion port, NtSetIoCompletion, ALPC, job object, wait object, shellcode execution