Title:
[Shellcode x64] Find and execute WinAPI functions with Assembly

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post explains how to write position-independent x64 Windows shellcode that manually resolves and calls WinAPI functions without relying on imports or GetProcAddress.  
- It walks through locating the Process Environment Block (PEB) via `gs:[0x60]`, traversing `PEB_LDR_DATA` module lists to find `kernel32.dll`, and parsing the in-memory PE headers to reach the Export Address Table (EAT).  
- The author demonstrates resolving `WinExec` by iterating `AddressOfNames`, matching strings (using `repe cmpsb`), then mapping name index → ordinal → function RVA → virtual address.  
- It also covers practical x64 calling convention requirements (RCX/RDX args, 16-byte stack alignment, and 32-byte shadow space) to successfully invoke `WinExec("calc.exe")`.  
- Useful for red teamers, exploit devs, and malware analysts who need to understand or implement classic API resolution techniques used in shellcode and loaders.  
- Interesting because it ties Windows internals (PEB/LDR, PE format, EAT) directly to working assembly patterns and common pitfalls like structure alignment.

Technical Focus:
- PEB access on x64 (`gs:[0x60]`) and loader structures (`PEB_LDR_DATA`, `LDR_DATA_TABLE_ENTRY`)
- Traversing `InMemoryOrderModuleList` to locate module base addresses
- In-memory PE parsing (`IMAGE_DOS_HEADER`, `e_lfanew`, PE headers)
- Export Address Table resolution (`IMAGE_EXPORT_DIRECTORY`, names/ordinals/functions arrays)
- RVA → VA calculations for exported functions
- Windows x64 calling convention (register args, stack alignment, shadow space)

Use Cases:
- Building Windows x64 shellcode that resolves APIs dynamically
- Implementing reflective loaders / minimal import-less stagers
- Malware analysis: understanding common API-hashing/name-lookup resolution patterns
- Exploit development where imports are unavailable or unreliable
- Creating test payloads (e.g., WinExec calc) for debugging shellcode execution paths

Keywords:
x64 shellcode, Windows assembly, PEB, gs segment, PEB_LDR_DATA, LDR_DATA_TABLE_ENTRY, InMemoryOrderModuleList, kernel32.dll, PE headers, IMAGE_DOS_HEADER, e_lfanew, RVA, virtual address, export address table, IMAGE_EXPORT_DIRECTORY, AddressOfNames, AddressOfFunctions, AddressOfNameOrdinals, repe cmpsb, WinExec, Windows x64 calling convention, shadow space, stack alignment, NASM