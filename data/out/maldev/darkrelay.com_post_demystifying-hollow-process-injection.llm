Title:
Demystifying Hollow Process Injection

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post explains Windows process hollowing (MITRE T1055.012), a technique where an attacker creates a legitimate process in a suspended state, removes/unmaps its original image, and replaces it with a malicious PE before resuming execution.  
- It walks through a practical PoC based on the m0n0ph1/Process-Hollowing GitHub project, using `svchost.exe` as the target container and a simple `helloworld.exe` payload to demonstrate execution under a trusted process name.  
- The article breaks down key steps: creating a suspended process, reading the remote PEB to find the image base, unmapping with `NtUnmapViewOfSection`, allocating memory with `VirtualAllocEx`, copying headers/sections with `WriteProcessMemory`, handling relocations, and redirecting execution by editing thread context (`GetThreadContext`/`SetThreadContext`) before `ResumeThread`.  
- It’s useful for red teamers/pentesters and malware analysts learning classic user-mode injection tradecraft, and for defenders wanting to understand what telemetry to hunt for.  
- The main value is a clear, code-oriented explanation of the mechanics (PE layout, PEB usage, thread context manipulation) behind a common stealth execution method.

Technical Focus:
- Process hollowing / RunPE workflow
- PEB parsing and remote image base discovery
- `NtUnmapViewOfSection` and section unmapping
- Remote memory allocation and PE mapping (`VirtualAllocEx`, `WriteProcessMemory`)
- PE headers/sections copying and base relocations
- Thread context hijacking (`GetThreadContext`/`SetThreadContext`) and resuming execution

Use Cases:
- Implementing or testing process hollowing PoCs in controlled labs
- Malware analysis/training to understand hollowing artifacts and execution flow
- Building detection logic around suspicious suspended process creation + unmap/remap patterns
- EDR telemetry validation (thread context changes, remote writes, image replacement indicators)

Keywords:
process hollowing, hollow process injection, T1055.012, RunPE, svchost.exe, suspended process, CreateProcessA, CREATE_SUSPENDED, PEB, ImageBaseAddress, NtUnmapViewOfSection, ntdll.dll, VirtualAllocEx, WriteProcessMemory, GetThreadContext, SetThreadContext, ResumeThread, PE headers, section mapping, base relocations