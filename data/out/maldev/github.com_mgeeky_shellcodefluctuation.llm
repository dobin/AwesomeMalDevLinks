Title:
Shellcode Fluctuation PoC (ShellcodeFluctuation)

Type:
GitHub Tool

Short Summary (4–8 sentences max):
- This repository provides a proof-of-concept Windows shellcode loader implementing “shellcode fluctuation”: periodically encrypting shellcode in memory and toggling its page protections between RX and RW or PAGE_NOACCESS.  
- The goal is to reduce exposure to memory scanners (e.g., Moneta, pe-sieve) that look for abnormal private executable pages and can dump implants for analysis.  
- The PoC targets Cobalt Strike Beacon specifically by inline-hooking `kernel32!Sleep` to detect when the Beacon sleeps, then encrypting/decrypting the shellcode region and flipping protections around the sleep interval.  
- A PAGE_NOACCESS mode uses a Vectored Exception Handler (VEH) to catch access violations when execution resumes, restoring RX and decrypting on-demand.  
- The README also discusses residual IOCs (e.g., “modified code in kernel32.dll” due to private working-set pages) and tradeoffs of hooking/unhooking to minimize obvious trampolines.  
- Useful for red team tool developers and malware researchers building custom loaders and studying in-memory evasion vs. scanner heuristics.

Technical Focus:
- Memory protection flipping (`VirtualProtect`, RX↔RW / RX↔PAGE_NOACCESS)
- In-memory payload encryption/decryption (XOR32)
- Inline hooking / trampoline hooking of `kernel32!Sleep`
- Vectored Exception Handling (VEH) for execution resumption
- Self-injection loader pattern (`VirtualAlloc` + `memcpy` + `CreateThread`)
- Memory scanner IOC mechanics (MEM_PRIVATE within MEM_IMAGE, working set analysis)

Use Cases:
- Implement sleep-time memory masking for Beacon-like implants
- Reduce “private executable memory” findings in memory triage tools
- Experiment with RW vs. NOACCESS fluctuation strategies and their artifacts
- Study how Moneta/pe-sieve detect modified modules and injected regions
- Build/validate custom shellcode loaders with periodic in-memory obfuscation

Keywords:
Shellcode fluctuation, Cobalt Strike Beacon, sleep masking, VirtualProtect, VirtualAlloc, CreateThread, kernel32!Sleep hook, inline hook, trampoline, XOR encryption, PAGE_READWRITE, PAGE_NOACCESS, Vectored Exception Handler, access violation, Moneta, pe-sieve, MEM_PRIVATE, MEM_IMAGE, working set, in-memory evasion