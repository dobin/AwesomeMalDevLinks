# https://www.mdsec.co.uk/2022/07/part-2-how-i-met-your-beacon-cobalt-strike/

<!DOCTYPE html><!--[if lt IE 7 ]><html lang="en-GB" class="no-js ie ie6 lte7 lte8 lte9"><![endif]--><!--[if IE 7 ]><html lang="en-GB" class="no-js ie ie7 lte7 lte8 lte9"><![endif]--><!--[if IE 8 ]><html lang="en-GB" class="no-js ie ie8 lte8 lte9"><![endif]--><!--[if IE 9 ]><html lang="en-GB" class="no-js ie ie9 lte9"><![endif]--><!--[if (gt IE 9)|!(IE)]><!--><html lang="en-GB" class=" js flexbox flexboxlegacy canvas canvastext postmessage no-websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers no-applicationcache svg inlinesvg"><!--<![endif]-->
	    
	<body class="wp-singular post-template-default single single-post postid-2994 single-format-standard wp-theme-mdsec">
    <!--[if lt IE 7]>
        <div class="browse-happy">
        	 <a href="https://www.mdsec.co.uk">
				<div id="logo">Logo</div>
			</a>
        	<p>You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        </div>    	
    <![endif]-->              
	
	<!-- Site Wrapper Start --> 
	<div class="site-wrapper">
		
	<!-- Header Start --> 
	
    <!-- Header End --> 
		
		
	<div class="subnav">
		<section class="content-wrapper">
			<ul class="service-list clearfix">
				<li class="item" style="">
					<a href="https://www.mdsec.co.uk/our-services/adversary-simulation/">
						<div class="service-icon">
							<img src="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/icons/icon-adversary.svg" alt="Adversary" width="300" height="150">
						</div>
						<hgroup>
							<h2>
								Adversary Simulation
							</h2>
						</hgroup>
						<p>Our best in class red team can deliver a holistic cyber attack simulation to provide a true evaluation of your organisation’s cyber resilience.</p>
						
					</a>
				</li>
				<li class="item" style="">
					<a href="https://www.mdsec.co.uk/our-services/applicaton-security/">
						<div class="service-icon">
							<img src="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/icons/icon-application-security.svg" alt="Application Security" width="300" height="150">
						</div>
						<hgroup>
							<h2>
								Application <br>Security
							</h2>
						</hgroup>
						<p>Leverage the team behind the industry-leading Web Application and Mobile Hacker’s Handbook series.</p>
					</a>
				</li>
				<li class="item" style="">
					<a href="https://www.mdsec.co.uk/our-services/penetration-testing/">
						<div class="service-icon">
							<img src="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/icons/icon-penetration-testing.svg" alt="Penetration Testing" width="300" height="150">
						</div>
						<hgroup>
							<h2>
								Penetration <br>Testing
							</h2>
						</hgroup>
						<p>MDSec’s penetration testing team is trusted by companies from the world’s leading technology firms to global financial institutions.</p>
					</a>
				</li>
				<li class="item" style="">
					<a href="https://www.mdsec.co.uk/our-services/response/">
						<div class="service-icon">
							<img src="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/icons/icon-response.svg" alt="Response" width="300" height="150">
						</div>
						<hgroup>
							<h2>
								Response
							</h2>
						</hgroup>
						<p>Our certified team work with customers at all stages of the Incident Response lifecycle through our range of proactive and reactive services.</p>
					</a>
				</li>
			</ul>
		</section>		
	</div>
	<div class="subnav-kc">
		<section class="content-wrapper">
			<ul class="service-list clearfix">
				<li>
					<a href="https://www.mdsec.co.uk/knowledge-centre/research/">
						<hgroup>
							<h2>
								Research
							</h2>
						</hgroup>
						<p>MDSec’s dedicated research team periodically releases white papers, blog posts, and tooling.</p>
					</a>
				</li>
				<li>
					<a href="https://www.mdsec.co.uk/knowledge-centre/training/">
						<hgroup>
							<h2>
								Training
							</h2>
						</hgroup>
						<p>MDSec’s training courses are informed by our security consultancy and research functions, ensuring you benefit from the latest and most applicable trends in the field.</p>
					</a>
				</li>
				<li>
					<a href="https://www.mdsec.co.uk/knowledge-centre/insights/">
						<hgroup>
							<h2>
								Insights
							</h2>
						</hgroup>
						<p>View insights from MDSec’s consultancy and research teams.</p>
					</a>
				</li>
			</ul>
		</section>		
	</div>		

	
	<section class="insights-single-header">
		<div class="content-wrapper">
			<div class="the-category">
			<span class="category">ActiveBreach</span>			</div>
			<h1>PART 2: How I Met Your Beacon – Cobalt Strike</h1>
		</div>
	</section>

	<section class="full-width-wrapper white pad20-120">
		<div class="content-wrapper">
			<div class="breadcrumb-wrapper">
				
			</div>	

		</div>
		
		<div class="insights-content">
		
<p>Cobalt Strike is one of the most popular command-and-control frameworks, favoured by red teams and threat actors alike. In this blog post we will discuss strategies that can be used by defenders and threat hunters to detect Cobalt Strike across different configurations and across the network, using the techniques outlined in <a href="https://www.mdsec.co.uk/2022/07/part-1-how-i-met-your-beacon-overview/" target="_blank" rel="noreferrer noopener">Part 1</a> of this series. All analysis is performed on Cobalt Strike 4.6.1; the latest at the time of writing.</p>



<p>The Cobalt Strike beacon is highly malleable and as such some indicators may vary depending on the malleable profile options selected.</p>



<h2 class="wp-block-heading"><strong>Cobalt Strike In Memory</strong></h2>



<p>Hunting for Cobalt Strike signatures in memory has been fruitful for threat hunters in the past, with prior comprehensive write ups being provided by <a href="https://www.elastic.co/blog/detecting-cobalt-strike-with-memory-signatures" target="_blank" rel="noreferrer noopener">Elastic</a>. However, since then much work has been done by HelpSystems, with Cobalt Strike 4.4 introducing the Sleep Mask Kit.</p>



<p>Cobalt Strike provides the following possible configuration options for it’s obfuscate and sleep strategies:</p>



<ul class="wp-block-list"><li><strong>No sleep mask</strong>: the beacon, its strings and code will remain plaintext in memory and it can be trivially identified through memory scanning.</li><li><strong>Enabling sleep_mask in the malleable profile</strong>: when setting <em>sleep_mask</em> to true in the malleable profile, beacon will use the built-in obfuscate and sleep strategy to mask the beacon in memory which uses xor to obfuscate strings and data. As detailed in the aforementioned post by Elastic, this can of course be signatured by targeting portions of code.</li><li><strong>Using a user defined sleep mask</strong>: the user defined sleep mask exposes the beacon’s obfuscate and sleep functions to the user, allowing them to roll their own implementation. While doing this, it also provides the user with a number of pointers to any heap records used by beacon such that the user can encrypt them. Leveraging a user defined sleep mask does have some tradeoffs, notably that in order to obfuscate the <em>.text</em> section, the configuration must have the “<em>userwx</em>” option set to true. That is, the beacon will always live in RWX memory if it is to be obfuscated. If the <em>userwx</em> option is set to false, the beacon will operate from RX memory but the <em>.text</em> section will not be obfuscated and by consequence ripe for signaturing. Its left to the operator’s discretion to choose the indicator they feel most comfortable with.</li></ul>



<p>As an example, Cobalt Strike can be detected with the following <a href="https://codex-7.gitbook.io/codexs-terminal-window/blue-team/detecting-cobalt-strike/sleep-mask-kit-iocs" target="_blank" rel="noreferrer noopener">Yara rule</a> when using the Sleep Mask Kit with the <em>userwx</em> option set to false:</p>



<pre class="wp-block-code"><code class="hljs yaml"><span class="hljs-string">rule</span> <span class="hljs-string">CobaltStrike_sleepmask</span> <span class="hljs-string">{</span>
	<span class="hljs-attr">meta:</span>
		<span class="hljs-string">description</span> <span class="hljs-string">=</span> <span class="hljs-string">"Static bytes in Cobalt Strike 4.5 sleep mask function that are not obfuscated"</span>
		<span class="hljs-string">author</span> <span class="hljs-string">=</span> <span class="hljs-string">"CodeX"</span>
		<span class="hljs-string">date</span> <span class="hljs-string">=</span> <span class="hljs-string">"2022-07-04"</span>
	<span class="hljs-attr">strings:</span>
		<span class="hljs-string">$sleep_mask</span> <span class="hljs-string">=</span> <span class="hljs-string">{48</span> <span class="hljs-string">8B</span> <span class="hljs-string">C4</span> <span class="hljs-number">48</span> <span class="hljs-number">89</span> <span class="hljs-number">58</span> <span class="hljs-number">08</span> <span class="hljs-number">48</span> <span class="hljs-number">89</span> <span class="hljs-number">68</span> <span class="hljs-number">10</span> <span class="hljs-number">48</span> <span class="hljs-number">89</span> <span class="hljs-number">70</span> <span class="hljs-number">18</span> <span class="hljs-number">48</span> <span class="hljs-number">89</span> <span class="hljs-number">78</span> <span class="hljs-number">20</span> <span class="hljs-number">45</span> <span class="hljs-number">33</span> <span class="hljs-string">DB</span> <span class="hljs-number">45</span> <span class="hljs-number">33</span> <span class="hljs-string">D2</span> <span class="hljs-number">33</span> <span class="hljs-string">FF</span> <span class="hljs-number">33</span> <span class="hljs-string">F6</span> <span class="hljs-number">48</span> <span class="hljs-string">8B</span> <span class="hljs-string">E9</span> <span class="hljs-string">BB</span> <span class="hljs-number">03</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">85</span> <span class="hljs-string">D2</span> <span class="hljs-string">0F</span> <span class="hljs-number">84</span> <span class="hljs-number">81</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-string">0F</span> <span class="hljs-string">B6</span> <span class="hljs-number">45</span> <span class="hljs-string">}</span>
	<span class="hljs-attr">condition:</span>
		<span class="hljs-string">$sleep_mask</span>
<span class="hljs-string">}</span>
</code></pre>



<p>Running this Yara rule against an injected beacon will show detection of the signature:</p>


<div class="wp-block-image is-style-default">
<figure class="aligncenter size-large is-resized"><img fetchpriority="high" decoding="async" src="https://www.mdsec.co.uk/wp-content/uploads/2022/07/image-22-960x168.png" alt="" class="wp-image-2995" width="720" height="126"></figure></div>


<p>Enabling the <em>userwx</em> will set the page permissions to <em>EXECUTE_READWRITE</em> but means the beacon is now obfuscating its <em>.text</em> section:</p>


<div class="wp-block-image is-style-default">
<figure class="aligncenter size-large is-resized"><img decoding="async" src="https://www.mdsec.co.uk/wp-content/uploads/2022/07/image-23-960x330.png" alt="" class="wp-image-2996" width="720" height="248"></figure></div>


<h3 class="wp-block-heading">Page Permissions</h3>



<p>Cobalt Strike beacons will typically be operating from a page with either RX or RWX page permissions, depending on the value of the “<em>userwx</em>” configuration option of the malleable profile and without module stomping, will be backed by unmapped memory.</p>



<p>This is a clear indicator that makes spotting the beacon relatively trivial in memory:</p>


<div class="wp-block-image is-style-default">
<figure class="aligncenter size-large is-resized"><img decoding="async" src="https://www.mdsec.co.uk/wp-content/uploads/2022/07/image-24-960x267.png" alt="" class="wp-image-2997" width="720" height="200"></figure></div>


<p>With care for avoiding JIT’d assemblies, it is possible to scan for these memory regions, searching for pages with <em>PAGE_EXECUTE_READWRITE</em> or <em>PAGE_EXECUTE_READ</em> page permissions and the MEM_COMMIT flag. When used with other indicators, this may prove valuable for identifying beaconing activity. We built this check in to BeaconHunter when the -p flag is used:</p>


<div class="wp-block-image is-style-default">
<figure class="aligncenter size-large is-resized"><img loading="lazy" decoding="async" src="https://www.mdsec.co.uk/wp-content/uploads/2022/07/Screenshot-2022-07-24-at-19.09.23-960x550.png" alt="" class="wp-image-2998" width="720" height="413"></figure></div>


<h3 class="wp-block-heading"><strong>Threads</strong></h3>



<p>When injected in to memory, Cobalt Strike will occupy a single thread; the beacon is synchronous. By default, the thread that the beacon operates within is highly suspicious and has a number of indicators associated with it.</p>



<p>Examining the thread of a Cobalt Strike beacon in Process Hacker might look something like this:</p>


<div class="wp-block-image is-style-default">
<figure class="aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.mdsec.co.uk/wp-content/uploads/2022/07/image-25.png" alt="" class="wp-image-2999" width="476" height="213"></figure></div>


<p>In the above screenshot alone, we can see a number of indicators that make the thread look highly suspicious:</p>



<ul class="wp-block-list"><li>Firstly, the thread typically has a <em>0x0</em> start address. This on the whole is somewhat irregular, although from scanning legitimate processes it does appear happen on occasion in some processes such as <em>chrome.exe</em>.</li><li>Diving deeper in to the call stack of the thread, we also note calls to <em>KernelBase!SleepEx</em> and <em>ntdll.dll!NtDelayExecution</em>. These calls are a tell tale sign of a sleeping beacon, and are used to delay execution of the thread while the beacon sleeps.</li><li>Just before the call to <em>KernelBase.dll!SleepEx</em> we can see the a call in the trace at <em>0x1b8ef69fcc7</em>; the stack walk has not resolved the symbol for this address so it’s almost certainly virtual memory. The thread backed by virtual memory is highly suspicious and would likely warrant further analysis.</li></ul>



<p>Considering all these indicators in parallel, a threat hunter is able to determine with high confidence that malicious activity is originating from the thread. BeaconHunter will pluck out these threads as being suspicious due to these indicators:</p>


<div class="wp-block-image is-style-default">
<figure class="aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.mdsec.co.uk/wp-content/uploads/2022/07/image-26.png" alt="" class="wp-image-3000" width="647" height="830"></figure></div>


<p>It should also be noted that Cobalt Strike introduced stack spoofing to the <a href="https://www.cobaltstrike.com/blog/arsenal-kit-update-thread-stack-spoofing/" target="_blank" rel="noreferrer noopener">arsenal kit in June ‘21</a>. However, the call stack spoofing was only determined to apply to exe/dll artifacts generated through the artifact kit as opposed to the beacon injected through shellcode in an injected thread. As such, they are unlikely to pose effective in masking the beacon in memory.</p>



<p>Cursory analysis suggests that the use of fibers is rare, therefore these can be trivially hunted for by analysing the call stack for a start address of <em>ntdll.dll!RtlUserFiberStart</em> and when combined with other indicators, may provide a starting point for hunting Cobalt artifacts:</p>


<div class="wp-block-image is-style-default">
<figure class="aligncenter size-large is-resized"><img loading="lazy" decoding="async" src="https://www.mdsec.co.uk/wp-content/uploads/2022/07/image-35-960x400.png" alt="" class="wp-image-3009" width="720" height="300"></figure></div>


<h3 class="wp-block-heading"><strong>Module Stomping:</strong></h3>



<p>Cobalt Strike supports module stomping use the “<em>set module_x64</em>” and “<em>set module_x86</em>” malleable options. Configuring these options cause beacon to be backed by a module on disk, providing some OpSec benefits over operating from virtual memory.</p>



<p>However, the implementation of the Cobalt Strike module stomping technique does leave some indicators of compromise behind within the process’ PEB. Aside from comparing the in memory module with the copy on disk or removal of the shared bit, the actual technique for implementation allows defenders to create a highly accurate detection of module stomping. This detection technique has already been <a href="https://github.com/slaeryan/DetectCobaltStomp" target="_blank" rel="noreferrer noopener">documented</a> by <a href="https://twitter.com/_winterknife_" target="_blank" rel="noreferrer noopener">@_<em>winterknife</em>_</a> and <a href="https://twitter.com/ilove2pwn_" target="_blank" rel="noreferrer noopener">@ilove2pwn_.</a></p>



<p>Summarising the approach used by Cobalt Strike for module stomping, it first loads the sacrificial DLL using a call to <em>LoadLibraryExA(moduleName, NULL, DONT_RESOLVE_DLL_REFERENCES)</em>:</p>


<div class="wp-block-image is-style-default">
<figure class="aligncenter size-large is-resized"><img loading="lazy" decoding="async" src="https://www.mdsec.co.uk/wp-content/uploads/2022/07/image-27-960x142.png" alt="" class="wp-image-3001" width="720" height="107"></figure></div>


<p>This instructs the loader to not execute the DLLs entry point and avoids processing the DLL’s import table to load dependencies (which is preferred as its sacrificial).</p>



<p>However, the side effect of this approach is that certain attributes inside the <em>LDR_DATA_TABLE_ENTRY</em> structure within the PEB are left in a rare configuration; specifically the <em>EntryPoint</em> attribute will be set to NULL and the <em>ImageDLL</em> bit false.</p>



<p>Walking the PEB and parsing this structure can for the combination of these attributes in this configuration can provide a high confidence indicator:</p>


<div class="wp-block-image is-style-default">
<figure class="aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.mdsec.co.uk/wp-content/uploads/2022/07/image-28.png" alt="" class="wp-image-3002" width="707" height="255"></figure></div>


<h2 class="wp-block-heading"><strong>Cobalt Strike on the Network</strong></h2>



<p>The Cobalt Strike C2 server is based on <a href="https://github.com/NanoHttpd/nanohttpd" target="_blank" rel="noreferrer noopener">NanoHttpd</a>, this is a lightweight Java HTTP server and has undergone a small number of alterations to align it with the Cobalt Strike use case. Prior work has been done by <a href="https://blog.fox-it.com/2019/02/26/identifying-cobalt-strike-team-servers-in-the-wild/" target="_blank" rel="noreferrer noopener">FoxIT</a> on identifying Cobalt Strike team servers in the wild; however, the fingerprint of the superfluous white space character has long since been patched. At the time, the FoxIT research showed that there were likely many more Cobalt Strike C2 servers in the wild than NanoHttpd servers.</p>



<p>A cursory analysis of the Cobalt Strike C2 server revealed a number of further methods for fingerprinting the C2.</p>



<p>The first one involves the use of the Range HTTP header, where sending a request with an invalid integer will will cause no response to be returned by the server:</p>


<div class="wp-block-image is-style-default">
<figure class="aligncenter size-large is-resized"><img loading="lazy" decoding="async" src="https://www.mdsec.co.uk/wp-content/uploads/2022/07/image-29-960x315.png" alt="" class="wp-image-3003" width="720" height="236"></figure></div>


<p>Taking a closer look at the team server, we can see the reason for this. An unhandled exception has occurred:</p>


<div class="wp-block-image is-style-default">
<figure class="aligncenter size-large is-resized"><img loading="lazy" decoding="async" src="https://www.mdsec.co.uk/wp-content/uploads/2022/07/image-30-960x491.png" alt="" class="wp-image-3004" width="720" height="368"></figure></div>


<p>Taking a closer look at the C2 server source code (<em>src/main/java/cloudstrike/WebServer.java</em>), we can quickly find the reason for this; the server attempts to convert the string to an integer but the value is invalid and no exception handling is in place:</p>


<div class="wp-block-image is-style-default">
<figure class="aligncenter size-large is-resized"><img loading="lazy" decoding="async" src="https://www.mdsec.co.uk/wp-content/uploads/2022/07/image-31-960x211.png" alt="" class="wp-image-3005" width="720" height="158"></figure></div>


<p>A second technique for fingerprinting the Cobalt Strike C2 server also exists within the Range HTTP header. Providing a range that the server cannot satisfy (e.g. 1-0), will lead to a “<em>Range Not Satisfiable</em>” error. While this error will also occur in NanoHTTPd servers, we can imply that it is Cobalt Strike through the erroneous Server header; that is servers such as IIS, Apache and Nginx do not return this error:</p>


<div class="wp-block-image is-style-default">
<figure class="aligncenter size-large is-resized"><img loading="lazy" decoding="async" src="https://www.mdsec.co.uk/wp-content/uploads/2022/07/image-32-960x364.png" alt="" class="wp-image-3006" width="720" height="273"></figure></div>


<p>Analysing the C2 server source code further, we can easily identify other responses that can lead to fingerprinting, such as the following found in <em>src/main/java/cloudstrike/NanoHTTPD.java</em>:</p>


<div class="wp-block-image is-style-default">
<figure class="aligncenter size-large is-resized"><img loading="lazy" decoding="async" src="https://www.mdsec.co.uk/wp-content/uploads/2022/07/image-33-960x502.png" alt="" class="wp-image-3007" width="720" height="377"></figure></div>


<p>As we can see above, when an invalid URL encoded byte is submitted in the URI, the C2 server will return a finger printable response.</p>



<p>Using this logic, we can build a Nuclei template to scan for team servers:</p>



<pre class="wp-block-code"><code class="hljs http"><span class="hljs-attribute">id</span>: csteamsever-badencoding

<span class="less"><span class="hljs-attribute">info</span>:
  <span class="hljs-attribute">name</span>: Cobalt Strike Team Servers
  <span class="hljs-attribute">author</span>: Dominic Chell
  <span class="hljs-attribute">severity</span>: info
  <span class="hljs-attribute">description</span>: description
  <span class="hljs-attribute">reference</span>:
    - <span class="hljs-attribute">https</span>:<span class="hljs-comment">//</span>
  <span class="hljs-attribute">tags</span>: tags

<span class="hljs-attribute">requests</span>:
  - <span class="hljs-attribute">raw</span>:
      - |-
        GET /%<span class="hljs-number">0</span> HTTP1.<span class="hljs-number">1</span>
        <span class="hljs-attribute">Host</span>: {{Hostname}}

    <span class="hljs-attribute">unsafe</span>: true
    <span class="hljs-attribute">matchers-condition</span>: and
    <span class="hljs-attribute">matchers</span>:
      - <span class="hljs-attribute">type</span>: word
        <span class="hljs-attribute">part</span>: body
        <span class="hljs-attribute">words</span>:
          - <span class="hljs-string">'BAD REQUEST: Bad percent-encoding.'</span>
      - <span class="hljs-attribute">type</span>: status
        <span class="hljs-attribute">status</span>:
          - <span class="hljs-number">400</span>

</span></code></pre>



<p>With an example match as follows:</p>


<div class="wp-block-image is-style-default">
<figure class="aligncenter size-large is-resized"><img loading="lazy" decoding="async" src="https://www.mdsec.co.uk/wp-content/uploads/2022/07/image-34-960x409.png" alt="" class="wp-image-3008" width="720" height="307"></figure></div>


<p>In conclusion, we’ve outlined a number of techniques that can be used by defenders to identify malicious activity from Cobalt Strike beacons in the wild, including indicators in memory, within threads and across the network.</p>



<p><strong>References</strong>:</p>



<ul class="wp-block-list"><li><a href="https://blog.fox-it.com/2019/02/26/identifying-cobalt-strike-team-servers-in-the-wild/"></a><a href="https://blog.fox-it.com/2019/02/26/identifying-cobalt-strike-team-servers-in-the-wild/">https://blog.fox-it.com/2019/02/26/identifying-cobalt-strike-team-servers-in-the-wild/</a></li><li><a href="https://github.com/slaeryan/DetectCobaltStomp"></a><a href="https://github.com/slaeryan/DetectCobaltStomp">https://github.com/slaeryan/DetectCobaltStomp</a></li><li><a href="https://www.elastic.co/blog/detecting-cobalt-strike-with-memory-signatures"></a><a href="https://www.elastic.co/blog/detecting-cobalt-strike-with-memory-signatures">https://www.elastic.co/blog/detecting-cobalt-strike-with-memory-signatures</a></li><li><a href="https://codex-7.gitbook.io/codexs-terminal-window/blue-team/detecting-cobalt-strike/sleep-mask-kit-iocs" target="_blank" rel="noreferrer noopener">https://codex-7.gitbook.io/codexs-terminal-window/blue-team/detecting-cobalt-strike/sleep-mask-kit-iocs</a></li></ul>



<p>This blog post was written by <a href="https://twitter.com/domchell" target="_blank" rel="noreferrer noopener">Dominic Chell</a>.</p>



<p>For further information on finding Cobalt Strike in your network, <a href="https://www.mdsec.co.uk/contact/" target="_blank" rel="noreferrer noopener">contact us</a> for more details on our <a href="https://www.mdsec.co.uk/our-services/response/" target="_blank" rel="noreferrer noopener">Threat Hunting Services</a>.</p>
		</div>
		
		<div class="author">
			<div class="content-wrapper clearfix">
				<div class="author-avatar">
					<img alt="" src="https://secure.gravatar.com/avatar/9cb7b62409a4b5ef00769dca4ba852fc49229c9729d600fc2637daf77068c31c?s=96&amp;d=wp_user_avatar&amp;r=g" class="avatar avatar-96 photo" height="96" width="96" loading="lazy" decoding="async">				</div>
				<div class="author-meta">
					<div class="author-meta__content">
						<span>written by</span>
						<h4>MDSec Research</h4>
					</div>
				</div>
			</div>
		</div>
		<section class="testing">
	<div class="content-wrapper">
		<h2>Ready to engage<br>with MDSec?</h2>
		<div class="button">
			<a href="https://www.mdsec.co.uk/contact">
				Get in touch
			</a>
		</div>
	</div>
</section>		
	</section>




	<section class="newsletter">
	<div class="content-wrapper clearfix">
		<div class="newsletter-left">
			<p>
				Stay updated with the latest <br>news from MDSec.
			</p>
		</div>
		<div class="newsletter-right">
			<div class="frm_forms  with_frm_style frm_style_formidable-style" id="frm_form_2_container">
<form enctype="multipart/form-data" method="post" class="frm-show-form  frm_js_validate " id="form_newslettersignupform">
<div class="frm_form_fields ">
<fieldset>
<legend class="frm_screen_reader">Newsletter Signup Form</legend>

<div class="frm_fields_container">





<div id="frm_field_10_container" class="frm_form_field form-field  frm_none_container frm_full">
    <label for="field_nkjbj" id="field_nkjbj_label" class="frm_primary_label">Email
        <span class="frm_required"></span>
    </label>
    <input type="email" id="field_nkjbj" name="item_meta[10]" value="" placeholder="Enter your email for updates" data-invmsg="Email is invalid" aria-invalid="false">
    
    
</div>
<div id="frm_field_11_container" class="frm_form_field form-field  frm_none_container frm_first frm_full">
    <label for="g-recaptcha-response" id="field_ah4d8_label" class="frm_primary_label">
        <span class="frm_required"></span>
    </label>
    <div id="field_ah4d8" class="frm-g-recaptcha" data-sitekey="6Lc27L0ZAAAAAMV4QCtKwWRbT-Hm1FnY6IKqcSxw" data-size="invisible" data-theme="light"></div>
    
    
</div>
	
			<div id="frm_field_29_container">
			<label for="field_7i5ta" style="display:none;">
				If you are human, leave this field blank.			</label>
			<input id="field_7i5ta" type="text" class="frm_form_field form-field frm_verify" name="item_meta[29]" value="" style="display:none;">
		</div>
		<div class="frm_submit">

<button class="frm_button_submit" type="submit">Submit</button>

</div></div>
</fieldset>
</div>

</form>
</div>
			
		</div>
	</div>
</section>

		</div>
	<!-- Site Wrapper End -->
	
	<!-- Footer Start -->	
	

	<div class="end clearfix">
		<div class="end__left">
			Copyright 2026 MDSec
		</div>
		<div class="end__right">
			<!--<a href="#">Privacy Policy</a>-->
		</div>
	</div>
	<!-- Footer End -->
	
    










	
			
	
	



    	    			




</body><!-- Body End --></html>