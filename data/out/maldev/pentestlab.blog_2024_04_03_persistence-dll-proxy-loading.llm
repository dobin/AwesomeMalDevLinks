Title:
Persistence – DLL Proxy Loading

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post explains DLL Proxy Loading, a DLL hijacking variant where a malicious DLL mimics a legitimate DLL’s exported functions and forwards calls to the real library to avoid breaking application behavior.  
- The goal is stealthy code execution (often for persistence) by planting the proxy DLL in the target application’s directory with the same filename as the expected DLL.  
- It covers how to enumerate required exports (DLL Export Viewer, Visual Studio `dumpbin /exports`) and how to implement forwarding via linker `/export:` directives while running payload code (e.g., in `DllMain`).  
- The article highlights tooling to find and automate proxy opportunities, including Accenture’s Spartacus (detection + Procmon-assisted workflows) and Flangvik’s SharpDLLProxy (auto-generates proxy templates and can load shellcode from disk).  
- Useful primarily for red teams/pentesters and malware developers implementing sideloading/persistence while keeping the host process functioning normally; also relevant to defenders for understanding a stealthier hijack pattern.

Technical Focus:
- DLL search order abuse / DLL hijacking (sideloading)
- Export enumeration and matching (PE exports)
- Export forwarding via linker directives (`/export:`)
- Payload execution via `DllMain` / process context execution
- Tooling: Procmon, Spartacus, SharpDLLProxy, `dumpbin`

Use Cases:
- Establish persistence by proxying a commonly executed application DLL
- Execute an implant inside a trusted process without disrupting normal functionality
- Rapidly generate proxy DLL scaffolding for a target legitimate DLL
- Identify candidate binaries/DLLs vulnerable to hijacking/proxying using Procmon + automation

Keywords:
DLL proxy loading, DLL hijacking, DLL sideloading, persistence, Windows DLL search order, PE exports, export forwarding, linker pragma comment, /export directive, DllMain, rundll32, dumpbin.exe, Visual Studio, Process Monitor, Procmon, Spartacus, SharpDLLProxy, shellcode loader, trusted process execution, C2 implant