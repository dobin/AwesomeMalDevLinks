Title:
LayeredSyscall – Abusing VEH to Bypass EDRs (Legitimate Call Stack + Indirect Syscalls)

Type:
GitHub Tool

Short Summary (4–8 sentences max):
LayeredSyscall is a Windows user-mode evasion technique/tool that combines indirect syscalls with call stack spoofing to bypass user-land EDR API hooks. It abuses Vectored Exception Handling (VEH) to generate a “legitimate-looking” call stack frame while executing sensitive NT syscalls, addressing the common detection gap where indirect syscalls produce anomalous stacks. The repo provides C/C++ wrappers (prefix `wrp` to syscall names) and hook initialization/teardown routines (`IntializeHooks()` / `DestroyHooks()`). Users can customize which benign Windows API call is used to shape the stack (default demo uses `MessageBox`), enabling per-API stack selection. It’s primarily useful for red teams, offensive security researchers, and malware developers evaluating or bypassing user-mode telemetry, and for blue teams studying detection opportunities around VEH registration and stack heuristics.

Technical Focus:
- Vectored Exception Handling (VEH) abuse (AddVectoredExceptionHandler-style flow)
- Indirect syscalls / direct NT syscall invocation
- User-mode EDR hook bypass (ntdll/API hooking evasion)
- Call stack spoofing / stack frame fabrication
- Windows NT process creation via `NtCreateUserProcess` and RTL helpers

Use Cases:
- Integrate syscall wrappers into implants/loaders to reduce user-mode hook visibility
- Proof-of-concept research on stack-based detections vs. syscall-based evasion
- Testing EDR resilience to VEH-based control-flow and stack anomalies
- Customizing “legitimate” stack origins per operation (e.g., process/thread/memory syscalls)

Keywords:
Windows, EDR bypass, user-mode hooks, ntdll, indirect syscall, direct syscall, Vectored Exception Handling, VEH, call stack spoofing, stack frames, NtCreateUserProcess, RtlCreateProcessParametersEx, UNICODE_STRING, PS_CREATE_INFO, PS_ATTRIBUTE_LIST, MessageBox, exception handler registration, telemetry evasion, C/C++ PoC