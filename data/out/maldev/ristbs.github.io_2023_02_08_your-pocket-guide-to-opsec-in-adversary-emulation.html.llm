Title:
Your Pocket Guide to OPSEC in Adversary Emulation

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post is a practical OPSEC checklist for red team/adversary emulation, focused on reducing detection by understanding common blue team telemetry and tooling.  
- It outlines “the enemies” (EDRs, memory scanners, YARA/pattern matching) and summarizes key Windows detection surfaces such as user-mode hooks, kernel callbacks, and ETW/ETWTI providers.  
- The author connects offensive tradecraft to defensive data sources (Sysmon/Windows Security logs, ETW, network telemetry) and highlights specific event IDs defenders correlate (e.g., 3, 17/18, 4698/4699, 4703, 4768/4769).  
- It provides OPSEC tips across phases: recon, initial access (MOTW, container delivery, HTML smuggling, ASR constraints), Kerberos abuse (ASREPRoast/Kerberoast noise and encryption choices), lateral movement (DCOM/DCERPC), and pivoting (SOCKS, named pipes).  
- The tooling section emphasizes minimizing forensic and detection artifacts (cmdline/PowerShell avoidance, in-memory tradeoffs like CLR ETW, handle hygiene, PPID spoofing, RW→RX, debug symbol stripping, entropy/timestamps).  
- Useful for red teamers/pentesters designing stealthier operations and for blue teamers to understand attacker OPSEC assumptions and where to hunt.

Technical Focus:
- Windows EDR telemetry: ETW providers, ETWTI, user-mode hooks, kernel callbacks  
- Windows/Sysmon event IDs and correlation for detection (network, pipes, tasks, Kerberos)  
- C2/infrastructure OPSEC: redirectors, domain reputation, TLS/mTLS, multi-C2 staging  
- Initial access evasion: MOTW behavior, container formats, HTML smuggling, ASR rules  
- Kerberos tradecraft: ASREPRoasting/Kerberoasting signals, RC4 vs AES, Overpass-the-Hash  
- Payload/tool OPSEC: in-memory execution, CLR ETW/UsageLogs, PPID/cmdline spoofing, memory permissions

Use Cases:
- Build an engagement OPSEC plan mapped to expected SIEM/EDR telemetry
- Choose C2 protocols and infrastructure patterns that blend with enterprise traffic
- Reduce initial access artifacts (MOTW-aware delivery, ASR-safe execution paths)
- Tune Kerberos attack tooling to reduce obvious indicators (encryption/options/targeting)
- Avoid common endpoint detections (named pipe IOCs, suspicious parent/child chains, RWX memory)
- Create blue-team hunt hypotheses based on attacker OPSEC failure points

Keywords:
OPSEC, adversary emulation, EDR, Sysmon, Windows Security Event Log, ETW, ETWTI, AMSI, ASR rules, Mark-of-the-Web, HTML smuggling, redirectors, mTLS, SOCKS proxy, named pipes, Kerberos, ASREPRoasting, Kerberoasting, DCSync, Overpass-the-Hash, DCOM, DCERPC, PPID spoofing, process injection, RWX, CLR ETW, YARA, Sigma, Cobalt Strike, BOF, COFF loader