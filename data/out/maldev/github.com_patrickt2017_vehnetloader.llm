Title:
VEHNetLoader

Type:
GitHub Tool

Short Summary (4–8 sentences max):
- VEHNetLoader is a Windows .NET assembly loader that focuses on evasion by combining CLR hosting with ETW and AMSI bypass techniques.  
- It implements “vectored syscalls” using Vectored Exception Handling (VEH) to execute Native API syscalls indirectly by intentionally triggering an access violation and reconstructing the syscall context in the exception handler.  
- For ETW suppression, it patches the syscall number (SSN) used by `NtTraceEvent` to a dummy value so ETW event emission fails.  
- For AMSI bypass, it modifies the `AmsiScanBuffer` string in the `.rdata` section of `clr.dll` so `GetProcAddress` cannot resolve the AMSI export, preventing scanning during reflective/hosted assembly loads.  
- Payloads can be RC4-encrypted on disk (helper script included) and decrypted at runtime before being loaded and invoked via `Load_3`/`Invoke_3` with `SAFEARRAY` arguments.  
- Useful for red teams/pentesters and malware researchers studying modern .NET loader tradecraft and common telemetry bypass patterns; also relevant to defenders for understanding detection opportunities (e.g., anomalous call stacks from vectored syscalls, in-memory patching of `clr.dll`/ETW paths).

Technical Focus:
- Vectored Exception Handling (VEH) for indirect syscalls (“vectored syscalls”)
- ETW bypass via patching `NtTraceEvent` syscall number (SSN)
- AMSI bypass by tampering `clr.dll` `.rdata` (`AmsiScanBuffer` resolution failure)
- CLR hosting to load and execute .NET assemblies (`Load_3`, `Invoke_3`, `SAFEARRAY`)
- On-disk payload encryption/decryption (RC4)

Use Cases:
- Load and execute a .NET payload from a native loader while attempting to reduce ETW/AMSI visibility
- Research and prototype syscall indirection via VEH and its detection artifacts
- Test EDR detections for in-memory patching of ETW/AMSI-related code/data
- Deliver encrypted .NET assemblies and pass user-controlled arguments to the managed EntryPoint

Keywords:
VEH, Vectored Exception Handling, vectored syscalls, indirect syscalls, Native API, syscall stub, SSN, NtTraceEvent, ETW, EtwEventWrite, AMSI, AmsiScanBuffer, clr.dll, GetProcAddress, CLR hosting, Load_3, Invoke_3, SAFEARRAY, RC4, .NET assembly loader