Title:
Ghost (Evasive Shellcode Loader)

Type:
GitHub Tool

Short Summary (4–8 sentences max):
Ghost is a Windows shellcode loader focused on evading common EDR telemetry and in-memory detection. It targets three main detection areas: kernel callback visibility of thread/process execution, stack-unwinding/callstack-based anomaly detection, and memory scanning for known shellcode patterns. To reduce kernel-observable execution artifacts, it executes via Windows Fibers (user-mode scheduling) and uses fiber switching to help hide a beacon’s call stack during sleep. For callstack evasion, it implements return-address spoofing and a hook-based approach to swap fibers around sleep to obscure the beacon’s stack frames. For memory scanning resistance, it uses a “plain sight” technique: allocate a large region, fill with random data via SystemFunction036 (RtlGenRandom), and place shellcode at a random offset among the noise; it also supports embedding shellcode in PE resources. It additionally includes ETW patching, indirect syscalls, unhooking, and custom API hashing/SSN resolution, making it primarily useful for red teams and offensive security researchers evaluating EDR resilience.

Technical Focus:
- Windows Fibers for user-mode execution and evasion of kernel callbacks
- Call stack spoofing (return address spoofing) and stack-unwinding evasion
- Sleep masking via function hooking + fiber switching
- Shellcode concealment in large randomized memory regions (“plain sight”)
- ETW patching/disablement in-memory
- Indirect syscalls, unhooking, API hashing, SSN resolution

Use Cases:
- Building/experimenting with evasive in-process shellcode loaders on Windows
- Testing EDR detections around callstack integrity, sleep masking, and syscall telemetry
- Researching fiber-based execution tradeoffs vs. thread-based injection/execution
- Prototyping beacon sleep obfuscation by hooking the beacon’s sleep API
- Evaluating memory-scanning robustness against “noise + random placement” techniques

Keywords:
Windows shellcode loader, EDR evasion, Fibers, ConvertThreadToFiber, fiber switching, kernel callbacks, stack unwinding, call stack spoofing, return address spoofing, sleep masking, function hooking, indirect syscalls, SSN resolution, API hashing, ETW patching, SystemFunction036, RtlGenRandom, memory scanning evasion, PE resources, Cobalt Strike beacon