Title:
Avoiding direct syscall instructions by using trampolines (BouncyGate)

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post describes an evasion technique to avoid static/signature-based detection of direct `syscall` instructions commonly produced by SysWhispers1/2 and similar generators.  
- The author explains why EDRs flag binaries containing inline `syscall` opcodes and how this impacts Nim-based packers/payload loaders.  
- It builds on HellsGate-style syscall number resolution (PEB traversal + NTDLL export parsing + API hashing) but replaces the inline `syscall` instruction with a trampoline `JMP` into an existing `syscall` instruction inside `ntdll.dll`.  
- The implementation scans `ntdll.dll` in memory to locate a suitable `syscall` sequence and then jumps to it from custom syscall stubs, making the syscall appear to originate from NTDLL and removing `syscall` opcodes from the implant’s code section.  
- This is useful for red teamers and malware developers building loaders/packers who want to reduce detections tied to SysWhispers-style stubs; it also helps defenders understand a common “no direct syscall” pattern (similar to SysWhispers3/RecycledGate).  

Technical Focus:
- Windows syscalls via NTDLL (Nt* APIs) and EDR userland hooking
- HellsGate syscall number extraction (PEB walk, EAT parsing, API hashing)
- Trampoline/recycled syscalls (jumping to `ntdll`’s `syscall` instruction)
- Opcode/pattern scanning in memory to locate `syscall` sequences
- Nim inline assembly for syscall stubs and low-level Windows interop

Use Cases:
- Building stealthier Windows implants/loaders that avoid SysWhispers1/2 signatures
- Implementing “no direct syscall instruction” syscall invocation in Nim
- Researching detection opportunities around NTDLL-based syscall trampolines
- Customizing syscall dispatch to blend with legitimate NTDLL execution flow

Keywords:
Windows syscalls, NTDLL.dll, NtProtectVirtualMemory, SysWhispers, SysWhispers3, NimlineWhispers, HellsGate, RecycledGate, trampoline, indirect syscall, EDR hooks, userland hooking, PEB traversal, Export Address Table, API hashing, inline assembly, opcode scanning, 0F 05 syscall, packer, Nim malware development