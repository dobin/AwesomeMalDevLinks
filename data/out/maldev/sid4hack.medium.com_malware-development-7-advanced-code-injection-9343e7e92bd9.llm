Title:
Malware Development 7: Advanced Code Injection

Type:
Blog Post

Short Summary (4–8 sentences max):
This Medium post is part of a malware-development series and focuses on practical building blocks used in Windows code injection workflows. The accessible portion demonstrates how to enumerate running processes and resolve a target PID by process name using the Toolhelp32 snapshot APIs. This solves the common injector prerequisite of reliably selecting a target process (often higher-privilege or user-session specific) before performing remote memory operations or DLL/shellcode injection. The article discusses Win32 API usage patterns, required structures, and iteration logic for process discovery. It’s primarily useful for red teamers, pentesters, and malware developers implementing custom injectors, and secondarily for blue teamers wanting to understand common precursor behaviors to injection. It’s interesting because process enumeration and PID resolution are frequently observed telemetry steps preceding many injection techniques.

Technical Focus:
- Process enumeration via Toolhelp32 snapshots
- PID discovery by executable name matching
- Win32 API usage for process discovery (CreateToolhelp32Snapshot/Process32First/Process32Next)
- PROCESSENTRY32 structure handling and iteration
- Injector targeting logic (selecting candidate processes)

Use Cases:
- Implementing a “find target process” routine for DLL/shellcode injectors
- Building process discovery utilities for post-exploitation tooling
- Creating detection logic for suspicious process enumeration preceding injection
- Validating privilege/session-based targeting (e.g., admin-launched processes)

Keywords:
Windows, Win32 API, code injection, process enumeration, PID lookup, CreateToolhelp32Snapshot, TH32CS_SNAPPROCESS, PROCESSENTRY32, Process32First, Process32Next, szExeFile, th32ProcessID, injector, DLL injection, shellcode, process discovery, endpoint telemetry, malware development