Title:
MochiMapper — Minimal in-memory manual PE loader (resource-embedded)

Type:
GitHub Tool

Short Summary (4–8 sentences max):
MochiMapper is a minimal Windows manual PE loader that maps a payload PE from the host binary’s `.rsrc` section into memory and emulates key parts of the Windows loader. It solves the problem of executing an EXE/DLL without using the normal on-disk load path by performing relocation processing, import resolution (reading INT/ILT and writing the IAT), TLS callback execution, and x64 unwind/exception support via `.pdata` registration. Payloads can be optionally AES-128-CBC encrypted, with a companion Python utility (ObfusX) to encrypt PEs/shellcode for embedding. The loader also includes optional IAT-level hooks to spoof/hide command-line and related CRT APIs without modifying the PEB, and can target exported DLL functions instead of `DllMain`. It’s primarily useful for red team operators, pentesters, and malware researchers studying or prototyping in-memory execution and loader behavior. The project explicitly notes limited OPSEC and suggests enhancements like API hashing, indirect syscalls, improved key/IV handling, CRT-free builds, or converting to a reflective DLL loader.

Technical Focus:
- Manual PE mapping from memory (resource section payload)
- Base relocations and bounds-checked relocation walking
- Import resolution (INT/ILT parsing, IAT patching)
- TLS callbacks and loader emulation
- x64 SEH/unwind support via `.pdata` registration
- IAT hooking for command-line/CRT/exit API interception

Use Cases:
- Execute embedded EXE/DLL payloads from memory without dropping to disk
- Prototype/customize a manual mapper for red team tradecraft experiments
- Study Windows loader mechanics (relocations, imports, TLS, unwind metadata)
- Implement command-line spoofing via IAT patching for specific payloads
- Encrypt and embed payloads (AES-CBC) to reduce static visibility of raw PE bytes

Keywords:
manual mapping, PE loader, in-memory execution, .rsrc, AES-128-CBC, relocation table, base relocations, INT, ILT, IAT, import address table, TLS callbacks, .pdata, x64 unwind, SEH, export resolver, forwarder exports, IAT hooking, GetCommandLineW, __getmainargs, ExitProcess, mimikatz demo