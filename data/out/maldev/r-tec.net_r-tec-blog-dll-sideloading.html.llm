Title:
DLL Sideloading (and DLL Proxying) on Windows: Theory, Discovery, and Weaponization

Type:
Blog Post

Short Summary (4–8 sentences max):
- The post explains Windows DLL loading mechanics and how attackers abuse DLL search order weaknesses to achieve code execution via DLL hijacking and DLL sideloading.  
- It walks through identifying hijackable DLL loads using Sysinternals Process Monitor by spotting `CreateFile` events with `NAME NOT FOUND` in user-writable paths.  
- The key improvement from basic hijacking to sideloading is DLL proxying: exporting/forwarding the expected functions to the real DLL to keep the target application stable while running attacker code.  
- It highlights practical pitfalls like LoaderLock when executing payloads in `DllMain`, recommending thread-based execution or triggering from exported functions.  
- The blog demonstrates automation with Spartacus to generate proxy DLL Visual Studio projects and then modifies them to run shellcode (local and staged over HTTPS with XOR “encryption”).  
- A “weaponization” example targets Microsoft Teams by selecting a suitable DLL (e.g., `AudioSes.dll`) and discusses delivery via crafted `.msc`-based execution to drop the DLL into Teams’ directory for persistence and C2 execution.  
- Useful for red teams/pentesters and malware developers; also provides defender notes on detecting abnormal DLL load paths and using allowlisting.

Technical Focus:
- Windows DLL loader behavior and DLL search order
- DLL hijacking vs DLL sideloading (proxy DLL export forwarding)
- ProcMon-based discovery of missing DLL loads (`NAME NOT FOUND`)
- Spartacus automation for hijack/proxy generation
- Payload execution considerations (LoaderLock, `DllMain`, `CreateThread`)
- Shellcode staging/execution (WinHTTP download, `VirtualAlloc`, `CreateFileMapping`/`MapViewOfFile`)

Use Cases:
- Identify DLL hijacking opportunities in third-party or preinstalled Windows applications
- Build proxy DLLs that preserve application functionality while executing a payload
- Establish stealthier execution/persistence by running inside signed/legitimate processes (e.g., Teams)
- Automate triage and proxy project generation with Spartacus + ProcMon logs
- Stage encrypted shellcode over HTTPS and execute in-memory from a sideloaded DLL

Keywords:
DLL sideloading, DLL hijacking, DLL proxying, Windows loader, DLL search order, import table, exported functions, DllMain, LoaderLock, CreateThread, GetProcAddress, GetModuleHandleA, LoadLibrary, Sysinternals ProcMon, Process Monitor, Spartacus, NAME NOT FOUND, PATH environment variable, System32, AppData, Microsoft Teams, AudioSes.dll, cryptbase.dll, DWrite.dll, oleacc.dll, shellcode execution, VirtualAlloc, CreateFileMapping, MapViewOfFile, WinHTTP, HTTPS staging, XOR encryption, msfvenom, Mythic C2, persistence, signed binary abuse, MSC file execution