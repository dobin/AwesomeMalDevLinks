Title:
NtCreateSection + NtMapViewOfSection Code Injection (Section Mapping Injection)

Type:
Blog Post

Short Summary (4â€“8 sentences max):
- This write-up demonstrates a Windows process injection technique using Native APIs to share a memory section between the injector and a remote target process.  
- It creates a section object with executable permissions, maps it as RW in the local process and as RX in the target process, then writes shellcode into the local view so it is reflected in the remote view.  
- Execution is triggered by creating a thread in the target process with `RtlCreateUserThread` pointing at the remote mapped address.  
- A key goal is avoiding allocating RWX memory directly in the remote process (a common EDR heuristic) by separating write and execute permissions across different mapped views.  
- The post includes a working C/C++ PoC that dynamically resolves `NtCreateSection`, `NtMapViewOfSection`, and `RtlCreateUserThread` from `ntdll.dll`.  
- Useful for red teamers and malware developers studying alternative injection primitives and for defenders modeling telemetry around section objects and remote thread creation.

Technical Focus:
- NT Native API process injection (`NtCreateSection`, `NtMapViewOfSection`)
- Section objects and shared memory views across processes
- Memory protection strategy (RW local view, RX remote view; avoiding remote RWX)
- Remote thread creation via `RtlCreateUserThread`
- Shellcode staging via mirrored section mapping

Use Cases:
- Injecting shellcode into a remote process without `VirtualAllocEx` + RWX in the target
- Building/understanding stealthier user-mode injection tradecraft
- Creating detection logic around section mapping + remote thread start addresses
- Lab exercises for Windows internals and EDR evasion research

Keywords:
NtCreateSection, NtMapViewOfSection, RtlCreateUserThread, ntdll.dll, Native API, NTAPI, section object, mapped view, shared memory, process injection, shellcode, remote thread, PAGE_EXECUTE_READWRITE, PAGE_READWRITE, PAGE_EXECUTE_READ, SEC_COMMIT, OpenProcess, memory protections, Windows internals, EDR heuristics