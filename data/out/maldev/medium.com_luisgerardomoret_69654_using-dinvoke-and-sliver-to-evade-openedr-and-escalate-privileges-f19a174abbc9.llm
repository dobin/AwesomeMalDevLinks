Title:
Using DInvoke and Sliver to Evade OpenEDR and Escalate Privileges

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post walks through evading Xcitium (Comodo) OpenEDR on Windows while Windows Defender is enabled, then moving into privilege escalation and credential dumping.  
- It explains the common EDR technique of user-mode API hooking in `kernel32.dll`/`ntdll.dll` to monitor suspicious calls (e.g., `VirtualAlloc`, `CreateThread`) used by shellcode loaders.  
- The core evasion approach is using DInvoke in C# to dynamically resolve and invoke Windows APIs from in-memory module copies rather than standard P/Invoke paths that are commonly hooked.  
- The author modifies an existing DInvoke-based C# shellcode loader (Kara-4search) by replacing hardcoded shellcode with a Sliver C2 payload.  
- The lab setup uses EDR/AV exclusions to enable development and testing, then demonstrates post-exploitation steps (high-integrity execution and credential access).  
- Useful primarily for red teamers/pentesters and malware developers interested in practical user-mode hook bypass patterns and integrating them with Sliver tradecraft.

Technical Focus:
- User-mode API hooking and EDR telemetry (kernel32/ntdll)
- DInvoke (dynamic invocation without P/Invoke)
- C# shellcode loading and in-memory execution
- Sliver C2 payload generation/usage
- Windows privilege escalation to High Integrity
- Credential dumping workflow (post-exploitation)

Use Cases:
- Building/adjusting C# loaders to reduce user-mode hook visibility
- Delivering Sliver implants via custom in-memory execution chains
- Testing OpenEDR detection coverage against dynamic invocation techniques
- Post-exploitation chaining: initial access → high integrity → credential access
- Red team lab validation of EDR bypass assumptions around hooked APIs

Keywords:
Xcitium OpenEDR, Comodo EDR, EDR evasion, user-mode hooks, API hooking, kernel32.dll, ntdll.dll, Native API, VirtualAlloc, CreateThread, DInvoke, C#, dynamic invocation, P/Invoke bypass, shellcode loader, in-memory execution, Sliver C2, privilege escalation, High Integrity, credential dumping