Title:
Process injection in 2023, evading leading EDRs

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post provides a “blueprint” for building a Windows process-injection loader that aims to evade modern EDR detections while using well-known injection primitives.  
- It focuses on reducing common telemetry/signatures around API resolution, user-mode hooks in `ntdll.dll`, classic remote-thread creation, and large suspicious memory operations.  
- Techniques include a custom `GetProcAddress` via PEB export walking (with string obfuscation/API hashing), bypassing EDR hooks using hardware breakpoints + VEH with syscall recovery (HalosGate) and syscall/return-address camouflage (HWSyscalls), and “threadless” injection by patching execution flow near commonly used `ntdll` functions to execute a code-cave trampoline without `NtCreateThread`.  
- It also covers chunked memory allocation/writes (DripLoader-style) to avoid large allocation heuristics, and sleep evasion using FOLIAGE/Ekko-style threadpool timer queues to encrypt/decrypt beacon memory without obvious hooks or RWX patterns.  
- The approach is positioned for red teamers and offensive security researchers building loaders/implants and evaluating EDR detection boundaries, with notes on practical integration using existing public modules (e.g., ThreadlessInject, Ekko, AceLdr).  

Technical Focus:
- PEB-based export resolution (custom `GetProcAddress`), API hashing/string obfuscation
- Hook bypass via hardware breakpoints (DR registers) + Vectored Exception Handling (VEH)
- Syscall number resolution (HalosGate) and syscall/return-address spoofing
- Threadless process injection using code caves + control-flow redirection/trampolines
- Heuristic evasion via chunked `VirtualAlloc`/`WriteProcessMemory` patterns
- Sleep obfuscation (FOLIAGE/Ekko): threadpool timers, `NtContinue`, in-memory encryption

Use Cases:
- Building an evasive Windows loader for controlled red team operations
- Testing EDR detections around API resolution, `ntdll` hooks, and injection chains
- Implementing threadless injection to avoid remote thread creation telemetry
- Adding sleep masking/memory encryption to reduce in-memory beacon exposure
- Researching detection opportunities for VEH/hardware-breakpoint-based syscall execution

Keywords:
process injection, EDR evasion, Windows internals, PEB, export table walking, GetProcAddress, API hashing, ntdll.dll hooks, hardware breakpoints, DR7, Vectored Exception Handler, VEH, direct syscalls, HalosGate, HWSyscalls, ThreadlessInject, code cave, trampoline, VirtualAlloc, WriteProcessMemory, VirtualProtect, sleep masking, FOLIAGE, Ekko, thread pool timers, NtContinue, return address spoofing, AceLdr, ETW, AMSI