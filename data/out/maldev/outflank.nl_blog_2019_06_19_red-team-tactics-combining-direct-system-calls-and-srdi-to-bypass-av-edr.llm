Title:
Red Team Tactics: Combining Direct System Calls and sRDI to bypass AV/EDR

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post explains how to evade AV/EDR user-mode API monitoring by invoking Windows syscalls directly (bypassing Win32/NTDLL call paths commonly hooked by security products).  
- It shows how to implement OS-version-specific syscall stubs in assembly, selected at runtime via `RtlGetVersion`, to call routines like `ZwProtectVirtualMemory` and `ZwWriteVirtualMemory` without traversing hooked APIs.  
- The author then uses these direct syscalls to “unhook” patched NTDLL functions by restoring the first bytes of the original syscall prologue, enabling subsequent API usage with reduced user-mode visibility.  
- As a proof of concept, Outflank’s “Dumpert” creates an LSASS minidump for offline credential extraction (e.g., with Mimikatz) while aiming to avoid common EDR detections tied to API hooks and on-disk tooling.  
- Finally, it combines Dumpert with sRDI (Shellcode Reflective DLL Injection) to convert the dumper DLL into position-independent shellcode and inject it via Cobalt Strike (Aggressor script + `shinject`) for “no-touch-disk” execution.  
- Useful for red teams and offensive tool developers; also relevant to defenders for understanding syscall-based evasion and why kernel-level telemetry becomes more important.

Technical Focus:
- Direct system calls on Windows x64 (`syscall`, SSDT dispatch, syscall numbers)
- Win32 API vs Native API (NTDLL) layering and user-mode hooking
- Unhooking patched NTDLL stubs (restoring syscall prologues)
- LSASS minidump creation for credential access
- sRDI (Shellcode Reflective DLL Injection) and in-memory execution
- Cobalt Strike integration (Aggressor scripting, `shinject`)

Use Cases:
- Bypassing user-mode API hooks to perform sensitive actions (process/memory operations)
- Creating LSASS dumps in environments where procdump/Mimikatz are heavily detected
- Building syscall-based loaders/dumpers that adapt to Windows version/build
- Converting DLL tooling into shellcode for in-memory deployment (sRDI)
- Automating stealthy execution workflows via Cobalt Strike scripts

Keywords:
Windows x64, direct syscalls, syscall numbers, syscall instruction, SSDT, NTDLL, Native API, Win32 API, user-mode hooks, EDR evasion, unhooking, ZwProtectVirtualMemory, ZwWriteVirtualMemory, RtlGetVersion, LSASS, minidump, Mimikatz, Dumpert, sRDI, Cobalt Strike, Aggressor Script, shinject, reflective loading, shellcode injection, PatchGuard