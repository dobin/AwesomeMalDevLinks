Title:
Ebyte-Syscalls — VEH-Based Function Call Obfuscation

Type:
GitHub Tool

Short Summary (4–8 sentences max):
- This repository implements Windows function-call obfuscation and lightweight hooking by redirecting execution through Vectored Exception Handling (VEH) rather than explicit jumps/call patches.  
- It triggers exceptions intentionally (guard-page violations or INT3 breakpoints) and then rewrites the thread context (RIP/EIP) inside the VEH to transfer control to a redirect/hook target.  
- For guard-page hooks, it uses `PAGE_GUARD` via `NtProtectVirtualMemory` and relies on `STATUS_SINGLE_STEP` (trap flag) to reapply guard protections after Windows clears them.  
- For INT3 hooks, it byte-swaps the first instruction byte to `0xCC` and flushes the instruction cache with `NtFlushInstructionCache`.  
- The project emphasizes “byte switching” and in-place modification (no new executable memory allocations, no runtime assembly generation), and resolves Nt* exports via manual PE parsing instead of `GetProcAddress`.  
- Useful for red teams, malware developers, and researchers exploring exception-driven control-flow obfuscation and anti-analysis tradeoffs; defenders can also use it to understand detection opportunities (VEH enumeration, exception-rate anomalies).

Technical Focus:
- Vectored Exception Handler (VEH) control-flow redirection
- `PAGE_GUARD` / `STATUS_GUARD_PAGE_VIOLATION` + trap-flag `STATUS_SINGLE_STEP` re-arming
- INT3 breakpoint hooking (`0xCC`) / `STATUS_BREAKPOINT`
- Thread context manipulation (RIP/EIP, EFlags)
- `NtProtectVirtualMemory` and `NtFlushInstructionCache` usage
- Manual PE export parsing / dynamic API resolution

Use Cases:
- Obfuscate sensitive function calls and indirect execution paths behind exception handling
- Implement stealthier user-mode hooks without allocating trampolines/shellcode buffers
- Prototype EDR-evasion concepts based on exception-driven control flow
- Research/detect VEH-based hooking by monitoring exception patterns and handler registration

Keywords:
Vectored Exception Handler, VEH, PAGE_GUARD, STATUS_GUARD_PAGE_VIOLATION, STATUS_SINGLE_STEP, trap flag, EFlags, STATUS_BREAKPOINT, INT3, 0xCC, thread context, RIP, EIP, NtProtectVirtualMemory, NtFlushInstructionCache, manual PE parsing, export resolution, user-mode hooking, control-flow obfuscation, byte patching