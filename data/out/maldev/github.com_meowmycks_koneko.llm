Title:
koneko — Robust Cobalt Strike shellcode loader with advanced evasion

Type:
GitHub Tool

Short Summary (4–8 sentences max):
- This repository contains a Windows C/C++/x64 assembly shellcode loader designed primarily for running Cobalt Strike Beacon shellcode with multiple evasion features.  
- It focuses on defeating user-mode detections by implementing a custom sleep routine (instead of standard Sleep/SleepEx) and spoofing thread call stacks during idle periods.  
- The loader uses extensive return-address spoofing and indirect syscalls to reduce visibility from API hooking and EDR telemetry.  
- It also includes anti-VM and anti-debug checks and obfuscates embedded shellcode by splitting it into pointer-like chunks using the Windows EncodePointer API.  
- The author notes limitations: the spoofing/obfuscation benefits apply to the current process and don’t automatically carry over after process injection, and the sleep-hooking logic is tailored to Cobalt Strike’s behavior.  
- Useful for red teamers and malware researchers studying modern user-mode evasion patterns and loader tradecraft.

Technical Focus:
- Sleep obfuscation via NtCreateEvent / NtWaitForSingleObject
- Thread call stack spoofing and return address spoofing
- Indirect syscalls (NTAPI syscall invocation patterns)
- Fiber switching to evade memory scanning/heuristics
- Anti-VM and anti-debugging checks
- Shellcode obfuscation using EncodePointer and address-splitting

Use Cases:
- Building/experimenting with stealthy in-process shellcode loaders for lab red teaming
- Researching EDR user-mode hook evasion (API hooking vs indirect syscalls)
- Prototyping sleep-masking/callstack-masking techniques for long-lived implants
- Developing detections for anomalous NTAPI sleep patterns, fibers, and spoofed stacks

Keywords:
Cobalt Strike, Beacon, shellcode loader, Windows internals, sleep obfuscation, call stack spoofing, return address spoofing, indirect syscalls, NTAPI, NtCreateEvent, NtWaitForSingleObject, SleepEx hook, fibers, EncodePointer, anti-VM, anti-debug, EDR evasion, user-mode hooks, Cortex XDR, Microsoft Defender for Endpoint