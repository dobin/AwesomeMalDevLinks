# https://github.com/0xTriboulet/T-1

[Skip to content](https://github.com/0xTriboulet/T-1#start-of-content)

You signed in with another tab or window. [Reload](https://github.com/0xTriboulet/T-1) to refresh your session.You signed out in another tab or window. [Reload](https://github.com/0xTriboulet/T-1) to refresh your session.You switched accounts on another tab or window. [Reload](https://github.com/0xTriboulet/T-1) to refresh your session.Dismiss alert

{{ message }}

This repository was archived by the owner on Nov 9, 2024. It is now read-only.


[0xTriboulet](https://github.com/0xTriboulet)/ **[T-1](https://github.com/0xTriboulet/T-1)** Public archive

- [Notifications](https://github.com/login?return_to=%2F0xTriboulet%2FT-1) You must be signed in to change notification settings
- [Fork\\
5](https://github.com/login?return_to=%2F0xTriboulet%2FT-1)
- [Star\\
34](https://github.com/login?return_to=%2F0xTriboulet%2FT-1)


T-1 is a shellcode loader that leverages ML techniques to detect VM environments


### License

[MIT license](https://github.com/0xTriboulet/T-1/blob/main/LICENSE)

[34\\
stars](https://github.com/0xTriboulet/T-1/stargazers) [5\\
forks](https://github.com/0xTriboulet/T-1/forks) [Branches](https://github.com/0xTriboulet/T-1/branches) [Tags](https://github.com/0xTriboulet/T-1/tags) [Activity](https://github.com/0xTriboulet/T-1/activity)

[Star](https://github.com/login?return_to=%2F0xTriboulet%2FT-1)

[Notifications](https://github.com/login?return_to=%2F0xTriboulet%2FT-1) You must be signed in to change notification settings

# 0xTriboulet/T-1

main

[**1** Branch](https://github.com/0xTriboulet/T-1/branches) [**0** Tags](https://github.com/0xTriboulet/T-1/tags)

[Go to Branches page](https://github.com/0xTriboulet/T-1/branches)[Go to Tags page](https://github.com/0xTriboulet/T-1/tags)

Go to file

Code

Open more actions menu

## Folders and files

| Name | Name | Last commit message | Last commit date |
| --- | --- | --- | --- |
| ## Latest commit<br>[![0xTriboulet](https://avatars.githubusercontent.com/u/22229087?v=4&size=40)](https://github.com/0xTriboulet)[0xTriboulet](https://github.com/0xTriboulet/T-1/commits?author=0xTriboulet)<br>[Create LICENSE](https://github.com/0xTriboulet/T-1/commit/0cfbcb459d668fc12c826ce78dc9a7099143a52e)<br>2 years agoOct 30, 2024<br>[0cfbcb4](https://github.com/0xTriboulet/T-1/commit/0cfbcb459d668fc12c826ce78dc9a7099143a52e) · 2 years agoOct 30, 2024<br>## History<br>[34 Commits](https://github.com/0xTriboulet/T-1/commits/main/) <br>Open commit details<br>[View commit history for this file.](https://github.com/0xTriboulet/T-1/commits/main/) 34 Commits |
| [build](https://github.com/0xTriboulet/T-1/tree/main/build "build") | [build](https://github.com/0xTriboulet/T-1/tree/main/build "build") | [Delete build/T-1.exe](https://github.com/0xTriboulet/T-1/commit/f935f7b245ca55b59daf2d79730b33a26e8bf9b6 "Delete build/T-1.exe") | 2 years agoSep 15, 2024 |
| [inc](https://github.com/0xTriboulet/T-1/tree/main/inc "inc") | [inc](https://github.com/0xTriboulet/T-1/tree/main/inc "inc") | [Implemented InlinedShellcodeExecution and DeleteSelfFromDisk functions](https://github.com/0xTriboulet/T-1/commit/b88005548e4ed350ecc11a0bba4da05bbbcc6731 "Implemented InlinedShellcodeExecution and DeleteSelfFromDisk functions") | 2 years agoAug 17, 2024 |
| [python](https://github.com/0xTriboulet/T-1/tree/main/python "python") | [python](https://github.com/0xTriboulet/T-1/tree/main/python "python") | [python script development, model improvements, train/test splitting, …](https://github.com/0xTriboulet/T-1/commit/17963aaae9a81de4236e2139cc3c944a78f7345b "python script development, model improvements, train/test splitting, renaming to T-1 from T-70") | 2 years agoAug 11, 2024 |
| [src](https://github.com/0xTriboulet/T-1/tree/main/src "src") | [src](https://github.com/0xTriboulet/T-1/tree/main/src "src") | [shellcode credit](https://github.com/0xTriboulet/T-1/commit/caa1b1efd75fd572469bd0cbfc3ce1e52d052b23 "shellcode credit") | 2 years agoAug 17, 2024 |
| [.gitignore](https://github.com/0xTriboulet/T-1/blob/main/.gitignore ".gitignore") | [.gitignore](https://github.com/0xTriboulet/T-1/blob/main/.gitignore ".gitignore") | [Update README and cleanup build artifacts](https://github.com/0xTriboulet/T-1/commit/eafc3612407d7cb557388c77628515f09c143a77 "Update README and cleanup build artifacts  Enhanced the README with a detailed project description, setup instructions, and key features. Also, added the build directory to .gitignore and removed the obsolete executable file.") | 2 years agoSep 15, 2024 |
| [LICENSE](https://github.com/0xTriboulet/T-1/blob/main/LICENSE "LICENSE") | [LICENSE](https://github.com/0xTriboulet/T-1/blob/main/LICENSE "LICENSE") | [Create LICENSE](https://github.com/0xTriboulet/T-1/commit/0cfbcb459d668fc12c826ce78dc9a7099143a52e "Create LICENSE") | 2 years agoOct 30, 2024 |
| [Makefile](https://github.com/0xTriboulet/T-1/blob/main/Makefile "Makefile") | [Makefile](https://github.com/0xTriboulet/T-1/blob/main/Makefile "Makefile") | [Added the ability to distinguish errors to discern an implicit third …](https://github.com/0xTriboulet/T-1/commit/8c755d5d6ce1256f4670243bb2a222edb8bb1cf9 "Added the ability to distinguish errors to discern an implicit third user, similar to the python mechanic") | 2 years agoAug 11, 2024 |
| [README.md](https://github.com/0xTriboulet/T-1/blob/main/README.md "README.md") | [README.md](https://github.com/0xTriboulet/T-1/blob/main/README.md "README.md") | [Rename project title in README.md](https://github.com/0xTriboulet/T-1/commit/8b3c1f9d6dfa8d4f5f3822a45e12582f3cb400db "Rename project title in README.md  Changed the project title from \"Ground Offensive System\" to \"Intelligent VM Detection with DTC.\" This update better reflects the current scope and goals of the project.") | 2 years agoSep 15, 2024 |
| View all files |

## Repository files navigation

# T-1: Intelligent VM Detection with DTC

[Permalink: T-1: Intelligent VM Detection with DTC](https://github.com/0xTriboulet/T-1#t-1-intelligent-vm-detection-with-dtc)

## Project Overview

[Permalink: Project Overview](https://github.com/0xTriboulet/T-1#project-overview)

**T-1** is a C++ project inspired by the **T-1 Battlefield Robot**, also known as the **T-1 Ground Assault Vehicle**, which is a fully autonomous ground offensive system developed by Cyber Research Systems. This project simulates part of the logic behind the T-1 by leveraging a **Decision Tree Classifier (DTC)** trained using Python's **scikit-learn** library to implement VM detection in a C++ environment.

The model is trained to predict whether the system is running on a virtual machine based on the number of processes per user. The trained model is then used to implement VM detection in the C++ file `VmDetection.cxx`. The decision tree logic is extracted and converted into conditional statements that can be applied in any language, allowing the developer to integrate machine learning predictions into a C++ application.

### Key Features:

[Permalink: Key Features:](https://github.com/0xTriboulet/T-1#key-features)

- **Decision Tree Classifier (DTC) Training**: A Python script uses `scikit-learn` to train a decision tree model based on system data, which can be visualized and implemented in C++.
- **VM Detection**: Implements the decision tree logic in the function `VmDetection` to determine whether the system is running on bare metal or inside a virtual machine.
- **Self-Deletion and Shellcode Execution**: Based on the VM detection result, the system can either execute shellcode or self-delete when running in a virtualized environment.

## Project Structure

[Permalink: Project Structure](https://github.com/0xTriboulet/T-1#project-structure)

- **`main.cxx`**: The main entry point of the project, which handles process and user counting, executes VM detection, and takes appropriate action based on the result.

- **`intelligence.h`**: Contains declarations for system functions such as `GetProcessCountViaSnapShot`, `GetUniqueUserCountViaSnapshot`, and `VmDetection`.

- **`VmDetection.cxx`**: Implements the `VmDetection` logic based on the decision tree classifier's learnings.

- **Python Scripts**:
  - The `python` directory contains scripts for training the decision tree classifier on system data, visualizing the model, and exporting the learned logic for use in C++.

## Decision Tree Classifier Logic

[Permalink: Decision Tree Classifier Logic](https://github.com/0xTriboulet/T-1#decision-tree-classifier-logic)

The `VmDetection` function in C++ is based on the decision tree classifier model, which uses the `process_count_per_user` as the main feature to detect whether the system is virtualized or not:

```
BOOL VmDetection(float process_count_per_user){

	// Conditional extracted from DecisionTreeClassifier learnings
	if ((process_count_per_user > 75.3) || (process_count_per_user > 61.45 && process_count_per_user <= 69.3)){

		PRINT("[i] Running on bare metal machine!\n");
		return TRUE;

	}

	return FALSE;
}
```

This logic is derived from the decision tree model's learnings and applied to the `VmDetection` function in C++.

## Dependencies

[Permalink: Dependencies](https://github.com/0xTriboulet/T-1#dependencies)

- **C++**: The project is written in C++ and utilizes standard C++ libraries for system interaction.
- **scikit-learn (Python)**: Used for training the decision tree model. The `python` directory contains all scripts and data needed to train and visualize the model.

## Setup Instructions

[Permalink: Setup Instructions](https://github.com/0xTriboulet/T-1#setup-instructions)

### Step 1: Train the Decision Tree Classifier

[Permalink: Step 1: Train the Decision Tree Classifier](https://github.com/0xTriboulet/T-1#step-1-train-the-decision-tree-classifier)

The first step is to train the decision tree classifier using the provided Python scripts. These scripts are located in the `python` directory:

```
cd .\python\DecisionTree
python decision_tree.py
```

This script will train the model based on the collected system data and output a visualization of the decision tree, which you can use to understand the model's decision-making process.

### Step 2: Build the C++ Project

[Permalink: Step 2: Build the C++ Project](https://github.com/0xTriboulet/T-1#step-2-build-the-c-project)

Once the decision tree logic has been extracted and implemented in `VmDetection.cxx`, you can build the C++ project using a standard C++ compiler.

```
mingw32-make.exe
```

### Step 3: Run the Executable

[Permalink: Step 3: Run the Executable](https://github.com/0xTriboulet/T-1#step-3-run-the-executable)

After building the project, you can run the executable to perform VM detection and trigger appropriate actions:

```
./build/T-1.exe
```

## Special Thanks

[Permalink: Special Thanks](https://github.com/0xTriboulet/T-1#special-thanks)

Special thanks to all the researchers who voluntarily ran the Python script to collect the necessary data for training the Decision Tree Classifier. Your contributions made this project possible!

## License

[Permalink: License](https://github.com/0xTriboulet/T-1#license)

T-1 is licensed under the MIT License.

* * *

_Inspired by the T-1 Ground Assault Vehicle, the first Terminator-class robot._

More information: [T-1 Terminator](https://terminator.fandom.com/wiki/T-1)

## About

T-1 is a shellcode loader that leverages ML techniques to detect VM environments


### Resources

[Readme](https://github.com/0xTriboulet/T-1#readme-ov-file)

### License

[MIT license](https://github.com/0xTriboulet/T-1#MIT-1-ov-file)

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/0xTriboulet/T-1).

[Activity](https://github.com/0xTriboulet/T-1/activity)

### Stars

[**34**\\
stars](https://github.com/0xTriboulet/T-1/stargazers)

### Watchers

[**1**\\
watching](https://github.com/0xTriboulet/T-1/watchers)

### Forks

[**5**\\
forks](https://github.com/0xTriboulet/T-1/forks)

[Report repository](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2F0xTriboulet%2FT-1&report=0xTriboulet+%28user%29)

## [Releases](https://github.com/0xTriboulet/T-1/releases)

No releases published

## [Packages\  0](https://github.com/users/0xTriboulet/packages?repo_name=T-1)

No packages published

## Languages

- [C++58.6%](https://github.com/0xTriboulet/T-1/search?l=c%2B%2B)
- [Python30.2%](https://github.com/0xTriboulet/T-1/search?l=python)
- [Makefile7.1%](https://github.com/0xTriboulet/T-1/search?l=makefile)
- [C4.1%](https://github.com/0xTriboulet/T-1/search?l=c)

You can’t perform that action at this time.