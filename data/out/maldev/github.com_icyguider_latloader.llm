Title:
LatLoader — Automated Lateral Movement PoC Module for Havoc C2 (with Elastic EDR rule evasion notes)

Type:
GitHub Tool

Short Summary (4–8 sentences max):
LatLoader is a proof-of-concept Havoc C2 module demonstrating automated lateral movement workflows and BOF/module development. It provides subcommands to upload payloads over SMB and execute commands remotely via WMI, plus combined “one-shot” movement primitives (`load`, `xorload`, `sideload`). The most feature-complete path (`sideload`) performs DLL sideloading of a shellcode loader and documents specific bypasses for multiple default Elastic EDR behavioral rules (e.g., avoiding direct execution of SMB-dropped binaries, leveraging excluded paths, and signing a DLL with an expired certificate). The repo also includes standalone (non-BOF) equivalents of the WMI exec and SMB write utilities to help learners compare implementations. It’s primarily useful for red teamers/pentesters learning Havoc + BOF tradecraft and for defenders validating/understanding detection logic gaps and rule assumptions. Notably, the author highlights that Elastic updated rules shortly after release, making it a good case study in detection iteration and attacker adaptation.

Technical Focus:
- Havoc C2 module development and BOF (Beacon Object File) tradecraft
- SMB-based remote file transfer and remote tool staging
- WMI remote process creation/execution (WBEM/COM)
- DLL sideloading for remote execution
- EDR behavioral rule evasion patterns (Elastic rules) and detection engineering feedback loop
- Shellcode loading and memory permission changes (e.g., VirtualProtect / NtAllocateVirtualMemory, HWBP syscalls PoC)

Use Cases:
- Automate lateral movement steps (stage over SMB, execute via WMI) from Havoc
- Learn/teach BOF development by comparing BOFs to standalone binaries
- Reproduce and study Elastic EDR behavioral detections and bypass conditions
- Build lab exercises for purple teaming around lateral movement telemetry
- Prototype alternate loaders (XOR shellcode loader, DLL sideloader variants)

Keywords:
Havoc C2, BOF, Beacon Object File, lateral movement, SMB, WMI, WBEM, COM, ProcessCreate, DLL sideloading, shellcode loader, VirtualProtect, NtAllocateVirtualMemory, HWSyscalls, hardware breakpoints, Elastic EDR, behavioral rules, YARA, osslsigncode, mingw-w64, code signing, expired certificate, defense evasion