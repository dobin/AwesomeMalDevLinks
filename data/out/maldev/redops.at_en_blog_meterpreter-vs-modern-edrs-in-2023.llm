Title:
Meterpreter vs Modern EDR(s)

Type:
Blog Post

Short Summary (4–8 sentences max):
- The post evaluates how well a basic Meterpreter staged reverse_tcp shellcode dropper is detected by a modern (unnamed) EDR in 2023, and shows that small loader changes can materially affect outcomes.  
- It starts from a simple C++ self-injection loader using `VirtualAlloc(PAGE_EXECUTE_READWRITE)`, `memcpy`, and direct execution via a function pointer, which is statically detected and quarantined due to Meterpreter signatures.  
- Three incremental modifications are tested: XOR-encrypting the embedded shellcode to reduce static signature hits, adding “legitimate” PE metadata via a manifest (impersonating Process Explorer), and relocating the shellcode bytes from `.text/.rdata` to `.data` by making it a global variable.  
- The author observes inconsistent results for XOR and metadata alone (varying static/dynamic detections and alert severity), but reports that the combined approach—especially moving shellcode to `.data`—resulted in repeated executions without detection and a stable C2 session.  
- File entropy is tracked across variants, with the claim that certain entropy ranges appeared to correlate with lower detection likelihood in their tests.  
- Useful for red teamers and malware devs building Windows shellcode loaders, and for blue teams to understand how superficial PE/loader traits can influence EDR scoring beyond “advanced” syscall/unhooking techniques.

Technical Focus:
- Windows shellcode loader pattern (VirtualAlloc RWX + memcpy + direct execution)
- Static vs dynamic EDR detection and alert prioritization
- XOR shellcode obfuscation and in-memory decryption
- PE metadata/manifest-based “legitimacy” signals
- PE section placement differences (`.text/.rdata` vs `.data`) and detection impact
- Shannon entropy as a heuristic for file classification

Use Cases:
- Building/iterating simple Windows shellcode droppers to test EDR sensitivity
- Demonstrating how PE metadata and section layout affect static scoring
- Creating lab exercises for EDR evasion fundamentals (loader tradecraft)
- Developing defensive detections for RWX allocation + shellcode execution patterns
- Threat hunting for unbacked executable memory and suspicious memory protections

Keywords:
Meterpreter, Metasploit, msfvenom, windows/x64/meterpreter/reverse_tcp, EDR evasion, shellcode dropper, self-injection, VirtualAlloc, PAGE_EXECUTE_READWRITE, MEM_COMMIT, memcpy, RWX memory, unbacked executable memory, PE sections, .text, .rdata, .data, manifest, version metadata, Process Explorer, static detection, dynamic analysis, Shannon entropy, pestudio, CFF Explorer, C2 channel