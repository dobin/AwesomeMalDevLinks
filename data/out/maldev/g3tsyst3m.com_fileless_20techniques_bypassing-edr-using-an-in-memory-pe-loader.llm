Title:
Bypassing EDR using an In-Memory PE Loader

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post walks through building a custom 64-bit in-memory PE loader that downloads an EXE from a remote URL (GitHub) and executes it without writing to disk.  
- The goal is “dynamic execution” inside an already-trusted process context to reduce disk-based and initial execution detections commonly used by EDR.  
- It covers the core steps of manual PE mapping: parsing DOS/NT headers, allocating memory, copying headers/sections, applying base relocations, resolving imports (IAT), setting per-section memory protections, and calling the PE entry point.  
- The author demonstrates loading benign GUI software (PuTTY) and later references loading known offensive tooling (e.g., EDRSilencer, Mimikatz) to illustrate detection impact.  
- Useful primarily for red teamers, pentesters, and malware developers interested in fileless tradecraft and custom loaders; also relevant to blue teams for understanding what telemetry/manual-mapping behaviors to hunt.  
- Interesting because it provides a straightforward, end-to-end implementation of a reflective-style EXE loader using common Win32 APIs rather than relying on off-the-shelf frameworks.

Technical Focus:
- Manual PE mapping (in-memory loading of EXE images)
- PE format parsing (DOS header, NT headers, section headers)
- Import resolution (LoadLibraryA/GetProcAddress, IAT patching)
- Base relocations (IMAGE_DIRECTORY_ENTRY_BASERELOC, DIR64)
- Memory allocation and protection changes (VirtualAlloc, VirtualProtect)
- Remote payload retrieval via WinINet (InternetOpenA/InternetOpenUrlA/InternetReadFile)

Use Cases:
- Fileless execution of remote payloads (EXE) from memory
- Custom loader development for red team operations to reduce disk artifacts
- Testing EDR detection gaps around manual mapping vs. standard process creation
- Building/understanding reflective loading tradecraft (foundation for DLL reflective loaders)
- Defensive research: creating detections for manual-map behaviors (relocations/IAT writes/RWX transitions)

Keywords:
in-memory PE loader, manual mapping, reflective loading, Portable Executable, PE headers, IMAGE_NT_HEADERS64, section mapping, relocations, IMAGE_DIRECTORY_ENTRY_BASERELOC, IMAGE_REL_BASED_DIR64, import table, IAT patching, LoadLibraryA, GetProcAddress, VirtualAlloc, VirtualProtect, WinINet, InternetOpenUrlA, fileless execution, EDR evasion