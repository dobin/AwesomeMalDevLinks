Title:
New Process Injection Class: The CONTEXT-Only Attack Surface

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post introduces “context-only” process injection techniques on Windows that aim to bypass common EDR correlation logic by avoiding the classic allocate→write→execute chain.  
- It demonstrates a pointer-only `LoadLibraryA` injection that uses an existing shared string inside `ntdll.dll` (e.g., `"0"`) as the remote thread argument, causing the target to load `0.dll` without any remote memory writes.  
- The authors then expand execution-only primitives by combining `CreateRemoteThread` with thread context manipulation (`SetThreadContext`) to call arbitrary functions with up to four controlled parameters (x64 calling convention), using in-process ROP gadgets to fix stack/return flow and exit cleanly.  
- A deeper section explores using `NtCreateThread` with a pre-supplied `CONTEXT`/`INITIAL_TEB`, including kernel-level reasoning for why it fails under mitigations like CFG/IAF and succeeds more often in non-Microsoft binaries.  
- ETW is used to show remote thread creation is noisy/legitimate in many environments, explaining why “remote thread == malicious” is hard to operationalize.  
- It’s useful for red teams and security researchers building stealthier injection tradecraft, and for blue teams refining detection models beyond “2-of-3” injection telemetry correlation.

Technical Focus:
- Execution-only / context-only process injection primitives
- Pointer-only `LoadLibrary` via shared `ntdll` data and DLL search order
- Thread context hijacking (`SetThreadContext`, `NtSetContextThread`) and x64 calling convention (RCX/RDX/R8/R9)
- ROP gadget discovery and stack/return repair for remote threads
- `NtCreateThread` internals and mitigation gates (CFG, IAF, Minimal Process)
- ETW-based measurement of cross-process thread creation “noise”

Use Cases:
- Bypassing EDR rules that correlate `VirtualAllocEx`/`WriteProcessMemory` with execution triggers
- DLL injection without remote memory allocation or writes (pointer-only argument reuse)
- Shellcode staging where the target process performs “local” allocation/writes under coerced execution
- Researching/validating detection opportunities around context manipulation and unusual thread lifecycles
- Building PoCs and operator tooling (RedirectThread) for controlled experimentation across injection methods

Keywords:
Windows process injection, CONTEXT, SetThreadContext, GetThreadContext, CreateRemoteThread, NtCreateThread, NtCreateThreadEx, LoadLibraryA, ntdll.dll, shared sections, copy-on-write, ASLR, DLL search order, ROP gadget, x64 calling convention, RIP, RSP, TEB, CFG, Import Address Filtering, ETW, QueueUserAPC, NtQueueApcThreadEx2, RtlUserThreadStart, BaseThreadInitThunk