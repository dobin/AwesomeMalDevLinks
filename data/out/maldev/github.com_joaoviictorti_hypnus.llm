Title:
hypnus — Sleep Obfuscation in Rust

Type:
GitHub Tool

Short Summary (4–8 sentences max):
- Hypnus is a Rust library for “execution/sleep obfuscation” on Windows that encrypts selected memory regions while a program is inactive (sleep window) and restores them afterward.  
- It aims to reduce in-memory exposure of payloads (e.g., shellcode buffers or even the full PE image) and to make the execution flow harder to analyze by combining memory protection with dynamic call stack spoofing.  
- The library implements multiple sleep mechanisms using Windows thread pool primitives (`TpSetTimer`, `TpSetWait`) and an APC-based approach (`NtQueueApcThread`), chaining spoofed callbacks rather than duplicating threads.  
- It optionally supports heap obfuscation via a custom allocator (`HypnusHeap`) and can register spoofed call targets with Control Flow Guard (CFG) when enabled.  
- It supports `#[no_std]` (with `alloc`) and notes that `no_std` is recommended when obfuscating the entire process image to avoid `std`/TLS-related access violations.  
- Useful primarily for red teams, offensive tool developers, and malware researchers building stealthier Windows implants/loaders; also relevant to blue teams for understanding modern sleep/memory evasion patterns.

Technical Focus:
- Windows sleep obfuscation (timer/wait/APC-based)
- Memory region encryption/decryption during inactivity
- Dynamic call stack spoofing / stack trace evasion
- Windows Thread Pool APIs (`TpSetTimer`, `TpSetWait`)
- APC execution (`NtQueueApcThread`)
- Heap obfuscation via custom allocator + CFG considerations

Use Cases:
- Implement encrypted “sleep” for in-memory payload buffers to reduce scanable dwell time
- Add stack-spoofed API chains around sensitive operations (encrypt/decrypt/protect)
- Build `no_std` Rust loaders that can obfuscate large memory regions (including PE image)
- Experiment with thread-pool–driven callback execution patterns for evasion research
- Evaluate/detect threadpool/APC-based sleep obfuscation behaviors in EDR testing

Keywords:
Rust, Windows, sleep obfuscation, memory encryption, in-memory evasion, call stack spoofing, Thread Pool, TpSetTimer, TpSetWait, wait objects, APC, NtQueueApcThread, Control Flow Guard, CFG, no_std, alloc, HypnusHeap, custom allocator, RWX protection, Ekko, Foliage, UWD