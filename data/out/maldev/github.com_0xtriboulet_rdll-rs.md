# https://github.com/0xTriboulet/rdll-rs

[Skip to content](https://github.com/0xTriboulet/rdll-rs#start-of-content)

You signed in with another tab or window. [Reload](https://github.com/0xTriboulet/rdll-rs) to refresh your session.You signed out in another tab or window. [Reload](https://github.com/0xTriboulet/rdll-rs) to refresh your session.You switched accounts on another tab or window. [Reload](https://github.com/0xTriboulet/rdll-rs) to refresh your session.Dismiss alert

{{ message }}

[0xTriboulet](https://github.com/0xTriboulet)/ **[rdll-rs](https://github.com/0xTriboulet/rdll-rs)** Public template

- [Notifications](https://github.com/login?return_to=%2F0xTriboulet%2Frdll-rs) You must be signed in to change notification settings
- [Fork\\
11](https://github.com/login?return_to=%2F0xTriboulet%2Frdll-rs)
- [Star\\
113](https://github.com/login?return_to=%2F0xTriboulet%2Frdll-rs)


A reflective DLL development template for the Rust programming language


### License

[Apache-2.0 license](https://github.com/0xTriboulet/rdll-rs/blob/master/LICENSE.txt)

[113\\
stars](https://github.com/0xTriboulet/rdll-rs/stargazers) [11\\
forks](https://github.com/0xTriboulet/rdll-rs/forks) [Branches](https://github.com/0xTriboulet/rdll-rs/branches) [Tags](https://github.com/0xTriboulet/rdll-rs/tags) [Activity](https://github.com/0xTriboulet/rdll-rs/activity)

[Star](https://github.com/login?return_to=%2F0xTriboulet%2Frdll-rs)

[Notifications](https://github.com/login?return_to=%2F0xTriboulet%2Frdll-rs) You must be signed in to change notification settings

# 0xTriboulet/rdll-rs

master

[**2** Branches](https://github.com/0xTriboulet/rdll-rs/branches) [**0** Tags](https://github.com/0xTriboulet/rdll-rs/tags)

[Go to Branches page](https://github.com/0xTriboulet/rdll-rs/branches)[Go to Tags page](https://github.com/0xTriboulet/rdll-rs/tags)

Go to file

Code

Open more actions menu

## Folders and files

| Name | Name | Last commit message | Last commit date |
| --- | --- | --- | --- |
| ## Latest commit<br>[![0xTriboulet](https://avatars.githubusercontent.com/u/22229087?v=4&size=40)](https://github.com/0xTriboulet)[0xTriboulet](https://github.com/0xTriboulet/rdll-rs/commits?author=0xTriboulet)<br>[restore pipe name to default](https://github.com/0xTriboulet/rdll-rs/commit/44912f4da1381fbec8c81629be92ace759f1ca62)<br>3 months agoNov 4, 2025<br>[44912f4](https://github.com/0xTriboulet/rdll-rs/commit/44912f4da1381fbec8c81629be92ace759f1ca62) · 3 months agoNov 4, 2025<br>## History<br>[49 Commits](https://github.com/0xTriboulet/rdll-rs/commits/master/) <br>Open commit details<br>[View commit history for this file.](https://github.com/0xTriboulet/rdll-rs/commits/master/) 49 Commits |
| [build-deps](https://github.com/0xTriboulet/rdll-rs/tree/master/build-deps "build-deps") | [build-deps](https://github.com/0xTriboulet/rdll-rs/tree/master/build-deps "build-deps") | [submodule folder](https://github.com/0xTriboulet/rdll-rs/commit/8437a77933353bf4c75a7d5969c1e2a77fddbf0e "submodule folder") | 9 months agoMay 10, 2025 |
| [dll](https://github.com/0xTriboulet/rdll-rs/tree/master/dll "dll") | [dll](https://github.com/0xTriboulet/rdll-rs/tree/master/dll "dll") | [fix broken pipe comms](https://github.com/0xTriboulet/rdll-rs/commit/7e75b2e6c4b00049d0a6e289100949179e51d53f "fix broken pipe comms") | 3 months agoNov 4, 2025 |
| [exe](https://github.com/0xTriboulet/rdll-rs/tree/master/exe "exe") | [exe](https://github.com/0xTriboulet/rdll-rs/tree/master/exe "exe") | [named pipe support and some refactoring](https://github.com/0xTriboulet/rdll-rs/commit/62ebcca03dc8b3206a96810722d6c25d7ec68635 "named pipe support and some refactoring") | 9 months agoMay 10, 2025 |
| [xtask](https://github.com/0xTriboulet/rdll-rs/tree/master/xtask "xtask") | [xtask](https://github.com/0xTriboulet/rdll-rs/tree/master/xtask "xtask") | [refactor the C FFI linkage and build.rs](https://github.com/0xTriboulet/rdll-rs/commit/b007de6c08a51db8b936b828ea66a1e1bfea026b "refactor the C FFI linkage and build.rs") | 9 months agoMay 11, 2025 |
| [.gitignore](https://github.com/0xTriboulet/rdll-rs/blob/master/.gitignore ".gitignore") | [.gitignore](https://github.com/0xTriboulet/rdll-rs/blob/master/.gitignore ".gitignore") | [Add pe\_to\_shellcode submodule and usage instructions](https://github.com/0xTriboulet/rdll-rs/commit/5f4eea5031419e799335c3c70b5120625fb75757 "Add pe_to_shellcode submodule and usage instructions  Introduced a git submodule for hasherezade's pe_to_shellcode under `build-deps/`. Updated `.gitignore` and `readme.md` to reflect submodule usage and provide build instructions for creating a Reflective DLL.") | 9 months agoMay 10, 2025 |
| [.gitmodules](https://github.com/0xTriboulet/rdll-rs/blob/master/.gitmodules ".gitmodules") | [.gitmodules](https://github.com/0xTriboulet/rdll-rs/blob/master/.gitmodules ".gitmodules") | [Add pe\_to\_shellcode submodule and usage instructions](https://github.com/0xTriboulet/rdll-rs/commit/5f4eea5031419e799335c3c70b5120625fb75757 "Add pe_to_shellcode submodule and usage instructions  Introduced a git submodule for hasherezade's pe_to_shellcode under `build-deps/`. Updated `.gitignore` and `readme.md` to reflect submodule usage and provide build instructions for creating a Reflective DLL.") | 9 months agoMay 10, 2025 |
| [Cargo.toml](https://github.com/0xTriboulet/rdll-rs/blob/master/Cargo.toml "Cargo.toml") | [Cargo.toml](https://github.com/0xTriboulet/rdll-rs/blob/master/Cargo.toml "Cargo.toml") | [Add Reflective DLL support and xtask utility](https://github.com/0xTriboulet/rdll-rs/commit/f9063cfbc6971b17ee115ca5179d5f5389d0ca71 "Add Reflective DLL support and xtask utility  Introduced a new `xtask` for building Reflective DLLs and integrated [pe_to_shellcode] for enhanced compatibility. Updated `dll/src/lib.rs` with ReflectiveLoader logic, added necessary FFI bindings, and extended documentation to include the build process and usage.") | 9 months agoMay 10, 2025 |
| [LICENSE.txt](https://github.com/0xTriboulet/rdll-rs/blob/master/LICENSE.txt "LICENSE.txt") | [LICENSE.txt](https://github.com/0xTriboulet/rdll-rs/blob/master/LICENSE.txt "LICENSE.txt") | [license](https://github.com/0xTriboulet/rdll-rs/commit/fd9eb3c6b718c73550ddacc64e4b8833ce55f21d "license") | 10 months agoMay 3, 2025 |
| [img.png](https://github.com/0xTriboulet/rdll-rs/blob/master/img.png "img.png") | [img.png](https://github.com/0xTriboulet/rdll-rs/blob/master/img.png "img.png") | [readme](https://github.com/0xTriboulet/rdll-rs/commit/b94f4349ecb4e9d9f0a2c13f967498a2bbc3ddf3 "readme") | 9 months agoMay 11, 2025 |
| [img\_1.png](https://github.com/0xTriboulet/rdll-rs/blob/master/img_1.png "img_1.png") | [img\_1.png](https://github.com/0xTriboulet/rdll-rs/blob/master/img_1.png "img_1.png") | [readme](https://github.com/0xTriboulet/rdll-rs/commit/93cda6959adb942c840e574330fbd84a95b26ed1 "readme") | 9 months agoMay 11, 2025 |
| [rdll-rs.cna](https://github.com/0xTriboulet/rdll-rs/blob/master/rdll-rs.cna "rdll-rs.cna") | [rdll-rs.cna](https://github.com/0xTriboulet/rdll-rs/blob/master/rdll-rs.cna "rdll-rs.cna") | [restore pipe name to default](https://github.com/0xTriboulet/rdll-rs/commit/44912f4da1381fbec8c81629be92ace759f1ca62 "restore pipe name to default") | 3 months agoNov 4, 2025 |
| [readme.md](https://github.com/0xTriboulet/rdll-rs/blob/master/readme.md "readme.md") | [readme.md](https://github.com/0xTriboulet/rdll-rs/blob/master/readme.md "readme.md") | [readme](https://github.com/0xTriboulet/rdll-rs/commit/348412901d73a9364aaa7f8c301fd9788005252e "readme") | 9 months agoMay 18, 2025 |
| [rust-toolchain.toml](https://github.com/0xTriboulet/rdll-rs/blob/master/rust-toolchain.toml "rust-toolchain.toml") | [rust-toolchain.toml](https://github.com/0xTriboulet/rdll-rs/blob/master/rust-toolchain.toml "rust-toolchain.toml") | [Execute `calc.exe` on DLL load instead of panicking.](https://github.com/0xTriboulet/rdll-rs/commit/18839ad433b64d17d771bbf916e0fe0f25ff9b17 "Execute `calc.exe` on DLL load instead of panicking.  Replaced the panic call with a command to execute `calc.exe` upon DLL load. This ensures a behavior change from terminating the process to launching the calculator application.") | 10 months agoMay 3, 2025 |
| View all files |

## Repository files navigation

# rdll-rs

[Permalink: rdll-rs](https://github.com/0xTriboulet/rdll-rs#rdll-rs)

A Rust DLL template project that integrates [pe2shc](https://github.com/hasherezade/pe_to_shellcode) to facilitate the development of [Reflective DLLs](https://github.com/stephenfewer/ReflectiveDLLInjection). The template presently only supports 64-bit DLL development in most contexts, though with a few tweaks it should support 32-bit.

## Overview

[Permalink: Overview](https://github.com/0xTriboulet/rdll-rs#overview)

rdll-rs is a Rust template that can be compiled as both a dynamic-link library (DLL), a regular executable, or a Reflective DLL. It provides an example of how to create Windows DLLs using Rust, including proper exports and Windows API integration.

This project is broken down into "main" branches `master` and `master-legacy`.

- `master` is intended for use with modern prepend loaders.
- `master-legacy` retains the necessary symbols for compatibility with stomp-style reflective loaders.

## Features

[Permalink: Features](https://github.com/0xTriboulet/rdll-rs#features)

- Dual compilation modes (DLL and executable)
- Windows API integration through FFI
- Example exported functions
- DLL lifecycle management

## Project Structure

[Permalink: Project Structure](https://github.com/0xTriboulet/rdll-rs#project-structure)

- `dll/src/lib.rs` \- Library entry point
- `dll/c_src/c_entry.c` \- Entry point for C code via FFI
- `exe/src/main.rs` \- Executable implementation
- `build-deps/pe_to_shellcode` \- Post-build stomp reflective loader
- Supporting Rust source files

## Building

[Permalink: Building](https://github.com/0xTriboulet/rdll-rs#building)

To build the project, use Cargo:

```
cargo build
```

Or to build in release:

```
cargo build --release
```

Or to build a Reflective DLL:

```
cargo run --bin xtask --release
```

## Usage

[Permalink: Usage](https://github.com/0xTriboulet/rdll-rs#usage)

The project can be used in three ways:

1. As a DLL ( **dll-rs.dll**):

   - Build in release mode to generate the DLL
   - The DLL exports a `DllMain` function and example functionality
2. As an executable ( **debug-executable.exe**):

   - Run in debug mode to test DLL functionality without DLL debugging gymnastics
   - Running in release mode will display a warning message
   - **NOTE: For maximum compatability with this template, all functionality should be called from `dll_main` in `dll/src/lib.rs`**
3. As a Reflective DLL ( **dll\_rs.shc.dll**) using [@hasherezade's](https://github.com/hasherezade) [pe\_to\_shellcode](https://github.com/hasherezade/pe_to_shellcode)
   - Resolve submodules with `git submodule update --init --recursive`
   - `cd .\build-deps\pe_to_shellcode\`
   - `cmake .`
   - `cmake --build . --config Release`
   - `cd ..\..`
   - `cargo run --bin xtask --release`
   - Use your Reflective DLL in `target/release/dll_rs.shc.dll`
   - **NOTE: If the build process above is too complicated/broken for your taste, simply placing the [`pe2shc.exe`](https://github.com/hasherezade/pe_to_shellcode/releases/download/v1.2/pe2shc.exe) executable in the proper folder structure (`build-deps/pe_to_shellcode/pe2shc/Release/pe2shc.exe`) will work.**

## Getting Reflective DLL Output to Beacon Console

[Permalink: Getting Reflective DLL Output to Beacon Console](https://github.com/0xTriboulet/rdll-rs#getting-reflective-dll-output-to-beacon-console)

This template includes a `write_output` function which allows for output via named pipes to the Beacon console (in a very hacky way).
This works by loading the `rdll-rs.cna` which registers two commands: `rdll-exec` and `rdll-read`.

- `rdll-exec` stomps the pipe name specified in the `.cna` into the `dll_rs.shc.dll`, then injects the DLL via the `bdllinject` aggressor function.
- `rdll-read` uses `CommandBuilder` to build a custom task to read from the pipe and output the contents to the Beacon console.
- **NOTE: `write_output` is BLOCKING so it should only be used to write output to the Beacon console all at once (ie once your intended functionality is entirely complete).**

[![img_1.png](https://github.com/0xTriboulet/rdll-rs/raw/master/img_1.png)](https://github.com/0xTriboulet/rdll-rs/blob/master/img_1.png)

## Using Other Reflective Loaders

[Permalink: Using Other Reflective Loaders](https://github.com/0xTriboulet/rdll-rs#using-other-reflective-loaders)

The `master` branch of this repository abandoned compatability with stomp loaders in favor of more generic prepend-style (sRDI) reflective loaders. For stomp-style support see the `master-legacy` branch. Some implementations of reflective loaders obfuscate the DLL. This can be helpful in some contexts but applying the obfuscation on the DLL before execution of the `.cna` results in a failure to stomp the appropriate pipe name into the DLL, breaking `write_output` functionality. To mitigate the risk of this, it's recommended that a manual stomp step be applied before the reflective loader is applied to the DLL. An example workflow that uses a PowerShell one-liner is below:

- `cargo build --release`
- `cd target/release`
- ``$path = "dll_rs.dll"; $bytes = [System.IO.File]::ReadAllBytes($path); $search = [System.Text.Encoding]::ASCII.GetBytes("RDLL_PIPE_NAME_NO_CHANGE_PLS"); $replace = [System.Text.Encoding]::ASCII.GetBytes("macrohard_updates`0".PadRight($search.Length, "`0")); for ($i = 0; $i -le $bytes.Length - $search.Length; $i++) { $match = $true; for ($j = 0; $j -lt $search.Length; $j++) { if ($bytes[$i + $j] -ne $search[$j]) { $match = $false; break } } if ($match) { $replace.CopyTo($bytes, $i); break } }; [System.IO.File]::WriteAllBytes($path, $bytes)``
  - **Note that `macrohard_updates` should match the pipe name in the `.cna` and has the same length limitation (28-bytes).**
- `donut --input:dll_rs.dll -o dll_rs.shc.dll`

## I don't want to learn Rust

[Permalink: I don't want to learn Rust](https://github.com/0xTriboulet/rdll-rs#i-dont-want-to-learn-rust)

I encourage you to try it sometime. However, to support the integration of C code a [Foreign Function Interface (FFI)](https://doc.rust-lang.org/nomicon/ffi.html) entry point (`dll/c_src/c_entry.c`) has been added to the template to allow you to call into C code from Rust.
[![img.png](https://github.com/0xTriboulet/rdll-rs/raw/master/img.png)](https://github.com/0xTriboulet/rdll-rs/blob/master/img.png)

If you want to add more `.c` files, be sure to add them to the `dll/c_src` directory because that's the intended convention, and define desired FFI functions in `dll/ffi.rs` if you want to call them from Rust. The build script `dll/build.rs` builds all `.c` files in the `c_src` directory into a single
static library (`c_code`) that is linked into the Rust DLL.

## Technical Details

[Permalink: Technical Details](https://github.com/0xTriboulet/rdll-rs#technical-details)

- Uses `cdylib` and `rlib` crate types
- Implements Windows API bindings
- Provides internal FFI declarations for Windows types
- Includes DLL entry point handling
- Remember: For maximum compatability with this template, all functionality should be called from `dll_main` in `dll/src/lib.rs`
- Supports the command-line ergonomics of the `shinject` in your [favorite C2 Framework](https://www.cobaltstrike.com/).

## Comments

[Permalink: Comments](https://github.com/0xTriboulet/rdll-rs#comments)

This template is significantly more useful than most existing Reflective DLL templates in C/C++ because it provides an organic platform from which third-party libraries can be readily used. This is thanks to Rust's [Cargo](https://github.com/rust-lang/cargo) which allows for easily sharable libraries.
For example, if you were looking for a method of stack spoofing from inside a Reflective DLL in C/C++ you would most likely be stuck implementing that yourself from your preferred template. However, using Cargo, you can quickly add a library like [uwd](https://crates.io/crates/uwd) to
get access to that capability without any of the overhead or additional Git submodule shenanigans that come with setting that up in a C/C++ repository. The entire [Crates](https://crates.io/) ecosystem is now at your fingertips.

## Requirements

[Permalink: Requirements](https://github.com/0xTriboulet/rdll-rs#requirements)

- Rust 2024 edition
- Windows operating system
- Cargo build system
- Cmake > 3.0

## Licensing

[Permalink: Licensing](https://github.com/0xTriboulet/rdll-rs#licensing)

- MIT or Apache 2.0

## About

A reflective DLL development template for the Rust programming language


### Resources

[Readme](https://github.com/0xTriboulet/rdll-rs#readme-ov-file)

### License

[Apache-2.0 license](https://github.com/0xTriboulet/rdll-rs#Apache-2.0-1-ov-file)

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/0xTriboulet/rdll-rs).

[Activity](https://github.com/0xTriboulet/rdll-rs/activity)

### Stars

[**113**\\
stars](https://github.com/0xTriboulet/rdll-rs/stargazers)

### Watchers

[**1**\\
watching](https://github.com/0xTriboulet/rdll-rs/watchers)

### Forks

[**11**\\
forks](https://github.com/0xTriboulet/rdll-rs/forks)

[Report repository](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2F0xTriboulet%2Frdll-rs&report=0xTriboulet+%28user%29)

## [Releases](https://github.com/0xTriboulet/rdll-rs/releases)

No releases published

## [Packages\  0](https://github.com/users/0xTriboulet/packages?repo_name=rdll-rs)

No packages published

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/0xTriboulet/rdll-rs).

## Languages

- [Rust99.0%](https://github.com/0xTriboulet/rdll-rs/search?l=rust)
- [C1.0%](https://github.com/0xTriboulet/rdll-rs/search?l=c)

You can’t perform that action at this time.