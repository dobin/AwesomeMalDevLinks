Title:
Overview of Process Creation (Windows Internals)

Type:
Documentation

Short Summary (4–8 sentences max):
- This write-up summarizes the Windows process creation flow from high-level Win32 APIs down to the native system call boundary.  
- It traces how `CreateProcess` (kernel32.dll) leads into the undocumented `CreateProcessInternal*` and then transitions via `NtCreateUserProcess` (ntdll.dll) into the kernel implementation.  
- It also covers alternate process creation APIs in advapi32 (`CreateProcessWithLogonW`, `CreateProcessWithTokenW`, `CreateProcessAsUser`) and explains how Secondary Logon (seclogon) and RPC are involved for “logon/token-based” creation paths.  
- The post highlights security relevance by mapping these APIs to common abuse patterns such as token manipulation and process injection, and notes required privileges (e.g., `SeAssignPrimaryToken`) for certain paths.  
- Useful for red teamers, malware analysts, and defenders who need to understand where telemetry can be collected (user-mode API, ntdll, kernel) and how different creation methods change artifacts and requirements.

Technical Focus:
- Win32 process creation (`CreateProcess`) and call chain to native APIs  
- Undocumented internals (`CreateProcessInternal*`, kernel `NtCreateUserProcess`)  
- Native system call interface (`NtCreateUserProcess`, `PS_CREATE_INFO`, attribute lists)  
- Token/logon-based process creation (advapi32, seclogon, RPC)  
- Privileges and access tokens in process creation (`SeAssignPrimaryToken`)  
- MITRE ATT&CK mappings (T1055, T1134, T1543 references)

Use Cases:
- Map process-creation telemetry points for EDR/detection engineering (API vs syscall vs service-mediated paths)
- Choose appropriate process creation API for token-based execution (impersonation vs primary token scenarios)
- Understand how Secondary Logon affects artifacts and required permissions
- Support research into process injection/spawn techniques and their prerequisites
- Build or audit tooling that uses `NtCreateUserProcess` directly for controlled process instantiation

Keywords:
Windows internals, process creation, CreateProcess, CreateProcessInternal, NtCreateUserProcess, kernel32.dll, ntdll.dll, advapi32.dll, CreateProcessWithLogonW, CreateProcessWithTokenW, CreateProcessAsUser, seclogon, Secondary Logon service, RPC, access token, SeAssignPrimaryToken, svchost.exe, MITRE T1134, MITRE T1055, MITRE T1543