# https://www.cobaltstrike.com/blog/cobalt-strike-412-fix-up-look-sharp

<!DOCTYPE html><html lang="en-US"><body class="wp-singular post-template-default single single-post postid-8728 single-format-standard wp-custom-logo wp-embed-responsive wp-theme-helpsystems wp-child-theme-cobalt-strike group-blog understrap-has-sidebar"><div id="consent_blackbar" lang="en">
            
            <div id="truste-consent-track" style="position: relative; z-index: 999999; border-top: 1px solid rgb(102, 102, 102);" class="ta-show ta-display-block">  <div id="truste-consent-content" style="overflow: hidden;">    <div id="truste-consent-text" class="truste-messageColumn" data-nosnippet="data-nosnippet">      <span class="hstitle">This website uses cookies. You may change your settings at any time.</span>    </div>    <div id="truste-consent-buttons" class="truste-buttonsColumn" data-nosnippet="data-nosnippet">      <span id="truste-repop-msg" style="padding: 7px 10px; background: #F9EDBE; border:1px solid #F0C36D; margin: 11px 0px 13px;font-size:11; line-height: 16px;color: #AF7501; display:none;"></span>       <button id="truste-consent-button">Accept</button>      <button id="truste-consent-required">Reject All</button>      <button id="truste-show-consent" aria-haspopup="dialog">Manage Cookies</button>    </div>  </div></div></div>
<div style="display:none;" id="teconsent" consent="undefined" aria-label="Open Cookie Preferences Modal" class="truste_caIcon_display" role="complementary"><a role="link" id="icon-id0674276771455295" tabindex="0" lang="en" aria-haspopup="dialog" aria-label="Cookie Preferences, opens a dedicated popup modal window" class="truste_cursor_pointer">Cookie Preferences</a></div>

	
<!-- TrustArc tag end -->
<!-- Google Tag Manager -->

<!-- End Google Tag Manager --><link rel="icon" href="https://www.cobaltstrike.com/app/uploads/2023/06/cropped-android-chrome-512x512-2-32x32.png" sizes="32x32">
<link rel="icon" href="https://www.cobaltstrike.com/app/uploads/2023/06/cropped-android-chrome-512x512-2-192x192.png" sizes="192x192">
<link rel="apple-touch-icon" href="https://www.cobaltstrike.com/app/uploads/2023/06/cropped-android-chrome-512x512-2-180x180.png">

		
		


<!-- Google Tag Manager (noscript) -->

<!-- End Google Tag Manager (noscript) -->
<div class="site" id="page">

	<!-- ******************* The Navbar Area ******************* -->
	<!-- #wrapper-navbar -->

<div class="header-banner"> 
	<div class="jumbotron jumbotron-fluid bg-4 " style="background-image: ">
	<div class="banner-wrapper">
		<div class="container">
			<p class="yoast-breadcrumbs m-0"><span><span><a href="https://www.cobaltstrike.com/">Home</a></span> » <span><a href="https://www.cobaltstrike.com/blog/">Blog</a></span> » <span class="breadcrumb_last" aria-current="page">Cobalt Strike 4.12: Fix Up, Look Sharp!</span></span></p>							<h1>Cobalt Strike 4.12: Fix Up, Look Sharp!</h1>
							</div>
	</div>
	</div>
</div>


<div class="wrapper" id="page-wrapper">

	<div class="container" id="content" tabindex="-1">
		<div class="row">
			<div class="col-lg-8 content-area" id="primary">

				<main class="site-main" id="main">
					<article class="post-8728 post type-post status-publish format-standard has-post-thumbnail hentry product_line-cobalt-strike cornerstone-announcements cta_type-blog" id="post-8728">


<div class="entry-content">
		
<p>Cobalt Strike 4.12 is now available. We are excited to introduce a new look and feel for the Cobalt Strike GUI, a REST API, User Defined Command and Control (UDC2), new process injection options, new UAC bypasses, a new BOF API <code>BeaconDownload</code> for in-memory buffers,&nbsp;and new drip loading Malleable C2 options. </p>



<p>Additionally, we have overhauled pivot Beacons so that they now support the novel Sleepmask <a href="https://www.cobaltstrike.com/blog/cobalt-strike-411-shh-beacon-is-sleeping" target="_blank" rel="noreferrer noopener">introduced in 4.11</a>, fixed the SSH Beacon for newer Mac/Linux distros, and added IPv6 support for SOCKS5.</p>



<p><em><strong>Note:</strong>&nbsp;Cobalt Strike 4.12&nbsp;has updated&nbsp;the&nbsp;minimum&nbsp;supported version of Java from Java 11 to Java 17.&nbsp;See the&nbsp;“Java Support Updated&nbsp;To&nbsp;Java 17”&nbsp;section for more information.&nbsp;</em></p>



<figure class="wp-block-image aligncenter size-large is-resized"><img fetchpriority="high" decoding="async" width="1024" height="1024" src="https://www.cobaltstrike.com/app/uploads/2025/11/Your-paragraph-text-22-1024x1024.png" alt="" class="wp-image-8861" style="width:898px;height:auto"></figure>



<h2 class="wp-block-heading">New GUI, New Me</h2>



<p>In this&nbsp;release,&nbsp;we have&nbsp;added&nbsp;a new&nbsp;modern&nbsp;look and feel to the Cobalt Strike client.&nbsp;You can&nbsp;now select&nbsp;<strong>different&nbsp;themes</strong> to apply to your client including Dracula, Solarized,&nbsp;and Monokai&nbsp;to name a few. Furthermore, all the&nbsp;<strong>Visualizations&nbsp;</strong>have been updated, including the Pivot Graph.&nbsp;This will now<strong> display the&nbsp;listener&nbsp;name</strong> for egress Beacons and <strong>type of pivot</strong> for ingress Beacons&nbsp;(i.e. SMB/TCP).&nbsp;The screenshots below&nbsp;show&nbsp;the&nbsp;new look&nbsp;and feel in action:</p>





<div class="carousel">
  <div class="carousel-images" style="transform: translateX(0%);">
    <img decoding="async" src="https://www.cobaltstrike.com/app/uploads/2025/11/CS412_CobaltStrike.png" alt="Default Cobalt Strike Theme">
    <img decoding="async" src="https://www.cobaltstrike.com/app/uploads/2025/11/CS412_NatureGreen.png" alt="Nature Green Theme">
    <img decoding="async" src="https://www.cobaltstrike.com/app/uploads/2025/11/CS412_Ocean.png" alt="Ocean Blue Theme">
    <img decoding="async" src="https://www.cobaltstrike.com/app/uploads/2025/11/CS412_Dracula.png" alt="Dracula Theme">
  </div>
  <button class="prev">❮</button>
  <button class="next">❯</button>
</div>
<div class="carousel-dots"><span class="active"></span><span></span><span></span><span></span></div>





<p style="text-align:center;"><span class="wp-element-caption"><em><strong>Fig 1: </strong></em> <em>An image carousel showing different themes for Cobalt Strike 4.12</em></span></p>



<h2 class="wp-block-heading">Do Beacons Dream of Electric Sheep?</h2>



<p>One of the most important questions facing the security industry&nbsp;today&nbsp;is the&nbsp;<a href="https://www.anthropic.com/news/disrupting-AI-espionage" target="_blank" rel="noreferrer noopener">use</a>&nbsp;of advanced machine learning models in offensive security and the impact it will have on our defensive thinking.&nbsp;</p>



<p>There is inevitably a lot of&nbsp;noise in this space, but there are&nbsp;great examples&nbsp;of&nbsp;cutting-edge&nbsp;research&nbsp;emerging.&nbsp;For example, Outflank’s&nbsp;<a href="https://x.com/kyleavery" target="_blank" rel="noreferrer noopener">Kyle Avery</a> has published research on using LLMs to generate&nbsp;<a href="https://www.outflank.nl/blog/2025/08/07/training-specialist-models" target="_blank" rel="noreferrer noopener">Cobalt Strike&nbsp;shellcode loaders</a>&nbsp;and&nbsp;to&nbsp;discover trapped COM objects&nbsp;<a href="https://www.outflank.nl/blog/2025/07/29/accelerating-offensive-research-with-llm" target="_blank" rel="noreferrer noopener">capable&nbsp;of lateral movement</a>.&nbsp;Additionally, the Cobalt Strike Team has released <a href="https://www.cobaltstrike.com/blog/artificial-intelligence-for-post-exploitation" target="_blank" rel="noreferrer noopener">research</a>&nbsp;on&nbsp;utilising ML techniques&nbsp;to aid post exploitation.&nbsp;Furthermore,&nbsp;tools such as&nbsp;<a href="https://github.com/SpecterOps/Nemesis" target="_blank" rel="noreferrer noopener">Nemesis</a>&nbsp;are&nbsp;already&nbsp;applying&nbsp;data science&nbsp;techniques to aid operator workflows.&nbsp;</p>



<p>It is worth reiterating that one of the guiding principles of Cobalt Strike’s&nbsp;product philosophy&nbsp;is to aspire to&nbsp;<strong>act as a foundation for modern offensive security research</strong>&nbsp;and&nbsp;to explore the left and right bounds of our defensive ideas and strategies.&nbsp;<strong>We want to support&nbsp;and&nbsp;enable&nbsp;all red team operators to become security researchers and active participants in the&nbsp;</strong><a href="https://aff-wg.org/2025/03/13/the-security-conversation/" target="_blank" rel="noreferrer noopener"><strong>security conversation</strong></a>.&nbsp;Therefore, to ensure that Cobalt Strike enables advanced offensive research in the future for areas such as ML/LLMs,&nbsp;we have released a REST API in 4.12&nbsp;(NB this is in <strong>beta for the&nbsp;initial&nbsp;release</strong> and we will release a blog post in the next few days going into more detail on the design considerations).&nbsp;</p>



<p>However, the REST API&nbsp;has benefits far beyond simply enabling offensive research:</p>



<ul class="wp-block-list">
<li>It makes it possible to&nbsp;<strong>script Cobalt Strike&nbsp;with&nbsp;any&nbsp;language&nbsp;</strong>for the first time</li>



<li>Enables<strong> advanced automation</strong></li>



<li>Eases operator&nbsp;workflows with&nbsp;<strong>server-side storage</strong></li>



<li>Starts to&nbsp;enable the development of&nbsp;<strong>custom&nbsp;Cobalt Strike&nbsp;clients</strong></li>
</ul>



<p>Due to the&nbsp;size and&nbsp;scope of the REST API we have released a <a href="https://www.cobaltstrike.com/blog/release-out-finally-some-rest">separate blog post</a> outlining its motivations, design, and how to get started with it. However, to briefly demonstrate its power, the demo below shows a Cobalt Strike MCP Server for Anthropic’s&nbsp;<a href="https://claude.ai/" target="_blank" rel="noreferrer noopener">Claude</a>:&nbsp;</p>



 <wistia-player media-id="y5ik9dlc5m" aspect="1.7777777777777777" unique-id="wistia-y5ik9dlc5m-16"><div><div class="wistia_swatch" style="height: 1071px; left: 0px; position: absolute; top: 0px; width: 100%;"><div style="height: 100%; position: relative; width: 100%;"><div style="height: 100%; left: 0px; overflow: hidden; position: absolute; top: 0px; width: 100%; border-radius: 0px;"><img src="https://fast.wistia.com/embed/medias/y5ik9dlc5m/swatch" alt="" aria-hidden="true" style="filter: blur(5px); height: 100%; object-fit: contain; width: 100%;"></div></div></div><div><div style="--wistia-player-icon-color: #ffffff;"><div tabindex="-1" class="w-css-reset" style="cursor: pointer; width: 100%; height: 1080px;"><div><div class="w-css-reset" style="height: 100%; left: 0px; opacity: 1; position: absolute; top: 0px; width: 100%; display: block;"><img src="https://embed-ssl.wistia.com/deliveries/debb57053c2f232381cc4a06e6568078bb795bc3.webp?image_crop_resized=1920x1080" alt="" class="w-css-reset" style="background-color: rgb(0, 0, 0); height: 100%; object-fit: contain; position: absolute; width: 100%; top: 0px; left: 0px; clip: auto; display: block; border-radius: 0px;"></div></div></div><div class="w-bpb-wrapper w-css-reset w-css-reset-tree" style="border-radius: 0px; display: block; left: calc(50%); margin-left: -81.25px; margin-top: -52px; overflow: hidden; position: absolute; top: calc(50% - 22.1px);"><button aria-label="Play Video: CS_Claude_meets_Cobalt" tabindex="0" type="button" class="w-big-play-button w-css-reset-button-important w-vulcan-v2-button" style="background-color: transparent; border: 0px; color: rgb(255, 255, 255); cursor: pointer; height: 104px; box-shadow: none; width: 162.5px;"><div style="background: rgb(0, 106, 86); display: block; left: 0px; height: 104px; mix-blend-mode: darken; position: absolute; top: 0px; width: 162.5px;"></div><div style="background-color: rgba(0, 106, 86, 0.7); height: 104px; left: 0px; position: absolute; top: 0px; transition: background-color 150ms; width: 162.5px;"></div><svg x="0px" y="0px" viewBox="0 0 125 80" enable-background="new 0 0 125 80" aria-hidden="true" style="fill: rgb(255, 255, 255); height: 104px; left: 0px; stroke-width: 0px; top: 0px; width: 100%; position: absolute; color: rgb(255, 255, 255);"><path fill-rule="evenodd" clip-rule="evenodd" fill="currentcolor" opacity="1" transform="translate(44, 22)" d="M12.138 2.173C10.812 1.254 9 2.203 9 3.817v28.366c0 1.613 1.812 2.563 3.138 1.644l20.487-14.183a2 2 0 0 0 0-3.288L12.138 2.173Z"></path></svg></button></div></div></div></div><div id="wistia_chrome_134" class="w-chrome notranslate" tabindex="-1" style="display: inline-block; height: 100%; line-height: normal; margin: 0px; padding: 0px; position: relative; vertical-align: top; width: 100%; outline: none; overflow: hidden; box-sizing: content-box; border-radius: 0px; clip-path: inset(0.5px);"><div id="wistia_grid_140_wrapper" style="display: block;"><div id="wistia_grid_140_above"></div><div id="wistia_grid_140_main"><div id="wistia_grid_140_behind"></div><div id="wistia_grid_140_center"><div class="w-video-wrapper w-css-reset" style="width: 100%; height: 100%; display: flex; align-items: center; opacity: 1; background-color: rgb(0, 0, 0);"><video id="wistia_simple_video_253" crossorigin="anonymous" aria-label="CS_Claude_meets_Cobalt" controlslist="nodownload" playsinline="" preload="none" type="video/m3u8" x-webkit-airplay="allow" style="background: transparent; display: block; height: 100%; max-height: none; max-width: none; position: static; visibility: visible; width: 100%; aspect-ratio: 1.77778 / 1; object-fit: contain;"></video></div><div class="w-ui-container" style="height: 100%; left: 0px; position: absolute; top: 0px; width: 100%; opacity: 1;"><div id="w-vulcan-v2-139" class="w-vulcan-v2 w-css-reset" style="border-radius: 0px; box-sizing: border-box; cursor: default; direction: ltr; height: 100%; left: 0px; position: absolute; visibility: visible; top: 0px; width: 100%; --wistia-player-icon-color: #ffffff; --wistia-player-color-hover: #001100; --wistia-player-icon-color-hover: #fff;"><div class="w-vulcan--background w-css-reset" style="height: 100%; left: 0px; position: absolute; top: 0px; width: 100%;"><div data-handle="statusBar" class="w-css-reset"></div><div data-handle="backgroundFocus" class="w-css-reset"><button aria-label="Play Video: CS_Claude_meets_Cobalt" tabindex="0" class="w-css-reset w-vulcan-v2-button" style="clip: rect(1px, 1px, 1px, 1px); height: 1px; overflow: hidden; position: absolute; white-space: nowrap; width: 1px; pointer-events: none;"></button></div><div data-handle="thumbnail" class="w-css-reset"><div><div class="w-css-reset" style="height: 100%; left: 0px; opacity: 1; position: absolute; top: 0px; width: 100%; display: block;"><img src="https://embed-ssl.wistia.com/deliveries/debb57053c2f232381cc4a06e6568078bb795bc3.webp?image_crop_resized=1920x1080" alt="Video Thumbnail" class="w-css-reset" style="background-color: rgb(0, 0, 0); height: 100%; object-fit: contain; position: absolute; width: 100%; top: 0px; left: 0px; clip: auto; display: block; border-radius: 0px;"></div></div></div></div><div aria-live="polite" aria-atomic="true" class="w-vulcan--aria-live w-css-reset" style="position: absolute; left: -99999em;"></div><div class="w-vulcan-overlays-table w-css-reset" style="display: table; pointer-events: none; position: absolute; width: 100%; height: calc(100% - 44px);"><div class="w-vulcan-overlays--left w-css-reset" style="display: table-cell; height: auto; vertical-align: top; position: relative; width: 0px;"><div class="w-css-reset" style="height: 100%;"></div></div><div class="w-vulcan-overlays--center w-css-reset" style="display: table-cell; height: 100%; vertical-align: top; position: relative; width: 100%;"><div class="w-css-reset" style="height: 100%;"><div data-handle="bigPlayButton" class="w-css-reset" style="pointer-events: auto;"><div class="w-bpb-wrapper w-css-reset w-css-reset-tree" style="border-radius: 0px; display: block; left: calc(50%); margin-left: -81.25px; margin-top: -52px; overflow: hidden; position: absolute; top: calc(50% + 0px);"><button aria-label="Play Video: CS_Claude_meets_Cobalt" tabindex="0" type="button" class="w-big-play-button w-css-reset-button-important w-vulcan-v2-button" style="background-color: transparent; border: 0px; color: rgb(255, 255, 255); cursor: pointer; height: 104px; box-shadow: none; width: 162.5px;"><div style="background: rgb(0, 106, 86); display: block; left: 0px; height: 104px; mix-blend-mode: darken; position: absolute; top: 0px; width: 162.5px;"></div><div style="background-color: rgba(0, 106, 86, 0.7); height: 104px; left: 0px; position: absolute; top: 0px; transition: background-color 150ms; width: 162.5px;"></div><svg x="0px" y="0px" viewBox="0 0 125 80" enable-background="new 0 0 125 80" aria-hidden="true" style="fill: rgb(255, 255, 255); height: 104px; left: 0px; stroke-width: 0px; top: 0px; width: 100%; position: absolute; color: rgb(255, 255, 255);"><path fill-rule="evenodd" clip-rule="evenodd" fill="currentcolor" opacity="1" transform="translate(44, 22)" d="M12.138 2.173C10.812 1.254 9 2.203 9 3.817v28.366c0 1.613 1.812 2.563 3.138 1.644l20.487-14.183a2 2 0 0 0 0-3.288L12.138 2.173Z"></path></svg></button></div></div><div data-handle="clickForSoundButton" class="w-css-reset" style="pointer-events: auto;"><div data-handle="click-for-sound-backdrop" class="w-css-reset w-css-reset-tree" style="display: none; height: 100%; left: 0px; pointer-events: auto; position: absolute; top: 0px; width: 100%;"><button aria-label="Click for sound" class="w-vulcan-v2-button click-for-sound-btn" style="background: rgba(0, 0, 0, 0.8); border: 2px solid transparent; border-radius: 60px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; outline: none; pointer-events: auto; position: absolute; right: 27.25px; top: 27.25px; max-width: 1849.5px;"><div style="display: flex; align-items: center; justify-content: flex-end; white-space: nowrap; overflow: hidden; max-width: 0px; transition: max-width 200ms;"><span style="color: rgb(255, 255, 255); font-family: WistiaPlayerInter, Helvetica, sans-serif; font-size: 18px; font-weight: 500; padding-left: 1em; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 1904px;">Click for sound</span></div><svg viewBox="0 0 237 237" width="68.25" height="68.25"><path fill="#fff" d="M88 107H65v24h24l23 23V84z"></path><g fill="none" stroke="#fff" stroke-linecap="round" stroke-width="10"><path d="M142 86c9 21 9 44 0 65" class="volume__small-wave"></path><path d="M165 74c13 23 13 66 0 89" class="volume__large-wave"></path></g></svg></button></div></div><div data-handle="playPauseNotifier" class="w-css-reset" style="pointer-events: auto;"><div class="w-play-pause-notifier" style="background: rgba(0, 0, 0, 0.6); border-radius: 50%; height: 182px; left: 50%; pointer-events: none; position: absolute; opacity: 0; top: 50%; transform: translate(-50%, -50%) scale(0.8); transition: opacity 0.8s, transform 0.8s; width: 182px;"><div style="width: 100%; height: 100%; margin-left: 0px;"><svg x="0px" y="0px" viewBox="0 0 40 34" enable-background="new 0 0 40 34" aria-hidden="true" style="fill: none; height: 100%; left: 0px; stroke-width: 0px; top: 0px; width: 100%; color: rgb(255, 255, 255);"><path fill-rule="evenodd" clip-rule="evenodd" d="M16.5 11C15.6716 11 15 11.6716 15 12.5V22.5C15 23.3284 15.6716 24 16.5 24H17.5C18.3284 24 19 23.3284 19 22.5V12.5C19 11.6716 18.3284 11 17.5 11H16.5ZM23.5 11C22.6716 11 22 11.6716 22 12.5V22.5C22 23.3284 22.6716 24 23.5 24H24.5C25.3284 24 26 23.3284 26 22.5V12.5C26 11.6716 25.3284 11 24.5 11H23.5Z" fill="currentcolor"></path></svg></div></div></div><div data-handle="playPauseLoading" class="w-css-reset" style="pointer-events: auto;"><div class="w-css-reset w-css-reset-tree" style="height: 100%; left: 0px; pointer-events: none; position: absolute; top: 0px; width: 100%;"><button aria-label="Play Video" class="w-vulcan-v2-button" style="background: rgba(0, 0, 0, 0.6); border: 0px; border-radius: 50%; cursor: pointer; display: none; height: 182px; left: 50%; margin: 0px; padding: 0px; pointer-events: auto; position: absolute; opacity: 0; outline: none; top: 50%; transform: translate(-50%, -50%) scale(0.8); transition: opacity 200ms, transform 600ms; -webkit-tap-highlight-color: rgba(0, 0, 0, 0); width: 182px;"><div style="width: 100%; height: 100%; margin-left: 0px;"><svg x="0px" y="0px" viewBox="0 0 40 34" enable-background="new 0 0 40 34" aria-hidden="true" style="fill: none; height: 100%; left: 0px; stroke-width: 0px; top: 0px; width: 100%; color: rgb(255, 255, 255);"><path d="M24.888 16.1913C25.4371 16.5906 25.4371 17.4094 24.888 17.8087L16.5882 23.845C15.9272 24.3257 15 23.8535 15 23.0362V10.9638C15 10.1465 15.9272 9.67433 16.5882 10.155L24.888 16.1913Z" fill="currentcolor"></path></svg></div></button></div></div></div></div><div class="w-vulcan-overlays--right w-css-reset" style="display: table-cell; height: auto; vertical-align: top; position: relative; width: 0px;"><div class="w-css-reset" style="height: 100%;"></div></div></div><div class="w-bottom-bar w-css-reset" style="bottom: 0px; border-radius: 0px; border-collapse: collapse; display: table; height: 44px; pointer-events: none; position: absolute; padding-left: 0px; padding-right: 0px; right: 50%; table-layout: auto; transform: translate(50%); width: calc(100% + 0px); z-index: 1; animation: 250ms ease-in-out 0s 1 normal forwards running w-control-bar-fade-in;"><div class="w-bottom-bar-lower w-css-reset" style="position: relative;"><div style="height: 100%; left: 0px; position: absolute; top: 0px; width: 100%;"><div style="background: rgb(0, 106, 86); display: none; height: 100%; mix-blend-mode: darken; left: 0px; opacity: 1; position: absolute; top: 0px; transition: opacity; width: 100%;"></div><div style="background: rgba(0, 106, 86, 0.85); border-radius: 0px; height: 100%; opacity: 1; left: 0px; position: absolute; top: 0px; transition: opacity; width: 100%;"></div></div><div style="display: none;"><div style="background: rgb(0, 106, 86); display: none; height: 100%; mix-blend-mode: darken; left: 0px; opacity: 1; position: absolute; top: 0px; transition: opacity; width: 100%;"></div><div style="background: 100% rgba(0, 106, 86, 0.85); border-radius: 0px; height: 100%; opacity: 1; left: 0px; position: absolute; top: 0px; transition: opacity; width: 100%;"></div></div><div class="w-bottom-bar-left w-css-reset" style="display: table-cell; height: auto; vertical-align: top; position: relative; width: 0px; opacity: 1; transition: opacity;"><div class="w-bottom-bar-left-inner w-css-reset" style="height: 44px; position: relative; pointer-events: auto; white-space: nowrap;"><div data-handle="smallPlayButton" class="w-css-reset" style="display: inline-block; vertical-align: top;"><div class="w-vulcan-button-wrapper w-css-reset" style="display: inline-block; height: 44px; position: relative; vertical-align: top; width: 52px;"><button tabindex="0" class="w-vulcan-v2-button w-css-reset w-css-reset-tree w-css-reset-button-important" aria-label="Play Video" title="Play Video" style="background-color: transparent; border-radius: 0px; box-shadow: none; cursor: pointer; height: 100%; position: relative; transition: background-color 150ms; width: 100%; color: var(--wistia-player-icon-color) !important;"><div data-handle="smallPlayButton_icon_wrapper" class="w-vulcan-icon-wrapper" style="box-sizing: border-box; height: 100%; position: relative; opacity: 1; transform: scale(1.001); transition: transform 200ms;"><div style="width: 100%; height: 100%; margin-left: 1.95px;"><svg x="0px" y="0px" viewBox="0 0 40 34" enable-background="new 0 0 40 34" aria-hidden="true" style="fill: none; height: 100%; left: 0px; stroke-width: 0px; top: 0px; width: 100%; vertical-align: top;"><path d="M24.888 16.1913C25.4371 16.5906 25.4371 17.4094 24.888 17.8087L16.5882 23.845C15.9272 24.3257 15 23.8535 15 23.0362V10.9638C15 10.1465 15.9272 9.67433 16.5882 10.155L24.888 16.1913Z" fill="currentcolor"></path></svg></div></div></button></div></div></div></div><div class="w-bottom-bar-middle w-css-reset" style="display: table-cell; height: auto; vertical-align: top; position: relative; width: 100%; opacity: 1; transition: opacity;"><div class="w-bottom-bar-middle-inner w-css-reset" style="height: 44px; position: relative; pointer-events: auto; white-space: nowrap; opacity: 1; transform: translateY(0px); transition: opacity, transform;"><div data-handle="playbar" class="w-css-reset" style="height: 100%; position: relative;"><div class="w-playbar-wrapper w-css-reset w-css-reset-tree" style="display: flex; height: 100%; width: 100%;"><div class="w-playbar__time" style="box-sizing: content-box; color: rgb(255, 255, 255); font-family: WistiaPlayerInterNumbersSemiBold, Helvetica, sans-serif; font-size: 16.9px; letter-spacing: 0.65px; line-height: 44px; padding-left: 6.5px; pointer-events: none; position: relative; text-align: center; width: 36.4px;">8:59</div><div style="width: 100%; position: relative;"><div aria-label="Playbar" aria-orientation="horizontal" aria-valuemax="538.541" aria-valuemin="0" aria-valuenow="0" aria-valuetext="0 seconds" role="slider" tabindex="0" style="cursor: pointer; flex: 1 1 0%; height: 44px; outline: none; margin-left: 19.5px; margin-right: 13px; position: relative;"><canvas height="44" width="1669.1" style="height: 44px; left: -19.5px; position: absolute; top: 0px; width: 1669.1px;"></canvas><div style="border-radius: 50%; height: 14.56px; left: -7.28px; opacity: 0; position: absolute; top: 14.72px; width: 14.56px;"></div></div></div></div></div></div></div><div class="w-bottom-bar-right w-css-reset" style="display: table-cell; height: auto; vertical-align: top; position: relative; width: 0px; opacity: 1; transition: opacity; white-space: nowrap;"><div class="w-bottom-bar-right-inner-anchor w-css-reset" style="height: 44px; position: relative; pointer-events: auto; white-space: nowrap; display: inline-block; right: 0px; top: 0px; vertical-align: top;"><div class="w-bottom-bar-right-inner w-css-reset" style="height: 44px; position: relative; pointer-events: auto; white-space: nowrap; display: inline-block; opacity: 1; right: 0px; top: 0px; transform: translateY(0px); transition: opacity, transform;"><div data-handle="volumeButton" class="w-css-reset" style="display: inline-block; vertical-align: top;"><div class="w-vulcan-button-wrapper w-css-reset" style="display: inline-block; height: 44px; position: relative; vertical-align: top; width: 52px;"><button tabindex="0" aria-pressed="false" class="w-vulcan-v2-button w-css-reset w-css-reset-tree w-css-reset-button-important" aria-label="Mute" title="Mute" style="background-color: transparent; border-radius: 0px; box-shadow: none; cursor: pointer; height: 100%; position: relative; transition: background-color 150ms; width: 100%; color: var(--wistia-player-icon-color) !important;"><div data-handle="volumeButton_icon_wrapper" class="w-vulcan-icon-wrapper" style="box-sizing: border-box; height: 100%; position: relative; opacity: 1; transform: scale(1.001); transition: transform 200ms;"><svg x="0px" y="0px" viewBox="0 0 40 34" enable-background="new 0 0 40 34" aria-hidden="true" style="fill: none; height: 100%; left: 0px; stroke-width: 0px; top: 0px; width: 100%;"><g style="transform: translateX(1.25px); transition: transform 100ms;"><path d="M15.8 13.9995C15.3 14.4995 14.4 14.7995 13.8 14.7995H12.2C11.5 14.7995 11 15.2995 11 15.9995V17.5995C11 18.2995 11.5 18.7995 12.2 18.7995H13.8C14.5 18.7995 15.4 19.1995 15.8 19.5995L18.2 21.3999C18.5296 21.6472 19 21.412 19 20.9999V12.154C19 11.7163 18.4774 11.4899 18.1581 11.7892L15.8 13.9995Z" fill="currentcolor"></path><g stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.5C22 11.5 23.1 14 23.1 16.5C23.1 19 22 21.5 22 21.5" style="opacity: 1; transition: opacity 100ms;"></path><path d="M26 9C26 9 27.7 12.8 27.7 16.5C27.7 20.2 26 24 26 24" style="opacity: 1; transition: opacity 100ms;"></path><g style="opacity: 0; transition: opacity 100ms;"><path d="M22 14L27 19"></path><path d="M27 14L22 19"></path></g></g></g></svg></div></button></div></div><div data-handle="settingsButton" class="w-css-reset" style="display: inline-block; vertical-align: top;"><div class="w-vulcan-button-wrapper w-css-reset" style="display: inline-block; height: 44px; position: relative; vertical-align: top; width: 52px;"><button tabindex="0" aria-expanded="false" class="w-vulcan-v2-button w-css-reset w-css-reset-tree w-css-reset-button-important" aria-label="Show settings menu" title="Show settings menu" style="background-color: transparent; border-radius: 0px; box-shadow: none; cursor: pointer; height: 100%; position: relative; transition: background-color 150ms; width: 100%; color: var(--wistia-player-icon-color) !important;"><div data-handle="settingsButton_icon_wrapper" class="w-vulcan-icon-wrapper" style="box-sizing: border-box; height: 100%; position: relative; opacity: 1; transform: scale(1.001); transition: transform 200ms;"><svg x="0px" y="0px" viewBox="0 0 40 34" enable-background="new 0 0 40 34" aria-hidden="true" style="fill: none; height: 100%; left: 0px; stroke-width: 0px; top: 0px; width: 100%;"><path fill-rule="evenodd" clip-rule="evenodd" d="M26.4 15.4H28.3C28.7 15.4 29 15.7 29 16.1V16.7C29 17.1 28.7 17.4 28.3 17.4H26.4C26 17.4 25.6 17.7 25.5 18.1L25.1 19.2C25 19.5 25 20 25.3 20.3L26.6 21.6C26.9 21.9 26.9 22.3 26.6 22.6L26.2 23C25.9 23.3 25.5 23.3 25.2 23L23.9 21.7C23.6 21.5 23.1 21.4 22.8 21.6L21.7 22.1C21.3 22.2 21 22.6 21 23V24.7C21 25.1 20.7 25.4 20.3 25.4H19.7C19.3 25.4 19 25.1 19 24.7V23C19 22.6 18.7 22.2 18.3 22.1L17.1 21.6C16.8 21.5 16.3 21.5 16 21.8L14.8 23C14.5 23.3 14.1 23.3 13.8 23L13.4 22.6C13.1 22.3 13.1 21.9 13.4 21.6L14.6 20.4C14.8 20.1 14.9 19.6 14.7 19.3L14.2 18.1C14.1 17.7 13.7 17.4 13.3 17.4H11.7C11.3 17.4 11 17.1 11 16.7V16.1C11 15.7 11.3 15.4 11.7 15.4H13.3C13.7 15.4 14.1 15.1 14.2 14.7L14.7 13.5C14.9 13.2 14.9 12.7 14.6 12.4L13.4 11.2C13.1 10.9 13.1 10.5 13.4 10.2L13.8 9.8C14.1 9.5 14.5 9.5 14.8 9.8L16 11C16.3 11.3 16.8 11.4 17.1 11.2L18.3 10.7C18.7 10.6 19 10.2 19 9.8V8.1C19 7.7 19.3 7.4 19.7 7.4H20.3C20.7 7.4 21 7.7 21 8.1V9.8C21 10.2 21.3 10.6 21.7 10.7L22.8 11.2C23.1 11.4 23.6 11.4 23.9 11.1L25.2 9.8C25.5 9.5 25.9 9.5 26.2 9.8L26.6 10.2C26.9 10.5 26.9 10.9 26.6 11.2L25.3 12.5C25 12.8 24.9 13.3 25.1 13.6L25.5 14.7C25.6 15.1 26 15.4 26.4 15.4ZM19.9 20.4C22 20.4 23.8 18.7 23.8 16.5C23.8 14.3 22.1 12.6 19.9 12.6C17.7 12.6 16 14.4 16 16.5C16 18.6 17.7 20.4 19.9 20.4Z" fill="currentcolor"></path></svg></div></button></div></div><div data-handle="fullscreenControl" class="w-css-reset" style="display: inline-block; vertical-align: top;"><div class="w-vulcan-button-wrapper w-css-reset" style="display: inline-block; height: 44px; position: relative; vertical-align: top; width: 52px;"><button tabindex="0" class="w-vulcan-v2-button w-css-reset w-css-reset-tree w-css-reset-button-important" aria-label="Fullscreen" title="Fullscreen" style="background-color: transparent; border-radius: 0px; box-shadow: none; cursor: pointer; height: 100%; position: relative; transition: background-color 150ms; width: 100%; color: var(--wistia-player-icon-color) !important;"><div data-handle="fullscreenControl_icon_wrapper" class="w-vulcan-icon-wrapper" style="box-sizing: border-box; height: 100%; position: relative; opacity: 1; transform: scale(1.001); transition: transform 200ms;"><svg x="0px" y="0px" viewBox="0 0 40 34" enable-background="new 0 0 40 34" aria-hidden="true" style="fill: none; height: 100%; left: 0px; stroke-width: 0px; top: 0px; width: 100%;"><rect x="14" y="13" width="12" height="8" rx="1.5" stroke="currentcolor" stroke-width="2"></rect><g stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13V11C10 9.89543 10.8954 9 12 9H14"></path><path d="M30 13V11C30 9.89543 29.1046 9 28 9H26"></path><path d="M30 21L30 23C30 24.1046 29.1046 25 28 25L26 25"></path><path d="M10 21L10 23C10 24.1046 10.8954 25 12 25L14 25"></path></g></svg></div></button></div></div></div></div><div class="w-wistia-logo w-css-reset" style="height: 44px; position: relative; pointer-events: auto; white-space: nowrap; display: none; right: 0px; top: 0px;"></div><div class="w-ellipsis w-css-reset" style="height: 44px; position: relative; pointer-events: auto; white-space: nowrap; display: none;"></div></div></div></div><div class="w-foreground w-css-reset" style="height: 100%; left: 0px; pointer-events: none; position: absolute; top: 0px; width: 100%; z-index: 1;"><div data-handle="contextMenu" class="w-css-reset" style="pointer-events: auto;"></div><div data-handle="loadingHourglass" class="w-css-reset" style="pointer-events: auto;"></div><div data-handle="focusOutline" class="w-css-reset" style="pointer-events: auto;"><div class="w-focus-outline" style="box-shadow: rgb(255, 255, 255) 0px 0px 0px 2px inset; border-radius: 0px; display: none; height: 100%; left: 0px; pointer-events: none; position: absolute; right: 0px; width: 100%;"></div></div></div></div></div></div><div id="wistia_grid_140_front"></div><div id="wistia_grid_140_top_inside"><div id="wistia_grid_140_top"></div></div><div id="wistia_grid_140_bottom_inside"><div id="wistia_grid_140_bottom"></div></div><div id="wistia_grid_140_left_inside"><div id="wistia_grid_140_left"></div></div><div id="wistia_grid_140_right_inside"><div id="wistia_grid_140_right"></div></div></div><div id="wistia_grid_140_below"></div></div></div></wistia-player>

<p style="text-align:center;"><span class="wp-element-caption"><em><strong>Video 1: </strong></em> <em>A PoC MCP Server for Cobalt Strike</em></span></p>



<p><em><strong>Note:</strong> We will release our MCP code demonstrated above in the upcoming weeks.</em></p>



<p>The REST API documentation can be found <a href="https://hstechdocs.helpsystems.com/manuals/cobaltstrike/current/userguide/content/api/index.html" target="_blank" rel="noreferrer noopener">here</a> and contains instructions on how to start the REST API server and a list of the available endpoints so you can start playing with it straight away.</p>



<h2 class="wp-block-heading">User Defined Command and Control (UDC2)</h2>



<p>Many on the Cobalt Strike&nbsp;Team&nbsp;remember the release of&nbsp;<a href="https://hstechdocs.helpsystems.com/manuals/cobaltstrike/current/userguide/content/topics/listener-infrastructure_external-c2.htm" target="_blank" rel="noreferrer noopener">extc2</a>&nbsp;and&nbsp;<a href="https://labs.withsecure.com/publications/tasking-office-365-for-cobalt-strike-c2" target="_blank" rel="noreferrer noopener">early attempts</a>&nbsp;to pivot Beacon over&nbsp;<a href="https://github.com/ReversecLabs/C3" target="_blank" rel="noreferrer noopener">increasingly esoteric C2 channels</a>.&nbsp;This ushered in a new era of&nbsp;tradecraft&nbsp;for custom&nbsp;egress and P2P channels which highlighted&nbsp;many&nbsp;<a href="https://www.youtube.com/watch?v=tQAZx0uXGMo" target="_blank" rel="noreferrer noopener">weaknesses</a>&nbsp;in security controls&nbsp;around&nbsp;network&nbsp;ingress and egress&nbsp;filtering.&nbsp;Moreover, many of these techniques are still actively being&nbsp;used by&nbsp;<a href="https://www.elastic.co/security-labs/siestagraph-new-implant-uncovered-in-asean-member-foreign-ministry" target="_blank" rel="noreferrer noopener">threat actors today</a>.</p>



<p>However, while still&nbsp;<a href="https://github.com/ryanq47/CS-EXTC2-NTP" target="_blank" rel="noreferrer noopener">powerful</a>, extc2 has some drawbacks.&nbsp;In particular, its&nbsp;reliance on named pipes to relay frames from an SMB Beacon&nbsp;can&nbsp;make it&nbsp;<a href="https://github.com/RedSiege/GraphStrike" target="_blank" rel="noreferrer noopener">hard to use&nbsp;operationally.</a>&nbsp;UDC2 addresses these issues by&nbsp;enabling Cobalt Strike users to&nbsp;<strong>develop custom C2 channels as BOFs</strong>.&nbsp;The UDC2&nbsp;BOF&nbsp;is patched in on payload creation and is invoked by Beacon to proxy out all its traffic over the custom channel.&nbsp;This makes it possible to&nbsp;<strong>combine custom C2 channels with custom&nbsp;UDRLs/transformations</strong>.&nbsp;</p>



<p>The UDC2 BOF&nbsp;is complemented by a&nbsp;UDC2 server&nbsp;(i.e.&nbsp;a&nbsp;Python script&nbsp;running in the attacker infrastructure) to relay traffic to the UDC2 listener.&nbsp;The high-level architecture is illustrated below:&nbsp;</p>



<figure class="wp-block-image aligncenter size-large is-resized"><img decoding="async" width="1024" height="666" src="https://www.cobaltstrike.com/app/uploads/2025/11/udc2_diagram-1024x666.png" alt="" class="wp-image-8782" style="width:934px;height:auto"><figcaption class="wp-element-caption"><em><strong>Fig 2:</strong></em> <em>The&nbsp;high-level&nbsp;architecture&nbsp;of UDC2. The UDC2 BOF acts as the&nbsp;‘client’&nbsp;and proxies Beacon’s&nbsp;comms&nbsp;over a custom channel&nbsp;to&nbsp;the UDC2 server. The UDC2 server then relays these&nbsp;frames to the UDC2 listener.</em></figcaption></figure>



<p>The video below shows UDC2 in action,&nbsp;<strong>demonstrating&nbsp;an ICMP egress channel</strong>:</p>



 <wistia-player media-id="zqma56dfjp" aspect="1.7777777777777777" unique-id="wistia-zqma56dfjp-17"><div><div class="wistia_swatch" style="height: 1071px; left: 0px; position: absolute; top: 0px; width: 100%;"><div style="height: 100%; position: relative; width: 100%;"><div style="height: 100%; left: 0px; overflow: hidden; position: absolute; top: 0px; width: 100%; border-radius: 0px;"><img src="https://fast.wistia.com/embed/medias/zqma56dfjp/swatch" alt="" aria-hidden="true" style="filter: blur(5px); height: 100%; object-fit: contain; width: 100%;"></div></div></div><div><div style="--wistia-player-icon-color: #ffffff;"><div tabindex="-1" class="w-css-reset" style="cursor: pointer; width: 100%; height: 1080px;"><div><div class="w-css-reset" style="height: 100%; left: 0px; opacity: 1; position: absolute; top: 0px; width: 100%; display: block;"><img src="https://embed-ssl.wistia.com/deliveries/5d32323542a0b7bc223f4eb3081603c2892ce308.webp?image_crop_resized=1920x1080" alt="" class="w-css-reset" style="background-color: rgb(0, 0, 0); height: 100%; object-fit: contain; position: absolute; width: 100%; top: 0px; left: 0px; clip: auto; display: block; border-radius: 0px;"></div></div></div><div class="w-bpb-wrapper w-css-reset w-css-reset-tree" style="border-radius: 0px; display: block; left: calc(50%); margin-left: -81.25px; margin-top: -52px; overflow: hidden; position: absolute; top: calc(50% - 22.1px);"><button aria-label="Play Video: 412_UDC2" tabindex="0" type="button" class="w-big-play-button w-css-reset-button-important w-vulcan-v2-button" style="background-color: transparent; border: 0px; color: rgb(255, 255, 255); cursor: pointer; height: 104px; box-shadow: none; width: 162.5px;"><div style="background: rgb(0, 106, 86); display: block; left: 0px; height: 104px; mix-blend-mode: darken; position: absolute; top: 0px; width: 162.5px;"></div><div style="background-color: rgba(0, 106, 86, 0.7); height: 104px; left: 0px; position: absolute; top: 0px; transition: background-color 150ms; width: 162.5px;"></div><svg x="0px" y="0px" viewBox="0 0 125 80" enable-background="new 0 0 125 80" aria-hidden="true" style="fill: rgb(255, 255, 255); height: 104px; left: 0px; stroke-width: 0px; top: 0px; width: 100%; position: absolute; color: rgb(255, 255, 255);"><path fill-rule="evenodd" clip-rule="evenodd" fill="currentcolor" opacity="1" transform="translate(44, 22)" d="M12.138 2.173C10.812 1.254 9 2.203 9 3.817v28.366c0 1.613 1.812 2.563 3.138 1.644l20.487-14.183a2 2 0 0 0 0-3.288L12.138 2.173Z"></path></svg></button></div></div></div></div><div id="wistia_chrome_196" class="w-chrome notranslate" tabindex="-1" style="display: inline-block; height: 100%; line-height: normal; margin: 0px; padding: 0px; position: relative; vertical-align: top; width: 100%; outline: none; overflow: hidden; box-sizing: content-box; border-radius: 0px; clip-path: inset(0.5px);"><div id="wistia_grid_202_wrapper" style="display: block;"><div id="wistia_grid_202_above"></div><div id="wistia_grid_202_main"><div id="wistia_grid_202_behind"></div><div id="wistia_grid_202_center"><div class="w-video-wrapper w-css-reset" style="width: 100%; height: 100%; display: flex; align-items: center; opacity: 1; background-color: rgb(0, 0, 0);"><video id="wistia_simple_video_276" crossorigin="anonymous" aria-label="412_UDC2" controlslist="nodownload" playsinline="" preload="none" type="video/m3u8" x-webkit-airplay="allow" style="background: transparent; display: block; height: 100%; max-height: none; max-width: none; position: static; visibility: visible; width: 100%; aspect-ratio: 1.77778 / 1; object-fit: contain;"></video></div><div class="w-ui-container" style="height: 100%; left: 0px; position: absolute; top: 0px; width: 100%; opacity: 1;"><div id="w-vulcan-v2-201" class="w-vulcan-v2 w-css-reset" style="border-radius: 0px; box-sizing: border-box; cursor: default; direction: ltr; height: 100%; left: 0px; position: absolute; visibility: visible; top: 0px; width: 100%; --wistia-player-icon-color: #ffffff; --wistia-player-color-hover: #001100; --wistia-player-icon-color-hover: #fff;"><div class="w-vulcan--background w-css-reset" style="height: 100%; left: 0px; position: absolute; top: 0px; width: 100%;"><div data-handle="statusBar" class="w-css-reset"></div><div data-handle="backgroundFocus" class="w-css-reset"><button aria-label="Play Video: 412_UDC2" tabindex="0" class="w-css-reset w-vulcan-v2-button" style="clip: rect(1px, 1px, 1px, 1px); height: 1px; overflow: hidden; position: absolute; white-space: nowrap; width: 1px; pointer-events: none;"></button></div><div data-handle="thumbnail" class="w-css-reset"><div><div class="w-css-reset" style="height: 100%; left: 0px; opacity: 1; position: absolute; top: 0px; width: 100%; display: block;"><img src="https://embed-ssl.wistia.com/deliveries/5d32323542a0b7bc223f4eb3081603c2892ce308.webp?image_crop_resized=1920x1080" alt="Video Thumbnail" class="w-css-reset" style="background-color: rgb(0, 0, 0); height: 100%; object-fit: contain; position: absolute; width: 100%; top: 0px; left: 0px; clip: auto; display: block; border-radius: 0px;"></div></div></div></div><div aria-live="polite" aria-atomic="true" class="w-vulcan--aria-live w-css-reset" style="position: absolute; left: -99999em;"></div><div class="w-vulcan-overlays-table w-css-reset" style="display: table; pointer-events: none; position: absolute; width: 100%; height: calc(100% - 44px);"><div class="w-vulcan-overlays--left w-css-reset" style="display: table-cell; height: auto; vertical-align: top; position: relative; width: 0px;"><div class="w-css-reset" style="height: 100%;"></div></div><div class="w-vulcan-overlays--center w-css-reset" style="display: table-cell; height: 100%; vertical-align: top; position: relative; width: 100%;"><div class="w-css-reset" style="height: 100%;"><div data-handle="bigPlayButton" class="w-css-reset" style="pointer-events: auto;"><div class="w-bpb-wrapper w-css-reset w-css-reset-tree" style="border-radius: 0px; display: block; left: calc(50%); margin-left: -81.25px; margin-top: -52px; overflow: hidden; position: absolute; top: calc(50% + 0px);"><button aria-label="Play Video: 412_UDC2" tabindex="0" type="button" class="w-big-play-button w-css-reset-button-important w-vulcan-v2-button" style="background-color: transparent; border: 0px; color: rgb(255, 255, 255); cursor: pointer; height: 104px; box-shadow: none; width: 162.5px;"><div style="background: rgb(0, 106, 86); display: block; left: 0px; height: 104px; mix-blend-mode: darken; position: absolute; top: 0px; width: 162.5px;"></div><div style="background-color: rgba(0, 106, 86, 0.7); height: 104px; left: 0px; position: absolute; top: 0px; transition: background-color 150ms; width: 162.5px;"></div><svg x="0px" y="0px" viewBox="0 0 125 80" enable-background="new 0 0 125 80" aria-hidden="true" style="fill: rgb(255, 255, 255); height: 104px; left: 0px; stroke-width: 0px; top: 0px; width: 100%; position: absolute; color: rgb(255, 255, 255);"><path fill-rule="evenodd" clip-rule="evenodd" fill="currentcolor" opacity="1" transform="translate(44, 22)" d="M12.138 2.173C10.812 1.254 9 2.203 9 3.817v28.366c0 1.613 1.812 2.563 3.138 1.644l20.487-14.183a2 2 0 0 0 0-3.288L12.138 2.173Z"></path></svg></button></div></div><div data-handle="clickForSoundButton" class="w-css-reset" style="pointer-events: auto;"><div data-handle="click-for-sound-backdrop" class="w-css-reset w-css-reset-tree" style="display: none; height: 100%; left: 0px; pointer-events: auto; position: absolute; top: 0px; width: 100%;"><button aria-label="Click for sound" class="w-vulcan-v2-button click-for-sound-btn" style="background: rgba(0, 0, 0, 0.8); border: 2px solid transparent; border-radius: 60px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; outline: none; pointer-events: auto; position: absolute; right: 27.25px; top: 27.25px; max-width: 1849.5px;"><div style="display: flex; align-items: center; justify-content: flex-end; white-space: nowrap; overflow: hidden; max-width: 0px; transition: max-width 200ms;"><span style="color: rgb(255, 255, 255); font-family: WistiaPlayerInter, Helvetica, sans-serif; font-size: 18px; font-weight: 500; padding-left: 1em; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 1904px;">Click for sound</span></div><svg viewBox="0 0 237 237" width="68.25" height="68.25"><path fill="#fff" d="M88 107H65v24h24l23 23V84z"></path><g fill="none" stroke="#fff" stroke-linecap="round" stroke-width="10"><path d="M142 86c9 21 9 44 0 65" class="volume__small-wave"></path><path d="M165 74c13 23 13 66 0 89" class="volume__large-wave"></path></g></svg></button></div></div><div data-handle="playPauseNotifier" class="w-css-reset" style="pointer-events: auto;"><div class="w-play-pause-notifier" style="background: rgba(0, 0, 0, 0.6); border-radius: 50%; height: 182px; left: 50%; pointer-events: none; position: absolute; opacity: 0; top: 50%; transform: translate(-50%, -50%) scale(0.8); transition: opacity 0.8s, transform 0.8s; width: 182px;"><div style="width: 100%; height: 100%; margin-left: 0px;"><svg x="0px" y="0px" viewBox="0 0 40 34" enable-background="new 0 0 40 34" aria-hidden="true" style="fill: none; height: 100%; left: 0px; stroke-width: 0px; top: 0px; width: 100%; color: rgb(255, 255, 255);"><path fill-rule="evenodd" clip-rule="evenodd" d="M16.5 11C15.6716 11 15 11.6716 15 12.5V22.5C15 23.3284 15.6716 24 16.5 24H17.5C18.3284 24 19 23.3284 19 22.5V12.5C19 11.6716 18.3284 11 17.5 11H16.5ZM23.5 11C22.6716 11 22 11.6716 22 12.5V22.5C22 23.3284 22.6716 24 23.5 24H24.5C25.3284 24 26 23.3284 26 22.5V12.5C26 11.6716 25.3284 11 24.5 11H23.5Z" fill="currentcolor"></path></svg></div></div></div><div data-handle="playPauseLoading" class="w-css-reset" style="pointer-events: auto;"><div class="w-css-reset w-css-reset-tree" style="height: 100%; left: 0px; pointer-events: none; position: absolute; top: 0px; width: 100%;"><button aria-label="Play Video" class="w-vulcan-v2-button" style="background: rgba(0, 0, 0, 0.6); border: 0px; border-radius: 50%; cursor: pointer; display: none; height: 182px; left: 50%; margin: 0px; padding: 0px; pointer-events: auto; position: absolute; opacity: 0; outline: none; top: 50%; transform: translate(-50%, -50%) scale(0.8); transition: opacity 200ms, transform 600ms; -webkit-tap-highlight-color: rgba(0, 0, 0, 0); width: 182px;"><div style="width: 100%; height: 100%; margin-left: 0px;"><svg x="0px" y="0px" viewBox="0 0 40 34" enable-background="new 0 0 40 34" aria-hidden="true" style="fill: none; height: 100%; left: 0px; stroke-width: 0px; top: 0px; width: 100%; color: rgb(255, 255, 255);"><path d="M24.888 16.1913C25.4371 16.5906 25.4371 17.4094 24.888 17.8087L16.5882 23.845C15.9272 24.3257 15 23.8535 15 23.0362V10.9638C15 10.1465 15.9272 9.67433 16.5882 10.155L24.888 16.1913Z" fill="currentcolor"></path></svg></div></button></div></div></div></div><div class="w-vulcan-overlays--right w-css-reset" style="display: table-cell; height: auto; vertical-align: top; position: relative; width: 0px;"><div class="w-css-reset" style="height: 100%;"></div></div></div><div class="w-bottom-bar w-css-reset" style="bottom: 0px; border-radius: 0px; border-collapse: collapse; display: table; height: 44px; pointer-events: none; position: absolute; padding-left: 0px; padding-right: 0px; right: 50%; table-layout: auto; transform: translate(50%); width: calc(100% + 0px); z-index: 1; animation: 250ms ease-in-out 0s 1 normal forwards running w-control-bar-fade-in;"><div class="w-bottom-bar-lower w-css-reset" style="position: relative;"><div style="height: 100%; left: 0px; position: absolute; top: 0px; width: 100%;"><div style="background: rgb(0, 106, 86); display: none; height: 100%; mix-blend-mode: darken; left: 0px; opacity: 1; position: absolute; top: 0px; transition: opacity; width: 100%;"></div><div style="background: rgba(0, 106, 86, 0.85); border-radius: 0px; height: 100%; opacity: 1; left: 0px; position: absolute; top: 0px; transition: opacity; width: 100%;"></div></div><div style="display: none;"><div style="background: rgb(0, 106, 86); display: none; height: 100%; mix-blend-mode: darken; left: 0px; opacity: 1; position: absolute; top: 0px; transition: opacity; width: 100%;"></div><div style="background: 100% rgba(0, 106, 86, 0.85); border-radius: 0px; height: 100%; opacity: 1; left: 0px; position: absolute; top: 0px; transition: opacity; width: 100%;"></div></div><div class="w-bottom-bar-left w-css-reset" style="display: table-cell; height: auto; vertical-align: top; position: relative; width: 0px; opacity: 1; transition: opacity;"><div class="w-bottom-bar-left-inner w-css-reset" style="height: 44px; position: relative; pointer-events: auto; white-space: nowrap;"><div data-handle="smallPlayButton" class="w-css-reset" style="display: inline-block; vertical-align: top;"><div class="w-vulcan-button-wrapper w-css-reset" style="display: inline-block; height: 44px; position: relative; vertical-align: top; width: 52px;"><button tabindex="0" class="w-vulcan-v2-button w-css-reset w-css-reset-tree w-css-reset-button-important" aria-label="Play Video" title="Play Video" style="background-color: transparent; border-radius: 0px; box-shadow: none; cursor: pointer; height: 100%; position: relative; transition: background-color 150ms; width: 100%; color: var(--wistia-player-icon-color) !important;"><div data-handle="smallPlayButton_icon_wrapper" class="w-vulcan-icon-wrapper" style="box-sizing: border-box; height: 100%; position: relative; opacity: 1; transform: scale(1.001); transition: transform 200ms;"><div style="width: 100%; height: 100%; margin-left: 1.95px;"><svg x="0px" y="0px" viewBox="0 0 40 34" enable-background="new 0 0 40 34" aria-hidden="true" style="fill: none; height: 100%; left: 0px; stroke-width: 0px; top: 0px; width: 100%; vertical-align: top;"><path d="M24.888 16.1913C25.4371 16.5906 25.4371 17.4094 24.888 17.8087L16.5882 23.845C15.9272 24.3257 15 23.8535 15 23.0362V10.9638C15 10.1465 15.9272 9.67433 16.5882 10.155L24.888 16.1913Z" fill="currentcolor"></path></svg></div></div></button></div></div></div></div><div class="w-bottom-bar-middle w-css-reset" style="display: table-cell; height: auto; vertical-align: top; position: relative; width: 100%; opacity: 1; transition: opacity;"><div class="w-bottom-bar-middle-inner w-css-reset" style="height: 44px; position: relative; pointer-events: auto; white-space: nowrap; opacity: 1; transform: translateY(0px); transition: opacity, transform;"><div data-handle="playbar" class="w-css-reset" style="height: 100%; position: relative;"><div class="w-playbar-wrapper w-css-reset w-css-reset-tree" style="display: flex; height: 100%; width: 100%;"><div class="w-playbar__time" style="box-sizing: content-box; color: rgb(255, 255, 255); font-family: WistiaPlayerInterNumbersSemiBold, Helvetica, sans-serif; font-size: 16.9px; letter-spacing: 0.65px; line-height: 44px; padding-left: 6.5px; pointer-events: none; position: relative; text-align: center; width: 36.4px;">2:58</div><div style="width: 100%; position: relative;"><div aria-label="Playbar" aria-orientation="horizontal" aria-valuemax="178.19" aria-valuemin="0" aria-valuenow="0" aria-valuetext="0 seconds" role="slider" tabindex="0" style="cursor: pointer; flex: 1 1 0%; height: 44px; outline: none; margin-left: 19.5px; margin-right: 13px; position: relative;"><canvas height="44" width="1669.1" style="height: 44px; left: -19.5px; position: absolute; top: 0px; width: 1669.1px;"></canvas><div style="border-radius: 50%; height: 14.56px; left: -7.28px; opacity: 0; position: absolute; top: 14.72px; width: 14.56px;"></div></div></div></div></div></div></div><div class="w-bottom-bar-right w-css-reset" style="display: table-cell; height: auto; vertical-align: top; position: relative; width: 0px; opacity: 1; transition: opacity; white-space: nowrap;"><div class="w-bottom-bar-right-inner-anchor w-css-reset" style="height: 44px; position: relative; pointer-events: auto; white-space: nowrap; display: inline-block; right: 0px; top: 0px; vertical-align: top;"><div class="w-bottom-bar-right-inner w-css-reset" style="height: 44px; position: relative; pointer-events: auto; white-space: nowrap; display: inline-block; opacity: 1; right: 0px; top: 0px; transform: translateY(0px); transition: opacity, transform;"><div data-handle="volumeButton" class="w-css-reset" style="display: inline-block; vertical-align: top;"><div class="w-vulcan-button-wrapper w-css-reset" style="display: inline-block; height: 44px; position: relative; vertical-align: top; width: 52px;"><button tabindex="0" aria-pressed="false" class="w-vulcan-v2-button w-css-reset w-css-reset-tree w-css-reset-button-important" aria-label="Mute" title="Mute" style="background-color: transparent; border-radius: 0px; box-shadow: none; cursor: pointer; height: 100%; position: relative; transition: background-color 150ms; width: 100%; color: var(--wistia-player-icon-color) !important;"><div data-handle="volumeButton_icon_wrapper" class="w-vulcan-icon-wrapper" style="box-sizing: border-box; height: 100%; position: relative; opacity: 1; transform: scale(1.001); transition: transform 200ms;"><svg x="0px" y="0px" viewBox="0 0 40 34" enable-background="new 0 0 40 34" aria-hidden="true" style="fill: none; height: 100%; left: 0px; stroke-width: 0px; top: 0px; width: 100%;"><g style="transform: translateX(1.25px); transition: transform 100ms;"><path d="M15.8 13.9995C15.3 14.4995 14.4 14.7995 13.8 14.7995H12.2C11.5 14.7995 11 15.2995 11 15.9995V17.5995C11 18.2995 11.5 18.7995 12.2 18.7995H13.8C14.5 18.7995 15.4 19.1995 15.8 19.5995L18.2 21.3999C18.5296 21.6472 19 21.412 19 20.9999V12.154C19 11.7163 18.4774 11.4899 18.1581 11.7892L15.8 13.9995Z" fill="currentcolor"></path><g stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.5C22 11.5 23.1 14 23.1 16.5C23.1 19 22 21.5 22 21.5" style="opacity: 1; transition: opacity 100ms;"></path><path d="M26 9C26 9 27.7 12.8 27.7 16.5C27.7 20.2 26 24 26 24" style="opacity: 1; transition: opacity 100ms;"></path><g style="opacity: 0; transition: opacity 100ms;"><path d="M22 14L27 19"></path><path d="M27 14L22 19"></path></g></g></g></svg></div></button></div></div><div data-handle="settingsButton" class="w-css-reset" style="display: inline-block; vertical-align: top;"><div class="w-vulcan-button-wrapper w-css-reset" style="display: inline-block; height: 44px; position: relative; vertical-align: top; width: 52px;"><button tabindex="0" aria-expanded="false" class="w-vulcan-v2-button w-css-reset w-css-reset-tree w-css-reset-button-important" aria-label="Show settings menu" title="Show settings menu" style="background-color: transparent; border-radius: 0px; box-shadow: none; cursor: pointer; height: 100%; position: relative; transition: background-color 150ms; width: 100%; color: var(--wistia-player-icon-color) !important;"><div data-handle="settingsButton_icon_wrapper" class="w-vulcan-icon-wrapper" style="box-sizing: border-box; height: 100%; position: relative; opacity: 1; transform: scale(1.001); transition: transform 200ms;"><svg x="0px" y="0px" viewBox="0 0 40 34" enable-background="new 0 0 40 34" aria-hidden="true" style="fill: none; height: 100%; left: 0px; stroke-width: 0px; top: 0px; width: 100%;"><path fill-rule="evenodd" clip-rule="evenodd" d="M26.4 15.4H28.3C28.7 15.4 29 15.7 29 16.1V16.7C29 17.1 28.7 17.4 28.3 17.4H26.4C26 17.4 25.6 17.7 25.5 18.1L25.1 19.2C25 19.5 25 20 25.3 20.3L26.6 21.6C26.9 21.9 26.9 22.3 26.6 22.6L26.2 23C25.9 23.3 25.5 23.3 25.2 23L23.9 21.7C23.6 21.5 23.1 21.4 22.8 21.6L21.7 22.1C21.3 22.2 21 22.6 21 23V24.7C21 25.1 20.7 25.4 20.3 25.4H19.7C19.3 25.4 19 25.1 19 24.7V23C19 22.6 18.7 22.2 18.3 22.1L17.1 21.6C16.8 21.5 16.3 21.5 16 21.8L14.8 23C14.5 23.3 14.1 23.3 13.8 23L13.4 22.6C13.1 22.3 13.1 21.9 13.4 21.6L14.6 20.4C14.8 20.1 14.9 19.6 14.7 19.3L14.2 18.1C14.1 17.7 13.7 17.4 13.3 17.4H11.7C11.3 17.4 11 17.1 11 16.7V16.1C11 15.7 11.3 15.4 11.7 15.4H13.3C13.7 15.4 14.1 15.1 14.2 14.7L14.7 13.5C14.9 13.2 14.9 12.7 14.6 12.4L13.4 11.2C13.1 10.9 13.1 10.5 13.4 10.2L13.8 9.8C14.1 9.5 14.5 9.5 14.8 9.8L16 11C16.3 11.3 16.8 11.4 17.1 11.2L18.3 10.7C18.7 10.6 19 10.2 19 9.8V8.1C19 7.7 19.3 7.4 19.7 7.4H20.3C20.7 7.4 21 7.7 21 8.1V9.8C21 10.2 21.3 10.6 21.7 10.7L22.8 11.2C23.1 11.4 23.6 11.4 23.9 11.1L25.2 9.8C25.5 9.5 25.9 9.5 26.2 9.8L26.6 10.2C26.9 10.5 26.9 10.9 26.6 11.2L25.3 12.5C25 12.8 24.9 13.3 25.1 13.6L25.5 14.7C25.6 15.1 26 15.4 26.4 15.4ZM19.9 20.4C22 20.4 23.8 18.7 23.8 16.5C23.8 14.3 22.1 12.6 19.9 12.6C17.7 12.6 16 14.4 16 16.5C16 18.6 17.7 20.4 19.9 20.4Z" fill="currentcolor"></path></svg></div></button></div></div><div data-handle="fullscreenControl" class="w-css-reset" style="display: inline-block; vertical-align: top;"><div class="w-vulcan-button-wrapper w-css-reset" style="display: inline-block; height: 44px; position: relative; vertical-align: top; width: 52px;"><button tabindex="0" class="w-vulcan-v2-button w-css-reset w-css-reset-tree w-css-reset-button-important" aria-label="Fullscreen" title="Fullscreen" style="background-color: transparent; border-radius: 0px; box-shadow: none; cursor: pointer; height: 100%; position: relative; transition: background-color 150ms; width: 100%; color: var(--wistia-player-icon-color) !important;"><div data-handle="fullscreenControl_icon_wrapper" class="w-vulcan-icon-wrapper" style="box-sizing: border-box; height: 100%; position: relative; opacity: 1; transform: scale(1.001); transition: transform 200ms;"><svg x="0px" y="0px" viewBox="0 0 40 34" enable-background="new 0 0 40 34" aria-hidden="true" style="fill: none; height: 100%; left: 0px; stroke-width: 0px; top: 0px; width: 100%;"><rect x="14" y="13" width="12" height="8" rx="1.5" stroke="currentcolor" stroke-width="2"></rect><g stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13V11C10 9.89543 10.8954 9 12 9H14"></path><path d="M30 13V11C30 9.89543 29.1046 9 28 9H26"></path><path d="M30 21L30 23C30 24.1046 29.1046 25 28 25L26 25"></path><path d="M10 21L10 23C10 24.1046 10.8954 25 12 25L14 25"></path></g></svg></div></button></div></div></div></div><div class="w-wistia-logo w-css-reset" style="height: 44px; position: relative; pointer-events: auto; white-space: nowrap; display: none; right: 0px; top: 0px;"></div><div class="w-ellipsis w-css-reset" style="height: 44px; position: relative; pointer-events: auto; white-space: nowrap; display: none;"></div></div></div></div><div class="w-foreground w-css-reset" style="height: 100%; left: 0px; pointer-events: none; position: absolute; top: 0px; width: 100%; z-index: 1;"><div data-handle="contextMenu" class="w-css-reset" style="pointer-events: auto;"></div><div data-handle="loadingHourglass" class="w-css-reset" style="pointer-events: auto;"></div><div data-handle="focusOutline" class="w-css-reset" style="pointer-events: auto;"><div class="w-focus-outline" style="box-shadow: rgb(255, 255, 255) 0px 0px 0px 2px inset; border-radius: 0px; display: none; height: 100%; left: 0px; pointer-events: none; position: absolute; right: 0px; width: 100%;"></div></div></div></div></div></div><div id="wistia_grid_202_front"></div><div id="wistia_grid_202_top_inside"><div id="wistia_grid_202_top"></div></div><div id="wistia_grid_202_bottom_inside"><div id="wistia_grid_202_bottom"></div></div><div id="wistia_grid_202_left_inside"><div id="wistia_grid_202_left"></div></div><div id="wistia_grid_202_right_inside"><div id="wistia_grid_202_right"></div></div></div><div id="wistia_grid_202_below"></div></div></div></wistia-player>

<p style="text-align:center;"><span class="wp-element-caption"><em><strong>Video 2: </strong></em> <em>User Defined Command and Control (UDC2)</em></span></p>



<p>As highlighted in this video, you can ‘pin’ specific BOFs to a given UDC2 listener which gives a native feel to exported payloads for custom C2 channels.&nbsp;</p>



<p>Furthermore, to aid development of&nbsp;UDC2 BOFs, <strong>we have released&nbsp;<a href="https://github.com/Cobalt-Strike/udc2-vs" target="_blank" rel="noreferrer noopener">UDC2-VS</a>.</strong>&nbsp;This&nbsp;contains&nbsp;a basic&nbsp;UDC2&nbsp;TCP implementation&nbsp;demonstrating UDC2’s software contract&nbsp;and can be used to rapidly develop custom&nbsp;C2 channels.&nbsp;For more information on how UDC2 works you can check the documentation&nbsp;<a href="https://hstechdocs.helpsystems.com/manuals/cobaltstrike/current/userguide/content/topics/listener-infrastructure_user-defined-c2.htm" target="_blank" rel="noreferrer noopener">here</a>&nbsp;or look at the readme in&nbsp;<a href="https://github.com/Cobalt-Strike/udc2-vs" target="_blank" rel="noreferrer noopener">UDC2-VS</a>.</p>



<p>Lastly, we have also&nbsp;<a href="https://github.com/Cobalt-Strike/icmp-udc2" target="_blank" rel="noreferrer noopener">open sourced</a>&nbsp;the ICMP UDC2 channel&nbsp;demonstrated&nbsp;above.&nbsp;The repository&nbsp;contains&nbsp;a quick start guide&nbsp;on how to get up and running with the&nbsp;ICMP&nbsp;UDC2&nbsp;channel&nbsp;in&nbsp;Cobalt Strike&nbsp;straight away.&nbsp;</p>



<h2 class="wp-block-heading">Process Injection Overhaul</h2>



<p>This&nbsp;release also includes new process injection options.&nbsp;These process injection techniques are implemented as BOFs and use the&nbsp;<a href="https://offensivedefence.co.uk/posts/cs-process-inject-kit/" target="_blank" rel="noreferrer noopener">process inject kit</a>&nbsp;under the hood.&nbsp;These are available via the&nbsp;new&nbsp;GUI&nbsp;option,&nbsp;<code>Advanced Config-&gt;Process Injection</code>.&nbsp;&nbsp;They support both&nbsp;explicit injection (i.e. inject into a&nbsp;specified process) and fork/run injection (i.e.&nbsp;spawn a process and inject into it).&nbsp;The&nbsp;new&nbsp;techniques&nbsp;added are:&nbsp;</p>



<ul class="wp-block-list">
<li><code>RtlCloneUserProcess</code>&nbsp;–&nbsp;This is based on&nbsp;<a href="https://www.deepinstinct.com/blog/dirty-vanity-a-new-approach-to-code-injection-edr-bypass" target="_blank" rel="noreferrer noopener">DirtyVanity</a>&nbsp;and&nbsp;leverages&nbsp;cloned processes to&nbsp;break up the typical&nbsp;allocate/write/execute injection primitives&nbsp;used&nbsp;by&nbsp;EDRs to detect process injection.</li>



<li><code>TpDirect</code>– Based on the&nbsp;<a href="https://www.safebreach.com/blog/process-injection-using-windows-thread-pools/" target="_blank" rel="noreferrer noopener">work of SafeBreach Labs,</a>&nbsp;this technique manipulates a target process’s&nbsp;<code>TP_DIRECT</code>&nbsp;structure to trigger remote thread creation.</li>



<li><code>TpStartRoutineStub</code>&nbsp;–&nbsp;Also based on the same&nbsp;SafeBreach&nbsp;Labs research referenced above,&nbsp;this technique manipulates a target process’s&nbsp;thread pool to trigger remote thread creation.</li>



<li><code>EarlyCascade</code>&nbsp;(Fork/Run only) –&nbsp;This&nbsp;is based on&nbsp;<a href="https://www.outflank.nl/blog/2024/10/15/introducing-early-cascade-injection-from-windows-process-creation-to-stealthy-injection/" target="_blank" rel="noreferrer noopener">Outflank’s research</a>&nbsp;and&nbsp;manipulates process initialization routines to redirect code execution to&nbsp;an&nbsp;injected payload.</li>
</ul>



<p>Additionally,&nbsp;Cobalt Strike users&nbsp;can add&nbsp;their&nbsp;own&nbsp;process injection&nbsp;techniques to the GUI.&nbsp;Two new Aggressor <a href="https://hstechdocs.helpsystems.com/manuals/cobaltstrike/current/userguide/content/topics_aggressor-scripts/as-resources_hooks.htm" target="_blank" rel="noreferrer noopener">hooks</a>, <code>PROCESS_INJECT_EXPLICIT_USER/PROCESS_INJECT_SPAWN_USER</code> have been added&nbsp;which enable adding custom process injection BOFs to the <code>Advanced Config-&gt;Process Injection</code>&nbsp;menu.&nbsp;&nbsp;<br>&nbsp;<br>A short&nbsp;<code>.cna</code> snippet&nbsp;for&nbsp;adding a custom technique&nbsp;to&nbsp;the&nbsp;explicit process injection&nbsp;GUI option&nbsp;can be found below:</p>


<div class="wp-block-syntaxhighlighter-code "><div id="highlighter_213525" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="https://www.cobaltstrike.com/blog/cobalt-strike-412-fix-up-look-sharp#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_213525_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_213525" menu="false" src="https://www.cobaltstrike.com/app/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="https://www.cobaltstrike.com/blog/cobalt-strike-412-fix-up-look-sharp#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="https://www.cobaltstrike.com/blog/cobalt-strike-412-fix-up-look-sharp#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">set PROCESS_INJECT_EXPLICIT_USER { </code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">local</code><code class="plain">(</code><code class="string">'%explicit_injections'</code><code class="plain">); </code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="variable">%explicit_injections</code><code class="plain">[</code><code class="string">"MyFavoriteExplicitInjection-x64"</code><code class="plain">] = </code><code class="string">"/path/to/my/bof.x64.o"</code><code class="plain">; </code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">return</code> <code class="variable">%explicit_injections</code><code class="plain">; </code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div></div></div></div>


<p>Loading the script above will make the new&nbsp;option&nbsp;available from the&nbsp;<code>Process Injection</code>&nbsp;dialog:&nbsp;</p>



<figure class="wp-block-image aligncenter size-full is-resized"><img decoding="async" width="850" height="520" src="https://www.cobaltstrike.com/app/uploads/2025/11/412_proc_inj_hook.png" alt="" class="wp-image-8786" style="width:500px;height:auto"><figcaption class="wp-element-caption"><em><strong>Fig 3:</strong></em> <em>A&nbsp;screenshot of the new Process Injection GUI with a custom technique, <code>MyFavoriteExplicitInjection-x64</code>, added.</em></figcaption></figure>



<p>The demo below shows the new process injection options in action:</p>



 <wistia-player media-id="b0vac1o3tt" aspect="1.7777777777777777" unique-id="wistia-b0vac1o3tt-18"><div><div class="wistia_swatch" style="height: 1071px; left: 0px; position: absolute; top: 0px; width: 100%;"><div style="height: 100%; position: relative; width: 100%;"><div style="height: 100%; left: 0px; overflow: hidden; position: absolute; top: 0px; width: 100%; border-radius: 0px;"><img src="https://fast.wistia.com/embed/medias/b0vac1o3tt/swatch" alt="" aria-hidden="true" style="filter: blur(5px); height: 100%; object-fit: contain; width: 100%;"></div></div></div><div><div style="--wistia-player-icon-color: #ffffff;"><div tabindex="-1" class="w-css-reset" style="cursor: pointer; width: 100%; height: 1080px;"><div><div class="w-css-reset" style="height: 100%; left: 0px; opacity: 1; position: absolute; top: 0px; width: 100%; display: block;"><img src="https://embed-ssl.wistia.com/deliveries/74cea494d3e59a75e2789671bdd7a2f913c82d7b.webp?image_crop_resized=1920x1080" alt="" class="w-css-reset" style="background-color: rgb(0, 0, 0); height: 100%; object-fit: contain; position: absolute; width: 100%; top: 0px; left: 0px; clip: auto; display: block; border-radius: 0px;"></div></div></div><div class="w-bpb-wrapper w-css-reset w-css-reset-tree" style="border-radius: 0px; display: block; left: calc(50%); margin-left: -81.25px; margin-top: -52px; overflow: hidden; position: absolute; top: calc(50% - 22.1px);"><button aria-label="Play Video: 412_ProcessInjection" tabindex="0" type="button" class="w-big-play-button w-css-reset-button-important w-vulcan-v2-button" style="background-color: transparent; border: 0px; color: rgb(255, 255, 255); cursor: pointer; height: 104px; box-shadow: none; width: 162.5px;"><div style="background: rgb(0, 106, 86); display: block; left: 0px; height: 104px; mix-blend-mode: darken; position: absolute; top: 0px; width: 162.5px;"></div><div style="background-color: rgba(0, 106, 86, 0.7); height: 104px; left: 0px; position: absolute; top: 0px; transition: background-color 150ms; width: 162.5px;"></div><svg x="0px" y="0px" viewBox="0 0 125 80" enable-background="new 0 0 125 80" aria-hidden="true" style="fill: rgb(255, 255, 255); height: 104px; left: 0px; stroke-width: 0px; top: 0px; width: 100%; position: absolute; color: rgb(255, 255, 255);"><path fill-rule="evenodd" clip-rule="evenodd" fill="currentcolor" opacity="1" transform="translate(44, 22)" d="M12.138 2.173C10.812 1.254 9 2.203 9 3.817v28.366c0 1.613 1.812 2.563 3.138 1.644l20.487-14.183a2 2 0 0 0 0-3.288L12.138 2.173Z"></path></svg></button></div></div></div></div><div id="wistia_chrome_82" class="w-chrome notranslate" tabindex="-1" style="display: inline-block; height: 100%; line-height: normal; margin: 0px; padding: 0px; position: relative; vertical-align: top; width: 100%; outline: none; overflow: hidden; box-sizing: content-box; border-radius: 0px; clip-path: inset(0.5px);"><div id="wistia_grid_88_wrapper" style="display: block;"><div id="wistia_grid_88_above"></div><div id="wistia_grid_88_main"><div id="wistia_grid_88_behind"></div><div id="wistia_grid_88_center"><div class="w-video-wrapper w-css-reset" style="width: 100%; height: 100%; display: flex; align-items: center; opacity: 1; background-color: rgb(0, 0, 0);"><video id="wistia_simple_video_299" crossorigin="anonymous" aria-label="412_ProcessInjection" controlslist="nodownload" playsinline="" preload="none" type="video/m3u8" x-webkit-airplay="allow" style="background: transparent; display: block; height: 100%; max-height: none; max-width: none; position: static; visibility: visible; width: 100%; aspect-ratio: 1.77778 / 1; object-fit: contain;"></video></div><div class="w-ui-container" style="height: 100%; left: 0px; position: absolute; top: 0px; width: 100%; opacity: 1;"><div id="w-vulcan-v2-87" class="w-vulcan-v2 w-css-reset" style="border-radius: 0px; box-sizing: border-box; cursor: default; direction: ltr; height: 100%; left: 0px; position: absolute; visibility: visible; top: 0px; width: 100%; --wistia-player-icon-color: #ffffff; --wistia-player-color-hover: #001100; --wistia-player-icon-color-hover: #fff;"><div class="w-vulcan--background w-css-reset" style="height: 100%; left: 0px; position: absolute; top: 0px; width: 100%;"><div data-handle="statusBar" class="w-css-reset"></div><div data-handle="backgroundFocus" class="w-css-reset"><button aria-label="Play Video: 412_ProcessInjection" tabindex="0" class="w-css-reset w-vulcan-v2-button" style="clip: rect(1px, 1px, 1px, 1px); height: 1px; overflow: hidden; position: absolute; white-space: nowrap; width: 1px; pointer-events: none;"></button></div><div data-handle="thumbnail" class="w-css-reset"><div><div class="w-css-reset" style="height: 100%; left: 0px; opacity: 1; position: absolute; top: 0px; width: 100%; display: block;"><img src="https://embed-ssl.wistia.com/deliveries/74cea494d3e59a75e2789671bdd7a2f913c82d7b.webp?image_crop_resized=1920x1080" alt="Video Thumbnail" class="w-css-reset" style="background-color: rgb(0, 0, 0); height: 100%; object-fit: contain; position: absolute; width: 100%; top: 0px; left: 0px; clip: auto; display: block; border-radius: 0px;"></div></div></div></div><div aria-live="polite" aria-atomic="true" class="w-vulcan--aria-live w-css-reset" style="position: absolute; left: -99999em;"></div><div class="w-vulcan-overlays-table w-css-reset" style="display: table; pointer-events: none; position: absolute; width: 100%; height: calc(100% - 44px);"><div class="w-vulcan-overlays--left w-css-reset" style="display: table-cell; height: auto; vertical-align: top; position: relative; width: 0px;"><div class="w-css-reset" style="height: 100%;"></div></div><div class="w-vulcan-overlays--center w-css-reset" style="display: table-cell; height: 100%; vertical-align: top; position: relative; width: 100%;"><div class="w-css-reset" style="height: 100%;"><div data-handle="bigPlayButton" class="w-css-reset" style="pointer-events: auto;"><div class="w-bpb-wrapper w-css-reset w-css-reset-tree" style="border-radius: 0px; display: block; left: calc(50%); margin-left: -81.25px; margin-top: -52px; overflow: hidden; position: absolute; top: calc(50% + 0px);"><button aria-label="Play Video: 412_ProcessInjection" tabindex="0" type="button" class="w-big-play-button w-css-reset-button-important w-vulcan-v2-button" style="background-color: transparent; border: 0px; color: rgb(255, 255, 255); cursor: pointer; height: 104px; box-shadow: none; width: 162.5px;"><div style="background: rgb(0, 106, 86); display: block; left: 0px; height: 104px; mix-blend-mode: darken; position: absolute; top: 0px; width: 162.5px;"></div><div style="background-color: rgba(0, 106, 86, 0.7); height: 104px; left: 0px; position: absolute; top: 0px; transition: background-color 150ms; width: 162.5px;"></div><svg x="0px" y="0px" viewBox="0 0 125 80" enable-background="new 0 0 125 80" aria-hidden="true" style="fill: rgb(255, 255, 255); height: 104px; left: 0px; stroke-width: 0px; top: 0px; width: 100%; position: absolute; color: rgb(255, 255, 255);"><path fill-rule="evenodd" clip-rule="evenodd" fill="currentcolor" opacity="1" transform="translate(44, 22)" d="M12.138 2.173C10.812 1.254 9 2.203 9 3.817v28.366c0 1.613 1.812 2.563 3.138 1.644l20.487-14.183a2 2 0 0 0 0-3.288L12.138 2.173Z"></path></svg></button></div></div><div data-handle="clickForSoundButton" class="w-css-reset" style="pointer-events: auto;"><div data-handle="click-for-sound-backdrop" class="w-css-reset w-css-reset-tree" style="display: none; height: 100%; left: 0px; pointer-events: auto; position: absolute; top: 0px; width: 100%;"><button aria-label="Click for sound" class="w-vulcan-v2-button click-for-sound-btn" style="background: rgba(0, 0, 0, 0.8); border: 2px solid transparent; border-radius: 60px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; outline: none; pointer-events: auto; position: absolute; right: 27.25px; top: 27.25px; max-width: 1849.5px;"><div style="display: flex; align-items: center; justify-content: flex-end; white-space: nowrap; overflow: hidden; max-width: 0px; transition: max-width 200ms;"><span style="color: rgb(255, 255, 255); font-family: WistiaPlayerInter, Helvetica, sans-serif; font-size: 18px; font-weight: 500; padding-left: 1em; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 1904px;">Click for sound</span></div><svg viewBox="0 0 237 237" width="68.25" height="68.25"><path fill="#fff" d="M88 107H65v24h24l23 23V84z"></path><g fill="none" stroke="#fff" stroke-linecap="round" stroke-width="10"><path d="M142 86c9 21 9 44 0 65" class="volume__small-wave"></path><path d="M165 74c13 23 13 66 0 89" class="volume__large-wave"></path></g></svg></button></div></div><div data-handle="playPauseNotifier" class="w-css-reset" style="pointer-events: auto;"><div class="w-play-pause-notifier" style="background: rgba(0, 0, 0, 0.6); border-radius: 50%; height: 182px; left: 50%; pointer-events: none; position: absolute; opacity: 0; top: 50%; transform: translate(-50%, -50%) scale(0.8); transition: opacity 0.8s, transform 0.8s; width: 182px;"><div style="width: 100%; height: 100%; margin-left: 0px;"><svg x="0px" y="0px" viewBox="0 0 40 34" enable-background="new 0 0 40 34" aria-hidden="true" style="fill: none; height: 100%; left: 0px; stroke-width: 0px; top: 0px; width: 100%; color: rgb(255, 255, 255);"><path fill-rule="evenodd" clip-rule="evenodd" d="M16.5 11C15.6716 11 15 11.6716 15 12.5V22.5C15 23.3284 15.6716 24 16.5 24H17.5C18.3284 24 19 23.3284 19 22.5V12.5C19 11.6716 18.3284 11 17.5 11H16.5ZM23.5 11C22.6716 11 22 11.6716 22 12.5V22.5C22 23.3284 22.6716 24 23.5 24H24.5C25.3284 24 26 23.3284 26 22.5V12.5C26 11.6716 25.3284 11 24.5 11H23.5Z" fill="currentcolor"></path></svg></div></div></div><div data-handle="playPauseLoading" class="w-css-reset" style="pointer-events: auto;"><div class="w-css-reset w-css-reset-tree" style="height: 100%; left: 0px; pointer-events: none; position: absolute; top: 0px; width: 100%;"><button aria-label="Play Video" class="w-vulcan-v2-button" style="background: rgba(0, 0, 0, 0.6); border: 0px; border-radius: 50%; cursor: pointer; display: none; height: 182px; left: 50%; margin: 0px; padding: 0px; pointer-events: auto; position: absolute; opacity: 0; outline: none; top: 50%; transform: translate(-50%, -50%) scale(0.8); transition: opacity 200ms, transform 600ms; -webkit-tap-highlight-color: rgba(0, 0, 0, 0); width: 182px;"><div style="width: 100%; height: 100%; margin-left: 0px;"><svg x="0px" y="0px" viewBox="0 0 40 34" enable-background="new 0 0 40 34" aria-hidden="true" style="fill: none; height: 100%; left: 0px; stroke-width: 0px; top: 0px; width: 100%; color: rgb(255, 255, 255);"><path d="M24.888 16.1913C25.4371 16.5906 25.4371 17.4094 24.888 17.8087L16.5882 23.845C15.9272 24.3257 15 23.8535 15 23.0362V10.9638C15 10.1465 15.9272 9.67433 16.5882 10.155L24.888 16.1913Z" fill="currentcolor"></path></svg></div></button></div></div></div></div><div class="w-vulcan-overlays--right w-css-reset" style="display: table-cell; height: auto; vertical-align: top; position: relative; width: 0px;"><div class="w-css-reset" style="height: 100%;"></div></div></div><div class="w-bottom-bar w-css-reset" style="bottom: 0px; border-radius: 0px; border-collapse: collapse; display: table; height: 44px; pointer-events: none; position: absolute; padding-left: 0px; padding-right: 0px; right: 50%; table-layout: auto; transform: translate(50%); width: calc(100% + 0px); z-index: 1; animation: 250ms ease-in-out 0s 1 normal forwards running w-control-bar-fade-in;"><div class="w-bottom-bar-lower w-css-reset" style="position: relative;"><div style="height: 100%; left: 0px; position: absolute; top: 0px; width: 100%;"><div style="background: rgb(0, 106, 86); display: none; height: 100%; mix-blend-mode: darken; left: 0px; opacity: 1; position: absolute; top: 0px; transition: opacity; width: 100%;"></div><div style="background: rgba(0, 106, 86, 0.85); border-radius: 0px; height: 100%; opacity: 1; left: 0px; position: absolute; top: 0px; transition: opacity; width: 100%;"></div></div><div style="display: none;"><div style="background: rgb(0, 106, 86); display: none; height: 100%; mix-blend-mode: darken; left: 0px; opacity: 1; position: absolute; top: 0px; transition: opacity; width: 100%;"></div><div style="background: 100% rgba(0, 106, 86, 0.85); border-radius: 0px; height: 100%; opacity: 1; left: 0px; position: absolute; top: 0px; transition: opacity; width: 100%;"></div></div><div class="w-bottom-bar-left w-css-reset" style="display: table-cell; height: auto; vertical-align: top; position: relative; width: 0px; opacity: 1; transition: opacity;"><div class="w-bottom-bar-left-inner w-css-reset" style="height: 44px; position: relative; pointer-events: auto; white-space: nowrap;"><div data-handle="smallPlayButton" class="w-css-reset" style="display: inline-block; vertical-align: top;"><div class="w-vulcan-button-wrapper w-css-reset" style="display: inline-block; height: 44px; position: relative; vertical-align: top; width: 52px;"><button tabindex="0" class="w-vulcan-v2-button w-css-reset w-css-reset-tree w-css-reset-button-important" aria-label="Play Video" title="Play Video" style="background-color: transparent; border-radius: 0px; box-shadow: none; cursor: pointer; height: 100%; position: relative; transition: background-color 150ms; width: 100%; color: var(--wistia-player-icon-color) !important;"><div data-handle="smallPlayButton_icon_wrapper" class="w-vulcan-icon-wrapper" style="box-sizing: border-box; height: 100%; position: relative; opacity: 1; transform: scale(1.001); transition: transform 200ms;"><div style="width: 100%; height: 100%; margin-left: 1.95px;"><svg x="0px" y="0px" viewBox="0 0 40 34" enable-background="new 0 0 40 34" aria-hidden="true" style="fill: none; height: 100%; left: 0px; stroke-width: 0px; top: 0px; width: 100%; vertical-align: top;"><path d="M24.888 16.1913C25.4371 16.5906 25.4371 17.4094 24.888 17.8087L16.5882 23.845C15.9272 24.3257 15 23.8535 15 23.0362V10.9638C15 10.1465 15.9272 9.67433 16.5882 10.155L24.888 16.1913Z" fill="currentcolor"></path></svg></div></div></button></div></div></div></div><div class="w-bottom-bar-middle w-css-reset" style="display: table-cell; height: auto; vertical-align: top; position: relative; width: 100%; opacity: 1; transition: opacity;"><div class="w-bottom-bar-middle-inner w-css-reset" style="height: 44px; position: relative; pointer-events: auto; white-space: nowrap; opacity: 1; transform: translateY(0px); transition: opacity, transform;"><div data-handle="playbar" class="w-css-reset" style="height: 100%; position: relative;"><div class="w-playbar-wrapper w-css-reset w-css-reset-tree" style="display: flex; height: 100%; width: 100%;"><div class="w-playbar__time" style="box-sizing: content-box; color: rgb(255, 255, 255); font-family: WistiaPlayerInterNumbersSemiBold, Helvetica, sans-serif; font-size: 16.9px; letter-spacing: 0.65px; line-height: 44px; padding-left: 6.5px; pointer-events: none; position: relative; text-align: center; width: 36.4px;">5:01</div><div style="width: 100%; position: relative;"><div aria-label="Playbar" aria-orientation="horizontal" aria-valuemax="301.186" aria-valuemin="0" aria-valuenow="0" aria-valuetext="0 seconds" role="slider" tabindex="0" style="cursor: pointer; flex: 1 1 0%; height: 44px; outline: none; margin-left: 19.5px; margin-right: 13px; position: relative;"><canvas height="44" width="1669.1" style="height: 44px; left: -19.5px; position: absolute; top: 0px; width: 1669.1px;"></canvas><div style="border-radius: 50%; height: 14.56px; left: -7.28px; opacity: 0; position: absolute; top: 14.72px; width: 14.56px;"></div></div></div></div></div></div></div><div class="w-bottom-bar-right w-css-reset" style="display: table-cell; height: auto; vertical-align: top; position: relative; width: 0px; opacity: 1; transition: opacity; white-space: nowrap;"><div class="w-bottom-bar-right-inner-anchor w-css-reset" style="height: 44px; position: relative; pointer-events: auto; white-space: nowrap; display: inline-block; right: 0px; top: 0px; vertical-align: top;"><div class="w-bottom-bar-right-inner w-css-reset" style="height: 44px; position: relative; pointer-events: auto; white-space: nowrap; display: inline-block; opacity: 1; right: 0px; top: 0px; transform: translateY(0px); transition: opacity, transform;"><div data-handle="volumeButton" class="w-css-reset" style="display: inline-block; vertical-align: top;"><div class="w-vulcan-button-wrapper w-css-reset" style="display: inline-block; height: 44px; position: relative; vertical-align: top; width: 52px;"><button tabindex="0" aria-pressed="false" class="w-vulcan-v2-button w-css-reset w-css-reset-tree w-css-reset-button-important" aria-label="Mute" title="Mute" style="background-color: transparent; border-radius: 0px; box-shadow: none; cursor: pointer; height: 100%; position: relative; transition: background-color 150ms; width: 100%; color: var(--wistia-player-icon-color) !important;"><div data-handle="volumeButton_icon_wrapper" class="w-vulcan-icon-wrapper" style="box-sizing: border-box; height: 100%; position: relative; opacity: 1; transform: scale(1.001); transition: transform 200ms;"><svg x="0px" y="0px" viewBox="0 0 40 34" enable-background="new 0 0 40 34" aria-hidden="true" style="fill: none; height: 100%; left: 0px; stroke-width: 0px; top: 0px; width: 100%;"><g style="transform: translateX(1.25px); transition: transform 100ms;"><path d="M15.8 13.9995C15.3 14.4995 14.4 14.7995 13.8 14.7995H12.2C11.5 14.7995 11 15.2995 11 15.9995V17.5995C11 18.2995 11.5 18.7995 12.2 18.7995H13.8C14.5 18.7995 15.4 19.1995 15.8 19.5995L18.2 21.3999C18.5296 21.6472 19 21.412 19 20.9999V12.154C19 11.7163 18.4774 11.4899 18.1581 11.7892L15.8 13.9995Z" fill="currentcolor"></path><g stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.5C22 11.5 23.1 14 23.1 16.5C23.1 19 22 21.5 22 21.5" style="opacity: 1; transition: opacity 100ms;"></path><path d="M26 9C26 9 27.7 12.8 27.7 16.5C27.7 20.2 26 24 26 24" style="opacity: 1; transition: opacity 100ms;"></path><g style="opacity: 0; transition: opacity 100ms;"><path d="M22 14L27 19"></path><path d="M27 14L22 19"></path></g></g></g></svg></div></button></div></div><div data-handle="settingsButton" class="w-css-reset" style="display: inline-block; vertical-align: top;"><div class="w-vulcan-button-wrapper w-css-reset" style="display: inline-block; height: 44px; position: relative; vertical-align: top; width: 52px;"><button tabindex="0" aria-expanded="false" class="w-vulcan-v2-button w-css-reset w-css-reset-tree w-css-reset-button-important" aria-label="Show settings menu" title="Show settings menu" style="background-color: transparent; border-radius: 0px; box-shadow: none; cursor: pointer; height: 100%; position: relative; transition: background-color 150ms; width: 100%; color: var(--wistia-player-icon-color) !important;"><div data-handle="settingsButton_icon_wrapper" class="w-vulcan-icon-wrapper" style="box-sizing: border-box; height: 100%; position: relative; opacity: 1; transform: scale(1.001); transition: transform 200ms;"><svg x="0px" y="0px" viewBox="0 0 40 34" enable-background="new 0 0 40 34" aria-hidden="true" style="fill: none; height: 100%; left: 0px; stroke-width: 0px; top: 0px; width: 100%;"><path fill-rule="evenodd" clip-rule="evenodd" d="M26.4 15.4H28.3C28.7 15.4 29 15.7 29 16.1V16.7C29 17.1 28.7 17.4 28.3 17.4H26.4C26 17.4 25.6 17.7 25.5 18.1L25.1 19.2C25 19.5 25 20 25.3 20.3L26.6 21.6C26.9 21.9 26.9 22.3 26.6 22.6L26.2 23C25.9 23.3 25.5 23.3 25.2 23L23.9 21.7C23.6 21.5 23.1 21.4 22.8 21.6L21.7 22.1C21.3 22.2 21 22.6 21 23V24.7C21 25.1 20.7 25.4 20.3 25.4H19.7C19.3 25.4 19 25.1 19 24.7V23C19 22.6 18.7 22.2 18.3 22.1L17.1 21.6C16.8 21.5 16.3 21.5 16 21.8L14.8 23C14.5 23.3 14.1 23.3 13.8 23L13.4 22.6C13.1 22.3 13.1 21.9 13.4 21.6L14.6 20.4C14.8 20.1 14.9 19.6 14.7 19.3L14.2 18.1C14.1 17.7 13.7 17.4 13.3 17.4H11.7C11.3 17.4 11 17.1 11 16.7V16.1C11 15.7 11.3 15.4 11.7 15.4H13.3C13.7 15.4 14.1 15.1 14.2 14.7L14.7 13.5C14.9 13.2 14.9 12.7 14.6 12.4L13.4 11.2C13.1 10.9 13.1 10.5 13.4 10.2L13.8 9.8C14.1 9.5 14.5 9.5 14.8 9.8L16 11C16.3 11.3 16.8 11.4 17.1 11.2L18.3 10.7C18.7 10.6 19 10.2 19 9.8V8.1C19 7.7 19.3 7.4 19.7 7.4H20.3C20.7 7.4 21 7.7 21 8.1V9.8C21 10.2 21.3 10.6 21.7 10.7L22.8 11.2C23.1 11.4 23.6 11.4 23.9 11.1L25.2 9.8C25.5 9.5 25.9 9.5 26.2 9.8L26.6 10.2C26.9 10.5 26.9 10.9 26.6 11.2L25.3 12.5C25 12.8 24.9 13.3 25.1 13.6L25.5 14.7C25.6 15.1 26 15.4 26.4 15.4ZM19.9 20.4C22 20.4 23.8 18.7 23.8 16.5C23.8 14.3 22.1 12.6 19.9 12.6C17.7 12.6 16 14.4 16 16.5C16 18.6 17.7 20.4 19.9 20.4Z" fill="currentcolor"></path></svg></div></button></div></div><div data-handle="fullscreenControl" class="w-css-reset" style="display: inline-block; vertical-align: top;"><div class="w-vulcan-button-wrapper w-css-reset" style="display: inline-block; height: 44px; position: relative; vertical-align: top; width: 52px;"><button tabindex="0" class="w-vulcan-v2-button w-css-reset w-css-reset-tree w-css-reset-button-important" aria-label="Fullscreen" title="Fullscreen" style="background-color: transparent; border-radius: 0px; box-shadow: none; cursor: pointer; height: 100%; position: relative; transition: background-color 150ms; width: 100%; color: var(--wistia-player-icon-color) !important;"><div data-handle="fullscreenControl_icon_wrapper" class="w-vulcan-icon-wrapper" style="box-sizing: border-box; height: 100%; position: relative; opacity: 1; transform: scale(1.001); transition: transform 200ms;"><svg x="0px" y="0px" viewBox="0 0 40 34" enable-background="new 0 0 40 34" aria-hidden="true" style="fill: none; height: 100%; left: 0px; stroke-width: 0px; top: 0px; width: 100%;"><rect x="14" y="13" width="12" height="8" rx="1.5" stroke="currentcolor" stroke-width="2"></rect><g stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13V11C10 9.89543 10.8954 9 12 9H14"></path><path d="M30 13V11C30 9.89543 29.1046 9 28 9H26"></path><path d="M30 21L30 23C30 24.1046 29.1046 25 28 25L26 25"></path><path d="M10 21L10 23C10 24.1046 10.8954 25 12 25L14 25"></path></g></svg></div></button></div></div></div></div><div class="w-wistia-logo w-css-reset" style="height: 44px; position: relative; pointer-events: auto; white-space: nowrap; display: none; right: 0px; top: 0px;"></div><div class="w-ellipsis w-css-reset" style="height: 44px; position: relative; pointer-events: auto; white-space: nowrap; display: none;"></div></div></div></div><div class="w-foreground w-css-reset" style="height: 100%; left: 0px; pointer-events: none; position: absolute; top: 0px; width: 100%; z-index: 1;"><div data-handle="contextMenu" class="w-css-reset" style="pointer-events: auto;"></div><div data-handle="loadingHourglass" class="w-css-reset" style="pointer-events: auto;"></div><div data-handle="focusOutline" class="w-css-reset" style="pointer-events: auto;"><div class="w-focus-outline" style="box-shadow: rgb(255, 255, 255) 0px 0px 0px 2px inset; border-radius: 0px; display: none; height: 100%; left: 0px; pointer-events: none; position: absolute; right: 0px; width: 100%;"></div></div></div></div></div></div><div id="wistia_grid_88_front"></div><div id="wistia_grid_88_top_inside"><div id="wistia_grid_88_top"></div></div><div id="wistia_grid_88_bottom_inside"><div id="wistia_grid_88_bottom"></div></div><div id="wistia_grid_88_left_inside"><div id="wistia_grid_88_left"></div></div><div id="wistia_grid_88_right_inside"><div id="wistia_grid_88_right"></div></div></div><div id="wistia_grid_88_below"></div></div></div></wistia-player>

<p style="text-align:center;"><span class="wp-element-caption"><em><strong>Video 3: </strong></em> <em>Process Injection Overhaul</em></span></p>



<h2 class="wp-block-heading">UAC Bypass Refresh</h2>



<p>In addition to the process injection updates,&nbsp;we wanted to refresh Cobalt Strike’s&nbsp;out-the-box&nbsp;UAC bypass&nbsp;options.&nbsp;Cobalt Strike&nbsp;4.12 adds two new working UAC bypasses&nbsp;(compatible with Win10 – Win11 24H2).&nbsp;The two techniques added are:&nbsp;</p>



<ul class="wp-block-list">
<li><code>uac-rpc-dom</code> – This is based on&nbsp;<a href="https://x.com/tiraniddo" target="_blank" rel="noreferrer noopener">James Forshaw’s</a>&nbsp;<a href="https://googleprojectzero.blogspot.com/2019/12/calling-local-windows-rpc-servers-from.html" target="_blank" rel="noreferrer noopener">AppInfo ALPC&nbsp;UAC bypass</a>&nbsp;(#59 in&nbsp;<a href="https://github.com/hfiref0x/UACME" target="_blank" rel="noreferrer noopener">UACME</a>).&nbsp;&nbsp;This&nbsp;is supported by&nbsp;both the <code>elevate</code> and <code>runasadmin</code> commands.</li>



<li><code>uac-cmlua</code> – This is based on&nbsp;<a href="https://x.com/Oddvarmoe" target="_blank" rel="noreferrer noopener">Oddvar Moe’s</a>&nbsp;UAC bypass using the&nbsp;<code>ICMLuaUtil</code>&nbsp;elevated COM interface&nbsp;(#41 in&nbsp;<a href="https://github.com/hfiref0x/UACME" target="_blank" rel="noreferrer noopener">UACME</a>).&nbsp;This&nbsp;is supported by the&nbsp;<code>runasadmin</code> command only.&nbsp;</li>
</ul>



<p>The video below shows them in action:</p>



 <wistia-player media-id="l2axnihk5t" aspect="1.7777777777777777" unique-id="wistia-l2axnihk5t-19"><div><div class="wistia_swatch" style="height: 1071px; left: 0px; position: absolute; top: 0px; width: 100%;"><div style="height: 100%; position: relative; width: 100%;"><div style="height: 100%; left: 0px; overflow: hidden; position: absolute; top: 0px; width: 100%; border-radius: 0px;"><img src="https://fast.wistia.com/embed/medias/l2axnihk5t/swatch" alt="" aria-hidden="true" style="filter: blur(5px); height: 100%; object-fit: contain; width: 100%;"></div></div></div><div><div style="--wistia-player-icon-color: #ffffff;"><div tabindex="-1" class="w-css-reset" style="cursor: pointer; width: 100%; height: 1080px;"><div><div class="w-css-reset" style="height: 100%; left: 0px; opacity: 1; position: absolute; top: 0px; width: 100%; display: block;"><img src="https://embed-ssl.wistia.com/deliveries/a2442954dd231213583699564f6a58174760c596.webp?image_crop_resized=1920x1080" alt="" class="w-css-reset" style="background-color: rgb(0, 0, 0); height: 100%; object-fit: contain; position: absolute; width: 100%; top: 0px; left: 0px; clip: auto; display: block; border-radius: 0px;"></div></div></div><div class="w-bpb-wrapper w-css-reset w-css-reset-tree" style="border-radius: 0px; display: block; left: calc(50%); margin-left: -81.25px; margin-top: -52px; overflow: hidden; position: absolute; top: calc(50% - 22.1px);"><button aria-label="Play Video: 412_UACBypasses" tabindex="0" type="button" class="w-big-play-button w-css-reset-button-important w-vulcan-v2-button" style="background-color: transparent; border: 0px; color: rgb(255, 255, 255); cursor: pointer; height: 104px; box-shadow: none; width: 162.5px;"><div style="background: rgb(0, 106, 86); display: block; left: 0px; height: 104px; mix-blend-mode: darken; position: absolute; top: 0px; width: 162.5px;"></div><div style="background-color: rgba(0, 106, 86, 0.7); height: 104px; left: 0px; position: absolute; top: 0px; transition: background-color 150ms; width: 162.5px;"></div><svg x="0px" y="0px" viewBox="0 0 125 80" enable-background="new 0 0 125 80" aria-hidden="true" style="fill: rgb(255, 255, 255); height: 104px; left: 0px; stroke-width: 0px; top: 0px; width: 100%; position: absolute; color: rgb(255, 255, 255);"><path fill-rule="evenodd" clip-rule="evenodd" fill="currentcolor" opacity="1" transform="translate(44, 22)" d="M12.138 2.173C10.812 1.254 9 2.203 9 3.817v28.366c0 1.613 1.812 2.563 3.138 1.644l20.487-14.183a2 2 0 0 0 0-3.288L12.138 2.173Z"></path></svg></button></div></div></div></div><div id="wistia_chrome_158" class="w-chrome notranslate" tabindex="-1" style="display: inline-block; height: 100%; line-height: normal; margin: 0px; padding: 0px; position: relative; vertical-align: top; width: 100%; outline: none; overflow: hidden; box-sizing: content-box; border-radius: 0px; clip-path: inset(0.5px);"><div id="wistia_grid_164_wrapper" style="display: block;"><div id="wistia_grid_164_above"></div><div id="wistia_grid_164_main"><div id="wistia_grid_164_behind"></div><div id="wistia_grid_164_center"><div class="w-video-wrapper w-css-reset" style="width: 100%; height: 100%; display: flex; align-items: center; opacity: 1; background-color: rgb(0, 0, 0);"><video id="wistia_simple_video_322" crossorigin="anonymous" aria-label="412_UACBypasses" src="blob:https://www.cobaltstrike.com/50bdfee0-14f2-4c60-bf62-ddf62abfc1c4" controlslist="nodownload" playsinline="" preload="none" type="video/m3u8" x-webkit-airplay="allow" style="background: transparent; display: block; height: 100%; max-height: none; max-width: none; position: static; visibility: visible; width: 100%; aspect-ratio: 1.77778 / 1; object-fit: contain;"><source type="application/x-mpegURL" src="https://fast.wistia.com/embed/medias/l2axnihk5t.m3u8"></video></div><div class="w-ui-container" style="height: 100%; left: 0px; position: absolute; top: 0px; width: 100%; opacity: 1;"><div id="w-vulcan-v2-163" class="w-vulcan-v2 w-css-reset" style="border-radius: 0px; box-sizing: border-box; cursor: default; direction: ltr; height: 100%; left: 0px; position: absolute; visibility: visible; top: 0px; width: 100%; --wistia-player-icon-color: #ffffff; --wistia-player-color-hover: #001100; --wistia-player-icon-color-hover: #fff;"><div class="w-vulcan--background w-css-reset" style="height: 100%; left: 0px; position: absolute; top: 0px; width: 100%;"><div data-handle="statusBar" class="w-css-reset"></div><div data-handle="backgroundFocus" class="w-css-reset"><button aria-label="Play Video: 412_UACBypasses" tabindex="0" class="w-css-reset w-vulcan-v2-button" style="clip: rect(1px, 1px, 1px, 1px); height: 1px; overflow: hidden; position: absolute; white-space: nowrap; width: 1px; pointer-events: none;"></button></div><div data-handle="thumbnail" class="w-css-reset"><div><div class="w-css-reset" style="height: 100%; left: 0px; opacity: 1; position: absolute; top: 0px; width: 100%; display: block;"><img src="https://embed-ssl.wistia.com/deliveries/a2442954dd231213583699564f6a58174760c596.webp?image_crop_resized=1920x1080" alt="Video Thumbnail" class="w-css-reset" style="background-color: rgb(0, 0, 0); height: 100%; object-fit: contain; position: absolute; width: 100%; top: 0px; left: 0px; clip: auto; display: block; border-radius: 0px;"></div></div></div></div><div aria-live="polite" aria-atomic="true" class="w-vulcan--aria-live w-css-reset" style="position: absolute; left: -99999em;"></div><div class="w-vulcan-overlays-table w-css-reset" style="display: table; pointer-events: none; position: absolute; width: 100%; height: calc(100% - 44px);"><div class="w-vulcan-overlays--left w-css-reset" style="display: table-cell; height: auto; vertical-align: top; position: relative; width: 0px;"><div class="w-css-reset" style="height: 100%;"></div></div><div class="w-vulcan-overlays--center w-css-reset" style="display: table-cell; height: 100%; vertical-align: top; position: relative; width: 100%;"><div class="w-css-reset" style="height: 100%;"><div data-handle="bigPlayButton" class="w-css-reset" style="pointer-events: auto;"><div class="w-bpb-wrapper w-css-reset w-css-reset-tree" style="border-radius: 0px; display: block; left: calc(50%); margin-left: -81.25px; margin-top: -52px; overflow: hidden; position: absolute; top: calc(50% + 0px);"><button aria-label="Play Video: 412_UACBypasses" tabindex="0" type="button" class="w-big-play-button w-css-reset-button-important w-vulcan-v2-button" style="background-color: transparent; border: 0px; color: rgb(255, 255, 255); cursor: pointer; height: 104px; box-shadow: none; width: 162.5px;"><div style="background: rgb(0, 106, 86); display: block; left: 0px; height: 104px; mix-blend-mode: darken; position: absolute; top: 0px; width: 162.5px;"></div><div style="background-color: rgba(0, 106, 86, 0.7); height: 104px; left: 0px; position: absolute; top: 0px; transition: background-color 150ms; width: 162.5px;"></div><svg x="0px" y="0px" viewBox="0 0 125 80" enable-background="new 0 0 125 80" aria-hidden="true" style="fill: rgb(255, 255, 255); height: 104px; left: 0px; stroke-width: 0px; top: 0px; width: 100%; position: absolute; color: rgb(255, 255, 255);"><path fill-rule="evenodd" clip-rule="evenodd" fill="currentcolor" opacity="1" transform="translate(44, 22)" d="M12.138 2.173C10.812 1.254 9 2.203 9 3.817v28.366c0 1.613 1.812 2.563 3.138 1.644l20.487-14.183a2 2 0 0 0 0-3.288L12.138 2.173Z"></path></svg></button></div></div><div data-handle="clickForSoundButton" class="w-css-reset" style="pointer-events: auto;"><div data-handle="click-for-sound-backdrop" class="w-css-reset w-css-reset-tree" style="display: none; height: 100%; left: 0px; pointer-events: auto; position: absolute; top: 0px; width: 100%;"><button aria-label="Click for sound" class="w-vulcan-v2-button click-for-sound-btn" style="background: rgba(0, 0, 0, 0.8); border: 2px solid transparent; border-radius: 60px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; outline: none; pointer-events: auto; position: absolute; right: 27.25px; top: 27.25px; max-width: 1849.5px;"><div style="display: flex; align-items: center; justify-content: flex-end; white-space: nowrap; overflow: hidden; max-width: 0px; transition: max-width 200ms;"><span style="color: rgb(255, 255, 255); font-family: WistiaPlayerInter, Helvetica, sans-serif; font-size: 18px; font-weight: 500; padding-left: 1em; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 1904px;">Click for sound</span></div><svg viewBox="0 0 237 237" width="68.25" height="68.25"><path fill="#fff" d="M88 107H65v24h24l23 23V84z"></path><g fill="none" stroke="#fff" stroke-linecap="round" stroke-width="10"><path d="M142 86c9 21 9 44 0 65" class="volume__small-wave"></path><path d="M165 74c13 23 13 66 0 89" class="volume__large-wave"></path></g></svg></button></div></div><div data-handle="playPauseNotifier" class="w-css-reset" style="pointer-events: auto;"><div class="w-play-pause-notifier" style="background: rgba(0, 0, 0, 0.6); border-radius: 50%; height: 182px; left: 50%; pointer-events: none; position: absolute; opacity: 0; top: 50%; transform: translate(-50%, -50%) scale(0.8); transition: opacity 0.8s, transform 0.8s; width: 182px;"><div style="width: 100%; height: 100%; margin-left: 0px;"><svg x="0px" y="0px" viewBox="0 0 40 34" enable-background="new 0 0 40 34" aria-hidden="true" style="fill: none; height: 100%; left: 0px; stroke-width: 0px; top: 0px; width: 100%; color: rgb(255, 255, 255);"><path fill-rule="evenodd" clip-rule="evenodd" d="M16.5 11C15.6716 11 15 11.6716 15 12.5V22.5C15 23.3284 15.6716 24 16.5 24H17.5C18.3284 24 19 23.3284 19 22.5V12.5C19 11.6716 18.3284 11 17.5 11H16.5ZM23.5 11C22.6716 11 22 11.6716 22 12.5V22.5C22 23.3284 22.6716 24 23.5 24H24.5C25.3284 24 26 23.3284 26 22.5V12.5C26 11.6716 25.3284 11 24.5 11H23.5Z" fill="currentcolor"></path></svg></div></div></div><div data-handle="playPauseLoading" class="w-css-reset" style="pointer-events: auto;"><div class="w-css-reset w-css-reset-tree" style="height: 100%; left: 0px; pointer-events: none; position: absolute; top: 0px; width: 100%;"><button aria-label="Play Video" class="w-vulcan-v2-button" style="background: rgba(0, 0, 0, 0.6); border: 0px; border-radius: 50%; cursor: pointer; display: none; height: 182px; left: 50%; margin: 0px; padding: 0px; pointer-events: auto; position: absolute; opacity: 0; outline: none; top: 50%; transform: translate(-50%, -50%) scale(0.8); transition: opacity 200ms, transform 600ms; -webkit-tap-highlight-color: rgba(0, 0, 0, 0); width: 182px;"><div style="width: 100%; height: 100%; margin-left: 0px;"><svg x="0px" y="0px" viewBox="0 0 40 34" enable-background="new 0 0 40 34" aria-hidden="true" style="fill: none; height: 100%; left: 0px; stroke-width: 0px; top: 0px; width: 100%; color: rgb(255, 255, 255);"><path d="M24.888 16.1913C25.4371 16.5906 25.4371 17.4094 24.888 17.8087L16.5882 23.845C15.9272 24.3257 15 23.8535 15 23.0362V10.9638C15 10.1465 15.9272 9.67433 16.5882 10.155L24.888 16.1913Z" fill="currentcolor"></path></svg></div></button></div></div></div></div><div class="w-vulcan-overlays--right w-css-reset" style="display: table-cell; height: auto; vertical-align: top; position: relative; width: 0px;"><div class="w-css-reset" style="height: 100%;"></div></div></div><div class="w-bottom-bar w-css-reset" style="bottom: 0px; border-radius: 0px; border-collapse: collapse; display: table; height: 44px; pointer-events: none; position: absolute; padding-left: 0px; padding-right: 0px; right: 50%; table-layout: auto; transform: translate(50%); width: calc(100% + 0px); z-index: 1; animation: 250ms ease-in-out 0s 1 normal forwards running w-control-bar-fade-in;"><div class="w-bottom-bar-lower w-css-reset" style="position: relative;"><div style="height: 100%; left: 0px; position: absolute; top: 0px; width: 100%;"><div style="background: rgb(0, 106, 86); display: none; height: 100%; mix-blend-mode: darken; left: 0px; opacity: 1; position: absolute; top: 0px; transition: opacity; width: 100%;"></div><div style="background: rgba(0, 106, 86, 0.85); border-radius: 0px; height: 100%; opacity: 1; left: 0px; position: absolute; top: 0px; transition: opacity; width: 100%;"></div></div><div style="display: none;"><div style="background: rgb(0, 106, 86); display: none; height: 100%; mix-blend-mode: darken; left: 0px; opacity: 1; position: absolute; top: 0px; transition: opacity; width: 100%;"></div><div style="background: 100% rgba(0, 106, 86, 0.85); border-radius: 0px; height: 100%; opacity: 1; left: 0px; position: absolute; top: 0px; transition: opacity; width: 100%;"></div></div><div class="w-bottom-bar-left w-css-reset" style="display: table-cell; height: auto; vertical-align: top; position: relative; width: 0px; opacity: 1; transition: opacity;"><div class="w-bottom-bar-left-inner w-css-reset" style="height: 44px; position: relative; pointer-events: auto; white-space: nowrap;"><div data-handle="smallPlayButton" class="w-css-reset" style="display: inline-block; vertical-align: top;"><div class="w-vulcan-button-wrapper w-css-reset" style="display: inline-block; height: 44px; position: relative; vertical-align: top; width: 52px;"><button tabindex="0" class="w-vulcan-v2-button w-css-reset w-css-reset-tree w-css-reset-button-important" aria-label="Play Video" title="Play Video" style="background-color: transparent; border-radius: 0px; box-shadow: none; cursor: pointer; height: 100%; position: relative; transition: background-color 150ms; width: 100%; color: var(--wistia-player-icon-color) !important;"><div data-handle="smallPlayButton_icon_wrapper" class="w-vulcan-icon-wrapper" style="box-sizing: border-box; height: 100%; position: relative; opacity: 1; transform: scale(1.001); transition: transform 200ms;"><div style="width: 100%; height: 100%; margin-left: 1.95px;"><svg x="0px" y="0px" viewBox="0 0 40 34" enable-background="new 0 0 40 34" aria-hidden="true" style="fill: none; height: 100%; left: 0px; stroke-width: 0px; top: 0px; width: 100%; vertical-align: top;"><path d="M24.888 16.1913C25.4371 16.5906 25.4371 17.4094 24.888 17.8087L16.5882 23.845C15.9272 24.3257 15 23.8535 15 23.0362V10.9638C15 10.1465 15.9272 9.67433 16.5882 10.155L24.888 16.1913Z" fill="currentcolor"></path></svg></div></div></button></div></div></div></div><div class="w-bottom-bar-middle w-css-reset" style="display: table-cell; height: auto; vertical-align: top; position: relative; width: 100%; opacity: 1; transition: opacity;"><div class="w-bottom-bar-middle-inner w-css-reset" style="height: 44px; position: relative; pointer-events: auto; white-space: nowrap; opacity: 1; transform: translateY(0px); transition: opacity, transform;"><div data-handle="playbar" class="w-css-reset" style="height: 100%; position: relative;"><div class="w-playbar-wrapper w-css-reset w-css-reset-tree" style="display: flex; height: 100%; width: 100%;"><div class="w-playbar__time" style="box-sizing: content-box; color: rgb(255, 255, 255); font-family: WistiaPlayerInterNumbersSemiBold, Helvetica, sans-serif; font-size: 16.9px; letter-spacing: 0.65px; line-height: 44px; padding-left: 6.5px; pointer-events: none; position: relative; text-align: center; width: 36.4px;">2:46</div><div style="width: 100%; position: relative;"><div aria-label="Playbar" aria-orientation="horizontal" aria-valuemax="165.744" aria-valuemin="0" aria-valuenow="0" aria-valuetext="0 seconds" role="slider" tabindex="0" style="cursor: pointer; flex: 1 1 0%; height: 44px; outline: none; margin-left: 19.5px; margin-right: 13px; position: relative;"><canvas height="44" width="1669.1" style="height: 44px; left: -19.5px; position: absolute; top: 0px; width: 1669.1px;"></canvas><div style="border-radius: 50%; height: 14.56px; left: -7.28px; opacity: 0; position: absolute; top: 14.72px; width: 14.56px;"></div></div></div></div></div></div></div><div class="w-bottom-bar-right w-css-reset" style="display: table-cell; height: auto; vertical-align: top; position: relative; width: 0px; opacity: 1; transition: opacity; white-space: nowrap;"><div class="w-bottom-bar-right-inner-anchor w-css-reset" style="height: 44px; position: relative; pointer-events: auto; white-space: nowrap; display: inline-block; right: 0px; top: 0px; vertical-align: top;"><div class="w-bottom-bar-right-inner w-css-reset" style="height: 44px; position: relative; pointer-events: auto; white-space: nowrap; display: inline-block; opacity: 1; right: 0px; top: 0px; transform: translateY(0px); transition: opacity, transform;"><div data-handle="volumeButton" class="w-css-reset" style="display: inline-block; vertical-align: top;"><div class="w-vulcan-button-wrapper w-css-reset" style="display: inline-block; height: 44px; position: relative; vertical-align: top; width: 52px;"><button tabindex="0" aria-pressed="false" class="w-vulcan-v2-button w-css-reset w-css-reset-tree w-css-reset-button-important" aria-label="Mute" title="Mute" style="background-color: transparent; border-radius: 0px; box-shadow: none; cursor: pointer; height: 100%; position: relative; transition: background-color 150ms; width: 100%; color: var(--wistia-player-icon-color) !important;"><div data-handle="volumeButton_icon_wrapper" class="w-vulcan-icon-wrapper" style="box-sizing: border-box; height: 100%; position: relative; opacity: 1; transform: scale(1.001); transition: transform 200ms;"><svg x="0px" y="0px" viewBox="0 0 40 34" enable-background="new 0 0 40 34" aria-hidden="true" style="fill: none; height: 100%; left: 0px; stroke-width: 0px; top: 0px; width: 100%;"><g style="transform: translateX(1.25px); transition: transform 100ms;"><path d="M15.8 13.9995C15.3 14.4995 14.4 14.7995 13.8 14.7995H12.2C11.5 14.7995 11 15.2995 11 15.9995V17.5995C11 18.2995 11.5 18.7995 12.2 18.7995H13.8C14.5 18.7995 15.4 19.1995 15.8 19.5995L18.2 21.3999C18.5296 21.6472 19 21.412 19 20.9999V12.154C19 11.7163 18.4774 11.4899 18.1581 11.7892L15.8 13.9995Z" fill="currentcolor"></path><g stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.5C22 11.5 23.1 14 23.1 16.5C23.1 19 22 21.5 22 21.5" style="opacity: 1; transition: opacity 100ms;"></path><path d="M26 9C26 9 27.7 12.8 27.7 16.5C27.7 20.2 26 24 26 24" style="opacity: 1; transition: opacity 100ms;"></path><g style="opacity: 0; transition: opacity 100ms;"><path d="M22 14L27 19"></path><path d="M27 14L22 19"></path></g></g></g></svg></div></button></div></div><div data-handle="settingsButton" class="w-css-reset" style="display: inline-block; vertical-align: top;"><div class="w-vulcan-button-wrapper w-css-reset" style="display: inline-block; height: 44px; position: relative; vertical-align: top; width: 52px;"><button tabindex="0" aria-expanded="false" class="w-vulcan-v2-button w-css-reset w-css-reset-tree w-css-reset-button-important" aria-label="Show settings menu" title="Show settings menu" style="background-color: transparent; border-radius: 0px; box-shadow: none; cursor: pointer; height: 100%; position: relative; transition: background-color 150ms; width: 100%; color: var(--wistia-player-icon-color) !important;"><div data-handle="settingsButton_icon_wrapper" class="w-vulcan-icon-wrapper" style="box-sizing: border-box; height: 100%; position: relative; opacity: 1; transform: scale(1.001); transition: transform 200ms;"><svg x="0px" y="0px" viewBox="0 0 40 34" enable-background="new 0 0 40 34" aria-hidden="true" style="fill: none; height: 100%; left: 0px; stroke-width: 0px; top: 0px; width: 100%;"><path fill-rule="evenodd" clip-rule="evenodd" d="M26.4 15.4H28.3C28.7 15.4 29 15.7 29 16.1V16.7C29 17.1 28.7 17.4 28.3 17.4H26.4C26 17.4 25.6 17.7 25.5 18.1L25.1 19.2C25 19.5 25 20 25.3 20.3L26.6 21.6C26.9 21.9 26.9 22.3 26.6 22.6L26.2 23C25.9 23.3 25.5 23.3 25.2 23L23.9 21.7C23.6 21.5 23.1 21.4 22.8 21.6L21.7 22.1C21.3 22.2 21 22.6 21 23V24.7C21 25.1 20.7 25.4 20.3 25.4H19.7C19.3 25.4 19 25.1 19 24.7V23C19 22.6 18.7 22.2 18.3 22.1L17.1 21.6C16.8 21.5 16.3 21.5 16 21.8L14.8 23C14.5 23.3 14.1 23.3 13.8 23L13.4 22.6C13.1 22.3 13.1 21.9 13.4 21.6L14.6 20.4C14.8 20.1 14.9 19.6 14.7 19.3L14.2 18.1C14.1 17.7 13.7 17.4 13.3 17.4H11.7C11.3 17.4 11 17.1 11 16.7V16.1C11 15.7 11.3 15.4 11.7 15.4H13.3C13.7 15.4 14.1 15.1 14.2 14.7L14.7 13.5C14.9 13.2 14.9 12.7 14.6 12.4L13.4 11.2C13.1 10.9 13.1 10.5 13.4 10.2L13.8 9.8C14.1 9.5 14.5 9.5 14.8 9.8L16 11C16.3 11.3 16.8 11.4 17.1 11.2L18.3 10.7C18.7 10.6 19 10.2 19 9.8V8.1C19 7.7 19.3 7.4 19.7 7.4H20.3C20.7 7.4 21 7.7 21 8.1V9.8C21 10.2 21.3 10.6 21.7 10.7L22.8 11.2C23.1 11.4 23.6 11.4 23.9 11.1L25.2 9.8C25.5 9.5 25.9 9.5 26.2 9.8L26.6 10.2C26.9 10.5 26.9 10.9 26.6 11.2L25.3 12.5C25 12.8 24.9 13.3 25.1 13.6L25.5 14.7C25.6 15.1 26 15.4 26.4 15.4ZM19.9 20.4C22 20.4 23.8 18.7 23.8 16.5C23.8 14.3 22.1 12.6 19.9 12.6C17.7 12.6 16 14.4 16 16.5C16 18.6 17.7 20.4 19.9 20.4Z" fill="currentcolor"></path></svg></div></button></div></div><div data-handle="fullscreenControl" class="w-css-reset" style="display: inline-block; vertical-align: top;"><div class="w-vulcan-button-wrapper w-css-reset" style="display: inline-block; height: 44px; position: relative; vertical-align: top; width: 52px;"><button tabindex="0" class="w-vulcan-v2-button w-css-reset w-css-reset-tree w-css-reset-button-important" aria-label="Fullscreen" title="Fullscreen" style="background-color: transparent; border-radius: 0px; box-shadow: none; cursor: pointer; height: 100%; position: relative; transition: background-color 150ms; width: 100%; color: var(--wistia-player-icon-color) !important;"><div data-handle="fullscreenControl_icon_wrapper" class="w-vulcan-icon-wrapper" style="box-sizing: border-box; height: 100%; position: relative; opacity: 1; transform: scale(1.001); transition: transform 200ms;"><svg x="0px" y="0px" viewBox="0 0 40 34" enable-background="new 0 0 40 34" aria-hidden="true" style="fill: none; height: 100%; left: 0px; stroke-width: 0px; top: 0px; width: 100%;"><rect x="14" y="13" width="12" height="8" rx="1.5" stroke="currentcolor" stroke-width="2"></rect><g stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13V11C10 9.89543 10.8954 9 12 9H14"></path><path d="M30 13V11C30 9.89543 29.1046 9 28 9H26"></path><path d="M30 21L30 23C30 24.1046 29.1046 25 28 25L26 25"></path><path d="M10 21L10 23C10 24.1046 10.8954 25 12 25L14 25"></path></g></svg></div></button></div></div></div></div><div class="w-wistia-logo w-css-reset" style="height: 44px; position: relative; pointer-events: auto; white-space: nowrap; display: none; right: 0px; top: 0px;"></div><div class="w-ellipsis w-css-reset" style="height: 44px; position: relative; pointer-events: auto; white-space: nowrap; display: none;"></div></div></div></div><div class="w-foreground w-css-reset" style="height: 100%; left: 0px; pointer-events: none; position: absolute; top: 0px; width: 100%; z-index: 1;"><div data-handle="contextMenu" class="w-css-reset" style="pointer-events: auto;"></div><div data-handle="loadingHourglass" class="w-css-reset" style="pointer-events: auto;"></div><div data-handle="focusOutline" class="w-css-reset" style="pointer-events: auto;"><div class="w-focus-outline" style="box-shadow: rgb(255, 255, 255) 0px 0px 0px 2px inset; border-radius: 0px; display: none; height: 100%; left: 0px; pointer-events: none; position: absolute; right: 0px; width: 100%;"></div></div></div></div></div></div><div id="wistia_grid_164_front"></div><div id="wistia_grid_164_top_inside"><div id="wistia_grid_164_top"></div></div><div id="wistia_grid_164_bottom_inside"><div id="wistia_grid_164_bottom"></div></div><div id="wistia_grid_164_left_inside"><div id="wistia_grid_164_left"></div></div><div id="wistia_grid_164_right_inside"><div id="wistia_grid_164_right"></div></div></div><div id="wistia_grid_164_below"></div></div></div></wistia-player>

<p style="text-align:center;"><span class="wp-element-caption"><em><strong>Video 4: </strong></em> <em>New UAC Bypass Options</em></span></p>



<h2 class="wp-block-heading">BeaconDownload</h2>



<p>Beacon’s&nbsp;<a href="https://hstechdocs.helpsystems.com/manuals/cobaltstrike/current/userguide/content/topics/post-exploitation_upload-download-files.htm" target="_blank" rel="noreferrer noopener"><code>download</code></a>&nbsp;command&nbsp;only supports&nbsp;retrieving files&nbsp;from&nbsp;disk.&nbsp;This can be an issue when trying to dump&nbsp;and exfiltrate&nbsp;credentials&nbsp;(or process memory)&nbsp;as writing to disk first is an unnecessary IOC&nbsp;and can result in an increased risk of detection.&nbsp;This has led to many Cobalt Strike users using&nbsp;<a href="https://github.com/fortra/nanodump/blob/450d5b23aeba5e0f8f6e5fc826a08997b2237be9/source/utils.c#L639" target="_blank" rel="noreferrer noopener">undocumented functionality</a>&nbsp;to get round this limitation.</p>



<p>To solve this problem, we&nbsp;have added a new&nbsp;<a href="https://hstechdocs.helpsystems.com/manuals/cobaltstrike/current/userguide/content/topics/beacon-object-files_bof-c-api.htm" target="_blank" rel="noreferrer noopener">BOF API</a>,&nbsp;<code>BeaconDownload</code>. This&nbsp;opens up&nbsp;Beacon’s native download functionality to&nbsp;support&nbsp;<strong>the&nbsp;downloading of in-memory buffers</strong>.&nbsp;This&nbsp;approach&nbsp;means&nbsp;that a BOF can ‘offload’ the&nbsp;download&nbsp;to Beacon&nbsp;and carry on executing&nbsp;as normal.&nbsp;In-memory downloads behave the same way as normal file downloads and can be cancelled via the Beacon console.</p>



<p><em><strong>Note:</strong>&nbsp;<code>BeaconDownload</code> currently&nbsp;supports a&nbsp;max&nbsp;download&nbsp;size of 2GB.&nbsp;</em></p>



<h2 class="wp-block-heading">Sleepmask Updates</h2>



<p>As part of the&nbsp;<a href="https://www.cobaltstrike.com/blog/cobalt-strike-411-shh-beacon-is-sleeping" target="_blank" rel="noreferrer noopener">Cobalt&nbsp;Strike 4.11 release</a>, we added a&nbsp;new&nbsp;default&nbsp;evasive&nbsp;Sleepmask&nbsp;for HTTP(S)/DNS Beacons&nbsp;and mentioned that we were overhauling the pivot Beacon Sleepmask&nbsp;(i.e.&nbsp;for&nbsp;SMB and TCP Beacons). This work has&nbsp;now&nbsp;been completed as part&nbsp;of the 4.12 release&nbsp;and&nbsp;<strong>pivot Beacons will now&nbsp;use the same&nbsp;default evasive Sleepmask</strong> <strong>released in 4.11</strong>.</p>



<p>Prior to&nbsp;this&nbsp;release, the Sleepmask for pivot Beacons was&nbsp;<a href="https://github.com/Cobalt-Strike/sleepmask-vs/blob/5370617af2dd40e711d1a5f5f998ae27cff87be6/sleepmask-vs/library/pivot.cpp#L18-L103" target="_blank" rel="noreferrer noopener">complex</a><a href="https://github.com/Cobalt-Strike/sleepmask-vs/blob/5370617af2dd40e711d1a5f5f998ae27cff87be6/sleepmask-vs/library/pivot.cpp" target="_blank" rel="noreferrer noopener">;</a>&nbsp;we needed to pass&nbsp;additional&nbsp;information to the&nbsp;Sleepmask such as the action being performed (accept a socket?&nbsp;connect to a pipe?) and any&nbsp;additional&nbsp;arguments&nbsp;needed&nbsp;for those calls. This led to bloated code&nbsp;and made&nbsp;customisation&nbsp;unnecessarily complicated.</p>



<p>In 4.12, we have converted all pivot channels (SMB/TCP) to use asynchronous&nbsp;communication. The&nbsp;consequence&nbsp;of this&nbsp;change&nbsp;is that&nbsp;a ‘sleep’ for pivot Beacons now&nbsp;simply&nbsp;consists&nbsp;of a call to <code>WaitForSingleObject</code>&nbsp;on an I/O event handle&nbsp;(i.e.&nbsp;analogous&nbsp;to&nbsp;<code>Sleep</code>&nbsp;for HTTP(S)/DNS&nbsp;Beacons).&nbsp;&nbsp;Once there is new data on the pipe/socket, the <code>WaitForSingleObject</code> call will return and Beacon will continue executing as normal.&nbsp;</p>



<p>This&nbsp;greatly simplifies&nbsp;Sleepmask development, however these changes&nbsp;have&nbsp;<strong>necessitated&nbsp;breaking the Sleepmask&nbsp;entrypoint</strong>. This is because the original purpose of <code>SLEEPMASK_INFO</code> was to pass information related to pivot beacons (along with Beacon’s masking info). This change means this structure (and the code acting on it) was no longer&nbsp;required. The entry point is now simply:</p>


<div class="wp-block-syntaxhighlighter-code "><div id="highlighter_127023" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="https://www.cobaltstrike.com/blog/cobalt-strike-412-fix-up-look-sharp#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_127023_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_127023" menu="false" src="https://www.cobaltstrike.com/app/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="https://www.cobaltstrike.com/blog/cobalt-strike-412-fix-up-look-sharp#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="https://www.cobaltstrike.com/blog/cobalt-strike-412-fix-up-look-sharp#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines no-wrap"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="keyword bold">void</code> <code class="plain">sleep_mask(PBEACON_INFO info, PFUNCTION_CALL functionCall) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">/* invoke beacon gate */</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">BeaconGateWrapper(info, functionCall);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div></div></div></div>


<p>Where&nbsp;<code>info</code>&nbsp;contains&nbsp;the information&nbsp;required&nbsp;to mask&nbsp;Beacon&nbsp;and the&nbsp;<code>functionCall</code>&nbsp;contains&nbsp;the target function to execute (i.e. <code>Sleep</code> for HTTP(S)/DNS Beacons / <code>WaitForSingleObject</code> for pivot Beacons).</p>



<p>Furthermore, there are multiple open source UDRLs that&nbsp;<a href="https://github.com/kyleavery/AceLdr/blob/main/src/hooks/delay.c#L468" target="_blank" rel="noreferrer noopener">utilise an IAT hook on&nbsp;<code>Sleep</code></a>&nbsp;to perform&nbsp;sleep obfuscation. This&nbsp;change now makes it possible to use the same technique to obfuscate pivot Beacons by placing an IAT hook on&nbsp;<code>WaitForSingleObject</code>&nbsp;as well.</p>



<p>We understand&nbsp;a breaking change can be&nbsp;frustrating in a minor release but on balance we thought&nbsp;the benefits from&nbsp;cleaning up the&nbsp;Sleepmask&nbsp;interface&nbsp;and&nbsp;greatly&nbsp;simplifying&nbsp;it&nbsp;outweighed waiting for a major release.</p>



<p><em><strong>Note:</strong>&nbsp;Both the&nbsp;Sleepmask&nbsp;Kit and&nbsp;<a href="https://github.com/Cobalt-Strike/sleepmask-vs" target="_blank" rel="noreferrer noopener">Sleepmask-vs</a>&nbsp;have been updated to support this breaking change. You will need to migrate any custom Sleepmasks to use this new entry point (and the drip loading change explained below) for them to be compatible with 4.12.</em></p>



<h2 class="wp-block-heading">Drip Loading</h2>



<p>One&nbsp;approach EDRs can take to detect process injection is&nbsp;through correlating different events&nbsp;for common injection primitives.&nbsp;For example,&nbsp;a very simple&nbsp;flow would involve&nbsp;allocating&nbsp;a&nbsp;<em>large</em>&nbsp;chunk of memory,&nbsp;copying over&nbsp;a payload, and creating a new thread at the start address.&nbsp;Correlating these events over a set period can&nbsp;produce high fidelity detection logic.</p>



<p>One way to subvert&nbsp;event-driven&nbsp;detection is to&nbsp;break up specific primitives and introduce delays between them.&nbsp;For example,&nbsp;<a href="https://github.com/xuanxuan0/DripLoader" target="_blank" rel="noreferrer noopener">drip loading</a>&nbsp;writes a payload in&nbsp;small&nbsp;individual chunks&nbsp;and&nbsp;sleeps briefly&nbsp;between writes. By doing so, it can help break event correlation.</p>



<p>In Cobalt Strike 4.12, we have added support for&nbsp;drip&nbsp;loading during both reflective loading&nbsp;<em>and</em>&nbsp;process injection.&nbsp;You&nbsp;can configure drip loading in the loader via the new&nbsp;Malleable C2&nbsp;<a href="https://hstechdocs.helpsystems.com/manuals/cobaltstrike/current/userguide/content/topics/malleable-c2-extend_pe-memory-indicators.htm" target="_blank" rel="noreferrer noopener">options</a> for the <code>stage</code> block as shown below:</p>


<div class="wp-block-syntaxhighlighter-code "><div id="highlighter_937945" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="https://www.cobaltstrike.com/blog/cobalt-strike-412-fix-up-look-sharp#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_937945_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_937945" menu="false" src="https://www.cobaltstrike.com/app/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="https://www.cobaltstrike.com/blog/cobalt-strike-412-fix-up-look-sharp#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="https://www.cobaltstrike.com/blog/cobalt-strike-412-fix-up-look-sharp#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines no-wrap"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">stage {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">set&nbsp;rdll_use_driploading&nbsp;“true”; </code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">set&nbsp;rdll_dripload_delay&nbsp;“100”;&nbsp;&nbsp; //adds a further delay </code><code class="keyword">if</code> <code class="plain">desired</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div></div></div></div>


<p>Similarly, drip loading can be configured for process injection via the new Malleable C2 <a href="https://hstechdocs.helpsystems.com/manuals/cobaltstrike/current/userguide/content/topics/malleable-c2-extend_process-injection.htm" target="_blank" rel="noreferrer noopener">options</a> for the <code>process-inject</code> block as shown below:</p>


<div class="wp-block-syntaxhighlighter-code "><div id="highlighter_62490" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="https://www.cobaltstrike.com/blog/cobalt-strike-412-fix-up-look-sharp#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_62490_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_62490" menu="false" src="https://www.cobaltstrike.com/app/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="https://www.cobaltstrike.com/blog/cobalt-strike-412-fix-up-look-sharp#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="https://www.cobaltstrike.com/blog/cobalt-strike-412-fix-up-look-sharp#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines no-wrap"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">process-inject {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">set use_driploading “true”;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">set dripload_delay “100”;&nbsp;&nbsp;&nbsp; //adds a further delay </code><code class="keyword">if</code> <code class="plain">desired</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div></div></div></div>


<p><em><strong>Note:</strong> The drip loader changes have required an update to the <code>ALLOCATED_MEMORY_*</code> structures found in <code>beacon.h</code>. This is because if Beacon lives in drip loaded memory the Sleepmask needs to handle it accordingly. Existing UDRLs will still work, however if you update the <code>USER_DATA.version</code> to 4.12 (0x00041200) you <strong>will also need to update</strong> the <code>ALLOCATED_MEMORY</code> structures. For Sleepmasks, as previously discussed, we have simplified the entry point so <em>all</em> existing Sleepmasks will need to be updated to support this <strong>and additionally will also need to include</strong> the new <code>ALLOCATED_MEMORY</code> structures found in <code>beacon.h</code>.</em> <em><a href="https://github.com/Cobalt-Strike/sleepmask-vs">Sleepmask-VS</a> contains all the required changes and so is a good template to aid migration.</em></p>



<h2 class="wp-block-heading">Java Support Updated To Java&nbsp;17</h2>



<p>We have&nbsp;updated the&nbsp;minimum&nbsp;supported version of Java from Java 11 to Java 17. <strong>You will get an error if&nbsp;you&nbsp;attempt&nbsp;to run Cobalt Strike 4.12 with an older version of Java.&nbsp;</strong></p>



<p>To avoid any issues, please make sure that the version of Java in your environment is at least Java 17 before downloading and running Cobalt Strike 4.12. For more guidance, see the Cobalt Strike&nbsp;<a href="https://hstechdocs.helpsystems.com/manuals/cobaltstrike/current/userguide/content/topics/install_installing.htm" target="_blank" rel="noreferrer noopener">installation guide</a>.&nbsp;</p>



<p>Also note that the TLS certificates used by our&nbsp;downloads&nbsp;infrastructure have been recently updated as they&nbsp;were due to&nbsp;expire on December 4, 2025. You will need to download and extract the distribution package for your platform to get the latest version of the update program&nbsp;(20251120)&nbsp;in order to&nbsp;run warning-free updates.&nbsp;</p>



<h2 class="wp-block-heading">Additional Updates</h2>



<p>This release also&nbsp;contains&nbsp;a number of&nbsp;additional&nbsp;QoL&nbsp;updates, including:</p>



<ul class="wp-block-list">
<li>Prior to 4.12, the SSH Beacon&nbsp;was broken&nbsp;for newer Mac/Linux&nbsp;distros. This has now been fixed.</li>



<li>To support the development of tools such as&nbsp;<a href="https://github.com/SpecterOps/Nemesis" target="_blank" rel="noreferrer noopener">Nemesis</a>,&nbsp;we’ve&nbsp;improved our logging capabilities.&nbsp;Historically,&nbsp;Cobalt&nbsp;Strike&nbsp;did not provide a&nbsp;mapping between a given command and its output, which made integration into tools like Nemesis difficult.&nbsp;<strong>In Cobalt Strike 4.12, all commands are now assigned a <code>task_id</code> which is mapped to the specific output&nbsp;of that command</strong>.&nbsp;An example of this from the&nbsp;logs&nbsp;is shown below:</li>
</ul>


<div class="wp-block-syntaxhighlighter-code aligncenter"><div id="highlighter_940253" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="https://www.cobaltstrike.com/blog/cobalt-strike-412-fix-up-look-sharp#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_940253_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_940253" menu="false" src="https://www.cobaltstrike.com/app/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="https://www.cobaltstrike.com/blog/cobalt-strike-412-fix-up-look-sharp#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="https://www.cobaltstrike.com/blog/cobalt-strike-412-fix-up-look-sharp#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines no-wrap"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">11/21 10:49:49 UTC [input] &amp;lt;wb&gt; &amp;lt;task 1cd089c04c42ce78&gt; getuid </code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="plain">11/21 10:49:50 UTC [task] &amp;lt;wb&gt; &amp;lt;task 1cd089c04c42ce78&gt; Tasked beacon to get userid </code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="plain">11/21 10:49:54 UTC [checkin] host called home, sent: 16 bytes </code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="plain">11/21 10:49:54 UTC [output] &amp;lt;task 1cd089c04c42ce78&gt;&nbsp; </code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="plain">You are DESKTOP-GM7B2QP\wb</code></td></tr></tbody></table></div></div></div></div>


<ul class="wp-block-list">
<li>Additionally, Cobalt Strike’s&nbsp;logs now&nbsp;contain&nbsp;<strong>all actions performed from the file and process browser&nbsp;</strong>thus enabling searching for any file-listing seen during an operation.</li>



<li>Beacon’s SOCKS5 proxy now supports IPv6 (TCP).</li>



<li>Beacon’s dynamic function resolution for BOFs is now unlimited (it was previously capped at 128).</li>



<li>We have added a <code>beacon_info</code> command (this is&nbsp;similar to&nbsp;the&nbsp;<code>cs_beacon_info</code> BOF&nbsp;found&nbsp;<a href="https://github.com/Cobalt-Strike/bof_template" target="_blank" rel="noreferrer noopener">here</a>) which will display Beacon’s in-memory location&nbsp;and heap allocations. This makes it much quicker to sanity check your Beacon’s in-memory OPSEC.</li>



<li>UDRL-VS now&nbsp;contains&nbsp;a GUI element which makes it much simpler to apply UDRLs to exported payloads. This update&nbsp;has&nbsp;added <code>udrl-vs.cna</code> to the project folder&nbsp;and&nbsp;consolidated&nbsp;the existing .cna&nbsp;scripts into the&nbsp;<code>./sleep</code> directory,&nbsp;so that users can easily call the sleep library functions (i.e. <code>RC4</code>, <code>base64</code>)&nbsp;when developing custom loaders.&nbsp;The GUI makes it&nbsp;possible to select either a Beacon Loader or&nbsp;a&nbsp;Postex&nbsp;Loader from the drop down and save the configuration so that it persists across restarts. In addition, “Export Debug Beacon” makes it trivial to export a “Debug Beacon” (i.e. a Beacon <em>without</em> a reflective loader).&nbsp;</li>
</ul>



<figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" width="906" height="544" src="https://www.cobaltstrike.com/app/uploads/2025/11/412_udrl_vs.png" alt="" class="wp-image-8789" style="width:507px;height:auto"><figcaption class="wp-element-caption"><em><strong>Fig 4:</strong>&nbsp;A screenshot showing the new UDRL-VS GUI,&nbsp;which makes it much easier to apply custom UDRLs to exported payloads.</em></figcaption></figure>



<p>Lastly, we now have a <a href="https://www.cobaltstrike.com/blog/cobalt-strike-412-fix-up-look-sharp#" id="openPopupLnk">feedback form</a> where you can directly&nbsp;submit&nbsp;feedback on Cobalt Strike.&nbsp;You can find a link to the form on&nbsp;our&nbsp;<a href="https://www.cobaltstrike.com/support" target="_blank" rel="noreferrer noopener">support page</a>&nbsp;under the “Support” header.&nbsp;You can also access this form directly from your Cobalt Strike client via <code>Help-&gt;Support</code>.&nbsp;</p>









<p>To see a full list of&nbsp;what’s&nbsp;new in Cobalt Strike 4.12, please check out the&nbsp;<a href="https://download.cobaltstrike.com/releasenotes.txt" target="_blank" rel="noreferrer noopener">release notes</a>.</p>



<p>To&nbsp;<a href="https://www.cobaltstrike.com/product/quote-request" target="_blank" rel="noreferrer noopener">purchase</a>&nbsp;Cobalt Strike or learn more, please&nbsp;<a href="https://www.cobaltstrike.com/product/quote-request" target="_blank" rel="noreferrer noopener">contact us</a>.</p>



<figure class="wp-block-image aligncenter size-large is-resized"><img loading="lazy" decoding="async" width="874" height="1024" src="https://www.cobaltstrike.com/app/uploads/2025/11/Cobalt-Strike-Guy-on-Comp-874x1024.png" alt="" class="wp-image-8865" style="width:603px;height:auto"></figure>

</div><!-- .entry-content -->

<!-- .entry-footer -->

</article><!-- #post-8728 -->


				</main>
			</div> <!-- #primary -->
			
<div class="col-lg-4 align-self-start resource-sidebar widget-area"><!-- #resource-sidebar -->
        <div class="sidebar-content bg-7 mb-3">
        <div class=" container">
            <div class="row">
                <div class="col-12">
                                    <div class="author-description p-3 row">
                                                <div class="author-image col-5">
                             <img width="231" height="231" src="https://www.cobaltstrike.com/app/uploads/2023/07/William-Burgess.png" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" decoding="async" loading="lazy">                        </div>
                                                <div class=" col-7 pl-0">
                            <h4 class="author-title text-align-left font-weight-light">
                                <a href="https://www.cobaltstrike.com/profile/william-burgess">William Burgess</a>
                            </h4>
                            <div>Principal Research Lead</div>
                        </div>
                        <div class="col-12 text-center mt-2">
                            <a class=" btn-link view-profile" href="https://www.cobaltstrike.com/profile/william-burgess">View Profile</a>
                        </div>
                    </div>
                                </div>  <!-- #column -->
            </div> <!-- #row -->
        </div> <!-- #container -->
    </div>  <!-- #sidebar-content -->
            <div class="sidebar-content bg-7 mb-3">
        <div class=" container">
            <div class="row">
                <div class="col-12">
                                            <div class="sidebar-content p-3">
                            <div class="block-title text-uppercase">
                            RELATED PRODUCTS
                            </div>
                            <ul class="list-group list-group-flush pt-2">
                            <li class="list-unstyled"><a href="https://www.cobaltstrike.com/blog/cobalt-strike-412-fix-up-look-sharp" title="Cobalt Strike">Cobalt Strike</a></li>                            </ul>
                        </div>
                                                                <div class="sidebar-content p-3">
                            <div class="block-title text-uppercase">
                            TOPICS
                            </div>
                            <ul class="list-group list-group-flush pt-2">
                            <li class="list-unstyled"><a href="https://www.cobaltstrike.com/blog?_sft_cornerstone=announcements" title="Announcements">Announcements</a></li>                            </ul>
                        </div>
                                    </div>  <!-- #column -->
            </div> <!-- #row -->
        </div> <!-- #container -->
    </div>  <!-- #sidebar-content -->
    </div><!-- #resource-sidebar -->
		</div><!-- .row -->
	</div><!-- #container -->
</div><!-- #page-wrapper -->



</div>



<div class="wpc-filters-overlay"></div>









<div height="1" width="1" style="position: absolute; top: 0px; left: 0px; border: none; visibility: hidden;" data-original-tag="iframe"></div>
<div class="ta-display-none" name="trustarc_notice" id="trustarcNoticeFrame" title="Trustarc Cross-Domain Consent Frame" src="https://consent.trustarc.com/get?name=crossdomain.html&amp;domain=helpsystems.com" data-original-tag="iframe"></div></body></html>