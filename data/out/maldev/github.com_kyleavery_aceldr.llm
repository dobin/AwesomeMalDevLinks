Title:
AceLdr – Avoid Memory Scanners

Type:
GitHub Tool

Short Summary (4–8 sentences max):
AceLdr is a position-independent reflective loader (UDRL) for Cobalt Strike Beacon designed to evade common in-memory scanners and signature-based hunting tools. It focuses on reducing or eliminating recognizable Beacon artifacts in process memory, including during sleep, to defeat tools like Moneta, PE-sieve, BeaconEye, and Hunt-Sleeping-Beacons. The loader implements dynamic heap usage with encryption of Beacon allocations before sleep, and encrypts/obfuscates Beacon code pages while marking them non-executable (inspired by FOLIAGE). It also includes return-address spoofing for selected WinAPI/NT calls and a “sleep without sleep” approach using wait APIs rather than a direct Sleep pattern. Encryption is performed via RC4 using SystemFunction032. It’s primarily useful for red teams and offensive operators customizing Cobalt Strike tradecraft, and for defenders studying modern memory-evasion patterns.

Technical Focus:
- Position-independent reflective loading (UDRL) for Cobalt Strike Beacon
- Memory artifact reduction: heap isolation, page permission changes, code/data encryption
- Sleep obfuscation (“sleep without sleep”) via wait primitives
- Return address spoofing for API call stack evasion
- RC4 via SystemFunction032 (advapi32/crypt routines)
- Evasion of memory scanners (Moneta, PE-sieve, Beacon-focused hunters)

Use Cases:
- Deploying Cobalt Strike Beacon with reduced in-memory signatures during sleep/idle
- Testing and benchmarking EDR/memory-scanner detections against encrypted/hidden Beacon memory
- Researching defensive detections for heap encryption, RX→RW/NX transitions, and wait-based sleep patterns
- Building custom loaders that integrate with Malleable C2 transformations to remove string artifacts

Keywords:
Cobalt Strike, Beacon, UDRL, reflective loader, position-independent code, in-memory evasion, memory scanner evasion, Moneta, PE-sieve, Hunt-Sleeping-Beacons, BeaconEye, BeaconHunter, heap encryption, FOLIAGE, page permissions, NX, return address spoofing, NtWaitForSingleObject, WaitForSingleObjectEx, RtlAllocateHeap, InternetConnectA, SystemFunction032, RC4, Malleable C2, shellcode loader