Title:
Bypass EDR’s memory protection, introduction to hooking

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post walks through diagnosing and bypassing an EDR that blocks LSASS credential dumping by intercepting memory-read behavior rather than handle acquisition.  
- The author observes that `OpenProcess(PROCESS_ALL_ACCESS)` succeeds, but `MiniDumpWriteDump()` fails because it internally relies on `ReadProcessMemory`/`NtReadVirtualMemory`, which the EDR monitors.  
- It explains the userland-to-kernel call chain (`ReadProcessMemory` → `NtReadVirtualMemory` → `syscall`) and argues kernel-level patching is constrained by Kernel Patch Protection (PatchGuard), pushing many EDRs toward user-mode hooks.  
- By inspecting `ntdll!NtReadVirtualMemory`, the author identifies a detour (first bytes replaced with a JMP) redirecting execution into an EDR DLL (example shown: `CyMemDef64.dll`).  
- Two bypass options are proposed: restoring the original syscall stub bytes (“re-patch the patch”) or redirecting calls via an IAT-based approach so the EDR’s hook remains intact but unused.  
- Useful for red teamers, pentesters, and malware researchers interested in practical hook identification and syscall-stub restoration to evade user-mode API monitoring.

Technical Focus:
- User-mode API hooking / detour JMP trampolines in `ntdll`
- Windows memory access APIs: `ReadProcessMemory`, `NtReadVirtualMemory`, `MiniDumpWriteDump`
- Syscall stubs and the userland→kernel transition (`syscall`)
- PatchGuard / Kernel Patch Protection constraints on kernel hooking
- Static/dynamic inspection of in-memory code bytes (function prologues)
- Import Address Table (IAT) redirection as an evasion technique

Use Cases:
- Identify which Windows APIs an EDR is intercepting during LSASS dumping attempts
- Restore original `ntdll` syscall stubs to bypass user-mode monitoring
- Build custom dumpers that avoid or neutralize userland hooks
- Develop and test EDR evasion tradecraft focused on memory-read telemetry
- Reverse engineer EDR user-mode components that enforce “memory protection” policies

Keywords:
LSASS, credential dumping, EDR bypass, MiniDumpWriteDump, ReadProcessMemory, NtReadVirtualMemory, ntdll, syscall stub, detour hook, JMP trampoline, user-mode hooking, PatchGuard, Kernel Patch Protection, IAT hooking, Import Address Table, CyMemDef64.dll, Windows internals, process memory dumping, API interception, Mimikatz