Title:
CVE-2025-52915: A BYOVD Evolution Story

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post analyzes a persistent BYOVD (Bring Your Own Vulnerable Driver) weakness in K7Computing’s rootkit scanner driver `K7RKScan.sys`, focusing on how a kernel process-termination IOCTL remains abusable across versions.  
- In the older version (v15.1.0.6, CVE-2025-1055), any user could open the device and send IOCTL `0x222018` with a PID to terminate arbitrary processes as SYSTEM, enabling both LPE and BYOVD.  
- In the newer version (v23.0.0.10, CVE-2025-52915), K7 added admin checks (`SeTokenIsAdmin()`), single-client semantics, and process filtering (blacklist + PP/PPL checks), mitigating the non-admin LPE path.  
- Despite these improvements, the core design still exposes kernel-assisted process termination to user mode with insufficient target validation, leaving an admin-loadable driver that can kill many non-blacklisted, non-PPL processes (including security tooling that relies on user-mode protections).  
- The write-up highlights “timing window” abuse during legitimate scan/load/unload cycles and explains why vendor fixes often remove escalation but preserve attacker-useful primitives.  
- Useful for red teams, malware developers, and defenders interested in driver abuse tradecraft, reverse engineering patterns, and mitigation/detection considerations.

Technical Focus:
- BYOVD driver abuse and attacker-controlled IOCTL interfaces
- Windows kernel driver device exposure (`\\Device\\...` / `\\DosDevices\\...`) and handle access control
- Kernel-mode process termination primitives via IOCTL `0x222018`
- Token/admin validation (`SeTokenIsAdmin`) and single-connection enforcement
- Process protection/allowlist-denylist logic (blacklists, PP/PPL checks)
- Timing/race-style abuse around driver lifecycle during legitimate scans

Use Cases:
- Terminate EDR/AV or other “hard-to-kill” user-mode processes using a signed vulnerable driver
- Build BYOVD chains where admin is available but user-mode termination is blocked/monitored
- Reverse engineer and assess third-party security drivers for exposed privileged IOCTLs
- Create detections for suspicious driver loads + IOCTL usage patterns targeting security processes
- Validate endpoint hardening against known-vulnerable driver abuse (blocklists, WDAC, HVCI)

Keywords:
CVE-2025-52915, CVE-2025-1055, BYOVD, K7RKScan.sys, K7Computing, IOCTL 0x222018, process termination, Windows kernel driver, \\Device\\NTK7RKScnDrv, \\DosDevices\\DosK7RKScnDrv, SeTokenIsAdmin, Protected Process (PP), Protected Process Light (PPL), driver loading, EDR bypass, AV tampering, race condition, device access control, reverse engineering, WDAC/HVCI