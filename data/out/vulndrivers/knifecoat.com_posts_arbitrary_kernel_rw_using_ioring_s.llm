Title:
Arbitrary Kernel RW using IORING’s

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post explains how Windows I/O Rings (IORING) on Windows 11 22H2+ can be abused to build an arbitrary kernel read/write primitive when combined with an existing kernel bug that provides an arbitrary write or increment.  
- The core idea is to corrupt the kernel-mode `_IORING_OBJECT` fields `RegBuffers` and `RegBuffersCount` so they point to attacker-controlled user-mode memory that contains pointers to crafted `_IOP_MC_BUFFER_ENTRY` structures.  
- By then using `BuildIoRingReadFile` and `BuildIoRingWriteFile`, the attacker can redirect I/O operations to read from or write to arbitrary kernel addresses specified in `IOP_MC_BUFFER_ENTRY.Address/Length`.  
- The post highlights a counterintuitive permission behavior (read capability enabling kernel write and vice versa) and notes version differences (v1/v2 vs v3 adding write/flush/drain).  
- Named pipes are suggested as a convenient “file” object to shuttle data for the primitive.  
- It includes WinDbg/KD walkthroughs of the relevant structures and a cleanup note to avoid BSOD by restoring `RegBuffers` to NULL before process exit.  
- Useful for exploit developers and red teamers building post-bug kernel exploitation chains; also relevant to defenders for understanding a modern Windows kernel exploitation primitive.

Technical Focus:
- Windows I/O Ring (IORING) internals and version capabilities
- Kernel object corruption of `_IORING_OBJECT` (`RegBuffers`, `RegBuffersCount`)
- Crafting `_IOP_MC_BUFFER_ENTRY` to control kernel address/length
- Arbitrary kernel read/write via `BuildIoRingReadFile` / `BuildIoRingWriteFile`
- Using named pipes as file objects for data exfiltration/injection
- WinDbg/KD structure inspection and exploitation workflow

Use Cases:
- Turning a limited kernel primitive (arbitrary write/increment) into full kernel R/W
- Kernel memory disclosure via file/pipe-backed IoRing writes
- Kernel memory overwrite for privilege escalation or token/EPROCESS manipulation (as a follow-on)
- Building reliable Windows 11 post-exploitation chains leveraging IORING
- Researching/detecting suspicious IoRing usage patterns in kernel exploitation

Keywords:
Windows 11, 22H2, 23H2, IORING, CreateIoRing, SubmitIoRing, BuildIoRingReadFile, BuildIoRingWriteFile, kernel exploit, arbitrary kernel read, arbitrary kernel write, _IORING_OBJECT, _IOP_MC_BUFFER_ENTRY, RegBuffers, RegBuffersCount, named pipe, NT_IORING_INFO, MDL, WinDbg, KD debugging