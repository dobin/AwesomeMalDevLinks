# https://blacksnufkin.github.io/posts/BYOVD-CVE-2025-52915/

<!DOCTYPE html><html lang="en"><body><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">CVE-2025-52915: A BYOVD Evolution Story</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">Contents</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"><h2 id="tldr"><span class="me-2">TL;DR</span><a href="https://blacksnufkin.github.io/posts/BYOVD-CVE-2025-52915/#tldr" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>K7RKScan.sys exposes a process termination IOCTL to user-mode without sufficient caller or target validation. This flaw enables attackers to terminate arbitrary processes from kernel mode, bypassing user-mode protections that legitimate security tools rely on. Despite multiple version updates and security improvements, the vulnerability persists in the latest release-now gated by admin checks but still usable in BYOVD attack chains.</p><hr><p>This analysis examines vulnerabilities discovered in K7Computing’s rootkit scanner driver K7RKScan.sys across two versions, showing how fundamental design flaws persist across driver releases despite security improvements.</p><h2 id="disclosure-timeline"><span class="me-2">Disclosure Timeline</span><a href="https://blacksnufkin.github.io/posts/BYOVD-CVE-2025-52915/#disclosure-timeline" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><blockquote><p>I reported the vulnerability on June 3, 2025, but a week later CVE-2025-1055 appeared crediting another researcher for what looked like the same issue. Throughout this time, my report was being dismissed as “highly unlikely” while they kept asking for more and more proof. The situation became even stranger when it turned out they actually thought I was the other researcher who had received credit for the first CVE. Even after acknowledging this confusion, they continued requesting additional evidence while maintaining their stance. What made it particularly odd was that the first CVE had gaps in the technical details and only covered versions up to 23.0.0.10. So when I demonstrated that BYOVD issues still existed in the latest version, they ended up assigning me CVE-2025-52915.</p></blockquote><p>The core problem is simple: a kernel-level process termination IOCTL exposed to user mode with poor validation. The LPE got patched, but the BYOVD risk stayed across all versions because the fundamental driver design never changed. The way this vulnerability shows up differs between driver versions:</p><ul><li><strong>CVE-2025-1055 (v15.1.0.6):</strong> No caller validation enables both privilege escalation and BYOVD attacks</li><li><strong>CVE-2025-52915 (v23.0.0.10):</strong> Admin checks and process filtering were added, but BYOVD attacks still work</li></ul><h2 id="the-legacy-vulnerability-cve-2025-1055-v15106"><span class="me-2">The Legacy Vulnerability: CVE-2025-1055 (v15.1.0.6)</span><a href="https://blacksnufkin.github.io/posts/BYOVD-CVE-2025-52915/#the-legacy-vulnerability-cve-2025-1055-v15106" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="how-the-driver-works"><span class="me-2">How the Driver Works</span><a href="https://blacksnufkin.github.io/posts/BYOVD-CVE-2025-52915/#how-the-driver-works" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>K7RKScan.sys version 15.1.0.6 follows standard Windows driver setup, but with a critical security oversight. When the driver loads, it creates a communication channel that any user can access.</p><p>The driver initialization begins with basic memory allocation and device setup:</p><p></p><p>This routine creates a device at <code class="language-plaintext highlighter-rouge">\\Device\\NTK7RKScnDrv</code> with symbolic link <code class="language-plaintext highlighter-rouge">\\DosDevices\\DosK7RKScnDrv</code>, making it accessible to user-mode applications. The driver assigns <code class="language-plaintext highlighter-rouge">sub_11434</code> to handle device open/close operations, while <code class="language-plaintext highlighter-rouge">sub_114A0</code> processes IOCTL commands.</p><p>When a user application tries to open the driver, it goes through the CREATE handler. This function performs basic reference counting but includes the critical security flaw:</p><p></p><p>This function does basic reference counting to track how many applications have the device open, but here’s the critical flaw: it performs no security checks whatsoever. Any user on the system can successfully open a handle to this device.</p><h3 id="the-kill-switch"><span class="me-2">The Kill Switch</span><a href="https://blacksnufkin.github.io/posts/BYOVD-CVE-2025-52915/#the-kill-switch" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Once a user opens a handle to the driver, the real risk begins in the IOCTL handler <code class="language-plaintext highlighter-rouge">sub_114A0</code>. This function interprets user-supplied commands, including one that terminates processes with full kernel privileges:</p><p></p><p>The logic is simple: when IOCTL 0x222018 is received with a process ID in the input buffer, the driver looks up that process and terminates it with SYSTEM privileges. No validation, no restrictions.</p><h3 id="attack-scenarios"><span class="me-2">Attack Scenarios</span><a href="https://blacksnufkin.github.io/posts/BYOVD-CVE-2025-52915/#attack-scenarios" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>This design creates two distinct attack vectors:</p><p><strong>Direct BYOVD Attack</strong>: Attackers with admin privileges can manually load the driver and immediately begin terminating any process on the system, including heavily protected processes like MsMpEng.exe (Windows Defender) and NisSrv.exe.</p><p><strong>Race Condition Privilege Escalation</strong>: Attackers can exploit the timing when K7’s legitimate software loads this driver during system scans. When scans complete or get canceled, there’s a brief cleanup window where the driver remains loaded. Standard users can exploit this timing by:</p><ol><li>Monitoring for K7 Rootkit Scanner service activity</li><li>Detecting when the driver becomes accessible during cleanup phases</li><li>Rapidly opening <code class="language-plaintext highlighter-rouge">\\.\DosK7RKScnDrv</code> before the driver unloads</li><li>Sending IOCTL 0x222018 commands to terminate arbitrary processes with SYSTEM privileges</li></ol><h2 id="the-current-version-cve-2025-52915-v230010"><span class="me-2">The Current Version: CVE-2025-52915 (v23.0.0.10)</span><a href="https://blacksnufkin.github.io/posts/BYOVD-CVE-2025-52915/#the-current-version-cve-2025-52915-v230010" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="security-improvements"><span class="me-2">Security Improvements</span><a href="https://blacksnufkin.github.io/posts/BYOVD-CVE-2025-52915/#security-improvements" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The current version of K7RKScan.sys (23.0.0.10) includes some security improvements compared to the legacy version. The most significant change appears in the driver initialization, which now includes enhanced security handlers.</p><p></p><p>The key difference is the new CREATE/CLOSE handler <code class="language-plaintext highlighter-rouge">sub_140001E50</code>, which adds proper privilege verification:</p><p></p><p>This enhanced handler checks for admin privileges using <code class="language-plaintext highlighter-rouge">SeTokenIsAdmin()</code> and enforces single-connection semantics. This change effectively mitigates the race condition-based privilege escalation vulnerability.</p><h3 id="process-protection-logic"><span class="me-2">Process Protection Logic</span><a href="https://blacksnufkin.github.io/posts/BYOVD-CVE-2025-52915/#process-protection-logic" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Unlike the legacy version this time the termination logic has been moved into sperate fucntion</p><p></p><p>Beyond access control, the updated driver also adds process filtering to prevent termination of critical system components. The filtering function <code class="language-plaintext highlighter-rouge">sub_140001680</code> implements multiple protection layers:</p><p></p><p>This filtering logic has multiple layers of protection. First, it maintains a hardcoded blacklist of critical system processes (csrss.exe, smss.exe, lsass.exe, winlogon.exe, svchost.exe) along with all K7-branded processes. Second, on Windows 8 and later systems, it checks for Protected Process (PP) and Protected Process Light (PPL) status.</p><h3 id="persistent-byovd-risk"><span class="me-2">Persistent BYOVD Risk</span><a href="https://blacksnufkin.github.io/posts/BYOVD-CVE-2025-52915/#persistent-byovd-risk" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Even with recent changes, the core issue remains. The driver still doesn’t validate who’s calling it, meaning it can be used to terminate processes that resist standard shutdown methods. While the blacklist helps reduce misuse, it doesn’t offer complete protection.</p><p>In practice, this leaves processes and services that can withstand user-mode termination - such as those immune to <code class="language-plaintext highlighter-rouge">taskkill /f</code> - but aren’t protected with PPL still exposed. The driver provides a direct kernel-level path to terminate them.</p><p>This design creates the same attack vectors as the legacy version, but with updated requirements:</p><p><strong>Direct BYOVD Attack</strong>: Attackers with admin privileges can manually load the driver and immediately begin terminating processes that survive standard administrative termination methods. The process filtering blocks critical system processes, but everything else remains vulnerable.</p><p><strong>Timing Window Attack</strong>: Attackers can exploit the timing when K7’s legitimate software loads this driver during system scans. When scans complete or get canceled, there’s a brief cleanup window where the driver remains loaded. Admin users can exploit this timing by:</p><p>The timing attack works exactly like in the legacy version - the only difference is now requires admin privileges. While this prevents escalation from standard users, it unintentionally enhances attacker capabilities for those with admin access. K7’s presence gives admin attackers enhanced capabilities they wouldn’t have on systems without K7 installed.</p><h2 id="vulnerability-evolution"><span class="me-2">Vulnerability Evolution</span><a href="https://blacksnufkin.github.io/posts/BYOVD-CVE-2025-52915/#vulnerability-evolution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The progression between driver versions reveals a predictable pattern:</p><div class="table-wrapper"><table><thead><tr><th>Version</th><th>Access Control</th><th>Process Filtering</th><th>Attack Surface</th></tr></thead><tbody><tr><td>15.1.0.6</td><td>None</td><td>None</td><td>Any user → any process</td></tr><tr><td>23.0.0.10</td><td>Admin required</td><td>Blacklist added</td><td>Admin → non-blacklisted processes</td></tr></tbody></table></div><p>This evolution shows how vendors typically approach security fixes: address the most critical vulnerability (privilege escalation) while preserving the core functionality that made the driver attractive to attackers in the first place.</p><h2 id="impact-analysis"><span class="me-2">Impact Analysis</span><a href="https://blacksnufkin.github.io/posts/BYOVD-CVE-2025-52915/#impact-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The K7RKScan.sys case shows why BYOVD vulnerabilities persist across development cycles. Even when vendors fix privilege escalation issues, they often keep the kernel functionality that made the driver useful to attackers. Process termination through kernel drivers bypasses user-mode protections. This makes K7RKScan.sys valuable for killing security software and other restricted processes that resist standard termination methods.</p><h2 id="resources"><span class="me-2">Resources</span><a href="https://blacksnufkin.github.io/posts/BYOVD-CVE-2025-52915/#resources" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Full proof-of-concept for both CVEs code is available on <a href="https://github.com/BlackSnufkin/BYOVD/tree/main/K7Terminator">GitHub</a>.</li><li>Vendor Response: <a href="https://support.k7computing.com/index.php?/solutions/view-article/Advisory-issued-on-2nd-Sep-2025">Official K7 Computing advisory</a></li></ul><h2 id="conclusion"><span class="me-2">Conclusion</span><a href="https://blacksnufkin.github.io/posts/BYOVD-CVE-2025-52915/#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>K7RKScan.sys represents a common pattern in kernel driver security. The vendor successfully addressed privilege escalation but maintained the BYOVD-enabling functionality. This shows why comprehensive security reviews are essential during driver development - addressing surface-level issues often misses fundamental design problems.</p><h2 id="pocs"><span class="me-2">PoC’s</span><a href="https://blacksnufkin.github.io/posts/BYOVD-CVE-2025-52915/#pocs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><strong>LPE</strong></li></ul><video controls="" width="100%"> <source src="https://blacksnufkin.github.io/assets/posts/2025-09-03-BYOVD-CVE-2025-52915/K7-LPE.mp4" type="video/mp4"> Your browser does not support the video tag. </video><ul><li><strong>BYOVD</strong></li></ul><video controls="" width="100%"> <source src="https://blacksnufkin.github.io/assets/posts/2025-09-03-BYOVD-CVE-2025-52915/K7-BYOVD.mp4" type="video/mp4"> Your browser does not support the video tag. </video></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="https://blacksnufkin.github.io/categories/byovd/">BYOVD</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="https://blacksnufkin.github.io/tags/research/" class="post-tag no-text-decoration">Research</a> <a href="https://blacksnufkin.github.io/tags/vulnerability/" class="post-tag no-text-decoration">Vulnerability</a> <a href="https://blacksnufkin.github.io/tags/exploit/" class="post-tag no-text-decoration">Exploit</a> <a href="https://blacksnufkin.github.io/tags/reverse/" class="post-tag no-text-decoration">Reverse</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 "><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=CVE-2025-52915:%20A%20BYOVD%20Evolution%20Story%20-%20BlackSnufkin&amp;url=https%3A%2F%2Fblacksnufkin.github.io%2Fposts%2FBYOVD-CVE-2025-52915%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" aria-label="Twitter" data-bs-original-title="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=CVE-2025-52915:%20A%20BYOVD%20Evolution%20Story%20-%20BlackSnufkin&amp;u=https%3A%2F%2Fblacksnufkin.github.io%2Fposts%2FBYOVD-CVE-2025-52915%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" aria-label="Facebook" data-bs-original-title="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fblacksnufkin.github.io%2Fposts%2FBYOVD-CVE-2025-52915%2F&amp;text=CVE-2025-52915:%20A%20BYOVD%20Evolution%20Story%20-%20BlackSnufkin" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" aria-label="Telegram" data-bs-original-title="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" data-title-succeed="Link copied successfully!" data-bs-original-title="Copy link"> <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="https://blacksnufkin.github.io/tags/detection/">Detection</a> <a class="post-tag btn btn-outline-primary" href="https://blacksnufkin.github.io/tags/exploit/">Exploit</a> <a class="post-tag btn btn-outline-primary" href="https://blacksnufkin.github.io/tags/iocs/">IOCs</a> <a class="post-tag btn btn-outline-primary" href="https://blacksnufkin.github.io/tags/opsec/">OPSEC</a> <a class="post-tag btn btn-outline-primary" href="https://blacksnufkin.github.io/tags/research/">Research</a> <a class="post-tag btn btn-outline-primary" href="https://blacksnufkin.github.io/tags/reverse/">Reverse</a> <a class="post-tag btn btn-outline-primary" href="https://blacksnufkin.github.io/tags/vulnerability/">Vulnerability</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>
</body></html>