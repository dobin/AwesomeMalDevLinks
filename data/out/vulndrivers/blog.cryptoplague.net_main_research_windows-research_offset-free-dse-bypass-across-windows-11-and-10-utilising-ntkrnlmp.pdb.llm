Title:
Offset-Free DSE Bypass Across Windows 11 and 10 Utilising ntkrnlmp.pdb

Type:
Research Paper / Technical Blog Post

Short Summary (4–8 sentences max):
- This write-up presents a Driver Signature Enforcement (DSE) bypass technique that works across many Windows 10/11 builds without relying on hardcoded kernel structure/function offsets.  
- It addresses a common reliability problem in BYOVD-based DSE bypasses: offsets change between versions, and wrong offsets often cause kernel corruption and BSODs.  
- The core idea is to dynamically resolve target kernel function locations (e.g., SeValidateImageHeader/SeValidateImageData) by downloading and parsing the matching ntoskrnl PDB from Microsoft’s public symbol server using the PDB GUID extracted from the local ntoskrnl.exe.  
- A vulnerable signed driver is then used to map/scan kernel physical memory, locate the in-memory ntoskrnl base by matching the PDB GUID, patch the CI-related validation routines to return success, load an unsigned driver, and restore original bytes to reduce PatchGuard risk.  
- The PoC is implemented in Rust and is demonstrated on multiple Windows 10/11 versions, including with VBS enabled (but not with HVCI).  
- It is primarily useful for red teams, exploit developers, and defenders studying BYOVD tradecraft and symbol-based kernel targeting.

Technical Focus:
- BYOVD-based kernel exploitation primitives (R/W or physical memory mapping)
- Microsoft public symbols (PDB) retrieval and parsing via GUID matching
- Dynamic resolution of kernel function RVAs (offset-free targeting)
- Kernel physical memory scanning to locate ntoskrnl base (MZ header + GUID validation)
- Patching SeValidateImageHeader / SeValidateImageData to disable signature checks temporarily
- PatchGuard/KPP timing considerations and restoration of patched bytes

Use Cases:
- Building more portable DSE bypass tooling across Windows 10/11 builds without per-version offset maintenance
- Reliable unsigned driver loading for controlled red-team operations (when a suitable BYOVD primitive exists)
- Researching and validating defenses around symbol access, vulnerable driver abuse, and kernel tamper detection
- Developing detections for PDB symbol fetching + kernel memory scanning + transient CI patch patterns

Keywords:
DSE, Driver Signature Enforcement, BYOVD, vulnerable driver, Windows 11, Windows 10, ntoskrnl.exe, ntkrnlmp.pdb, PDB GUID, Microsoft Symbol Server, SeValidateImageHeader, SeValidateImageData, PatchGuard, KPP, VBS, HVCI, kernel physical memory, ZwMapViewOfSection, PE parsing, Rust FFI