Title:
Silent Killers: Unmasking a Large-Scale Legacy Driver Exploitation Campaign

Type:
Blog Post

Short Summary (4–8 sentences max):
- Check Point Research analyzes a large-scale malware campaign that uses a legacy, vulnerable Windows kernel driver (Adlice RogueKiller antirootkit driver `Truesight.sys` v2.0.2) to kill EDR/AV processes, including protected processes (PP/PPL).  
- The campaign deployed thousands of first-stage downloader samples and leveraged 2,500+ distinct, validly signed variants of the same driver to evade hash-based detections and blocklists.  
- Attackers exploited a Windows driver-signing policy exception (pre-2015 cross-signed cert chain) to load the legacy driver on modern Windows, and initially bypassed the Microsoft Vulnerable Driver Blocklist and LOLDrivers coverage for this specific version.  
- The EDR/AV killer module (VMProtect-protected 32-bit DLL) uses `DeviceIoControl` with IOCTL `0x22E044` to trigger arbitrary process termination in the driver, then enables follow-on payload execution (notably Gh0st RAT/HiddenGh0st-like variants).  
- The infection chain includes phishing distribution, staged encrypted payloads masquerading as images, scheduled-task persistence, and DLL sideloading; infrastructure heavily uses China-region public cloud (Aliyun OSS) with most victims in China/Asia.  
- CPR reported the gap to MSRC, resulting in a blocklist update (Dec 17, 2024) to prevent loading these variants, highlighting the limits of hash-only driver detections.

Technical Focus:
- Vulnerable driver abuse for EDR/AV tampering (arbitrary process termination)
- Windows driver signing policy exceptions (legacy cross-signed drivers)
- Microsoft Vulnerable Driver Blocklist / WDAC signer+attribute matching (TBS hash)
- Authenticode evasion via PE-field and `WIN_CERTIFICATE` padding modifications
- Multi-stage loaders: encrypted payloads, in-memory execution, DLL sideloading, scheduled tasks
- VMProtect-protected payloads and 32-bit anti-analysis choices

Use Cases:
- Hunting/detection engineering for vulnerable-driver abuse beyond known LOLDrivers entries
- Building detections for signed-driver “varianting” that preserves Authenticode validity
- Incident response triage for EDR-killer behavior (driver drop + IOCTL process kill)
- Hardening guidance: applying updated Microsoft vulnerable driver blocklist / WDAC policies
- Threat intel enrichment: mapping staged loader + Aliyun OSS infrastructure + Gh0st RAT delivery

Keywords:
Truesight.sys, RogueKiller, Adlice, vulnerable driver, BYOVD, arbitrary process termination, IOCTL 0x22E044, DeviceIoControl, PP/PPL, EDR killer, Microsoft Vulnerable Driver Blocklist, WDAC, TBS hash, driver signing policy exception, cross-signed certificate, Authenticode, WIN_CERTIFICATE padding, PE CheckSum, DLL sideloading, scheduled task persistence, VMProtect, Gh0st RAT, HiddenGh0st, Aliyun OSS, Silver Fox