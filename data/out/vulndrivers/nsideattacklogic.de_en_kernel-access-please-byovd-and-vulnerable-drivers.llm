Title:
Kernel Access Please – BYOVD and Vulnerable Drivers

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post explains Bring Your Own Vulnerable Driver (BYOVD) attacks on Windows, focusing on how attackers load legitimately signed but vulnerable/legacy kernel drivers to gain powerful kernel-assisted capabilities.  
- It highlights the structural issue that Windows can still load pre-2015 signed drivers, allowing attackers to “re-enable” already-patched vulnerabilities by installing older versions.  
- The article reviews Microsoft mitigations (kernel-mode code signing changes and the Windows driver blocklist), and why they’re incomplete—especially due to version sprawl and the blocklist being enabled by default mainly on newer Windows 11 builds.  
- Using the legacy Truesight driver as an example, it shows that many BYOVD “exploits” are simply abusing exposed IOCTL functionality (e.g., an IOCTL that calls `ZwTerminateProcess`) to kill arbitrary processes, including PPL-protected EDR components.  
- It also demonstrates how CVE-2013-3900 can be used to modify a few bytes of a signed PE without breaking the Authenticode signature, defeating hash-based detections and enabling large-scale driver variant generation.  
- Useful for red teams and malware developers for understanding practical BYOVD tradecraft, and for blue teams to prioritize blocklist enforcement and behavior-based detection around driver loading and suspicious IOCTL use.

Technical Focus:
- BYOVD (Bring Your Own Vulnerable Driver) tradecraft
- Windows kernel-mode driver signing policy (legacy vs modern signing)
- Microsoft vulnerable driver blocklist (identifiers: Authentihash, version/name, TBS hash)
- IOCTL abuse via `DeviceIoControl` and driver dispatch routines
- Protected Process Light (PPL) bypass via kernel driver capabilities
- CVE-2013-3900 Authenticode verification weakness / signature-preserving tampering

Use Cases:
- Terminating or tampering with EDR/security processes protected by PPL using a vulnerable signed driver
- Evasion of hash-based detections by producing signature-valid driver variants (CVE-2013-3900)
- Assessing enterprise exposure to legacy driver loading and blocklist coverage gaps
- Building detections for suspicious driver loads and anomalous IOCTL activity
- Red team simulation of BYOVD-based defense evasion on Windows endpoints/servers

Keywords:
BYOVD, vulnerable driver, Windows kernel, kernel-mode code signing, legacy signed drivers, Windows 10 1607, Windows 11 driver blocklist, Microsoft recommended driver block rules, Authenticode, Authentihash, TBS hash, CVE-2013-3900, PE signature bypass, DeviceIoControl, IOCTL handler, DriverEntry, ZwTerminateProcess, Protected Process Light, PPL, Truesight driver, EDR tampering, VirusTotal, Binary Ninja