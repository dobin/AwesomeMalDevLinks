# https://github.com/TheCruZ/kdmapper

[Skip to content](https://github.com/TheCruZ/kdmapper#start-of-content)

You signed in with another tab or window. [Reload](https://github.com/TheCruZ/kdmapper) to refresh your session.You signed out in another tab or window. [Reload](https://github.com/TheCruZ/kdmapper) to refresh your session.You switched accounts on another tab or window. [Reload](https://github.com/TheCruZ/kdmapper) to refresh your session.Dismiss alert

{{ message }}

[TheCruZ](https://github.com/TheCruZ)/ **[kdmapper](https://github.com/TheCruZ/kdmapper)** Public

- [Notifications](https://github.com/login?return_to=%2FTheCruZ%2Fkdmapper) You must be signed in to change notification settings
- [Fork\\
613](https://github.com/login?return_to=%2FTheCruZ%2Fkdmapper)
- [Star\\
2.8k](https://github.com/login?return_to=%2FTheCruZ%2Fkdmapper)


KDMapper is a simple tool that exploits iqvw64e.sys Intel driver to manually map non-signed drivers in memory


### License

[MIT license](https://github.com/TheCruZ/kdmapper/blob/master/LICENSE)

[2.8k\\
stars](https://github.com/TheCruZ/kdmapper/stargazers) [613\\
forks](https://github.com/TheCruZ/kdmapper/forks) [Branches](https://github.com/TheCruZ/kdmapper/branches) [Tags](https://github.com/TheCruZ/kdmapper/tags) [Activity](https://github.com/TheCruZ/kdmapper/activity)

[Star](https://github.com/login?return_to=%2FTheCruZ%2Fkdmapper)

[Notifications](https://github.com/login?return_to=%2FTheCruZ%2Fkdmapper) You must be signed in to change notification settings

# TheCruZ/kdmapper

master

[**2** Branches](https://github.com/TheCruZ/kdmapper/branches) [**0** Tags](https://github.com/TheCruZ/kdmapper/tags)

[Go to Branches page](https://github.com/TheCruZ/kdmapper/branches)[Go to Tags page](https://github.com/TheCruZ/kdmapper/tags)

Go to file

Code

Open more actions menu

## Folders and files

| Name | Name | Last commit message | Last commit date |
| --- | --- | --- | --- |
| ## Latest commit<br>[![TheCruZ](https://avatars.githubusercontent.com/u/23271181?v=4&size=40)](https://github.com/TheCruZ)[TheCruZ](https://github.com/TheCruZ/kdmapper/commits?author=TheCruZ)<br>[Clarify](https://github.com/TheCruZ/kdmapper/commit/9892b48e30a2ffcbd4d360e4b4c0b8f50189a4fe)<br>2 months agoDec 22, 2025<br>[9892b48](https://github.com/TheCruZ/kdmapper/commit/9892b48e30a2ffcbd4d360e4b4c0b8f50189a4fe) · 2 months agoDec 22, 2025<br>## History<br>[169 Commits](https://github.com/TheCruZ/kdmapper/commits/master/) <br>Open commit details<br>[View commit history for this file.](https://github.com/TheCruZ/kdmapper/commits/master/) 169 Commits |
| [DbgHelp](https://github.com/TheCruZ/kdmapper/tree/master/DbgHelp "DbgHelp") | [DbgHelp](https://github.com/TheCruZ/kdmapper/tree/master/DbgHelp "DbgHelp") | [Symbols refactor...](https://github.com/TheCruZ/kdmapper/commit/19e12cf63ad53418333bdd28fe25a0bf957ca3b9 "Symbols refactor...") | last yearFeb 8, 2025 |
| [HelloWorld](https://github.com/TheCruZ/kdmapper/tree/master/HelloWorld "HelloWorld") | [HelloWorld](https://github.com/TheCruZ/kdmapper/tree/master/HelloWorld "HelloWorld") | [HelloWorld Source](https://github.com/TheCruZ/kdmapper/commit/58491c3ca541585767aa6bb6ba38883a2701eaad "HelloWorld Source") | 4 years agoNov 8, 2022 |
| [LibUsageExample](https://github.com/TheCruZ/kdmapper/tree/master/LibUsageExample "LibUsageExample") | [LibUsageExample](https://github.com/TheCruZ/kdmapper/tree/master/LibUsageExample "LibUsageExample") | [Fix example build](https://github.com/TheCruZ/kdmapper/commit/03a511da784b4cffa08805677df1bffb03eada47 "Fix example build") | 9 months agoMay 20, 2025 |
| [SymbolsFromPDB](https://github.com/TheCruZ/kdmapper/tree/master/SymbolsFromPDB "SymbolsFromPDB") | [SymbolsFromPDB](https://github.com/TheCruZ/kdmapper/tree/master/SymbolsFromPDB "SymbolsFromPDB") | [Extra message to help users](https://github.com/TheCruZ/kdmapper/commit/7bdefced12d82c655581151fbb78d27c0570496e "Extra message to help users") | 9 months agoMay 14, 2025 |
| [kdmapper](https://github.com/TheCruZ/kdmapper/tree/master/kdmapper "kdmapper") | [kdmapper](https://github.com/TheCruZ/kdmapper/tree/master/kdmapper "kdmapper") | [Clarify](https://github.com/TheCruZ/kdmapper/commit/9892b48e30a2ffcbd4d360e4b4c0b8f50189a4fe "Clarify") | 2 months agoDec 22, 2025 |
| [.gitignore](https://github.com/TheCruZ/kdmapper/blob/master/.gitignore ".gitignore") | [.gitignore](https://github.com/TheCruZ/kdmapper/blob/master/.gitignore ".gitignore") | [Symbols refactor...](https://github.com/TheCruZ/kdmapper/commit/19e12cf63ad53418333bdd28fe25a0bf957ca3b9 "Symbols refactor...") | last yearFeb 8, 2025 |
| [HelloWorld.sys](https://github.com/TheCruZ/kdmapper/blob/master/HelloWorld.sys "HelloWorld.sys") | [HelloWorld.sys](https://github.com/TheCruZ/kdmapper/blob/master/HelloWorld.sys "HelloWorld.sys") | [Fixed BSOD with Cleaning of g\_KernelHashBucketList, Fixed BSOD with C…](https://github.com/TheCruZ/kdmapper/commit/ca8cfe8e61506b26430176663632c0c9b65a3dda "Fixed BSOD with Cleaning of g_KernelHashBucketList, Fixed BSOD with Cleaning of MmUnloadedDrivers, Improved the race condition of the system hook hooking NtAddAtom") | 5 years agoJun 24, 2021 |
| [LICENSE](https://github.com/TheCruZ/kdmapper/blob/master/LICENSE "LICENSE") | [LICENSE](https://github.com/TheCruZ/kdmapper/blob/master/LICENSE "LICENSE") | [Create LICENSE](https://github.com/TheCruZ/kdmapper/commit/cd8512335dd0fdbe955c8adc819ead9396dca793 "Create LICENSE") | 6 years agoJan 21, 2021 |
| [README.MD](https://github.com/TheCruZ/kdmapper/blob/master/README.MD "README.MD") | [README.MD](https://github.com/TheCruZ/kdmapper/blob/master/README.MD "README.MD") | [Update README.MD](https://github.com/TheCruZ/kdmapper/commit/833a684bf9ac897e2bd973b51071acee4adbb829 "Update README.MD") | 4 months agoOct 20, 2025 |
| [kdmapper.sln](https://github.com/TheCruZ/kdmapper/blob/master/kdmapper.sln "kdmapper.sln") | [kdmapper.sln](https://github.com/TheCruZ/kdmapper/blob/master/kdmapper.sln "kdmapper.sln") | [PDB Offset PR adjustments](https://github.com/TheCruZ/kdmapper/commit/2c98eb1165fd1f55ebf238d2dcfb66076ac68e3d "PDB Offset PR adjustments") | last yearJan 9, 2025 |
| View all files |

## Repository files navigation

# KDMapper

[Permalink: KDMapper](https://github.com/TheCruZ/kdmapper#kdmapper)

KDMapper is a simple tool that exploits iqvw64e.sys Intel driver to manually map non-signed drivers in memory

Tested from **Windows 10 1607** to **Windows 11 25H2 26200.6899** ✔️

**Note:** Add definition **DISABLE\_OUTPUT** to remove all console outputs

**Note:** Is recommended set a custom entry point like in the HelloWorld example

## Parameters:

[Permalink: Parameters:](https://github.com/TheCruZ/kdmapper#parameters)

```
--copy-header to enable the copy driver header option by commandline
--free to automatically unmap the allocated memory
--indPages to map in allocated independent pages
--PassAllocationPtr to pass allocation ptr as first param
[PDB offset based build only]:
--offsetsPath "FilePath" to include your own offsets file path (by default .\offsets.ini)(if FilePath contains spaces, it must be enclosed in quotation marks)
--dontUpdateOffsets to execute without updating the offsets file (warning: you have to be sure that the offsets are not outdated to your current windows build, or you risk a potential BSOD)
```

## Features:

[Permalink: Features:](https://github.com/TheCruZ/kdmapper#features)

```
Works with /GS- compiled drivers
Hooks NtAddAtom which exists everywhere and is rarely called
Clears MmUnloadedDrivers
Clears PiDDBCacheTable
Clears g_KernelHashBucketList
Clears Wdfilter RuntimeDriverList RuntimeDriverCount and RuntimeDriverArry
Use NtLoadDriver and NtUnloadDriver for less traces
Prevent load if \Device\Nal exists (Prevents BSOD)
Header section skipped while copying driver to kernel
Added the possibility to modify params before call driver entry
Added PDB_OFFSETS macro that will allow the use of Offset PDB features (choose the target build)
Introduced new project "SymbolsFromPDB" that will help KDMapper to adapt quickly to any windows updates by parsing the target .PDB files (PDB_OFFSETS macro must be defined to use this feature)
```

## Building:

[Permalink: Building:](https://github.com/TheCruZ/kdmapper#building)

- Install Visual Studio: [https://visualstudio.microsoft.com/downloads/](https://visualstudio.microsoft.com/downloads/)
- Install Windows SDK: [https://developer.microsoft.com/windows/downloads/windows-sdk/](https://developer.microsoft.com/windows/downloads/windows-sdk/)
- Install Windows WDK: [https://learn.microsoft.com/windows-hardware/drivers/download-the-wdk](https://learn.microsoft.com/windows-hardware/drivers/download-the-wdk)
- Open the solution
- Choose target build eg. Release
- Build

## Requirements:

[Permalink: Requirements:](https://github.com/TheCruZ/kdmapper#requirements)

- Return from driver entry fastest as you can to prevent unexpected calls or patch guard, don't ever create a infinite while loop in the driver entry, create a thread or any other procedure to keep code running (if you can't close kdmapper you are doing it wrong)
- Disable vulnerable driver list if enabled [https://support.microsoft.com/en-au/topic/kb5020779-the-vulnerable-driver-blocklist-after-the-october-2022-preview-release-3fcbe13a-6013-4118-b584-fcfbc6a09936](https://support.microsoft.com/en-au/topic/kb5020779-the-vulnerable-driver-blocklist-after-the-october-2022-preview-release-3fcbe13a-6013-4118-b584-fcfbc6a09936)

## Common issues

[Permalink: Common issues](https://github.com/TheCruZ/kdmapper#common-issues)

### BSOD with a simple driver

[Permalink: BSOD with a simple driver](https://github.com/TheCruZ/kdmapper#bsod-with-a-simple-driver)

In DriverEntry, **DriverObject and RegistryPath** are **NULL** unless you specify anything! this is a manual mapped driver and **not a normal loading procedure**

### Error \\Device\\Nal is already in use.

[Permalink: Error \Device\Nal is already in use.](https://github.com/TheCruZ/kdmapper#error-devicenal-is-already-in-use)

This means that there is a intel driver already loaded or another instance of kdmapper is running or kdmapper crashed and didn't unload the previous driver.

If you are sure that there is no other instance of kdmapper running, you can try to restart your computer to fix this issue.

If the problem persists, you can try to unload the intel driver manually (If the driver was loaded with kdmapper will have a random name and will be located in %temp%), if not, the driver name is iqvw64e.sys and is installed with your network drivers.

### Errors 0xC0000022 and 0xC000009A:

[Permalink: Errors 0xC0000022 and 0xC000009A:](https://github.com/TheCruZ/kdmapper#errors-0xc0000022-and-0xc000009a)

Both are usually caused by FACEIT AC or other Antivirus/AntiCheat

**Note:** Some AntiCheats will keep running even if the game is not open

**Note:** Some Antivirus will keep blocking this even if you disabled them

### Error 0xC0000603:

[Permalink: Error 0xC0000603:](https://github.com/TheCruZ/kdmapper#error-0xc0000603)

The certificate has been blocked as vulnerable and the mapper will return a status of STATUS\_IMAGE\_CERT\_REVOKED. More info at [Microsoft](https://support.microsoft.com/en-au/topic/kb5020779-the-vulnerable-driver-blocklist-after-the-october-2022-preview-release-3fcbe13a-6013-4118-b584-fcfbc6a09936)

If you want to disable your vulnerable driver list you have to open regedit.exe, go to HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\CI\\Config and set 'VulnerableDriverBlocklistEnable' as dword with value 0 and restart to apply the changes
Alternativelty check this [Microsoft](https://support.microsoft.com/en-us/topic/kb5020779-the-vulnerable-driver-blocklist-after-the-october-2022-preview-release-3fcbe13a-6013-4118-b584-fcfbc6a09936)

## Creators and contributors

[Permalink: Creators and contributors](https://github.com/TheCruZ/kdmapper#creators-and-contributors)

Original creator [https://github.com/z175](https://github.com/z175)

Updated and improved by [https://github.com/TheCruZ](https://github.com/TheCruZ)

Initial PDB offsets parser written by [https://github.com/Mohi-eddine](https://github.com/Mohi-eddine)

Some code cleaning [https://github.com/tihomirocrew](https://github.com/tihomirocrew)

Have Fun!!

## About

KDMapper is a simple tool that exploits iqvw64e.sys Intel driver to manually map non-signed drivers in memory


### Resources

[Readme](https://github.com/TheCruZ/kdmapper#readme-ov-file)

### License

[MIT license](https://github.com/TheCruZ/kdmapper#MIT-1-ov-file)

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/TheCruZ/kdmapper).

[Activity](https://github.com/TheCruZ/kdmapper/activity)

### Stars

[**2.8k**\\
stars](https://github.com/TheCruZ/kdmapper/stargazers)

### Watchers

[**42**\\
watching](https://github.com/TheCruZ/kdmapper/watchers)

### Forks

[**613**\\
forks](https://github.com/TheCruZ/kdmapper/forks)

[Report repository](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FTheCruZ%2Fkdmapper&report=TheCruZ+%28user%29)

## [Releases](https://github.com/TheCruZ/kdmapper/releases)

No releases published

## [Packages\  0](https://github.com/users/TheCruZ/packages?repo_name=kdmapper)

No packages published

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/TheCruZ/kdmapper).

## [Contributors\  15](https://github.com/TheCruZ/kdmapper/graphs/contributors)

- [![@TheCruZ](https://avatars.githubusercontent.com/u/23271181?s=64&v=4)](https://github.com/TheCruZ)
- [![@Mohi-eddine](https://avatars.githubusercontent.com/u/73481411?s=64&v=4)](https://github.com/Mohi-eddine)
- [![@llxiaoyuan](https://avatars.githubusercontent.com/u/36320938?s=64&v=4)](https://github.com/llxiaoyuan)
- [![@tihomirocrew](https://avatars.githubusercontent.com/u/90578343?s=64&v=4)](https://github.com/tihomirocrew)
- [![@Jerem584](https://avatars.githubusercontent.com/u/31523935?s=64&v=4)](https://github.com/Jerem584)
- [![@gykkuo](https://avatars.githubusercontent.com/u/48140624?s=64&v=4)](https://github.com/gykkuo)
- [![@werw58](https://avatars.githubusercontent.com/u/67709902?s=64&v=4)](https://github.com/werw58)
- [![@Aeterts](https://avatars.githubusercontent.com/u/83576568?s=64&v=4)](https://github.com/Aeterts)
- [![@KING-UTKARSH](https://avatars.githubusercontent.com/u/129024073?s=64&v=4)](https://github.com/KING-UTKARSH)
- [![@blobbyblo](https://avatars.githubusercontent.com/u/11258511?s=64&v=4)](https://github.com/blobbyblo)
- [![@daniel-dron](https://avatars.githubusercontent.com/u/19430633?s=64&v=4)](https://github.com/daniel-dron)
- [![@GabrielBigardi](https://avatars.githubusercontent.com/u/42253181?s=64&v=4)](https://github.com/GabrielBigardi)
- [![@NotDiscordOfficial](https://avatars.githubusercontent.com/u/83149379?s=64&v=4)](https://github.com/NotDiscordOfficial)
- [![@RadonCoding](https://avatars.githubusercontent.com/u/86915746?s=64&v=4)](https://github.com/RadonCoding)
- [![@dalion971](https://avatars.githubusercontent.com/u/123962912?s=64&v=4)](https://github.com/dalion971)

## Languages

- [C++100.0%](https://github.com/TheCruZ/kdmapper/search?l=c%2B%2B)

You can’t perform that action at this time.