Title:
Automating binary vulnerability discovery with Ghidra and Semgrep

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post describes a workflow to speed up vulnerability research on closed-source binaries using static analysis automation.  
- It introduces two Ghidra scripts: **Rhabdomancer** (finds calls to potentially insecure APIs and annotates candidate hotspots) and **Haruspex** (bulk-exports Ghidra decompiler pseudocode into files suitable for IDE browsing and downstream tooling).  
- The exported pseudocode is then scanned with **Semgrep** using a custom C/C++ ruleset to flag likely bug patterns (e.g., unsafe string handling, format strings).  
- The approach is demonstrated by (re)discovering real vulnerabilities in Zyxel USG’s `zysh` binary, including memory corruption issues (CVE-2022-26531) and discussing limits for detecting command injection (CVE-2022-26532).  
- It’s useful for vulnerability researchers, reverse engineers, and red teamers auditing firmware/appliances where source code is unavailable, and it highlights where automation helps vs. where manual context is still required.

Technical Focus:
- Ghidra scripting (Java) for automated triage
- Decompiler pseudocode extraction and normalization
- Semgrep pattern-based static analysis on decompiled output
- Hotspot identification via insecure API call tracing/backtracing
- Bug classes: buffer overflow, format string, command injection
- Closed-source firmware/appliance vulnerability research

Use Cases:
- Rapidly triage large binaries by enumerating “dangerous” libc/API call sites
- Export decompiler output to an IDE for scalable review and navigation
- Run Semgrep rules against decompiled pseudocode to find likely vulnerability patterns
- Reproduce/validate known CVEs in embedded/network appliance binaries
- Build a repeatable static-analysis pipeline for binary auditing engagements

Keywords:
Ghidra, Ghidra scripting, decompiler pseudocode, Semgrep, static analysis, binary auditing, closed-source, C/C++, insecure APIs, strcpy, strcat, sprintf, scanf, fscanf, format string, buffer overflow, command injection, firmware analysis, Zyxel USG, zysh, CVE-2022-26531, CVE-2022-26532, GTFObins, tcpdump