Title:
Methodology of Reversing Vulnerable Killer Drivers

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post outlines a practical methodology for reverse engineering “vulnerable killer” Windows kernel drivers—signed drivers that expose functionality attackers can abuse to terminate arbitrary processes.  
- It focuses on identifying user-mode reachable attack surfaces by locating device creation (IoCreateDevice/IoCreateSymbolicLink), dispatch tables (DriverObject->MajorFunctions), and the IRP_MJ_DEVICE_CONTROL handler that processes IOCTLs.  
- Using IDA Free, it walks through tracing imports and cross-references to sensitive routines like ZwTerminateProcess/ZwOpenProcess, then backtracking to the IOCTL value and input structure needed to reach the vulnerable code path.  
- Two example drivers are analyzed (TrueSight.sys and Ksapi64.sys), including extracting an IOCTL (e.g., 0x22E044 for TrueSight) and demonstrating a simple user-mode PoC that sends a PID via DeviceIoControl to kill a process.  
- It also highlights defensive considerations: lack of access control/validation, the impact on critical processes and EDR components, and how poor design can bypass Protected Process Light (PPL) expectations.  
- Useful for red teamers/pentesters and malware analysts studying BYOVD-style abuse, and for defenders/driver developers looking to understand and mitigate these patterns.

Technical Focus:
- Windows kernel driver reversing (DriverEntry, dispatch routines, IRP handling)
- Device objects and symbolic links (IoCreateDevice, IoCreateSymbolicLink)
- IOCTL discovery and IRP_MJ_DEVICE_CONTROL analysis
- Process termination primitives (ZwOpenProcess, ZwTerminateProcess)
- BYOVD / “killer driver” abuse patterns
- PPL (Protected Process Light) and driver-side validation/access control

Use Cases:
- Reverse engineer signed vulnerable drivers to identify exploitable IOCTLs
- Build minimal PoCs to validate process-kill primitives exposed by drivers
- Map BYOVD tradecraft used to disable EDR/security tooling
- Create detection logic around suspicious device access + IOCTL usage
- Guide secure driver design (IOCTL ACLs, PID validation, PPL-aware checks)

Keywords:
BYOVD, vulnerable driver, killer driver, Windows kernel, TrueSight.sys, Ksapi64.sys, loldrivers.io, IDA Free, DriverEntry, IoCreateDevice, IoCreateSymbolicLink, IRP_MJ_DEVICE_CONTROL, MajorFunctions, IOCTL, DeviceIoControl, CreateFileA, ZwTerminateProcess, ZwOpenProcess, Protected Process Light, PPL, EDR tampering