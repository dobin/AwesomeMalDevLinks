Title:
Exploring malicious Windows drivers (Part 1): Introduction to the kernel and drivers

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post is the first in a Talos series aimed at lowering the barrier to analyzing malicious Windows kernel drivers.  
- It explains foundational Windows kernel concepts (user mode vs. kernel mode, virtual address space separation, protection rings) and how user-mode APIs transition into kernel execution via syscalls.  
- The article introduces key kernel components relevant to driver behavior (executive “manager” subsystems, HAL) and why kernel drivers are high-impact and high-risk (shared kernel address space, BSOD on faults).  
- It walks through driver fundamentals: what drivers are (.sys), packaging (INF/CAT), driver models (WDM vs. WDF/KMDF/UMDF), and core required routines (DriverEntry, dispatch routines, unload).  
- It also frames how drivers communicate with user mode via device objects, symbolic links, IRP major function codes, and the I/O manager/IRP model.  
- Useful for malware analysts, reverse engineers, and defenders starting kernel-mode driver analysis, as well as red teamers wanting to understand driver-based tradecraft and detection surfaces.

Technical Focus:
- Windows kernel architecture (Ring 0 vs Ring 3, syscalls, SSDT/KiSystemCall64)
- Executive layer managers (Object, Memory, Process/Thread, Registry/Config, I/O, PnP, Power)
- Driver development models (WDM vs WDF; KMDF/UMDF)
- Driver lifecycle routines (DriverEntry, AddDevice, dispatch, unload)
- Windows I/O model (IRPs, IRP_MJ_* major function codes, I/O manager)
- Device objects and symbolic links (IoCreateDevice, IoCreateSymbolicLink)

Use Cases:
- Onboarding material for reversing and triaging suspicious .sys drivers
- Mapping observed driver behavior to IRP handlers and I/O pathways during analysis
- Understanding kernel attack surface leveraged by malicious/vulnerable drivers
- Building minimal test drivers to learn debugging, IRP handling, and device interfaces
- Informing defensive monitoring around driver load, device creation, and IOCTL/IRP activity (expanded in later parts)

Keywords:
Windows kernel, kernel-mode driver, user mode, Ring 0, Ring 3, syscall, ntdll, NtOpenProcess, KiSystemCall64, SSDT, executive layer, Object Manager, Memory Manager, I/O Manager, HAL, hal.dll, WDM, WDF, KMDF, UMDF, WDK, DRIVER_OBJECT, DEVICE_OBJECT, DriverEntry, IRP, IRP_MJ_CREATE, IRP_MJ_DEVICE_CONTROL, IoCreateDevice, IoCreateSymbolicLink, IoCompleteRequest, NTSTATUS, INF, CAT file