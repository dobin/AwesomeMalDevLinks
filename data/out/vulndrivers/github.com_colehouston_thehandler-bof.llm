Title:
theHandler-BOF

Type:
GitHub Tool

Short Summary (4–8 sentences max):
- theHandler-BOF is a Cobalt Strike Beacon Object File (BOF) that dumps process memory (minidumps) from protected targets by manipulating kernel handle objects.  
- It uses a Bring Your Own Vulnerable Driver (BYOVD) approach (public release leverages Dell’s dbutil_2_3.sys, CVE-2021-21551) to gain kernel read/write and then tamper with process handle access to bypass PPL-style restrictions.  
- The tool supports “elevate handle” (increase access on an existing low-priv handle) and a “decoy PID” mode (tamper with a benign process handle to access the real target).  
- Dumps are encrypted and intended to be downloaded filelessly via Beacon, with a provided Python script to decrypt the minidump afterward (disk-based dumping is also supported; fileless is noted as WIP for large dumps).  
- It includes a kernel offset table for multiple Windows builds and warns about BSOD risk due to kernel memory R/W, with build-check functionality for compatibility.  
- Useful primarily for red teams/pentesters performing credential access (e.g., LSASS dumping) on systems where user-mode dumping is blocked, and for defenders studying BYOVD/PPL bypass tradecraft.

Technical Focus:
- BYOVD via vulnerable kernel driver (dbutil_2_3.sys) and CVE-2021-21551
- Kernel handle object manipulation / access mask tampering
- PPL bypass for protected process memory dumping
- Minidump creation, encryption, and post-processing (decryptMinidump.py)
- Windows build/offset management (kernel structure offsets, Vergilius-based tables)
- Operational constraints: VBS/HVCI driver block list interactions, stability/BSOD considerations

Use Cases:
- Dump LSASS or other protected processes for offline credential extraction
- Bypass user-mode EDR protections by performing handle escalation in kernel space
- Red team tradecraft development/testing around BYOVD and PPL bypass methods
- Defensive research: reproduce and detect kernel-handle tampering and vulnerable-driver abuse
- Lab validation of Microsoft driver block list/VBS-HVCI impact on BYOVD techniques

Keywords:
BYOVD, BOF, Cobalt Strike, PPL, Protected Process Light, LSASS, minidump, handle table, kernel handle, access mask, kernel read/write, dbutil_2_3.sys, Dell driver, CVE-2021-21551, VBS, HVCI, Microsoft driver block list, Windows kernel offsets, Vergilius Project, credential dumping