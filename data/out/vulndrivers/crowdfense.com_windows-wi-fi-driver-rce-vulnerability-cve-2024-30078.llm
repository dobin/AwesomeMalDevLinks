Title:
Windows Wi‑Fi Driver RCE Vulnerability – CVE‑2024‑30078

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post reverse engineers Microsoft’s June 2024 fix for CVE‑2024‑30078 in the Windows `nwifi.sys` Wi‑Fi NDIS filter driver on Windows 11 23H2.  
- The authors use binary diffing to pinpoint a missing length check in `Dot11Translate80211ToEthernetNdisPacket()` when parsing VLAN-tagged (802.1Q) frames after an LLC/SNAP header.  
- The bug can lead to an out-of-bounds read and a constrained out-of-bounds write during 802.11→Ethernet header translation, reachable in both AP and STA paths (they focus on STA).  
- They validate reachability and behavior with WinDbg and over-the-air packet injection using a Python/Scapy fake AP, showing the overwrite depends on uncontrolled bytes beyond the packet buffer passing `tpid`/`vlanid` checks.  
- The conclusion argues practical exploitability is low: the overwrite is tiny, highly layout-dependent, and likely lands in an unhelpful adapter-allocated buffer, with no clear path to control-flow hijack without an additional info leak.  
- Useful for Windows kernel/driver researchers, exploit developers assessing N-day viability, and defenders wanting to understand root cause and trigger conditions.

Technical Focus:
- Windows `nwifi.sys` NDIS filter driver internals and receive path (`Pt6Receive`, NBL/MDL handling)
- Binary diffing (BinDiff) and patch analysis of kernel drivers
- 802.11 data frame translation to Ethernet, LLC/SNAP parsing, VLAN (802.1Q) handling
- Out-of-bounds read/write conditions from missing bounds checks
- Over-the-air packet crafting via fake AP (Scapy, Radiotap/Dot11)
- Kernel debugging/validation with WinDbg and memory/pool inspection

Use Cases:
- Assessing CVE‑2024‑30078 exploitability and required preconditions in real Wi‑Fi environments
- Building PoCs to reproduce driver parsing bugs with crafted 802.11/LLC/VLAN frames
- Developing detection ideas around malformed VLAN-tagged Wi‑Fi data frames (lab validation)
- Training/research on Windows networking driver stacks (NBL/MDL) and patch diff workflows

Keywords:
CVE-2024-30078, nwifi.sys, Windows 11 23H2, NDIS filter driver, Dot11Translate80211ToEthernetNdisPacket, Pt6Receive, NET_BUFFER_LIST, MDL, ExtSTAReceivePacket, IEEE 802.11, Radiotap, LLC, SNAP, IEEE 802.1Q, VLAN TPID 0x8100, out-of-bounds read, out-of-bounds write, BinDiff, WinDbg, Scapy fake AP