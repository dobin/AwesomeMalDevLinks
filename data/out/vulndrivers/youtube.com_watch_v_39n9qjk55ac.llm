Title:
Exploiting The Core: A Deep Dive Into Kernel Driver Vulnerability Hunting

Type:
Conference Talk

Short Summary (4–8 sentences max):
This talk is a primer on hunting vulnerabilities in Windows kernel-mode drivers, with emphasis on device drivers exposed to user-mode via IOCTLs. It explains why kernel driver bugs are high-impact (privilege escalation, EDR/AV tampering, system-wide compromise) and highlights the rise of BYOVD-style abuse. The speaker summarizes Northwave’s driver research pipeline (collecting ~5,000 drivers, filtering, manually analyzing ~80, finding 35 vulns across 24 drivers) and provides practical guidance for selecting and loading drivers for analysis. The technical deep dive covers driver structure (DriverEntry, dispatch routines, IRPs), how to locate device objects, and how user-mode interacts via CreateFile/DeviceIoControl. Common bug classes are demonstrated, including “dangerous legitimate functionality” (arbitrary kernel R/W, process termination, physical memory mapping), memory corruption, info leaks, handle leaks, and TOCTOU issues with METHOD_DIRECT IOCTLs. It closes with automation pointers (Popcorn and VMware TAU tooling) to triage drivers for interesting primitives.

Technical Focus:
- Windows kernel driver architecture (DriverEntry, dispatch tables, IRP handling)
- IOCTL interface analysis (DeviceIoControl codes, METHOD_* transfer types, SystemBuffer semantics)
- Vulnerability patterns in drivers (arbitrary R/W, process kill, MmMapIoSpace abuse)
- Memory corruption & info leaks (heap overflow, uninitialized kernel memory disclosure)
- Kernel object/handle security (kernel handle leaks, OBJ_KERNEL_HANDLE)
- Driver collection/filtering and automated triage (Popcorn, VMware TAU scripts)

Use Cases:
- Identify privilege escalation primitives in third-party Windows drivers
- Find BYOVD candidates for EDR/AV tampering (e.g., process termination, kernel memory access)
- Build a driver corpus and prioritize targets via signature/access-control filtering
- Reverse engineer IOCTL handlers to map attack surface and fuzz/test inputs
- Detect and validate kernel info leaks to defeat mitigations (e.g., KASLR support primitives)

Keywords:
Windows kernel, kernel-mode driver, IOCTL, DeviceIoControl, IRP, dispatch routine, DriverEntry, device object, CreateFile, METHOD_DIRECT, SystemBuffer, privilege escalation, BYOVD, EDR bypass, arbitrary read/write, MmMapIoSpace, TerminateProcess, OpenProcess, heap overflow, uninitialized memory leak, OBJ_KERNEL_HANDLE, Popcorn, VMware Threat Analysis Unit, reverse engineering, IDA Pro