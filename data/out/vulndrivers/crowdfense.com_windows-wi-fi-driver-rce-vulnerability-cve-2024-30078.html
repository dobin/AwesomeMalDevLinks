# https://www.crowdfense.com/windows-wi-fi-driver-rce-vulnerability-cve-2024-30078/

<!DOCTYPE html><html class="wf-loading wf-urbanist-n4-loading wf-urbanist-n5-loading wf-urbanist-n6-loading wf-urbanist-n7-loading wf-urbanist-n8-loading wf-poppins-n4-loading wf-poppins-n6-loading wf-poppins-n7-loading js_active  vc_desktop  vc_transform  vc_transform  webkit chrome linux js" lang="en-US">
	<body class="wp-singular post-template-default single single-post postid-2756 single-format-standard wp-embed-responsive wp-theme-porto cookies-not-set porto-rounded porto-breadcrumbs-bb full blog-1 wpb-js-composer js-comp-ver-8.1 vc_responsive" style="--porto-scroll-w: 15px;">
	<div class="loading-overlay"><div class="bounce-loader"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div></div>
	<div class="page-wrapper"><!-- page wrapper -->
		
											<!-- header wrapper -->
				<div class="header-wrapper">
										


									</div>
				<!-- end header wrapper -->
			
			
					<section class="page-top page-header-1">
	<div class="container">
	<div class="row">
		<div class="col-lg-12">
						<div class="page-title-wrap">
								<h1 class="page-title">Windows Wi-Fi Driver RCE Vulnerability – CVE-2024-30078</h1>
							</div>
					</div>
	</div>
</div>
	</section>
	
		<div id="main" class="column1 boxed"><!-- main -->

			<div class="container">
			<div class="row main-content-wrap">

			<!-- main content -->
			<div class="main-content col-lg-12">

			
<div id="content" role="main" class="porto-single-page">

	
			
<article class="post-large post-2756 post type-post status-publish format-standard has-post-thumbnail hentry category-kernel category-vulnerability-research category-windows tag-cve-2024-30078 tag-exploitation tag-kernel tag-oob-write tag-rce tag-reverse-engineering tag-vulnerability-research tag-wi-fi tag-windows">

		<div class="post-image single">
		<div class="post-slideshow porto-carousel owl-carousel has-ccols ccols-1 nav-inside nav-inside-center nav-style-2 show-nav-hover owl-loaded owl-drag" data-plugin-options="{&quot;nav&quot;:true}">
											
								<div class="owl-stage-outer"><div class="owl-stage" style="transform: translate3d(0px, 0px, 0px); transition: all; width: 1888px;"><div class="owl-item active" style="width: 1888px;"><div>
								<div class="img-thumbnail">
						<img width="1140" height="445" src="https://www.crowdfense.com/wp-content/uploads/2024/07/evil-wifi-1140x445.jpeg" class="owl-lazy img-responsive" alt="" decoding="async" fetchpriority="high">											</div>
								</div></div></div></div><div class="owl-nav disabled"><button type="button" aria-label="Owl carousel Navigation" role="button" class="owl-prev disabled"></button><button type="button" aria-label="Owl carousel Navigation" role="button" class="owl-next disabled"></button></div><div class="owl-dots disabled"><button aria-label="Owl Carousel Pagination" role="button" class="owl-dot active"><span></span></button></div></div>
		
			</div>
	
			<div class="post-date">
			<span class="day">01</span><span class="month">Aug</span><time datetime="2024-08-01">August 1, 2024</time>		</div>
	
	<div class="post-content">
					<h2 class="entry-title">Windows Wi-Fi Driver RCE Vulnerability – CVE-2024-30078</h2>
				<span class="vcard" style="display: none;"><span class="fn"><a href="https://www.crowdfense.com/author/aleksandr-koshelev/" title="Posts by aleksandr.k" rel="author" itemprop="author" itemscope="itemscope" itemtype="https://schema.org/Person">aleksandr.k</a>, <a href="https://www.crowdfense.com/author/paolo-s/" title="Posts by voidsec" rel="author" itemprop="author" itemscope="itemscope" itemtype="https://schema.org/Person">voidsec</a></span></span><span class="updated" style="display:none">2024-09-05T09:38:12+04:00</span>
		<!-- Post meta before content -->
		
<div class="post-meta ">
				<span class="meta-author">
					<i class="far fa-user"></i>
							<span>By</span>
					<a href="https://www.crowdfense.com/author/aleksandr-koshelev/" title="Posts by aleksandr.k" rel="author" itemprop="author" itemscope="itemscope" itemtype="https://schema.org/Person">aleksandr.k</a>, <a href="https://www.crowdfense.com/author/paolo-s/" title="Posts by voidsec" rel="author" itemprop="author" itemscope="itemscope" itemtype="https://schema.org/Person">voidsec</a>		</span>
				
	
	</div>

		<div class="entry-content">
			<span class="span-reading-time rt-reading-time" style="display: block;"><span class="rt-label rt-prefix">Reading Time: </span> <span class="rt-time"> 10</span> <span class="rt-label rt-postfix">minutes</span></span><p>In June, during “Patch Tuesday”, Microsoft released a fix for <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30078" target="_blank" rel="noopener">CVE-2024-30078</a>. The severity of this vulnerability was marked as important, with its impact set to Remote Code Execution (RCE).</p>
<p>After reading Microsoft’s bulletin, this vulnerability piqued our interest. It seemed plausible for an unauthenticated attacker to send a malicious packet to an adjacent system, which could enable remote code execution. Even if an attacker must be within proximity of the target system to send and receive radio transmissions to exploit this vulnerability, an over-the-air RCE seemed too cool to skip.</p>
<p>Our analysis was performed under Windows 11, Version 23H2.</p>
<div id="ez-toc-container" class="ez-toc-v2_0_80 counter-hierarchy ez-toc-counter ez-toc-grey ez-toc-container-direction">
<div class="ez-toc-title-container">
<p class="ez-toc-title" style="cursor:inherit">Table of Contents</p>
<span class="ez-toc-title-toggle"><a href="https://www.crowdfense.com/windows-wi-fi-driver-rce-vulnerability-cve-2024-30078/#" class="ez-toc-pull-right ez-toc-btn ez-toc-btn-xs ez-toc-btn-default ez-toc-toggle ez-toc-loaded" aria-label="Toggle Table of Content"><span class="ez-toc-js-icon-con"><span class=""><span class="eztoc-hide" style="display:none;">Toggle</span><span class="ez-toc-icon-toggle-span"><svg style="fill: #999;color:#999" xmlns="http://www.w3.org/2000/svg" class="list-377408" width="20px" height="20px" viewBox="0 0 24 24" fill="none"><path d="M6 6H4v2h2V6zm14 0H8v2h12V6zM4 11h2v2H4v-2zm16 0H8v2h12v-2zM4 16h2v2H4v-2zm16 0H8v2h12v-2z" fill="currentColor"></path></svg><svg style="fill: #999;color:#999" class="arrow-unsorted-368013" xmlns="http://www.w3.org/2000/svg" width="10px" height="10px" viewBox="0 0 24 24" version="1.2" baseProfile="tiny"><path d="M18.2 9.3l-6.2-6.3-6.2 6.3c-.2.2-.3.4-.3.7s.1.5.3.7c.2.2.4.3.7.3h11c.3 0 .5-.1.7-.3.2-.2.3-.5.3-.7s-.1-.5-.3-.7zM5.8 14.7l6.2 6.3 6.2-6.3c.2-.2.3-.5.3-.7s-.1-.5-.3-.7c-.2-.2-.4-.3-.7-.3h-11c-.3 0-.5.1-.7.3-.2.2-.3.5-.3.7s.1.5.3.7z"></path></svg></span></span></span></a></span></div>
</div>
<h2><span class="ez-toc-section" id="binary-diffing" ez-toc-data-id="#binary-diffing"></span>Binary Diffing<span class="ez-toc-section-end"></span></h2>
<p>The vulnerability is located in the <code>nwifi.sys</code> Wi-Fi driver. We used <a href="https://www.zynamics.com/bindiff.html" target="_blank" rel="noopener">BinDiff</a> to compare the two versions of this driver:</p>
<ul>
<li>V.10.0.22621.3527 – vulnerable: <code>SHA1 788E6FD6D60F3CD5A6FAC5C14883A4A3EF53A355</code></li>
<li>V.10.0.22621.3733 – patched: <code>SHA1 BF5871100143804B77185314BD4DD433AFAC816B</code></li>
</ul>
<p>The patch was applied in the function named <code>Dot11Translate80211ToEthernetNdisPacket() </code>:</p>
<p><img decoding="async" class="aligncenter wp-image-2758 size-full" src="https://www.crowdfense.com/wp-content/uploads/2024/07/picture_1.png" alt="" width="998" height="874"></p>
<p>In the patched version, the following additional check has been added:</p>
<p><img decoding="async" class="aligncenter wp-image-2771 size-full" src="https://www.crowdfense.com/wp-content/uploads/2024/07/picture_14.png" alt="" width="589" height="29"></p>
<h2><span class="ez-toc-section" id="call-graph" ez-toc-data-id="#call-graph"></span>Call Graph<span class="ez-toc-section-end"></span></h2>
<p>In the call graph of the <code>Dot11Translate80211ToEthernetNdisPacket()</code> function, we can see how the vulnerable function is reachable from both Access Point (AP) and Station (STA) mode.</p>
<p><img loading="lazy" decoding="async" class="aligncenter wp-image-2768 size-full" src="https://www.crowdfense.com/wp-content/uploads/2024/07/picture_11.png" alt="" width="502" height="578"></p>
<p><strong>Please Note:</strong> here, IDA’s graph is not right as the <code>ExtSTAReceivePacket()</code> function is not directly called but just referenced.</p>
<p><strong>Access Point Mode (AP)</strong>: this is also known as hotspot mode. In this mode, the Wi-Fi module acts as an access point, similar to a router’s functionality. It creates a wireless network, allowing other devices to connect to it.</p>
<p><strong>Station Mode (STA)</strong>: STA mode allows the device to connect to an existing wireless network. It turns the device into a client of an existing wireless network, enabling access to the Internet or communication with other devices. In STA mode, the device becomes a node on the network, facilitating data exchange and communication with other devices.</p>
<p>We decided to focus on the STA path as it’s more interesting for our use case.</p>
<h2><span class="ez-toc-section" id="static-analysis" ez-toc-data-id="#static-analysis"></span>Static analysis<span class="ez-toc-section-end"></span></h2>
<p>The <code>nwifi.sys</code> driver is an <a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/network/ndis-filter-drivers" target="_blank" rel="noopener">NDIS Filter Driver</a>. It is placed in the driver stack between protocol drivers and miniport drivers. Its intended usage is to monitor and modify (if needed) packets coming from or to the Wi-Fi and pass them to the next driver in the stack.</p>
<p>The driver has to register callbacks with the <code>NdisFRegisterFilterDriver()</code> routine. The most interesting callbacks are the <code>AttachHandler</code> and <code>ReceiveNetBufferListsHandler</code>.<br>
The <code>ReceiveNetBufferListsHandler</code> callback in this driver is present in the <code>Pt6Receive()</code> function; it receives packets from the underlying drivers.</p>
<p>Even if, for some reason, IDA does not show this in the function graph above, we could verify it dynamically in WinDbg. The actual call stack looks like this:</p>
<p><img loading="lazy" decoding="async" class="aligncenter wp-image-2769 size-full" src="https://www.crowdfense.com/wp-content/uploads/2024/07/picture_12.png" alt="" width="742" height="430"></p>
<p><code>Pt6Receive()</code> receives a pointer to a <code>NET_BUFFER_LIST</code> structure (NBL) that consists of our packet. It then calls the <code>ExtSTARecvInitializeMSDUFromNBL()</code> function in order to convert the NBL structure to a structure called MSDU.</p>
<p>The <code>MSDU</code> structure looks like the following snippet:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-cpp enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-k2">struct</span><span class="enlighter-text"> MSDU_struct </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-k5">uint64_t</span><span class="enlighter-text"> info6;</span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-k5">char</span><span class="enlighter-text"> flags;</span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-k5">uint32_t</span><span class="enlighter-text"> llc_offset;</span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-k5">uint32_t</span><span class="enlighter-text"> data_length;</span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-k5">uint32_t</span><span class="enlighter-text"> field_14;</span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-k5">uint64_t</span><span class="enlighter-text"> data_begin;</span></div></div><div class=""><div><span class="enlighter-text"> NET_BUFFER_LIST *nbl;</span></div></div><div class=""><div><span class="enlighter-text"> _MDL *first_mdl;</span></div></div><div class=""><div><span class="enlighter-text"> _MDL *last_mdl;</span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-k5">uint32_t</span><span class="enlighter-text"> offset;</span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-k5">uint32_t</span><span class="enlighter-text"> nbl_data_length;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span><span class="enlighter-text">;</span></div></div></div><div class="enlighter-raw">struct MSDU_struct {
 uint64_t info6;
 char flags;
 uint32_t llc_offset;
 uint32_t data_length;
 uint32_t field_14;
 uint64_t data_begin;
 NET_BUFFER_LIST *nbl;
 _MDL *first_mdl;
 _MDL *last_mdl;
 uint32_t offset;
 uint32_t nbl_data_length;
};</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="c">struct MSDU_struct {
 uint64_t info6;
 char flags;
 uint32_t llc_offset;
 uint32_t data_length;
 uint32_t field_14;
 uint64_t data_begin;
 NET_BUFFER_LIST *nbl;
 _MDL *first_mdl;
 _MDL *last_mdl;
 uint32_t offset;
 uint32_t nbl_data_length;
};</pre>
<p>Later, the <code>MSDU</code> structure is passed to the <code>Dot11Translate80211ToEthernetNdisPacket()</code> function via <code>ExtSTAReceivePacket()</code> and <code>ExtSTAReceiveDataPacket()</code>.</p>
<p>The function name makes it obvious that it’s translating IEEE 802.11 packets to Ethernet packets. The function gets the <code>MSDU</code> structure as its second argument. This structure has a pointer to the first <code>_MDL</code> from the incoming <code>_NET_BUFFER_LIST</code>, which contains the packet to be translated. The translation is done by formatting the ethernet header in front of the next layer. The translation happens inside the same memory area where the original packet was placed.</p>
<h3><span class="ez-toc-section" id="the-bug" ez-toc-data-id="#the-bug"></span>The bug<span class="ez-toc-section-end"></span></h3>
<p>After some reverse engineering, the patch becomes more understandable. The <code>Dot11Translate80211ToEthernetNdisPacket()</code> function reads the LLC packet’s header in order to understand the next layer in the packet. Before it reads the LLC header, it checks if the packet’s buffer has enough data. LLC header size is 8 bytes:</p>
<p><img loading="lazy" decoding="async" class="aligncenter wp-image-2759 size-full" src="https://www.crowdfense.com/wp-content/uploads/2024/07/picture_2.png" alt="" width="710" height="162"></p>
<p>The check is present in the code as follows:</p>
<p><img loading="lazy" decoding="async" class="aligncenter wp-image-2760 size-full" src="https://www.crowdfense.com/wp-content/uploads/2024/07/picture_3.png" alt="" width="455" height="48"></p>
<p>In case the next layer is VLAN, there should be an additional 4 bytes of IEEE 802.1Q header, and these 4 bytes also have to be present in the packet:</p>
<p><img loading="lazy" decoding="async" class="aligncenter wp-image-2761 size-full" src="https://www.crowdfense.com/wp-content/uploads/2024/07/picture_4.png" alt="" width="705" height="242"></p>
<p>In the vulnerable version, there is no check if these 4 bytes of the IEEE 802.1Q header are present. The check, however, has been added in the patched version, as can be seen in the below image:</p>
<p><img loading="lazy" decoding="async" class="aligncenter wp-image-2762 size-full" src="https://www.crowdfense.com/wp-content/uploads/2024/07/picture_5.png" alt="" width="833" height="82"></p>
<p>In the vulnerable version, if <code>LLC-&gt;Type == 0x8100</code> and there is no data after the 8 bytes of LLC, there will be an out-of-bound read (case #4). The overwrite happens in the part of the code that builds the ethernet header:</p>
<p><img loading="lazy" decoding="async" class="aligncenter wp-image-2764 size-full" src="https://www.crowdfense.com/wp-content/uploads/2024/07/picture_7.2.png" alt="" width="781" height="316"></p>
<p>Variable <code>v17</code> is the offset to where the ethernet header must be built. The offset of the ethernet header (v17) is calculated depending on the values in the LCC and IEEE 802.1Q headers. There are four different cases where an ethernet header can be placed:</p>
<ul>
<li><strong>Case 1</strong>: <code>LCC-&gt;type != 0x81 &amp;&amp; LCC-&gt;type &lt; 0x600</code><br>
In this case, <code>v17</code> will be equal to <code>LCC offset - 0xE</code> and the ethernet header will be built before the LCC header:</li>
</ul>
<p><img loading="lazy" decoding="async" class="aligncenter wp-image-2773 size-full" src="https://www.crowdfense.com/wp-content/uploads/2024/07/picture_16.png" alt="" width="431" height="87"></p>
<ul>
<li><strong>Case 2</strong>: <code>LCC-&gt;type != 0x81 &amp;&amp; LCC-&gt;type &gt;= 0x600</code><br>
In this case, <code>v17</code> is equal to <code>LCC offset - 0xE + 8</code> and the ethernet header will rewrite the LCC header:</li>
</ul>
<p><img loading="lazy" decoding="async" class="aligncenter wp-image-2774 size-full" src="https://www.crowdfense.com/wp-content/uploads/2024/07/picture_17.png" alt="" width="437" height="92"></p>
<ul>
<li><strong>Case 3</strong>: <code>LCC-&gt;type == 0x81 &amp;&amp; vlanid &lt; 0x600</code><br>
In this case <code>v17 = LCC offset - 0xE + 4</code>. The ethernet header will rewrite half of the LCC header:</li>
</ul>
<p><img loading="lazy" decoding="async" class="aligncenter wp-image-2775 size-full" src="https://www.crowdfense.com/wp-content/uploads/2024/07/picture_18.png" alt="" width="436" height="88"></p>
<ul>
<li><strong>Case 4</strong>: <code>LCC-&gt;type == 0x81 &amp;&amp; vlanid &gt;= 0x600</code><br>
That is what we need! In this case, <code>v17 = LCC offset - 0xE + 4 + 8</code> and the rest of the ethernet header will be written outside, on memory described by <code>_MDL</code>:</li>
</ul>
<p><img loading="lazy" decoding="async" class="aligncenter wp-image-2776 size-full" src="https://www.crowdfense.com/wp-content/uploads/2024/07/picture_19.png" alt="" width="457" height="96"></p>
<p>Ufortunately, the buffer where the packet is placed has additional limitations, which we cannot control.</p>
<p><img loading="lazy" decoding="async" class="aligncenter wp-image-2770 size-full" src="https://www.crowdfense.com/wp-content/uploads/2024/07/picture_13.png" alt="" width="445" height="123"></p>
<p>The IEEE 802.1Q header’s field <code>tpid</code> is checked, and the <code>vlanid</code> field must be right. The <code>Dot11Translate80211ToEthernetNdisPacket()</code> function checks the IEEE 802.1Q header, and we cannot control this field. Also, there is no guarantee that these bytes will be useful.</p>
<h2><span class="ez-toc-section" id="dynamic-analysis" ez-toc-data-id="#dynamic-analysis"></span>Dynamic Analysis<span class="ez-toc-section-end"></span></h2>
<p>To confirm our analysis, we checked everything dynamically, sending packets over Wi-Fi to a vulnerable machine.</p>
<p>As pointed out in Microsoft’s bulletin, an attacker does not need authentication on the target system. However, for the packet to be delivered, we have to be on the same Wi-Fi network as the target; otherwise, the underlying drivers will block the packets.</p>
<p>There are several options on how to perform the attack:</p>
<ul>
<li>Set up a fake AP with the same configuration that the target uses. In this case, the target will automatically connect to our AP;</li>
<li>Connect to the same AP as the target: this route limits this attack to public networks or will require the key of the AP to be brute-forced/known. Besides that, there’s another fundamental reason not to take this path. Traffic from the network where other devices are present will make it harder to predict which packets the target catches. For example, if we use a spraying technique, we will not be sure that all the packets sent to the target are in the suitable memory layout for the attack to be successful.</li>
</ul>
<h3><span class="ez-toc-section" id="fake-ap" ez-toc-data-id="#fake-ap"></span>Fake AP<span class="ez-toc-section-end"></span></h3>
<p>Since we need to be able to send raw packets via Wi-Fi first, for our tests, we have built a fake AP with Python and the scary library. It is fast enough to be used to develop and prototype, allowing us to send raw packets over Wi-Fi.</p>
<p>Our setup included two VMs: a Windows 11 23H2 and a Kali Linux machine. Both have connected AC1200 Wi-Fi 5 USB adapters.</p>
<p><img loading="lazy" decoding="async" class="size-medium wp-image-2765 aligncenter" src="https://www.crowdfense.com/wp-content/uploads/2024/07/picture_8-300x208.png" alt="" width="300" height="208"></p>
<p>Our AP has to do the following minimal things:</p>
<ul>
<li>Beaconing: sending beacon packets to inform stations about our presence. A beacon packet has to be sent every 102.4ms;</li>
<li>Response to probe packets (broadcast and direct);</li>
<li>Response to authentication requests. For our tests, no authentication is required, so we used Open System Authentication;</li>
<li>Response to association requests.</li>
</ul>
<p><img loading="lazy" decoding="async" class="aligncenter wp-image-2766 size-full" src="https://www.crowdfense.com/wp-content/uploads/2024/07/picture_9.png" alt="" width="822" height="307"></p>
<p>After association, the station requests network info using DHCP, ARP and other protocols. These packets are sent as data packets. Our payload also has to be sent as a data packet in order to be able to reach our target function:</p>
<p><img loading="lazy" decoding="async" class="aligncenter wp-image-2767 size-full" src="https://www.crowdfense.com/wp-content/uploads/2024/07/picture_10.png" alt="" width="980" height="364"></p>
<p>Payload (data) packets can be generated with the following snippet:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-python enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-k0">def</span><span class="enlighter-text"> </span><span class="enlighter-m0">send_payload_v1</span><span class="enlighter-g1">(</span><span class="enlighter-text">self, destination, with_vlan</span><span class="enlighter-g1">)</span><span class="enlighter-text">:</span></div></div><div class=""><div><span class="enlighter-text"> radiotap = </span><span class="enlighter-m0">RadioTap</span><span class="enlighter-g1">()</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> dot11 = </span><span class="enlighter-m0">Dot11</span><span class="enlighter-g1">(</span><span class="enlighter-text">type = </span><span class="enlighter-n1">2</span><span class="enlighter-text">, subtype = </span><span class="enlighter-n1">0</span><span class="enlighter-text">, addr1 = destination, addr2 = self.ap.mac, addr3 = self.ap.mac, SC = self.ap.</span><span class="enlighter-m1">next_sc</span><span class="enlighter-g1">()</span><span class="enlighter-text">, FCfield=</span><span class="enlighter-s0">'from-DS'</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> llc = </span><span class="enlighter-m0">LLC</span><span class="enlighter-g1">(</span><span class="enlighter-text">dsap=</span><span class="enlighter-n2">0xaa</span><span class="enlighter-text">, ssap=</span><span class="enlighter-n2">0xaa</span><span class="enlighter-text">, ctrl=</span><span class="enlighter-n2">0x03</span><span class="enlighter-g1">)</span><span class="enlighter-text"> / </span><span class="enlighter-m0">SNAP</span><span class="enlighter-g1">(</span><span class="enlighter-text">OUI=</span><span class="enlighter-n2">0x000000</span><span class="enlighter-text">, code=</span><span class="enlighter-n2">0x8100</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> packet = radiotap / dot11 / llc </span><span class="enlighter-c0"># here can be any additional bytes if needed</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-m0">sendp</span><span class="enlighter-g1">(</span><span class="enlighter-text">packet, iface=self.ap.interface, verbose=</span><span class="enlighter-e0">False</span><span class="enlighter-g1">)</span></div></div></div><div class="enlighter-raw">def send_payload_v1(self, destination, with_vlan):
 radiotap = RadioTap()
 dot11 = Dot11(type = 2, subtype = 0, addr1 = destination, addr2 = self.ap.mac, addr3 = self.ap.mac, SC = self.ap.next_sc(), FCfield='from-DS')
 llc = LLC(dsap=0xaa, ssap=0xaa, ctrl=0x03) / SNAP(OUI=0x000000, code=0x8100)
 packet = radiotap / dot11 / llc # here can be any additional bytes if needed
 sendp(packet, iface=self.ap.interface, verbose=False)</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="python">def send_payload_v1(self, destination, with_vlan):
 radiotap = RadioTap()
 dot11 = Dot11(type = 2, subtype = 0, addr1 = destination, addr2 = self.ap.mac, addr3 = self.ap.mac, SC = self.ap.next_sc(), FCfield='from-DS')
 llc = LLC(dsap=0xaa, ssap=0xaa, ctrl=0x03) / SNAP(OUI=0x000000, code=0x8100)
 packet = radiotap / dot11 / llc # here can be any additional bytes if needed
 sendp(packet, iface=self.ap.interface, verbose=False)
</pre>
<h2><span class="ez-toc-section" id="debugging" ez-toc-data-id="#debugging"></span>Debugging<span class="ez-toc-section-end"></span></h2>
<p>Now that we have everything ready to try our attack dynamically, we have to set the breakpoint on the vulnerable function (<code>Dot11Translate80211ToEthernetNdisPacket()</code>), start the fake AP and connect to it. After STA successfully pass all the connection steps, the breakpoint is hit:</p>
<p><img loading="lazy" decoding="async" class="aligncenter wp-image-2772 size-full" src="https://www.crowdfense.com/wp-content/uploads/2024/07/picture_15.png" alt="" width="675" height="233"></p>
<p>In the image above we can see our packet; it has a length of <code>0x20</code> bytes. The IEEE 802.11 header is placed at offset <code>0x00</code> while the LLC header is placed at offset <code>0x18</code>.</p>
<p>We can also see that <code>LCC-&gt;type</code> is <code>0x81</code>, so we should pass the code that checks the IEEE 802.1Q header, namely the <code>tpid field</code>. Even so, the <code>tpid</code> value does not pass the checks, so this packet will not be translated.</p>
<p>The 12 lower bits of <code>tpid</code> must be 0 for the packet to be translated.</p>
<p><img loading="lazy" decoding="async" class="aligncenter wp-image-2777 size-full" src="https://www.crowdfense.com/wp-content/uploads/2024/07/picture_20.png" alt="" width="495" height="194"></p>
<p>In this code, the overread has already happened (first instruction in the above picture).</p>
<p>We could spray packets with proper values and right size and then send the vulnerability-triggering packet. It sounds nice, but it’s difficult to catch the real attacking packet in the debugger. So, we simulated the condition where the bytes are rightfully set after our attacking packet.</p>
<p>For the simulation another packet was sent, and the buffer behind it was edited to create the perfect condition to trigger the vulnerability.</p>
<p><img loading="lazy" decoding="async" class="aligncenter wp-image-2779 size-full" src="https://www.crowdfense.com/wp-content/uploads/2024/07/picture_22.png" alt="" width="673" height="234"></p>
<p>As you can see from the below images, this allowed us to bypass the <code>tpid</code> check. It will also help to get to the right path at the <code>vlanid</code> checking to increase ethernet offset to 8:</p>
<p><img loading="lazy" decoding="async" class="aligncenter wp-image-2792 size-full" src="https://www.crowdfense.com/wp-content/uploads/2024/07/vlan_id_check.png" alt="" width="941" height="397"></p>
<p><img loading="lazy" decoding="async" class="aligncenter wp-image-2780 size-full" src="https://www.crowdfense.com/wp-content/uploads/2024/07/picture_23.png" alt="" width="412" height="116"><br>
The code vulnerable to the out-of-bound write is shown in the following picture. Here, you can see that the <code>rcx</code> register is set to the pointer where the ethernet header has to be built. The last three instructions build the ethernet header. In theory, the overflow will occur at the last two instructions:</p>
<p><img loading="lazy" decoding="async" class="aligncenter wp-image-2781 size-full" src="https://www.crowdfense.com/wp-content/uploads/2024/07/picture_24.png" alt="" width="366" height="269"></p>
<p>Straight before the vulnerability is triggered, the memory layout looks like the following:</p>
<p><img loading="lazy" decoding="async" class="aligncenter wp-image-2782 size-full" src="https://www.crowdfense.com/wp-content/uploads/2024/07/picture_25.2.2.png" alt="" width="533" height="172"></p>
<p>Here, we can see at which address the ethernet header will be built. Underlined in red are the bytes which the overflow will overwrite.<br>
After these three instructions have been executed, the memory layout looks like this:</p>
<p><img loading="lazy" decoding="async" class="aligncenter wp-image-2785 size-full" src="https://www.crowdfense.com/wp-content/uploads/2024/07/picture_26.2.png" alt="" width="536" height="196"></p>
<p>Here, we can see that the first 2 bytes have been overwritten with the end of the source MAC address, which is under the attacker’s control. The following two bytes are left unchanged because the <code>si</code> register has the same value and is read from the same place.</p>
<h2><span class="ez-toc-section" id="exploitability" ez-toc-data-id="#exploitability"></span>Exploitability<span class="ez-toc-section-end"></span></h2>
<p>First of all, to get the overwritten state, we need to be very lucky and have proper bytes behind the packet buffer, which will pass <code>tpid</code> and <code>vlanid</code> checks. We do not control these bytes within the packet, which leads to overwriting. We can probably use a spraying technique before sending the vulnerability-triggering packet, but there are other limitations:</p>
<ol>
<li>In order to exploit this vulnerability, we need some form of information leaking vulnerability, which is currently lacking.</li>
<li>The memory, which is overwritten, is also crucial. It should be something useful like some pointers. But this buffer does not contain anything useful. If we check this buffer with the <code>!address</code> command, it will give the following result:</li>
</ol>
<p><img loading="lazy" decoding="async" class="aligncenter wp-image-2787 size-full" src="https://www.crowdfense.com/wp-content/uploads/2024/07/picture_27.png" alt="" width="357" height="361"></p>
<p>This memory region looks strange (e.g. Region Size). Checking this memory region with RamMap shows the tag of the memory:</p>
<p><img loading="lazy" decoding="async" class="aligncenter wp-image-2790 size-full" src="https://www.crowdfense.com/wp-content/uploads/2024/07/picture_29.png" alt="" width="932" height="174"></p>
<p>While if we try to check this memory with the <code>!poolused 4</code> command, it will show us that the tag is unknown.</p>
<p><img loading="lazy" decoding="async" class="aligncenter wp-image-2788 size-full" src="https://www.crowdfense.com/wp-content/uploads/2024/07/picture_28.png" alt="" width="835" height="79"></p>
<p>The only thing left is to understand what this memory region is, putting a breakpoint on its allocation.</p>
<p><img loading="lazy" decoding="async" class="aligncenter wp-image-2791 size-full" src="https://www.crowdfense.com/wp-content/uploads/2024/07/picture_30.png" alt="" width="832" height="518"></p>
<p>That gives us an idea of how the memory is allocated; it is allocated when connecting an adapter to a system and freed on its disconnection. The allocated buffer size is <code>0x7800</code>.</p>
<h2><span class="ez-toc-section" id="conclusion" ez-toc-data-id="#conclusion"></span>Conclusion<span class="ez-toc-section-end"></span></h2>
<p>Upon analysis, the impact of this vulnerability seems much less critical than what Microsoft anticipated. We can only overwrite another packet (limited number of bytes) if it is placed straight after our one, which is very unlikely and useless, as no interesting data there can be leveraged to take control of the execution flow. Anyway, we would love to be proven wrong, as this seems a very cool exploitation vector.</p>
<h2><span class="ez-toc-section" id="references" ez-toc-data-id="#references"></span>References<span class="ez-toc-section-end"></span></h2>
<ul>
<li><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30078" target="_blank" rel="noopener">https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30078</a></li>
<li><a href="https://github.com/rpp0/scapy-fakeap" target="_blank" rel="noopener">https://github.com/rpp0/scapy-fakeap</a></li>
<li><a href="https://www.amazon.com/Python-Scapy-Dot11-Programacion-pentesters/dp/1542748704" target="_blank" rel="noopener">https://www.amazon.com/Python-Scapy-Dot11-Programacion-pentesters/dp/1542748704</a></li>
<li><a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/network/ndis-filter-drivers" target="_blank" rel="noopener">https://learn.microsoft.com/en-us/windows-hardware/drivers/network/ndis-filter-drivers</a></li>
</ul>
		</div>

		<!-- Post meta after content -->
		
	</div>

					<div class="post-share post-block">
					<h3><i class="fas fa-share"></i>Share this post</h3>
							<div class="share-links"><a href="https://www.facebook.com/sharer.php?u=https://www.crowdfense.com/windows-wi-fi-driver-rce-vulnerability-cve-2024-30078/" target="_blank" rel="noopener noreferrer nofollow" data-bs-tooltip="" data-bs-placement="bottom" title="" class="share-facebook" data-bs-original-title="Facebook">Facebook</a>
		<a href="https://twitter.com/intent/tweet?text=Windows+Wi-Fi+Driver+RCE+Vulnerability+%26%238211%3B+CVE-2024-30078&amp;url=https://www.crowdfense.com/windows-wi-fi-driver-rce-vulnerability-cve-2024-30078/" target="_blank" rel="noopener noreferrer nofollow" data-bs-tooltip="" data-bs-placement="bottom" title="" class="share-twitter" data-bs-original-title="X">Twitter</a>
		<a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.crowdfense.com/windows-wi-fi-driver-rce-vulnerability-cve-2024-30078/&amp;title=Windows+Wi-Fi+Driver+RCE+Vulnerability+%26%238211%3B+CVE-2024-30078" target="_blank" rel="noopener noreferrer nofollow" data-bs-tooltip="" data-bs-placement="bottom" title="" class="share-linkedin" data-bs-original-title="LinkedIn">LinkedIn</a>
		<a href="mailto:?subject=Windows+Wi-Fi+Driver+RCE+Vulnerability+%26%238211%3B+CVE-2024-30078&amp;body=https://www.crowdfense.com/windows-wi-fi-driver-rce-vulnerability-cve-2024-30078/" target="_blank" rel="noopener noreferrer nofollow" data-bs-tooltip="" data-bs-placement="bottom" title="" class="share-email" data-bs-original-title="Email">Email</a>
		<a href="http://www.reddit.com/submit?url=https://www.crowdfense.com/windows-wi-fi-driver-rce-vulnerability-cve-2024-30078/&amp;title=Windows+Wi-Fi+Driver+RCE+Vulnerability+%26%238211%3B+CVE-2024-30078" target="_blank" rel="noopener noreferrer nofollow" data-bs-tooltip="" data-bs-placement="bottom" title="" class="share-reddit" data-bs-original-title="Reddit">Reddit</a>
	</div>			</div>
		
	

	
</article>
								<hr class="tall">
					<div class="related-posts">
												<h4 class="sub-title">Related <strong>Posts</strong></h4>
						<div class="post-carousel porto-carousel owl-carousel show-nav-title has-ccols ccols-1 ccols-lg-4 ccols-md-3 ccols-sm-2 owl-loaded owl-drag" data-plugin-options="{&quot;themeConfig&quot;:true,&quot;lg&quot;:&quot;4&quot;,&quot;md&quot;:3,&quot;sm&quot;:2,&quot;margin&quot;:30}">
						



						<div class="owl-stage-outer owl-height" style="height: 367.531px;"><div class="owl-stage" style="transform: translate3d(-1918px, 0px, 0px); transition: all; width: 5754px;"><div class="owl-item cloned" style="width: 449.5px; margin-right: 30px;"><div class="post-item">
	            <link rel="stylesheet" id="porto-thumb-info-css" href="https://www.crowdfense.com/wp-content/themes/porto/css/part/thumb-info.css?ver=7.7.3" type="text/css" media="all">             		<a aria-label="Go to post page" href="https://www.crowdfense.com/nt-os-kernel-information-disclosure-vulnerability-cve-2025-53136/"> <span class="post-image thumb-info thumb-info-hide-wrapper-bg m-b-md"> <span class="thumb-info-wrapper"> <img class="img-responsive" width="450" height="231" src="https://www.crowdfense.com/wp-content/uploads/2025/08/CVE-2025-53136-450x231.png" alt="">
			</span> </span> </a>
			<div class="post-date">
		<span class="day">11</span><span class="month">Sep</span><time datetime="2025-09-11">September 11, 2025</time>	</div>
			<h4><a href="https://www.crowdfense.com/nt-os-kernel-information-disclosure-vulnerability-cve-2025-53136/">
		NT OS Kernel Information Disclosure Vulnerability – CVE-2025-53136	</a></h4>
		<div><p class="post-excerpt">Introduction
Microsoft mitigated many traditional kernel information leaks starting with Windows 11/Windows Server...  <a class="read-more" href="https://www.crowdfense.com/nt-os-kernel-information-disclosure-vulnerability-cve-2025-53136/">read more <i class="fas fa-angle-right"></i></a></p></div> </div></div><div class="owl-item cloned" style="width: 449.5px; margin-right: 30px;"><div class="post-item">
			<a aria-label="Go to post page" href="https://www.crowdfense.com/cve-2025-53149-windows-ksthunk-heap-overflow/"> <span class="post-image thumb-info thumb-info-hide-wrapper-bg m-b-md"> <span class="thumb-info-wrapper"> <img class="img-responsive" width="450" height="231" src="https://www.crowdfense.com/wp-content/uploads/2025/08/CVE-2025-53149-450x231.png" alt="">
			</span> </span> </a>
			<div class="post-date">
		<span class="day">04</span><span class="month">Sep</span><time datetime="2025-09-04">September 4, 2025</time>	</div>
			<h4><a href="https://www.crowdfense.com/cve-2025-53149-windows-ksthunk-heap-overflow/">
		Heap-based buffer overflow in Kernel Streaming WOW Thunk Service Driver – CVE-2025-53149	</a></h4>
		<div><p class="post-excerpt">From time to time, while digging through internals during our research, we...  <a class="read-more" href="https://www.crowdfense.com/cve-2025-53149-windows-ksthunk-heap-overflow/">read more <i class="fas fa-angle-right"></i></a></p></div> </div></div><div class="owl-item cloned" style="width: 449.5px; margin-right: 30px;"><div class="post-item">
			<a aria-label="Go to post page" href="https://www.crowdfense.com/cve-2024-11477-7zip-zstd-buffer-overflow/"> <span class="post-image thumb-info thumb-info-hide-wrapper-bg m-b-md"> <span class="thumb-info-wrapper"> <img class="img-responsive" width="450" height="231" src="https://www.crowdfense.com/wp-content/uploads/2025/04/7-zip-450x231.png" alt="">
			</span> </span> </a>
			<div class="post-date">
		<span class="day">08</span><span class="month">May</span><time datetime="2025-05-08">May 8, 2025</time>	</div>
			<h4><a href="https://www.crowdfense.com/cve-2024-11477-7zip-zstd-buffer-overflow/">
		CVE-2024-11477- 7-Zip ZSTD Buffer Overflow Vulnerability	</a></h4>
		<div><p class="post-excerpt">As part of our daily job in Crowdfense, we investigate and dive...  <a class="read-more" href="https://www.crowdfense.com/cve-2024-11477-7zip-zstd-buffer-overflow/">read more <i class="fas fa-angle-right"></i></a></p></div> </div></div><div class="owl-item cloned" style="width: 449.5px; margin-right: 30px;"><div class="post-item">
			<a aria-label="Go to post page" href="https://www.crowdfense.com/windows-applocker-driver-lpe-vulnerability-cve-2024-21338/"> <span class="post-image thumb-info thumb-info-hide-wrapper-bg m-b-md"> <span class="thumb-info-wrapper"> <img class="img-responsive" width="450" height="231" src="https://www.crowdfense.com/wp-content/uploads/2024/07/untrusted-pointer-dereference-450x231.webp" alt="">
			</span> </span> </a>
			<div class="post-date">
		<span class="day">01</span><span class="month">Aug</span><time datetime="2024-08-01">August 1, 2024</time>	</div>
			<h4><a href="https://www.crowdfense.com/windows-applocker-driver-lpe-vulnerability-cve-2024-21338/">
		Windows AppLocker Driver LPE Vulnerability – CVE-2024-21338	</a></h4>
		<div><p class="post-excerpt">When I initially interviewed candidates for CF’s Windows Researchers position, one of...  <a class="read-more" href="https://www.crowdfense.com/windows-applocker-driver-lpe-vulnerability-cve-2024-21338/">read more <i class="fas fa-angle-right"></i></a></p></div> </div></div><div class="owl-item active" style="width: 449.5px; margin-right: 30px;"><div class="post-item">
	            <link rel="stylesheet" id="porto-thumb-info-css" href="https://www.crowdfense.com/wp-content/themes/porto/css/part/thumb-info.css?ver=7.7.3" type="text/css" media="all">             		<a aria-label="Go to post page" href="https://www.crowdfense.com/nt-os-kernel-information-disclosure-vulnerability-cve-2025-53136/"> <span class="post-image thumb-info thumb-info-hide-wrapper-bg m-b-md"> <span class="thumb-info-wrapper"> <img class="img-responsive" width="450" height="231" src="https://www.crowdfense.com/wp-content/uploads/2025/08/CVE-2025-53136-450x231.png" alt="">
			</span> </span> </a>
			<div class="post-date">
		<span class="day">11</span><span class="month">Sep</span><time datetime="2025-09-11">September 11, 2025</time>	</div>
			<h4><a href="https://www.crowdfense.com/nt-os-kernel-information-disclosure-vulnerability-cve-2025-53136/">
		NT OS Kernel Information Disclosure Vulnerability – CVE-2025-53136	</a></h4>
		<div><p class="post-excerpt">Introduction
Microsoft mitigated many traditional kernel information leaks starting with Windows 11/Windows Server...  <a class="read-more" href="https://www.crowdfense.com/nt-os-kernel-information-disclosure-vulnerability-cve-2025-53136/">read more <i class="fas fa-angle-right"></i></a></p></div> </div></div><div class="owl-item active" style="width: 449.5px; margin-right: 30px;"><div class="post-item">
			<a aria-label="Go to post page" href="https://www.crowdfense.com/cve-2025-53149-windows-ksthunk-heap-overflow/"> <span class="post-image thumb-info thumb-info-hide-wrapper-bg m-b-md"> <span class="thumb-info-wrapper"> <img class="img-responsive" width="450" height="231" src="https://www.crowdfense.com/wp-content/uploads/2025/08/CVE-2025-53149-450x231.png" alt="">
			</span> </span> </a>
			<div class="post-date">
		<span class="day">04</span><span class="month">Sep</span><time datetime="2025-09-04">September 4, 2025</time>	</div>
			<h4><a href="https://www.crowdfense.com/cve-2025-53149-windows-ksthunk-heap-overflow/">
		Heap-based buffer overflow in Kernel Streaming WOW Thunk Service Driver – CVE-2025-53149	</a></h4>
		<div><p class="post-excerpt">From time to time, while digging through internals during our research, we...  <a class="read-more" href="https://www.crowdfense.com/cve-2025-53149-windows-ksthunk-heap-overflow/">read more <i class="fas fa-angle-right"></i></a></p></div> </div></div><div class="owl-item active" style="width: 449.5px; margin-right: 30px;"><div class="post-item">
			<a aria-label="Go to post page" href="https://www.crowdfense.com/cve-2024-11477-7zip-zstd-buffer-overflow/"> <span class="post-image thumb-info thumb-info-hide-wrapper-bg m-b-md"> <span class="thumb-info-wrapper"> <img class="img-responsive" width="450" height="231" src="https://www.crowdfense.com/wp-content/uploads/2025/04/7-zip-450x231.png" alt="">
			</span> </span> </a>
			<div class="post-date">
		<span class="day">08</span><span class="month">May</span><time datetime="2025-05-08">May 8, 2025</time>	</div>
			<h4><a href="https://www.crowdfense.com/cve-2024-11477-7zip-zstd-buffer-overflow/">
		CVE-2024-11477- 7-Zip ZSTD Buffer Overflow Vulnerability	</a></h4>
		<div><p class="post-excerpt">As part of our daily job in Crowdfense, we investigate and dive...  <a class="read-more" href="https://www.crowdfense.com/cve-2024-11477-7zip-zstd-buffer-overflow/">read more <i class="fas fa-angle-right"></i></a></p></div> </div></div><div class="owl-item active" style="width: 449.5px; margin-right: 30px;"><div class="post-item">
			<a aria-label="Go to post page" href="https://www.crowdfense.com/windows-applocker-driver-lpe-vulnerability-cve-2024-21338/"> <span class="post-image thumb-info thumb-info-hide-wrapper-bg m-b-md"> <span class="thumb-info-wrapper"> <img class="img-responsive" width="450" height="231" src="https://www.crowdfense.com/wp-content/uploads/2024/07/untrusted-pointer-dereference-450x231.webp" alt="">
			</span> </span> </a>
			<div class="post-date">
		<span class="day">01</span><span class="month">Aug</span><time datetime="2024-08-01">August 1, 2024</time>	</div>
			<h4><a href="https://www.crowdfense.com/windows-applocker-driver-lpe-vulnerability-cve-2024-21338/">
		Windows AppLocker Driver LPE Vulnerability – CVE-2024-21338	</a></h4>
		<div><p class="post-excerpt">When I initially interviewed candidates for CF’s Windows Researchers position, one of...  <a class="read-more" href="https://www.crowdfense.com/windows-applocker-driver-lpe-vulnerability-cve-2024-21338/">read more <i class="fas fa-angle-right"></i></a></p></div> </div></div><div class="owl-item cloned" style="width: 449.5px; margin-right: 30px;"><div class="post-item">
	            <link rel="stylesheet" id="porto-thumb-info-css" href="https://www.crowdfense.com/wp-content/themes/porto/css/part/thumb-info.css?ver=7.7.3" type="text/css" media="all">             		<a aria-label="Go to post page" href="https://www.crowdfense.com/nt-os-kernel-information-disclosure-vulnerability-cve-2025-53136/"> <span class="post-image thumb-info thumb-info-hide-wrapper-bg m-b-md"> <span class="thumb-info-wrapper"> <img class="img-responsive" width="450" height="231" src="https://www.crowdfense.com/wp-content/uploads/2025/08/CVE-2025-53136-450x231.png" alt="">
			</span> </span> </a>
			<div class="post-date">
		<span class="day">11</span><span class="month">Sep</span><time datetime="2025-09-11">September 11, 2025</time>	</div>
			<h4><a href="https://www.crowdfense.com/nt-os-kernel-information-disclosure-vulnerability-cve-2025-53136/">
		NT OS Kernel Information Disclosure Vulnerability – CVE-2025-53136	</a></h4>
		<div><p class="post-excerpt">Introduction
Microsoft mitigated many traditional kernel information leaks starting with Windows 11/Windows Server...  <a class="read-more" href="https://www.crowdfense.com/nt-os-kernel-information-disclosure-vulnerability-cve-2025-53136/">read more <i class="fas fa-angle-right"></i></a></p></div> </div></div><div class="owl-item cloned" style="width: 449.5px; margin-right: 30px;"><div class="post-item">
			<a aria-label="Go to post page" href="https://www.crowdfense.com/cve-2025-53149-windows-ksthunk-heap-overflow/"> <span class="post-image thumb-info thumb-info-hide-wrapper-bg m-b-md"> <span class="thumb-info-wrapper"> <img class="img-responsive" width="450" height="231" src="https://www.crowdfense.com/wp-content/uploads/2025/08/CVE-2025-53149-450x231.png" alt="">
			</span> </span> </a>
			<div class="post-date">
		<span class="day">04</span><span class="month">Sep</span><time datetime="2025-09-04">September 4, 2025</time>	</div>
			<h4><a href="https://www.crowdfense.com/cve-2025-53149-windows-ksthunk-heap-overflow/">
		Heap-based buffer overflow in Kernel Streaming WOW Thunk Service Driver – CVE-2025-53149	</a></h4>
		<div><p class="post-excerpt">From time to time, while digging through internals during our research, we...  <a class="read-more" href="https://www.crowdfense.com/cve-2025-53149-windows-ksthunk-heap-overflow/">read more <i class="fas fa-angle-right"></i></a></p></div> </div></div><div class="owl-item cloned" style="width: 449.5px; margin-right: 30px;"><div class="post-item">
			<a aria-label="Go to post page" href="https://www.crowdfense.com/cve-2024-11477-7zip-zstd-buffer-overflow/"> <span class="post-image thumb-info thumb-info-hide-wrapper-bg m-b-md"> <span class="thumb-info-wrapper"> <img class="img-responsive" width="450" height="231" src="https://www.crowdfense.com/wp-content/uploads/2025/04/7-zip-450x231.png" alt="">
			</span> </span> </a>
			<div class="post-date">
		<span class="day">08</span><span class="month">May</span><time datetime="2025-05-08">May 8, 2025</time>	</div>
			<h4><a href="https://www.crowdfense.com/cve-2024-11477-7zip-zstd-buffer-overflow/">
		CVE-2024-11477- 7-Zip ZSTD Buffer Overflow Vulnerability	</a></h4>
		<div><p class="post-excerpt">As part of our daily job in Crowdfense, we investigate and dive...  <a class="read-more" href="https://www.crowdfense.com/cve-2024-11477-7zip-zstd-buffer-overflow/">read more <i class="fas fa-angle-right"></i></a></p></div> </div></div><div class="owl-item cloned" style="width: 449.5px; margin-right: 30px;"><div class="post-item">
			<a aria-label="Go to post page" href="https://www.crowdfense.com/windows-applocker-driver-lpe-vulnerability-cve-2024-21338/"> <span class="post-image thumb-info thumb-info-hide-wrapper-bg m-b-md"> <span class="thumb-info-wrapper"> <img class="img-responsive" width="450" height="231" src="https://www.crowdfense.com/wp-content/uploads/2024/07/untrusted-pointer-dereference-450x231.webp" alt="">
			</span> </span> </a>
			<div class="post-date">
		<span class="day">01</span><span class="month">Aug</span><time datetime="2024-08-01">August 1, 2024</time>	</div>
			<h4><a href="https://www.crowdfense.com/windows-applocker-driver-lpe-vulnerability-cve-2024-21338/">
		Windows AppLocker Driver LPE Vulnerability – CVE-2024-21338	</a></h4>
		<div><p class="post-excerpt">When I initially interviewed candidates for CF’s Windows Researchers position, one of...  <a class="read-more" href="https://www.crowdfense.com/windows-applocker-driver-lpe-vulnerability-cve-2024-21338/">read more <i class="fas fa-angle-right"></i></a></p></div> </div></div></div></div><div class="owl-nav disabled"><button type="button" aria-label="Owl carousel Navigation" role="button" class="owl-prev"></button><button type="button" aria-label="Owl carousel Navigation" role="button" class="owl-next"></button></div><div class="owl-dots disabled"><button aria-label="Owl Carousel Pagination" role="button" class="owl-dot active"><span></span></button></div></div>
					</div>
					</div>

		

</div><!-- end main content -->



	</div>
	</div>

					
				
				</div><!-- end main -->

				
				<div class="footer-wrapper">

																												
							
												
					
				</div>
							
					
	</div><!-- end wrapper -->
	
<div class="panel-overlay"></div>
<a href="https://www.crowdfense.com/windows-wi-fi-driver-rce-vulnerability-cve-2024-30078/#" role="button" aria-label="Close the Mobile Menu" class="side-nav-panel-close"><svg width="1.5rem" height="1.5rem" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><g id="cross"><line stroke="#fff" stroke-width="2px" x1="7" x2="25" y1="7" y2="25"></line><line stroke="#fff" stroke-width="2px" x1="7" x2="25" y1="25" y2="7"></line></g></svg></a>
<div id="side-nav-panel" class="panel-right">

	<div class="menu-wrap"><ul id="menu-main-menu-1" class="mobile-menu accordion-menu"><li id="accordion-menu-item-2843" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home"><a href="https://www.crowdfense.com/">Home</a></li>
<li id="accordion-menu-item-2650" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.crowdfense.com/exploit-acquisition-program/">Bounties</a></li>
<li id="accordion-menu-item-2652" class="menu-item menu-item-type-custom menu-item-object-custom"><a target="_blank" href="https://vrh.crowdfense.com/">Submit</a></li>
<li id="accordion-menu-item-2649" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.crowdfense.com/faq/">FAQ</a></li>
<li id="accordion-menu-item-2876" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children has-sub"><a href="https://www.crowdfense.com/windows-wi-fi-driver-rce-vulnerability-cve-2024-30078/#">Services</a>
<span aria-label="Open Submenu" class="arrow" role="button"></span><ul class="sub-menu">
	<li id="accordion-menu-item-2874" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.crowdfense.com/n-day-feed/">N-day Feed</a></li>
	<li id="accordion-menu-item-2875" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.crowdfense.com/n-day-feed-updates/">Recent Updates</a></li>
</ul>
</li>
<li id="accordion-menu-item-2674" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.crowdfense.com/blog/">Blog</a></li>
<li id="accordion-menu-item-2842" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children has-sub"><a href="https://www.crowdfense.com/windows-wi-fi-driver-rce-vulnerability-cve-2024-30078/#">About Us</a>
<span aria-label="Open Submenu" class="arrow" role="button"></span><ul class="sub-menu">
	<li id="accordion-menu-item-2647" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.crowdfense.com/about-us/">About Crowdfense</a></li>
	<li id="accordion-menu-item-2646" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.crowdfense.com/contact/">Contact</a></li>
	<li id="accordion-menu-item-2648" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.crowdfense.com/events/">Events</a></li>
	<li id="accordion-menu-item-2644" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.crowdfense.com/careers/">Careers</a></li>
</ul>
</li>
</ul></div><div class="share-links">		<a target="_blank" rel="nofollow noopener noreferrer" class="share-twitter" href="https://twitter.com/crowdfense" aria-label="X" title="X"></a>
				<a target="_blank" rel="nofollow noopener noreferrer" class="share-linkedin" href="https://www.linkedin.com/company/crowdfense/" aria-label="LinkedIn" title="LinkedIn"></a>
				<a target="_blank" rel="nofollow noopener noreferrer" class="share-telegram" href="https://t.me/crowdfense" aria-label="Telegram" title="Telegram"></a>
		</div></div>

























		<!-- Cookie Notice plugin v2.5.12 by Hu-manity.co https://hu-manity.co/ -->
		<div id="cookie-notice" role="dialog" class="cookie-notice-hidden cookie-revoke-hidden cn-position-bottom" aria-label="Cookie Notice" style="background-color: rgba(24,28,75,1);"><div class="cookie-notice-container" style="color: #fff"><span id="cn-notice-text" class="cn-text-container">This website uses cookies in order to improve your experience. By using this website, you agree to our use of cookies and other technologies to process your data.</span><span id="cn-notice-buttons" class="cn-buttons-container"><button id="cn-accept-cookie" data-cookie-set="accept" class="cn-set-cookie cn-button" aria-label="I Agree" style="background-color: #5472d2">I Agree</button><button data-link-url="https://www.crowdfense.com/privacy-policy/" data-link-target="_blank" id="cn-more-info" class="cn-more-info cn-button" aria-label="Privacy policy" style="background-color: #5472d2">Privacy policy</button></span><button type="button" id="cn-close-notice" data-cookie-set="accept" class="cn-close-icon" aria-label="No"></button></div>
			
		</div>
		<!-- / Cookie Notice plugin -->

<div id="topcontrol" title="" style="position: fixed; bottom: 0px; opacity: 0; cursor: pointer;"><i class="fas fa-chevron-up"></i></div></body></html>