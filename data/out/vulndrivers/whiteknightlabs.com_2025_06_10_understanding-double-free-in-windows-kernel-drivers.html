# https://whiteknightlabs.com/2025/06/10/understanding-double-free-in-windows-kernel-drivers/

<!DOCTYPE html><html lang="en-US" prefix="og: https://ogp.me/ns#" dir="ltr">

<body class="wp-singular post-template-default single single-post postid-32157 single-format-standard wp-embed-responsive wp-theme-hello-elementor ehf-template-hello-elementor ehf-stylesheet-hello-elementor et_monarch hello-elementor-default elementor-default elementor-template-canvas elementor-kit-27292 chrome e--ua-blink e--ua-chrome e--ua-webkit" data-elementor-device-mode="none">
	<!-- start Simple Custom CSS and JS -->
<!-- Add HTML code to the header or the footer.

For example, you can use the following code for loading the jQuery library from Google CDN:
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

or the following one for loading the Bootstrap library from jsDelivr:
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">

-- End of the comment --> 

<!-- Google Tag Manager (noscript) -->

<!-- End Google Tag Manager (noscript) --><!-- end Simple Custom CSS and JS -->
		<div data-elementor-type="wpr-theme-builder" data-elementor-id="29780" class="elementor elementor-29780 post-32157 post type-post status-publish format-standard hentry category-uncategorized">
				<div class="elementor-element elementor-element-1942ca1 e-con-full e-flex wpr-particle-no wpr-jarallax-no wpr-parallax-no wpr-sticky-section-no e-con e-parent e-lazyloaded" data-id="1942ca1" data-element_type="container">
				<div class="elementor-element elementor-element-d4867ca elementor-widget__width-inherit elementor-widget elementor-widget-shortcode" data-id="d4867ca" data-element_type="widget" data-widget_type="shortcode.default">
				<div class="elementor-widget-container">
							<div class="elementor-shortcode">		<div data-elementor-type="container" data-elementor-id="29841" class="elementor elementor-29841">
				<div class="elementor-element elementor-element-ff046b7 elementor-hidden-desktop elementor-hidden-laptop elementor-hidden-tablet_extra elementor-hidden-tablet elementor-hidden-mobile_extra elementor-hidden-mobile e-flex e-con-boxed wpr-particle-no wpr-jarallax-no wpr-parallax-no wpr-sticky-section-no e-con e-parent e-lazyloaded" data-id="ff046b7" data-element_type="container">
					<div class="e-con-inner">
				<div class="elementor-element elementor-element-85f582a elementor-widget elementor-widget-html" data-id="85f582a" data-element_type="widget" data-widget_type="html.default">
				<div class="elementor-widget-container">
					<!-- Responsive Container -->
<div class="wkl-banner-container">
    
    <!-- The Image -->
    <img src="https://whiteknightlabs.com/wp-content/uploads/2025/12/WKL_Click-Here_R1-01.jpg" alt="White Knight Labs Training Bundle" class="wkl-banner-image">

    <!-- Area 1: Full Bundle -->
    <a href="https://buy.stripe.com/5kQcN55DFb5K8Rggfg9IQ0t" target="_blank" title="Full Bundle" class="wkl-link link-full-bundle"></a>

    <!-- Area 2: 2 Class Bundle -->
    <a href="https://buy.stripe.com/5kQbJ14zB7Ty8Rg9QS9IQ0y" target="_blank" title="2 Class Bundle" class="wkl-link link-2-class"></a>

    <!-- Area 3: 3 Class Bundle -->
    <a href="https://buy.stripe.com/fZu8wPc235Lq3wW0gi9IQ0x" target="_blank" title="3 Class Bundle" class="wkl-link link-3-class"></a>

</div>				</div>
				</div>
					</div>
				</div>
		<div class="elementor-element elementor-element-7e163265 z-header e-flex e-con-boxed wpr-particle-no wpr-jarallax-no wpr-parallax-no wpr-sticky-section-no e-con e-parent e-lazyloaded" data-id="7e163265" data-element_type="container">
					<div class="e-con-inner">
		<div class="elementor-element elementor-element-1d40857e e-con-full e-flex wpr-particle-no wpr-jarallax-no wpr-parallax-no wpr-sticky-section-no e-con e-child" data-id="1d40857e" data-element_type="container">
				<div class="elementor-element elementor-element-1b9885cb z-logo elementor-widget elementor-widget-image" data-id="1b9885cb" data-element_type="widget" data-widget_type="image.default">
				<div class="elementor-widget-container">
																<a href="https://whiteknightlabs.com/">
							<img width="202" height="70" src="https://whiteknightlabs.com/wp-content/uploads/2024/08/Logo-v2.png" class="attachment-full size-full wp-image-27321" alt="White Knight Labs Logo">								</a>
															</div>
				</div>
				</div>
		<div class="elementor-element elementor-element-109d0bc6 e-con-full e-flex wpr-particle-no wpr-jarallax-no wpr-parallax-no wpr-sticky-section-no e-con e-child" data-id="109d0bc6" data-element_type="container">
				<div class="elementor-element elementor-element-3d2d14f6 elementor-widget__width-auto hfe-submenu-icon-classic hfe-submenu-animation-slide_up z-menu elementor-widget-tablet__width-initial hfe-nav-menu__align-left hfe-link-redirect-child hfe-nav-menu__breakpoint-tablet elementor-widget elementor-widget-navigation-menu" data-id="3d2d14f6" data-element_type="widget" data-settings="{&quot;padding_horizontal_menu_item&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:0,&quot;sizes&quot;:[]},&quot;menu_space_between&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:44,&quot;sizes&quot;:[]},&quot;distance_from_menu_mobile&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:0,&quot;sizes&quot;:[]},&quot;padding_vertical_dropdown_item&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:14,&quot;sizes&quot;:[]},&quot;padding_horizontal_menu_item_laptop&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;padding_horizontal_menu_item_tablet_extra&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;padding_horizontal_menu_item_tablet&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;padding_horizontal_menu_item_mobile_extra&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;padding_horizontal_menu_item_mobile&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;padding_vertical_menu_item&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:15,&quot;sizes&quot;:[]},&quot;padding_vertical_menu_item_laptop&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;padding_vertical_menu_item_tablet_extra&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;padding_vertical_menu_item_tablet&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;padding_vertical_menu_item_mobile_extra&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;padding_vertical_menu_item_mobile&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;menu_space_between_laptop&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;menu_space_between_tablet_extra&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;menu_space_between_tablet&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;menu_space_between_mobile_extra&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;menu_space_between_mobile&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;menu_row_space&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;menu_row_space_laptop&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;menu_row_space_tablet_extra&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;menu_row_space_tablet&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;menu_row_space_mobile_extra&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;menu_row_space_mobile&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;dropdown_border_radius&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;top&quot;:&quot;&quot;,&quot;right&quot;:&quot;&quot;,&quot;bottom&quot;:&quot;&quot;,&quot;left&quot;:&quot;&quot;,&quot;isLinked&quot;:true},&quot;dropdown_border_radius_laptop&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;top&quot;:&quot;&quot;,&quot;right&quot;:&quot;&quot;,&quot;bottom&quot;:&quot;&quot;,&quot;left&quot;:&quot;&quot;,&quot;isLinked&quot;:true},&quot;dropdown_border_radius_tablet_extra&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;top&quot;:&quot;&quot;,&quot;right&quot;:&quot;&quot;,&quot;bottom&quot;:&quot;&quot;,&quot;left&quot;:&quot;&quot;,&quot;isLinked&quot;:true},&quot;dropdown_border_radius_tablet&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;top&quot;:&quot;&quot;,&quot;right&quot;:&quot;&quot;,&quot;bottom&quot;:&quot;&quot;,&quot;left&quot;:&quot;&quot;,&quot;isLinked&quot;:true},&quot;dropdown_border_radius_mobile_extra&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;top&quot;:&quot;&quot;,&quot;right&quot;:&quot;&quot;,&quot;bottom&quot;:&quot;&quot;,&quot;left&quot;:&quot;&quot;,&quot;isLinked&quot;:true},&quot;dropdown_border_radius_mobile&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;top&quot;:&quot;&quot;,&quot;right&quot;:&quot;&quot;,&quot;bottom&quot;:&quot;&quot;,&quot;left&quot;:&quot;&quot;,&quot;isLinked&quot;:true},&quot;width_dropdown_item&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;220&quot;,&quot;sizes&quot;:[]},&quot;width_dropdown_item_laptop&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;width_dropdown_item_tablet_extra&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;width_dropdown_item_tablet&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;width_dropdown_item_mobile_extra&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;width_dropdown_item_mobile&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;padding_horizontal_dropdown_item&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;padding_horizontal_dropdown_item_laptop&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;padding_horizontal_dropdown_item_tablet_extra&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;padding_horizontal_dropdown_item_tablet&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;padding_horizontal_dropdown_item_mobile_extra&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;padding_horizontal_dropdown_item_mobile&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;padding_vertical_dropdown_item_laptop&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;padding_vertical_dropdown_item_tablet_extra&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;padding_vertical_dropdown_item_tablet&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;padding_vertical_dropdown_item_mobile_extra&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;padding_vertical_dropdown_item_mobile&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;distance_from_menu&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;distance_from_menu_laptop&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;distance_from_menu_tablet_extra&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;distance_from_menu_tablet&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;distance_from_menu_mobile_extra&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;toggle_size&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;toggle_size_laptop&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;toggle_size_tablet_extra&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;toggle_size_tablet&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;toggle_size_mobile_extra&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;toggle_size_mobile&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;toggle_border_width&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;toggle_border_width_laptop&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;toggle_border_width_tablet_extra&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;toggle_border_width_tablet&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;toggle_border_width_mobile_extra&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;toggle_border_width_mobile&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;toggle_border_radius&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;toggle_border_radius_laptop&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;toggle_border_radius_tablet_extra&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;toggle_border_radius_tablet&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;toggle_border_radius_mobile_extra&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;toggle_border_radius_mobile&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]}}" data-widget_type="navigation-menu.default">
				<div class="elementor-widget-container">
								<div class="hfe-nav-menu hfe-layout-horizontal hfe-nav-menu-layout horizontal hfe-pointer__none" data-layout="horizontal">
				<div role="button" class="hfe-nav-menu__toggle elementor-clickable" aria-haspopup="true" aria-expanded="false">
					<span class="screen-reader-text">Menu</span>
					<div class="hfe-nav-menu-icon">
						<svg aria-hidden="true" class="e-font-icon-svg e-fas-align-justify" viewBox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M432 416H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-128H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-128H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-128H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16z"></path></svg>					</div>
				</div>
				
			</div>
							</div>
				</div>
				<div class="elementor-element elementor-element-2ce86a3 hfe-search-layout-icon elementor-hidden-tablet elementor-hidden-mobile_extra elementor-hidden-mobile elementor-widget elementor-widget-hfe-search-button" data-id="2ce86a3" data-element_type="widget" data-settings="{&quot;toggle_icon_size&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:20,&quot;sizes&quot;:[]},&quot;input_icon_size&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:200,&quot;sizes&quot;:[]},&quot;input_icon_size_laptop&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;input_icon_size_tablet_extra&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;input_icon_size_tablet&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;input_icon_size_mobile_extra&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;input_icon_size_mobile&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;toggle_icon_size_laptop&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;toggle_icon_size_tablet_extra&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;toggle_icon_size_tablet&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;toggle_icon_size_mobile_extra&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]},&quot;toggle_icon_size_mobile&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:&quot;&quot;,&quot;sizes&quot;:[]}}" data-widget_type="hfe-search-button.default">
				<div class="elementor-widget-container">
							<form class="hfe-search-button-wrapper" role="search" action="https://whiteknightlabs.com/" method="get">

						<div class="hfe-search-icon-toggle">
				<input placeholder="" class="hfe-search-form__input" type="search" name="s" title="Search" value="" style="padding-right: 20px;">
				<i class="fas fa-search" aria-hidden="true"></i>
			</div>
					</form>
						</div>
				</div>
				</div>
					</div>
				</div>
				</div>
		<span class="wpr-template-edit-btn" data-permalink="https://whiteknightlabs.com/?elementor_library=z-header">Edit Template</span></div>
						</div>
				</div>
				</div>
		<div class="elementor-element elementor-element-5aa7457 e-flex e-con-boxed wpr-particle-no wpr-jarallax-no wpr-parallax-no wpr-sticky-section-no e-con e-parent e-lazyloaded" data-id="5aa7457" data-element_type="container" data-settings="{&quot;background_background&quot;:&quot;classic&quot;}">
					<div class="e-con-inner">
		<div class="elementor-element elementor-element-5ee8ea2 e-con-full e-flex wpr-particle-no wpr-jarallax-no wpr-parallax-no wpr-sticky-section-no e-con e-child" data-id="5ee8ea2" data-element_type="container">
		<div class="elementor-element elementor-element-0708fe0 e-con-full e-flex wpr-particle-no wpr-jarallax-no wpr-parallax-no wpr-sticky-section-no e-con e-child" data-id="0708fe0" data-element_type="container">
				<div class="elementor-element elementor-element-0d1c8bf elementor-widget elementor-widget-wpr-post-title" data-id="0d1c8bf" data-element_type="widget" data-widget_type="wpr-post-title.default">
				<div class="elementor-widget-container">
					<h1 class="wpr-post-title">Understanding Double Free in Windows Kernel Drivers</h1>				</div>
				</div>
				</div>
				</div>
					</div>
				</div>
		<div class="elementor-element elementor-element-96821df e-flex e-con-boxed wpr-particle-no wpr-jarallax-no wpr-parallax-no wpr-sticky-section-no e-con e-parent e-lazyloaded" data-id="96821df" data-element_type="container">
					<div class="e-con-inner">
		<div class="elementor-element elementor-element-7ede4ff e-con-full e-flex wpr-particle-no wpr-jarallax-no wpr-parallax-no wpr-sticky-section-no e-con e-child" data-id="7ede4ff" data-element_type="container">
				<div class="elementor-element elementor-element-f03e909 wpr-post-info-align-left elementor-widget__width-inherit elementor-widget elementor-widget-wpr-post-info" data-id="f03e909" data-element_type="widget" data-widget_type="wpr-post-info.default">
				<div class="elementor-widget-container">
					<ul class="wpr-post-info wpr-post-info-horizontal"><li class="wpr-post-info-author"><span>Jay Pandya</span></li><li class="wpr-post-info-date"><span>June 10, 2025</span></li><li class="wpr-post-info-taxonomy"><span>Uncategorized</span></li><li class="wpr-post-info-comments"></li></ul>				</div>
				</div>
				<div class="elementor-element elementor-element-c933496 elementor-widget__width-auto elementor-widget elementor-widget-wpr-post-media" data-id="c933496" data-element_type="widget" data-widget_type="wpr-post-media.default">
				<div class="elementor-widget-container">
					<div class="wpr-featured-media-wrap" data-caption="standard"></div>				</div>
				</div>
				<div class="elementor-element elementor-element-450bc4c elementor-widget__width-inherit z-post-content elementor-widget elementor-widget-wpr-post-content" data-id="450bc4c" data-element_type="widget" data-widget_type="wpr-post-content.default">
				<div class="elementor-widget-container">
					<div class="wpr-post-content">
<h1 class="wp-block-heading">What is Double-Free?</h1>



<p>A <strong>double-free</strong> vulnerability occurs when a program <strong>frees the same memory block multiple times</strong>. This typically happens when <code>ExFreePoolWithTag</code> or <code>ExFreePool </code>is called twice on the same pointer, causing corruption in the Windows kernel memory allocator. If an attacker can predict or control the reallocation of this memory, they may be able to <strong>corrupt memory structures</strong>, <strong>overwrite critical pointers</strong>, or <strong>redirect execution flow</strong> to controlled memory regions. Double-free vulnerabilities often lead to <strong>heap corruption, kernel crashes (BSOD), or even arbitrary code execution</strong>, if exploited properly.</p>



<div style="height:4px" aria-hidden="true" class="wp-block-spacer"></div>



<h3 class="wp-block-heading">1. Classic Double-Free (Same Function Call Twice)</h3>



<p><strong>Concept:</strong></p>



<p>The driver allocates memory using <code>ExAllocatePoolWithTag </code>and <strong>frees it twice</strong> using <code>ExFreePoolWithTag</code>. This causes corruption in the pool allocator, potentially leading to <strong>heap corruption or arbitrary execution</strong>. In this example, we implement a custom kernel driver that <strong>allocates a pool of memory</strong>, <strong>frees twice it</strong>, and then <strong>intentionally accesses it</strong>, triggering a BSOD.</p>



<figure data-wp-context="{&quot;imageId&quot;:&quot;69959ff98cc31&quot;}" data-wp-interactive="core/image" data-wp-key="69959ff98cc31" class="wp-block-image aligncenter size-full is-resized wp-lightbox-container"><img fetchpriority="high" decoding="async" width="852" height="389" data-wp-class--hide="state.isContentHidden" data-wp-class--show="state.isContentVisible" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://whiteknightlabs.com/wp-content/uploads/2025/04/13-Uaf.png" alt="" class="wp-image-31920" style="width:840px;height:auto"><button class="lightbox-trigger" type="button" aria-haspopup="dialog" aria-label="Enlarge" data-wp-init="callbacks.initTriggerButton" data-wp-on--click="actions.showLightbox" data-wp-style--right="state.imageButtonRight" data-wp-style--top="state.imageButtonTop" style="right: 16px; top: 16px;">
			<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="none" viewBox="0 0 12 12">
				<path fill="#fff" d="M2 0a2 2 0 0 0-2 2v2h1.5V2a.5.5 0 0 1 .5-.5h2V0H2Zm2 10.5H2a.5.5 0 0 1-.5-.5V8H0v2a2 2 0 0 0 2 2h2v-1.5ZM8 12v-1.5h2a.5.5 0 0 0 .5-.5V8H12v2a2 2 0 0 1-2 2H8Zm2-12a2 2 0 0 1 2 2v2h-1.5V2a.5.5 0 0 0-.5-.5H8V0h2Z"></path>
			</svg>
		</button><figcaption class="wp-element-caption">Double-free with ExfreePoolWithTag</figcaption></figure>



<p>The vulnerability occurs because <code>g_DoubleFreeMemory</code> is <strong>freed twice</strong> using <code>ExFreePoolWithTag</code>, leading to a <strong>double-free bug</strong>. After the first free, the pointer still holds the now-invalid memory address, allowing a second <code>ExFreePoolWithTag</code> call on an already freed block. This can lead to <strong>memory corruption</strong>, potential <strong>use-after-free (UAF) scenarios</strong>, and <strong>arbitrary code execution</strong> if an attacker reallocates the freed memory.</p>



<div style="height:4px" aria-hidden="true" class="wp-block-spacer"></div>



<h4 class="wp-block-heading">Simple BSOD with Double-Free in a Custom Driver</h4>



<p>The exploit will follow the same pattern as previously explained, as shown with the blue screen below.</p>



<figure data-wp-context="{&quot;imageId&quot;:&quot;69959ff98d5c9&quot;}" data-wp-interactive="core/image" data-wp-key="69959ff98d5c9" class="wp-block-image aligncenter size-full is-resized wp-lightbox-container"><img decoding="async" width="599" height="425" data-wp-class--hide="state.isContentHidden" data-wp-class--show="state.isContentVisible" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://whiteknightlabs.com/wp-content/uploads/2025/04/14-uaf.png" alt="" class="wp-image-31921" style="width:686px;height:auto"><button class="lightbox-trigger" type="button" aria-haspopup="dialog" aria-label="Enlarge" data-wp-init="callbacks.initTriggerButton" data-wp-on--click="actions.showLightbox" data-wp-style--right="state.imageButtonRight" data-wp-style--top="state.imageButtonTop" style="right: 16px; top: 16px;">
			<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="none" viewBox="0 0 12 12">
				<path fill="#fff" d="M2 0a2 2 0 0 0-2 2v2h1.5V2a.5.5 0 0 1 .5-.5h2V0H2Zm2 10.5H2a.5.5 0 0 1-.5-.5V8H0v2a2 2 0 0 0 2 2h2v-1.5ZM8 12v-1.5h2a.5.5 0 0 0 .5-.5V8H12v2a2 2 0 0 1-2 2H8Zm2-12a2 2 0 0 1 2 2v2h-1.5V2a.5.5 0 0 0-.5-.5H8V0h2Z"></path>
			</svg>
		</button><figcaption class="wp-element-caption"><em>Blue screen of death</em></figcaption></figure>



<h3 class="wp-block-heading">2. Double free via Memory Descriptor List</h3>



<p><code>IoFreeMdl</code> is used to release a Memory Descriptor List (MDL) in Windows kernel mode. Incorrect handling, such as double-freeing an MDL, can lead to system crashes or exploitation opportunities. This guide demonstrates creating a custom kernel driver that contains a double-free vulnerability and a user-mode PoC to trigger it.</p>



<figure data-wp-context="{&quot;imageId&quot;:&quot;69959ff98dc86&quot;}" data-wp-interactive="core/image" data-wp-key="69959ff98dc86" class="wp-block-image aligncenter size-full wp-lightbox-container"><img decoding="async" width="913" height="410" data-wp-class--hide="state.isContentHidden" data-wp-class--show="state.isContentVisible" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://whiteknightlabs.com/wp-content/uploads/2025/04/15-Uaf.png" alt="" class="wp-image-31922"><button class="lightbox-trigger" type="button" aria-haspopup="dialog" aria-label="Enlarge" data-wp-init="callbacks.initTriggerButton" data-wp-on--click="actions.showLightbox" data-wp-style--right="state.imageButtonRight" data-wp-style--top="state.imageButtonTop" style="right: 16px; top: 16px;">
			<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="none" viewBox="0 0 12 12">
				<path fill="#fff" d="M2 0a2 2 0 0 0-2 2v2h1.5V2a.5.5 0 0 1 .5-.5h2V0H2Zm2 10.5H2a.5.5 0 0 1-.5-.5V8H0v2a2 2 0 0 0 2 2h2v-1.5ZM8 12v-1.5h2a.5.5 0 0 0 .5-.5V8H12v2a2 2 0 0 1-2 2H8Zm2-12a2 2 0 0 1 2 2v2h-1.5V2a.5.5 0 0 0-.5-.5H8V0h2Z"></path>
			</svg>
		</button><figcaption class="wp-element-caption">IoFreeMdl double-free</figcaption></figure>



<p>In this code, an MDL (<code>g_Mdl</code>) is allocated using <code>IoAllocateMdl</code>, and its successful allocation is logged. The first call to <code>IoFreeMdl</code> (<code>g_Mdl</code>) correctly frees the MDL. A <code>KeDelayExecutionThread</code> introduces a 1-second delay before attempting to free the already-freed MDL again, triggering a <strong>double-free vulnerability</strong>.</p>



<div style="height:4px" aria-hidden="true" class="wp-block-spacer"></div>



<h4 class="wp-block-heading">Simple BSOD with Double-Free in a Custom Driver</h4>



<p>This user-mode PoC opens a handle to the vulnerable driver (<code>DoubleFreeLink</code>) and sends an <strong>IOCTL request </strong>(<code>IOCTL_TRIGGER_DOUBLE_FREE</code>) to trigger the double-free vulnerability in the kernel driver. If successful, the exploit could lead to a system crash or potential exploitation.</p>



<p></p>



<figure data-wp-context="{&quot;imageId&quot;:&quot;69959ff98e458&quot;}" data-wp-interactive="core/image" data-wp-key="69959ff98e458" class="wp-block-image aligncenter size-full wp-lightbox-container"><img loading="lazy" decoding="async" width="1069" height="553" data-wp-class--hide="state.isContentHidden" data-wp-class--show="state.isContentVisible" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://whiteknightlabs.com/wp-content/uploads/2025/04/16-uaf.png" alt="" class="wp-image-31923"><button class="lightbox-trigger" type="button" aria-haspopup="dialog" aria-label="Enlarge" data-wp-init="callbacks.initTriggerButton" data-wp-on--click="actions.showLightbox" data-wp-style--right="state.imageButtonRight" data-wp-style--top="state.imageButtonTop" style="right: 16px; top: 16px;">
			<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="none" viewBox="0 0 12 12">
				<path fill="#fff" d="M2 0a2 2 0 0 0-2 2v2h1.5V2a.5.5 0 0 1 .5-.5h2V0H2Zm2 10.5H2a.5.5 0 0 1-.5-.5V8H0v2a2 2 0 0 0 2 2h2v-1.5ZM8 12v-1.5h2a.5.5 0 0 0 .5-.5V8H12v2a2 2 0 0 1-2 2H8Zm2-12a2 2 0 0 1 2 2v2h-1.5V2a.5.5 0 0 0-.5-.5H8V0h2Z"></path>
			</svg>
		</button><figcaption class="wp-element-caption">Weaponizing exploit for double-free</figcaption></figure>



<p></p>



<p><strong>BSOD Triggered:</strong> The system crashes with a <strong>BUGCHECK_CODE: 0x4E (PFN_LIST_CORRUPT)</strong> due to the <strong>double-free of an MDL</strong> in the kernel driver.</p>



<figure data-wp-context="{&quot;imageId&quot;:&quot;69959ff98ea60&quot;}" data-wp-interactive="core/image" data-wp-key="69959ff98ea60" class="wp-block-image aligncenter size-full is-resized wp-lightbox-container"><img loading="lazy" decoding="async" width="589" height="441" data-wp-class--hide="state.isContentHidden" data-wp-class--show="state.isContentVisible" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://whiteknightlabs.com/wp-content/uploads/2025/04/17-uaf.png" alt="" class="wp-image-31924" style="width:689px;height:auto"><button class="lightbox-trigger" type="button" aria-haspopup="dialog" aria-label="Enlarge" data-wp-init="callbacks.initTriggerButton" data-wp-on--click="actions.showLightbox" data-wp-style--right="state.imageButtonRight" data-wp-style--top="state.imageButtonTop">
			<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="none" viewBox="0 0 12 12">
				<path fill="#fff" d="M2 0a2 2 0 0 0-2 2v2h1.5V2a.5.5 0 0 1 .5-.5h2V0H2Zm2 10.5H2a.5.5 0 0 1-.5-.5V8H0v2a2 2 0 0 0 2 2h2v-1.5ZM8 12v-1.5h2a.5.5 0 0 0 .5-.5V8H12v2a2 2 0 0 1-2 2H8Zm2-12a2 2 0 0 1 2 2v2h-1.5V2a.5.5 0 0 0-.5-.5H8V0h2Z"></path>
			</svg>
		</button><figcaption class="wp-element-caption"><em>Blue screen of death</em></figcaption></figure>



<p></p>



<h2 class="wp-block-heading">Making Double-Free More Challenging</h2>



<p>Weâ€™ve explored basic use-after-free (UAF) and double-free vulnerabilities, which might seem easy to understand. However, in real-world scenarios, these bugs are much harder to detect and exploit. Unlike simple examples, real UAF and double-free issues are rare and often require luck to find. Now, letâ€™s step up the challengeâ€”Iâ€™ll introduce a slightly more complex case that mirrors real-world scenarios but remains understandable.</p>



<div style="height:4px" aria-hidden="true" class="wp-block-spacer"></div>



<h3 class="wp-block-heading">0. Setup: Struct-Based Resource Handling</h3>



<p>Before diving into allocation, letâ€™s understand the structure.</p>



<figure data-wp-context="{&quot;imageId&quot;:&quot;69959ff98f7cb&quot;}" data-wp-interactive="core/image" data-wp-key="69959ff98f7cb" class="wp-block-image aligncenter size-full is-resized wp-lightbox-container"><img loading="lazy" decoding="async" width="362" height="87" data-wp-class--hide="state.isContentHidden" data-wp-class--show="state.isContentVisible" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://whiteknightlabs.com/wp-content/uploads/2025/04/image.png" alt="" class="wp-image-31904" style="width:618px;height:auto"><button class="lightbox-trigger" type="button" aria-haspopup="dialog" aria-label="Enlarge" data-wp-init="callbacks.initTriggerButton" data-wp-on--click="actions.showLightbox" data-wp-style--right="state.imageButtonRight" data-wp-style--top="state.imageButtonTop">
			<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="none" viewBox="0 0 12 12">
				<path fill="#fff" d="M2 0a2 2 0 0 0-2 2v2h1.5V2a.5.5 0 0 1 .5-.5h2V0H2Zm2 10.5H2a.5.5 0 0 1-.5-.5V8H0v2a2 2 0 0 0 2 2h2v-1.5ZM8 12v-1.5h2a.5.5 0 0 0 .5-.5V8H12v2a2 2 0 0 1-2 2H8Zm2-12a2 2 0 0 1 2 2v2h-1.5V2a.5.5 0 0 0-.5-.5H8V0h2Z"></path>
			</svg>
		</button><figcaption class="wp-element-caption"><em>Defining dummy buffer structure</em></figcaption></figure>



<p>This struct mimics a common pattern in driver development wrapping raw buffers inside helper structures. These wrappers often abstract buffer ownership and lifecycle management, <strong>but when misused, they also obscure bugs</strong> like double-free and UAF. Thatâ€™s exactly what happens here.</p>



<div style="height:4px" aria-hidden="true" class="wp-block-spacer"></div>



<h3 class="wp-block-heading">1. Allocation Phase</h3>



<p>This setup is clean and typical in real-world Windows drivers. But hereâ€™s the catch: <strong>no centralized memory tracking</strong>, no flags, and <strong>no safe-guard against double cleanup</strong>. A disaster waiting to happen if callbacks are reused.</p>



<p></p>



<figure data-wp-context="{&quot;imageId&quot;:&quot;69959ff98ff85&quot;}" data-wp-interactive="core/image" data-wp-key="69959ff98ff85" class="wp-block-image aligncenter size-full wp-lightbox-container"><img loading="lazy" decoding="async" width="1280" height="403" data-wp-class--hide="state.isContentHidden" data-wp-class--show="state.isContentVisible" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://whiteknightlabs.com/wp-content/uploads/2025/04/19uaf.png" alt="" class="wp-image-31927"><button class="lightbox-trigger" type="button" aria-haspopup="dialog" aria-label="Enlarge" data-wp-init="callbacks.initTriggerButton" data-wp-on--click="actions.showLightbox" data-wp-style--right="state.imageButtonRight" data-wp-style--top="state.imageButtonTop">
			<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="none" viewBox="0 0 12 12">
				<path fill="#fff" d="M2 0a2 2 0 0 0-2 2v2h1.5V2a.5.5 0 0 1 .5-.5h2V0H2Zm2 10.5H2a.5.5 0 0 1-.5-.5V8H0v2a2 2 0 0 0 2 2h2v-1.5ZM8 12v-1.5h2a.5.5 0 0 0 .5-.5V8H12v2a2 2 0 0 1-2 2H8Zm2-12a2 2 0 0 1 2 2v2h-1.5V2a.5.5 0 0 0-.5-.5H8V0h2Z"></path>
			</svg>
		</button><figcaption class="wp-element-caption"><em>Allocating pool tag</em></figcaption></figure>



<p>In this step, we allocate memory twice:</p>



<ul class="wp-block-list">
<li>First, for the structure <code>pDummy</code>, which will manage the lifetime of an internal buffer.</li>



<li>Second, for the actual buffer inside the structure (<code>pDummy-&gt;Buffer</code>) a 0x100-sized non-paged memory block.</li>
</ul>



<div style="height:4px" aria-hidden="true" class="wp-block-spacer"></div>



<h3 class="wp-block-heading">2. Double-Free via Wrapped FreeHandle Routine</h3>



<p>The double-free vulnerability is triggered when the buffer <code>pDummy-&gt;Buffer</code> is first manually freed.</p>



<figure data-wp-context="{&quot;imageId&quot;:&quot;69959ff990747&quot;}" data-wp-interactive="core/image" data-wp-key="69959ff990747" class="wp-block-image aligncenter size-full is-resized wp-lightbox-container"><img loading="lazy" decoding="async" width="587" height="166" data-wp-class--hide="state.isContentHidden" data-wp-class--show="state.isContentVisible" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://whiteknightlabs.com/wp-content/uploads/2025/04/20-uaf.png" alt="" class="wp-image-31928" style="width:775px;height:auto"><button class="lightbox-trigger" type="button" aria-haspopup="dialog" aria-label="Enlarge" data-wp-init="callbacks.initTriggerButton" data-wp-on--click="actions.showLightbox" data-wp-style--right="state.imageButtonRight" data-wp-style--top="state.imageButtonTop">
			<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="none" viewBox="0 0 12 12">
				<path fill="#fff" d="M2 0a2 2 0 0 0-2 2v2h1.5V2a.5.5 0 0 1 .5-.5h2V0H2Zm2 10.5H2a.5.5 0 0 1-.5-.5V8H0v2a2 2 0 0 0 2 2h2v-1.5ZM8 12v-1.5h2a.5.5 0 0 0 .5-.5V8H12v2a2 2 0 0 1-2 2H8Zm2-12a2 2 0 0 1 2 2v2h-1.5V2a.5.5 0 0 0-.5-.5H8V0h2Z"></path>
			</svg>
		</button><figcaption class="wp-element-caption"><em>Simulating double-free</em></figcaption></figure>



<p>This simulates a typical cleanup scenario like ğ™²ğ™³ğš˜ğš ğš—ğš•ğš˜ğšŠğšğ™±ğšğšğšğšğš›::ğšğšğš•ğšğšŠğšœğš() but the buffer pointer is never nullified or flagged as freed. Later, the driver calls a helper routine wrapped around the cleanup phase:</p>



<p>Inside <code>FreeHandle()</code>, the same buffer is freed again without validation.</p>



<figure data-wp-context="{&quot;imageId&quot;:&quot;69959ff990d87&quot;}" data-wp-interactive="core/image" data-wp-key="69959ff990d87" class="wp-block-image aligncenter size-full is-resized wp-lightbox-container"><img loading="lazy" decoding="async" width="707" height="127" data-wp-class--hide="state.isContentHidden" data-wp-class--show="state.isContentVisible" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://whiteknightlabs.com/wp-content/uploads/2025/04/21-uaf.png" alt="" class="wp-image-31929" style="width:793px;height:auto"><button class="lightbox-trigger" type="button" aria-haspopup="dialog" aria-label="Enlarge" data-wp-init="callbacks.initTriggerButton" data-wp-on--click="actions.showLightbox" data-wp-style--right="state.imageButtonRight" data-wp-style--top="state.imageButtonTop">
			<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="none" viewBox="0 0 12 12">
				<path fill="#fff" d="M2 0a2 2 0 0 0-2 2v2h1.5V2a.5.5 0 0 1 .5-.5h2V0H2Zm2 10.5H2a.5.5 0 0 1-.5-.5V8H0v2a2 2 0 0 0 2 2h2v-1.5ZM8 12v-1.5h2a.5.5 0 0 0 .5-.5V8H12v2a2 2 0 0 1-2 2H8Zm2-12a2 2 0 0 1 2 2v2h-1.5V2a.5.5 0 0 0-.5-.5H8V0h2Z"></path>
			</svg>
		</button><figcaption class="wp-element-caption"><em>Free handle function</em></figcaption></figure>



<p>Because <code>FreeHandle()</code> blindly assumes ownership and responsibility for cleanup, it unknowingly triggers a second free on an already-freed memory block. This cleanup wrapping common in error handling paths, <code>DriverUnload</code>, or exception-safe routines makes such bugs deceptively difficult to detect in large codebases. The result? A dangerous double-free that can corrupt memory or open the door to further exploitation.</p>



<div style="height:4px" aria-hidden="true" class="wp-block-spacer"></div>



<h3 class="wp-block-heading">Summary: Wrapping Around Danger â€“ Double-Free in Disguise</h3>



<p>This driver shows a classic double-free bug: memory is freed once directly, then again via a cleanup callback (<code>FreeHandle</code>). The issue lies in freeing <code>pDummy-&gt;Buffer</code> twice without resetting or checking ownership.</p>



<p>What makes it tricky is how the second free is <em>wrapped</em> in a callback just like real-world code, where cleanup is scattered across destructors or handlers, making such bugs harder to catch in large systems.</p>



<div style="height:4px" aria-hidden="true" class="wp-block-spacer"></div>



<h3 class="wp-block-heading">Double-Free (Mitigation):</h3>



<p>Double-free vulnerabilities can be avoided by <strong>nullifying pointers after the first free</strong>, and checking their state before every deallocation. In complex code with shared pointers or cleanup callbacks, use <strong>flags</strong> or <strong>state checks</strong> to ensure memory is freed only once.</p>



<p></p>



<figure data-wp-context="{&quot;imageId&quot;:&quot;69959ff991514&quot;}" data-wp-interactive="core/image" data-wp-key="69959ff991514" class="wp-block-image aligncenter size-full wp-lightbox-container"><img loading="lazy" decoding="async" width="751" height="261" data-wp-class--hide="state.isContentHidden" data-wp-class--show="state.isContentVisible" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://whiteknightlabs.com/wp-content/uploads/2025/04/23uaf.png" alt="" class="wp-image-31931"><button class="lightbox-trigger" type="button" aria-haspopup="dialog" aria-label="Enlarge" data-wp-init="callbacks.initTriggerButton" data-wp-on--click="actions.showLightbox" data-wp-style--right="state.imageButtonRight" data-wp-style--top="state.imageButtonTop">
			<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="none" viewBox="0 0 12 12">
				<path fill="#fff" d="M2 0a2 2 0 0 0-2 2v2h1.5V2a.5.5 0 0 1 .5-.5h2V0H2Zm2 10.5H2a.5.5 0 0 1-.5-.5V8H0v2a2 2 0 0 0 2 2h2v-1.5ZM8 12v-1.5h2a.5.5 0 0 0 .5-.5V8H12v2a2 2 0 0 1-2 2H8Zm2-12a2 2 0 0 1 2 2v2h-1.5V2a.5.5 0 0 0-.5-.5H8V0h2Z"></path>
			</svg>
		</button><figcaption class="wp-element-caption"><em>Mitigating double-free</em></figcaption></figure>



<p></p>



<h2 class="wp-block-heading">Bonus Tip: Spotting Double-Free in Windows Drivers</h2>



<p>To identify double-free vulnerabilities, start by looking for <strong>deallocation functions</strong>. In user-mode, watch for <code>free</code>, <code>delete</code>, <code>GlobalFree</code>, or <code>Release</code>. In Windows kernel drivers, key functions include <code>ExFreePoolWithTag</code>, <code>IoFreeMdl</code>, <code>ObDereferenceObject</code>, <code>MmFreeContiguousMemory</code>, and <code>RtlFreeHeap</code>. Many of these calls are <strong>wrapped</strong> inside internal cleanup functions or callbacks (like <code>CDownloadBuffer::Release</code> or <code>FreeHandle</code>), which can obscure the actual free. Always trace pointer lifecycle: if itâ€™s freed and still accessed or freed again, thatâ€™s a bug. Check if the pointer is <strong>nullified or checked</strong> post-freeâ€”if not, it might be reused unsafely.</p>
</div>				</div>
				</div>
				</div>
		<div class="elementor-element elementor-element-0c49398 e-con-full e-flex wpr-particle-no wpr-jarallax-no wpr-parallax-no wpr-sticky-section-no e-con e-child" data-id="0c49398" data-element_type="container">
				<div class="elementor-element elementor-element-62f14cd elementor-widget__width-inherit wpr-search-form-style-inner wpr-search-form-position-right elementor-widget elementor-widget-wpr-search" data-id="62f14cd" data-element_type="widget" data-widget_type="wpr-search.default">
				<div class="elementor-widget-container">
					
		<form role="search" method="get" class="wpr-search-form" action="https://whiteknightlabs.com/" autocomplete="off">

			<div class="wpr-search-form-input-wrap elementor-clearfix">
				<input class="wpr-search-form-input" placeholder="Search..." aria-label="Search" type="search" name="s" title="Search" value="" wpr-query-type="all" wpr-taxonomy-type="" number-of-results="2" ajax-search="yes" show-description="" number-of-words="30" show-ajax-thumbnails="yes" show-view-result-btn="yes" show-product-price="no" view-result-text="View Results" no-results="No Results Found" exclude-without-thumb="" link-target="_blank" password-protected="no" attachments="no">
				
		<button class="wpr-search-form-submit" aria-label="Search" type="submit">
							<i class="fas fa-search"></i>
					</button>

					</div>

					</form>
		<div class="wpr-data-fetch">
			<span class="wpr-close-search"></span>
			<ul></ul>
					</div>
		
						</div>
				</div>
				<div class="elementor-element elementor-element-2b851b1 elementor-widget__width-initial elementor-widget elementor-widget-heading" data-id="2b851b1" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
					<h4 class="elementor-heading-title elementor-size-default">Recent Posts</h4>				</div>
				</div>
				<div class="elementor-element elementor-element-9dfaca4 elementor-widget elementor-widget-elementskit-post-list" data-id="9dfaca4" data-element_type="widget" data-widget_type="elementskit-post-list.default">
				<div class="elementor-widget-container">
					<div class="ekit-wid-con">		<ul class="elementor-icon-list-items ekit-post-list-wrapper ">
						<li class="elementor-icon-list-item   ">
				<a href="https://whiteknightlabs.com/2026/01/20/backdooring-electron-applications/">
													<span class="elementor-icon-list-icon">
									<svg aria-hidden="true" class="e-font-icon-svg e-fas-angle-right" viewBox="0 0 256 512" xmlns="http://www.w3.org/2000/svg"><path d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9 0l-22.6-22.6c-9.4-9.4-9.4-24.6 0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6 0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9 0l136 136c9.5 9.4 9.5 24.6.1 34z"></path></svg>								</span>
												<div class="ekit_post_list_content_wraper">
						
						<span class="elementor-icon-list-text">Backdooring Electron Applications</span>

											</div>
				</a>
			</li>
					<li class="elementor-icon-list-item   ">
				<a href="https://whiteknightlabs.com/2026/01/13/uefi-vulnerability-analysis-using-ai-part-3-scaling-understanding-not-just-context/">
													<span class="elementor-icon-list-icon">
									<svg aria-hidden="true" class="e-font-icon-svg e-fas-angle-right" viewBox="0 0 256 512" xmlns="http://www.w3.org/2000/svg"><path d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9 0l-22.6-22.6c-9.4-9.4-9.4-24.6 0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6 0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9 0l136 136c9.5 9.4 9.5 24.6.1 34z"></path></svg>								</span>
												<div class="ekit_post_list_content_wraper">
						
						<span class="elementor-icon-list-text">UEFI Vulnerability Analysis Using AI Part 3: Scaling Understanding, Not Just Context</span>

											</div>
				</a>
			</li>
					<li class="elementor-icon-list-item   ">
				<a href="https://whiteknightlabs.com/2026/01/06/the-new-chapter-of-egress-communication-with-cobalt-strike-user-defined-c2/">
													<span class="elementor-icon-list-icon">
									<svg aria-hidden="true" class="e-font-icon-svg e-fas-angle-right" viewBox="0 0 256 512" xmlns="http://www.w3.org/2000/svg"><path d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9 0l-22.6-22.6c-9.4-9.4-9.4-24.6 0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6 0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9 0l136 136c9.5 9.4 9.5 24.6.1 34z"></path></svg>								</span>
												<div class="ekit_post_list_content_wraper">
						
						<span class="elementor-icon-list-text">The New Chapter of Egress Communication with Cobalt Strike User-Defined C2</span>

											</div>
				</a>
			</li>
					<li class="elementor-icon-list-item   ">
				<a href="https://whiteknightlabs.com/2025/12/30/uefi-vulnerability-analysis-using-ai-part-2-breaking-the-token-barrier/">
													<span class="elementor-icon-list-icon">
									<svg aria-hidden="true" class="e-font-icon-svg e-fas-angle-right" viewBox="0 0 256 512" xmlns="http://www.w3.org/2000/svg"><path d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9 0l-22.6-22.6c-9.4-9.4-9.4-24.6 0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6 0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9 0l136 136c9.5 9.4 9.5 24.6.1 34z"></path></svg>								</span>
												<div class="ekit_post_list_content_wraper">
						
						<span class="elementor-icon-list-text">UEFI Vulnerability Analysis using AI Part 2: Breaking the Token Barrier</span>

											</div>
				</a>
			</li>
					<li class="elementor-icon-list-item   ">
				<a href="https://whiteknightlabs.com/2025/12/23/just-in-time-for-runtime-interpretation-unmasking-the-world-of-llvm-ir-based-jit-execution/">
													<span class="elementor-icon-list-icon">
									<svg aria-hidden="true" class="e-font-icon-svg e-fas-angle-right" viewBox="0 0 256 512" xmlns="http://www.w3.org/2000/svg"><path d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9 0l-22.6-22.6c-9.4-9.4-9.4-24.6 0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6 0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9 0l136 136c9.5 9.4 9.5 24.6.1 34z"></path></svg>								</span>
												<div class="ekit_post_list_content_wraper">
						
						<span class="elementor-icon-list-text">Just-in-Time for Runtime Interpretation - Unmasking the World of LLVM IR Based JIT Execution</span>

											</div>
				</a>
			</li>
				</ul>
		</div>				</div>
				</div>
				<div class="elementor-element elementor-element-8bf564f elementor-widget__width-initial elementor-hidden-desktop elementor-hidden-laptop elementor-hidden-tablet_extra elementor-hidden-tablet elementor-hidden-mobile_extra elementor-hidden-mobile elementor-widget elementor-widget-heading" data-id="8bf564f" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
					<h4 class="elementor-heading-title elementor-size-default">Recent Comments</h4>				</div>
				</div>
				</div>
					</div>
				</div>
		<div class="elementor-element elementor-element-6d888cf e-con-full e-flex wpr-particle-no wpr-jarallax-no wpr-parallax-no wpr-sticky-section-no e-con e-parent e-lazyloaded" data-id="6d888cf" data-element_type="container">
				<div class="elementor-element elementor-element-cc439d8 elementor-widget__width-inherit elementor-widget elementor-widget-shortcode" data-id="cc439d8" data-element_type="widget" data-widget_type="shortcode.default">
				<div class="elementor-widget-container">
							<div class="elementor-shortcode">		<div data-elementor-type="container" data-elementor-id="29844" class="elementor elementor-29844">
				<div class="elementor-element elementor-element-1ce5d837 e-flex e-con-boxed wpr-particle-no wpr-jarallax-no wpr-parallax-no wpr-sticky-section-no e-con e-parent e-lazyloaded" data-id="1ce5d837" data-element_type="container" data-settings="{&quot;background_background&quot;:&quot;classic&quot;}">
					<div class="e-con-inner">
		<div class="elementor-element elementor-element-7eab5b5b e-con-full e-flex wpr-particle-no wpr-jarallax-no wpr-parallax-no wpr-sticky-section-no e-con e-child" data-id="7eab5b5b" data-element_type="container">
		<div class="elementor-element elementor-element-58fceb5d e-con-full e-flex wpr-particle-no wpr-jarallax-no wpr-parallax-no wpr-sticky-section-no e-con e-child" data-id="58fceb5d" data-element_type="container" id="chat" data-settings="{&quot;background_background&quot;:&quot;classic&quot;}">
		<div class="elementor-element elementor-element-101eed42 e-con-full e-flex wpr-particle-no wpr-jarallax-no wpr-parallax-no wpr-sticky-section-no e-con e-child" data-id="101eed42" data-element_type="container">
				<div class="elementor-element elementor-element-6858cb7b elementor-widget elementor-widget-heading" data-id="6858cb7b" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
					<h3 class="elementor-heading-title elementor-size-default">Letâ€™s Chat</h3>				</div>
				</div>
				<div class="elementor-element elementor-element-48f9184f elementor-widget elementor-widget-heading" data-id="48f9184f" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
					<h4 class="elementor-heading-title elementor-size-default">Strengthen your digital stronghold.</h4>				</div>
				</div>
				<div class="elementor-element elementor-element-4c26ee5a elementor-widget elementor-widget-image" data-id="4c26ee5a" data-element_type="widget" data-widget_type="image.default">
				<div class="elementor-widget-container">
															<img width="42" height="7" src="https://whiteknightlabs.com/wp-content/uploads/2024/08/desigen-1.png" class="attachment-full size-full wp-image-27367" alt="desigen">															</div>
				</div>
				<div class="elementor-element elementor-element-427c13a4 elementor-widget elementor-widget-text-editor" data-id="427c13a4" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
									<p>Reach out to us today and discover the potential of bespoke cybersecurity solutions designed to reduce your business risk.</p>								</div>
				</div>
				</div>
		<div class="elementor-element elementor-element-63003e38 e-con-full e-flex wpr-particle-no wpr-jarallax-no wpr-parallax-no wpr-sticky-section-no e-con e-child" data-id="63003e38" data-element_type="container">
				<div class="elementor-element elementor-element-3b4eaecd elementor-widget elementor-widget-shortcode" data-id="3b4eaecd" data-element_type="widget" data-widget_type="shortcode.default">
				<div class="elementor-widget-container">
							<div class="elementor-shortcode">
<div class="wpcf7 js" id="wpcf7-f27543-o1" lang="en-US" dir="ltr" data-wpcf7-id="27543">
<div class="screen-reader-response"><p role="status" aria-live="polite" aria-atomic="true"></p> <ul></ul></div>
<form action="https://whiteknightlabs.com/2025/06/10/understanding-double-free-in-windows-kernel-drivers/#wpcf7-f27543-o1" method="post" class="wpcf7-form init" aria-label="Contact form" novalidate="novalidate" data-status="init">
<div style="display: none;">






</div>
<div class="z-form main">
	<div class="z-input z-50">
		<p><span class="wpcf7-form-control-wrap" data-name="first-name"><input size="40" maxlength="400" class="wpcf7-form-control wpcf7-text wpcf7-validates-as-required" aria-required="true" aria-invalid="false" placeholder="First Name *" value="" type="text" name="first-name"></span>
		</p>
	</div>
	<div class="z-input z-50">
		<p><span class="wpcf7-form-control-wrap" data-name="last-name"><input size="40" maxlength="400" class="wpcf7-form-control wpcf7-text wpcf7-validates-as-required" aria-required="true" aria-invalid="false" placeholder="Last Name *" value="" type="text" name="last-name"></span>
		</p>
	</div>
	<div class="z-input z-50">
		<p><span class="wpcf7-form-control-wrap" data-name="your-email"><input size="40" maxlength="400" class="wpcf7-form-control wpcf7-email wpcf7-validates-as-required wpcf7-text wpcf7-validates-as-email" aria-required="true" aria-invalid="false" placeholder="Email Address *" value="" type="email" name="your-email"></span>
		</p>
	</div>
	<div class="z-input z-50">
		<p><span class="wpcf7-form-control-wrap" data-name="company-name"><input size="40" maxlength="400" class="wpcf7-form-control wpcf7-text wpcf7-validates-as-required" aria-required="true" aria-invalid="false" placeholder="Company *" value="" type="text" name="company-name"></span>
		</p>
	</div>
	<div class="z-input z-100">
		<p><span class="wpcf7-form-control-wrap" data-name="phone-number"><input size="40" maxlength="400" class="wpcf7-form-control wpcf7-tel wpcf7-validates-as-required wpcf7-text wpcf7-validates-as-tel" aria-required="true" aria-invalid="false" placeholder="Phone Number *" value="" type="tel" name="phone-number"></span>
		</p>
	</div>
	<div class="z-input z-100">
		<p><span class="wpcf7-form-control-wrap" data-name="your-message"><textarea cols="5" rows="1" maxlength="2000" class="wpcf7-form-control wpcf7-textarea wpcf7-validates-as-required" id="myTextarea" aria-required="true" aria-invalid="false" placeholder="Message *" name="your-message"></textarea></span>
		</p>
	</div>
	<div class="z-input z-100 z_mathcaptcha">
		<p></p><div class="dscf7-captcha-container"><div class="dscf7-question-container"><span class="dscf7_lt">What is 5 + 8 ? <a id="tag-generator-panel-dscf7captcha" class="dscf7_refresh_captcha" aria-label="Refresh captcha"><img class="dscf7_captcha_icon" src="https://whiteknightlabs.com/wp-content/plugins/ds-cf7-math-captcha/assets/img/icons8-refresh-30.png" alt="Refresh icon"><img class="dscf7_captcha_reload_icon" src="https://whiteknightlabs.com/wp-content/plugins/ds-cf7-math-captcha/assets/img/446bcd468478f5bfb7b4e5c804571392_w200.gif" alt="Refreshing captcha" style="display:none; width:30px"></a></span></div><div class="dscf7-answer-container"><label for="tag-generator-panel-dscf7captcha-input" class="screen-reader-text">Answer for 5 + 8</label><span class="wpcf7-form-control-wrap" data-name="tag-generator-panel-dscf7captcha"><input type="text" id="tag-generator-panel-dscf7captcha-input" aria-label="Answer for 5 + 8" aria-invalid="false" aria-required="true" class="wpcf7-form-control wpcf7-text wpcf7-validates-as-required" size="5" value="" name="tag-generator-panel-dscf7captcha" placeholder="Type your answer" style=""></span></div></div>
		<p></p>
	</div>
	<div class="z-input z-100 recaptcha">
		<p></p><div id="cf7sr-69959ff9ce7e8" class="cf7sr-g-recaptcha" data-theme="light" data-type="image" data-size="normal" data-sitekey="6Lf5uk4qAAAAADW8LDQroQXmnKEJ9v6E92gR0Rn9"><div style="width: 304px; height: 78px;"><div><div title="reCAPTCHA" width="304" height="78" role="presentation" name="a-6e0z8nrwpdw5" frameborder="0" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox allow-storage-access-by-user-activation" src="https://www.google.com/recaptcha/api2/anchor?ar=1&amp;k=6Lf5uk4qAAAAADW8LDQroQXmnKEJ9v6E92gR0Rn9&amp;co=aHR0cHM6Ly93aGl0ZWtuaWdodGxhYnMuY29tOjQ0Mw..&amp;hl=en&amp;type=image&amp;v=vUgXt_KV952_-5BB2jjloYzl&amp;theme=light&amp;size=normal&amp;anchor-ms=20000&amp;execute-ms=30000&amp;cb=ur07a2pdy3o" data-original-tag="iframe">

<title>reCAPTCHA</title>

<link rel="stylesheet" type="text/css" href="https://www.gstatic.com/recaptcha/releases/vUgXt_KV952_-5BB2jjloYzl/styles__ltr.css">

</div></div><textarea id="g-recaptcha-response" name="g-recaptcha-response" class="g-recaptcha-response" style="width: 250px; height: 40px; border: 1px solid rgb(193, 193, 193); margin: 10px 25px; padding: 0px; resize: none; display: none;"></textarea></div></div><span class="wpcf7-form-control-wrap cf7sr-recaptcha" data-name="cf7sr-recaptcha"></span>
		<p></p>
	</div>
	<div class="z-input submit">
		<p><input class="wpcf7-form-control wpcf7-submit has-spinner" type="submit" value="Submit"><span class="wpcf7-spinner"></span>
		</p>
	</div>
</div><div class="wpcf7-response-output" aria-hidden="true"></div>
</form>
</div>
</div>
						</div>
				</div>
				</div>
				</div>
		<div class="elementor-element elementor-element-1c22b186 e-con-full e-flex wpr-particle-no wpr-jarallax-no wpr-parallax-no wpr-sticky-section-no e-con e-child" data-id="1c22b186" data-element_type="container">
				<div class="elementor-element elementor-element-33cf1247 elementor-widget elementor-widget-image" data-id="33cf1247" data-element_type="widget" data-widget_type="image.default">
				<div class="elementor-widget-container">
																<a href="https://whiteknightlabs.com/">
							<img width="216" height="199" src="https://whiteknightlabs.com/wp-content/uploads/2024/08/footer-logo.png" class="attachment-full size-full wp-image-27553" alt="footer logo">								</a>
															</div>
				</div>
				</div>
		<div class="elementor-element elementor-element-37cf010d e-con-full e-flex wpr-particle-no wpr-jarallax-no wpr-parallax-no wpr-sticky-section-no e-con e-child" data-id="37cf010d" data-element_type="container">
				<div class="elementor-element elementor-element-4aaeaa0f e-grid-align-left elementor-shape-rounded elementor-grid-0 elementor-widget elementor-widget-social-icons" data-id="4aaeaa0f" data-element_type="widget" data-widget_type="social-icons.default">
				<div class="elementor-widget-container">
							<div class="elementor-social-icons-wrapper elementor-grid" role="list">
							<span class="elementor-grid-item" role="listitem">
					<a class="elementor-icon elementor-social-icon elementor-social-icon-linkedin-in elementor-repeater-item-24943ce" href="https://www.linkedin.com/company/white-knight-labs/" target="_blank">
						<span class="elementor-screen-only">Linkedin-in</span>
						<svg class="e-font-icon-svg e-fab-linkedin-in" viewBox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 0 1 107.58 0c0 29.7-24.1 54.3-53.79 54.3zM447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3 94 0 111.28 61.9 111.28 142.3V448z"></path></svg>					</a>
				</span>
							<span class="elementor-grid-item" role="listitem">
					<a class="elementor-icon elementor-social-icon elementor-social-icon-x-twitter elementor-repeater-item-0648e80" href="https://twitter.com/WKL_cyber" target="_blank">
						<span class="elementor-screen-only">X-twitter</span>
						<svg class="e-font-icon-svg e-fab-x-twitter" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"></path></svg>					</a>
				</span>
							<span class="elementor-grid-item" role="listitem">
					<a class="elementor-icon elementor-social-icon elementor-social-icon-discord elementor-repeater-item-a00d66c" href="https://discord.gg/qRGBT2TcEV" target="_blank">
						<span class="elementor-screen-only">Discord</span>
						<svg class="e-font-icon-svg e-fab-discord" viewBox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M297.216 243.2c0 15.616-11.52 28.416-26.112 28.416-14.336 0-26.112-12.8-26.112-28.416s11.52-28.416 26.112-28.416c14.592 0 26.112 12.8 26.112 28.416zm-119.552-28.416c-14.592 0-26.112 12.8-26.112 28.416s11.776 28.416 26.112 28.416c14.592 0 26.112-12.8 26.112-28.416.256-15.616-11.52-28.416-26.112-28.416zM448 52.736V512c-64.494-56.994-43.868-38.128-118.784-107.776l13.568 47.36H52.48C23.552 451.584 0 428.032 0 398.848V52.736C0 23.552 23.552 0 52.48 0h343.04C424.448 0 448 23.552 448 52.736zm-72.96 242.688c0-82.432-36.864-149.248-36.864-149.248-36.864-27.648-71.936-26.88-71.936-26.88l-3.584 4.096c43.52 13.312 63.744 32.512 63.744 32.512-60.811-33.329-132.244-33.335-191.232-7.424-9.472 4.352-15.104 7.424-15.104 7.424s21.248-20.224 67.328-33.536l-2.56-3.072s-35.072-.768-71.936 26.88c0 0-36.864 66.816-36.864 149.248 0 0 21.504 37.12 78.08 38.912 0 0 9.472-11.52 17.152-21.248-32.512-9.728-44.8-30.208-44.8-30.208 3.766 2.636 9.976 6.053 10.496 6.4 43.21 24.198 104.588 32.126 159.744 8.96 8.96-3.328 18.944-8.192 29.44-15.104 0 0-12.8 20.992-46.336 30.464 7.68 9.728 16.896 20.736 16.896 20.736 56.576-1.792 78.336-38.912 78.336-38.912z"></path></svg>					</a>
				</span>
					</div>
						</div>
				</div>
				<div class="elementor-element elementor-element-2ebf3ca1 elementor-widget__width-inherit elementor-widget-mobile__width-inherit word-break elementor-widget elementor-widget-heading" data-id="2ebf3ca1" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
					<h4 class="elementor-heading-title elementor-size-default"><a href="tel:877-864-4204"><span class="z-sm-txt">Call:</span> 877-864-4204</a></h4>				</div>
				</div>
				<div class="elementor-element elementor-element-7b256e3 elementor-widget__width-inherit elementor-widget-mobile__width-inherit word-break elementor-widget elementor-widget-heading" data-id="7b256e3" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
					<h4 class="elementor-heading-title elementor-size-default"><a href="mailto:sales@whiteknightlabs.com"><span class="z-sm-txt">Email:</span> sales@whiteknightlabs.com</a></h4>				</div>
				</div>
				<div class="elementor-element elementor-element-4f60bd52 elementor-widget__width-auto elementor-widget-mobile__width-inherit elementor-widget elementor-widget-heading" data-id="4f60bd52" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
					<h4 class="elementor-heading-title elementor-size-default"><a href="https://whiteknightlabs.com/2025/06/10/understanding-double-free-in-windows-kernel-drivers/#chat">Send us a message</a></h4>				</div>
				</div>
				</div>
		<div class="elementor-element elementor-element-2bc54d9f e-con-full e-flex wpr-particle-no wpr-jarallax-no wpr-parallax-no wpr-sticky-section-no e-con e-child" data-id="2bc54d9f" data-element_type="container">
				<div class="elementor-element elementor-element-553d18bf elementor-widget elementor-widget-heading" data-id="553d18bf" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
					<h4 class="elementor-heading-title elementor-size-default">Assessment</h4>				</div>
				</div>
				<div class="elementor-element elementor-element-2d71046c elementor-icon-list--layout-traditional elementor-list-item-link-full_width elementor-widget elementor-widget-icon-list" data-id="2d71046c" data-element_type="widget" data-widget_type="icon-list.default">
				<div class="elementor-widget-container">
							<ul class="elementor-icon-list-items">
							<li class="elementor-icon-list-item">
											<a href="https://whiteknightlabs.com/vip-home-cybersecurity-assessments">

											<span class="elementor-icon-list-text">VIP Home Security</span>
											</a>
									</li>
								<li class="elementor-icon-list-item">
											<a href="https://whiteknightlabs.com/password-audit-service">

											<span class="elementor-icon-list-text">Password Audit</span>
											</a>
									</li>
								<li class="elementor-icon-list-item">
											<a href="https://whiteknightlabs.com/embedded-security-testing">

											<span class="elementor-icon-list-text">Embedded Devices</span>
											</a>
									</li>
								<li class="elementor-icon-list-item">
											<a href="https://whiteknightlabs.com/osint-services">

											<span class="elementor-icon-list-text">OSINT</span>
											</a>
									</li>
								<li class="elementor-icon-list-item">
											<a href="https://whiteknightlabs.com/active-directory-security-assessment">

											<span class="elementor-icon-list-text">AD Assessment</span>
											</a>
									</li>
								<li class="elementor-icon-list-item">
											<a href="https://whiteknightlabs.com/dark-web-scanning">

											<span class="elementor-icon-list-text">Dark Web Scanning</span>
											</a>
									</li>
								<li class="elementor-icon-list-item">
											<a href="https://whiteknightlabs.com/smart-contract-audit">

											<span class="elementor-icon-list-text">Smart Contract Audit</span>
											</a>
									</li>
						</ul>
						</div>
				</div>
				</div>
		<div class="elementor-element elementor-element-33adade e-con-full e-flex wpr-particle-no wpr-jarallax-no wpr-parallax-no wpr-sticky-section-no e-con e-child" data-id="33adade" data-element_type="container">
				<div class="elementor-element elementor-element-6e5c9881 elementor-widget elementor-widget-heading" data-id="6e5c9881" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
					<h4 class="elementor-heading-title elementor-size-default">Penetration Testing</h4>				</div>
				</div>
				<div class="elementor-element elementor-element-7e0b5fa6 elementor-icon-list--layout-traditional elementor-list-item-link-full_width elementor-widget elementor-widget-icon-list" data-id="7e0b5fa6" data-element_type="widget" data-widget_type="icon-list.default">
				<div class="elementor-widget-container">
							<ul class="elementor-icon-list-items">
							<li class="elementor-icon-list-item">
											<a href="https://whiteknightlabs.com/network-penetration-testing-services">

											<span class="elementor-icon-list-text">Network Penetration Test</span>
											</a>
									</li>
								<li class="elementor-icon-list-item">
											<a href="https://whiteknightlabs.com/web-application-penetration-testing">

											<span class="elementor-icon-list-text">Web App Penetration Test</span>
											</a>
									</li>
								<li class="elementor-icon-list-item">
											<a href="https://whiteknightlabs.com/mobile-application-penetration-testing">

											<span class="elementor-icon-list-text">Mobile App Penetration Test</span>
											</a>
									</li>
								<li class="elementor-icon-list-item">
											<a href="https://whiteknightlabs.com/wireless-penetration-testing">

											<span class="elementor-icon-list-text">Wireless Penetration Test</span>
											</a>
									</li>
								<li class="elementor-icon-list-item">
											<a href="https://whiteknightlabs.com/cloud-penetration-testing">

											<span class="elementor-icon-list-text">Cloud Penetration Test</span>
											</a>
									</li>
								<li class="elementor-icon-list-item">
											<a href="https://whiteknightlabs.com/physical-penetration-testing/">

											<span class="elementor-icon-list-text">Physical Penetration Testing</span>
											</a>
									</li>
						</ul>
						</div>
				</div>
				</div>
		<div class="elementor-element elementor-element-7c47117b e-con-full e-flex wpr-particle-no wpr-jarallax-no wpr-parallax-no wpr-sticky-section-no e-con e-child" data-id="7c47117b" data-element_type="container">
				<div class="elementor-element elementor-element-c6209e2 elementor-widget elementor-widget-heading" data-id="c6209e2" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
					<h4 class="elementor-heading-title elementor-size-default">Simulation and Emulation</h4>				</div>
				</div>
				<div class="elementor-element elementor-element-4c4cbd23 elementor-icon-list--layout-traditional elementor-list-item-link-full_width elementor-widget elementor-widget-icon-list" data-id="4c4cbd23" data-element_type="widget" data-widget_type="icon-list.default">
				<div class="elementor-widget-container">
							<ul class="elementor-icon-list-items">
							<li class="elementor-icon-list-item">
											<a href="https://whiteknightlabs.com/red-team-engagements">

											<span class="elementor-icon-list-text">Red Team â€“ Adversarial Emulation</span>
											</a>
									</li>
								<li class="elementor-icon-list-item">
											<a href="https://whiteknightlabs.com/social-engineering-testing">

											<span class="elementor-icon-list-text">Social Engineering Attack Simulation</span>
											</a>
									</li>
								<li class="elementor-icon-list-item">
											<a href="https://whiteknightlabs.com/ransomware-attack-simulation">

											<span class="elementor-icon-list-text">Ransomware Attack Simulation</span>
											</a>
									</li>
						</ul>
						</div>
				</div>
				</div>
		<div class="elementor-element elementor-element-4de94cfd e-con-full e-flex wpr-particle-no wpr-jarallax-no wpr-parallax-no wpr-sticky-section-no e-con e-child" data-id="4de94cfd" data-element_type="container">
				<div class="elementor-element elementor-element-5b571d67 elementor-widget elementor-widget-heading" data-id="5b571d67" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
					<h4 class="elementor-heading-title elementor-size-default">Compliance and Advisory</h4>				</div>
				</div>
				<div class="elementor-element elementor-element-6870f4aa elementor-icon-list--layout-traditional elementor-list-item-link-full_width elementor-widget elementor-widget-icon-list" data-id="6870f4aa" data-element_type="widget" data-widget_type="icon-list.default">
				<div class="elementor-widget-container">
							<ul class="elementor-icon-list-items">
							<li class="elementor-icon-list-item">
											<a href="https://whiteknightlabs.com/framework-consulting">

											<span class="elementor-icon-list-text">Framework Consulting</span>
											</a>
									</li>
								<li class="elementor-icon-list-item">
											<a href="https://whiteknightlabs.com/gap-assessments">

											<span class="elementor-icon-list-text">Gap Assessments</span>
											</a>
									</li>
								<li class="elementor-icon-list-item">
											<a href="https://whiteknightlabs.com/compliance-as-a-service-caas">

											<span class="elementor-icon-list-text">Compliance-as-a-Service</span>
											</a>
									</li>
								<li class="elementor-icon-list-item">
											<a href="https://whiteknightlabs.com/devsecops-engineering">

											<span class="elementor-icon-list-text">DevSecOps Engineering</span>
											</a>
									</li>
						</ul>
						</div>
				</div>
				</div>
		<div class="elementor-element elementor-element-f113810 e-con-full e-flex wpr-particle-no wpr-jarallax-no wpr-parallax-no wpr-sticky-section-no e-con e-child" data-id="f113810" data-element_type="container">
				<div class="elementor-element elementor-element-5020e699 elementor-widget elementor-widget-heading" data-id="5020e699" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
					<h4 class="elementor-heading-title elementor-size-default">Incident Response</h4>				</div>
				</div>
				<div class="elementor-element elementor-element-6374f95f elementor-icon-list--layout-traditional elementor-list-item-link-full_width elementor-widget elementor-widget-icon-list" data-id="6374f95f" data-element_type="widget" data-widget_type="icon-list.default">
				<div class="elementor-widget-container">
							<ul class="elementor-icon-list-items">
							<li class="elementor-icon-list-item">
											<a href="https://whiteknightlabs.com/incident-response">

											<span class="elementor-icon-list-text">Incident Response</span>
											</a>
									</li>
						</ul>
						</div>
				</div>
				</div>
		<div class="elementor-element elementor-element-667852e4 e-con-full e-flex wpr-particle-no wpr-jarallax-no wpr-parallax-no wpr-sticky-section-no e-con e-child" data-id="667852e4" data-element_type="container">
				<div class="elementor-element elementor-element-18d18b57 elementor-widget-mobile__width-inherit elementor-widget elementor-widget-heading" data-id="18d18b57" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
					<h4 class="elementor-heading-title elementor-size-default">Copyright Â© <span class="z-date">2026</span> White Knight Labs | All rights reserved</h4>				</div>
				</div>
				</div>
		<div class="elementor-element elementor-element-6e54881 e-con-full e-flex wpr-particle-no wpr-jarallax-no wpr-parallax-no wpr-sticky-section-no e-con e-child" data-id="6e54881" data-element_type="container">
				<div class="elementor-element elementor-element-d52ea8f elementor-widget-mobile__width-inherit elementor-widget elementor-widget-heading" data-id="d52ea8f" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
					<h4 class="elementor-heading-title elementor-size-default"><a href="https://whiteknightlabs.com/contact-us/">Contact Us</a></h4>				</div>
				</div>
				</div>
				</div>
					</div>
				</div>
				</div>
		<span class="wpr-template-edit-btn" data-permalink="https://whiteknightlabs.com/?elementor_library=z-footer">Edit Template</span></div>
						</div>
				</div>
				</div>
				</div>
		
    
    
    	<div class="ald_laser_loader">
		<div class="ald_loader_progress"></div>
	</div>
	

<link rel="modulepreload" href="https://whiteknightlabs.com/wp-includes/js/dist/script-modules/interactivity/index.min.js?ver=66c613f68580994bb00a" id="@wordpress/interactivity-js-modulepreload" fetchpriority="low">

			
					<div class="wp-lightbox-overlay zoom" data-wp-interactive="core/image" data-wp-router-region="{ &quot;id&quot;: &quot;core/image-overlay&quot;, &quot;attachTo&quot;: &quot;body&quot; }" data-wp-key="wp-lightbox-overlay" data-wp-context="{}" data-wp-bind--role="state.roleAttribute" data-wp-bind--aria-label="state.currentImage.ariaLabel" data-wp-bind--aria-modal="state.ariaModal" data-wp-class--active="state.overlayEnabled" data-wp-class--show-closing-animation="state.overlayOpened" data-wp-watch="callbacks.setOverlayFocus" data-wp-on--keydown="actions.handleKeydown" data-wp-on--touchstart="actions.handleTouchStart" data-wp-on--touchmove="actions.handleTouchMove" data-wp-on--touchend="actions.handleTouchEnd" data-wp-on--click="actions.hideLightbox" data-wp-on-window--resize="callbacks.setOverlayStyles" data-wp-on-window--scroll="actions.handleScroll" data-wp-bind--style="state.overlayStyles" tabindex="-1">
				<button type="button" aria-label="Close" style="fill: #000" class="close-button">
					<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" focusable="false"><path d="m13.06 12 6.47-6.47-1.06-1.06L12 10.94 5.53 4.47 4.47 5.53 10.94 12l-6.47 6.47 1.06 1.06L12 13.06l6.47 6.47 1.06-1.06L13.06 12Z"></path></svg>
				</button>
				<div class="lightbox-image-container">
					<figure data-wp-bind--class="state.currentImage.figureClassNames" data-wp-bind--style="state.figureStyles">
						<img data-wp-bind--alt="state.currentImage.alt" data-wp-bind--class="state.currentImage.imgClassNames" data-wp-bind--style="state.imgStyles" data-wp-bind--src="state.currentImage.currentSrc" alt="" src="https://whiteknightlabs.com/2025/06/10/understanding-double-free-in-windows-kernel-drivers/">
					</figure>
				</div>
				<div class="lightbox-image-container">
					<figure data-wp-bind--class="state.currentImage.figureClassNames" data-wp-bind--style="state.figureStyles">
						<img data-wp-bind--alt="state.currentImage.alt" data-wp-bind--class="state.currentImage.imgClassNames" data-wp-bind--style="state.imgStyles" data-wp-bind--src="state.enlargedSrc" alt="" src="https://whiteknightlabs.com/2025/06/10/understanding-double-free-in-windows-kernel-drivers/">
					</figure>
				</div>
				<div class="scrim" style="background-color: #fff" aria-hidden="true"></div>
		</div>






























<span id="elementor-device-mode" class="elementor-screen-only"></span>










<!-- start Simple Custom CSS and JS -->

<!-- end Simple Custom CSS and JS -->


<!-- start Simple Custom CSS and JS -->


<!-- end Simple Custom CSS and JS -->
	

<div><div class="grecaptcha-badge" data-style="bottomright" style="width: 256px; height: 60px; display: block; transition: right 0.3s; position: fixed; bottom: 14px; right: -186px; box-shadow: gray 0px 0px 5px; border-radius: 2px; overflow: hidden;"><div class="grecaptcha-logo"><div title="reCAPTCHA" width="256" height="60" role="presentation" name="a-iqudkbs3dsly" frameborder="0" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox allow-storage-access-by-user-activation" src="https://www.google.com/recaptcha/api2/anchor?ar=1&amp;k=6Ld41o8nAAAAADAuJxe8J3eOEGgDXu8elQwOe0yA&amp;co=aHR0cHM6Ly93aGl0ZWtuaWdodGxhYnMuY29tOjQ0Mw..&amp;hl=en&amp;v=vUgXt_KV952_-5BB2jjloYzl&amp;size=invisible&amp;anchor-ms=20000&amp;execute-ms=30000&amp;cb=8s6r9ugd7o8g" data-original-tag="iframe">

<title>reCAPTCHA</title>

<link rel="stylesheet" type="text/css" href="https://www.gstatic.com/recaptcha/releases/vUgXt_KV952_-5BB2jjloYzl/styles__ltr.css">

</div></div><div class="grecaptcha-error"></div><textarea id="g-recaptcha-response-100000" name="g-recaptcha-response" class="g-recaptcha-response" style="width: 250px; height: 40px; border: 1px solid rgb(193, 193, 193); margin: 10px 25px; padding: 0px; resize: none; display: none;"></textarea></div></div></body></html>