Title:
Inline-EA (Inline Execute Assembly BOF)

Type:
GitHub Tool

Short Summary (4â€“8 sentences max):
- Inline-EA is a Cobalt Strike Beacon Object File (BOF) that executes .NET assemblies inside the current Beacon process (inline execution) rather than spawning a new process.  
- It targets EDR/AV detection points commonly associated with CLR hosting and .NET tradecraft, with specific mention of bypassing Elastic 8.17.4 and working against CrowdStrike Falcon and Microsoft Defender for Endpoint.  
- The tool loads CLR components via `LoadLibraryShim` to avoid detections tied to `ICLRRuntimeInfo::GetInterface` call stacks, and includes optional AMSI and ETW bypasses.  
- AMSI is bypassed by patching `clr.dll` in memory (instead of `amsi.dll`), and ETW is bypassed by EAT-hooking `advapi32!EventWrite` to a stub that returns immediately.  
- It also offers a patch for `System.Environment.Exit` to prevent the Beacon process from terminating when assemblies call `Exit` (noted as detectable by Elastic).  
- Useful for red teams and pentesters running .NET tooling (e.g., Rubeus-like assemblies) under tighter EDR scrutiny while staying in-process.

Technical Focus:
- Cobalt Strike BOF in-process .NET assembly execution (CLR hosting)
- `LoadLibraryShim`-based CLR loading to evade callstack-based detections
- AMSI bypass via in-memory patching of `clr.dll`
- ETW bypass via Export Address Table (EAT) hooking of `advapi32!EventWrite`
- APC-based console loading from backed memory
- Patching `System.Environment.Exit` behavior

Use Cases:
- Execute offensive .NET assemblies from Beacon without spawning sacrificial processes
- Reduce telemetry/detections associated with standard CLR hosting APIs and call stacks
- Disable AMSI scanning for managed payload execution paths
- Suppress ETW event emission by short-circuiting `EventWrite`
- Prevent accidental Beacon termination caused by managed tools calling `Environment.Exit`

Keywords:
Cobalt Strike, BOF, Beacon Object File, Aggressor Script, inline execute-assembly, CLR hosting, LoadLibraryShim, ICLRRuntimeInfo::GetInterface, AMSI, AmsiScanBuffer, clr.dll patching, ETW, Event Tracing for Windows, advapi32.dll, EventWrite, EAT hooking, APC, System.Environment.Exit, EDR evasion, Elastic 8.17.4, CrowdStrike Falcon, Microsoft Defender for Endpoint (MDE)