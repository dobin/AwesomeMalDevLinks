# https://github.com/strozfriedberg/SharpParty

[Skip to content](https://github.com/strozfriedberg/SharpParty#start-of-content)

You signed in with another tab or window. [Reload](https://github.com/strozfriedberg/SharpParty) to refresh your session.You signed out in another tab or window. [Reload](https://github.com/strozfriedberg/SharpParty) to refresh your session.You switched accounts on another tab or window. [Reload](https://github.com/strozfriedberg/SharpParty) to refresh your session.Dismiss alert

{{ message }}

[strozfriedberg](https://github.com/strozfriedberg)/ **[SharpParty](https://github.com/strozfriedberg/SharpParty)** Public

- [Notifications](https://github.com/login?return_to=%2Fstrozfriedberg%2FSharpParty) You must be signed in to change notification settings
- [Fork\\
1](https://github.com/login?return_to=%2Fstrozfriedberg%2FSharpParty)
- [Star\\
15](https://github.com/login?return_to=%2Fstrozfriedberg%2FSharpParty)


C# implementation of the process injection techniques dubbed "PoolParty"


### License

[BSD-3-Clause license](https://github.com/strozfriedberg/SharpParty/blob/main/LICENSE)

[15\\
stars](https://github.com/strozfriedberg/SharpParty/stargazers) [1\\
fork](https://github.com/strozfriedberg/SharpParty/forks) [Branches](https://github.com/strozfriedberg/SharpParty/branches) [Tags](https://github.com/strozfriedberg/SharpParty/tags) [Activity](https://github.com/strozfriedberg/SharpParty/activity)

[Star](https://github.com/login?return_to=%2Fstrozfriedberg%2FSharpParty)

[Notifications](https://github.com/login?return_to=%2Fstrozfriedberg%2FSharpParty) You must be signed in to change notification settings

# strozfriedberg/SharpParty

main

[**1** Branch](https://github.com/strozfriedberg/SharpParty/branches) [**0** Tags](https://github.com/strozfriedberg/SharpParty/tags)

[Go to Branches page](https://github.com/strozfriedberg/SharpParty/branches)[Go to Tags page](https://github.com/strozfriedberg/SharpParty/tags)

Go to file

Code

Open more actions menu

## Folders and files

| Name | Name | Last commit message | Last commit date |
| --- | --- | --- | --- |
| ## Latest commit<br>[![wimabb](https://avatars.githubusercontent.com/u/109627401?v=4&size=40)](https://github.com/wimabb)[wimabb](https://github.com/strozfriedberg/SharpParty/commits?author=wimabb)<br>[Initial release](https://github.com/strozfriedberg/SharpParty/commit/7d4069c9ac438fb68eba68103db7e4aa3f1016cc)<br>3 months agoNov 7, 2025<br>[7d4069c](https://github.com/strozfriedberg/SharpParty/commit/7d4069c9ac438fb68eba68103db7e4aa3f1016cc) · 3 months agoNov 7, 2025<br>## History<br>[1 Commit](https://github.com/strozfriedberg/SharpParty/commits/main/) <br>Open commit details<br>[View commit history for this file.](https://github.com/strozfriedberg/SharpParty/commits/main/) 1 Commit |
| [SharpParty](https://github.com/strozfriedberg/SharpParty/tree/main/SharpParty "SharpParty") | [SharpParty](https://github.com/strozfriedberg/SharpParty/tree/main/SharpParty "SharpParty") | [Initial release](https://github.com/strozfriedberg/SharpParty/commit/7d4069c9ac438fb68eba68103db7e4aa3f1016cc "Initial release") | 3 months agoNov 7, 2025 |
| [example-tasks](https://github.com/strozfriedberg/SharpParty/tree/main/example-tasks "example-tasks") | [example-tasks](https://github.com/strozfriedberg/SharpParty/tree/main/example-tasks "example-tasks") | [Initial release](https://github.com/strozfriedberg/SharpParty/commit/7d4069c9ac438fb68eba68103db7e4aa3f1016cc "Initial release") | 3 months agoNov 7, 2025 |
| [.gitignore](https://github.com/strozfriedberg/SharpParty/blob/main/.gitignore ".gitignore") | [.gitignore](https://github.com/strozfriedberg/SharpParty/blob/main/.gitignore ".gitignore") | [Initial release](https://github.com/strozfriedberg/SharpParty/commit/7d4069c9ac438fb68eba68103db7e4aa3f1016cc "Initial release") | 3 months agoNov 7, 2025 |
| [LICENSE](https://github.com/strozfriedberg/SharpParty/blob/main/LICENSE "LICENSE") | [LICENSE](https://github.com/strozfriedberg/SharpParty/blob/main/LICENSE "LICENSE") | [Initial release](https://github.com/strozfriedberg/SharpParty/commit/7d4069c9ac438fb68eba68103db7e4aa3f1016cc "Initial release") | 3 months agoNov 7, 2025 |
| [README.md](https://github.com/strozfriedberg/SharpParty/blob/main/README.md "README.md") | [README.md](https://github.com/strozfriedberg/SharpParty/blob/main/README.md "README.md") | [Initial release](https://github.com/strozfriedberg/SharpParty/commit/7d4069c9ac438fb68eba68103db7e4aa3f1016cc "Initial release") | 3 months agoNov 7, 2025 |
| [SharpParty.sln](https://github.com/strozfriedberg/SharpParty/blob/main/SharpParty.sln "SharpParty.sln") | [SharpParty.sln](https://github.com/strozfriedberg/SharpParty/blob/main/SharpParty.sln "SharpParty.sln") | [Initial release](https://github.com/strozfriedberg/SharpParty/commit/7d4069c9ac438fb68eba68103db7e4aa3f1016cc "Initial release") | 3 months agoNov 7, 2025 |
| View all files |

## Repository files navigation

# README

[Permalink: README](https://github.com/strozfriedberg/SharpParty#readme)

## Summary

[Permalink: Summary](https://github.com/strozfriedberg/SharpParty#summary)

This repo contains a C# implementation of the process injection techniques dubbed "PoolParty".

References:

- [SafeBreach Labs Original Blog Post](https://www.safebreach.com/blog/process-injection-using-windows-thread-pools/)
- [SafeBreach Labs Original Standalone C++ Implementation](https://github.com/SafeBreach-Labs/PoolParty/tree/main)
- [CS BOF Implementation](https://github.com/0xEr3bus/PoolPartyBof/tree/main)

## Usage

[Permalink: Usage](https://github.com/strozfriedberg/SharpParty#usage)

```
[*] USAGE: ./SharpParty.exe <variant> <pid>
--- <variant> (required): Integer value representing the PoolParty variant to run (1, 4, 6, 7)
--- <pid> (optional): Integer value representing the target process ID (if no value specified, an edge process will be created for the injection)
[*] Example: ./SharpParty.exe 4 666
```

## Info

[Permalink: Info](https://github.com/strozfriedberg/SharpParty#info)

So far, the current variants are implemented:

- [x]  Variant 1
- [ ]  Variant 2
- [ ]  Variant 3
- [x]  Variant 4
- [ ]  Variant 5
- [x]  Variant 6
- [x]  Variant 7
- [ ]  Variant 8

In general, Use Variant 4 or 6 as they are currently the most reliable. More information on the implemented variants is provided below.

#### Variant 1

[Permalink: Variant 1](https://github.com/strozfriedberg/SharpParty#variant-1)

Variant 1 of PoolParty involves getting a handle to the target process' thread pool worker factory, then inserting shellcode into the worker factory's start routine.
**Caveat: This variant cannot write shellcode over a certain size because it will overflow the start routine; CS beacons will not work with this (staged or stageless); Use for small sc or for demo.**

#### Variant 4

[Permalink: Variant 4](https://github.com/strozfriedberg/SharpParty#variant-4)

Variant 4 of PoolParty involves getting a handle to the target process' I/O completion queue, then inserting a malicious TP\_IO struct that will execute shellcode as a callback.
**Caveat: This variant works with CS beacon shellcode, but it will crash the target process on exit. Your beacon will stay online as long as you need it too, but just know this variant will produce a crash on the target when you exit the beacon.**

#### Variant 6

[Permalink: Variant 6](https://github.com/strozfriedberg/SharpParty#variant-6)

Variant 6 of PoolParty involves getting a handle to the target process' I/O completion queue, then inserting a malicious TP\_JOB struct that will execute shellcode as a callback.
**Caveat: This variant works with CS beacon shellcode, but it will crash the target process on exit. Your beacon will stay online as long as you need it too, but just know this variant will produce a crash on the target when you exit the beacon.**

#### Variant 7

[Permalink: Variant 7](https://github.com/strozfriedberg/SharpParty#variant-7)

Variant 7 of PoolParty involves getting a handle to the target process' I/O completion queue, then inserting a malicious TP\_DIRECT struct that will execute shellcode as a callback.
**Caveat: This variant only seems to work once per reboot, not entirely sure why but it's not the most reliable of variants implemented.**

## Building

[Permalink: Building](https://github.com/strozfriedberg/SharpParty#building)

_Note: These steps expect that Visual Studio 2022 is installed._

1. Clone this repository.
2. Open the Solution file (`SharpParty.sln`) in Visual Sutdio.
3. Replace the shellcode and encryption key in `SharpParty/Constants.cs` with your payload and key.
4. Within Visual Studio, build the project as a 64-bit standalone executable.

## Creating your own Task XMLs

[Permalink: Creating your own Task XMLs](https://github.com/strozfriedberg/SharpParty#creating-your-own-task-xmls)

You can use this C# code to craft your own Task XML files. An example has been provided in the `example-tasks/task-variant4.xml` file. The idea here is to copy out the relevant C# code for the variant you want to use into the `<code>` tag within the task XML.

Some general tips on how to achieve this:

- Start simple, debugging task XML file's execution is a bit more difficult than a standalone binary. This is largely due to the fact that the C# source code is placed in a temporary file (`C:\Users\User\AppData\Local\Temp`), and the compilation source and results are quickly deleted after `msbuild.exe` is done. Debugging tip: no shame in using `Console.WriteLine` with debug statements. Try to find the last piece of code that executes before the error, this will help narrow down what went wrong.
- Keep track of the relevant functions, Win32 calls, Structs, and Enums that are required for the variant you want to use. Once this is known, it becomes as easy as copy/paste.

## Copyright

[Permalink: Copyright](https://github.com/strozfriedberg/SharpParty#copyright)

Copyright 2025 Stroz Friedberg

## About

C# implementation of the process injection techniques dubbed "PoolParty"


### Resources

[Readme](https://github.com/strozfriedberg/SharpParty#readme-ov-file)

### License

[BSD-3-Clause license](https://github.com/strozfriedberg/SharpParty#BSD-3-Clause-1-ov-file)

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/strozfriedberg/SharpParty).

[Activity](https://github.com/strozfriedberg/SharpParty/activity)

[Custom properties](https://github.com/strozfriedberg/SharpParty/custom-properties)

### Stars

[**15**\\
stars](https://github.com/strozfriedberg/SharpParty/stargazers)

### Watchers

[**0**\\
watching](https://github.com/strozfriedberg/SharpParty/watchers)

### Forks

[**1**\\
fork](https://github.com/strozfriedberg/SharpParty/forks)

[Report repository](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fstrozfriedberg%2FSharpParty&report=strozfriedberg+%28user%29)

## [Releases](https://github.com/strozfriedberg/SharpParty/releases)

No releases published

## [Packages\  0](https://github.com/orgs/strozfriedberg/packages?repo_name=SharpParty)

No packages published

## Languages

- [C#100.0%](https://github.com/strozfriedberg/SharpParty/search?l=c%23)

You can’t perform that action at this time.