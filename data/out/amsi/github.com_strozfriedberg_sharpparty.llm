Title:
SharpParty — C# PoolParty Process Injection (Windows Thread Pool Abuse)

Type:
GitHub Tool

Short Summary (4–8 sentences max):
SharpParty is a C# implementation of SafeBreach Labs’ “PoolParty” process injection techniques that execute shellcode by abusing Windows thread pool internals rather than creating a new remote thread. It targets existing thread pool mechanisms (worker factory / I/O completion queue-backed thread pool objects) to trigger attacker-controlled callbacks inside a remote process. The repo implements PoolParty variants 1, 4, 6, and 7, with guidance that variants 4 and 6 are the most reliable but can crash the target process on beacon exit. It includes a workflow for embedding the technique into Task Scheduler XML tasks by compiling C# via msbuild at runtime, plus a standalone EXE mode that injects into a specified PID (or spawns an Edge process if none is provided). This is primarily useful for red teams and pentesters experimenting with alternative injection primitives and for defenders wanting concrete reference code to build detections around thread pool object tampering.

Technical Focus:
- Windows thread pool internals abuse (PoolParty)
- Remote process injection via TP_* structures (TP_IO, TP_JOB, TP_DIRECT)
- I/O completion queue (IOCP) manipulation for callback execution
- Worker factory start routine modification
- Shellcode embedding/encryption key handling in C# payloads
- Task Scheduler XML + msbuild-based execution/packaging

Use Cases:
- Execute shellcode in a remote process without classic CreateRemoteThread patterns
- Prototype and compare multiple PoolParty variants for reliability/side effects
- Build Task Scheduler task XMLs that compile and run injection logic via msbuild
- Develop defensive detections for anomalous thread pool/IOCP object usage and callback pointers
- Lab research on EDR visibility of thread pool–based injection chains

Keywords:
PoolParty, SharpParty, process injection, Windows thread pool, TP_IO, TP_JOB, TP_DIRECT, worker factory, start routine, I/O completion port, IOCP, callback execution, shellcode, C#, msbuild, Task Scheduler XML, remote handle, Windows internals, SafeBreach Labs