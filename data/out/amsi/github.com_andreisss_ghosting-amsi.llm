Title:
Ghosting-AMSI — AMSI Bypass via RPC Hijack (NdrClientCall3)

Type:
GitHub Tool

Short Summary (4–8 sentences max):
- This repository provides a PowerShell proof-of-concept for bypassing AMSI by hijacking the RPC runtime call path used when AMSI delegates content scanning to an AV provider.  
- Instead of patching `amsi.dll` (e.g., `AmsiScanBuffer`) or toggling common flags (e.g., `amsiInitFailed`), it hooks `rpcrt4.dll!NdrClientCall3` to intercept and manipulate scan-request arguments before they are marshaled and sent over RPC.  
- The core idea is to alter what AMSI/AV “sees” as the scanned buffer, making malicious content appear benign at the point of RPC stub invocation.  
- This is primarily useful for red teams, pentesters, and offensive researchers exploring deeper AMSI bypass primitives and COM/RPC internals.  
- It’s interesting because it targets a lower layer (RPC marshaling/dispatch) and avoids direct modification of AMSI functions, potentially reducing straightforward signature/behavior detections focused on `amsi.dll` tampering.

Technical Focus:
- AMSI provider delegation via COM/RPC
- Hooking `rpcrt4.dll!NdrClientCall3`
- RPC stub/IDL-generated client call flow and parameter marshaling
- Pre-serialization argument interception/manipulation
- PowerShell-based in-process hooking / userland instrumentation

Use Cases:
- Testing AMSI resilience against non-`amsi.dll` patch bypass techniques
- Researching COM/RPC call interception points used by security components
- Developing/validating detections for RPC-runtime hooking and scan-buffer tampering
- Red team tradecraft experimentation for payload staging in PowerShell contexts

Keywords:
AMSI, AmsiScanBuffer, rpcrt4.dll, NdrClientCall3, RPC, COM, AV provider, marshaling, IDL stubs, argument interception, userland hooking, PowerShell, scan buffer manipulation, AMSI bypass, EDR evasion, Windows internals, RPC runtime, content scanning