# https://github.com/mochabyte0x/TrampoLatte

[Skip to content](https://github.com/mochabyte0x/TrampoLatte#start-of-content)

You signed in with another tab or window. [Reload](https://github.com/mochabyte0x/TrampoLatte) to refresh your session.You signed out in another tab or window. [Reload](https://github.com/mochabyte0x/TrampoLatte) to refresh your session.You switched accounts on another tab or window. [Reload](https://github.com/mochabyte0x/TrampoLatte) to refresh your session.Dismiss alert

{{ message }}

[mochabyte0x](https://github.com/mochabyte0x)/ **[TrampoLatte](https://github.com/mochabyte0x/TrampoLatte)** Public

- [Notifications](https://github.com/login?return_to=%2Fmochabyte0x%2FTrampoLatte) You must be signed in to change notification settings
- [Fork\\
2](https://github.com/login?return_to=%2Fmochabyte0x%2FTrampoLatte)
- [Star\\
18](https://github.com/login?return_to=%2Fmochabyte0x%2FTrampoLatte)


A proof of concept AMSI & ETW bypass using trampolines for hooking and modifying execution flow


### License

[MIT license](https://github.com/mochabyte0x/TrampoLatte/blob/main/LICENSE)

[18\\
stars](https://github.com/mochabyte0x/TrampoLatte/stargazers) [2\\
forks](https://github.com/mochabyte0x/TrampoLatte/forks) [Branches](https://github.com/mochabyte0x/TrampoLatte/branches) [Tags](https://github.com/mochabyte0x/TrampoLatte/tags) [Activity](https://github.com/mochabyte0x/TrampoLatte/activity)

[Star](https://github.com/login?return_to=%2Fmochabyte0x%2FTrampoLatte)

[Notifications](https://github.com/login?return_to=%2Fmochabyte0x%2FTrampoLatte) You must be signed in to change notification settings

# mochabyte0x/TrampoLatte

main

[**1** Branch](https://github.com/mochabyte0x/TrampoLatte/branches) [**0** Tags](https://github.com/mochabyte0x/TrampoLatte/tags)

[Go to Branches page](https://github.com/mochabyte0x/TrampoLatte/branches)[Go to Tags page](https://github.com/mochabyte0x/TrampoLatte/tags)

Go to file

Code

Open more actions menu

## Folders and files

| Name | Name | Last commit message | Last commit date |
| --- | --- | --- | --- |
| ## Latest commit<br>[![mochabyte0x](https://avatars.githubusercontent.com/u/115954804?v=4&size=40)](https://github.com/mochabyte0x)[mochabyte0x](https://github.com/mochabyte0x/TrampoLatte/commits?author=mochabyte0x)<br>[little cleanup](https://github.com/mochabyte0x/TrampoLatte/commit/051882a26d405ff5b86c3bdf15f2cf7063043d35)<br>8 months agoJun 26, 2025<br>[051882a](https://github.com/mochabyte0x/TrampoLatte/commit/051882a26d405ff5b86c3bdf15f2cf7063043d35) · 8 months agoJun 26, 2025<br>## History<br>[8 Commits](https://github.com/mochabyte0x/TrampoLatte/commits/main/) <br>Open commit details<br>[View commit history for this file.](https://github.com/mochabyte0x/TrampoLatte/commits/main/) 8 Commits |
| [.gitignore](https://github.com/mochabyte0x/TrampoLatte/blob/main/.gitignore ".gitignore") | [.gitignore](https://github.com/mochabyte0x/TrampoLatte/blob/main/.gitignore ".gitignore") | [Initial commit](https://github.com/mochabyte0x/TrampoLatte/commit/3800ea1e86c32bff97c01f254c9e7a5f3ea88c05 "Initial commit") | 8 months agoJun 24, 2025 |
| [ETWProxy.vcxproj](https://github.com/mochabyte0x/TrampoLatte/blob/main/ETWProxy.vcxproj "ETWProxy.vcxproj") | [ETWProxy.vcxproj](https://github.com/mochabyte0x/TrampoLatte/blob/main/ETWProxy.vcxproj "ETWProxy.vcxproj") | [Initial Commit](https://github.com/mochabyte0x/TrampoLatte/commit/32d264003231ecd9892584838674c534440bba53 "Initial Commit") | 8 months agoJun 24, 2025 |
| [ETWProxy.vcxproj.filters](https://github.com/mochabyte0x/TrampoLatte/blob/main/ETWProxy.vcxproj.filters "ETWProxy.vcxproj.filters") | [ETWProxy.vcxproj.filters](https://github.com/mochabyte0x/TrampoLatte/blob/main/ETWProxy.vcxproj.filters "ETWProxy.vcxproj.filters") | [Initial Commit](https://github.com/mochabyte0x/TrampoLatte/commit/32d264003231ecd9892584838674c534440bba53 "Initial Commit") | 8 months agoJun 24, 2025 |
| [LICENSE](https://github.com/mochabyte0x/TrampoLatte/blob/main/LICENSE "LICENSE") | [LICENSE](https://github.com/mochabyte0x/TrampoLatte/blob/main/LICENSE "LICENSE") | [Initial commit](https://github.com/mochabyte0x/TrampoLatte/commit/3800ea1e86c32bff97c01f254c9e7a5f3ea88c05 "Initial commit") | 8 months agoJun 24, 2025 |
| [README.md](https://github.com/mochabyte0x/TrampoLatte/blob/main/README.md "README.md") | [README.md](https://github.com/mochabyte0x/TrampoLatte/blob/main/README.md "README.md") | [Update README.md](https://github.com/mochabyte0x/TrampoLatte/commit/4b627be154b7f5a46b35e2da4403f131188cdf2a "Update README.md") | 8 months agoJun 24, 2025 |
| [TrampoLatte.sln](https://github.com/mochabyte0x/TrampoLatte/blob/main/TrampoLatte.sln "TrampoLatte.sln") | [TrampoLatte.sln](https://github.com/mochabyte0x/TrampoLatte/blob/main/TrampoLatte.sln "TrampoLatte.sln") | [Initial Commit](https://github.com/mochabyte0x/TrampoLatte/commit/32d264003231ecd9892584838674c534440bba53 "Initial Commit") | 8 months agoJun 24, 2025 |
| [functions.h](https://github.com/mochabyte0x/TrampoLatte/blob/main/functions.h "functions.h") | [functions.h](https://github.com/mochabyte0x/TrampoLatte/blob/main/functions.h "functions.h") | [Corrected AMSI bug which led the process to crash](https://github.com/mochabyte0x/TrampoLatte/commit/e0130cf429fd3cfb8e8072329fcad3af676ba547 "Corrected AMSI bug which led the process to crash") | 8 months agoJun 26, 2025 |
| [hook.c](https://github.com/mochabyte0x/TrampoLatte/blob/main/hook.c "hook.c") | [hook.c](https://github.com/mochabyte0x/TrampoLatte/blob/main/hook.c "hook.c") | [Corrected AMSI bug which led the process to crash](https://github.com/mochabyte0x/TrampoLatte/commit/e0130cf429fd3cfb8e8072329fcad3af676ba547 "Corrected AMSI bug which led the process to crash") | 8 months agoJun 26, 2025 |
| [main.c](https://github.com/mochabyte0x/TrampoLatte/blob/main/main.c "main.c") | [main.c](https://github.com/mochabyte0x/TrampoLatte/blob/main/main.c "main.c") | [little cleanup](https://github.com/mochabyte0x/TrampoLatte/commit/051882a26d405ff5b86c3bdf15f2cf7063043d35 "little cleanup") | 8 months agoJun 26, 2025 |
| [ret.asm](https://github.com/mochabyte0x/TrampoLatte/blob/main/ret.asm "ret.asm") | [ret.asm](https://github.com/mochabyte0x/TrampoLatte/blob/main/ret.asm "ret.asm") | [Initial Commit](https://github.com/mochabyte0x/TrampoLatte/commit/32d264003231ecd9892584838674c534440bba53 "Initial Commit") | 8 months agoJun 24, 2025 |
| View all files |

## Repository files navigation

# TrampoLatté

[Permalink: TrampoLatté](https://github.com/mochabyte0x/TrampoLatte#trampolatt%C3%A9)

TrampoLatté is an AMSI & ETW bypass poc which utilizes trampolines to hook specific function and alter their execution behavior.

## Internals

[Permalink: Internals](https://github.com/mochabyte0x/TrampoLatte#internals)

```
      AmsiScanBuffer        EtwpEventWriteFull
          │                       │
  [13-byte jmp r10]      [13-byte jmp r10]
          │                       │
   ┌──────┴──────┐          ┌─────┴─────┐
   │   ProxyAmsi │          │  RetStub  │
   │  (saves ctx)│          │   (C3)    │
   └──────┬──────┘          └─────┬─────┘
          ▼                       ▼
     returns              returns to caller
   AmsiScanBuffer
        =
  AMSI_RESULT_CLEAN
```

## Detection

[Permalink: Detection](https://github.com/mochabyte0x/TrampoLatte#detection)

- Started a custom ETW Consumer (right terminal) monitoring the .NET runtime

[![image](https://private-user-images.githubusercontent.com/115954804/458427562-45bbcc57-a264-450c-b166-41a21b89c4e0.png?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NzE0MTIwNDEsIm5iZiI6MTc3MTQxMTc0MSwicGF0aCI6Ii8xMTU5NTQ4MDQvNDU4NDI3NTYyLTQ1YmJjYzU3LWEyNjQtNDUwYy1iMTY2LTQxYTIxYjg5YzRlMC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjYwMjE4JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI2MDIxOFQxMDQ5MDFaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT03MjZhNGM3MTJjNTQ1YzhjNTQ3YjI5NzUzZjc0NjBmYTVhNWI4ZjI5NzdhMWNlMzRiNDRiMzEzMmE5MDg3YTViJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.jb2rbgxEsZXHudMKO_7a1EgKQMJDzGbuc7_sTPWxg5E)](https://private-user-images.githubusercontent.com/115954804/458427562-45bbcc57-a264-450c-b166-41a21b89c4e0.png?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NzE0MTIwNDEsIm5iZiI6MTc3MTQxMTc0MSwicGF0aCI6Ii8xMTU5NTQ4MDQvNDU4NDI3NTYyLTQ1YmJjYzU3LWEyNjQtNDUwYy1iMTY2LTQxYTIxYjg5YzRlMC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjYwMjE4JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI2MDIxOFQxMDQ5MDFaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT03MjZhNGM3MTJjNTQ1YzhjNTQ3YjI5NzUzZjc0NjBmYTVhNWI4ZjI5NzdhMWNlMzRiNDRiMzEzMmE5MDg3YTViJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.jb2rbgxEsZXHudMKO_7a1EgKQMJDzGbuc7_sTPWxg5E)

- Executing assemblies through Havoc doesn't trigger any detection (ETW)

[![image](https://private-user-images.githubusercontent.com/115954804/458434105-80a6020e-aa22-48bc-ad99-dc9accbb1089.png?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NzE0MTIwNDEsIm5iZiI6MTc3MTQxMTc0MSwicGF0aCI6Ii8xMTU5NTQ4MDQvNDU4NDM0MTA1LTgwYTYwMjBlLWFhMjItNDhiYy1hZDk5LWRjOWFjY2JiMTA4OS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjYwMjE4JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI2MDIxOFQxMDQ5MDFaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT03NzJkOWE4ZjM5N2EzYjM3NjhjOGE5NmM1NTdlNzA3MTU5OGY0YTA1MWJhMDNjNjE2N2U3NWY5MDdjZjk5YzRhJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.YBNGoKVM6uRH-7pPIqVnpUeK9hqjubdiu3-ZyzjB_aE)](https://private-user-images.githubusercontent.com/115954804/458434105-80a6020e-aa22-48bc-ad99-dc9accbb1089.png?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NzE0MTIwNDEsIm5iZiI6MTc3MTQxMTc0MSwicGF0aCI6Ii8xMTU5NTQ4MDQvNDU4NDM0MTA1LTgwYTYwMjBlLWFhMjItNDhiYy1hZDk5LWRjOWFjY2JiMTA4OS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjYwMjE4JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI2MDIxOFQxMDQ5MDFaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT03NzJkOWE4ZjM5N2EzYjM3NjhjOGE5NmM1NTdlNzA3MTU5OGY0YTA1MWJhMDNjNjE2N2U3NWY5MDdjZjk5YzRhJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.YBNGoKVM6uRH-7pPIqVnpUeK9hqjubdiu3-ZyzjB_aE)

# Disclaimer

[Permalink: Disclaimer](https://github.com/mochabyte0x/TrampoLatte#disclaimer)

This is just a POC and is not OPSEC safe.

## About

A proof of concept AMSI & ETW bypass using trampolines for hooking and modifying execution flow


### Topics

[amsi-bypass](https://github.com/topics/amsi-bypass "Topic: amsi-bypass") [amsi-evasion](https://github.com/topics/amsi-evasion "Topic: amsi-evasion") [trampoline-hooking](https://github.com/topics/trampoline-hooking "Topic: trampoline-hooking") [etw-evasion](https://github.com/topics/etw-evasion "Topic: etw-evasion") [etw-bypass](https://github.com/topics/etw-bypass "Topic: etw-bypass")

### Resources

[Readme](https://github.com/mochabyte0x/TrampoLatte#readme-ov-file)

### License

[MIT license](https://github.com/mochabyte0x/TrampoLatte#MIT-1-ov-file)

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/mochabyte0x/TrampoLatte).

[Activity](https://github.com/mochabyte0x/TrampoLatte/activity)

### Stars

[**18**\\
stars](https://github.com/mochabyte0x/TrampoLatte/stargazers)

### Watchers

[**1**\\
watching](https://github.com/mochabyte0x/TrampoLatte/watchers)

### Forks

[**2**\\
forks](https://github.com/mochabyte0x/TrampoLatte/forks)

[Report repository](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fmochabyte0x%2FTrampoLatte&report=mochabyte0x+%28user%29)

## [Releases](https://github.com/mochabyte0x/TrampoLatte/releases)

No releases published

## [Packages\  0](https://github.com/users/mochabyte0x/packages?repo_name=TrampoLatte)

No packages published

## Languages

- [C98.5%](https://github.com/mochabyte0x/TrampoLatte/search?l=c)
- [Assembly1.5%](https://github.com/mochabyte0x/TrampoLatte/search?l=assembly)

You can’t perform that action at this time.