# https://www.ibm.com/think/x-force/being-a-good-clr-host-modernizing-offensive-net-tradecraft

<!DOCTYPE html><html lang="en" style="--anker-navigation-spacing: -6rem; --c4d-sticky-header-height: 114px;">
<body class="content-page page basicpage publish" id="content-page-ae295d1bd5" data-cmp-data-layer-enabled="" data-fullwidthtemplate="false" style="margin-inline-end: 0px;">



    




    



    
<div class="page-modal-wrapper">
     
</div>


<c4d-video-cta-container><!----> <slot></slot> 
     
         <div class="root container responsivegrid">

    
    
    
    <div id="container-25343bfcda" class="cmp-container">
        
        <div class="masthead hasNavigation">









    <c4d-masthead-container data-endpoint="#" auth-method="profile-api" has-contact="false" has-global="true" has-profile="" has-search="" has-cart="" current-region-text="Your current region is" different-region-text="Select a different region" no-other-region-text="This page is not available in any other regions" contact-type="chat-link" has-language-selector="true" cart-label="Cart" style="z-index: 900; position: relative; display: block; height: 114px;"><!---->
      <!--?lit$225724174$-->
      <c4d-masthead has-language-selector="" has-l1="" data-autoid="c4d--masthead" style="transition: none; inset-block-start: 0px;"><!---->
      <div part="l0" class="cds--masthead__l0" style="margin-inline-end: 0px;">
        <div part="header" class="cds--header">
          <slot name="brand"></slot>
          <div part="header-search" class="cds--header__search">
            <div part="header-nav-container" class="cds--header__nav-container">
              <slot></slot>
            </div>
            <slot name="search"></slot>
          </div>
          <slot name="profile"></slot>
        </div>
      </div>
      <slot name="masthead-l1"></slot>
    
        <c4d-skip-to-content href="#main-content" link-assistive-text="Skip to content" role="navigation" slot="brand" aria-label="Skip to content"><!---->
      <a class="cds--skip-to-content" href="https://www.ibm.com/think/x-force/being-a-good-clr-host-modernizing-offensive-net-tradecraft#main-content"><slot><!--?lit$225724174$-->Skip to content</slot></a>
    </c4d-skip-to-content>
        <!--?lit$225724174$--> <!--?lit$225724174$-->
        <c4d-masthead-logo data-autoid="c4d--masthead-logo" size="" slot="brand"><!---->
      <a tabindex="0" id="link" part="link" class="" href="https://www.ibm.com/" aria-label="IBM logo">
        <!--?lit$225724174$-->
      <slot>
        <!--?lit$225724174$--><svg focusable="false" preserveAspectRatio="xMidYMid meet" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" width="58px" height="23px" viewBox="0 0 58 23"><!--?lit$225724174$--><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="ibm-8-bar-logo--h15-copy"><path d="M58,21.4666667 L58,23 L50.3684211,23 L50.3684211,21.4666667 L58,21.4666667 Z M39.6842105,21.4666667 L39.6842105,23 L32.0526316,23 L32.0526316,21.4666667 L39.6842105,21.4666667 Z M45.6385329,21.4666667 L45.0245693,23 L44.41871,21.4666667 L45.6385329,21.4666667 Z M28.5421053,21.4666667 C27.4471432,22.4188667 26.0029202,23 24.3905263,23 L24.3905263,23 L12.2105263,23 L12.2105263,21.4666667 Z M10.6842105,21.4666667 L10.6842105,23 L0,23 L0,21.4666667 L10.6842105,21.4666667 Z M39.6842105,18.4 L39.6842105,19.9333333 L32.0526316,19.9333333 L32.0526316,18.4 L39.6842105,18.4 Z M46.8318522,18.4 L46.2377311,19.9333333 L43.8212353,19.9333333 L43.2226426,18.4 L46.8318522,18.4 Z M30.0684211,18.4 C29.9306437,18.9451697 29.7105614,19.4599515 29.4273684,19.9333333 L29.4273684,19.9333333 L12.2105263,19.9333333 L12.2105263,18.4 Z M10.6842105,18.4 L10.6842105,19.9333333 L0,19.9333333 L0,18.4 L10.6842105,18.4 Z M58,18.4 L58,19.9333333 L50.3684211,19.9333333 L50.3684211,18.4 L58,18.4 Z M54.9473684,15.3333333 L54.9473684,16.8666667 L50.3684211,16.8666667 L50.3684211,15.3333333 L54.9473684,15.3333333 Z M39.6842105,15.3333333 L39.6842105,16.8666667 L35.1052632,16.8666667 L35.1052632,15.3333333 L39.6842105,15.3333333 Z M48.0292704,15.3333333 L47.4295831,16.8666667 L42.6233978,16.8666667 L42.019006,15.3333333 L48.0292704,15.3333333 Z M29.8547368,15.3333333 C29.991899,15.8221879 30.0684211,16.3357152 30.0684211,16.8666667 L30.0684211,16.8666667 L24.4210526,16.8666667 L24.4210526,15.3333333 Z M19.8421053,15.3333333 L19.8421053,16.8666667 L15.2631579,16.8666667 L15.2631579,15.3333333 L19.8421053,15.3333333 Z M7.63157895,15.3333333 L7.63157895,16.8666667 L3.05263158,16.8666667 L3.05263158,15.3333333 L7.63157895,15.3333333 Z M54.9473684,12.2666667 L54.9473684,13.8 L50.3684211,13.8 L50.3684211,12.2666667 L54.9473684,12.2666667 Z M39.6842105,12.2666667 L39.6842105,13.8 L35.1052632,13.8 L35.1052632,12.2666667 L39.6842105,12.2666667 Z M49.2252679,12.2666667 L48.6284686,13.8 L41.4089474,13.8 L40.8168134,12.2666667 L49.2252679,12.2666667 Z M27.9773684,12.2666667 C28.5037637,12.6994848 28.9570701,13.2181697 29.3052632,13.8 L29.3052632,13.8 L15.2631579,13.8 L15.2631579,12.2666667 Z M7.63157895,12.2666667 L7.63157895,13.8 L3.05263158,13.8 L3.05263158,12.2666667 L7.63157895,12.2666667 Z M44.5987396,9.2 L45.0263158,10.4393515 L45.4535426,9.2 L54.9473684,9.2 L54.9473684,10.7333333 L50.3684211,10.7333333 L50.3684211,9.32433939 L49.8494737,10.7333333 L40.1878947,10.7333333 L39.6842105,9.3242 L39.6842105,10.7333333 L35.1052632,10.7333333 L35.1052632,9.2 L44.5987396,9.2 Z M7.63157895,9.2 L7.63157895,10.7333333 L3.05263158,10.7333333 L3.05263158,9.2 L7.63157895,9.2 Z M29.3052632,9.2 C28.9570701,9.7818303 28.5037637,10.3003758 27.9773684,10.7333333 L27.9773684,10.7333333 L15.2631579,10.7333333 L15.2631579,9.2 Z M54.9473684,6.13333333 L54.9473684,7.66666667 L45.9831118,7.66666667 L46.5234001,6.13333333 L54.9473684,6.13333333 Z M43.534302,6.13333333 L44.0745993,7.66666667 L35.1052632,7.66666667 L35.1052632,6.13333333 L43.534302,6.13333333 Z M30.0684211,6.13333333 C30.0684211,6.66414545 29.991899,7.17767273 29.8547368,7.66666667 L29.8547368,7.66666667 L24.4210526,7.66666667 L24.4210526,6.13333333 Z M19.8421053,6.13333333 L19.8421053,7.66666667 L15.2631579,7.66666667 L15.2631579,6.13333333 L19.8421053,6.13333333 Z M7.63157895,6.13333333 L7.63157895,7.66666667 L3.05263158,7.66666667 L3.05263158,6.13333333 L7.63157895,6.13333333 Z M42.4774196,3.06666667 L43.0079113,4.6 L32.0527757,4.6 L32.0526316,3.06666667 L42.4774196,3.06666667 Z M58,3.06666667 L58,4.6 L47.0390632,4.6 L47.5903678,3.06666667 L58,3.06666667 Z M29.4273684,3.06666667 C29.7105614,3.54004848 29.9306437,4.0548303 30.0684211,4.6 L30.0684211,4.6 L12.2105263,4.6 L12.2105263,3.06666667 Z M10.6842105,3.06666667 L10.6842105,4.6 L0,4.6 L0,3.06666667 L10.6842105,3.06666667 Z M41.4056725,0 L41.9462722,1.53333333 L32.05278,1.53333333 L32.0526316,0 L41.4056725,0 Z M58,0 L58,1.53333333 L48.1188427,1.53333333 L48.6466706,0 L58,0 Z M24.3905263,0 C25.9912083,0 27.4472798,0.581133333 28.5421053,1.53333333 L28.5421053,1.53333333 L12.2105263,1.53333333 L12.2105263,0 Z M10.6842105,0 L10.6842105,1.53333333 L0,1.53333333 L0,0 L10.6842105,0 Z" id="Combined-Shape"></path></g></g></svg>
      </slot>
    
      </a>
    </c4d-masthead-logo>
      
        <!--?lit$225724174$-->
        <!--?lit$225724174$-->
          <c4d-top-nav selected-menu-item="" data-autoid="c4d--masthead__l0-nav"><!---->
          <!--?lit$225724174$-->
                <div part="header-nav-caret-left-container" class=" cds--header__nav-caret-left-container c4d-ce--header__nav-caret-container--hidden ">
                  <button part="prev-button" tabindex="-1" aria-hidden="true" class="cds--header__nav-caret-left">
                    <!--?lit$225724174$--><svg focusable="false" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" fill="currentColor" aria-hidden="true" width="20" height="20" viewBox="0 0 32 32"><!--?lit$225724174$--><path d="M20 24L10 16 20 8z"></path></svg>
                  </button>
                  <div part="header_nav-caret-left-gradient" class="cds--header__nav-caret-left-gradient"></div>
                </div>
                <div part="ce-header-nav-content-container" class="c4d-ce--header__nav-content-container">
                  <div part="header-nav-content" class="cds--header__nav-content" style="inset-inline-start: 0px;">
                    
                  </div>
                </div>
                <div part="header-nav-caret-right-container" class=" cds--header__nav-caret-right-container c4d-ce--header__nav-caret-container--hidden ">
                  <div part="header-nav-caret-right-gradient" class="cds--header__nav-caret-right-gradient"></div>
                  <button part="next-button" tabindex="-1" aria-hidden="true" class="cds--header__nav-caret-right">
                    <!--?lit$225724174$--><svg focusable="false" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" fill="currentColor" aria-hidden="true" width="20" height="20" viewBox="0 0 32 32"><!--?lit$225724174$--><path d="M12 8L22 16 12 24z"></path></svg>
                  </button>
                </div>
              
        
            <!--?lit$225724174$--><!---->
        <c4d-megamenu-top-nav-menu menu-label="Software" trigger-content="Software" data-autoid="c4d--masthead__l0-nav--nav0" style="--c4d-ce--viewport-width: 1920px;"><!---->
      <a part="trigger" role="button" tabindex="0" aria-haspopup="menu" class=" cds--header__menu-item cds--header__menu-title " aria-expanded="false" data-attribute1="headerNav" data-attribute2="L0" data-attribute3="Software" data-selected="false">
        <!--?lit$225724174$-->Software<!--?lit$225724174$--><svg focusable="false" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" fill="currentColor" aria-hidden="true" width="16" height="16" viewBox="0 0 16 16" part="trigger-icon" class="cds--header__menu-arrow"><!--?lit$225724174$--><!--?lit$225724174$--><path d="M8 11L3 6 3.7 5.3 8 9.6 12.3 5.3 13 6z"></path></svg>
      </a>
      <ul part="menu-body" class="cds--header__menu" aria-label="Software">
        <slot></slot>
      </ul>
    
          <!--?lit$225724174$-->
        </c4d-megamenu-top-nav-menu>
      <!----><!---->
        <c4d-megamenu-top-nav-menu menu-label="Infrastructure" trigger-content="Infrastructure" data-autoid="c4d--masthead__l0-nav--nav1" style="--c4d-ce--viewport-width: 1920px;"><!---->
      <a part="trigger" role="button" tabindex="0" aria-haspopup="menu" class=" cds--header__menu-item cds--header__menu-title " aria-expanded="false" data-attribute1="headerNav" data-attribute2="L0" data-attribute3="Infrastructure" data-selected="false">
        <!--?lit$225724174$-->Infrastructure<!--?lit$225724174$--><svg focusable="false" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" fill="currentColor" aria-hidden="true" width="16" height="16" viewBox="0 0 16 16" part="trigger-icon" class="cds--header__menu-arrow"><!--?lit$225724174$--><!--?lit$225724174$--><path d="M8 11L3 6 3.7 5.3 8 9.6 12.3 5.3 13 6z"></path></svg>
      </a>
      <ul part="menu-body" class="cds--header__menu" aria-label="Infrastructure">
        <slot></slot>
      </ul>
    
          <!--?lit$225724174$-->
        </c4d-megamenu-top-nav-menu>
      <!----><!---->
      <c4d-top-nav-item href="https://www.ibm.com/consulting?lnk=L0G" title="Consulting" data-autoid="c4d--masthead__l0-nav--nav2"><!---->
      <a part="link" tabindex="0" class=" cds--header__menu-item " href="https://www.ibm.com/consulting?lnk=L0G" data-selected="false">
        <span part="title" class="cds--text-truncate--end"><slot><!--?lit$225724174$-->Consulting</slot></span>
      </a>
    </c4d-top-nav-item>
    <!----><!---->
        <c4d-top-nav-menu menu-label="Support" trigger-content="Support" data-autoid="c4d--masthead__l0-nav--nav3"><!---->
      <a part="trigger" role="button" tabindex="0" aria-haspopup="menu" class=" cds--header__menu-item cds--header__menu-title " aria-expanded="false" data-selected="false">
        <!--?lit$225724174$-->Support<!--?lit$225724174$--><svg focusable="false" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" fill="currentColor" aria-hidden="true" width="16" height="16" viewBox="0 0 16 16" part="trigger-icon" class="cds--header__menu-arrow"><!--?lit$225724174$--><!--?lit$225724174$--><path d="M8 11L3 6 3.7 5.3 8 9.6 12.3 5.3 13 6z"></path></svg>
      </a>
      <ul part="menu-body" class="cds--header__menu" aria-label="Support">
        <slot></slot>
      </ul>
    
          <!--?lit$225724174$--><!---->
                <c4d-top-nav-menu-item href="https://www.ibm.com/mysupport/s/?language=en_US&amp;lnk=flathl" title="Overview" data-autoid="c4d--masthead__l0-nav--subnav-col3-item0" role="listitem"><!---->
      <a part="link" tabindex="0" class=" cds--header__menu-item " href="https://www.ibm.com/mysupport/s/?language=en_US&amp;lnk=flathl">
        <span part="title" class="cds--text-truncate--end"><slot><!--?lit$225724174$-->Overview</slot></span>
      </a>
    </c4d-top-nav-menu-item>
              <!----><!---->
                <c4d-top-nav-menu-item href="https://community.ibm.com/community/user/community?lnk=flathl" title="Community" data-autoid="c4d--masthead__l0-nav--subnav-col3-item1" role="listitem"><!---->
      <a part="link" tabindex="0" class=" cds--header__menu-item " href="https://community.ibm.com/community/user/community?lnk=flathl">
        <span part="title" class="cds--text-truncate--end"><slot><!--?lit$225724174$-->Community</slot></span>
      </a>
    </c4d-top-nav-menu-item>
              <!----><!---->
                <c4d-top-nav-menu-item href="https://developer.ibm.com/?lnk=flathl" title="Developer" data-autoid="c4d--masthead__l0-nav--subnav-col3-item2" role="listitem"><!---->
      <a part="link" tabindex="0" class=" cds--header__menu-item " href="https://developer.ibm.com/?lnk=flathl">
        <span part="title" class="cds--text-truncate--end"><slot><!--?lit$225724174$-->Developer</slot></span>
      </a>
    </c4d-top-nav-menu-item>
              <!----><!---->
                <c4d-top-nav-menu-item href="https://www.ibm.com/docs/en?lnk=flathl" title="Documentation" data-autoid="c4d--masthead__l0-nav--subnav-col3-item3" role="listitem"><!---->
      <a part="link" tabindex="0" class=" cds--header__menu-item " href="https://www.ibm.com/docs/en?lnk=flathl">
        <span part="title" class="cds--text-truncate--end"><slot><!--?lit$225724174$-->Documentation</slot></span>
      </a>
    </c4d-top-nav-menu-item>
              <!----><!---->
                <c4d-top-nav-menu-item href="https://www.ibm.com/products/cloud/support?lnk=flathl" title="IBM Cloud platform" data-autoid="c4d--masthead__l0-nav--subnav-col3-item4" role="listitem"><!---->
      <a part="link" tabindex="0" class=" cds--header__menu-item " href="https://www.ibm.com/products/cloud/support?lnk=flathl">
        <span part="title" class="cds--text-truncate--end"><slot><!--?lit$225724174$-->IBM Cloud platform</slot></span>
      </a>
    </c4d-top-nav-menu-item>
              <!----><!---->
                <c4d-top-nav-menu-item href="https://www.ibm.com/products/expertlabs?lnk=flatitem" title="Implementation" data-autoid="c4d--masthead__l0-nav--subnav-col3-item5" role="listitem"><!---->
      <a part="link" tabindex="0" class=" cds--header__menu-item " href="https://www.ibm.com/products/expertlabs?lnk=flatitem">
        <span part="title" class="cds--text-truncate--end"><slot><!--?lit$225724174$-->Implementation</slot></span>
      </a>
    </c4d-top-nav-menu-item>
              <!----><!---->
                <c4d-top-nav-menu-item href="https://www.ibm.com/training/?lnk=flathl" title="Training" data-autoid="c4d--masthead__l0-nav--subnav-col3-item6" role="listitem"><!---->
      <a part="link" tabindex="0" class=" cds--header__menu-item " href="https://www.ibm.com/training/?lnk=flathl">
        <span part="title" class="cds--text-truncate--end"><slot><!--?lit$225724174$-->Training</slot></span>
      </a>
    </c4d-top-nav-menu-item>
              <!----><!---->
                <c4d-top-nav-menu-item href="https://www.ibm.com/services/technology-lifecycle-services?lnk=flathl" title="Technology Lifecycle Services" data-autoid="c4d--masthead__l0-nav--subnav-col3-item7" role="listitem"><!---->
      <a part="link" tabindex="0" class=" cds--header__menu-item " href="https://www.ibm.com/services/technology-lifecycle-services?lnk=flathl">
        <span part="title" class="cds--text-truncate--end"><slot><!--?lit$225724174$-->Technology Lifecycle Services</slot></span>
      </a>
    </c4d-top-nav-menu-item>
              <!---->
        </c4d-top-nav-menu>
      <!----><!---->
      <c4d-top-nav-item href="https://www.ibm.com/think" title="Think" data-autoid="c4d--masthead__l0-nav--nav4"><!---->
      <a part="link" tabindex="0" class=" cds--header__menu-item " href="https://www.ibm.com/think" data-selected="false">
        <span part="title" class="cds--text-truncate--end"><slot><!--?lit$225724174$-->Think</slot></span>
      </a>
    </c4d-top-nav-item>
    <!---->
          </c4d-top-nav>
         <!--?lit$225724174$-->
          <c4d-search-with-typeahead input-timeout="200" data-autoid="c4d--search-with-typeahead" aria-label="" direction="bottom" size="md" type="" value="" placeholder="Search all of IBM" slot="search" language="en-us"><!---->
      <!--?lit$225724174$-->
            <!--?lit$225724174$-->
            <div part="header-search-actions" class="cds--header__search--actions">
              <button type="button" part="open-button" class="cds--header__action cds--header__search--search" aria-label="Open IBM search field">
                <!--?lit$225724174$--><svg focusable="false" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" fill="currentColor" aria-hidden="true" width="20" height="20" viewBox="0 0 32 32"><!--?lit$225724174$--><path d="M29,27.5859l-7.5521-7.5521a11.0177,11.0177,0,1,0-1.4141,1.4141L27.5859,29ZM4,13a9,9,0,1,1,9,9A9.01,9.01,0,0,1,4,13Z"></path></svg>
              </button>
              <button type="button" part="close-button" class="cds--header__action cds--header__search--close" aria-label="Clear input">
                <!--?lit$225724174$--><svg focusable="false" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" fill="currentColor" aria-hidden="true" width="20" height="20" viewBox="0 0 32 32"><!--?lit$225724174$--><!--?lit$225724174$--><path d="M17.4141 16L24 9.4141 22.5859 8 16 14.5859 9.4143 8 8 9.4141 14.5859 16 8 22.5859 9.4143 24 16 17.4141 22.5859 24 24 22.5859 17.4141 16z"></path></svg>
              </button>
            </div>
          
    </c4d-search-with-typeahead>
        
        <c4d-masthead-global-bar data-autoid="c4d--masthead-global-bar" slot="profile"><!---->
      <div part="container" class=" c4d-ce--header__global__container ">
        <slot></slot>
      </div>
    
          <!--?lit$225724174$-->
          <!--?lit$225724174$--><c4d-masthead-cart link-label="Cart" data-autoid="c4d--masthead-cart"><!---->
      <a part="cart-link" href="https://www.ibm.com/store/en/us/checkout" class="cds--header__menu-item cds--header__menu-title" aria-label="Cart"><!--?lit$225724174$--><svg focusable="false" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" fill="currentColor" aria-hidden="true" width="20" height="20" viewBox="0 0 32 32"><!--?lit$225724174$--><circle cx="10" cy="28" r="2"></circle><circle cx="24" cy="28" r="2"></circle><path d="M28,7H5.82L5,2.8A1,1,0,0,0,4,2H0V4H3.18L7,23.2A1,1,0,0,0,8,24H26V22H8.82L8,18H26a1,1,0,0,0,1-.78l2-9A1,1,0,0,0,28,7Zm-2.8,9H7.62L6.22,9H26.75Z"></path></svg></a>
    </c4d-masthead-cart><!--?lit$225724174$-->
          <div class="earth-language-icon" part="earth-l0-icon" role="button" tabindex="0" aria-haspopup="true" aria-expanded="false" aria-controls="countryDropdown" style="display: block !important;">
            <!--?lit$225724174$--><svg focusable="false" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" fill="currentColor" aria-hidden="true" width="20" height="20" viewBox="0 0 32 32" part="earth-l0-svg"><!--?lit$225724174$--><path d="M16,2A14,14,0,1,0,30,16,14,14,0,0,0,16,2ZM28,15H22A24.26,24.26,0,0,0,19.21,4.45,12,12,0,0,1,28,15ZM16,28a5,5,0,0,1-.67,0A21.85,21.85,0,0,1,12,17H20a21.85,21.85,0,0,1-3.3,11A5,5,0,0,1,16,28ZM12,15a21.85,21.85,0,0,1,3.3-11,6,6,0,0,1,1.34,0A21.85,21.85,0,0,1,20,15Zm.76-10.55A24.26,24.26,0,0,0,10,15h-6A12,12,0,0,1,12.79,4.45ZM4.05,17h6a24.26,24.26,0,0,0,2.75,10.55A12,12,0,0,1,4.05,17ZM19.21,27.55A24.26,24.26,0,0,0,22,17h6A12,12,0,0,1,19.21,27.55Z"></path></svg>
          <div id="countrySwitcher"><div id="countryDropdown" class="hidden"><div id="currentRegion"></div><ul id="countryList"></ul></div></div></div>
        
          <!--?lit$225724174$-->
          <c4d-masthead-profile data-autoid="c4d--masthead-profile"><!---->
      <a part="profile-link" role="button" tabindex="0" class="cds--header__menu-item cds--header__menu-title" aria-expanded="false" aria-label="User profile">
        <!--?lit$225724174$--><svg focusable="false" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" fill="currentColor" aria-hidden="true" width="20" height="20" viewBox="0 0 32 32"><!--?lit$225724174$--><path d="M16 4a5 5 0 11-5 5 5 5 0 015-5m0-2a7 7 0 107 7A7 7 0 0016 2zM26 30H24V25a5 5 0 00-5-5H13a5 5 0 00-5 5v5H6V25a7 7 0 017-7h6a7 7 0 017 7z"></path></svg>
      </a>
      <ul part="header-menu" class="cds--header__menu">
        <slot></slot>
      </ul>
    
            <!--?lit$225724174$--><!---->
                  <c4d-masthead-profile-item href="https://myibm.ibm.com/?lnk=mmi" role="listitem"><!---->
      <a part="link" tabindex="0" class=" cds--header__menu-item " href="https://myibm.ibm.com/?lnk=mmi">
        <span part="title" class="cds--text-truncate--end"><slot><!--?lit$225724174$--></slot></span>
      </a>
    
                    <!--?lit$225724174$-->My IBM
                  </c4d-masthead-profile-item>
                <!----><!---->
                  <c4d-masthead-profile-item href="https://login.ibm.com/oidc/endpoint/default/authorize?redirect_uri=https%3A%2F%2Fmyibm.ibm.com%2FOIDCHandler.html&amp;response_type=token&amp;client_id=v18LoginProdCI&amp;scope=openid&amp;state=https%3A%2F%2Fwww.ibm.com%2Fthink%2Fx-force%2Fbeing-a-good-clr-host-modernizing-offensive-net-tradecraft&amp;nonce=8675309" role="listitem"><!---->
      <a part="link" tabindex="0" class=" cds--header__menu-item " href="https://login.ibm.com/oidc/endpoint/default/authorize?redirect_uri=https%3A%2F%2Fmyibm.ibm.com%2FOIDCHandler.html&amp;response_type=token&amp;client_id=v18LoginProdCI&amp;scope=openid&amp;state=https%3A%2F%2Fwww.ibm.com%2Fthink%2Fx-force%2Fbeing-a-good-clr-host-modernizing-offensive-net-tradecraft&amp;nonce=8675309">
        <span part="title" class="cds--text-truncate--end"><slot><!--?lit$225724174$--></slot></span>
      </a>
    
                    <!--?lit$225724174$-->Log in
                  </c4d-masthead-profile-item>
                <!---->
          </c4d-masthead-profile>
        
        </c4d-masthead-global-bar>
        <!--?lit$225724174$-->
          <c4d-masthead-l1 slot="masthead-l1" selected-menu-item="" data-autoid="c4d--masthead__l1" style="margin-inline-end: 0px; --scrollbarWidth: 15px;"><!---->
      <div part="masthead-l1-inner-container" class="cds--masthead__l1-inner-container">
        <!--?lit$225724174$--> <!--?lit$225724174$-->
      <div part="masthead-l1-menu-container-mask" class="cds--masthead__l1-menu-container-mask cds--masthead__l1-menu-container-mask--start"></div>
      <!--?lit$225724174$-->
            <div part="masthead-background-wrapper" class="cds--masthead__background-wrapper">
              <a part="masthead-l1-title" class="cds--masthead__l1-title" href="https://www.ibm.com/think" active=""><!--?lit$225724174$-->Think</a>
            </div>
          
      <div part="masthead-l1-menu-container-outer" class="cds--masthead__l1-menu-container-outer">
        
        <div part="l1-menu-container-inner" class="cds--masthead__l1-menu-container-inner">
          <ul part="l1-menu" class="cds--masthead__l1-menu">
            <!--?lit$225724174$--><!---->
        <li part="masthead-l1-item">
          <a part="masthead-l1-item-link" class="cds--masthead__l1-item" href="https://www.ibm.com/think/artificial-intelligence" target=""><!--?lit$225724174$-->Artificial intelligence</a>
        </li>
      <!----><!---->
        <li part="masthead-l1-item">
          <a part="masthead-l1-item-link" class="cds--masthead__l1-item" href="https://www.ibm.com/think/cloud" target=""><!--?lit$225724174$-->Cloud</a>
        </li>
      <!----><!---->
        <li part="masthead-l1-item">
          <a part="masthead-l1-item-link" class="cds--masthead__l1-item" href="https://www.ibm.com/think/security" target=""><!--?lit$225724174$-->Security</a>
        </li>
      <!----><!---->
        <li part="masthead-l1-item">
          <a part="masthead-l1-item-link" class="cds--masthead__l1-item" href="https://www.ibm.com/think/news" target=""><!--?lit$225724174$-->News</a>
        </li>
      <!----><!---->
      <li part="masthead-l1-item" tabindex="-1">
        <button part="masthead-l1-item-button" class="cds--masthead__l1-item">
          <!--?lit$225724174$-->Videos<!--?lit$225724174$--><svg focusable="false" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" fill="currentColor" aria-hidden="true" width="16" height="16" viewBox="0 0 16 16"><!--?lit$225724174$--><!--?lit$225724174$--><path d="M8 11L3 6 3.7 5.3 8 9.6 12.3 5.3 13 6z"></path></svg>
        </button>
        <div part="l1-dropdown" data-dropdown-target="" class="cds--masthead__l1-dropdown cds--masthead__l1-dropdown__1-col">
          <!--?lit$225724174$-->
          <div part="l1-dropdown-links" class=" cds--masthead__l1-dropdown-links ">
            <!--?lit$225724174$-->
            <!--?lit$225724174$--><!--?lit$225724174$--><!---->
        <div part="l1-dropdown-section" class="cds--masthead__l1-dropdown-section">
          <!--?lit$225724174$-->
          <!--?lit$225724174$--> <ul part="l1-dropdown-menu-items" class="cds--masthead__l1-dropdown-menu-items">
                <!--?lit$225724174$--><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/videos" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Overview 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/videos/ai-academy" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->AI Academy 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/videos/think-keynotes" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Think 2025 on demand 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/webinars" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Webinars 
                      </a>
                    </li>
                  <!---->
              </ul>
        </div>
      <!----><!--?-->
            <!--?lit$225724174$-->
          </div>
          <!--?lit$225724174$-->
        </div>
      </li>
    <!----><!---->
      <li part="masthead-l1-item" tabindex="-1">
        <button part="masthead-l1-item-button" class="cds--masthead__l1-item">
          <!--?lit$225724174$-->Reports<!--?lit$225724174$--><svg focusable="false" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" fill="currentColor" aria-hidden="true" width="16" height="16" viewBox="0 0 16 16"><!--?lit$225724174$--><!--?lit$225724174$--><path d="M8 11L3 6 3.7 5.3 8 9.6 12.3 5.3 13 6z"></path></svg>
        </button>
        <div part="l1-dropdown" data-dropdown-target="" class="cds--masthead__l1-dropdown cds--masthead__l1-dropdown__1-col">
          <!--?lit$225724174$-->
          <div part="l1-dropdown-links" class=" cds--masthead__l1-dropdown-links ">
            <!--?lit$225724174$-->
            <!--?lit$225724174$--><!--?lit$225724174$--><!---->
        <div part="l1-dropdown-section" class="cds--masthead__l1-dropdown-section">
          <!--?lit$225724174$-->
          <!--?lit$225724174$--> <ul part="l1-dropdown-menu-items" class="cds--masthead__l1-dropdown-menu-items">
                <!--?lit$225724174$--><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/reports/data-breach" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Cost of a Data Breach Report 2025 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/thought-leadership/institute-business-value/c-suite-study/ceo" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->The 2025 CEO Study 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/thought-leadership/institute-business-value/report/2025-threat-intelligence-index" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->IBM X-Force 2025 Threat Intelligence Index 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/thought-leadership/institute-business-value/report/industries-ai-era" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Industries in the AI era 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/thought-leadership/institute-business-value/report/agentic-process-automation" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Orchestrating agentic AI for intelligent business operations 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/thought-leadership/institute-business-value/report/supply-chain-ai-automation-oracle" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Scaling supply chain resilience: Agentic AI for autonomous operations 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/reports/ai-in-action" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->AI in Action report 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/reports/sustainability-readiness" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->State of Sustainability Readiness Report 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/thought-leadership/institute-business-value" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->View all IBV reports 
                      </a>
                    </li>
                  <!---->
              </ul>
        </div>
      <!----><!--?-->
            <!--?lit$225724174$-->
          </div>
          <!--?lit$225724174$-->
        </div>
      </li>
    <!----><!---->
      <li part="masthead-l1-item" tabindex="-1">
        <button part="masthead-l1-item-button" class="cds--masthead__l1-item">
          <!--?lit$225724174$-->Podcasts<!--?lit$225724174$--><svg focusable="false" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" fill="currentColor" aria-hidden="true" width="16" height="16" viewBox="0 0 16 16"><!--?lit$225724174$--><!--?lit$225724174$--><path d="M8 11L3 6 3.7 5.3 8 9.6 12.3 5.3 13 6z"></path></svg>
        </button>
        <div part="l1-dropdown" data-dropdown-target="" class="cds--masthead__l1-dropdown cds--masthead__l1-dropdown__1-col">
          <!--?lit$225724174$-->
          <div part="l1-dropdown-links" class=" cds--masthead__l1-dropdown-links ">
            <!--?lit$225724174$-->
            <!--?lit$225724174$--><!--?lit$225724174$--><!---->
        <div part="l1-dropdown-section" class="cds--masthead__l1-dropdown-section">
          <!--?lit$225724174$-->
          <!--?lit$225724174$--> <ul part="l1-dropdown-menu-items" class="cds--masthead__l1-dropdown-menu-items">
                <!--?lit$225724174$--><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/podcasts" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Overview 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/podcasts/ai-in-action" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->AI in Action 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/podcasts/mixture-of-experts" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Mixture of Experts 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/podcasts/security-intelligence" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Security Intelligence 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/podcasts/smart-talks" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Smart Talks with IBM 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/podcasts/techsplainers" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Techsplainers 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/podcasts/the-coherence-times" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->The Coherence Times 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/podcasts/transformers-podcast" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Transformers Podcast 
                      </a>
                    </li>
                  <!---->
              </ul>
        </div>
      <!----><!--?-->
            <!--?lit$225724174$-->
          </div>
          <!--?lit$225724174$-->
        </div>
      </li>
    <!----><!---->
      <li part="masthead-l1-item" tabindex="-1">
        <button part="masthead-l1-item-button" class="cds--masthead__l1-item">
          <!--?lit$225724174$-->Events<!--?lit$225724174$--><svg focusable="false" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" fill="currentColor" aria-hidden="true" width="16" height="16" viewBox="0 0 16 16"><!--?lit$225724174$--><!--?lit$225724174$--><path d="M8 11L3 6 3.7 5.3 8 9.6 12.3 5.3 13 6z"></path></svg>
        </button>
        <div part="l1-dropdown" data-dropdown-target="" class="cds--masthead__l1-dropdown cds--masthead__l1-dropdown__1-col">
          <!--?lit$225724174$-->
          <div part="l1-dropdown-links" class=" cds--masthead__l1-dropdown-links ">
            <!--?lit$225724174$-->
            <!--?lit$225724174$--><!--?lit$225724174$--><!---->
        <div part="l1-dropdown-section" class="cds--masthead__l1-dropdown-section">
          <!--?lit$225724174$-->
          <!--?lit$225724174$--> <ul part="l1-dropdown-menu-items" class="cds--masthead__l1-dropdown-menu-items">
                <!--?lit$225724174$--><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/events/think" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Think 2026 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/events/think/on-tour" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Think on Tour 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/events/techxchange" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->TechXchange 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/events" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->View all IBM Events 
                      </a>
                    </li>
                  <!---->
              </ul>
        </div>
      <!----><!--?-->
            <!--?lit$225724174$-->
          </div>
          <!--?lit$225724174$-->
        </div>
      </li>
    <!----><!---->
      <li part="masthead-l1-item" tabindex="-1">
        <button part="masthead-l1-item-button" class="cds--masthead__l1-item">
          <!--?lit$225724174$-->More<!--?lit$225724174$--><svg focusable="false" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" fill="currentColor" aria-hidden="true" width="16" height="16" viewBox="0 0 16 16"><!--?lit$225724174$--><!--?lit$225724174$--><path d="M8 11L3 6 3.7 5.3 8 9.6 12.3 5.3 13 6z"></path></svg>
        </button>
        <div part="l1-dropdown" data-dropdown-target="" class="cds--masthead__l1-dropdown cds--masthead__l1-dropdown__2-col">
          <!--?lit$225724174$-->
          <div part="l1-dropdown-links" class=" cds--masthead__l1-dropdown-links ">
            <!--?lit$225724174$-->
            <!--?lit$225724174$--><!--?lit$225724174$--><!---->
        <div part="l1-dropdown-section" class="cds--masthead__l1-dropdown-section">
          <!--?lit$225724174$--><!--?lit$225724174$-->
          <h2 part="masthead-l1-h2-heading" class=" cds--masthead__l1-dropdown-heading cds--masthead__l1-dropdown-heading--no-link ">
            <!--?lit$225724174$--> <!--?lit$225724174$-->Topics 
          </h2>
          <!--?lit$225724174$-->
        <!--?-->
          <!--?lit$225724174$--> <ul part="l1-dropdown-menu-items" class="cds--masthead__l1-dropdown-menu-items">
                <!--?lit$225724174$--><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/analytics" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Analytics 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/asset-management" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Asset management 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/business-automation" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Business automation 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/business-operations" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Business operations 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/compute" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Compute and servers 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/devops" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->DevOps 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/it-automation" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->IT automation 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/it-infrastructure" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->IT infrastructure 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/middleware" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Middleware 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/network" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Network 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/quantum" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Quantum 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/security" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Security 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/storage" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Storage 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/sustainability" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Sustainability 
                      </a>
                    </li>
                  <!---->
              </ul>
        </div>
      <!----><!---->
        <div part="l1-dropdown-section" class="cds--masthead__l1-dropdown-section">
          <!--?lit$225724174$--><!--?lit$225724174$-->
          <h2 part="masthead-l1-h2-heading" class=" cds--masthead__l1-dropdown-heading cds--masthead__l1-dropdown-heading--no-link ">
            <!--?lit$225724174$--> <!--?lit$225724174$-->Content types 
          </h2>
          <!--?lit$225724174$-->
        <!--?-->
          <!--?lit$225724174$--> <ul part="l1-dropdown-menu-items" class="cds--masthead__l1-dropdown-menu-items">
                <!--?lit$225724174$--><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/topics" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Explainers 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/insights" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Insights 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/news" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->News 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/subscribe" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Newsletters 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/architectures" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Reference architectures 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/tutorials" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Tutorials 
                      </a>
                    </li>
                  <!---->
              </ul>
        </div>
      <!----><!---->
        <div part="l1-dropdown-section" class="cds--masthead__l1-dropdown-section">
          <!--?lit$225724174$--><!--?lit$225724174$-->
          <h2 part="masthead-l1-h2-heading" class=" cds--masthead__l1-dropdown-heading cds--masthead__l1-dropdown-heading--no-link ">
            <!--?lit$225724174$--> <!--?lit$225724174$-->Industries 
          </h2>
          <!--?lit$225724174$-->
        <!--?-->
          <!--?lit$225724174$--> <ul part="l1-dropdown-menu-items" class="cds--masthead__l1-dropdown-menu-items">
                <!--?lit$225724174$--><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/automotive" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Automotive 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/banking-financial-markets" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Banking 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/consumer-goods" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Consumer Goods 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/energy" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Energy &amp; Utilities 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/government" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Government 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/healthcare" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Healthcare 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/manufacturing" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Manufacturing 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/retail" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Retail 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/telecommunications" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Telecommunications 
                      </a>
                    </li>
                  <!----><!---->
                    <li part="l1-dropdown-menu-item">
                      <a part="l1-dropdown-item-link" class="cds--masthead__l1-dropdown-item" href="https://www.ibm.com/think/travel-transportation" target="_self">
                        <!--?lit$225724174$--> <!--?lit$225724174$-->Travel 
                      </a>
                    </li>
                  <!---->
              </ul>
        </div>
      <!----><!--?-->
            <!--?lit$225724174$-->
          </div>
          <!--?lit$225724174$--><a part="l1-dropdown-viewall" class="cds--masthead__l1-dropdown-viewall" href="https://www.ibm.com/think/search"><!--?lit$225724174$-->View all<!--?lit$225724174$--><svg focusable="false" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" fill="currentColor" aria-hidden="true" width="16" height="16" viewBox="0 0 16 16"><!--?lit$225724174$--><path d="M9.3 3.7L13.1 7.5 1 7.5 1 8.5 13.1 8.5 9.3 12.3 10 13 15 8 10 3z"></path></svg></a>
        </div>
      </li>
    <!---->
          </ul>
        </div>
        
      </div>
      <!--?lit$225724174$-->
      <!--?lit$225724174$--><slot name="l1-cta"></slot>
      <div part="masthead-l1-menu-container-mask" class="cds--masthead__l1-menu-container-mask cds--masthead__l1-menu-container-mask--end"></div>
     
      </div>
    
            <!--?lit$225724174$-->
        <c4d-masthead-l1-cta slot="l1-cta" href="https://www.ibm.com/forms/news-mkt-52954"><!---->
        <a part="l1-link" class="cds--masthead__l1-cta" href="https://www.ibm.com/forms/news-mkt-52954">
          <!--?lit$225724174$-->
          <div part="inner-wrapper-desktop" class="cds--masthead__l1-cta-inner">
            <!--?lit$225724174$--><slot name="cta-text"></slot><!--?lit$225724174$--><!--?-->
          </div>
        
        </a>
      
          <!--?lit$225724174$--><span slot="cta-text"><!--?lit$225724174$-->Subscribe</span>
        </c4d-masthead-l1-cta>
      
          </c4d-masthead-l1>
        
        <c4d-megamenu-overlay></c4d-megamenu-overlay>
      </c4d-masthead>
    </c4d-masthead-container>






    



    







    
    








    

    

    

    
        
            
    




        
    

    






</div>
<div class="container responsivegrid">

    
    
    
    <div id="container-79eeba8da1" class="cmp-container">
        
        
        
    </div>

</div>
<div class="leadspace-container container responsivegrid" id="mbox-leadspace">

    
    
    
    <div id="leadspace-container-280ab0aca9" class="cmp-container">
        
        <div class="leadspace-article">

<div class="cds--leadspace-article">
	<section class="cds--leadspace-article__section cds-row">
		<div class="cds--leadspace-article__container--col">
			<div class="cds--leadspace-article__row">
				<div class="cds--leadspace-article__tags">
					
					<div class="tag-group">
						
							<a href="https://www.ibm.com/think/security">
                                <span class="aem-tag">
                                    Security
                                </span>
                            </a>
                        
                    </div>
                </div>
            </div>
            <div class="cds--leadspace-article__row cds--leadspace-article__row--title">
                <div class="cds--leadspace-article__title">
                    <h1 class="article-heading-title" id="mbox-heading">
                        
                        


  
  
    
    Being a good CLR host  Modernizing offensive .NET tradecraft

  





    


                    </h1>
                </div>
            </div>
            
            

            <div class="cds--leadspace-article__row cds--leadspace-article__row--full-width" id="mbox-leadspace_visual">
                <div class="cds--leadspace-article__assets">
                    <div class="cds--leadspace-article__assets--image">
                            <div class="image--responsive">
                                


	

	<div data-cmp-hook-image="imageV3IBM" data-cmp-is="image" data-cmp-widths="320,384,512,640,768,960,1024,1152,1280,1536,1584" data-cmp-dmimage="" data-cmp-src="https://assets.ibm.com/is/image/ibm/ma82916?ts=1738604436987&amp;dpr=off" data-asset-id="a348cde8-32d1-4d5e-9d6a-a1d09fbbf8e4" data-cmp-filereference="/content/dam/connectedassets-adobe-cms/worldwide-content/stock-assets/getty/image/photography/4a/7f/ma82916.jpg" id="image-dm-55f83818a0" data-cmp-data-layer="{&quot;image-dm-55f83818a0&quot;:{&quot;@type&quot;:&quot;adobe-cms/components/content/atoms/image-dm&quot;,&quot;dc:title&quot;:&quot;Side view of IT professional working on laptop in office&quot;,&quot;image&quot;:{&quot;repo:id&quot;:&quot;a348cde8-32d1-4d5e-9d6a-a1d09fbbf8e4&quot;,&quot;repo:modifyDate&quot;:&quot;2025-02-03T17:40:36Z&quot;,&quot;@type&quot;:&quot;image/jpeg&quot;,&quot;repo:path&quot;:&quot;/content/dam/connectedassets-adobe-cms/worldwide-content/stock-assets/getty/image/photography/4a/7f/ma82916.jpg&quot;,&quot;xdm:tags&quot;:[&quot;properties:orientation/landscape&quot;],&quot;xdm:smartTags&quot;:{&quot;peripheral&quot;:0.791,&quot;gaming&quot;:0.766,&quot;video gaming&quot;:0.765,&quot;woman&quot;:1.0,&quot;person&quot;:1.0,&quot;business photography&quot;:0.882,&quot;client&quot;:0.84,&quot;call center&quot;:0.826}}}}" class="cmp-image overlaywatermark">
		
		

			
				
					

					<img src="https://assets.ibm.com/is/image/ibm/ma82916?dpr=on%2C1&amp;wid=320&amp;hei=213" loading="lazy" class="cmp-image__image " itemprop="contentUrl" width="5700" height="3800" alt="Woman typing on the computer inside a dark room">
				

				

			
		
		

		

	</div>
	
    




    



                            </div>
                            
                    </div>
                    
                </div>
            </div>
        </div>
    </section>
</div>

	
    



</div>

        
    </div>

</div>
<div class="table-of-contents container responsivegrid">
<c4d-table-of-contents data-cmp-is="table-of-contents" data-autoid="c4d--table-of-contents" class="cmp-table-of-contents  " stickyoffset="96" toc-layout=""><!---->
      <!--?lit$98379261282$-->
      <div part="container" class=" c4d-ce--table-of-contents__container ">
        <div part="table" class=" cds--tableofcontents__sidebar ">
          <!--?lit$98379261282$-->
                
              
          <!--?lit$98379261282$-->
          <div part="items-container" class="c4d-ce--table-of-contents__items-container" style="position: sticky; top: 96px; transition: none; inset-block-start: 114px;">
            <div part="item-container" class="cds--tableofcontents-container">
              <div part="content" class="cds--tableofcontents" style="left: -0px">
                <!--?lit$98379261282$-->
                      <div part="sub-content-left" class="cds--sub-content-left"></div>
                    
                <ul part="list">
                  <!--?lit$98379261282$--><!---->
                      <li class="cds--tableofcontents__item cds--tableofcontents__item--active" part="list-item list-item--active">
                        <a part="link" data-target="Overview" href="https://www.ibm.com/think/x-force/being-a-good-clr-host-modernizing-offensive-net-tradecraft#Overview" tabindex="0" aria-current="location">
                          <!--?lit$98379261282$-->Overview
                        </a>
                      </li>
                    <!----><!---->
                      <li class=" cds--tableofcontents__item " part="list-item">
                        <a part="link" data-target="Key+highlights" href="https://www.ibm.com/think/x-force/being-a-good-clr-host-modernizing-offensive-net-tradecraft#Key+highlights" tabindex="-1">
                          <!--?lit$98379261282$-->Key highlights
                        </a>
                      </li>
                    <!----><!---->
                      <li class=" cds--tableofcontents__item " part="list-item">
                        <a part="link" data-target="A+brief+history+of+executing+assemblies" href="https://www.ibm.com/think/x-force/being-a-good-clr-host-modernizing-offensive-net-tradecraft#A+brief+history+of+executing+assemblies" tabindex="-1">
                          <!--?lit$98379261282$-->A brief history of executing assemblies
                        </a>
                      </li>
                    <!----><!---->
                      <li class=" cds--tableofcontents__item " part="list-item">
                        <a part="link" data-target="How+to+host+the+common+language+runtime" href="https://www.ibm.com/think/x-force/being-a-good-clr-host-modernizing-offensive-net-tradecraft#How+to+host+the+common+language+runtime" tabindex="-1">
                          <!--?lit$98379261282$-->How to host the common language runtime
                        </a>
                      </li>
                    <!----><!---->
                      <li class=" cds--tableofcontents__item " part="list-item">
                        <a part="link" data-target="What+are+CLR+customizations%3F" href="https://www.ibm.com/think/x-force/being-a-good-clr-host-modernizing-offensive-net-tradecraft#What+are+CLR+customizations%3F" tabindex="-1">
                          <!--?lit$98379261282$-->What are CLR customizations?
                        </a>
                      </li>
                    <!----><!---->
                      <li class=" cds--tableofcontents__item " part="list-item">
                        <a part="link" data-target="Implementing+IHostControl" href="https://www.ibm.com/think/x-force/being-a-good-clr-host-modernizing-offensive-net-tradecraft#Implementing+IHostControl" tabindex="-1">
                          <!--?lit$98379261282$-->Implementing IHostControl
                        </a>
                      </li>
                    <!----><!---->
                      <li class=" cds--tableofcontents__item " part="list-item">
                        <a part="link" data-target="Starting+the+CLR" href="https://www.ibm.com/think/x-force/being-a-good-clr-host-modernizing-offensive-net-tradecraft#Starting+the+CLR" tabindex="-1">
                          <!--?lit$98379261282$-->Starting the CLR
                        </a>
                      </li>
                    <!----><!---->
                      <li class=" cds--tableofcontents__item " part="list-item">
                        <a part="link" data-target="Taking+over+the+CLR%E2%80%99s+memory" href="https://www.ibm.com/think/x-force/being-a-good-clr-host-modernizing-offensive-net-tradecraft#Taking+over+the+CLR%E2%80%99s+memory" tabindex="-1">
                          <!--?lit$98379261282$-->Taking over the CLRs memory
                        </a>
                      </li>
                    <!----><!---->
                      <li class=" cds--tableofcontents__item " part="list-item">
                        <a part="link" data-target="Tracking+and+clearing+assembly+artifacts" href="https://www.ibm.com/think/x-force/being-a-good-clr-host-modernizing-offensive-net-tradecraft#Tracking+and+clearing+assembly+artifacts" tabindex="-1">
                          <!--?lit$98379261282$-->Tracking and clearing assembly artifacts
                        </a>
                      </li>
                    <!----><!---->
                      <li class=" cds--tableofcontents__item " part="list-item">
                        <a part="link" data-target="Managing+assembly+loads" href="https://www.ibm.com/think/x-force/being-a-good-clr-host-modernizing-offensive-net-tradecraft#Managing+assembly+loads" tabindex="-1">
                          <!--?lit$98379261282$-->Managing assembly loads
                        </a>
                      </li>
                    <!----><!---->
                      <li class=" cds--tableofcontents__item " part="list-item">
                        <a part="link" data-target="Bypassing+AMSI" href="https://www.ibm.com/think/x-force/being-a-good-clr-host-modernizing-offensive-net-tradecraft#Bypassing+AMSI" tabindex="-1">
                          <!--?lit$98379261282$-->Bypassing AMSI
                        </a>
                      </li>
                    <!----><!---->
                      <li class=" cds--tableofcontents__item " part="list-item">
                        <a part="link" data-target="Proof-of-concept+and+further+operationalization" href="https://www.ibm.com/think/x-force/being-a-good-clr-host-modernizing-offensive-net-tradecraft#Proof-of-concept+and+further+operationalization" tabindex="-1">
                          <!--?lit$98379261282$-->Proof-of-concept and further operationalization
                        </a>
                      </li>
                    <!----><!---->
                      <li class=" cds--tableofcontents__item " part="list-item">
                        <a part="link" data-target="Defensive+considerations" href="https://www.ibm.com/think/x-force/being-a-good-clr-host-modernizing-offensive-net-tradecraft#Defensive+considerations" tabindex="-1">
                          <!--?lit$98379261282$-->Defensive considerations
                        </a>
                      </li>
                    <!----><!---->
                      <li class=" cds--tableofcontents__item " part="list-item">
                        <a part="link" data-target="Why+release+this+now%3F" href="https://www.ibm.com/think/x-force/being-a-good-clr-host-modernizing-offensive-net-tradecraft#Why+release+this+now%3F" tabindex="-1">
                          <!--?lit$98379261282$-->Why release this now?
                        </a>
                      </li>
                    <!----><!---->
                      <li class=" cds--tableofcontents__item " part="list-item">
                        <a part="link" data-target="Wrapping+up" href="https://www.ibm.com/think/x-force/being-a-good-clr-host-modernizing-offensive-net-tradecraft#Wrapping+up" tabindex="-1">
                          <!--?lit$98379261282$-->Wrapping up
                        </a>
                      </li>
                    <!----><!---->
                      <li class=" cds--tableofcontents__item " part="list-item">
                        <a part="link" data-target="Acknowledgments" href="https://www.ibm.com/think/x-force/being-a-good-clr-host-modernizing-offensive-net-tradecraft#Acknowledgments" tabindex="-1">
                          <!--?lit$98379261282$-->Acknowledgments
                        </a>
                      </li>
                    <!----><!---->
                      <li class=" cds--tableofcontents__item " part="list-item">
                        <a part="link" data-target="Related+works" href="https://www.ibm.com/think/x-force/being-a-good-clr-host-modernizing-offensive-net-tradecraft#Related+works" tabindex="-1">
                          <!--?lit$98379261282$-->Related works
                        </a>
                      </li>
                    <!---->
                </ul>
                <!--?lit$98379261282$-->
                      <div part="sub-content-right" class="cds--sub-content-right"></div>
                    
              </div>
            </div>
          </div>

          <!--?lit$98379261282$-->
        </div>

        <div part="content-table" class="cds--tableofcontents__content">
          <div part="wrapper" class="cds--tableofcontents__content-wrapper">
            <!--?lit$98379261282$-->
            <slot></slot>
          </div>
        </div>
      </div>
    
    
    
    <div id="table-of-contents-bddcff21bf" class="cmp-table-of-contents table-of-contents-article cds-row">
        
        <div class="body-article-8 container responsivegrid cds--col">


    
    
    
    <div id="container-79564acb22" class="cmp-container">
        
        <div class="author-signature">

<div class="cmp-author-signature ">
    <h2 class="productive-heading-02 author-signature__title">
        


  
  
    
    Author

  





    


    </h2>
    <div class="cds--author-signature">
        <div class="cds--author-signature__author">
            <div class="cds--author-signature__author--image">
                
                <div class="cds--author-signature__author--image--default">
                    <svg id="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
                        <path d="M16,8a5,5,0,1,0,5,5A5,5,0,0,0,16,8Zm0,8a3,3,0,1,1,3-3A3.0034,3.0034,0,0,1,16,16Z"></path>
                        <path d="M16,2A14,14,0,1,0,30,16,14.0158,14.0158,0,0,0,16,2ZM10,26.3765V25a3.0033,3.0033,0,0,1,3-3h6a3.0033,3.0033,0,0,1,3,3v1.3765a11.8989,11.8989,0,0,1-12,0Zm13.9925-1.4507A5.0016,5.0016,0,0,0,19,20H13a5.0016,5.0016,0,0,0-4.9925,4.9258,12,12,0,1,1,15.985,0Z"></path>
                    </svg>
                </div>
            </div>
            <div class="cds--author-signature__author--details">
                
                    
                    <span class="productive-heading-02">Joshua Magri</span>
                
                <p class="auth-signature-paragraph body-short-02">Senior Managing Security Consultant</p>
                <p class="auth-signature-paragraph body-short-02"> Adversary Services,  IBM X-Force Red</p>
            </div>

        </div>

    </div>
</div>




    
    


</div>
<div class="standalone-title enhanced-title text">

    <h2 class="expressive-heading-05  ">
        
    </h2>
        
  
    
    <a data-title="Overview" name="Overview"></a>
  









    

</div>
<div class="rich-text text"><div class="cms-richtext  " id="rich-text-86db51df89" data-dynamic-inner-content="description">
     <p>The modern red team is defined by its ability to compromise endpoints and take actions to complete objectives. To achieve the former, many teams implement their own custom command-and-control (C2) or use an open-source option. For the latter, there is a constant stream of post-exploitation tooling being released that takes advantage of various features in Windows, Active Directory and third-party applications. The execution mechanism for this tooling has, for the last several years, relied heavily on executing .NET assemblies in memory.</p><p>Despite being such a large part of the modern red team arsenal, tradecraft for executing .NET assemblies on a compromised endpoint has remained largely stagnant. In this blog post, we will discuss how red teams can bring their .NET execution harnesses into this decade.</p>
    
    
    
    

</div></div>
<div class="standalone-title enhanced-title text">

    <h2 class="expressive-heading-05  ">
        Key highlights
    </h2>
        
  
    
    <a data-title="Key highlights" name="Key+highlights"></a>
  









    

</div>
<div class="rich-text text"><div class="cms-richtext  " id="rich-text-0779a1438f" data-dynamic-inner-content="description">
    <ul><li>Operators can take control over many aspects of the CLR using CLR customizations when executing .NET assemblies in memory</li><li>Taking over memory management for the CLR enables operators to control and track all allocations made by the CLR, and also provides an easy way to keep track of assemblies being loaded into the process</li><li>Implementing a custom assembly loading manager enables a novel AMSI bypass using only intended functionality, with no byte patches or process hacking required</li></ul>
    
    
    
    

</div></div>
<div class="experiencefragment">
<div id="experiencefragment-a806e667b3" class="cmp-experiencefragment cmp-experiencefragment--blueprint---subscription-form-inline---xf---do-not-edit">

    



<div class="xf-content-height">
    <div class="root container responsivegrid">

    
    
    
    <div id="container-9e1b978f22" class="cmp-container">
        
        <div class="subscription-form-inline">

<div class="subscription-form-inline__container theme-" data-attribute2="Data management" data-attribute1="subscription">
    <div class="subscription-form-inline__content">
        <div class="subscription-form-inline__content__label">
            
    <span class="  normal cms-richtext">
        <p>Industry newsletter</p>

    </span>
    
    



        </div>

        <div class="subscription-form-inline__content__title">
            



    <h3 class="expressive-heading-04  ">The latest tech news, backed by expert insights</h3>






    


        </div>

        <div class="subscription-form-inline__content__text" id="subscription-text">
            
    <span class="  normal cms-richtext">
        <p>Stay up to date on the most importantand intriguingindustry trends on AI, automation, data and beyond with the Think Newsletter.&nbsp;See the&nbsp;<a href="https://www.ibm.com/privacy" target="_self" rel="noopener noreferrer">IBM Privacy Statement</a>.</p>

    </span>
    
    



        </div>
        <div class="subscription-form-inline__thanks-container ">
            
            <div class="subscription-form-inline__content__thanks-heading hide" id="thanks-heading">
                



    <h3 class="expressive-heading-04  ">Thank you! You are subscribed.</h3>






    


            </div>

            <div class="subscription-form-inline__content__thanks-text hide" id="thanks-text">
                

            </div>
        </div>
        <div class="subscription-form-inline__content__form" data-xf-topics="Data management,Enterprise asset management,Artificial intelligence,DataOps,Blockchain,Cloud hosting,Cloud management,Cloud migration,Business operations,Business intelligence,Hybrid cloud,Network management,Marketing,Renewable energy,e-Commerce,ESG,Application development,Telecommunications,Cloud storage,Customer experience,Business strategy,Energy and utilities,Business process management,Climate change,Business transformation,Business automation,Domain Name System,Procurement,IoT,Supply chain,Compute and servers,Asset management,Sustainability,Cloud networking,Industry-related topics,Manufacturing,Consulting,Digital experience,5G,Business process automation,Retail,Business sustainability,Transportation,High performance computing,Financial services,Disaster recovery,Customer service,Application modernization,Employee experience,Enterprise content management,Talent management,Sales,Middleware,AI and ML,Data science,DevOps,Cloud,Healthcare,Robotic process automation,Data storage,Mainframes,Analytics,Insurance,IT automation,Services,Kubernetes,Banking,Automotive,IT infrastructure,Agriculture,Cloud integration,Virtualization,Corporate finance,OpenTelemetry,Software composition analysis" data-is-xf="">
            <div no-toc="" id="subscription-52954"><div class="urx-form-widget urx-form-col-2 urx-form-theme-light"><div class="urx-form-container " dir="ltr"><div class="hiddenTest" style="display: none;"> </div><div class="form-block shortform-block fist-step "><div class="form-container
                
                  no-accordion inline-form"><div class="hiddenTest" style="display: none;"> </div><div></div><form id="signUpForm" name="signUpForm"><div class="form-inner-container"><ul class="cds--accordion reg-accordion cds--accordion--end cds--accordion--lg cds--layout--size-lg"><li class="cds--accordion__item cds--accordion__item--active cds--accordion__item reg-accordion-item reg-accordion-item--active  accordion-final-step  "><button type="button" aria-controls="accordion-item-:r2:" aria-expanded="true" class="cds--accordion__heading"><svg focusable="false" preserveAspectRatio="xMidYMid meet" fill="currentColor" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" class="cds--accordion__arrow" xmlns="http://www.w3.org/2000/svg"><path d="M11 8L6 13 5.3 12.3 9.6 8 5.3 3.7 6 3z"></path></svg><div class="cds--accordion__title" dir="auto"><li class="cds--progress-step cds--progress-step--current"></li></div></button><button type="button" class="cds--progress-step-button cds--progress-step-button--unclickable" aria-disabled="false" tabindex="-1" title="Account information"><svg focusable="false" preserveAspectRatio="xMidYMid meet" fill="currentColor" width="16" height="16" viewBox="0 0 32 32" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"><path d="M23.7642 6.8593l1.2851-1.5315A13.976 13.976 0 0020.8672 2.887l-.6836 1.8776A11.9729 11.9729 0 0123.7642 6.8593zM27.81 14l1.9677-.4128A13.8888 13.8888 0 0028.14 9.0457L26.4087 10A12.52 12.52 0 0127.81 14zM20.1836 27.2354l.6836 1.8776a13.976 13.976 0 004.1821-2.4408l-1.2851-1.5315A11.9729 11.9729 0 0120.1836 27.2354zM26.4087 22L28.14 23a14.14 14.14 0 001.6382-4.5872L27.81 18.0659A12.1519 12.1519 0 0126.4087 22zM16 30V2a14 14 0 000 28z"></path><title></title></svg><div class="cds--progress-text"><p class="cds--progress-label" dir="auto">Account information</p></div><span class="cds--assistive-text">Current</span><span class="cds--progress-line"></span></button></li></ul></div><div class="cds--accordion__wrapper"><div id="accordion-item-:r2:" class="cds--accordion__content"><div class="reg-accordion-item__content_section"><div class="input-fields-container"><div class=" full-width field-container email-container input-type-text"><div class="bx-p-rel "><div class=""><span class="jfk-bubble bx--tooltip   email-notification"><span>We use your email to validate you are who you say you are, to create your IBMid, and to contact you for account related matters.</span><span class="bx--tooltip__caret jit-caret"></span></span><div class="cds--form-item full-width cds--text-input-wrapper"><div class="cds--text-input__label-wrapper"><label for="email" class="cds--label cds--visually-hidden" dir="auto">Business email</label></div><div class="cds--text-input__field-outer-wrapper"><div class="cds--text-input__field-wrapper"><input id="email" placeholder="johndoe@yourdomain.com" type="text" class="cds--text-input cds--text-input--lg cds--layout--size-lg" title="johndoe@yourdomain.com" name="email" value=""><span class="cds--text-input__counter-alert" role="alert" aria-live="assertive" aria-atomic="true"></span></div></div></div></div></div></div><div class=" full-width chickadee-legal-text chickadee-question field-container Q_NEWS_CHICK_LEGAL-container input-type-label"><div class="cds--form-item full-width"><p>Your subscription will be delivered in English. You will find an unsubscribe link in every newsletter. You can manage your subscriptions or unsubscribe <a target="_blank" href="https://www.ibm.com/account/reg/us-en/signup?formid=news-urx-51525"> here.</a> Refer to our <a target="_blank" href="https://www.ibm.com/us-en/privacy"> IBM Privacy Statement</a> for more information.</p></div></div></div></div></div></div><div class="button-container no-accordion-form"><button class="cds--btn--md btn--long bx--btn--primary cds--btn cds--btn--primary" type="submit">Subscribe<svg focusable="false" preserveAspectRatio="xMidYMid meet" fill="currentColor" aria-hidden="true" width="16" height="16" viewBox="0 0 16 16" class="cds--btn__icon" xmlns="http://www.w3.org/2000/svg"><path d="M9.3 3.7L13.1 7.5 1 7.5 1 8.5 13.1 8.5 9.3 12.3 10 13 15 8 10 3z"></path></svg></button></div></form></div></div></div></div></div></div>
        </div>
    </div>
    <div class="subscription-form-inline__tooltip">
        <cds-toggletip alignment="left" has-actions=""><!---->
      <!--?lit$883923442$-->
      <span class="cds--toggletip-label">
        <slot></slot>
      </span>
    
      <span class=" cds--popover-container cds--popover--caret cds--popover--high-contrast cds--popover--left cds--toggletip ">
        <!--?lit$883923442$-->
      <!--?lit$883923442$-->
      <button aria-controls="" class="cds--toggletip-button">
        <!--?lit$883923442$--><svg focusable="false" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" fill="currentColor" aria-hidden="true" width="16" height="16" viewBox="0 0 16 16" id="trigger"><!--?lit$883923442$--><path d="M8.5 11L8.5 6.5 6.5 6.5 6.5 7.5 7.5 7.5 7.5 11 6 11 6 12 10 12 10 11zM8 3.5c-.4 0-.8.3-.8.8S7.6 5 8 5c.4 0 .8-.3.8-.8S8.4 3.5 8 3.5z"></path><path d="M8,15c-3.9,0-7-3.1-7-7s3.1-7,7-7s7,3.1,7,7S11.9,15,8,15z M8,2C4.7,2,2,4.7,2,8s2.7,6,6,6s6-2.7,6-6S11.3,2,8,2z"></path></svg>
      </button>
     <!--?lit$883923442$-->
          <span class="cds--popover">
            <span class="cds--popover-content">
              <div class="cds--toggletip-content">
                <slot name="body-text"></slot>
                <div class="cds--toggletip-actions">
                  <slot name="actions"></slot>
                </div>
              </div>
            </span>
            <span class="cds--popover-caret"></span>
          </span>
        
    
      </span>
    
    
            <div slot="body-text">
                
                    <p>Your subscription will be delivered in English. You will find an unsubscribe link in every newsletter. You can manage your subscriptions or unsubscribe <a href="https://www.ibm.com/account/reg/signup?formid=news-urx-51525" target="_blank" rel="noopener noreferrer">here</a>. Refer to our <a href="https://www.ibm.com/privacy" target="_self" rel="noopener noreferrer">IBM Privacy Statement</a> for more information.<br>
</p>
 
            </div>
            <a target="_self" slot="actions">
                <cds-link size=""><!---->
      </cds-link></a><a tabindex="0" id="link" part="link" class=" cds--link ">
        <!--?lit$225724174$-->
      <slot></slot>
      
    
      </a>
    
                     
                
            
        </cds-toggletip>
    </div>
</div>


    


</div>

        
    </div>

</div>

</div>
</div>

    
</div>
<div class="standalone-title enhanced-title text">

    <h2 class="expressive-heading-05  ">
        A brief history of executing assemblies
    </h2>
        
  
    
    <a data-title="A brief history of executing assemblies" name="A+brief+history+of+executing+assemblies"></a>
  









    

</div>
<div class="rich-text text"><div class="cms-richtext  " id="rich-text-412ee32cb2" data-dynamic-inner-content="description">
    <p>Not so long ago, many <a href="https://www.ibm.com/think/security" target="_blank" rel="noopener noreferrer">red teams</a> relied on PowerShell for post-exploitation tooling. Cobalt Strike took a step to change that in 2018 by implementing the <a href="https://www.cobaltstrike.com/blog/cobalt-strike-3-11-the-snake-that-eats-its-tail" target="_blank" rel="noopener noreferrer"><span class="ibm_icon_launch_external_after">execute-assembly module</span></a>. Execute-assembly would spawn a sacrificial process and inject a reflective DLL into it which would load the Common Language Runtime (CLR) and execute a .NET assembly provided by the operator.</p>
<p>This resulted in a lot of post-exploitation tooling being shifted over to .NET assemblies. After a while, defenders began to build detections for the fork-and-run behavior of execute-assembly, namely the reflective DLL injection. To get around this, <a href="https://x.com/anthemtotheego" target="_blank" rel="noopener noreferrer"><span class="ibm_icon_launch_external_after">Shawn Jones</span></a>, also of the IBM Adversary Simulation team, developed the <a href="https://www.ibm.com/think/x-force/net-execution-inlineexecute-assembly?" target="_self" rel="noopener noreferrer">InlineExecute-Assembly</a> Beacon Object File (BOF). This allowed operators to shift away from the fork-and-run behavior of execute-assembly and stay within the implant process. Since then, many C2 frameworks have adopted this behavior natively.</p>
<p>If you are not already familiar with how to host the CLR and execute .NET assemblies, I would recommend you read Shawns blog post linked above.</p>

    
    
    
    

</div></div>
<div class="experiencefragment">
<div id="experiencefragment-e5343507cc" class="cmp-experiencefragment cmp-experiencefragment--blueprint---media-player-ad-video---xf---do-not-edit">

    



<div class="xf-content-height">
    <div class="root container responsivegrid">

    
    
    
    <div id="container-d4eb71d339" class="cmp-container">
        
        <div class="media-player-ad-video">



<div class="media-player-ad-video__container theme-media-player-ad--image-bkg-light" data-theme="image-bkg-light" data-autoid="" data-cmp-data-layer="{&quot;media-player-ad-video-44de5f8f83&quot;:{&quot;linkLabel&quot;:&quot;Watch all episodes of Mixture of Experts&quot;,&quot;linkNumber&quot;:1,&quot;mediaPlayerLink&quot;:&quot;https://www.ibm.com/think/podcasts/mixture-of-experts?utm=XFLatestEpMoE&quot;,&quot;@type&quot;:&quot;adobe-cms/components/content/molecules/media-player-ad-video&quot;,&quot;ctaInXf&quot;:&quot;true&quot;,&quot;topic&quot;:&quot;Enterprise asset management&quot;,&quot;eyebrowLabel&quot;:&quot;Mixture of Experts | 13 February, episode 94&quot;,&quot;componentName&quot;:&quot;Media Player Ad - Video&quot;}}" data-attribute2="Enterprise asset management" data-attribute1="media-player" style="--backgroundImage: url(https://cdnsecakmi.kaltura.com/p/1773841/thumbnail/entry_id/1_m4234x30/width/full);">
    <div class="media-player-ad-video__content">
        <div class="media-player-ad-video__top">
            <div class="media-player-ad-video__eyebrow">


  
  
      Mixture of Experts | 13 February, episode 94
  




    

</div>
        </div>

        <div class="media-player-ad-video__video" data-cmp-clickable="">

	
		
			<c4d-video-player-container class="overlaywatermark" video-id="1_m4234x30" aspect-ratio="16x9" playing-mode="inline" hide-caption="" button-position="bottom-right" href="https://mediacenter.ibm.com/id/1_m4234x30" data-attribute1="media-player-video" data-attribute2="Enterprise asset management"><!----> <slot></slot> 
				
					
    


					
    



				
			<!---->
      <c4d-video-player part="video-player" hide-caption="" thumbnail-url="https://cdnsecakmi.kaltura.com/p/1773841/thumbnail/entry_id/1_m4234x30/width/3" video-id="1_m4234x30" aspect-ratio="16x9" playing-mode="inline" content-state="thumbnail" button-position="bottom-right" data-autoid="c4d--video-player" tabindex="0" duration="2300" name="What do people really use AI for?" aria-label="What do people really use AI for? (38:20 min)"><!---->
      <div part="video-container" class=" c4d--video-player__video-container c4d--video-player__aspect-ratio--16x9 ">
        <!--?lit$162927062$-->
        <!--?lit$162927062$-->
            <div part="video" class="c4d--video-player__video">
              <button part="button" class="c4d--video-player__image-overlay" href="https://mediacenter.ibm.com/id/1_m4234x30" data-attribute1="media-player-video" data-attribute2="Enterprise asset management">
                <c4d-image part="image" default-src="https://cdnsecakmi.kaltura.com/p/1773841/thumbnail/entry_id/1_m4234x30/width/1180" data-autoid="c4d--image" alt="What do people really use AI for?"><!---->
      <!--?lit$162927062$--> <!--?lit$162927062$-->
      <slot></slot>
      <picture part="picture">
        <!--?lit$162927062$-->
        <img aria-describedby="image-caption long-description" part="image" loading="lazy" class=" c4d--image__img " src="https://cdnsecakmi.kaltura.com/p/1773841/thumbnail/entry_id/1_m4234x30/width/1180" alt="What do people really use AI for?">
      </picture>
      <div id="long-description" part="long-description" class="c4d--image__longdescription">
        <slot name="long-description"></slot>
      </div>
      <slot name="icon"></slot>
     
      <!--?lit$162927062$-->
    
                  <!--?lit$162927062$--><svg focusable="false" preserveAspectRatio="xMidYMid meet" slot="icon" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" width="64px" height="64px" viewBox="0 0 64 64" part="play-video"><!--?lit$162927062$--><g id="visual-spec" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Card-group-video" transform="translate(-736.000000, -1746.000000)"><g id="Group-2-Copy-2" transform="translate(608.000000, 1658.000000)"><g id="Group-3" transform="translate(128.000000, 88.000000)"><circle id="Oval-Copy-3" fill-opacity="0.9" fill="#525252" cx="32" cy="32" r="32"></circle><path d="M26.5555476,43.111135 C26.0032708,43.111135 25.5555476,42.6633959 25.5555476,42.1111111 L25.5555476,20.1111111 C25.5541311,19.7531358 25.7441673,19.4217049 26.0538295,19.2421008 C26.3634918,19.0624967 26.745539,19.0621192 27.0555476,19.2411111 L46.0555476,30.2411111 C46.368866,30.4186723 46.5625038,30.7509842 46.5625038,31.1111111 C46.5625038,31.4712381 46.368866,31.8035499 46.0555476,31.9811111 L27.0555476,42.9811111 C26.9031526,43.0674916 26.7307319,43.1123209 26.5555476,43.111135 Z" id="Path-Copy" fill="#F3F3F3" fill-rule="nonzero"></path></g></g></g></g></svg>
                </c4d-image>
              </button>
            </div>
          
      </div>
      <!--?lit$162927062$-->
    
      </c4d-video-player>
    </c4d-video-player-container>
		
	
	<div id="c4d-analytics-data" data-title-c4d="Being a good CLR host: modernizing offensive net tradecraft" data-last-modified-c4d="Wed Nov 19 15:59:01 UTC 2025" data-last-published-c4d="Wed Nov 19 15:59:01 UTC 2025" data-template-c4d="/conf/adobe-cms-editable/settings/wcm/templates/article" data-playing-mode-c4d="inline">
	</div>


    

</div>

        <h3 class="expressive-heading-03 media-player-ad-video__heading">
            


  
  
    
    Decoding AI: Weekly News Roundup

  





    


        </h3>
        <div class="media-player-ad-video__text">
            
    <span class="  normal cms-richtext">
        <p>Join our world-class panel of engineers, researchers, product leaders and more as they cut through the AI noise to bring you the latest in AI news and insights.</p>

    </span>
    
    



        </div>
        <div class="media-player-ad-video__link">
    
    
        
        
        
        
        
        
        
        
        <a href="https://www.ibm.com/think/podcasts/mixture-of-experts?utm=XFLatestEpMoE" style="display: contents;">
            </a><div><a href="https://www.ibm.com/think/podcasts/mixture-of-experts?utm=XFLatestEpMoE" style="display: contents;">
                <c4d-link-with-icon cta-type="local" href="https://www.ibm.com/think/podcasts/mixture-of-experts?utm=XFLatestEpMoE" icon-placement="right" target="_blank" data-link-type="local" data-dynamic-properties="{&quot;ctaUrl&quot;:&quot;href&quot;}" data-video-modal-type="media-center" data-cmp-clickable="" data-autoid="c4d--link-with-icon" data-attribute1="media-player-link" data-attribute2="Enterprise asset management"><!---->
      </c4d-link-with-icon></a><a tabindex="0" id="link" part="link" class="cds--link cds--link--lg cds--link-with-icon cds--link-with-icon__icon-right cds--link-with-icon--inline-icon" href="https://www.ibm.com/think/podcasts/mixture-of-experts?utm=XFLatestEpMoE" target="_blank" data-link-type="local" data-dynamic-properties="{&quot;ctaUrl&quot;:&quot;href&quot;}" data-video-modal-type="media-center" data-cmp-clickable="" data-attribute1="media-player-link" data-attribute2="Enterprise asset management">
        <!--?lit$0164668459$--> <!--?lit$0164668459$--><span part="span"><slot></slot></span><!--?lit$0164668459$-->
        <slot name="icon">
          <span part="icon-visually-hidden" class="cds--visually-hidden"><!--?lit$0164668459$--></span>
          <!--?lit$0164668459$--><svg focusable="false" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" fill="currentColor" aria-hidden="true" width="20" height="20" viewBox="0 0 20 20" class="c4d--card__cta c4d-ce--cta__icon"><!--?lit$0164668459$--><path d="M11.8 2.8L10.8 3.8 16.2 9.3 1 9.3 1 10.7 16.2 10.7 10.8 16.2 11.8 17.2 19 10z"></path></svg>
        </slot>
       
      </a>
    
                    
                    <span class="cds--link-text" data-link-text="" data-dynamic-inner-content="ctaLabel">Watch all episodes of Mixture of Experts</span>

                    
                        
    <!-- LTR - Left to Right version -->
    
    <svg xmlns="http://www.w3.org/2000/svg" slot="icon" width="20" height="20" focusable="false" fill="currentColor" viewBox="0 0 20 20" aria-hidden="true">
        <path d="M11.8 2.8L10.8 3.8 16.2 9.3 1 9.3 1 10.7 16.2 10.7 10.8 16.2 11.8 17.2 19 10z"></path>
    </svg>

    <!-- RTL - Right to Left version -->
    
    
    
    
    
    
    
    
    

                        
                    
                
            </div>
        
    
    
    


</div>
    </div>

    <div class="media-player-ad-video__wrapper">
        <div class="media-player-ad-video__wrapper__background"></div>
        <div class="media-player-ad-video__wrapper__overlay"></div>
    </div>
</div>
</div>

        
    </div>

</div>

</div>
</div>

    
</div>
<div class="standalone-title enhanced-title text">

    <h2 class="expressive-heading-05  ">
        How to host the common language runtime
    </h2>
        
  
    
    <a data-title="How to host the common language runtime" name="How+to+host+the+common+language+runtime"></a>
  









    

</div>
<div class="rich-text text"><div class="cms-richtext  " id="rich-text-56ac45f9f6" data-dynamic-inner-content="description">
    <p>The execute-assembly technique takes advantage of a Windows feature known as <a href="https://learn.microsoft.com/en-us/dotnet/framework/unmanaged-api/hosting/clr-hosting-interfaces" target="_blank" rel="noopener noreferrer"><span class="ibm_icon_launch_external_after">Unmanaged CLR Hosting</span></a>. The Common Language Runtime, or CLR, is the runtime environment for .NET. Users can write .NET assemblies in a variety of languages (C#, F#, etc.) which are compiled into an Intermediate Language (IL). The CLR is responsible for taking an assembly containing IL and executing it.</p>
<p>Traditionally, the execute-assembly technique has relied on the use of the deprecated <a href="https://learn.microsoft.com/en-us/dotnet/framework/unmanaged-api/hosting/icorruntimehost-interface" target="_blank" rel="noopener noreferrer"><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="ICorRuntimeHost" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      <span class="ibm_icon_launch_external_after">ICorRuntimeHost</span></cds-code-snippet>
</a>&nbsp;interface.&nbsp;The reason that offensive practitioners use this interface is that it allows for loading assemblies from an in-memory byte array, by creating an <a href="https://learn.microsoft.com/en-us/dotnet/framework/app-domains/application-domains" target="_blank" rel="noopener noreferrer"><span class="ibm_icon_launch_external_after">App Domain</span></a> and using the <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="Load_3" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      Load_3</cds-code-snippet>
</code> method. By loading from a byte array we avoid the problem of having to drop any code to the file system, which could be scanned by defensive solutions.</p>
<p>The <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="ICorRuntimeHost" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      ICorRuntimeHost</cds-code-snippet>
</code> has since been replaced by the <a href="https://learn.microsoft.com/en-us/dotnet/framework/unmanaged-api/hosting/iclrruntimehost-interface" target="_blank" rel="noopener noreferrer"><code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="ICLRRuntimeHost" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      <span class="ibm_icon_launch_external_after">ICLRRuntimeHost</span></cds-code-snippet>
</code></a> interface.</p>

    
    
    
    

</div></div>
<div class="image-dm image">


	

	<div data-cmp-aspectratio="1x1|1x1|1x1|16x9|16x9" data-cmp-hook-image="imageV3IBM" data-cmp-is="image" data-cmp-widths="320,384,512,640,768,960,1024,1152,1280,1536,1584" data-cmp-dmimage="" data-cmp-src="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1?ts=1763567921772&amp;dpr=off" data-asset-id="6031843c-d257-4617-a7d1-b3f555d699b6" data-cmp-filereference="/content/dam/connectedassets-adobe-cms/worldwide-content/creative-assets/iwci/ul/g/60/31/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1.png" id="image-dm-ae8173e27b" data-cmp-data-layer="{&quot;image-dm-ae8173e27b&quot;:{&quot;@type&quot;:&quot;adobe-cms/components/content/atoms/image-dm&quot;,&quot;repo:modifyDate&quot;:&quot;2025-11-19T15:58:41Z&quot;,&quot;dc:title&quot;:&quot;Being a good CLR host  Modernizing offensive NET tradecraft&quot;,&quot;image&quot;:{&quot;repo:id&quot;:&quot;6031843c-d257-4617-a7d1-b3f555d699b6&quot;,&quot;repo:modifyDate&quot;:&quot;2025-02-21T19:53:14Z&quot;,&quot;@type&quot;:&quot;image/png&quot;,&quot;repo:path&quot;:&quot;/content/dam/connectedassets-adobe-cms/worldwide-content/creative-assets/iwci/ul/g/60/31/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1.png&quot;}}}" class="cmp-image overlaywatermark" data-cmp-aspectratio-max="16x9" data-cmp-aspectratio-xl="16x9" data-cmp-aspectratio-md="1x1" data-cmp-aspectratio-lg="1x1" data-cmp-aspectratio-sm="1x1">
		
		

			
				<picture>
					
						<source media="(min-width: 1584px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=216 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=288 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=360 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=432 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=540 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=576 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=648 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=720 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=864 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=891 1584w">
						<source media="(min-width: 1312px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=216 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=288 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=360 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=432 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=540 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=576 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=648 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=720 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=864 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=891 1584w">
						<source media="(min-width: 1056px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
						<source media="(min-width: 627px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
						<source media="(min-width: 320px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
					

					<img src="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-1:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180" loading="lazy" class="cmp-image__image " itemprop="contentUrl" width="1561" height="784" alt="MSDN page for the ICLRRuntimeHost interface">
				</picture>

				

			
		
		

		

	</div>
	
    




    

</div>
<div class="rich-text text"><div class="cms-richtext  " id="rich-text-ee133167a7" data-dynamic-inner-content="description">
    <p><em>Figure 1: MSDN page for the ICLRRuntimeHost interface</em></p>
<p>The MSDN docs for the&nbsp;<cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="ICLRRuntimeHost" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      ICLRRuntimeHost</cds-code-snippet>
&nbsp;interface state that it adds the&nbsp;<a href="https://learn.microsoft.com/en-us/dotnet/framework/unmanaged-api/hosting/iclrruntimehost-sethostcontrol-method" target="_blank" rel="noopener noreferrer"><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="SetHostControl" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      <span class="ibm_icon_launch_external_after">SetHostControl</span></cds-code-snippet>
</a>&nbsp;method, but omits some methods provided by&nbsp;<cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="ICorRuntimeHost" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      ICorRuntimeHost</cds-code-snippet>
. When Microsoft says omission of some methods, they mean all of the fun ones that let us load assemblies reflectively. In exchange, we get access to CLR Customizations through the&nbsp;<cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="SetHostControl" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      SetHostControl</cds-code-snippet>
&nbsp;method.</p>
<p>Note: While we cant use&nbsp;<cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="ICLRRuntimeHost" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      ICLRRuntimeHost</cds-code-snippet>
&nbsp;directly to load reflective assemblies, we can start the CLR using&nbsp;<cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="ICLRRuntimeHost" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      ICLRRuntimeHost</cds-code-snippet>
&nbsp;and then call&nbsp;<cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="GetInterface" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      GetInterface</cds-code-snippet>
&nbsp;to get an&nbsp;<cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="ICorRuntimeHost" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      ICorRuntimeHost</cds-code-snippet>
&nbsp;interface. Then we can use the&nbsp;<cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="ICorRuntimeHost" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      ICorRuntimeHost</cds-code-snippet>
&nbsp;interface to load reflective assemblies while also having our CLR Customizations enabled.</p>

    
    
    
    

</div></div>
<div class="standalone-title enhanced-title text">

    <h2 class="expressive-heading-05  ">
        What are CLR customizations?
    </h2>
        
  
    
    <a data-title="What are CLR customizations?" name="What+are+CLR+customizations%3F"></a>
  









    

</div>
<div class="rich-text text"><div class="cms-richtext  " id="rich-text-6572d0e120" data-dynamic-inner-content="description">
    <p>The <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="SetHostControl" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      SetHostControl</cds-code-snippet>
</code> method allows us to provide our own implementation of the <a href="https://learn.microsoft.com/en-us/dotnet/framework/unmanaged-api/hosting/ihostcontrol-interface" target="_blank" rel="noopener noreferrer"><code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="IHostControl" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      <span class="ibm_icon_launch_external_after">IHostControl</span></cds-code-snippet>
</code></a> COM interface, which is how we can tell the CLR to use various customization features. CLR Customizations are a little talked-about feature which allow developers to take control over aspects of the CLR. Customizations work by using various Manager interfaces that we as the developer can implement, and our <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="IHostControl" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      IHostControl</cds-code-snippet>
</code> implementation will tell the CLR which managers we would like it to use. Anything we dont implement will simply be handled by the CLR as it normally would. A list of supported managers is shown below..</p>

    
    
    
    

</div></div>
<div class="image-dm image">


	

	<div data-cmp-aspectratio="1x1|1x1|1x1|16x9|16x9" data-cmp-hook-image="imageV3IBM" data-cmp-is="image" data-cmp-widths="320,384,512,640,768,960,1024,1152,1280,1536,1584" data-cmp-dmimage="" data-cmp-src="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2?ts=1763567922146&amp;dpr=off" data-asset-id="eab90d33-8875-4a48-862e-5c062af1b507" data-cmp-filereference="/content/dam/connectedassets-adobe-cms/worldwide-content/creative-assets/iwci/ul/g/ea/b9/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2.png" id="image-dm-ef821fc97a" data-cmp-data-layer="{&quot;image-dm-ef821fc97a&quot;:{&quot;@type&quot;:&quot;adobe-cms/components/content/atoms/image-dm&quot;,&quot;repo:modifyDate&quot;:&quot;2025-11-19T15:58:42Z&quot;,&quot;dc:title&quot;:&quot;Being a good CLR host  Modernizing offensive NET tradecraft&quot;,&quot;image&quot;:{&quot;repo:id&quot;:&quot;eab90d33-8875-4a48-862e-5c062af1b507&quot;,&quot;repo:modifyDate&quot;:&quot;2025-02-21T19:52:33Z&quot;,&quot;@type&quot;:&quot;image/png&quot;,&quot;repo:path&quot;:&quot;/content/dam/connectedassets-adobe-cms/worldwide-content/creative-assets/iwci/ul/g/ea/b9/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2.png&quot;}}}" class="cmp-image overlaywatermark" data-cmp-aspectratio-max="16x9" data-cmp-aspectratio-xl="16x9" data-cmp-aspectratio-md="1x1" data-cmp-aspectratio-lg="1x1" data-cmp-aspectratio-sm="1x1">
		
		

			
				<picture>
					
						<source media="(min-width: 1584px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=216 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=288 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=360 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=432 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=540 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=576 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=648 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=720 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=864 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=891 1584w">
						<source media="(min-width: 1312px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=216 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=288 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=360 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=432 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=540 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=576 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=648 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=720 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=864 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=891 1584w">
						<source media="(min-width: 1056px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
						<source media="(min-width: 627px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
						<source media="(min-width: 320px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
					

					<img src="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-2:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180" loading="lazy" class="cmp-image__image " itemprop="contentUrl" width="975" height="615" alt="Some of the interfaces supported for CLR customizations">
				</picture>

				

			
		
		

		

	</div>
	
    




    

</div>
<div class="rich-text text"><div class="cms-richtext  " id="rich-text-b88e872891" data-dynamic-inner-content="description">
    <p><em>Figure 2: Some of the interfaces supported for CLR customizations</em></p>
<p>Ive used red boxes to highlight the two managers that will be covered in this blog post:&nbsp;<a href="https://learn.microsoft.com/en-us/dotnet/framework/unmanaged-api/hosting/ihostmemorymanager-interface" target="_blank" rel="noopener noreferrer"><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="IHostMemoryManager" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      <span class="ibm_icon_launch_external_after">IHostMemoryManager</span></cds-code-snippet>
</a>&nbsp;and&nbsp;<a href="https://learn.microsoft.com/en-us/dotnet/framework/unmanaged-api/hosting/ihostassemblymanager-interface" target="_blank" rel="noopener noreferrer"><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="IHostAssemblyManager" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      <span class="ibm_icon_launch_external_after">IHostAssemblyManager</span></cds-code-snippet>
</a>. But first, we will implement our&nbsp;<cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="IHostControl" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      IHostControl</cds-code-snippet>
&nbsp;interface.</p>

    
    
    
    

</div></div>
<div class="standalone-title enhanced-title text">

    <h2 class="expressive-heading-05  ">
        Implementing IHostControl
    </h2>
        
  
    
    <a data-title="Implementing IHostControl" name="Implementing+IHostControl"></a>
  









    

</div>
<div class="rich-text text"><div class="cms-richtext  " id="rich-text-e9c7347ec0" data-dynamic-inner-content="description">
    <p>I wrote my initial proof-of-concept for CLR Customizations in C++, but I ultimately chose to re-implement everything in pure C, which is what we will look at in this post. I prefer implants written in C to avoid the bloat of C++, so I wanted this assembly execution harness in C as well. Implementing COM interfaces in C is a massive chore, but I hope that the following information will make it easier in the future. Below is how you need to define the <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="IHostControl" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      IHostControl</cds-code-snippet>
</code> interface, which I have named MyHostControl.</p>

    
    
    
    

</div></div>
<div class="image-dm image">


	

	<div data-cmp-aspectratio="1x1|1x1|1x1|16x9|16x9" data-cmp-hook-image="imageV3IBM" data-cmp-is="image" data-cmp-widths="320,384,512,640,768,960,1024,1152,1280,1536,1584" data-cmp-dmimage="" data-cmp-src="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3?ts=1763567922480&amp;dpr=off" data-asset-id="334295da-afd6-49d0-8dfe-e73b899fcc51" data-cmp-filereference="/content/dam/connectedassets-adobe-cms/worldwide-content/creative-assets/iwci/ul/g/33/42/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3.png" id="image-dm-e7ed2380f9" data-cmp-data-layer="{&quot;image-dm-e7ed2380f9&quot;:{&quot;@type&quot;:&quot;adobe-cms/components/content/atoms/image-dm&quot;,&quot;repo:modifyDate&quot;:&quot;2025-11-19T15:58:42Z&quot;,&quot;dc:title&quot;:&quot;Being a good CLR host  Modernizing offensive NET tradecraft&quot;,&quot;image&quot;:{&quot;repo:id&quot;:&quot;334295da-afd6-49d0-8dfe-e73b899fcc51&quot;,&quot;repo:modifyDate&quot;:&quot;2025-04-03T21:25:07Z&quot;,&quot;@type&quot;:&quot;image/png&quot;,&quot;repo:path&quot;:&quot;/content/dam/connectedassets-adobe-cms/worldwide-content/creative-assets/iwci/ul/g/33/42/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3.png&quot;,&quot;xdm:tags&quot;:[&quot;properties:orientation/landscape&quot;],&quot;xdm:smartTags&quot;:{&quot;editorial photography&quot;:0.837,&quot;webpage&quot;:0.766}}}}" class="cmp-image overlaywatermark" data-cmp-aspectratio-max="16x9" data-cmp-aspectratio-xl="16x9" data-cmp-aspectratio-md="1x1" data-cmp-aspectratio-lg="1x1" data-cmp-aspectratio-sm="1x1">
		
		

			
				<picture>
					
						<source media="(min-width: 1584px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=216 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=288 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=360 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=432 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=540 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=576 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=648 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=720 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=864 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=891 1584w">
						<source media="(min-width: 1312px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=216 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=288 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=360 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=432 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=540 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=576 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=648 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=720 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=864 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=891 1584w">
						<source media="(min-width: 1056px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
						<source media="(min-width: 627px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
						<source media="(min-width: 320px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
					

					<img src="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-3:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180" loading="lazy" class="cmp-image__image " itemprop="contentUrl" width="1551" height="1144" alt="Header file implementing the IHostControl interface">
				</picture>

				

			
		
		

		

	</div>
	
    




    

</div>
<div class="rich-text text"><div class="cms-richtext  " id="rich-text-e2cf82c577" data-dynamic-inner-content="description">
    <p><em>Figure 3:&nbsp;Header file implementing the IHostControl interface</em></p>
<p>To implement our COM interface, we must have the following components (shown above in this order):</p>
<ol><li>A typedef for a struct which contains the functions for our interface. The&nbsp;<cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="QueryInterface" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      QueryInterface</cds-code-snippet>
,&nbsp;<cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="AddRef" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      AddRef</cds-code-snippet>
&nbsp;and&nbsp;<cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="Release" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      Release</cds-code-snippet>
&nbsp;functions are boilerplate and will be in every COM interface. The two functions below,&nbsp;<cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="GetHostManager" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      GetHostManager</cds-code-snippet>
&nbsp;and&nbsp;<cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="SetAppDomainManager" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      SetAppDomainManager</cds-code-snippet>
, are specific to this interface.</li><li>A typedef for a struct that defines our actual interface, which has a Virtual Table (VTBL) and a Count.</li><li>Definitions for the specific functions that we will implement separately. Ive prefixed them with MyHostControl_ as you will have to define&nbsp;<cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="QueryInterface" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      QueryInterface</cds-code-snippet>
/<cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="AddRef" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      AddRef</cds-code-snippet>
/<cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="Release" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      Release</cds-code-snippet>
&nbsp;for every COM interface.</li><li>A const of the VTBL we defined earlier but populated with the functions we defined above.</li></ol>
<p>Implementing the actual methods is a bit more straightforward, as shown below:</p>

    
    
    
    

</div></div>
<div class="image-dm image">


	

	<div data-cmp-aspectratio="1x1|1x1|1x1|16x9|16x9" data-cmp-hook-image="imageV3IBM" data-cmp-is="image" data-cmp-widths="320,384,512,640,768,960,1024,1152,1280,1536,1584" data-cmp-dmimage="" data-cmp-src="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4?ts=1763567922681&amp;dpr=off" data-asset-id="405c25ae-69b6-4bc1-ae66-03d9f8d3f00a" data-cmp-filereference="/content/dam/connectedassets-adobe-cms/worldwide-content/creative-assets/iwci/ul/g/40/5c/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4.png" id="image-dm-308f859fe9" data-cmp-data-layer="{&quot;image-dm-308f859fe9&quot;:{&quot;@type&quot;:&quot;adobe-cms/components/content/atoms/image-dm&quot;,&quot;repo:modifyDate&quot;:&quot;2025-11-19T15:58:42Z&quot;,&quot;dc:title&quot;:&quot;Being a good CLR host  Modernizing offensive NET tradecraft&quot;,&quot;image&quot;:{&quot;repo:id&quot;:&quot;405c25ae-69b6-4bc1-ae66-03d9f8d3f00a&quot;,&quot;repo:modifyDate&quot;:&quot;2025-02-21T19:51:16Z&quot;,&quot;@type&quot;:&quot;image/png&quot;,&quot;repo:path&quot;:&quot;/content/dam/connectedassets-adobe-cms/worldwide-content/creative-assets/iwci/ul/g/40/5c/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4.png&quot;}}}" class="cmp-image overlaywatermark" data-cmp-aspectratio-max="16x9" data-cmp-aspectratio-xl="16x9" data-cmp-aspectratio-md="1x1" data-cmp-aspectratio-lg="1x1" data-cmp-aspectratio-sm="1x1">
		
		

			
				<picture>
					
						<source media="(min-width: 1584px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=216 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=288 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=360 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=432 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=540 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=576 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=648 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=720 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=864 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=891 1584w">
						<source media="(min-width: 1312px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=216 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=288 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=360 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=432 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=540 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=576 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=648 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=720 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=864 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=891 1584w">
						<source media="(min-width: 1056px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
						<source media="(min-width: 627px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
						<source media="(min-width: 320px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
					

					<img src="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-4:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180" loading="lazy" class="cmp-image__image " itemprop="contentUrl" width="1553" height="758" alt="Implementing the QueryInterface, AddRef and Release methods">
				</picture>

				

			
		
		

		

	</div>
	
    




    

</div>
<div class="rich-text text"><div class="cms-richtext  " id="rich-text-9ffa3ac2ab" data-dynamic-inner-content="description">
    <p><em>Figure 4: Implementing the QueryInterface, AddRef and Release methods</em></p>
<p>As I mentioned before, the&nbsp;<cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="QueryInterface" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      QueryInterface</cds-code-snippet>
/<cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="AddRef" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      AddRef</cds-code-snippet>
/<cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="Release" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      Release</cds-code-snippet>
&nbsp;methods are boilerplate. The only thing you need to change to implement a different interface is the xIID_IHostControl value in the&nbsp;<cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="QueryInterface" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      QueryInterface</cds-code-snippet>
&nbsp;method.</p>

    
    
    
    

</div></div>
<div class="image-dm image">


	

	<div data-cmp-aspectratio="1x1|1x1|1x1|16x9|16x9" data-cmp-hook-image="imageV3IBM" data-cmp-is="image" data-cmp-widths="320,384,512,640,768,960,1024,1152,1280,1536,1584" data-cmp-dmimage="" data-cmp-src="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5?ts=1763567922863&amp;dpr=off" data-asset-id="7eabf585-c346-4585-a02c-45de15490aaf" data-cmp-filereference="/content/dam/connectedassets-adobe-cms/worldwide-content/creative-assets/iwci/ul/g/7e/ab/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5.png" id="image-dm-78fd81731a" data-cmp-data-layer="{&quot;image-dm-78fd81731a&quot;:{&quot;@type&quot;:&quot;adobe-cms/components/content/atoms/image-dm&quot;,&quot;repo:modifyDate&quot;:&quot;2025-11-19T15:58:42Z&quot;,&quot;dc:title&quot;:&quot;Being a good CLR host  Modernizing offensive NET tradecraft&quot;,&quot;image&quot;:{&quot;repo:id&quot;:&quot;7eabf585-c346-4585-a02c-45de15490aaf&quot;,&quot;repo:modifyDate&quot;:&quot;2025-02-21T19:50:52Z&quot;,&quot;@type&quot;:&quot;image/png&quot;,&quot;repo:path&quot;:&quot;/content/dam/connectedassets-adobe-cms/worldwide-content/creative-assets/iwci/ul/g/7e/ab/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5.png&quot;}}}" class="cmp-image overlaywatermark" data-cmp-aspectratio-max="16x9" data-cmp-aspectratio-xl="16x9" data-cmp-aspectratio-md="1x1" data-cmp-aspectratio-lg="1x1" data-cmp-aspectratio-sm="1x1">
		
		

			
				<picture>
					
						<source media="(min-width: 1584px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=216 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=288 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=360 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=432 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=540 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=576 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=648 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=720 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=864 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=891 1584w">
						<source media="(min-width: 1312px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=216 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=288 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=360 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=432 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=540 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=576 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=648 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=720 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=864 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=891 1584w">
						<source media="(min-width: 1056px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
						<source media="(min-width: 627px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
						<source media="(min-width: 320px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
					

					<img src="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-5:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180" loading="lazy" class="cmp-image__image " itemprop="contentUrl" width="979" height="343" alt="Implementing the GetHostManager method">
				</picture>

				

			
		
		

		

	</div>
	
    




    

</div>
<div class="rich-text text"><div class="cms-richtext  " id="rich-text-54d31e829e" data-dynamic-inner-content="description">
    <p><em>Figure 5:&nbsp;Implementing the GetHostManager method</em></p>
<p>Here we dont actually need to implement the&nbsp;<cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="SetAppDomainManager" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      SetAppDomainManager</cds-code-snippet>
&nbsp;method and can simply return E_NOTIMPL, so long as we dont try to call it later. The&nbsp;<cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="GetHostManager" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      GetHostManager</cds-code-snippet>
&nbsp;method, which is the core of this interface, is really just a series of if statements where we check to see if the CLR is asking us for a manager that we care about. In the code above, I am checking if the provided IID is for the&nbsp;<cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="IHostMemoryManager" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      IHostMemoryManager</cds-code-snippet>
&nbsp;interface, and then creating a new memory manager pointing the ppObject argument to it.</p>

    
    
    
    

</div></div>
<div class="standalone-title enhanced-title text">

    <h2 class="expressive-heading-05  ">
        Starting the CLR
    </h2>
        
  
    
    <a data-title="Starting the CLR" name="Starting+the+CLR"></a>
  









    

</div>
<div class="rich-text text"><div class="cms-richtext  " id="rich-text-3600986228" data-dynamic-inner-content="description">
    <p>Now that weve implemented our <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="IHostControl" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      IHostControl</cds-code-snippet>
</code> interface, we can call <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="SetHostControl" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      SetHostControl</cds-code-snippet>
</code> and start the CLR. Below is a snippet of code for doing the normal CLR hosting stuff (<code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="CLRCreateInstance" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      CLRCreateInstance</cds-code-snippet>
</code>, <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="GetRuntime" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      GetRuntime</cds-code-snippet>
</code>, <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="GetInterface" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      GetInterface</cds-code-snippet>
</code>), and then calling <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="SetHostControl" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      SetHostControl</cds-code-snippet>
</code> using our custom host control interface. Then we start the CLR.</p>

    
    
    
    

</div></div>
<div class="image-dm image">


	

	<div data-cmp-aspectratio="1x1|1x1|1x1|16x9|16x9" data-cmp-hook-image="imageV3IBM" data-cmp-is="image" data-cmp-widths="320,384,512,640,768,960,1024,1152,1280,1536,1584" data-cmp-dmimage="" data-cmp-src="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6?ts=1763567923208&amp;dpr=off" data-asset-id="1238a091-27e3-4251-b48e-85cee8540cde" data-cmp-filereference="/content/dam/connectedassets-adobe-cms/worldwide-content/creative-assets/iwci/ul/g/12/38/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6.png" id="image-dm-ca36eba06b" data-cmp-data-layer="{&quot;image-dm-ca36eba06b&quot;:{&quot;@type&quot;:&quot;adobe-cms/components/content/atoms/image-dm&quot;,&quot;repo:modifyDate&quot;:&quot;2025-11-19T15:58:43Z&quot;,&quot;dc:title&quot;:&quot;Being a good CLR host  Modernizing offensive NET tradecraft&quot;,&quot;image&quot;:{&quot;repo:id&quot;:&quot;1238a091-27e3-4251-b48e-85cee8540cde&quot;,&quot;repo:modifyDate&quot;:&quot;2025-02-21T19:50:32Z&quot;,&quot;@type&quot;:&quot;image/png&quot;,&quot;repo:path&quot;:&quot;/content/dam/connectedassets-adobe-cms/worldwide-content/creative-assets/iwci/ul/g/12/38/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6.png&quot;}}}" class="cmp-image overlaywatermark" data-cmp-aspectratio-max="16x9" data-cmp-aspectratio-xl="16x9" data-cmp-aspectratio-md="1x1" data-cmp-aspectratio-lg="1x1" data-cmp-aspectratio-sm="1x1">
		
		

			
				<picture>
					
						<source media="(min-width: 1584px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=216 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=288 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=360 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=432 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=540 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=576 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=648 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=720 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=864 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=891 1584w">
						<source media="(min-width: 1312px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=216 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=288 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=360 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=432 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=540 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=576 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=648 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=720 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=864 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=891 1584w">
						<source media="(min-width: 1056px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
						<source media="(min-width: 627px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
						<source media="(min-width: 320px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
					

					<img src="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-6:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180" loading="lazy" class="cmp-image__image " itemprop="contentUrl" width="1597" height="657" alt="Calling SetHostControl and starting the CLR">
				</picture>

				

			
		
		

		

	</div>
	
    




    

</div>
<div class="rich-text text"><div class="cms-richtext  " id="rich-text-7e37382116" data-dynamic-inner-content="description">
    <p><em>Figure 6:&nbsp;Calling SetHostControl and starting the CLR</em></p>

    
    
    
    

</div></div>
<div class="standalone-title enhanced-title text">

    <h2 class="expressive-heading-05  ">
        Taking over the CLRs memory
    </h2>
        
  
    
    <a data-title="Taking over the CLRs memory" name="Taking+over+the+CLR%E2%80%99s+memory"></a>
  









    

</div>
<div class="rich-text text"><div class="cms-richtext  " id="rich-text-0d846e7623" data-dynamic-inner-content="description">
    <p>Now that we know how to implement COM interfaces in C, implementing specific managers is more straightforward. The <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="IHostMemoryManager" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      IHostMemoryManager</cds-code-snippet>
</code> interface allows us to take control of the CLRs memory management. Below is a <a href="https://learn.microsoft.com/en-us/dotnet/framework/unmanaged-api/hosting/ihostmemorymanager-interface" target="_blank" rel="noopener noreferrer"><span class="ibm_icon_launch_external_after">list of all the functions</span></a> we need to implement for <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="IHostMemoryManager" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      IHostMemoryManager</cds-code-snippet>
</code>.</p>

    
    
    
    

</div></div>
<div class="image-dm image">


	

	<div data-cmp-aspectratio="1x1|1x1|1x1|16x9|16x9" data-cmp-hook-image="imageV3IBM" data-cmp-is="image" data-cmp-widths="320,384,512,640,768,960,1024,1152,1280,1536,1584" data-cmp-dmimage="" data-cmp-src="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7?ts=1763567923539&amp;dpr=off" data-asset-id="66154e09-8e3e-4098-b743-226a548e9e52" data-cmp-filereference="/content/dam/connectedassets-adobe-cms/worldwide-content/creative-assets/iwci/ul/g/66/15/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7.png" id="image-dm-9181740514" data-cmp-data-layer="{&quot;image-dm-9181740514&quot;:{&quot;@type&quot;:&quot;adobe-cms/components/content/atoms/image-dm&quot;,&quot;repo:modifyDate&quot;:&quot;2025-11-19T15:58:43Z&quot;,&quot;dc:title&quot;:&quot;Being a good CLR host  Modernizing offensive NET tradecraft&quot;,&quot;image&quot;:{&quot;repo:id&quot;:&quot;66154e09-8e3e-4098-b743-226a548e9e52&quot;,&quot;repo:modifyDate&quot;:&quot;2025-02-21T19:50:09Z&quot;,&quot;@type&quot;:&quot;image/png&quot;,&quot;repo:path&quot;:&quot;/content/dam/connectedassets-adobe-cms/worldwide-content/creative-assets/iwci/ul/g/66/15/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7.png&quot;}}}" class="cmp-image overlaywatermark" data-cmp-aspectratio-max="16x9" data-cmp-aspectratio-xl="16x9" data-cmp-aspectratio-md="1x1" data-cmp-aspectratio-lg="1x1" data-cmp-aspectratio-sm="1x1">
		
		

			
				<picture>
					
						<source media="(min-width: 1584px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=216 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=288 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=360 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=432 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=540 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=576 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=648 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=720 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=864 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=891 1584w">
						<source media="(min-width: 1312px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=216 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=288 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=360 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=432 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=540 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=576 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=648 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=720 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=864 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=891 1584w">
						<source media="(min-width: 1056px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
						<source media="(min-width: 627px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
						<source media="(min-width: 320px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
					

					<img src="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-7:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180" loading="lazy" class="cmp-image__image " itemprop="contentUrl" width="1583" height="1139" alt="List of methods for the IHostMemoryManager interface">
				</picture>

				

			
		
		

		

	</div>
	
    




    

</div>
<div class="rich-text text"><div class="cms-richtext  " id="rich-text-9474d9b922" data-dynamic-inner-content="description">
    <p><em>Figure 7:&nbsp;List of methods for the IHostMemoryManager interface</em></p>
<p>You probably notice a few methods that enable some interesting behavior, namely the Virtual* methods (VirtualAlloc, VirtualProtect, VirtualQuery, VirtualFree) which are used to do the bulk of memory management on Windows. Below is a very barebones implementation of these methods.</p>

    
    
    
    

</div></div>
<div class="image-dm image">


	

	<div data-cmp-aspectratio="1x1|1x1|1x1|16x9|16x9" data-cmp-hook-image="imageV3IBM" data-cmp-is="image" data-cmp-widths="320,384,512,640,768,960,1024,1152,1280,1536,1584" data-cmp-dmimage="" data-cmp-src="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8?ts=1763567923718&amp;dpr=off" data-asset-id="0710c87c-3b5c-4587-81c8-b252668bb362" data-cmp-filereference="/content/dam/connectedassets-adobe-cms/worldwide-content/creative-assets/iwci/ul/g/07/10/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8.png" id="image-dm-7a5a741223" data-cmp-data-layer="{&quot;image-dm-7a5a741223&quot;:{&quot;@type&quot;:&quot;adobe-cms/components/content/atoms/image-dm&quot;,&quot;repo:modifyDate&quot;:&quot;2025-11-19T15:58:43Z&quot;,&quot;dc:title&quot;:&quot;Being a good CLR host  Modernizing offensive NET tradecraft&quot;,&quot;image&quot;:{&quot;repo:id&quot;:&quot;0710c87c-3b5c-4587-81c8-b252668bb362&quot;,&quot;repo:modifyDate&quot;:&quot;2025-02-21T19:38:35Z&quot;,&quot;@type&quot;:&quot;image/png&quot;,&quot;repo:path&quot;:&quot;/content/dam/connectedassets-adobe-cms/worldwide-content/creative-assets/iwci/ul/g/07/10/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8.png&quot;}}}" class="cmp-image overlaywatermark" data-cmp-aspectratio-max="16x9" data-cmp-aspectratio-xl="16x9" data-cmp-aspectratio-md="1x1" data-cmp-aspectratio-lg="1x1" data-cmp-aspectratio-sm="1x1">
		
		

			
				<picture>
					
						<source media="(min-width: 1584px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=216 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=288 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=360 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=432 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=540 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=576 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=648 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=720 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=864 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=891 1584w">
						<source media="(min-width: 1312px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=216 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=288 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=360 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=432 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=540 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=576 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=648 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=720 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=864 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=891 1584w">
						<source media="(min-width: 1056px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
						<source media="(min-width: 627px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
						<source media="(min-width: 320px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
					

					<img src="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-8:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180" loading="lazy" class="cmp-image__image " itemprop="contentUrl" width="663" height="210" alt="Implementing VirtualAlloc, VirtualFree, VirtualQuery and VirtualProtect">
				</picture>

				

			
		
		

		

	</div>
	
    




    

</div>
<div class="rich-text text"><div class="cms-richtext  " id="rich-text-617c5baea4" data-dynamic-inner-content="description">
    <p><em>Figure 8: Implementing VirtualAlloc, VirtualFree, VirtualQuery and VirtualProtect</em></p>
<p>Taking control over memory allocations enables the operator to get as fancy with it as they like. For example, you could perform the allocation API calls via&nbsp;<a href="https://passthehashbrowns.github.io/hiding-your-syscalls" target="_blank" rel="noopener noreferrer"><span class="ibm_icon_launch_external_after">indirect syscalls</span></a>. You could also track all allocations made by the CLR and encrypt them when your implant goes to sleep. Note that encrypting CLR allocations is not very stable. In addition to the Virtual* methods, there is also the&nbsp;<cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="CreateMAlloc" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      CreateMAlloc</cds-code-snippet>
&nbsp;method, which returns an implementation of the&nbsp;<cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="IHostMalloc" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      IHostMalloc</cds-code-snippet>
&nbsp;interface. This interface allows us to take control over all Heap allocations made by the CLR.</p>

    
    
    
    

</div></div>
<div class="standalone-title enhanced-title text">

    <h2 class="expressive-heading-05  ">
        Tracking and clearing assembly artifacts
    </h2>
        
  
    
    <a data-title="Tracking and clearing assembly artifacts" name="Tracking+and+clearing+assembly+artifacts"></a>
  









    

</div>
<div class="rich-text text"><div class="cms-richtext  " id="rich-text-cde4bf0467" data-dynamic-inner-content="description">
    <p>I mentioned above that trying to encrypt CLR memory allocations goes from kind of unstable to very unstable, depending on how exactly you do it. This is because if you encrypt or free a piece of memory that the CLR tries to reference later, the CLR will throw an error and crash your process. However, there is one exception to this that I have found: Allocations made during initial assembly loads.</p>
<p>When you load an assembly, whether that is in memory or from disk, the CLR will allocate space and map the assembly into memory. As far as I am aware, there was no good publicly known way to identify this memory region and wipe it, aside from searching process memory for byte patterns or allocations of the expected size. CLR customizations provide an easy mechanism to keep track of these allocations in the form of the <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="AcquiredVirtualAddressSpace" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      AcquiredVirtualAddressSpace</cds-code-snippet>
</code> method. This method is a notification callback that gets triggered whenever the CLR loads an assembly into the process, and the callback includes the address and size of the allocation as arguments. From my testing, this callback is only triggered when an assembly is loaded into the process, which provides us with a good way to keep track of assembly load allocations. For robustness, you can check the size or parse memory to ensure that its the assembly you are expecting. Below is an example of implementing this method. Since it is just a notification callback, you can do whatever you would like and then simply return S_OK..</p>

    
    
    
    

</div></div>
<div class="image-dm image">


	

	<div data-cmp-aspectratio="1x1|1x1|1x1|16x9|16x9" data-cmp-hook-image="imageV3IBM" data-cmp-is="image" data-cmp-widths="320,384,512,640,768,960,1024,1152,1280,1536,1584" data-cmp-dmimage="" data-cmp-src="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9?ts=1763567924077&amp;dpr=off" data-asset-id="a6e37706-a0d9-4102-92be-b3736b12f385" data-cmp-filereference="/content/dam/connectedassets-adobe-cms/worldwide-content/creative-assets/iwci/ul/g/a6/e3/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9.png" id="image-dm-079de2bd05" data-cmp-data-layer="{&quot;image-dm-079de2bd05&quot;:{&quot;@type&quot;:&quot;adobe-cms/components/content/atoms/image-dm&quot;,&quot;repo:modifyDate&quot;:&quot;2025-11-19T15:58:44Z&quot;,&quot;dc:title&quot;:&quot;Being a good CLR host  Modernizing offensive NET tradecraft&quot;,&quot;image&quot;:{&quot;repo:id&quot;:&quot;a6e37706-a0d9-4102-92be-b3736b12f385&quot;,&quot;repo:modifyDate&quot;:&quot;2025-02-21T19:38:35Z&quot;,&quot;@type&quot;:&quot;image/png&quot;,&quot;repo:path&quot;:&quot;/content/dam/connectedassets-adobe-cms/worldwide-content/creative-assets/iwci/ul/g/a6/e3/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9.png&quot;}}}" class="cmp-image overlaywatermark" data-cmp-aspectratio-max="16x9" data-cmp-aspectratio-xl="16x9" data-cmp-aspectratio-md="1x1" data-cmp-aspectratio-lg="1x1" data-cmp-aspectratio-sm="1x1">
		
		

			
				<picture>
					
						<source media="(min-width: 1584px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=216 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=288 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=360 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=432 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=540 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=576 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=648 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=720 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=864 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=891 1584w">
						<source media="(min-width: 1312px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=216 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=288 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=360 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=432 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=540 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=576 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=648 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=720 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=864 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=891 1584w">
						<source media="(min-width: 1056px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
						<source media="(min-width: 627px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
						<source media="(min-width: 320px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
					

					<img src="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-9:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180" loading="lazy" class="cmp-image__image " itemprop="contentUrl" width="1546" height="182" alt="Implementing the AcquiredVirtualAddressSpace method">
				</picture>

				

			
		
		

		

	</div>
	
    




    

</div>
<div class="rich-text text"><div class="cms-richtext  " id="rich-text-ab2da5f12d" data-dynamic-inner-content="description">
    <p><em>Figure 9: Implementing the AcquiredVirtualAddressSpace method</em></p>
<p>Unlike the other allocations made by the CLR, I have not had any problems with encrypting or wiping this memory region after the assembly has finished executing. You may run into problems if you try to execute the same assembly in the same App Domain again as the CLR might try to use the cached assembly which is now invalid. Most implementations of execute-assembly will create a new App Domain and then destroy it after execution, so just be sure to test with your implementation.</p>
<p>This notification functionality also has a minor defensive application. Typically, defensive products will use&nbsp;<a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/event-tracing-for-windows--etw-" target="_blank" rel="noopener noreferrer"><span class="ibm_icon_launch_external_after">Event Tracing for Windows (ETW)</span></a>&nbsp;to keep track of assembly loads in the CLR, but this provides another way to be notified if an assembly has been loaded into the process. Since the memory address and size are included, it would be trivial for a defensive product to perform a memory scan on that region.</p>

    
    
    
    

</div></div>
<div class="standalone-title enhanced-title text">

    <h2 class="expressive-heading-05  ">
        Managing assembly loads
    </h2>
        
  
    
    <a data-title="Managing assembly loads" name="Managing+assembly+loads"></a>
  









    

</div>
<div class="rich-text text"><div class="cms-richtext  " id="rich-text-0a21ca2c48" data-dynamic-inner-content="description">
    <p>The other managers that we will look at are <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="IHostAssemblyManager" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      IHostAssemblyManager</cds-code-snippet>
</code> and <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="IHostAssemblyStore" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      IHostAssemblyStore</cds-code-snippet>
</code>. <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="IHostAssemblyManager" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      IHostAssemblyManager</cds-code-snippet>
</code> is responsible for two things: giving the CLR a list of assemblies it should handle loading (instead of us, as the CLR host), and returning an <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="IHostAssemblyStore" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      IHostAssemblyStore</cds-code-snippet>
</code> interface to the CLR. <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="IHostAssemblyStore" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      IHostAssemblyStore</cds-code-snippet>
</code> has two methods: <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="ProvideAssembly" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      ProvideAssembly</cds-code-snippet>
</code> and <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="ProvideModule" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      ProvideModule</cds-code-snippet>
</code>.</p>
<p><code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="ProvideAssembly" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      ProvideAssembly</cds-code-snippet>
</code> will be called whenever the CLR is asked to load an assembly that is not in the list of assemblies that the CLR is responsible for loading (returned by <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="IHostAssemblyManager" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      IHostAssemblyManager</cds-code-snippet>
</code>). The CLR calls <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="ProvideAssembly" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      ProvideAssembly</cds-code-snippet>
</code> and passes in the identity string for an assembly, and <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="ProvideAssembly" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      ProvideAssembly</cds-code-snippet>
</code> is responsible for returning the bytes of the assembly. Youve likely seen an identity string before, it looks something like: <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="Seatbelt, Version=0.0.0.0, PublicKeyToken=null, Culture=neutral" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      Seatbelt, Version=0.0.0.0, PublicKeyToken=null, Culture=neutral</cds-code-snippet>
</code>.</p>
<p>Once <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="ProvideAssembly" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      ProvideAssembly</cds-code-snippet>
</code> has resolved the assembly, the assembly content is returned by setting a pointer which is provided as an argument. Ive highlighted the relevant argument, <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="ppStmAssemblyImage" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      ppStmAssemblyImage</cds-code-snippet>
</code>, in the screenshot below.</p>

    
    
    
    

</div></div>
<div class="image-dm image">


	

	<div data-cmp-aspectratio="1x1|1x1|1x1|16x9|16x9" data-cmp-hook-image="imageV3IBM" data-cmp-is="image" data-cmp-widths="320,384,512,640,768,960,1024,1152,1280,1536,1584" data-cmp-dmimage="" data-cmp-src="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10?ts=1763567924473&amp;dpr=off" data-asset-id="b422add2-0ab3-4f93-9e4f-142916f5241c" data-cmp-filereference="/content/dam/connectedassets-adobe-cms/worldwide-content/creative-assets/iwci/ul/g/b4/22/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10.png" id="image-dm-62d01fceec" data-cmp-data-layer="{&quot;image-dm-62d01fceec&quot;:{&quot;@type&quot;:&quot;adobe-cms/components/content/atoms/image-dm&quot;,&quot;repo:modifyDate&quot;:&quot;2025-11-19T15:58:44Z&quot;,&quot;dc:title&quot;:&quot;Being a good CLR host  Modernizing offensive NET tradecraft&quot;,&quot;image&quot;:{&quot;repo:id&quot;:&quot;b422add2-0ab3-4f93-9e4f-142916f5241c&quot;,&quot;repo:modifyDate&quot;:&quot;2025-02-21T19:25:08Z&quot;,&quot;@type&quot;:&quot;image/png&quot;,&quot;repo:path&quot;:&quot;/content/dam/connectedassets-adobe-cms/worldwide-content/creative-assets/iwci/ul/g/b4/22/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10.png&quot;}}}" class="cmp-image overlaywatermark" data-cmp-aspectratio-max="16x9" data-cmp-aspectratio-xl="16x9" data-cmp-aspectratio-md="1x1" data-cmp-aspectratio-lg="1x1" data-cmp-aspectratio-sm="1x1">
		
		

			
				<picture>
					
						<source media="(min-width: 1584px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=216 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=288 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=360 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=432 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=540 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=576 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=648 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=720 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=864 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=891 1584w">
						<source media="(min-width: 1312px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=216 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=288 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=360 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=432 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=540 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=576 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=648 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=720 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=864 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=891 1584w">
						<source media="(min-width: 1056px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
						<source media="(min-width: 627px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
						<source media="(min-width: 320px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
					

					<img src="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-10:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180" loading="lazy" class="cmp-image__image " itemprop="contentUrl" width="1446" height="881" alt="Arguments for the ProvideAssembly method of the IHostAssemblyStore interface">
				</picture>

				

			
		
		

		

	</div>
	
    




    

</div>
<div class="rich-text text"><div class="cms-richtext  " id="rich-text-56badc9c31" data-dynamic-inner-content="description">
    <p><em>Figure 10: Arguments for the ProvideAssembly method of the IHostAssemblyStore interface</em></p>
<p>The assembly is returned by setting the pointer to the address of an in-memory IStream. Typically the CLR would try to locate the assembly by following its directory search order on disk, similar to loading a DLL in a normal Windows process. But since we can provide our own implementation, we can take a request for an assembly that would typically be loaded from disk and instead provide an assembly that we have in memory. The assembly bytes do need to be in an IStream, which can be accomplished using the&nbsp;<a href="https://learn.microsoft.com/en-us/windows/win32/api/shlwapi/nf-shlwapi-shcreatememstream" target="_blank" rel="noopener noreferrer"><span class="ibm_icon_launch_external_after">SHCreateMemStream</span></a>&nbsp;function that takes in a byte array and returns an IStream.</p>
<p>You may be wondering why this matters if its simply another way to load assemblies in memory. What about the&nbsp;<a href="https://learn.microsoft.com/en-us/windows/win32/amsi/antimalware-scan-interface-portal" target="_blank" rel="noopener noreferrer"><span class="ibm_icon_launch_external_after">Anti-Malware Scan Interface (AMSI)</span></a>?</p>

    
    
    
    

</div></div>
<div class="standalone-title enhanced-title text">

    <h2 class="expressive-heading-05  ">
        Bypassing AMSI
    </h2>
        
  
    
    <a data-title="Bypassing AMSI" name="Bypassing+AMSI"></a>
  









    

</div>
<div class="rich-text text"><div class="cms-richtext  " id="rich-text-6f4458abcd" data-dynamic-inner-content="description">
    <p>AMSI is responsible for scanning any assemblies that are loaded reflectively for malicious content. Windows Defender uses AMSI, and AMSI also allows other EDRs to hook in and scan the contents of assemblies loaded in memory. Some tend to sneer at AMSI since it can be bypassed, but I feel that for something that is installed in Windows by default, AMSI is a fairly effective security feature. At a minimum, it will catch a lot of stock malicious .NET tooling (such as <a href="https://github.com/GhostPack/Seatbelt" target="_blank" rel="noopener noreferrer"><span class="ibm_icon_launch_external_after">Seatbelt</span></a>) being executed in memory. There is a<a href="https://github.com/rasta-mouse/AmsiScanBufferBypass" target="_blank" rel="noopener noreferrer"> <span class="ibm_icon_launch_external_after">rich cat-and-mouse history</span></a> of bypassing AMSI among red teamers, but a lot of AMSI bypasses rely on patching the bytes for key functions (such as AmsiScanBuffer) so that they either fail to execute or return a good value. Traditional AMSI bypasses are messy as they leave <a href="https://learn.microsoft.com/en-us/windows/win32/memory/memory-protection#copy-on-write-protection" target="_blank" rel="noopener noreferrer"><span class="ibm_icon_launch_external_after">Copy-on-Write</span></a> bytes in the .text section of AMSI.dlls memory, which are a dead giveaway for any defenders looking at a suspicious process. More sophisticated AMSI bypasses such as hardware breakpoint hooks also have other IOCs associated with them, like inspecting the thread context to look for debug register usage.</p>
<p>By implementing our own version of the <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="ProvideAssembly" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      ProvideAssembly</cds-code-snippet>
</code> method, we can circumvent AMSI entirely. Traditionally, the <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="Load_3" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      Load_3</cds-code-snippet>
</code> method is used to load assemblies from a byte array and <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="Load_3" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      Load_3</cds-code-snippet>
</code> is instrumented by AMSI. But did you know that there are other seldom-used Load_* functions?.</p>

    
    
    
    

</div></div>
<div class="image-dm image">


	

	<div data-cmp-aspectratio="1x1|1x1|1x1|16x9|16x9" data-cmp-hook-image="imageV3IBM" data-cmp-is="image" data-cmp-widths="320,384,512,640,768,960,1024,1152,1280,1536,1584" data-cmp-dmimage="" data-cmp-src="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11?ts=1763567924845&amp;dpr=off" data-asset-id="bc18a429-4b24-4d35-a2ca-772fd983989b" data-cmp-filereference="/content/dam/connectedassets-adobe-cms/worldwide-content/creative-assets/iwci/ul/g/bc/18/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11.png" id="image-dm-2b26673d4b" data-cmp-data-layer="{&quot;image-dm-2b26673d4b&quot;:{&quot;@type&quot;:&quot;adobe-cms/components/content/atoms/image-dm&quot;,&quot;repo:modifyDate&quot;:&quot;2025-11-19T15:58:44Z&quot;,&quot;dc:title&quot;:&quot;Being a good CLR host  Modernizing offensive NET tradecraft&quot;,&quot;image&quot;:{&quot;repo:id&quot;:&quot;bc18a429-4b24-4d35-a2ca-772fd983989b&quot;,&quot;repo:modifyDate&quot;:&quot;2025-02-21T19:24:25Z&quot;,&quot;@type&quot;:&quot;image/png&quot;,&quot;repo:path&quot;:&quot;/content/dam/connectedassets-adobe-cms/worldwide-content/creative-assets/iwci/ul/g/bc/18/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11.png&quot;}}}" class="cmp-image overlaywatermark" data-cmp-aspectratio-max="16x9" data-cmp-aspectratio-xl="16x9" data-cmp-aspectratio-md="1x1" data-cmp-aspectratio-lg="1x1" data-cmp-aspectratio-sm="1x1">
		
		

			
				<picture>
					
						<source media="(min-width: 1584px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=216 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=288 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=360 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=432 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=540 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=576 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=648 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=720 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=864 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=891 1584w">
						<source media="(min-width: 1312px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=216 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=288 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=360 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=432 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=540 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=576 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=648 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=720 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=864 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=891 1584w">
						<source media="(min-width: 1056px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
						<source media="(min-width: 627px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
						<source media="(min-width: 320px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
					

					<img src="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-11:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180" loading="lazy" class="cmp-image__image " itemprop="contentUrl" width="520" height="533" alt="The Load family of methods">
				</picture>

				

			
		
		

		

	</div>
	
    




    

</div>
<div class="rich-text text"><div class="cms-richtext  " id="rich-text-f0f2bae202" data-dynamic-inner-content="description">
    <p><em>Figure 11:&nbsp;The Load family of methods</em></p>
<p><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="Load_2" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      Load_2</cds-code-snippet>
&nbsp;takes an assembly identity string as an argument instead of a byte array like&nbsp;<cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="Load_3" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      Load_3</cds-code-snippet>
. Typically, this would mean that the assembly has to be on disk somewhere that the CLR can find, but we know that when the CLR is asked to load an assembly by identity it will ask our&nbsp;<cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="ProvideAssembly" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      ProvideAssembly</cds-code-snippet>
&nbsp;implementation to provide that assembly. We also know that we can return an in-memory byte array (in an IStream) from&nbsp;<cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="ProvideAssembly" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      ProvideAssembly</cds-code-snippet>
. This means that we can call&nbsp;<cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="Load_2" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      Load_2</cds-code-snippet>
&nbsp;and provide the CLR with an in-memory assembly that it will load.</p>
<p>Now the important part: because were calling&nbsp;<cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="Load_2" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      Load_2</cds-code-snippet>
, the CLR believes that were loading our assembly from disk and AMSI does not scan our assembly bytes. In fact, AMSI never even gets loaded into the process.</p>
<p>Below is an example of executing Seatbelt via a call to&nbsp;<cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="Load_2" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      Load_2</cds-code-snippet>
&nbsp;without AMSI being loaded into the process.</p>

    
    
    
    

</div></div>
<div class="image-dm image">


	

	<div data-cmp-aspectratio="1x1|1x1|1x1|16x9|16x9" data-cmp-hook-image="imageV3IBM" data-cmp-is="image" data-cmp-widths="320,384,512,640,768,960,1024,1152,1280,1536,1584" data-cmp-dmimage="" data-cmp-src="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12?ts=1763567925051&amp;dpr=off" data-asset-id="f14821a3-48b5-49e5-bfaa-6607c1a0eeb8" data-cmp-filereference="/content/dam/connectedassets-adobe-cms/worldwide-content/creative-assets/iwci/ul/g/f1/48/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12.png" id="image-dm-2a599275e7" data-cmp-data-layer="{&quot;image-dm-2a599275e7&quot;:{&quot;@type&quot;:&quot;adobe-cms/components/content/atoms/image-dm&quot;,&quot;repo:modifyDate&quot;:&quot;2025-11-19T15:58:45Z&quot;,&quot;dc:title&quot;:&quot;Being a good CLR host  Modernizing offensive NET tradecraft&quot;,&quot;image&quot;:{&quot;repo:id&quot;:&quot;f14821a3-48b5-49e5-bfaa-6607c1a0eeb8&quot;,&quot;repo:modifyDate&quot;:&quot;2025-02-21T19:23:43Z&quot;,&quot;@type&quot;:&quot;image/png&quot;,&quot;repo:path&quot;:&quot;/content/dam/connectedassets-adobe-cms/worldwide-content/creative-assets/iwci/ul/g/f1/48/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12.png&quot;}}}" class="cmp-image overlaywatermark" data-cmp-aspectratio-max="16x9" data-cmp-aspectratio-xl="16x9" data-cmp-aspectratio-md="1x1" data-cmp-aspectratio-lg="1x1" data-cmp-aspectratio-sm="1x1">
		
		

			
				<picture>
					
						<source media="(min-width: 1584px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=216 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=288 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=360 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=432 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=540 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=576 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=648 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=720 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=864 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=891 1584w">
						<source media="(min-width: 1312px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=216 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=288 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=360 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=432 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=540 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=576 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=648 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=720 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=864 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=891 1584w">
						<source media="(min-width: 1056px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
						<source media="(min-width: 627px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
						<source media="(min-width: 320px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
					

					<img src="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-12:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180" loading="lazy" class="cmp-image__image " itemprop="contentUrl" width="626" height="350" alt="Executing Seatbelt and bypassing AMSI">
				</picture>

				

			
		
		

		

	</div>
	
    




    

</div>
<div class="rich-text text"><div class="cms-richtext  " id="rich-text-ce5f62e626" data-dynamic-inner-content="description">
    <p><em>Figure 12:&nbsp;Executing Seatbelt and bypassing AMSI</em></p>

    
    
    
    

</div></div>
<div class="image-dm image">


	

	<div data-cmp-aspectratio="1x1|1x1|1x1|16x9|16x9" data-cmp-hook-image="imageV3IBM" data-cmp-is="image" data-cmp-widths="320,384,512,640,768,960,1024,1152,1280,1536,1584" data-cmp-dmimage="" data-cmp-src="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13?ts=1763567925226&amp;dpr=off" data-asset-id="787ee680-f4bc-4e8b-bebd-27d24f3aa84d" data-cmp-filereference="/content/dam/connectedassets-adobe-cms/worldwide-content/creative-assets/iwci/ul/g/78/7e/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13.png" id="image-dm-04507c6907" data-cmp-data-layer="{&quot;image-dm-04507c6907&quot;:{&quot;@type&quot;:&quot;adobe-cms/components/content/atoms/image-dm&quot;,&quot;repo:modifyDate&quot;:&quot;2025-11-19T15:58:45Z&quot;,&quot;dc:title&quot;:&quot;Being a good CLR host  Modernizing offensive NET tradecraft&quot;,&quot;image&quot;:{&quot;repo:id&quot;:&quot;787ee680-f4bc-4e8b-bebd-27d24f3aa84d&quot;,&quot;repo:modifyDate&quot;:&quot;2025-02-21T19:23:13Z&quot;,&quot;@type&quot;:&quot;image/png&quot;,&quot;repo:path&quot;:&quot;/content/dam/connectedassets-adobe-cms/worldwide-content/creative-assets/iwci/ul/g/78/7e/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13.png&quot;}}}" class="cmp-image overlaywatermark" data-cmp-aspectratio-max="16x9" data-cmp-aspectratio-xl="16x9" data-cmp-aspectratio-md="1x1" data-cmp-aspectratio-lg="1x1" data-cmp-aspectratio-sm="1x1">
		
		

			
				<picture>
					
						<source media="(min-width: 1584px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=216 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=288 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=360 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=432 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=540 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=576 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=648 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=720 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=864 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=891 1584w">
						<source media="(min-width: 1312px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=216 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=288 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=360 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=432 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=540 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=576 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=648 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=720 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=864 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=891 1584w">
						<source media="(min-width: 1056px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
						<source media="(min-width: 627px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
						<source media="(min-width: 320px)" srcset="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=320 320w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=384&amp;hei=384 384w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=512&amp;hei=512 512w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=640&amp;hei=640 640w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=768&amp;hei=768 768w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=960&amp;hei=960 960w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1024&amp;hei=1024 1024w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1152&amp;hei=1152 1152w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1280&amp;hei=1280 1280w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1536&amp;hei=1536 1536w,https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:1x1?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=1584&amp;hei=1584 1584w">
					

					<img src="https://assets.ibm.com/is/image/ibm/being-a-good-clr-host-modernizing-offensive-net-tradecraft-13:16x9?fmt=png-alpha&amp;dpr=on%2C1&amp;wid=320&amp;hei=180" loading="lazy" class="cmp-image__image " itemprop="contentUrl" width="631" height="202" alt="A process module listing with no AMSI.dll loaded">
				</picture>

				

			
		
		

		

	</div>
	
    




    

</div>
<div class="rich-text text"><div class="cms-richtext  " id="rich-text-296ddc3770" data-dynamic-inner-content="description">
    <p><em>Figure 13:&nbsp;A process module listing with no AMSI.dll loaded</em></p>
<p>According to a&nbsp;<a href="https://learn.microsoft.com/en-us/archive/msdn-magazine/2006/august/clr-inside-out-clr-hosting-apis" target="_blank" rel="noopener noreferrer"><span class="ibm_icon_launch_external_after">CLR Inside Out</span></a>&nbsp;article published in the August 2006 edition of the MSDN magazine, Microsoft themselves have used a similar technique to have SQL Server 2005 load .NET assemblies from the database rather than from disk. The ability to store and execute .NET assemblies from a SQL database is a personal favorite lateral movement technique and can be done easily using&nbsp;<a href="https://github.com/xforcered/sqlrecon" target="_blank" rel="noopener noreferrer"><span class="ibm_icon_launch_external_after">SQLRecon</span></a>, another X-Force Red tool written by&nbsp;<a href="https://x.com/sanjivkawa" target="_blank" rel="noopener noreferrer"><span class="ibm_icon_launch_external_after">Sanjiv Kawa</span></a>.</p>

    
    
    
    

</div></div>
<div class="standalone-title enhanced-title text">

    <h2 class="expressive-heading-05  ">
        Proof-of-concept and further operationalization
    </h2>
        
  
    
    <a data-title="Proof-of-concept and further operationalization" name="Proof-of-concept+and+further+operationalization"></a>
  









    

</div>
<div class="rich-text text"><div class="cms-richtext  " id="rich-text-a52bcf8f99" data-dynamic-inner-content="description">
    <p>I am releasing a proof-of-concept for this technique that you can find on GitHub <a href="https://github.com/xforcered/Being-A-Good-CLR-Host" target="_blank" rel="noopener noreferrer"><span class="ibm_icon_launch_external_after">here</span></a>. This proof-of-concept shows how to implement the <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="IHostControl" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      IHostControl</cds-code-snippet>
</code>, <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="IHostMemoryManager" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      IHostMemoryManager</cds-code-snippet>
</code>, <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="IHostMalloc" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      IHostMalloc</cds-code-snippet>
</code>, <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="IHostAssemblyStore" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      IHostAssemblyStore</cds-code-snippet>
</code>&nbsp;and <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="IHostAssemblyManager" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      IHostAssemblyManager</cds-code-snippet>
</code> COM interfaces. It calls <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="SetHostControl" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      SetHostControl</cds-code-snippet>
</code> and starts the CLR using the <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="ICLRRuntimeHost" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      ICLRRuntimeHost</cds-code-snippet>
</code> interface.</p>
<p>The memory manager implementation simply calls the correct Windows APIs (ex: VirtualAlloc) but does include an example of tracking all memory allocations made by the CLR. It also includes an example of wiping the assembly load artifacts provided by the <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="AcquiredVirtualAddressSpace" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      AcquiredVirtualAddressSpace</cds-code-snippet>
</code> callback discussed earlier.</p>
<p>There is also a full proof-of-concept for the AMSI bypass. There is a caveat with this bypass if you try to implement it into your own tooling: The assembly identity that you attempt to load using the <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="Load_2" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      Load_2</cds-code-snippet>
</code> method must match the identity of the assembly you ultimately return to the CLR. For example, if you call <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="Load_2" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      Load_2</cds-code-snippet>
</code> with an argument of Seatbelt, Version=0.0.0.0, PublicKeyToken=null, Culture=neutral, then the assembly that you are ultimately trying to run must also have this identity. You cannot attempt to load mscorlib but instead return Seatbelt, as the CLR will check this and throw an error. Be mindful of what assembly names you are attempting to load, but if you are still trying to reflectively load an assembly named Seatbelt in whatever year you are reading this then I would suggest you close this blog post and pursue a more fulfilling activity.</p>
<p>In the proof-of-concept, I use the <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="GetBindingIdentityFromStream" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      GetBindingIdentityFromStream</cds-code-snippet>
</code> method of the <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="ICLRAssemblyIdentityManager" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      ICLRAssemblyIdentityManager</cds-code-snippet>
</code> interface to get the identity string for the assembly that is going to be executed. You could also shift this away from the implant and get the assembly identity on the client or teamserver, and then pass the identity string as an argument to your implant.</p>

    
    
    
    

</div></div>
<div class="standalone-title enhanced-title text">

    <h2 class="expressive-heading-05  ">
        Defensive considerations
    </h2>
        
  
    
    <a data-title="Defensive considerations" name="Defensive+considerations"></a>
  









    

</div>
<div class="rich-text text"><div class="cms-richtext  " id="rich-text-fc061d5acd" data-dynamic-inner-content="description">
    <p>While this is a novel AMSI bypass, it is ultimately just that: an AMSI bypass. Defensive products should be utilizing defense-in-depth strategies and not simply relying on AMSI to detect malicious assemblies. Any assemblies loaded using this technique will also generate the same Event Tracing for Windows (ETW) events as any other in-memory assembly. Malicious assemblies can be detected via memory scanning, as we have seen several more advanced EDR platforms doing. Many post-exploitation tools also have their own <a href="https://github.com/GhostPack/Rubeus/commit/b303d1c9d8076bc4b5f97d8151fe3c39c42e50d6" target="_blank" rel="noopener noreferrer"><span class="ibm_icon_launch_external_after">unique IOCs</span></a>.</p>
<p>As mentioned above there, are also some defensive applications of this research. The <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="AcquiredVirtualAddressSpace" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      AcquiredVirtualAddressSpace</cds-code-snippet>
</code> callback provides another method of being notified when assemblies are loaded into the process. If a defender were to implement the <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="IHostAssemblyStore" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      IHostAssemblyStore</cds-code-snippet>
</code> interface then they would be inserted into the assembly loading chain and have the ability to block assembly loads entirely or modify the bytes of an assembly before it is loaded into the process. Ill call my shot here and say that I think its highly likely there will be future developments in this area.</p>

    
    
    
    

</div></div>
<div class="standalone-title enhanced-title text">

    <h2 class="expressive-heading-05  ">
        Why release this now?
    </h2>
        
  
    
    <a data-title="Why release this now?" name="Why+release+this+now%3F"></a>
  









    

</div>
<div class="rich-text text"><div class="cms-richtext  " id="rich-text-1db863418d" data-dynamic-inner-content="description">
    <p>Id like to touch on our timeline with this research, and why we are publishing it now. I performed all of this research in June of 2023 and we have kept it internal since then, although it has been submitted to several conference CFPs. At the time that this research was performed, I scoured search engines for anything similar, initially looking for reference material and later seeking to confirm if I was the first to identify this behavior. Since then, Ive performed periodic searches to see if anyone had published any similar work. At the beginning of January 2025, I found this piece: <a href="https://www.nttdata.com/global/en/-/media/nttdataglobal/1_files/services/cybersecurity/radar_magazine/2024/radar_supplement_july.pdf?" target="_blank" rel="noopener noreferrer"><span class="ibm_icon_launch_external_after">Using CLR Hosting to Evade AMSI</span></a>, by Marcos Gonzlez Hermida in the NTT Data magazine.</p>
<p>This piece disclosed this same bypass, and according to the magazine it was initially published in June of 2024 (the supplementary linked above is from July 2024). Its an excellently written piece and I would recommend that you read it. The only notes I would make is that the author concludes that assemblies must be signed to be executed, and in their proof-of-concept, they use the <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="GetType_2" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      GetType_2</cds-code-snippet>
</code> method to manually obtain the Main method of the assembly they load (<a href="https://github.com/GhostPack/Rubeus" target="_blank" rel="noopener noreferrer"><span class="ibm_icon_launch_external_after">Rubeus</span></a>, specifically). I have had no problem loading unsigned assemblies using this technique, and you can use the same <code><cds-code-snippet class="notranslate" type="inline"><!---->
        <cds-copy button-class-name="cds--snippet cds--snippet--inline" kind="primary" size="md" tooltip-alignment="" tooltip-position="top" type="button" align="bottom"><!---->
      <cds-tooltip align="bottom" close-on-activation="false" enter-delay-ms="100" leave-delay-ms="300" highcontrast="" caret="" dropshadow="" size="false" timeoutid="0"><!---->
    <span class="cds--popover-container cds--popover--caret cds--popover--drop-shadow cds--popover--high-contrast cds--popover--bottom cds--tooltip cds--icon-tooltip">
      <slot></slot>
      <slot name="content"><slot>
    </slot></slot></span>
    
        <!--?lit$222482365$-->
          <button id="button" part="button" class="cds--btn cds--btn--primary cds--btn--md cds--layout--size-md cds--snippet cds--snippet--inline cds--btn--icon-only cds-ce--btn--has-icon" type="button" aria-label="Entrypoint" style="max-inline-size: unset;">
            <!--?lit$222482365$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
         <!--?lit$222482365$-->
      <cds-tooltip-content aria-hidden="true" role="tooltip" align="bottom" dropshadow="" slot="content" caret=""><!---->
        <span class="cds--popover-content cds--tooltip-content">
          <slot> </slot>
        </span>
        <span class="cds--popover-caret"></span>
      
        <!--?lit$222482365$--><slot name="tooltip-content"></slot>
      </cds-tooltip-content>
    
      </cds-tooltip>
    
          <code slot="icon"><slot></slot></code>
          <span slot="tooltip-content"><!--?lit$222482365$-->Copy to clipboard</span>
        </cds-copy>
      Entrypoint</cds-code-snippet>
</code> method to obtain the entry point of the loaded assembly that is used in many implementations of execute-assembly, without having to know the namespace/class names.</p>
<p>With the publication of Marcos piece and proof-of-concept, this AMSI bypass could now be considered public, so we decided it was time to publish our research along with a proof-of-concept of what we discovered.</p>

    
    
    
    

</div></div>
<div class="standalone-title enhanced-title text">

    <h2 class="expressive-heading-05  ">
        Wrapping up
    </h2>
        
  
    
    <a data-title="Wrapping up" name="Wrapping+up"></a>
  









    

</div>
<div class="rich-text text"><div class="cms-richtext  " id="rich-text-a8a3e347f6" data-dynamic-inner-content="description">
    <p>In this post, we looked at how you can use CLR customizations to improve your OPSEC while running .NET tooling in memory. Additionally, we demonstrated a full AMSI bypass utilizing these lesser-known CLR features. The use of .NET tooling will remain effective for offensive practitioners and <a href="https://www.ibm.com/think/topics/threat-actor" target="_blank" rel="noopener noreferrer">threat actors</a>. For this reason, it is critical that defenders understand how the CLR works and build defense-in-depth strategies to detect post-exploitation tooling.</p>
    
    
    
    

</div></div>
<div class="standalone-title enhanced-title text">

    <h2 class="expressive-heading-05  ">
        Acknowledgments
    </h2>
        
  
    
    <a data-title="Acknowledgments" name="Acknowledgments"></a>
  









    

</div>
<div class="rich-text text"><div class="cms-richtext  " id="rich-text-26053080ed" data-dynamic-inner-content="description">
    <p>Thank you Brett and Valentina for peer-reviewing this research!</p><ul><li>Brett Hawkins (@h4wkst3r)</li><li>Valentina Palmiotti (@chompie1337)</li></ul>
    
    
    
    

</div></div>
<div class="standalone-title enhanced-title text">

    <h2 class="expressive-heading-05  ">
        Related works
    </h2>
        
  
    
    <a data-title="Related works" name="Related+works"></a>
  









    

</div>
<div class="rich-text text"><div class="cms-richtext  " id="rich-text-0de3582694" data-dynamic-inner-content="description">
    <p><a href="https://posts.specterops.io/dealing-with-failure-failure-escalation-policy-in-clr-hosts-54ca8b728faa" target="_blank" rel="noopener noreferrer"><span class="ibm_icon_launch_external_after">Dealing with Failure: Failure Escalation Policy in CLR Hosts</span></a>  This is the only real example I could find of offensive tradecraft using CLR customizations when I was initially doing this research.</p>
<p><a href="https://github.com/ldematte/HostedPumpkin" target="_blank" rel="noopener noreferrer"><span class="ibm_icon_launch_external_after">Hosted Pumpkin</span></a>  A GitHub repository containing a proof-of-concept for implementing several CLR customizations.</p>
<p>Shellcode: Loading .NET Assemblies From Memory  Donut was a great deal of help in wrangling all of the relevant data structures and definitions in C.</p>
<p>Customizing the Microsoft .NET Framework Common Language Runtime by Steven Pratschner  This is the definitive text on CLR Customizations. Simply a must-read if you have any interest in this area.</p>

    
    
    
    

</div></div>
<div class="share-module">
	<div class="cds-btn--share-module">
	    
	    <div class="cds-btn--share-module__container">
	        <div class="cds-btn--share-module__copy-button">
	            <cds-button href="https://www.ibm.com/think/x-force/being-a-good-clr-host-modernizing-offensive-net-tradecraft" kind="secondary" size="lg" tooltip-alignment="" tooltip-position="top" type="button"><!---->
            <a id="button" part="button" role="button" class="cds--btn cds--btn--secondary cds--btn--lg cds--layout--size-lg cds--btn--icon-only cds-ce--btn--has-icon" href="https://www.ibm.com/think/x-force/being-a-good-clr-host-modernizing-offensive-net-tradecraft" type="button">
              <slot></slot>
              <slot name="icon"></slot>
            </a>
          
	                
    <svg xmlns="http://www.w3.org/2000/svg" slot="icon" width="16" height="16" fill="currentColor" viewBox="0 0 32 32" aria-hidden="true">
        <path d="M29.25,6.76a6,6,0,0,0-8.5,0l1.42,1.42a4,4,0,1,1,5.67,5.67l-8,8a4,4,0,1,1-5.67-5.66l1.41-1.42-1.41-1.42-1.42,1.42a6,6,0,0,0,0,8.5A6,6,0,0,0,17,25a6,6,0,0,0,4.27-1.76l8-8A6,6,0,0,0,29.25,6.76Z"></path>
        <path d="M4.19,24.82a4,4,0,0,1,0-5.67l8-8a4,4,0,0,1,5.67,0A3.94,3.94,0,0,1,19,14a4,4,0,0,1-1.17,2.85L15.71,19l1.42,1.42,2.12-2.12a6,6,0,0,0-8.51-8.51l-8,8a6,6,0,0,0,0,8.51A6,6,0,0,0,7,28a6.07,6.07,0,0,0,4.28-1.76L9.86,24.82A4,4,0,0,1,4.19,24.82Z"></path>
    </svg>

	            </cds-button>
	            <div class="cds-btn--share-module__tooltip hide">
	                Link copied
	            </div>
	        </div>
	
	        <cds-button target="_blank" href="mailto:?subject=Being%20a%20good%20CLR%20host:%20modernizing%20offensive%20net%20tradecraft&amp;body=https://www.ibm.com/think/x-force/being-a-good-clr-host-modernizing-offensive-net-tradecraft" kind="secondary" size="lg" tooltip-alignment="" tooltip-position="top" type="button"><!---->
            <a id="button" part="button" role="button" class="cds--btn cds--btn--secondary cds--btn--lg cds--layout--size-lg cds--btn--icon-only cds-ce--btn--has-icon" href="mailto:?subject=Being%20a%20good%20CLR%20host:%20modernizing%20offensive%20net%20tradecraft&amp;body=https://www.ibm.com/think/x-force/being-a-good-clr-host-modernizing-offensive-net-tradecraft" target="_blank" type="button" data-cmp-is="table-of-contents">
              <slot></slot>
              <slot name="icon"></slot>
            </a>
          
	            
    <svg xmlns="http://www.w3.org/2000/svg" slot="icon" width="16" height="16" fill="currentColor" viewBox="0 0 32 32" aria-hidden="true">
        <path d="M28,6H4A2,2,0,0,0,2,8V24a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V8A2,2,0,0,0,28,6ZM25.8,8,16,14.78,6.2,8ZM4,24V8.91l11.43,7.91a1,1,0,0,0,1.14,0L28,8.91V24Z"></path>
    </svg>

	        </cds-button>
	
	        <a href="https://www.linkedin.com/shareArticle?url=https://www.ibm.com/think/x-force/being-a-good-clr-host-modernizing-offensive-net-tradecraft&amp;title=Being%20a%20good%20CLR%20host:%20modernizing%20offensive%20net%20tradecraft" target="_blank">
	            <cds-button kind="secondary" size="lg" tooltip-alignment="" tooltip-position="top" type="button"><!---->
          <button id="button" part="button" class="cds--btn cds--btn--secondary cds--btn--lg cds--layout--size-lg cds--btn--icon-only cds-ce--btn--has-icon" type="button">
            <!--?lit$162927062$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
        
	                
    <svg xmlns="http://www.w3.org/2000/svg" slot="icon" width="16" height="16" fill="currentColor" viewBox="0 0 32 32" aria-hidden="true">
        <path d="M26.2,4H5.8C4.8,4,4,4.8,4,5.7v20.5c0,0.9,0.8,1.7,1.8,1.7h20.4c1,0,1.8-0.8,1.8-1.7V5.7C28,4.8,27.2,4,26.2,4z M11.1,24.4 H7.6V13h3.5V24.4z M9.4,11.4c-1.1,0-2.1-0.9-2.1-2.1c0-1.2,0.9-2.1,2.1-2.1c1.1,0,2.1,0.9,2.1,2.1S10.5,11.4,9.4,11.4z M24.5,24.3 H21v-5.6c0-1.3,0-3.1-1.9-3.1c-1.9,0-2.1,1.5-2.1,2.9v5.7h-3.5V13h3.3v1.5h0.1c0.5-0.9,1.7-1.9,3.4-1.9c3.6,0,4.3,2.4,4.3,5.5V24.3z"></path>
    </svg>

	            </cds-button>
	        </a>
	
	        <a href="https://www.facebook.com/share.php?u=https://www.ibm.com/think/x-force/being-a-good-clr-host-modernizing-offensive-net-tradecraft" target="_blank">
	            <cds-button kind="secondary" size="lg" tooltip-alignment="" tooltip-position="top" type="button"><!---->
          <button id="button" part="button" class="cds--btn cds--btn--secondary cds--btn--lg cds--layout--size-lg cds--btn--icon-only cds-ce--btn--has-icon" type="button">
            <!--?lit$162927062$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
        
	                
    <svg xmlns="http://www.w3.org/2000/svg" slot="icon" width="16" height="16" fill="currentColor" viewBox="0 0 32 32" aria-hidden="true">
        <path d="M26.67,4H5.33A1.34,1.34,0,0,0,4,5.33V26.67A1.34,1.34,0,0,0,5.33,28H16.82V18.72H13.7V15.09h3.12V12.42c0-3.1,1.89-4.79,4.67-4.79.93,0,1.86,0,2.79.14V11H22.37c-1.51,0-1.8.72-1.8,1.77v2.31h3.6l-.47,3.63H20.57V28h6.1A1.34,1.34,0,0,0,28,26.67V5.33A1.34,1.34,0,0,0,26.67,4Z" transform="translate(0 0)"></path>
    </svg>

	            </cds-button>
	        </a>
	
	        <a href="https://x.com/intent/tweet?text=Being%20a%20good%20CLR%20host:%20modernizing%20offensive%20net%20tradecraft&amp;url=https://www.ibm.com/think/x-force/being-a-good-clr-host-modernizing-offensive-net-tradecraft" target="_blank">
	            <cds-button kind="secondary" size="lg" tooltip-alignment="" tooltip-position="top" type="button"><!---->
          <button id="button" part="button" class="cds--btn cds--btn--secondary cds--btn--lg cds--layout--size-lg cds--btn--icon-only cds-ce--btn--has-icon" type="button">
            <!--?lit$162927062$-->
            <slot></slot>
            <slot name="icon"></slot>
          </button>
        
	                
    <svg xmlns="http://www.w3.org/2000/svg" slot="icon" width="16" height="16" fill="currentColor" viewBox="0 0 32 32" aria-hidden="true">
        <path d="m18.2342,14.1624l8.7424-10.1624h-2.0717l-7.591,8.8238-6.0629-8.8238h-6.9929l9.1684,13.3432-9.1684,10.6568h2.0718l8.0163-9.3183,6.4029,9.3183h6.9929l-9.5083-13.8376h.0005Zm-2.8376,3.2984l-.9289-1.3287L7.0763,5.5596h3.1822l5.9649,8.5323.9289,1.3287,7.7536,11.0907h-3.1822l-6.3272-9.05v-.0005Z"></path>
    </svg>

	            </cds-button>
	        </a>
	
	    </div>
	</div>
	
	    
    


	


</div>

        
    </div>

</div>
<div class="body-article-4 container responsivegrid cds--col">


    
    
    
    <div id="container-e4665dada2" class="cmp-container">
        
        <div class="article-content-slot">
 



</div>
<div class="experiencefragment">


    
</div>

        
    </div>

</div>

        
    </c4d-table-of-contents></div>



    
    

</div>
<div class="body-article-16 container responsivegrid cds--col"><div class="cds--grid">
    <div class="cds--row">
        <div class="cds--col-lg-16 cds--no-gutter">
            <div class="cds--content-section">
                

    
    
    
    <div id="container-6d7453a90d" class="cmp-container">
        
        <div class="article-content-slot">
 



</div>
<div class="experiencefragment">


    
</div>
<div class="experiencefragment">


    
</div>
<div class="experiencefragment">


    
</div>

        
    </div>


            </div>
        </div>
    </div>
</div></div>


        
    </div>



     
    
</c4d-video-cta-container>
<div class="video-modal-overlay" aria-hidden="true">
    <div class="video-modal-overlay__dialog">
        <div class="video-modal-overlay__dialog--body">
            <div class="video-modal-overlay__dialog--body__close-btn">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect width="24" height="24" fill="white" fill-opacity="0.01" style="mix-blend-mode:multiply"></rect>
                    <path id="Vector" d="M13.0606 12L19.5 5.56058L18.4394 4.5L12 10.9394L5.56072 4.5L4.5 5.56058L10.9394 12L4.5 18.4394L5.56072 19.5L12 13.0606L18.4394 19.5L19.5 18.4394L13.0606 12Z" fill="#161616"></path>
                </svg>
            </div>
            <div class="video-modal-overlay__dialog--body-content">

                <div class="video-modal-overlay__loading-container">
                    <cds-loading><!---->
    <svg viewBox="0 0 100 100" class="cds--loading__svg">
      <!--?lit$415294847$--> <title><!---->Loading<!----></title> 
      
      <circle cx="50%" cy="50%" class="cds--loading__stroke" r="44"></circle>
    </svg>
  </cds-loading>
                </div>

                <div class="video-wms hide">
                    <div class="video-modal-content" data-original-src="https://video.ibm.com/embed/$[wmsChanneId]?volume=0&amp;autoplay=true&amp;controls=true" src="cid:frame-D4D4C4C46C1B620D6641D4CF698CA659@mhtml.blink" webkitallowfullscreen="" allowfullscreen="" frameborder="no" referrerpolicy="no-referrer-when-downgrade" data-original-tag="iframe"></div>

                </div>

                <div class="video-media-center hide">
                    <c4d-video-player-container video-id="" aspect-ratio="16x9" auto-play="" muted="" playing-mode="inline" button-position="bottom-right"><!----> <slot></slot> <!---->
      <c4d-video-player part="video-player" thumbnail-url="https://cdnsecakmi.kaltura.com/p/1773841/thumbnail/entry_id//width/3" aspect-ratio="16x9" playing-mode="inline" content-state="thumbnail" button-position="bottom-right" data-autoid="c4d--video-player" tabindex="0" auto-play=""><!---->
      <div part="video-container" class=" c4d--video-player__video-container c4d--video-player__aspect-ratio--16x9 ">
        <!--?lit$162927062$-->
        <!--?lit$162927062$--> <slot></slot> 
      </div>
      <!--?lit$162927062$-->
            <div part="caption" class="c4d--video-player__video-caption" dir="ltr">
              <!--?lit$162927062$-->
            </div>
          
    
      </c4d-video-player>
    </c4d-video-player-container>
                </div>
            </div>
        </div>
    </div>
</div>


    
    






<c4d-lightbox-video-player-container playing-mode="inline"><!----> <slot></slot> <!----><!--?--></c4d-lightbox-video-player-container>

    
    



    
    
    




    


    
    












    
    



    
    
    


    


    
    



    

    

    



    
    





    




<!-- Added for Adobe analytics implementation ADCMS-5834
<script type="text/javascript">

    adobeDataLayer.push({
        "event": "linkClick",
        "web": {
            "webPageDetails": {
                "URL": document.URL,
                "name": "home"
            },
            "webInteraction": {
                "linkClick":"event",
                "value":"1",
                "type": "other",
                "URL": document.URL,
                "name": "linkClick: " +  document.URL
            }
        },
    })
</script>  !-->

<!-- Added for Adobe analytics implementation ADCMS-5834 & ADCMS-6152 !-->


<link rel="stylesheet" type="text/css" href="https://www.ibm.com/TetFaHRFGkh63Rn9GedZpOwJfcc/Sz/aXAdCSofPw/V3M/lbWheIwdZ"><div id="sec-overlay" style="display:none;"><div id="sec-container"></div></div>
<div style="display: contents;"><!----></div><div style="display: contents;"><!----></div><div style="display: contents;"><!---->
      <c4d-expressive-modal expressive-size="full-width" mode="lightbox" data-autoid="c4d--expressive-modal" close-button=""><!---->
      <button id="start-sentinel" part="sentinel-button sentinel-button--start" class="cds--visually-hidden">
        START
      </button>
      <div part="modal-container" tabindex="-1" role="dialog" class=" cds--modal-container cds--modal-container--fullwidth " aria-labelledby="c4d--modal-header">
        <div part="modal-content" class="cds--modal-content" style="--modal-vh: 99904px; --modal-vw: 1472px;">
          <!--?lit$162927062$-->
      <div part="modal-header" id="cds--modal-header" class="  ">
        <slot name="header"></slot>
      </div>
    <!--?lit$162927062$-->
      <div part="modal-body" class=" c4d-ce--modal__body "><slot></slot></div>
    <!--?lit$162927062$-->
      <div part="footer-container"><slot name="footer"></slot></div>
    
        </div>
      </div>
      <button id="end-sentinel" part="sentinel-button sentinel-button--end" class="cds--visually-hidden">
        END
      </button>
    
        <c4d-expressive-modal-close-button data-autoid="c4d--expressive-modal-close-button" size="full-width"><!---->
      <button part="button" aria-label="Close" class="cds--modal-close" title="Close">
        <!--?lit$162927062$--><svg focusable="false" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" fill="currentColor" aria-hidden="true" width="20" height="20" viewBox="0 0 32 32" part="close-icon" class="cds--modal-close__icon"><!--?lit$162927062$--><!--?lit$162927062$--><path d="M17.4141 16L24 9.4141 22.5859 8 16 14.5859 9.4143 8 8 9.4141 14.5859 16 8 22.5859 9.4143 24 16 17.4141 22.5859 24 24 22.5859 17.4141 16z"></path></svg>
      </button>
    </c4d-expressive-modal-close-button>
        <c4d-lightbox-video-player role="dialog" aria-label=""><!---->
      <div class="c4d--lightbox-media-viewer__container">
        <div class="c4d--lightbox-media-viewer__row">
          <div class="c4d--lightbox-media-viewer__media">
            <!--?lit$804003979$-->
      <div class="c4d--video-player">
        <div class="c4d--video-player__video-container">
          <slot></slot>
        </div>
      </div>
    
          </div>
          <div class="c4d--lightbox-media-viewer__media-description">
            <div class="c4d--lightbox-media-viewer__content">
              <div part="title" class="c4d--lightbox-media-viewer__content__title" data-autoid="c4d--lightbox-media-viewer__content__title">
                <!--?lit$804003979$-->
      <slot name="title">
        <h2 style="all: inherit;">
          <!--?lit$804003979$-->
        </h2>
      </slot>
    
              </div>
              <div part="description" class="c4d--lightbox-media-viewer__content__desc" data-autoid="c4d--lightbox-media-viewer__content__desc">
                <!--?lit$804003979$-->
      <slot name="description"><!--?lit$804003979$--></slot>
    
              </div>
            </div>
          </div>
        </div>
      </div>
    
        </c4d-lightbox-video-player>
      </c4d-expressive-modal>
    </div><div style="display: contents;"><!---->
      <c4d-lightbox-video-player-composite video-cta-lightbox="true" playing-mode="inline"><!----> <slot></slot> 
      <!----><!--?--></c4d-lightbox-video-player-composite>
    </div><div style="display: contents;"><!---->
      <c4d-expressive-modal expressive-size="full-width" mode="lightbox" data-autoid="c4d--expressive-modal" close-button=""><!---->
      <button id="start-sentinel" part="sentinel-button sentinel-button--start" class="cds--visually-hidden">
        START
      </button>
      <div part="modal-container" tabindex="-1" role="dialog" class=" cds--modal-container cds--modal-container--fullwidth " aria-labelledby="c4d--modal-header">
        <div part="modal-content" class="cds--modal-content" style="--modal-vh: 99904px; --modal-vw: 1472px;">
          <!--?lit$162927062$-->
      <div part="modal-header" id="cds--modal-header" class="  ">
        <slot name="header"></slot>
      </div>
    <!--?lit$162927062$-->
      <div part="modal-body" class=" c4d-ce--modal__body "><slot></slot></div>
    <!--?lit$162927062$-->
      <div part="footer-container"><slot name="footer"></slot></div>
    
        </div>
      </div>
      <button id="end-sentinel" part="sentinel-button sentinel-button--end" class="cds--visually-hidden">
        END
      </button>
    
        <c4d-expressive-modal-close-button data-autoid="c4d--expressive-modal-close-button" size="full-width"><!---->
      <button part="button" aria-label="Close" class="cds--modal-close" title="Close">
        <!--?lit$162927062$--><svg focusable="false" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" fill="currentColor" aria-hidden="true" width="20" height="20" viewBox="0 0 32 32" part="close-icon" class="cds--modal-close__icon"><!--?lit$162927062$--><!--?lit$162927062$--><path d="M17.4141 16L24 9.4141 22.5859 8 16 14.5859 9.4143 8 8 9.4141 14.5859 16 8 22.5859 9.4143 24 16 17.4141 22.5859 24 24 22.5859 17.4141 16z"></path></svg>
      </button>
    </c4d-expressive-modal-close-button>
        <c4d-lightbox-video-player role="dialog" aria-label=""><!---->
      <div class="c4d--lightbox-media-viewer__container">
        <div class="c4d--lightbox-media-viewer__row">
          <div class="c4d--lightbox-media-viewer__media">
            <!--?lit$804003979$-->
      <div class="c4d--video-player">
        <div class="c4d--video-player__video-container">
          <slot></slot>
        </div>
      </div>
    
          </div>
          <div class="c4d--lightbox-media-viewer__media-description">
            <div class="c4d--lightbox-media-viewer__content">
              <div part="title" class="c4d--lightbox-media-viewer__content__title" data-autoid="c4d--lightbox-media-viewer__content__title">
                <!--?lit$804003979$-->
      <slot name="title">
        <h2 style="all: inherit;">
          <!--?lit$804003979$-->
        </h2>
      </slot>
    
              </div>
              <div part="description" class="c4d--lightbox-media-viewer__content__desc" data-autoid="c4d--lightbox-media-viewer__content__desc">
                <!--?lit$804003979$-->
      <slot name="description"><!--?lit$804003979$--></slot>
    
              </div>
            </div>
          </div>
        </div>
      </div>
    
        </c4d-lightbox-video-player>
      </c4d-expressive-modal>
    </div><div id="consent_blackbar" role="banner" aria-label="consent_blackbar" lang="en">
            
            <div id="truste_domain_list">      <div id="trustarc-banner-overlay"></div>      <div class="trustarc-domain-list-container">        <a href="https://www.ibm.com/think/x-force/being-a-good-clr-host-modernizing-offensive-net-tradecraft#" class="close"><img src="https://consent.trustarc.com/get?name=ibm_close_icon.svg" alt="close icon" id="truste-domain-close"></a>        <p class="bpopmodal-head">IBM web domains</p>      ibm.com, ibm.org, ibm-zcouncil.com, insights-on-business.com, jazz.net, mobilebusinessinsights.com, promontory.com, proveit.com, ptech.org, s81c.com, securityintelligence.com, skillsbuild.org, softlayer.com, storagecommunity.org, think-exchange.com, thoughtsoncloud.com, alphaevents.webcasts.com, ibm-cloud.github.io, ibmbigdatahub.com, bluemix.net, mybluemix.net, ibm.net, ibmcloud.com, galasa.dev, blueworkslive.com, swiss-quantum.ch, blueworkslive.com, cloudant.com, ibm.ie, ibm.fr, ibm.com.br, ibm.co, ibm.ca, community.watsonanalytics.com, datapower.com, skills.yourlearning.ibm.com, bluewolf.com, carbondesignsystem.com, openliberty.io      </div>    </div>    <div id="truste-consent-track" class="ta-show ta-display-block">      <div class="truste-consent-track-class">        <div class="truste-icon-box">          <img src="https://consent.trustarc.com/get?name=ibm_close_icon.svg" alt="close icon" id="truste-consent-close" role="button">        </div>        <div id="truste-consent-content" class="truste-banner">          <div class="flex-container-ccm">            <div class="col">              <div class="text-content">                <div id="truste-consent-text" class="truste-messageColumn">                  <span class="truste-banner-headline">About cookies on this site</span>                  <span class="truste-banner-description"><span>Our websites require some cookies to function properly (required). In addition, other cookies may be used with your consent to analyze site usage, improve the user experience and for advertising.</span>                    <span><span class="ta-space">For more information, please review your</span><button id="truste-show-consent" aria-haspopup="dialog">                        cookie&nbsp;preferences</button><span class="ta-space">&nbsp;options. By visiting our website, you agree to our processing of information as described in IBMs</span><a href="https://www.ibm.com/privacy" target="_blank" id="truste-privacy-button" class="truste-cookie-link">privacy&nbsp;statement</a>.&nbsp;</span>                    <span class="truste-description-p2">To provide a smooth navigation, your cookie preferences will be shared across the IBM web domains listed&nbsp;<a href="https://www.ibm.com/think/x-force/being-a-good-clr-host-modernizing-offensive-net-tradecraft#truste_domain_list" id="truste-cookie-link">here</a>.</span>                  </span>                  <!-- <span class="scroll-fade"></span> -->                </div>              </div>              <div class="scroll-fade"></div>            </div>            <div id="truste-consent-buttons" class="truste-buttonsColumn">              <button id="truste-consent-button" type="button">Accept all</button>               <button id="truste-consent-show-button" type="button">More options</button>            </div>          </div>          <div class="clearBoth"></div>        </div>      </div>    </div></div><div class="ta-display-none" name="trustarc_notice" id="trustarcNoticeFrame" title="Trustarc Cross-Domain Consent Frame" src="https://consent.trustarc.com/get?name=crossdomain.html&amp;domain=ibm.com" data-original-tag="iframe"></div></body></html>