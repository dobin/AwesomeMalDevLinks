Title:
Bypassing detections with command-line obfuscation

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post explains how EDR/AV detections that rely on process command-line strings can be bypassed by making “synonymous” argument changes that preserve program behavior.  
- It distinguishes command-line obfuscation (target executable argument parsing quirks) from shell-level obfuscation (e.g., DOSfuscation/PowerShell obfuscation) and notes that EDR telemetry often records the obfuscated form as-is.  
- The author surveys many obfuscation primitives across Windows and *nix (e.g., option character substitution, Unicode homoglyphs/insertion, quote insertion, value transformations, path/URL manipulation) and shows how these break common Sigma/Splunk/Elastic detections.  
- Methodology: automated fuzzing of argument variants using a Python module to find equivalent invocations, then encoding results into machine-readable “model files” that define token types and allowed modifiers.  
- Key output is ArgFuscator.net plus an offline PowerShell module (Invoke-ArgFuscator) to generate randomized obfuscated command lines for 68 Windows 11 LOLBINs, validated on Windows 11 23H2.  
- Defensive guidance includes normalization/parsing before matching, anomaly-based heuristics (Unicode range, quote density, random casing), and shifting detections from command-line substrings to harder-to-spoof telemetry (e.g., network connections).

Technical Focus:
- Command-line parsing ambiguities and argument tokenization
- Command-line obfuscation primitives (Unicode insertion/substitution, quoting, option separators, value transforms)
- LOLBIN/“malwareless” tradecraft and process-creation telemetry
- Automated equivalence testing (exit code/stdout) and model-driven obfuscation generation
- Detection engineering: normalization, anomaly detection, and behavior-based alternatives

Use Cases:
- Generate obfuscated LOLBIN command lines to test EDR resilience and detection gaps
- Build/validate more robust Sigma/Splunk/Elastic rules against argument-level evasion
- Create red-team tradecraft variants for living-off-the-land execution
- Develop command-line normalization pipelines and “parsed vs raw” deviation alerts
- Prioritize detections based on non-string telemetry (network/file/registry/process actions)

Keywords:
command-line obfuscation, EDR evasion, AV bypass, LOLBIN, process creation telemetry, Windows 11 23H2, ArgFuscator.net, Invoke-ArgFuscator, Unicode homoglyphs, zero-width characters, quote insertion, option character substitution, argument parsing, Sigma rules, Splunk detections, Elastic detection rules, msiexec, certutil, reg.exe, parse_command_line (KQL)