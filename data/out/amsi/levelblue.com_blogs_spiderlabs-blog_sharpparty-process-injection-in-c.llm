Title:
SharpParty: Process Injection in C#

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post introduces “SharpParty,” a C# port of SafeBreach Labs’ PoolParty research, implementing Windows thread-pool–based process injection.  
- It addresses the problem of traditional injection primitives (e.g., CreateRemoteThread) being heavily monitored by modern AV/EDR by instead crafting legitimate thread pool work items inside a target process.  
- The article explains the PoolParty concept (work items as an execution primitive) and why a C# implementation is operationally useful, especially for inline MSBuild Task XML payloads and reflective in-memory loading via PowerShell.  
- It discusses real-world efficacy and detection tradeoffs, noting initial bypass success against Microsoft Defender for Endpoint followed by vendor detections after responsible disclosure and public research release.  
- A brief engagement “success story” outlines a multi-layer encrypted MSBuild inline task dropper that ultimately triggered delayed EDR detection, highlighting the value of time-to-detect gaps.  
- Useful primarily for red teams/pentesters building Windows tradecraft, and for blue teams looking to understand and detect thread-pool injection and MSBuild abuse.

Technical Focus:
- Windows Thread Pool internals and work item injection
- Process injection without CreateRemoteThread (alternate execution primitives)
- C# offensive tooling and P/Invoke-style Windows API interaction (implied)
- MSBuild inline Task XML execution (living-off-the-land)
- Reflective .NET assembly loading via PowerShell
- EDR detection/bypass considerations and time-to-detect

Use Cases:
- Implement thread-pool–based process injection in .NET tradecraft
- Build MSBuild Task XML payloads that compile/execute embedded C# on target hosts
- In-memory loading/execution of offensive .NET tooling via PowerShell
- Red team validation of EDR coverage for thread pool injection and msbuild.exe abuse
- Defensive testing: create detections for anomalous thread pool work item manipulation and MSBuild misuse

Keywords:
SharpParty, PoolParty, process injection, Windows thread pool, thread pool work item, T1055, msbuild.exe, inline MSBuild task, Task XML, living-off-the-land, C#, .NET assembly, reflective loading, PowerShell, shellcode injection, Cobalt Strike beacon, Microsoft Defender for Endpoint, EDR bypass, SafeBreach Labs, Stroz Friedberg