# https://jsecurity101.medium.com/refining-detection-new-perspectives-on-etw-patching-telemetry-e6c94e55a9ad

<!DOCTYPE html><html lang="en" data-rh="lang" dir="ltr"><body><div id="root"><div class="a b c"><a href="https://jonny-johnson.medium.com/sitemap/sitemap.xml" class="d">Sitemap</a><div class="e f g h i j k l"></div><div class="m c"><div class="m n o p c" style="transform: translateY(0px);"><div class="q r s t u v w x y j e z ab"><a class="eb ai ec bg am b ao ap aq ar as at au av t v x j e r ed ab" href="https://play.google.com/store/apps/details?id=com.medium.reader&amp;referrer=utm_source%3DmobileNavBar&amp;source=post_page---top_nav_layout_nav-----------------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="ea"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ac r"><p class="bg b ee ef eg eh ei ej ek el em eo eb"><span data-dd-action-name="Susi presentation tracker global_nav"><button class="bg b ee ef ep eg eh eq ei ej er es el et eu eo ev ew ex ey ez fa fb fc fd fe ff fg fh fi fj fk bn fl fm" data-testid="headerSignUpButton">Sign up</button></span></p><div class="fn m"><p class="bg b ee ef eg eh ei ej ek el em eo eb"><span data-dd-action-name="Susi presentation tracker global_nav"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fjonny-johnson.medium.com%2Frefining-detection-new-perspectives-on-etw-patching-telemetry-e6c94e55a9ad&amp;source=post_page---top_nav_layout_nav-----------------------global_nav------------------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="q r s ac ae af"><div class="ac r ag"><a class="ah ai aj ak al am an ao ap aq ar as at au av ac" aria-label="Homepage" data-testid="headerMediumLogo" href="https://medium.com/?source=post_page---top_nav_layout_nav-----------------------------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" aria-labelledby="wordmark-medium-desc" viewBox="0 0 719 160" class="aw ax ay"><desc id="wordmark-medium-desc">Medium Logo</desc><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="az i"><div class="ac ak ba bb bc r bd be"><div class="bn" aria-describedby="searchResults" aria-labelledby="searchResults" aria-haspopup="listbox" role="listbox"></div><div class="bo bp ac"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ak bf bg bh ab bi bj bk bl bm" placeholder="Search" value=""></div></div></div><div class="i l x fp fq"><span data-dd-action-name="Susi presentation tracker new_post_topnav"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerWriteButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav------------------" rel="noopener follow"><div class="bg b bh ab eb fr fs ac r ft fu fv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg>Write</div></a></span></div><div class="l k j e"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerSearchButton" href="https://medium.com/search?source=post_page---top_nav_layout_nav-----------------------------------------" rel="noopener follow"><div class="bg b bh ab eb fr fs ac r ft fu fv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Search</span></div></a></div><div class="ge i l k"><div class="ac r"><p class="bg b ee ef eg eh ei ej ek el em eo eb"><span data-dd-action-name="Susi presentation tracker global_nav"><button class="bg b ee ef ep eg eh eq ei ej er es el et eu eo ev ew ex ey ez fa fb fc fd fe ff fg fh fi fj fk bn fl fm" data-testid="headerSignUpButton">Sign up</button></span></p><div class="fn m"><p class="bg b ee ef eg eh ei ej ek el em eo eb"><span data-dd-action-name="Susi presentation tracker global_nav"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fjonny-johnson.medium.com%2Frefining-detection-new-perspectives-on-etw-patching-telemetry-e6c94e55a9ad&amp;source=post_page---top_nav_layout_nav-----------------------global_nav------------------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="m"><div><div class="bn" role="tooltip" aria-describedby="1" aria-labelledby="1"><div tabindex="-1" class="bf"><button class="ak gf ao ac r aq fr gg gh gi" aria-label="user options menu" data-testid="headerUserIcon"><div class="m fr"><img alt="" class="m fk by bz ca de" width="32" height="32" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fill:32:32/1*dmbNkD5D-u45r44go_cf0g.png"><div class="gj by m bz ca fw o ak gk"></div></div></button></div></div></div></div></div></div><div class="ac"><div class="cb i l k j cc" style="width: 0px;"></div><div class="cd bi ce cf cg ch" style="width: calc(100% + 0px);"><div class="m"><div data-focus-guard="true" tabindex="-1" style="width: 1px; height: 0px; padding: 0px; overflow: hidden; position: fixed; top: 1px; left: 1px;"></div><div data-focus-lock-disabled="disabled"><div class="qv" role="dialog" aria-modal="true" tabindex="-1"><div class="vf vg bi ed vh vi vj aq vk hd vl" aria-hidden="true" role="presentation"></div><div class="vm vh vn vo vp vf ed fk vq vr vs ln vt vu vv vw vx vy vz wa wb wc ac cv wd" aria-hidden="true"><div class="we gy"></div></div></div></div><div data-focus-guard="true" tabindex="-1" style="width: 1px; height: 0px; padding: 0px; overflow: hidden; position: fixed; top: 1px; left: 1px;"></div><div class="gl gm gn go gp m"><div class="ac ci"><div class="cp bi gq gr gs gt"></div></div><article><div class="m"><div class="m"><span class="m"></span><section><div><div class="fw gz wf hb hc hd"></div><div class="he hf hg hh hi"><div class="ac ci"><div class="cp bi gq gr gs gt"><div><h1 id="577e" class="pw-post-title hj hk hl bg hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il bl" data-testid="storyTitle" data-selectable-paragraph="">Refining Detection: New Perspectives on ETW Patching Telemetry</h1><div><div class="speechify-ignore ac cw"><div class="speechify-ignore bi m"><div class="ac im in io ip iq ir is it iu iv iw"><div class="ac r iw"><div class="ac ix"><div><div class="bn" aria-describedby="3" aria-labelledby="3" role="tooltip"><div tabindex="-1" class="bf"><a rel="noopener follow" href="https://jonny-johnson.medium.com/?source=post_page---byline--e6c94e55a9ad---------------------------------------" data-discover="true"><div class="m iy iz by ja jb"><div class="m fr"><img alt="Jonathan Johnson" class="m fk by bz ca de" width="32" height="32" loading="lazy" data-testid="authorPhoto" src="https://miro.medium.com/v2/resize:fill:32:32/1*ro6iOomAZwYlmMgljL7EfA.png"><div class="jc by m bz ca fw o jd gk"></div></div></div></a></div></div></div></div><span class="bg b bh ab bl"><div class="je ac r"><div class="ac r jf"><div class="ac r"><div><div class="bn" aria-describedby="4" aria-labelledby="4" role="tooltip"><div tabindex="-1" class="bf"><span class="bg b bh ab bl"><a class="ah ai aj fo al am an ao ap aq ar as at jg" data-testid="authorName" rel="noopener follow" href="https://jonny-johnson.medium.com/?source=post_page---byline--e6c94e55a9ad---------------------------------------" data-discover="true">Jonathan Johnson</a></span></div></div></div></div><div class="jh bn"></div><button class="wz xe aq ac ci r xf xg xh" style="border: 1px solid rgb(36, 36, 36);"><span class="bg b bh ab bl bi"><span class="bn xi">Follow</span></span></button></div></div></span></div><div class="ac r ji"><span class="bg b bh ab eb"><div class="ac ag"><span data-testid="storyReadTime">7 min read</span><div class="jj jk m" aria-hidden="true"><span class="m" aria-hidden="true"><span class="bg b bh ab eb">·</span></span></div><span data-testid="storyPublishDate">Jun 12, 2024</span></div></span></div></div><div class="ac cw jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka"><div class="i l x fp fq r"><div class="kq m"><div class="ac r kr ks"><div class="pw-multi-vote-icon fr kt ku kv kw"><span data-dd-action-name="Susi presentation tracker clap_footer"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fe6c94e55a9ad&amp;operation=register&amp;redirect=https%3A%2F%2Fjonny-johnson.medium.com%2Frefining-detection-new-perspectives-on-etw-patching-telemetry-e6c94e55a9ad&amp;user=Jonathan+Johnson&amp;userId=78d2ff57ed70&amp;source=---header_actions--e6c94e55a9ad---------------------clap_footer------------------" rel="noopener follow"><div><div class="bn" aria-describedby="5" aria-labelledby="5" role="tooltip"><div tabindex="-1" class="bf"><div class="kx aq ky kz la lb ao lc ld le kw" role="presentation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></div></a></span></div><div class="pw-multi-vote-count m lf lg lh li lj lk ll"><div><div class="bn" aria-describedby="48" aria-labelledby="48" role="tooltip"><div tabindex="-1" class="bf"><p class="bg b ec ab eb"><button class="ah ai aj fo al am an ao ap aq ar as at au av xj lt">66<span class="m i h g ra rb"></span></button></p></div></div></div></div></div></div><div><div class="bn" aria-describedby="6" aria-labelledby="6" role="tooltip"><div tabindex="-1" class="bf"><button class="aq kx ln lo ac r fs lp lq" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lr"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ac r kb kc kd ke kf kg kh ki kj kk kl km kn ko kp"><div class="ls l k j e"></div><div class="i l"><div><div class="bn" aria-describedby="7" aria-labelledby="7" role="tooltip"><div tabindex="-1" class="bf"><span data-dd-action-name="Susi presentation tracker bookmark_footer"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe6c94e55a9ad&amp;operation=register&amp;redirect=https%3A%2F%2Fjonny-johnson.medium.com%2Frefining-detection-new-perspectives-on-etw-patching-telemetry-e6c94e55a9ad&amp;source=---header_actions--e6c94e55a9ad---------------------bookmark_footer------------------" rel="noopener follow"><span class=""><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="eb lt" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></span></a></span></div></div></div></div><div class="fk lu cu"><div class="m ag"><div class="ac ci"><div class="lv lw lx ly lz ma cp bi"><div class="ac"><div class="bn" role="tooltip"><div><div class="bn" aria-describedby="8" aria-labelledby="8" role="tooltip"><div tabindex="-1" class="bf"><button aria-label="Listen" data-testid="audioPlayButton" class="ah fs aj fo al am an mb ap aq ar fe mc md lq me mf mg mh mi t mj mk ml mm mn mo mp v mq mr ms"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="k j e"><p class="bg b bh ab eb">Listen</p></div></button></div></div></div></div></div></div></div></div></div><div class="bn" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bn" aria-describedby="9" aria-labelledby="9" role="tooltip"><div tabindex="-1" class="bf"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="ah fs aj fo al am an mb ap aq ar fe mc md lq me mf mg mh mi t mj mk ml mm mn mo mp v mq mr ms"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="k j e"><p class="bg b bh ab eb">Share</p></div></button></div></div></div></div></div></div></div></div></div></div><h2 id="0416" class="mt mu hl bg mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq bl" data-selectable-paragraph="">Introduction</h2><p id="f69c" class="pw-post-body-paragraph nr ns hl nt b nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om on oo he bl" data-selectable-paragraph="">Not long ago I wrote a blog called <a class="ah op" href="https://medium.com/@jsecurity101/understanding-etw-patching-9f5af87f9d7b" rel="noopener">Understanding ETW Patching</a> where I walked through how ETW patching is a hyper-focused version of a function patch. In the Defenders portion I mention how an approach to seeing this activity could be seeing a provider DLL loaded within a process but no ETW events being emitted. This isn’t a great approach because it will only work for a targeted provider. You can read more about this initial thought in this <a class="ah op" href="https://x.com/jsecurity101/status/1734986839151292439" rel="noopener ugc nofollow" target="_blank">tweet</a>. Since then, I have dived a bit deeper and this post, although short, will discuss this approach.</p><h2 id="f9aa" class="mt mu hl bg mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq bl" data-selectable-paragraph="">Local ETW Patching</h2><p id="9992" class="pw-post-body-paragraph nr ns hl nt b nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om on oo he bl" data-selectable-paragraph="">As discussed in my previous <a class="ah op" href="https://medium.com/@jsecurity101/understanding-etw-patching-9f5af87f9d7b" rel="noopener">post</a>, a common way to patch out events being emitted is by focusing on the ntdll functions, specifically <a class="ah op" href="https://learn.microsoft.com/en-us/windows/win32/devnotes/etweventwrite" rel="noopener ugc nofollow" target="_blank">EtwEventWrite</a> or <a class="ah op" href="https://www.geoffchappell.com/studies/windows/km/ntoskrnl/api/etw/traceapi/event/index.htm" rel="noopener ugc nofollow" target="_blank">NtTraceEvent</a>. The steps to accomplish this are as follows:</p><ol class=""><li id="9733" class="nr ns hl nt b nu oq nw nx ny or oa ob oc os oe of og ot oi oj ok ou om on oo ov ow ox bl" data-selectable-paragraph="">Load the DLL: Load the DLL that contains the function you want to patch, if it isn’t already loaded.</li><li id="4f49" class="nr ns hl nt b nu oy nw nx ny oz oa ob oc pa oe of og pb oi oj ok pc om on oo ov ow ox bl" data-selectable-paragraph="">Obtain a Function Pointer: Get a function pointer to the desired function.</li><li id="65e9" class="nr ns hl nt b nu oy nw nx ny oz oa ob oc pa oe of og pb oi oj ok pc om on oo ov ow ox bl" data-selectable-paragraph="">Change Memory Protection: Change the memory region’s protection value to allow write access.</li><li id="9a5d" class="nr ns hl nt b nu oy nw nx ny oz oa ob oc pa oe of og pb oi oj ok pc om on oo ov ow ox bl" data-selectable-paragraph="">Apply the Patch: Write in the patch.</li><li id="8218" class="nr ns hl nt b nu oy nw nx ny oz oa ob oc pa oe of og pb oi oj ok pc om on oo ov ow ox bl" data-selectable-paragraph="">Restore Memory Protection: Optionally, change the memory region’s protection value back to its original setting.</li></ol><p id="9762" class="pw-post-body-paragraph nr ns hl nt b nu oq nw nx ny or oa ob oc os oe of og ot oi oj ok ou om on oo he bl" data-selectable-paragraph="">As you can see, after obtaining the function pointer, someone can not simply patch these bytes arbitrarily. The protection level of the memory address for both functions must first be changed. This would be possible if those functions had write permissions on their memory region, but as we will see in a moment they do not.</p><p id="1888" class="pw-post-body-paragraph nr ns hl nt b nu oq nw nx ny or oa ob oc os oe of og ot oi oj ok ou om on oo he bl" data-selectable-paragraph="">Memory regions have <a class="ah op" href="https://learn.microsoft.com/en-us/windows/win32/Memory/memory-protection-constants" rel="noopener ugc nofollow" target="_blank">protection constants</a> that limit the actions that can be performed on them. For these functions, you will see that writing to that memory section is not supported unless the protection value is modified. Below we can see the memory region’s protection value of these functions.</p><pre class="pd pe pf pg ph pi pj pk bq pl bc bl"><span id="49d2" class="pm mu hl pj b bh pn po m pp pq" data-selectable-paragraph="">0:012&gt; !vprot ntdll!EtwEventWrite<br>BaseAddress: 00007ffaafbbf000<br>AllocationBase: 00007ffaafb90000<br>AllocationProtect: 00000080 PAGE_EXECUTE_WRITECOPY<br>RegionSize: 0000000000103000<br>State: 00001000 MEM_COMMIT<br>Protect: 00000020 PAGE_EXECUTE_READ<br>Type: 01000000 MEM_IMAGE<br><br>0:012&gt; !vprot ntdll!NtTraceEvent<br>BaseAddress: 00007ffaafc30000<br>AllocationBase: 00007ffaafb90000<br>AllocationProtect: 00000080 PAGE_EXECUTE_WRITECOPY<br>RegionSize: 0000000000092000<br>State: 00001000 MEM_COMMIT<br>Protect: 00000020 PAGE_EXECUTE_READ<br>Type: 01000000 MEM_IMAGE</span></pre><p id="61c1" class="pw-post-body-paragraph nr ns hl nt b nu oq nw nx ny or oa ob oc os oe of og ot oi oj ok ou om on oo he bl" data-selectable-paragraph="">This indicates that code within these sections can be read and executed, but not written to. Therefore, when patching either of these functions, the protection value must be changed, typically to PAGE_EXECUTE_READWRITE (0x40/60), using <a class="ah op" href="https://learn.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-virtualprotect" rel="noopener ugc nofollow" target="_blank">VirtualProtect</a>. Telemetry collected prior to the <a class="ah op" href="https://learn.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-virtualprotect" rel="noopener ugc nofollow" target="_blank">VirtualProtect</a> operation is likely not a reliable indicator of function patching. Even the <a class="ah op" href="https://learn.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-virtualprotect" rel="noopener ugc nofollow" target="_blank">VirtualProtect</a> operation isn’t directly indicative of function patching. However, if telemetry data for <a class="ah op" href="https://learn.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-virtualprotect" rel="noopener ugc nofollow" target="_blank">VirtualProtect</a> is available, it could offer sufficient context within the metadata to speculate whether function patching has taken place.</p><p id="e37e" class="pw-post-body-paragraph nr ns hl nt b nu oq nw nx ny or oa ob oc os oe of og ot oi oj ok ou om on oo he bl" data-selectable-paragraph="">Within the ETW Threat Intelligence Provider there is an event — THREATINT_PROTECTVM_LOCAL (EID: 7) that seems to give us telemetry when VirtualProtect was performed locally. We can tell this by looking at the <a class="ah op" href="https://github.com/jsecurity101/TelemetrySource" rel="noopener ugc nofollow" target="_blank">TelemetrySource</a> project of by running <a class="ah op" href="https://github.com/jsecurity101/ETWInspector" rel="noopener ugc nofollow" target="_blank">EtwInspector</a>:</p><figure class="pd pe pf pg ph pu pr ps paragraph-image"><div class="pr ps pt"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*Y_Cd6Jz2XuFfBvhZ 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*Y_Cd6Jz2XuFfBvhZ 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*Y_Cd6Jz2XuFfBvhZ 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*Y_Cd6Jz2XuFfBvhZ 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*Y_Cd6Jz2XuFfBvhZ 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*Y_Cd6Jz2XuFfBvhZ 1100w, https://miro.medium.com/v2/resize:fit:1046/format:webp/0*Y_Cd6Jz2XuFfBvhZ 1046w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 523px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/0*Y_Cd6Jz2XuFfBvhZ 640w, https://miro.medium.com/v2/resize:fit:720/0*Y_Cd6Jz2XuFfBvhZ 720w, https://miro.medium.com/v2/resize:fit:750/0*Y_Cd6Jz2XuFfBvhZ 750w, https://miro.medium.com/v2/resize:fit:786/0*Y_Cd6Jz2XuFfBvhZ 786w, https://miro.medium.com/v2/resize:fit:828/0*Y_Cd6Jz2XuFfBvhZ 828w, https://miro.medium.com/v2/resize:fit:1100/0*Y_Cd6Jz2XuFfBvhZ 1100w, https://miro.medium.com/v2/resize:fit:1046/0*Y_Cd6Jz2XuFfBvhZ 1046w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 523px"><img alt="" class="bi ma pv c" width="523" height="554" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:523/0*Y_Cd6Jz2XuFfBvhZ"></picture></div></figure><p id="cb21" class="pw-post-body-paragraph nr ns hl nt b nu oq nw nx ny or oa ob oc os oe of og ot oi oj ok ou om on oo he bl" data-selectable-paragraph="">After further investigation we can confirm that there are events for when someone changes the protection level of a region of memory:</p><p id="0d47" class="pw-post-body-paragraph nr ns hl nt b nu oq nw nx ny or oa ob oc os oe of og ot oi oj ok ou om on oo he bl" data-selectable-paragraph=""><strong class="nt hm">Pre-Patch: Changing the protection value from PAGE_EXECUTE_READ (0x20) to PAGE_EXECUTE_READWRITE (0x40).</strong></p><figure class="pd pe pf pg ph pu pr ps paragraph-image"><div class="pr ps pw"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*-lz06SVh9236wYgV 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*-lz06SVh9236wYgV 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*-lz06SVh9236wYgV 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*-lz06SVh9236wYgV 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*-lz06SVh9236wYgV 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*-lz06SVh9236wYgV 1100w, https://miro.medium.com/v2/resize:fit:1092/format:webp/0*-lz06SVh9236wYgV 1092w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 546px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/0*-lz06SVh9236wYgV 640w, https://miro.medium.com/v2/resize:fit:720/0*-lz06SVh9236wYgV 720w, https://miro.medium.com/v2/resize:fit:750/0*-lz06SVh9236wYgV 750w, https://miro.medium.com/v2/resize:fit:786/0*-lz06SVh9236wYgV 786w, https://miro.medium.com/v2/resize:fit:828/0*-lz06SVh9236wYgV 828w, https://miro.medium.com/v2/resize:fit:1100/0*-lz06SVh9236wYgV 1100w, https://miro.medium.com/v2/resize:fit:1092/0*-lz06SVh9236wYgV 1092w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 546px"><img alt="" class="bi ma pv c" width="546" height="584" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:546/0*-lz06SVh9236wYgV"></picture></div></figure><p id="f7bd" class="pw-post-body-paragraph nr ns hl nt b nu oq nw nx ny or oa ob oc os oe of og ot oi oj ok ou om on oo he bl" data-selectable-paragraph="">There is some valuable information in this event, specifically:</p><ul class=""><li id="a5d3" class="nr ns hl nt b nu oq nw nx ny or oa ob oc os oe of og ot oi oj ok ou om on oo px ow ox bl" data-selectable-paragraph=""><strong class="nt hm">BaseAddress </strong>— the memory address where the protection value was changed.</li><li id="8fbd" class="nr ns hl nt b nu oy nw nx ny oz oa ob oc pa oe of og pb oi oj ok pc om on oo px ow ox bl" data-selectable-paragraph=""><strong class="nt hm">RegionSize Value</strong> — 2. This shows that the protection of only 2 bytes were changed. This is unusually low and from what I found this value is oftentimes 4096 or higher. This will be the case if someone changes the bytes to (0xc3, 0x00) which is the return value in x64 systems.</li><li id="2575" class="nr ns hl nt b nu oy nw nx ny oz oa ob oc pa oe of og pb oi oj ok pc om on oo px ow ox bl" data-selectable-paragraph=""><strong class="nt hm">ProtectionMask</strong> — Shows the value was changed to PAGE_EXECUTE_READWRITE.</li><li id="028a" class="nr ns hl nt b nu oy nw nx ny oz oa ob oc pa oe of og pb oi oj ok pc om on oo px ow ox bl" data-selectable-paragraph=""><strong class="nt hm">Last ProtectionMask</strong> — Shows the value was changed from PAGE_EXECUTE_READ.</li><li id="8cb2" class="nr ns hl nt b nu oy nw nx ny oz oa ob oc pa oe of og pb oi oj ok pc om on oo px ow ox bl" data-selectable-paragraph=""><strong class="nt hm">Callstack</strong> — shows that VirtualProtect was called.</li></ul><p id="94f3" class="pw-post-body-paragraph nr ns hl nt b nu oq nw nx ny or oa ob oc os oe of og ot oi oj ok ou om on oo he bl" data-selectable-paragraph=""><strong class="nt hm">Post-Patch: Changing the protection value from PAGE_EXECUTE_READWRITE (0x20) to PAGE_EXECUTE_READ (0x40).</strong></p><figure class="pd pe pf pg ph pu pr ps paragraph-image"><div class="pr ps py"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*TxweUSUfMn-jybbV 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*TxweUSUfMn-jybbV 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*TxweUSUfMn-jybbV 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*TxweUSUfMn-jybbV 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*TxweUSUfMn-jybbV 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*TxweUSUfMn-jybbV 1100w, https://miro.medium.com/v2/resize:fit:1096/format:webp/0*TxweUSUfMn-jybbV 1096w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 548px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/0*TxweUSUfMn-jybbV 640w, https://miro.medium.com/v2/resize:fit:720/0*TxweUSUfMn-jybbV 720w, https://miro.medium.com/v2/resize:fit:750/0*TxweUSUfMn-jybbV 750w, https://miro.medium.com/v2/resize:fit:786/0*TxweUSUfMn-jybbV 786w, https://miro.medium.com/v2/resize:fit:828/0*TxweUSUfMn-jybbV 828w, https://miro.medium.com/v2/resize:fit:1100/0*TxweUSUfMn-jybbV 1100w, https://miro.medium.com/v2/resize:fit:1096/0*TxweUSUfMn-jybbV 1096w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 548px"><img alt="" class="bi ma pv c" width="548" height="572" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:548/0*TxweUSUfMn-jybbV"></picture></div></figure><p id="dbe9" class="pw-post-body-paragraph nr ns hl nt b nu oq nw nx ny or oa ob oc os oe of og ot oi oj ok ou om on oo he bl" data-selectable-paragraph="">The post protection value doesn’t have to take place. However, it’s a good signal if someone wants to see when the protection value was changed to one value then back. This is very odd for someone to do. Because we can’t see the actual bytes being changed this could help with false positives.</p><div class="tm tn to tp ac r cv"><div class="tq tr ts tt tu m fm"><h2 class="tv b tw tx ty tz ua">Get Jonathan Johnson’s stories in&nbsp;your&nbsp;inbox</h2></div><div class="cs m fm"><p class="bg b bh ab eb">Join Medium for free to get updates from&nbsp;this&nbsp;writer.</p></div><div class="ue rf uf ug re uh ac"><span class="bg b bh ab bl"><div class="ui ac cv"><div class="ac ui fj fi bq uj uk de ln ul um un uo up uq ur"><input class="us al aj an ut uu gd lb bm uv bi" placeholder="Enter your email" type="text" value=""></div></div></span><div class="i l rv cb"><div class="ub uc ud"><button class="bg b bh ab uw qk ux uy uz va vb fc fd vc vd ve fh fi fj fk bn fl fm">Subscribe</button></div></div><div class="bi k j e"><button class="bg b bh ab uw qk ux uy uz va vb fc fd vc vd ve fh bi fi fj fk bn fl fm">Subscribe</button></div></div><div class="qi m"><div id="g-recaptcha"></div></div></div><p id="2254" class="pw-post-body-paragraph nr ns hl nt b nu nw nx ny oa ob oc oe of og oi oj ok om on tp oo he bl" data-selectable-paragraph="">Now you might be thinking — what about the actual patching of the bytes? Initially I thought that WriteProcessMemory would work, but then realized that when someone calls the C function — memcpy/memmove doesn’t actually end up calling WriteProcessMemory. We will still explore this below in remote patching.</p><h2 id="2879" class="mt mu hl bg mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq bl" data-selectable-paragraph="">Detection Ideas:</h2><ol class=""><li id="87c0" class="nr ns hl nt b nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om on oo ov ow ox bl" data-selectable-paragraph="">Collect Event ID 7: Local Virtual Protect — Initial ProtectionMask Change</li></ol><ul class=""><li id="03ae" class="nr ns hl nt b nu oq nw nx ny or oa ob oc os oe of og ot oi oj ok ou om on oo px ow ox bl" data-selectable-paragraph="">Look for the common number of bytes that are patched (RegionSize Value) in functions you care about in x64/x86. A good example is with EtwEventWrite in x64 the number of bytes that are patched are 2 because often the return value is patched in once the function gets executed.</li><li id="564d" class="nr ns hl nt b nu oy nw nx ny oz oa ob oc pa oe of og pb oi oj ok pc om on oo px ow ox bl" data-selectable-paragraph="">Look for when the New ProtectionMask has been opened to PAGE_READWRITE (0x04) or PAGE_EXECUTE_READWRITE (0x40)</li></ul><p id="14c8" class="pw-post-body-paragraph nr ns hl nt b nu oq nw nx ny or oa ob oc os oe of og ot oi oj ok ou om on oo he bl" data-selectable-paragraph="">2. Collect Event ID 7: Local Virtual Protect — Reverting the ProtectionMask</p><ul class=""><li id="ecbe" class="nr ns hl nt b nu oq nw nx ny or oa ob oc os oe of og ot oi oj ok ou om on oo px ow ox bl" data-selectable-paragraph="">Someone doesn’t have to change the protection value back to the original value, but that is common practice. Honestly seeing the protection mask go from a more locked down mask like 0x20 to 0x40 then back to 0x20 is pretty suspicious. So watching for 2 EID 7’s where the same memory address has its protection mask changed back and forth like that could yield high results.</li></ul><h2 id="08b9" class="mt mu hl bg mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq bl" data-selectable-paragraph="">Remote ETW Patching</h2><p id="92db" class="pw-post-body-paragraph nr ns hl nt b nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om on oo he bl" data-selectable-paragraph="">Remote patching is more uncommon but not unheard of and a good project to check out for this would be <a class="ah op" href="https://github.com/Hagrid29/RemotePatcher" rel="noopener ugc nofollow" target="_blank">RemotePatcher</a>. This is because it is a lot riskier to perform remote function patching, due to the likelihood of getting detected. Because memcpy/memmove doesn’t support the writing of bytes within a remote process, <a class="ah op" href="https://learn.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-writeprocessmemory" rel="noopener ugc nofollow" target="_blank">WriteProcessMemory</a> has to be used, RemotePatcher does this in the <a class="ah op" href="https://github.com/Hagrid29/RemotePatcher/blob/29f478c758714e48c88d3e3ce5a2177c3076b924/RemotePatcher/RemotePatcher.cpp#L8C6-L8C15" rel="noopener ugc nofollow" target="_blank">patchAMSI</a> function.</p><figure class="pd pe pf pg ph pu pr ps paragraph-image"><div role="button" tabindex="0" class="qa qb fr qc bi qd"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="pr ps pz"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*-oeeish3PDt1FqiJ 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*-oeeish3PDt1FqiJ 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*-oeeish3PDt1FqiJ 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*-oeeish3PDt1FqiJ 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*-oeeish3PDt1FqiJ 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*-oeeish3PDt1FqiJ 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-oeeish3PDt1FqiJ 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/0*-oeeish3PDt1FqiJ 640w, https://miro.medium.com/v2/resize:fit:720/0*-oeeish3PDt1FqiJ 720w, https://miro.medium.com/v2/resize:fit:750/0*-oeeish3PDt1FqiJ 750w, https://miro.medium.com/v2/resize:fit:786/0*-oeeish3PDt1FqiJ 786w, https://miro.medium.com/v2/resize:fit:828/0*-oeeish3PDt1FqiJ 828w, https://miro.medium.com/v2/resize:fit:1100/0*-oeeish3PDt1FqiJ 1100w, https://miro.medium.com/v2/resize:fit:1400/0*-oeeish3PDt1FqiJ 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bi ma pv c" width="700" height="312" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:700/0*-oeeish3PDt1FqiJ"></picture></div></div></figure><p id="54ad" class="pw-post-body-paragraph nr ns hl nt b nu oq nw nx ny or oa ob oc os oe of og ot oi oj ok ou om on oo he bl" data-selectable-paragraph="">Now, we can see that <a class="ah op" href="https://ntdoc.m417z.com/ntprotectvirtualmemory" rel="noopener ugc nofollow" target="_blank">NtProtectVirtualMemory</a> is called twice, once to change the protection value to PAGE_READWRITE (0x04) and then back to the original value. The difference is that NtWriteVirtualMemory is called. We can tell within <a class="ah op" href="https://github.com/jsecurity101/TelemetrySource" rel="noopener ugc nofollow" target="_blank">TelemetrySource</a> that this will lead to event ID 14 within the ETW TI Provider. Let’s take a look at this:</p><figure class="pd pe pf pg ph pu pr ps paragraph-image"><div role="button" tabindex="0" class="qa qb fr qc bi qd"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="pr ps qe"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*LN6EXaYS6GNIGcAM 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*LN6EXaYS6GNIGcAM 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*LN6EXaYS6GNIGcAM 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*LN6EXaYS6GNIGcAM 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*LN6EXaYS6GNIGcAM 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*LN6EXaYS6GNIGcAM 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*LN6EXaYS6GNIGcAM 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/0*LN6EXaYS6GNIGcAM 640w, https://miro.medium.com/v2/resize:fit:720/0*LN6EXaYS6GNIGcAM 720w, https://miro.medium.com/v2/resize:fit:750/0*LN6EXaYS6GNIGcAM 750w, https://miro.medium.com/v2/resize:fit:786/0*LN6EXaYS6GNIGcAM 786w, https://miro.medium.com/v2/resize:fit:828/0*LN6EXaYS6GNIGcAM 828w, https://miro.medium.com/v2/resize:fit:1100/0*LN6EXaYS6GNIGcAM 1100w, https://miro.medium.com/v2/resize:fit:1400/0*LN6EXaYS6GNIGcAM 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bi ma pv c" width="700" height="744" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:700/0*LN6EXaYS6GNIGcAM"></picture></div></div></figure><p id="e8df" class="pw-post-body-paragraph nr ns hl nt b nu oq nw nx ny or oa ob oc os oe of og ot oi oj ok ou om on oo he bl" data-selectable-paragraph="">What is cool about the events shown above is that it’s clear there’s a process that accessed a remote process, changed the memory region protection values, wrote data to the target process and then change the protection values back. This sequence of operations doesn’t happen frequently in Windows.</p><h2 id="60c3" class="mt mu hl bg mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq bl" data-selectable-paragraph="">Detection Ideas:</h2><ol class=""><li id="ccb4" class="nr ns hl nt b nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om on oo ov ow ox bl" data-selectable-paragraph="">Collect Event ID 2: Remote Virtual Protect — Initial ProtectionMask Change</li></ol><ul class=""><li id="ee95" class="nr ns hl nt b nu oq nw nx ny or oa ob oc os oe of og ot oi oj ok ou om on oo px ow ox bl" data-selectable-paragraph="">Look for when the New ProtectionMask has been opened to PAGE_READWRITE (0x04) or PAGE_EXECUTE_READWRITE (0x40)</li></ul><p id="8975" class="pw-post-body-paragraph nr ns hl nt b nu oq nw nx ny or oa ob oc os oe of og ot oi oj ok ou om on oo he bl" data-selectable-paragraph="">2. Collect Event ID 2: Remote Virtual Protect — Reverting the ProtectionMask</p><ul class=""><li id="ecb6" class="nr ns hl nt b nu oq nw nx ny or oa ob oc os oe of og ot oi oj ok ou om on oo px ow ox bl" data-selectable-paragraph="">Someone doesn’t have to change the protection value back to the original value, but that is common practice. Honestly seeing the protection mask go from a more locked down mask like 0x20 to 0x40 then back to 0x20 is pretty suspicious. So watching for 2 EID 2’s where the same memory address has its protection mask changed back and forth like that could yield high results.</li></ul><p id="d8b6" class="pw-post-body-paragraph nr ns hl nt b nu oq nw nx ny or oa ob oc os oe of og ot oi oj ok ou om on oo he bl" data-selectable-paragraph="">3. Collect Event ID 14: Write Process Memory — writing the bytes for the patch</p><ul class=""><li id="508d" class="nr ns hl nt b nu oq nw nx ny or oa ob oc os oe of og ot oi oj ok ou om on oo px ow ox bl" data-selectable-paragraph="">Watching this in the context of a remote VirtualProtect being performed before and after the memory write would be suspicious</li><li id="e131" class="nr ns hl nt b nu oy nw nx ny oz oa ob oc pa oe of og pb oi oj ok pc om on oo px ow ox bl" data-selectable-paragraph="">Keep in mind this might be hard to discern if this is ETW Patching, but this definitely could be used for Process Injection visibility regardless. This technically could be considered process injection since data is being written into a target process.</li></ul><h2 id="9314" class="mt mu hl bg mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq bl" data-selectable-paragraph="">Conclusion</h2><p id="9eb2" class="pw-post-body-paragraph nr ns hl nt b nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om on oo he bl" data-selectable-paragraph="">In this post, I wanted to briefly explore ETW patching and a practical approach to observing this activity. Local patching is much more common than remote patching. Unfortunately, because memcpy and memmove do not call <a class="ah op" href="https://learn.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-writeprocessmemory" rel="noopener ugc nofollow" target="_blank">WriteProcessMemory</a>, identifying the actual patch locally is extremely difficult. However, detecting changes in the protection masks for the memory region where the patch will take place remains a good indicator.</p><p id="e618" class="pw-post-body-paragraph nr ns hl nt b nu oq nw nx ny or oa ob oc os oe of og ot oi oj ok ou om on oo he bl" data-selectable-paragraph="">It is uncommon to see these protection masks change from read/execute to read/write/execute. Additionally, the number of bytes changing in such events is usually lower than in other common VirtualProtect events, which often involve 4096 bytes or more. Keep in mind that, as seen in RemotePatcher, someone could change the protection value of a 4096-byte memory region to blend in.</p><p id="cee2" class="pw-post-body-paragraph nr ns hl nt b nu oq nw nx ny or oa ob oc os oe of og ot oi oj ok ou om on oo he bl" data-selectable-paragraph="">If you are wanting to implement this approach, I recommend analyzing the data to identify patterns where multiple operations occur in sequence, rather than just a single operation. Additionally, examine all possible protection values an attacker might change, especially those that include write permissions. I hope this information is helpful. Please feel free to reach out if you have any ideas to share or questions to ask.</p><p id="a5ff" class="pw-post-body-paragraph nr ns hl nt b nu oq nw nx ny or oa ob oc os oe of og ot oi oj ok ou om on oo he bl" data-selectable-paragraph=""><em class="qf">Thanks to </em><a class="ah op" href="https://x.com/waldoirc" rel="noopener ugc nofollow" target="_blank"><em class="qf">Arash Parsa</em></a><em class="qf"> for reaching out and prompting me to revisit and document this topic.</em></p></div></div></div></div></section></div></div></article></div><div class="ac ci"><div class="cp bi gq gr gs gt"><div class="qg qh ac ji"><div class="qi ac"><a class="qj ak ao aq" href="https://medium.com/tag/windows?source=post_page-----e6c94e55a9ad---------------------------------------" rel="noopener follow"><div class="qk fr de ql gv qm qn bg b bh ab bl gc">Windows</div></a></div><div class="qi ac"><a class="qj ak ao aq" href="https://medium.com/tag/windows-internals?source=post_page-----e6c94e55a9ad---------------------------------------" rel="noopener follow"><div class="qk fr de ql gv qm qn bg b bh ab bl gc">Windows Internals</div></a></div><div class="qi ac"><a class="qj ak ao aq" href="https://medium.com/tag/detection-engineering?source=post_page-----e6c94e55a9ad---------------------------------------" rel="noopener follow"><div class="qk fr de ql gv qm qn bg b bh ab bl gc">Detection Engineering</div></a></div><div class="qi ac"><a class="qj ak ao aq" href="https://medium.com/tag/research?source=post_page-----e6c94e55a9ad---------------------------------------" rel="noopener follow"><div class="qk fr de ql gv qm qn bg b bh ab bl gc">Research</div></a></div></div></div></div><div class="m"></div><div class="rd m"><div class="ac ci"><div class="cp bi gq gr gs gt"><div class="ac iv it ir re rf"><div class="rg rh ri rj rk rl rm rn ro rp ac cw"><div class="i l"><a tabindex="0" rel="noopener follow" href="https://jonny-johnson.medium.com/?source=post_page---post_author_info--e6c94e55a9ad---------------------------------------" data-discover="true"><div class="m fr"><img alt="Jonathan Johnson" class="m fk by rq rr de" width="48" height="48" loading="lazy" src="https://miro.medium.com/v2/resize:fill:48:48/1*ro6iOomAZwYlmMgljL7EfA.png"><div class="gj by m rq rr fw o ak rs"></div></div></a></div><div class="k j e"><a tabindex="0" rel="noopener follow" href="https://jonny-johnson.medium.com/?source=post_page---post_author_info--e6c94e55a9ad---------------------------------------" data-discover="true"><div class="m fr"><img alt="Jonathan Johnson" class="m fk by rt ru de" width="64" height="64" loading="lazy" src="https://miro.medium.com/v2/resize:fill:64:64/1*ro6iOomAZwYlmMgljL7EfA.png"><div class="gj by m rt ru fw o ak rs"></div></div></a></div><div class="k j e rv cb"><div class="ac"><button class="wz xe aq ac ci r xk kq xl" style="border: 1px solid rgb(36, 36, 36);"><span class="bg b bh ab bl bi"><span class="bn xi">Follow</span></span></button></div></div></div><div class="ac cv cd"><div class="rw rx ry rz sa m"><a class="ah ai aj al am an ao ap aq ar as at au av ac r" rel="noopener follow" href="https://jonny-johnson.medium.com/?source=post_page---post_author_info--e6c94e55a9ad---------------------------------------" data-discover="true"><h2 class="pw-author-name bg sc sd se sf sg sh si oc sj sk og sl sm ok sn so bl"><span class="he sb">Written by Jonathan Johnson</span></h2></a><div class="qi ac ix"><div class="m cb"><span class="pw-follower-count bg b bh ab eb"><a class="ah ai aj fo al am an ao ap aq ar as at jg" rel="noopener follow" href="https://jonny-johnson.medium.com/followers?source=post_page---post_author_info--e6c94e55a9ad---------------------------------------" data-discover="true">1.1K followers</a></span></div><div class="bg b bh ab eb ac sp"><span class="sq m" aria-hidden="true"><span class="bg b bh ab eb">·</span></span><a class="ah ai aj fo al am an ao ap aq ar as at jg" rel="noopener follow" href="https://jonny-johnson.medium.com/following?source=post_page---post_author_info--e6c94e55a9ad---------------------------------------" data-discover="true">30 following</a></div></div><div class="sr m"><p class="bg b bh ab bl"><span class="he">Principal Windows EDR Product Researcher @Huntress | Windows Internals</span></p></div></div></div><div class="i l"><div class="ac"><button class="wz xe aq ac ci r xk kq xl" style="border: 1px solid rgb(36, 36, 36);"><span class="bg b bh ab bl bi"><span class="bn xi">Follow</span></span></button></div></div></div></div></div></div><div class="ss m"><div class="st bi s rd"></div><div class="ac ci"><div class="cp bi gq gr gs gt"><div class="ac r cw"><h2 class="bg sc mw my mz na nc nd ne ng nh ni nk nl nm no np bl">No responses yet</h2><div class="ac su"><div><div class="bn" aria-describedby="15" aria-labelledby="15" role="tooltip"><div tabindex="-1" class="bf"><a class="sv sw" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--e6c94e55a9ad---------------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" aria-label="Shield with a checkmark" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div></div><div class="sx sy sz ta tb m"><div><div class="bg b bh ab bl"><div class="wg"><div class="wo m"><div class="wp ac r"><div class="m fr"><img alt="" class="m fk by bz ca de" width="32" height="32" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fill:32:32/1*dmbNkD5D-u45r44go_cf0g.png"><div class="gj by m bz ca fw o ak rs"></div></div><div class="bo ac cu cv ci"><p class="bg b bh ab eb">Write a response</p></div></div><div class="de bq ac cv wh wi"><div class="ac cv fr"><span data-dd-action-name="Susi presentation tracker respond_sidebar"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fjonny-johnson.medium.com%2Frefining-detection-new-perspectives-on-etw-patching-telemetry-e6c94e55a9ad&amp;source=---post_responses--e6c94e55a9ad---------------------respond_sidebar------------------" rel="noopener follow"><div class="uj m"><p class="bg b bh ab eb">What are your thoughts?</p></div></a></span><div class="cw wj eb ac wk vk wl"><span class="bg b bh ab eb"><div class="ac"><div><div class="bn" aria-describedby="28" aria-labelledby="28" role="tooltip"><div tabindex="-1" class="bf"><span role="button" aria-label="Bold (⌘B)" class="wq wr ws wt bq lu ci wu wv ww" tabindex="0"><svg width="21" height="21"><path fill-rule="evenodd" d="M10.308 17.993h-5.92l.11-.894.783-.12c.56-.11.79-.224.79-.448V5.37c0-.225-.113-.336-.902-.448H4.5l-.114-.894h6.255c4.02 0 5.58 1.23 5.58 3.13 0 1.896-1.78 3.125-3.79 3.463v.11c2.69.34 4.25 1.56 4.25 3.57 0 2.35-2.01 3.69-6.37 3.69l.02.01h-.02zm-.335-12.96H8.967V10.5h1.23c1.788 0 2.79-1.23 2.79-2.683 0-1.685-1.004-2.803-3.006-2.803v.02zm-.223 6.36h-.783v5.588l1.225.23h.22c1.67 0 3.01-1.004 3.01-2.792 0-2.122-1.566-3.016-3.69-3.016h.018z"></path></svg></span></div></div></div><div><div class="bn" aria-describedby="29" aria-labelledby="29" role="tooltip"><div tabindex="-1" class="bf"><span role="button" aria-label="Italic (⌘I)" class="wq wr ws wt bq lu ci wu wv ww" tabindex="0"><svg width="21" height="21"><path fill-rule="evenodd" d="M9.847 18.04c-.533 0-2.027-.64-1.92-.853l2.027-7.68-.64-.214-1.387 1.494-.427-.427c.534-1.173 1.707-2.667 2.774-2.667.533 0 2.24.534 2.133.854l-2.133 7.786.533.214 1.6-1.067.427.427c-.64 1.066-1.92 2.133-2.987 2.133m2.347-11.733c-.96 0-1.387-.64-1.387-1.387 0-1.067.747-1.92 1.493-1.92.854 0 1.387.64 1.387 1.493-.107 1.067-.747 1.814-1.493 1.814"></path></svg></span></div></div></div></div></span><div class="wm rv ac wk vk wl"><div class="wn"><button class="bg b ec ab bl wx wy wz xa lt lp vb fc fd fe xb xc xd fh fi fj fk bn fl fm" data-testid="CancelResponseButton">Cancel</button></div><button class="bg b ec ab uw wx ux uy uz va vb fc fd vc vd ve fh fi fj fk bn fl fm" disabled="" data-testid="ResponseRespondButton">Respond</button></div></div></div></div></div></div></div></div></div></div></div></div><div class="tc td te tf tg m bx"><div class="ac ci"><div class="cp bi gq gr gs gt"><div class="xm xn dt du dv sr m"><h2 class="bg sc mw my mz na nc nd ne ng nh ni nk nl nm no np bl">More from Jonathan Johnson</h2></div><div class="xo ac kr ji xp xq xr xs xt xu xv xw xx xy xz ya yb yc yd"><div class="ye yf yg sa yh yi yj rz yk yl ym yn yo yp yq yr ys yt yu yv yw"><div class="yx yy yz za zb ed m"><article class="ed" data-testid="post-preview"><div class="ed qs m"><div class="bi ed"><div class="ed m"><div class="fr ed zc zd ze zf zg zh zi zj zk zl zm zn zo" role="link" data-href="https://jonny-johnson.medium.com/understanding-etw-patching-9f5af87f9d7b" tabindex="0"><div class="zp"><div aria-label="Understanding ETW Patching"><div class="zr zs zt zu cc"><img alt="Understanding ETW Patching" class="bi zv zw zx bx" loading="lazy" src="https://miro.medium.com/v2/resize:fit:679/format:webp/0*Bz0rLE2iCu65PdiK"></div></div></div><div class="zq ac ci cv"><div class="ac cv we bi zy zz aba abb"><div class="abc abd abe abf abg ac r"><div class="qj m"><div class="m"><div><div class="m" aria-describedby="72" aria-labelledby="72" role="tooltip"><div tabindex="-1" class="bf"><a tabindex="-1" rel="noopener follow" href="https://jonny-johnson.medium.com/?source=post_page---author_recirc--e6c94e55a9ad----0---------------------c38170ad_9c2f_4e19_bacf_0d3edb5c8216--------------" data-discover="true"><div class="m fr"><img alt="Jonathan Johnson" class="m fk by abh abi de" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:20:20/1*ro6iOomAZwYlmMgljL7EfA.png"><div class="gj by m abh abi fw o ak gk"></div></div></a></div></div></div></div></div><div><div class="m" aria-describedby="73" aria-labelledby="73" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at jg ac r" rel="noopener follow" href="https://jonny-johnson.medium.com/?source=post_page---author_recirc--e6c94e55a9ad----0---------------------c38170ad_9c2f_4e19_bacf_0d3edb5c8216--------------" data-discover="true"><p class="bg b ec ab ga abj abk abl abm abn abo abp bl">Jonathan Johnson</p></a></div></div></div></div><div class="abq m abr abs abt abu abv he"><div class="abw abx aby abz aca acb acc acd"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://jonny-johnson.medium.com/understanding-etw-patching-9f5af87f9d7b?source=post_page---author_recirc--e6c94e55a9ad----0---------------------c38170ad_9c2f_4e19_bacf_0d3edb5c8216--------------" data-discover="true"><div title=""><h2 class="bg hm mw my ace acf acg ach aci acj mz na nc ack acl acm acn aco acp nd oc sj acq acr acs act acu acv sk og sl acw acx acy acz ada adb sm ok sn adc add ade adf adg adh so abp bl">Understanding ETW Patching</h2></div><div class="adi m"><h3 class="bg b adj ab ga adk abk abl adl abn abp eb">Introduction</h3></div></a></div></div><span class="bg b ec ab eb"><div class="rq ac cw ag"><div class="ac r ado"><span>Apr 12, 2024</span><div class=""><div class="fr adm do ac r"><div class="fw vk adn ac r ado"><div class="fn do adp m de"></div></div><a class="fw ln adn ac r ado" tabindex="-1" rel="noopener follow" href="https://jonny-johnson.medium.com/understanding-etw-patching-9f5af87f9d7b?source=post_page---author_recirc--e6c94e55a9ad----0---------------------c38170ad_9c2f_4e19_bacf_0d3edb5c8216--------------" data-discover="true"><div><div class="ac" aria-describedby="234" aria-labelledby="234" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r adt"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>110</span></div></div></div></div></a></div></div></div></div></span><div class="k j e"><div class="st bi th lr"></div></div></div></div></div></div></div></div></article></div></div><div class="ye yf yg sa yh yi yj rz yk yl ym yn yo yp yq yr ys yt yu yv yw"><div class="yx yy yz za zb ed m"><article class="ed" data-testid="post-preview"><div class="ed qs m"><div class="bi ed"><div class="ed m"><div class="fr ed zc zd ze zf zg zh zi zj zk zl zm zn zo" role="link" data-href="https://jonny-johnson.medium.com/understanding-telemetry-kernel-callbacks-1a97cfcb8fb3" tabindex="0"><div class="zp"><div aria-label="Understanding Telemetry: Kernel Callbacks"><div class="zr zs zt zu cc"><img alt="Understanding Telemetry: Kernel Callbacks" class="bi zv zw zx bx" loading="lazy" src="https://miro.medium.com/v2/resize:fit:679/format:webp/1*xi5rSD9TBGupTx7BSeQclA.png"></div></div></div><div class="zq ac ci cv"><div class="ac cv we bi zy zz aba abb"><div class="abc abd abe abf abg ac r"><div class="qj m"><div class="m"><div><div class="m" aria-describedby="75" aria-labelledby="75" role="tooltip"><div tabindex="-1" class="bf"><a tabindex="-1" rel="noopener follow" href="https://jonny-johnson.medium.com/?source=post_page---author_recirc--e6c94e55a9ad----1---------------------c38170ad_9c2f_4e19_bacf_0d3edb5c8216--------------" data-discover="true"><div class="m fr"><img alt="Jonathan Johnson" class="m fk by abh abi de" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:20:20/1*ro6iOomAZwYlmMgljL7EfA.png"><div class="gj by m abh abi fw o ak gk"></div></div></a></div></div></div></div></div><div><div class="m" aria-describedby="76" aria-labelledby="76" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at jg ac r" rel="noopener follow" href="https://jonny-johnson.medium.com/?source=post_page---author_recirc--e6c94e55a9ad----1---------------------c38170ad_9c2f_4e19_bacf_0d3edb5c8216--------------" data-discover="true"><p class="bg b ec ab ga abj abk abl abm abn abo abp bl">Jonathan Johnson</p></a></div></div></div></div><div class="abq m abr abs abt abu abv he"><div class="abw abx aby abz aca acb acc acd"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://jonny-johnson.medium.com/understanding-telemetry-kernel-callbacks-1a97cfcb8fb3?source=post_page---author_recirc--e6c94e55a9ad----1---------------------c38170ad_9c2f_4e19_bacf_0d3edb5c8216--------------" data-discover="true"><div title=""><h2 class="bg hm mw my ace acf acg ach aci acj mz na nc ack acl acm acn aco acp nd oc sj acq acr acs act acu acv sk og sl acw acx acy acz ada adb sm ok sn adc add ade adf adg adh so abp bl">Understanding Telemetry: Kernel Callbacks</h2></div><div class="adi m"><h3 class="bg b adj ab ga adk abk abl adl abn abp eb">Introduction</h3></div></a></div></div><span class="bg b ec ab eb"><div class="rq ac cw ag"><div class="ac r ado"><span>Jun 12, 2023</span><div class=""><div class="fr adm do ac r"><div class="fw vk adn ac r ado"><div class="fn do adp m de"></div></div><a class="fw ln adn ac r ado" tabindex="-1" rel="noopener follow" href="https://jonny-johnson.medium.com/understanding-telemetry-kernel-callbacks-1a97cfcb8fb3?source=post_page---author_recirc--e6c94e55a9ad----1---------------------c38170ad_9c2f_4e19_bacf_0d3edb5c8216--------------" data-discover="true"><div><div class="ac" aria-describedby="235" aria-labelledby="235" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r adt"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>7</span></div></div></div></div></a></div></div></div></div></span><div class="k j e"><div class="st bi th lr"></div></div></div></div></div></div></div></div></article></div></div><div class="ye yf yg sa yh yi yj rz yk yl ym yn yo yp yq yr ys yt yu yv yw"><div class="yx yy yz za zb ed m"><article class="ed" data-testid="post-preview"><div class="ed qs m"><div class="bi ed"><div class="ed m"><div class="fr ed zc zd ze zf zg zh zi zj zk zl zm zn zo" role="link" data-href="https://jonny-johnson.medium.com/wmi-internals-part-1-41bb97e7f5eb" tabindex="0"><div class="zp"><div aria-label="WMI Internals Part 1"><div class="zr zs zt zu cc"><img alt="WMI Internals Part 1" class="bi zv zw zx bx" loading="lazy" src="https://miro.medium.com/v2/resize:fit:679/format:webp/0*4yL5BkWjyOpksUzx"></div></div></div><div class="zq ac ci cv"><div class="ac cv we bi zy zz aba abb"><div class="abc abd abe abf abg ac r"><div class="qj m"><div class="m"><div><div class="m" aria-describedby="78" aria-labelledby="78" role="tooltip"><div tabindex="-1" class="bf"><a tabindex="-1" rel="noopener follow" href="https://jonny-johnson.medium.com/?source=post_page---author_recirc--e6c94e55a9ad----2---------------------c38170ad_9c2f_4e19_bacf_0d3edb5c8216--------------" data-discover="true"><div class="m fr"><img alt="Jonathan Johnson" class="m fk by abh abi de" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:20:20/1*ro6iOomAZwYlmMgljL7EfA.png"><div class="gj by m abh abi fw o ak gk"></div></div></a></div></div></div></div></div><div><div class="m" aria-describedby="79" aria-labelledby="79" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at jg ac r" rel="noopener follow" href="https://jonny-johnson.medium.com/?source=post_page---author_recirc--e6c94e55a9ad----2---------------------c38170ad_9c2f_4e19_bacf_0d3edb5c8216--------------" data-discover="true"><p class="bg b ec ab ga abj abk abl abm abn abo abp bl">Jonathan Johnson</p></a></div></div></div></div><div class="abq m abr abs abt abu abv he"><div class="abw abx aby abz aca acb acc acd"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://jonny-johnson.medium.com/wmi-internals-part-1-41bb97e7f5eb?source=post_page---author_recirc--e6c94e55a9ad----2---------------------c38170ad_9c2f_4e19_bacf_0d3edb5c8216--------------" data-discover="true"><div title=""><h2 class="bg hm mw my ace acf acg ach aci acj mz na nc ack acl acm acn aco acp nd oc sj acq acr acs act acu acv sk og sl acw acx acy acz ada adb sm ok sn adc add ade adf adg adh so abp bl">WMI Internals Part 1</h2></div><div class="adi m"><h3 class="bg b adj ab ga adk abk abl adl abn abp eb">Understanding the Basics</h3></div></a></div></div><span class="bg b ec ab eb"><div class="rq ac cw ag"><div class="ac r ado"><span>Jul 5, 2022</span><div class=""><div class="fr adm do ac r"><div class="fw vk adn ac r ado"><div class="fn do adp m de"></div></div><a class="fw ln adn ac r ado" tabindex="-1" rel="noopener follow" href="https://jonny-johnson.medium.com/wmi-internals-part-1-41bb97e7f5eb?source=post_page---author_recirc--e6c94e55a9ad----2---------------------c38170ad_9c2f_4e19_bacf_0d3edb5c8216--------------" data-discover="true"><div><div class="ac" aria-describedby="236" aria-labelledby="236" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r adt"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>55</span></div></div></div></div><div><div class="ac" aria-describedby="80" aria-labelledby="80" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r adt"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#6B6B6B" aria-labelledby="response-filled-16px-desc" viewBox="0 0 16 16"><desc id="response-filled-16px-desc">A response icon</desc><path fill="#6B6B6B" d="M12.344 11.458A5.28 5.28 0 0 0 14 7.526C14 4.483 11.391 2 8.051 2S2 4.483 2 7.527c0 3.051 2.712 5.526 6.059 5.526a6.6 6.6 0 0 0 1.758-.236q.255.223.554.414c.784.51 1.626.768 2.512.768a.37.37 0 0 0 .355-.214.37.37 0 0 0-.03-.384 4.7 4.7 0 0 1-.857-1.958v.014z"></path></svg><span>1</span></div></div></div></div></a></div></div></div></div></span><div class="k j e"><div class="st bi th lr"></div></div></div></div></div></div></div></div></article></div></div><div class="ye yf yg sa yh yi yj rz yk yl ym yn yo yp yq yr ys yt yu yv yw"><div class="yx yy yz za zb ed m"><article class="ed" data-testid="post-preview"><div class="ed qs m"><div class="bi ed"><div class="ed m"><div class="fr ed zc zd ze zf zg zh zi zj zk zl zm zn zo" role="link" data-href="https://jonny-johnson.medium.com/uncovering-windows-events-b4b9db7eac54" tabindex="0"><div class="zp"><div aria-label="Uncovering Windows Events"><div class="zr zs zt zu cc"><img alt="Uncovering Windows Events" class="bi zv zw zx bx" loading="lazy" src="https://miro.medium.com/v2/resize:fit:679/format:webp/0*1WyzENPfD3ip59cm"></div></div></div><div class="zq ac ci cv"><div class="ac cv we bi zy zz aba abb"><div class="abc abd abe abf abg ac r"><div class="qj m"><div class="m"><div><div class="m" aria-describedby="82" aria-labelledby="82" role="tooltip"><div tabindex="-1" class="bf"><a tabindex="-1" rel="noopener follow" href="https://jonny-johnson.medium.com/?source=post_page---author_recirc--e6c94e55a9ad----3---------------------c38170ad_9c2f_4e19_bacf_0d3edb5c8216--------------" data-discover="true"><div class="m fr"><img alt="Jonathan Johnson" class="m fk by abh abi de" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:20:20/1*ro6iOomAZwYlmMgljL7EfA.png"><div class="gj by m abh abi fw o ak gk"></div></div></a></div></div></div></div></div><div><div class="m" aria-describedby="83" aria-labelledby="83" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at jg ac r" rel="noopener follow" href="https://jonny-johnson.medium.com/?source=post_page---author_recirc--e6c94e55a9ad----3---------------------c38170ad_9c2f_4e19_bacf_0d3edb5c8216--------------" data-discover="true"><p class="bg b ec ab ga abj abk abl abm abn abo abp bl">Jonathan Johnson</p></a></div></div></div></div><div class="abq m abr abs abt abu abv he"><div class="abw abx aby abz aca acb acc acd"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="https://jonny-johnson.medium.com/uncovering-windows-events-b4b9db7eac54?source=post_page---author_recirc--e6c94e55a9ad----3---------------------c38170ad_9c2f_4e19_bacf_0d3edb5c8216--------------" data-discover="true"><div title=""><h2 class="bg hm mw my ace acf acg ach aci acj mz na nc ack acl acm acn aco acp nd oc sj acq acr acs act acu acv sk og sl acw acx acy acz ada adb sm ok sn adc add ade adf adg adh so abp bl">Uncovering Windows Events</h2></div><div class="adi m"><h3 class="bg b adj ab ga adk abk abl adl abn abp eb">Threat Intelligence ETW</h3></div></a></div></div><span class="bg b ec ab eb"><div class="rq ac cw ag"><div class="ac r ado"><span>Mar 15, 2023</span><div class=""><div class="fr adm do ac r"><div class="fw vk adn ac r ado"><div class="fn do adp m de"></div></div><a class="fw ln adn ac r ado" tabindex="-1" rel="noopener follow" href="https://jonny-johnson.medium.com/uncovering-windows-events-b4b9db7eac54?source=post_page---author_recirc--e6c94e55a9ad----3---------------------c38170ad_9c2f_4e19_bacf_0d3edb5c8216--------------" data-discover="true"><div><div class="ac" aria-describedby="238" aria-labelledby="238" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r adt"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>34</span></div></div></div></div><div><div class="ac" aria-describedby="84" aria-labelledby="84" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r adt"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#6B6B6B" aria-labelledby="response-filled-16px-desc" viewBox="0 0 16 16"><desc id="response-filled-16px-desc">A response icon</desc><path fill="#6B6B6B" d="M12.344 11.458A5.28 5.28 0 0 0 14 7.526C14 4.483 11.391 2 8.051 2S2 4.483 2 7.527c0 3.051 2.712 5.526 6.059 5.526a6.6 6.6 0 0 0 1.758-.236q.255.223.554.414c.784.51 1.626.768 2.512.768a.37.37 0 0 0 .355-.214.37.37 0 0 0-.03-.384 4.7 4.7 0 0 1-.857-1.958v.014z"></path></svg><span>1</span></div></div></div></div></a></div></div></div></div></span></div></div></div></div></div></div></article></div></div></div><div class="st bi th dr ds adu adv adw"></div><div class="ac rf re ir it iv"><a class="bg b bh ab bl qk wy wz xa lt lp vb fc fd fe xb xc xd fh adx ady adz aea aeb fi fj fk bn fl fm" rel="noopener follow" href="https://jonny-johnson.medium.com/?source=post_page---author_recirc--e6c94e55a9ad---------------------------------------" data-discover="true"><div class="m fm">See all from Jonathan Johnson</div></a></div></div></div><div class="st bi th aec aed aee aef aeg"></div><div class="ac ci"><div class="cp bi gq gr gs gt"><div class="aeh aei m"><h2 class="bg sc mw my mz na nc nd ne ng nh ni nk nl nm no np bl">Recommended from Medium</h2><div class="pd pe pf pg ph m"><div class="xo ac kr ji xp xq xr xs xt xu xv xw xx xy xz ya yb yc yd"><div class="ye yf yg sa yh yi yj rz yk yl ym yn yo yp yq yr ys yt yu yv yw"><div class="yx yy yz za zb ed m"><article class="ed" data-testid="post-preview"><div class="ed qs m"><div class="bi ed"><div class="ed m"><div class="fr ed zc zd ze zf zg zh zi zj zk zl zm zn zo" role="link" data-href="https://medium.com/@luisgerardomoret_69654/modifying-godpotato-to-evade-antivirus-f066aa779cf9" tabindex="0"><div class="zp"><div aria-label="Modifying GodPotato to Evade Antivirus"><div class="zr zs zt zu cc"><img alt="Modifying GodPotato to Evade Antivirus" class="bi zv zw zx bx" loading="lazy" src="https://miro.medium.com/v2/resize:fit:679/format:webp/1*ZBfU29N4K48f1_FpL9HHCA.png"></div></div></div><div class="zq ac ci cv"><div class="ac cv we bi zy zz aba abb"><div class="abc abd abe abf abg ac r"><div class="qj m"><div class="m"><div><div class="m" aria-describedby="86" aria-labelledby="86" role="tooltip"><div tabindex="-1" class="bf"><a tabindex="-1" href="https://medium.com/@luisgerardomoret_69654?source=post_page---read_next_recirc--e6c94e55a9ad----0---------------------c9c81c35_aa82_4294_8d6a_3ad5637d8aa6--------------" rel="noopener follow"><div class="m fr"><img alt="lainkusanagi" class="m fk by abh abi de" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:20:20/1*VzJHRBQO-U0LwAINk4bE1A.png"><div class="gj by m abh abi fw o ak gk"></div></div></a></div></div></div></div></div><div><div class="m" aria-describedby="87" aria-labelledby="87" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at jg ac r" href="https://medium.com/@luisgerardomoret_69654?source=post_page---read_next_recirc--e6c94e55a9ad----0---------------------c9c81c35_aa82_4294_8d6a_3ad5637d8aa6--------------" rel="noopener follow"><p class="bg b ec ab ga abj abk abl abm abn abo abp bl">lainkusanagi</p></a></div></div></div></div><div class="abq m abr abs abt abu abv he"><div class="abw abx aby abz aca acb acc acd"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://medium.com/@luisgerardomoret_69654/modifying-godpotato-to-evade-antivirus-f066aa779cf9?source=post_page---read_next_recirc--e6c94e55a9ad----0---------------------c9c81c35_aa82_4294_8d6a_3ad5637d8aa6--------------" rel="noopener follow"><div title=""><h2 class="bg hm mw my ace acf acg ach aci acj mz na nc ack acl acm acn aco acp nd oc sj acq acr acs act acu acv sk og sl acw acx acy acz ada adb sm ok sn adc add ade adf adg adh so abp bl">Modifying GodPotato to Evade Antivirus</h2></div><div class="adi m"><h3 class="bg b adj ab ga adk abk abl adl abn abp eb">Friend link if you aren’t a medium member</h3></div></a></div></div><span class="bg b ec ab eb"><div class="rq ac cw ag"><div class="ac r ado"><div class="qs ac"><button class="m ak aq ao" aria-label="Member-only story"><div class=""><div><div class="bn" aria-describedby="88" aria-labelledby="88" role="tooltip"><div tabindex="-1" class="bf"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 64 64"><path fill="#FFC017" d="m39.637 40.831-5.771 15.871a1.99 1.99 0 0 1-3.732 0l-5.771-15.87a2.02 2.02 0 0 0-1.194-1.195L7.298 33.866a1.99 1.99 0 0 1 0-3.732l15.87-5.771a2.02 2.02 0 0 0 1.195-1.194l5.771-15.871a1.99 1.99 0 0 1 3.732 0l5.771 15.87a2.02 2.02 0 0 0 1.194 1.195l15.871 5.771a1.99 1.99 0 0 1 0 3.732l-15.87 5.771a2.02 2.02 0 0 0-1.195 1.194"></path></svg></div></div></div></div></button></div><span>Nov 7, 2025</span><div class=""><div class="fr adm do ac r"><div class="fw vk adn ac r ado"><div class="fn do adp m de"></div></div><a class="fw ln adn ac r ado" tabindex="-1" href="https://medium.com/@luisgerardomoret_69654/modifying-godpotato-to-evade-antivirus-f066aa779cf9?source=post_page---read_next_recirc--e6c94e55a9ad----0---------------------c9c81c35_aa82_4294_8d6a_3ad5637d8aa6--------------" rel="noopener follow"><div><div class="ac" aria-describedby="240" aria-labelledby="240" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r adt"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>114</span></div></div></div></div></a></div></div></div></div></span><div class="k j e"><div class="st bi th lr"></div></div></div></div></div></div></div></div></article></div></div><div class="ye yf yg sa yh yi yj rz yk yl ym yn yo yp yq yr ys yt yu yv yw"><div class="yx yy yz za zb ed m"><article class="ed" data-testid="post-preview"><div class="ed qs m"><div class="bi ed"><div class="ed m"><div class="fr ed zc zd ze zf zg zh zi zj zk zl zm zn zo" role="link" data-href="https://medium.com/@RootRouteway/breaking-boundaries-mastering-windows-privilege-escalation-with-boxes-1ec73145f972" tabindex="0"><div class="zp"><div aria-label="Breaking Boundaries: Mastering Windows Privilege Escalation with Boxes"><div class="zr zs zt zu cc"><img alt="Breaking Boundaries: Mastering Windows Privilege Escalation with Boxes" class="bi zv zw zx bx" loading="lazy" src="https://miro.medium.com/v2/resize:fit:679/format:webp/1*IgYHuhuq4NtiYuAm9xJOSQ.jpeg"></div></div></div><div class="zq ac ci cv"><div class="ac cv we bi zy zz aba abb"><div class="abc abd abe abf abg ac r"><div class="qj m"><div class="m"><div><div class="m" aria-describedby="90" aria-labelledby="90" role="tooltip"><div tabindex="-1" class="bf"><a tabindex="-1" href="https://medium.com/@RootRouteway?source=post_page---read_next_recirc--e6c94e55a9ad----1---------------------c9c81c35_aa82_4294_8d6a_3ad5637d8aa6--------------" rel="noopener follow"><div class="m fr"><img alt="RootRouteway" class="m fk by abh abi de" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:20:20/1*1NJ0Ca228T14MgWbflZ3IA.jpeg"><div class="gj by m abh abi fw o ak gk"></div></div></a></div></div></div></div></div><div><div class="m" aria-describedby="91" aria-labelledby="91" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at jg ac r" href="https://medium.com/@RootRouteway?source=post_page---read_next_recirc--e6c94e55a9ad----1---------------------c9c81c35_aa82_4294_8d6a_3ad5637d8aa6--------------" rel="noopener follow"><p class="bg b ec ab ga abj abk abl abm abn abo abp bl">RootRouteway</p></a></div></div></div></div><div class="abq m abr abs abt abu abv he"><div class="abw abx aby abz aca acb acc acd"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://medium.com/@RootRouteway/breaking-boundaries-mastering-windows-privilege-escalation-with-boxes-1ec73145f972?source=post_page---read_next_recirc--e6c94e55a9ad----1---------------------c9c81c35_aa82_4294_8d6a_3ad5637d8aa6--------------" rel="noopener follow"><div title=""><h2 class="bg hm mw my ace acf acg ach aci acj mz na nc ack acl acm acn aco acp nd oc sj acq acr acs act acu acv sk og sl acw acx acy acz ada adb sm ok sn adc add ade adf adg adh so abp bl">Breaking Boundaries: Mastering Windows Privilege Escalation with Boxes</h2></div><div class="adi m"><h3 class="bg b adj ab ga adk abk abl adl abn abp eb">In today’s security landscape, gaining and maintaining system access is only part of the story — understanding how privileges are…</h3></div></a></div></div><span class="bg b ec ab eb"><div class="rq ac cw ag"><div class="ac r ado"><span>Nov 9, 2025</span><div class=""><div class="fr adm do ac r"><div class="fw vk adn ac r ado"><div class="fn do adp m de"></div></div><a class="fw ln adn ac r ado" tabindex="-1" href="https://medium.com/@RootRouteway/breaking-boundaries-mastering-windows-privilege-escalation-with-boxes-1ec73145f972?source=post_page---read_next_recirc--e6c94e55a9ad----1---------------------c9c81c35_aa82_4294_8d6a_3ad5637d8aa6--------------" rel="noopener follow"><div><div class="ac" aria-describedby="241" aria-labelledby="241" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r adt"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>9</span></div></div></div></div><div><div class="ac" aria-describedby="92" aria-labelledby="92" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r adt"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#6B6B6B" aria-labelledby="response-filled-16px-desc" viewBox="0 0 16 16"><desc id="response-filled-16px-desc">A response icon</desc><path fill="#6B6B6B" d="M12.344 11.458A5.28 5.28 0 0 0 14 7.526C14 4.483 11.391 2 8.051 2S2 4.483 2 7.527c0 3.051 2.712 5.526 6.059 5.526a6.6 6.6 0 0 0 1.758-.236q.255.223.554.414c.784.51 1.626.768 2.512.768a.37.37 0 0 0 .355-.214.37.37 0 0 0-.03-.384 4.7 4.7 0 0 1-.857-1.958v.014z"></path></svg><span>2</span></div></div></div></div></a></div></div></div></div></span></div></div></div></div></div></div></article></div></div></div></div><div class="xo ac kr ji xp xq xr xs xt xu xv xw xx xy xz ya yb yc yd"><div class="ye yf yg sa yh yi yj rz yk yl ym yn yo yp yq yr ys yt yu yv yw"><div class="yx yy yz za zb ed m"><article class="ed" data-testid="post-preview"><div class="ed qs m"><div class="bi ed"><div class="ed m"><div class="fr ed zc zd ze zf zg zh zi zj zk zl zm zn zo" role="link" data-href="https://medium.verylazytech.com/13-techniques-to-stay-undetected-in-corporate-networks-master-stealthy-pentesting-like-a-pro-4a70120a9062" tabindex="0"><div class="zp"><div aria-label="13 Techniques to Stay Undetected in Corporate Networks: Master Stealthy Pentesting Like a Pro"><div class="zr zs zt zu cc"><img alt="13 Techniques to Stay Undetected in Corporate Networks: Master Stealthy Pentesting Like a Pro" class="bi zv zw zx bx" loading="lazy" src="https://miro.medium.com/v2/resize:fit:679/format:webp/0*3RDWm05NbqoVf-Bd"></div></div></div><div class="zq ac ci cv"><div class="ac cv we bi zy zz aba abb"><div class="abc abd abe abf abg ac r"><div class="qj m"><div class="m"><div><div class="m" aria-describedby="94" aria-labelledby="94" role="tooltip"><div tabindex="-1" class="bf"><a tabindex="-1" href="https://medium.verylazytech.com/?source=post_page---read_next_recirc--e6c94e55a9ad----0---------------------c9c81c35_aa82_4294_8d6a_3ad5637d8aa6--------------" rel="noopener follow"><div class="m fr"><img alt="Very Lazy Tech 👾" class="m fk by abh abi de" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:20:20/1*cQVMEaLp7npt5Gw9hUV7aQ.png"><div class="gj by m abh abi fw o ak gk"></div></div></a></div></div></div></div></div><div><div class="m" aria-describedby="95" aria-labelledby="95" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at jg ac r" href="https://medium.verylazytech.com/?source=post_page---read_next_recirc--e6c94e55a9ad----0---------------------c9c81c35_aa82_4294_8d6a_3ad5637d8aa6--------------" rel="noopener follow"><p class="bg b ec ab ga abj abk abl abm abn abo abp bl">Very Lazy Tech 👾</p></a></div></div></div></div><div class="abq m abr abs abt abu abv he"><div class="abw abx aby abz aca acb acc acd"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://medium.verylazytech.com/13-techniques-to-stay-undetected-in-corporate-networks-master-stealthy-pentesting-like-a-pro-4a70120a9062?source=post_page---read_next_recirc--e6c94e55a9ad----0---------------------c9c81c35_aa82_4294_8d6a_3ad5637d8aa6--------------" rel="noopener follow"><div title="13 Techniques to Stay Undetected in Corporate Networks: Master Stealthy Pentesting Like a Pro"><h2 class="bg hm mw my ace acf acg ach aci acj mz na nc ack acl acm acn aco acp nd oc sj acq acr acs act acu acv sk og sl acw acx acy acz ada adb sm ok sn adc add ade adf adg adh so abp bl">13 Techniques to Stay Undetected in Corporate Networks: Master Stealthy Pentesting Like a Pro</h2></div><div class="adi m"><h3 class="bg b adj ab ga adk abk abl adl abn abp eb">Why Stealth Matters in Modern Pentesting</h3></div></a></div></div><span class="bg b ec ab eb"><div class="rq ac cw ag"><div class="ac r ado"><div class="qs ac"><button class="m ak aq ao" aria-label="Member-only story"><div class=""><div><div class="bn" aria-describedby="96" aria-labelledby="96" role="tooltip"><div tabindex="-1" class="bf"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 64 64"><path fill="#FFC017" d="m39.637 40.831-5.771 15.871a1.99 1.99 0 0 1-3.732 0l-5.771-15.87a2.02 2.02 0 0 0-1.194-1.195L7.298 33.866a1.99 1.99 0 0 1 0-3.732l15.87-5.771a2.02 2.02 0 0 0 1.195-1.194l5.771-15.871a1.99 1.99 0 0 1 3.732 0l5.771 15.87a2.02 2.02 0 0 0 1.194 1.195l15.871 5.771a1.99 1.99 0 0 1 0 3.732l-15.87 5.771a2.02 2.02 0 0 0-1.195 1.194"></path></svg></div></div></div></div></button></div><span>Feb 1</span><div class=""><div class="fr adm do ac r"><div class="fw vk adn ac r ado"><div class="fn do adp m de"></div></div><a class="fw ln adn ac r ado" tabindex="-1" href="https://medium.verylazytech.com/13-techniques-to-stay-undetected-in-corporate-networks-master-stealthy-pentesting-like-a-pro-4a70120a9062?source=post_page---read_next_recirc--e6c94e55a9ad----0---------------------c9c81c35_aa82_4294_8d6a_3ad5637d8aa6--------------" rel="noopener follow"><div><div class="ac" aria-describedby="243" aria-labelledby="243" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r adt"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>109</span></div></div></div></div></a></div></div></div></div></span><div class="k j e"><div class="st bi th lr"></div></div></div></div></div></div></div></div></article></div></div><div class="ye yf yg sa yh yi yj rz yk yl ym yn yo yp yq yr ys yt yu yv yw"><div class="yx yy yz za zb ed m"><article class="ed" data-testid="post-preview"><div class="ed qs m"><div class="bi ed"><div class="ed m"><div class="fr ed zc zd ze zf zg zh zi zj zk zl zm zn zo" role="link" data-href="https://medium.com/@maxwellcross/30-days-of-red-team-day-14-week-2-integration-lab-f5b1d39d8942" tabindex="0"><div class="zp"><div aria-label="30 Days of Red Team: Day 14 — Week 2 Capstone: Simulating an Advanced Persistent Threat"><div class="zr zs zt zu cc"><img alt="30 Days of Red Team: Day 14 — Week 2 Capstone: Simulating an Advanced Persistent Threat" class="bi zv zw zx bx" loading="lazy" src="https://miro.medium.com/v2/resize:fit:679/format:webp/1*eOObvQTjsbcKb4sKbfPfGA.png"></div></div></div><div class="zq ac ci cv"><div class="ac cv we bi zy zz aba abb"><div class="abc abd abe abf abg ac r"><div class="qj m"><div><div class="m" aria-describedby="98" aria-labelledby="98" role="tooltip"><div tabindex="-1" class="bf"><a href="https://medium.com/30-days-of-red-team?source=post_page---read_next_recirc--e6c94e55a9ad----1---------------------c9c81c35_aa82_4294_8d6a_3ad5637d8aa6--------------" rel="noopener follow"><div class="fr"><img alt="30 Days of Red Team" class="de aej m abi abh" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:20:20/1*mDDxZ8b9SAK4X34fO8PVLQ.png"><div class="aej m abh abi fw o gj gk"></div></div></a></div></div></div></div><div class="sb m gc"><p class="bg b ec ab eb">In</p></div><div class="m"><div><div class="m" aria-describedby="99" aria-labelledby="99" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at jg ac r" href="https://medium.com/30-days-of-red-team?source=post_page---read_next_recirc--e6c94e55a9ad----1---------------------c9c81c35_aa82_4294_8d6a_3ad5637d8aa6--------------" rel="noopener follow"><p class="bg b ec ab ga abj abk abl abm abn abo abp bl">30 Days of Red Team</p></a></div></div></div></div><div class="aek m"><p class="bg b ec ab eb">by</p></div><div><div class="m" aria-describedby="100" aria-labelledby="100" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at jg ac r" href="https://medium.com/@maxwellcross?source=post_page---read_next_recirc--e6c94e55a9ad----1---------------------c9c81c35_aa82_4294_8d6a_3ad5637d8aa6--------------" rel="noopener follow"><p class="bg b ec ab ga abj abk abl abm abn abo abp bl">Maxwell Cross</p></a></div></div></div></div><div class="abq m abr abs abt abu abv he"><div class="abw abx aby abz aca acb acc acd"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://medium.com/@maxwellcross/30-days-of-red-team-day-14-week-2-integration-lab-f5b1d39d8942?source=post_page---read_next_recirc--e6c94e55a9ad----1---------------------c9c81c35_aa82_4294_8d6a_3ad5637d8aa6--------------" rel="noopener follow"><div title="30 Days of Red Team: Day 14 — Week 2 Capstone: Simulating an Advanced Persistent Threat"><h2 class="bg hm mw my ace acf acg ach aci acj mz na nc ack acl acm acn aco acp nd oc sj acq acr acs act acu acv sk og sl acw acx acy acz ada adb sm ok sn adc add ade adf adg adh so abp bl">30 Days of Red Team: Day 14 — Week 2 Capstone: Simulating an Advanced Persistent Threat</h2></div><div class="adi m"><h3 class="bg b adj ab ga adk abk abl adl abn abp eb">The complete lifecycle: Deploying resilient C2, establishing persistence, and exfiltrating data while maintaining strict OPSEC discipline.</h3></div></a></div></div><span class="bg b ec ab eb"><div class="rq ac cw ag"><div class="ac r ado"><div class="qs ac"><button class="m ak aq ao" aria-label="Member-only story"><div class=""><div><div class="bn" aria-describedby="101" aria-labelledby="101" role="tooltip"><div tabindex="-1" class="bf"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 64 64"><path fill="#FFC017" d="m39.637 40.831-5.771 15.871a1.99 1.99 0 0 1-3.732 0l-5.771-15.87a2.02 2.02 0 0 0-1.194-1.195L7.298 33.866a1.99 1.99 0 0 1 0-3.732l15.87-5.771a2.02 2.02 0 0 0 1.195-1.194l5.771-15.871a1.99 1.99 0 0 1 3.732 0l5.771 15.87a2.02 2.02 0 0 0 1.194 1.195l15.871 5.771a1.99 1.99 0 0 1 0 3.732l-15.87 5.771a2.02 2.02 0 0 0-1.195 1.194"></path></svg></div></div></div></div></button></div><span>Jan 10</span><div class=""><div class="fr adm do ac r"><div class="fw vk adn ac r ado"><div class="fn do adp m de"></div></div><a class="fw ln adn ac r ado" tabindex="-1" href="https://medium.com/@maxwellcross/30-days-of-red-team-day-14-week-2-integration-lab-f5b1d39d8942?source=post_page---read_next_recirc--e6c94e55a9ad----1---------------------c9c81c35_aa82_4294_8d6a_3ad5637d8aa6--------------" rel="noopener follow"><div><div class="ac" aria-describedby="244" aria-labelledby="244" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r adt"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>4</span></div></div></div></div></a></div></div></div></div></span><div class="k j e"><div class="st bi th lr"></div></div></div></div></div></div></div></div></article></div></div><div class="ye yf yg sa yh yi yj rz yk yl ym yn yo yp yq yr ys yt yu yv yw"><div class="yx yy yz za zb ed m"><article class="ed" data-testid="post-preview"><div class="ed qs m"><div class="bi ed"><div class="ed m"><div class="fr ed zc zd ze zf zg zh zi zj zk zl zm zn zo" role="link" data-href="https://medium.com/@taylorgehrlein/adversary-emulation-for-detection-engineering-d816b4e0c734" tabindex="0"><div class="zp"><div aria-label="Adversary Emulation for Detection Engineering"><div class="zr zs zt zu cc"><img alt="Adversary Emulation for Detection Engineering" class="bi zv zw zx bx" loading="lazy" src="https://miro.medium.com/v2/resize:fit:679/format:webp/1*OV-vma4qKRvWt0dwmjkRng.png"></div></div></div><div class="zq ac ci cv"><div class="ac cv we bi zy zz aba abb"><div class="abc abd abe abf abg ac r"><div class="qj m"><div class="m"><div><div class="m" aria-describedby="103" aria-labelledby="103" role="tooltip"><div tabindex="-1" class="bf"><a tabindex="-1" href="https://medium.com/@taylorgehrlein?source=post_page---read_next_recirc--e6c94e55a9ad----2---------------------c9c81c35_aa82_4294_8d6a_3ad5637d8aa6--------------" rel="noopener follow"><div class="m fr"><img alt="Taylor Gehrlein" class="m fk by abh abi de" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:20:20/1*mMvMz0GDgPifRdqKsKWU1g.png"><div class="gj by m abh abi fw o ak gk"></div></div></a></div></div></div></div></div><div><div class="m" aria-describedby="104" aria-labelledby="104" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at jg ac r" href="https://medium.com/@taylorgehrlein?source=post_page---read_next_recirc--e6c94e55a9ad----2---------------------c9c81c35_aa82_4294_8d6a_3ad5637d8aa6--------------" rel="noopener follow"><p class="bg b ec ab ga abj abk abl abm abn abo abp bl">Taylor Gehrlein</p></a></div></div></div></div><div class="abq m abr abs abt abu abv he"><div class="abw abx aby abz aca acb acc acd"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://medium.com/@taylorgehrlein/adversary-emulation-for-detection-engineering-d816b4e0c734?source=post_page---read_next_recirc--e6c94e55a9ad----2---------------------c9c81c35_aa82_4294_8d6a_3ad5637d8aa6--------------" rel="noopener follow"><div title=""><h2 class="bg hm mw my ace acf acg ach aci acj mz na nc ack acl acm acn aco acp nd oc sj acq acr acs act acu acv sk og sl acw acx acy acz ada adb sm ok sn adc add ade adf adg adh so abp bl">Adversary Emulation for Detection Engineering</h2></div><div class="adi m"><h3 class="bg b adj ab ga adk abk abl adl abn abp eb">Adversary emulation- the art of imitating attackers with the goal of shoring up security defenses. Sounds cool and complicated- it can be…</h3></div></a></div></div><span class="bg b ec ab eb"><div class="rq ac cw ag"><div class="ac r ado"><span>Jan 24</span><div class=""><div class="fr adm do ac r"><div class="fw vk adn ac r ado"><div class="fn do adp m de"></div></div><a class="fw ln adn ac r ado" tabindex="-1" href="https://medium.com/@taylorgehrlein/adversary-emulation-for-detection-engineering-d816b4e0c734?source=post_page---read_next_recirc--e6c94e55a9ad----2---------------------c9c81c35_aa82_4294_8d6a_3ad5637d8aa6--------------" rel="noopener follow"><div><div class="ac" aria-describedby="245" aria-labelledby="245" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r adt"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>4</span></div></div></div></div></a></div></div></div></div></span><div class="k j e"><div class="st bi th lr"></div></div></div></div></div></div></div></div></article></div></div><div class="ye yf yg sa yh yi yj rz yk yl ym yn yo yp yq yr ys yt yu yv yw"><div class="yx yy yz za zb ed m"><article class="ed" data-testid="post-preview"><div class="ed qs m"><div class="bi ed"><div class="ed m"><div class="fr ed zc zd ze zf zg zh zi zj zk zl zm zn zo" role="link" data-href="https://justmoii.medium.com/create-your-own-up-to-date-threat-intelligence-9bc7cd8c7085" tabindex="0"><div class="zp"><div aria-label="Create Your Own Up-to-Date Threat Intelligence"><div class="zr zs zt zu cc"><img alt="Create Your Own Up-to-Date Threat Intelligence" class="bi zv zw zx bx" loading="lazy" src="https://miro.medium.com/v2/resize:fit:679/format:webp/1*Sj0AmXp6sDkDFGsz-eSxRQ.png"></div></div></div><div class="zq ac ci cv"><div class="ac cv we bi zy zz aba abb"><div class="abc abd abe abf abg ac r"><div class="qj m"><div><div class="m" aria-describedby="106" aria-labelledby="106" role="tooltip"><div tabindex="-1" class="bf"><a href="https://detect.fyi/?source=post_page---read_next_recirc--e6c94e55a9ad----3---------------------c9c81c35_aa82_4294_8d6a_3ad5637d8aa6--------------" rel="noopener follow"><div class="fr"><img alt="Detect FYI" class="de aej m abi abh" width="20" height="20" loading="lazy" src="https://miro.medium.com/v2/resize:fill:20:20/1*ayMhoNccbO0IxQ1UPFv0SA.png"><div class="aej m abh abi fw o gj gk"></div></div></a></div></div></div></div><div class="sb m gc"><p class="bg b ec ab eb">In</p></div><div class="m"><div><div class="m" aria-describedby="107" aria-labelledby="107" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at jg ac r" href="https://detect.fyi/?source=post_page---read_next_recirc--e6c94e55a9ad----3---------------------c9c81c35_aa82_4294_8d6a_3ad5637d8aa6--------------" rel="noopener follow"><p class="bg b ec ab ga abj abk abl abm abn abo abp bl">Detect FYI</p></a></div></div></div></div><div class="aek m"><p class="bg b ec ab eb">by</p></div><div><div class="m" aria-describedby="108" aria-labelledby="108" role="tooltip"><div tabindex="-1" class="bf"><a class="ah ai aj fo al am an ao ap aq ar as at jg ac r" href="https://justmoii.medium.com/?source=post_page---read_next_recirc--e6c94e55a9ad----3---------------------c9c81c35_aa82_4294_8d6a_3ad5637d8aa6--------------" rel="noopener follow"><p class="bg b ec ab ga abj abk abl abm abn abo abp bl">Just Moi</p></a></div></div></div></div><div class="abq m abr abs abt abu abv he"><div class="abw abx aby abz aca acb acc acd"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://justmoii.medium.com/create-your-own-up-to-date-threat-intelligence-9bc7cd8c7085?source=post_page---read_next_recirc--e6c94e55a9ad----3---------------------c9c81c35_aa82_4294_8d6a_3ad5637d8aa6--------------" rel="noopener follow"><div title=""><h2 class="bg hm mw my ace acf acg ach aci acj mz na nc ack acl acm acn aco acp nd oc sj acq acr acs act acu acv sk og sl acw acx acy acz ada adb sm ok sn adc add ade adf adg adh so abp bl">Create Your Own Up-to-Date Threat Intelligence</h2></div><div class="adi m"><h3 class="bg b adj ab ga adk abk abl adl abn abp eb">What Does This Script Do?</h3></div></a></div></div><span class="bg b ec ab eb"><div class="rq ac cw ag"><div class="ac r ado"><span>Jan 25</span><div class=""><div class="fr adm do ac r"><div class="fw vk adn ac r ado"><div class="fn do adp m de"></div></div><a class="fw ln adn ac r ado" tabindex="-1" href="https://justmoii.medium.com/create-your-own-up-to-date-threat-intelligence-9bc7cd8c7085?source=post_page---read_next_recirc--e6c94e55a9ad----3---------------------c9c81c35_aa82_4294_8d6a_3ad5637d8aa6--------------" rel="noopener follow"><div><div class="ac" aria-describedby="246" aria-labelledby="246" role="tooltip"><div tabindex="-1" class="bf"><div class="ac r adt"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>3</span></div></div></div></div></a></div></div></div></div></span></div></div></div></div></div></div></article></div></div></div><div class="st bi th dr ds adu adv adw"></div><a class="bg b bh ab bl qk wy wz xa lt lp vb fc fd fe xb xc xd fh adx ady adz aea aeb fi fj fk bn fl fm" href="https://medium.com/?source=post_page---read_next_recirc--e6c94e55a9ad---------------------------------------" rel="noopener follow"><div class="m fm">See more recommendations</div></a></div></div></div><div class="i l k"><div class="st bi th ti"></div><div class="ac ci"><div class="cp bi gq gr gs gt"><div class="tj ac kr ji"><div class="tk tl m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://help.medium.com/hc/en-us?source=post_page-----e6c94e55a9ad---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Help</p></a></div><div class="tk tl m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://status.medium.com/?source=post_page-----e6c94e55a9ad---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Status</p></a></div><div class="tk tl m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://medium.com/about?autoplay=1&amp;source=post_page-----e6c94e55a9ad---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">About</p></a></div><div class="tk tl m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----e6c94e55a9ad---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Careers</p></a></div><div class="tk tl m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="mailto:pressinquiries@medium.com" rel="noopener follow"><p class="bg b ec ab eb">Press</p></a></div><div class="tk tl m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://blog.medium.com/?source=post_page-----e6c94e55a9ad---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Blog</p></a></div><div class="tk tl m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e6c94e55a9ad---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Privacy</p></a></div><div class="tk tl m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page-----e6c94e55a9ad---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Rules</p></a></div><div class="tk tl m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e6c94e55a9ad---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Terms</p></a></div><div class="tk m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://speechify.com/medium?source=post_page-----e6c94e55a9ad---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Text to speech</p></a></div></div></div></div></div></div></div></div></div></div></div></div>





































<div height="1" width="1" style="position: absolute; top: 0px; left: 0px; border: none; visibility: hidden;" data-original-tag="iframe"></div>
<div><div class="grecaptcha-badge" data-style="bottomright" style="width: 256px; height: 60px; display: block; transition: right 0.3s; position: fixed; bottom: 14px; right: -186px; box-shadow: gray 0px 0px 5px; border-radius: 2px; overflow: hidden;"><div class="grecaptcha-logo"><div title="reCAPTCHA" width="256" height="60" role="presentation" name="a-gj6yaf5663dy" frameborder="0" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox allow-storage-access-by-user-activation" src="https://www.google.com/recaptcha/enterprise/anchor?ar=1&amp;k=6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp&amp;co=aHR0cHM6Ly9qb25ueS1qb2huc29uLm1lZGl1bS5jb206NDQz&amp;hl=en&amp;v=vUgXt_KV952_-5BB2jjloYzl&amp;size=invisible&amp;anchor-ms=20000&amp;execute-ms=30000&amp;cb=au6m70ju4w8n" data-original-tag="iframe">

<title>reCAPTCHA</title>

<link rel="stylesheet" type="text/css" href="https://www.gstatic.com/recaptcha/releases/vUgXt_KV952_-5BB2jjloYzl/styles__ltr.css">


<div id="rc-anchor-alert" class="rc-anchor-alert"></div>

<div class="rc-anchor rc-anchor-invisible rc-anchor-light  rc-anchor-invisible-hover"><div id="recaptcha-accessible-status" class="rc-anchor-aria-status" aria-hidden="true">Recaptcha requires verification. </div><div class="rc-anchor-error-msg-container" style="display:none"><span class="rc-anchor-error-msg" aria-hidden="true"></span></div><div class="rc-anchor-normal-footer"><div class="rc-anchor-logo-large" role="presentation"><div class="rc-anchor-logo-img rc-anchor-logo-img-large"></div></div><div class="rc-anchor-pt"><a href="https://www.google.com/intl/en/policies/privacy/" target="_blank">Privacy</a><span aria-hidden="true" role="presentation"> - </span><a href="https://www.google.com/intl/en/policies/terms/" target="_blank">Terms</a></div></div><div class="rc-anchor-invisible-text"><span>protected by <strong>reCAPTCHA</strong></span><div class="rc-anchor-pt"><a href="https://www.google.com/intl/en/policies/privacy/" target="_blank" style="">Privacy</a><span aria-hidden="true" role="presentation"> - </span><a href="https://www.google.com/intl/en/policies/terms/" target="_blank" style="">Terms</a></div></div></div><div style="display: none;" data-original-tag="iframe"></div></div></div><div class="grecaptcha-error"></div><textarea id="g-recaptcha-response-100000" name="g-recaptcha-response" class="g-recaptcha-response" style="width: 250px; height: 40px; border: 1px solid rgb(193, 193, 193); margin: 10px 25px; padding: 0px; resize: none; display: none;"></textarea></div><div style="display: none;" data-original-tag="iframe"></div></div></body></html>