# https://github.com/T3nb3w/ComDotNetExploit

[Skip to content](https://github.com/T3nb3w/ComDotNetExploit#start-of-content)

You signed in with another tab or window. [Reload](https://github.com/T3nb3w/ComDotNetExploit) to refresh your session.You signed out in another tab or window. [Reload](https://github.com/T3nb3w/ComDotNetExploit) to refresh your session.You switched accounts on another tab or window. [Reload](https://github.com/T3nb3w/ComDotNetExploit) to refresh your session.Dismiss alert

{{ message }}

[T3nb3w](https://github.com/T3nb3w)/ **[ComDotNetExploit](https://github.com/T3nb3w/ComDotNetExploit)** Public

- [Notifications](https://github.com/login?return_to=%2FT3nb3w%2FComDotNetExploit) You must be signed in to change notification settings
- [Fork\\
48](https://github.com/login?return_to=%2FT3nb3w%2FComDotNetExploit)
- [Star\\
332](https://github.com/login?return_to=%2FT3nb3w%2FComDotNetExploit)


A C++ proof of concept demonstrating the exploitation of Windows Protected Process Light (PPL) by leveraging COM-to-.NET redirection and reflection techniques for code injection. This PoC showcases bypassing code integrity checks and loading malicious payloads in highly protected processes such as LSASS. Based on research from James Forshaw.


[332\\
stars](https://github.com/T3nb3w/ComDotNetExploit/stargazers) [48\\
forks](https://github.com/T3nb3w/ComDotNetExploit/forks) [Branches](https://github.com/T3nb3w/ComDotNetExploit/branches) [Tags](https://github.com/T3nb3w/ComDotNetExploit/tags) [Activity](https://github.com/T3nb3w/ComDotNetExploit/activity)

[Star](https://github.com/login?return_to=%2FT3nb3w%2FComDotNetExploit)

[Notifications](https://github.com/login?return_to=%2FT3nb3w%2FComDotNetExploit) You must be signed in to change notification settings

# T3nb3w/ComDotNetExploit

main

[**1** Branch](https://github.com/T3nb3w/ComDotNetExploit/branches) [**0** Tags](https://github.com/T3nb3w/ComDotNetExploit/tags)

[Go to Branches page](https://github.com/T3nb3w/ComDotNetExploit/branches)[Go to Tags page](https://github.com/T3nb3w/ComDotNetExploit/tags)

Go to file

Code

Open more actions menu

## Folders and files

| Name | Name | Last commit message | Last commit date |
| --- | --- | --- | --- |
| ## Latest commit<br>[![T3nb3w](https://avatars.githubusercontent.com/u/27919170?v=4&size=40)](https://github.com/T3nb3w)[T3nb3w](https://github.com/T3nb3w/ComDotNetExploit/commits?author=T3nb3w)<br>[Merge pull request](https://github.com/T3nb3w/ComDotNetExploit/commit/6652de8f50c51c1e75731612a89f27d0dcce4283) [#2](https://github.com/T3nb3w/ComDotNetExploit/pull/2) [from T3nb3w/patch-1](https://github.com/T3nb3w/ComDotNetExploit/commit/6652de8f50c51c1e75731612a89f27d0dcce4283)<br>Open commit details<br>last yearMar 6, 2025<br>[6652de8](https://github.com/T3nb3w/ComDotNetExploit/commit/6652de8f50c51c1e75731612a89f27d0dcce4283) · last yearMar 6, 2025<br>## History<br>[19 Commits](https://github.com/T3nb3w/ComDotNetExploit/commits/main/) <br>Open commit details<br>[View commit history for this file.](https://github.com/T3nb3w/ComDotNetExploit/commits/main/) 19 Commits |
| [Bypass\_COM\_PPL](https://github.com/T3nb3w/ComDotNetExploit/tree/main/Bypass_COM_PPL "Bypass_COM_PPL") | [Bypass\_COM\_PPL](https://github.com/T3nb3w/ComDotNetExploit/tree/main/Bypass_COM_PPL "Bypass_COM_PPL") | [Update dotnet\_interop.cpp](https://github.com/T3nb3w/ComDotNetExploit/commit/64b9e9dc8eaef5996bc8d13f4f403af2842eb4c2 "Update dotnet_interop.cpp") | last yearMar 4, 2025 |
| [ComDotNetExploit.sln](https://github.com/T3nb3w/ComDotNetExploit/blob/main/ComDotNetExploit.sln "ComDotNetExploit.sln") | [ComDotNetExploit.sln](https://github.com/T3nb3w/ComDotNetExploit/blob/main/ComDotNetExploit.sln "ComDotNetExploit.sln") | [Add project files](https://github.com/T3nb3w/ComDotNetExploit/commit/44d7dbf6b49c0e32408d5b2d5609fc19ede5f35e "Add project files") | last yearMar 1, 2025 |
| [README.md](https://github.com/T3nb3w/ComDotNetExploit/blob/main/README.md "README.md") | [README.md](https://github.com/T3nb3w/ComDotNetExploit/blob/main/README.md "README.md") | [Update README.md](https://github.com/T3nb3w/ComDotNetExploit/commit/b7f596df2584cc3f25365392a68b2abc3cf90eac "Update README.md") | last yearMar 6, 2025 |
| View all files |

## Repository files navigation

# PPL Exploit PoC (Proof of Concept)

[Permalink: PPL Exploit PoC (Proof of Concept)](https://github.com/T3nb3w/ComDotNetExploit#ppl-exploit-poc-proof-of-concept)

This repository contains a C++ Proof of Concept (PoC) demonstrating the exploitation of Windows Protected Process Light (PPL) using COM-to-.NET redirection and reflection techniques for code injection. The exploit bypasses code integrity checks and injects a malicious payload into highly protected processes such as LSASS.

The PoC leverages registry manipulation and the IDispatch interface, enabling code injection into a PPL process like `svchost.exe` or others with similar protections. This technique is inspired by James Forshaw's (a.k.a. [@tiraniddo](https://infosec.exchange/@tiraniddo)) research into exploiting .NET reflection and the bypass of signature checks on PPL processes.
I wrote a blog post about this tool:

- **Blog post part**: [Abusing IDispatch for Trapped COM Object Access & Injecting into PPL Processes](https://mohamed-fakroud.gitbook.io/red-teamings-dojo/abusing-idispatch-for-trapped-com-object-access-and-injecting-into-ppl-processes)

* * *

## **Usage**

[Permalink: Usage](https://github.com/T3nb3w/ComDotNetExploit#usage)

**Run the Exploit:**

The following command will load the malicious payload into the svchost PPL process:

```
ComDotNetExploit.exe <DLL Path> <Static Class Name>
```

* * *

## **Analysis**

[Permalink: Analysis](https://github.com/T3nb3w/ComDotNetExploit#analysis)

The PoC demonstrates how registry manipulation can allow COM-to-.NET redirection to execute unmanaged code in a .NET process. By enabling reflection via `Assembly.Load(byte[])`, we bypass the SEC\_IMAGE code integrity checks that are typically enforced during image section creation in PPL processes.

The exploit showcases the following attack vectors:

- **COM-to-.NET redirection**: By manipulating registry keys, we can redirect COM activation to a .NET object, which allows us to load and execute .NET assemblies in a protected process context.
- **Bypassing code integrity checks**: Using .NET Reflection (`Assembly.Load(byte[])`), we bypass the normal image section validation that occurs in PPL processes, allowing us to load unsigned, malicious code.

* * *

## **Credit**

[Permalink: Credit](https://github.com/T3nb3w/ComDotNetExploit#credit)

This PoC is largely inspired by the research conducted by **James Forshaw** (a.k.a. [@tiraniddo](https://infosec.exchange/@tiraniddo)).

- **[Windows Bug Class: Accessing Trapped COM Objects with IDispatch](https://googleprojectzero.blogspot.com/2025/01/windows-bug-class-accessing-trapped-com.html)**

* * *

## **Disclaimer**

[Permalink: Disclaimer](https://github.com/T3nb3w/ComDotNetExploit#disclaimer)

This PoC is intended for educational purposes only. It should not be used for any illegal or malicious activities. I do not take any responsibility for misuse or unintended consequences arising from the use of this code.

## About

A C++ proof of concept demonstrating the exploitation of Windows Protected Process Light (PPL) by leveraging COM-to-.NET redirection and reflection techniques for code injection. This PoC showcases bypassing code integrity checks and loading malicious payloads in highly protected processes such as LSASS. Based on research from James Forshaw.


### Resources

[Readme](https://github.com/T3nb3w/ComDotNetExploit#readme-ov-file)

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/T3nb3w/ComDotNetExploit).

[Activity](https://github.com/T3nb3w/ComDotNetExploit/activity)

### Stars

[**332**\\
stars](https://github.com/T3nb3w/ComDotNetExploit/stargazers)

### Watchers

[**3**\\
watching](https://github.com/T3nb3w/ComDotNetExploit/watchers)

### Forks

[**48**\\
forks](https://github.com/T3nb3w/ComDotNetExploit/forks)

[Report repository](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FT3nb3w%2FComDotNetExploit&report=T3nb3w+%28user%29)

## [Releases](https://github.com/T3nb3w/ComDotNetExploit/releases)

No releases published

## [Packages\  0](https://github.com/users/T3nb3w/packages?repo_name=ComDotNetExploit)

No packages published

## Languages

- [C++100.0%](https://github.com/T3nb3w/ComDotNetExploit/search?l=c%2B%2B)

You can’t perform that action at this time.