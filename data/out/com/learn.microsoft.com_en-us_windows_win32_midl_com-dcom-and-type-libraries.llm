Title:
COM, DCOM, and Type Libraries

Type:
Documentation

Short Summary (4–8 sentences max):
- This Microsoft Win32/MIDL documentation explains how COM and DCOM interfaces are defined and how they use RPC for communication across apartments, processes, and machines.  
- It introduces type libraries (.tlb) as the runtime-accessible binary metadata that describes COM/DCOM objects’ methods, properties, and supported interfaces, enabling language-agnostic invocation and automation.  
- The article outlines how interface characteristics are specified using MIDL via IDL files (wire format and marshaling semantics) and optional ACF files (local environment/binding and complex structure marshaling guidance).  
- It describes what the MIDL compiler (midl.exe) generates depending on attributes/statements: COM proxy/stub code for custom interfaces, compiled type libraries for `library` blocks, and classic RPC stubs for non-`object` interfaces.  
- Useful for Windows developers, reverse engineers, and both red/blue teams who need to understand COM/DCOM interface metadata, marshaling, and the artifacts produced for RPC-based communication.

Technical Focus:
- COM/DCOM interface definition and RPC transport
- Type libraries (.tlb) and runtime interface discovery
- MIDL (IDL/ACF) attributes and wire-level marshaling
- Cross-apartment/cross-process/cross-machine marshaling
- MIDL compiler outputs (proxy/stub, headers, IID, DLL data)

Use Cases:
- Reverse engineering COM servers by inspecting type libraries and interface definitions
- Building or auditing custom COM interfaces and their marshaling behavior
- Understanding DCOM/RPC communication paths for lateral movement or hardening
- Generating proxy/stub code and .tlb artifacts from MIDL for interoperability testing
- Mapping COM/RPC artifacts (IIDs, proxies) to binaries during incident response

Keywords:
COM, DCOM, RPC, MIDL, midl.exe, IDL, ACF, type library, TLB, marshaling, proxy/stub, interface definition, IID, cross-apartment, cross-process, cross-machine, Automation, OSF-DCE IDL, Win32, COM interface