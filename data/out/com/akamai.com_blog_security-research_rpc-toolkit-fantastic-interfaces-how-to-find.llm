Title:
Fantastic RPC Interfaces and How to Find Them

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post introduces Akamai’s open-source RPC Toolkit and focuses on the “RPC Interface Analyzer” for discovering and triaging potentially vulnerable MS-RPC interfaces on Windows.  
- It explains how RPC interface security is commonly enforced via server-side security callbacks and what attributes those callbacks inspect (transport/protocol sequence, auth level/service, NULL sessions, opnum, caller locality, PID, etc.).  
- The walkthrough covers two discovery paths: parsing public MIDL/IDL files to extract interface UUIDs and function signatures, and scraping PE files to find interfaces registered via RpcServerRegisterIf* and related APIs.  
- For PE analysis, the tool can run in regex-only mode or integrate with disassemblers (IDA Pro, Radare2) to recover richer registration metadata (flags, security descriptor, callback address) and detect interface-level caching usage.  
- A new feature adds automated parsing of security callback logic by identifying RpcServerInqCallAttributes usage and extracting which RPC_CALL_ATTRIBUTES fields are compared and how, enabling filtering for weak/misconfigured access controls.  
- It’s useful for vulnerability researchers, red teams, and defenders who need scalable RPC attack-surface mapping and prioritization based on real access-control behavior.

Technical Focus:
- MS-RPC interface discovery (IDL/MIDL parsing, UUID/opnum mapping)
- PE static analysis of RpcServerRegisterIf/RpcServerRegisterIfEx registrations
- RPC security callbacks and access-control logic extraction
- RPC_CALL_ATTRIBUTES (v1/v2/v3) and RpcServerInqCallAttributes
- Authentication levels/services (NTLM/Kerberos/Negotiate/Netlogon) and NULL sessions
- Transport/protocol sequences (TCP, Named Pipes, ALPC, HTTP) and string bindings

Use Cases:
- Enumerate RPC servers/clients and interface UUIDs across Windows binaries (e.g., System32)
- Identify interfaces that allow weak auth (e.g., NONE), NULL sessions, or risky transport exposure
- Triage interfaces by callback checks (local-only, kernel-only, opnum-gated functions)
- Support exploit research by extracting function names/signatures and registration flags
- Defensive auditing of RPC hardening posture and callback/caching misconfigurations

Keywords:
MS-RPC, RPC Toolkit, RPC Interface Analyzer, IDL, MIDL, UUID, opnum, RpcServerRegisterIf, RpcServerRegisterIfEx, RpcServerInqCallAttributes, RPC_CALL_ATTRIBUTES, security callback, authentication level, authentication service, NTLM, Kerberos, Named Pipes, ALPC, string binding, IDA Pro, Radare2, PE analysis, interface caching