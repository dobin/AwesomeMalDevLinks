Title:
Forget PSEXEC: DCOM Upload & Execute Backdoor

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post details a new DCOM-based lateral movement technique that achieves remote “upload and execute” by abusing undocumented Windows Installer COM interfaces.  
- It reverses the IMsiServer / IMsiCustomAction internals in msi.dll to move beyond the usual IDispatch-scriptable DCOM objects commonly abused via PowerShell.  
- The attack creates a remote custom action server (child MSIEXEC.exe), uses IMsiCustomAction methods to write a strong-named .NET assembly into the target’s GAC (predictable path), then loads it via LoadEmbeddedDLL and triggers exported entrypoints via CallInitDLL.  
- It includes a working PoC (DCOMUploadExec) and highlights constraints such as domain/forest requirements and DCOM hardening compatibility (KB5004442 alignment).  
- Useful for red teams and security researchers mapping overlooked DCOM attack surface; also valuable for defenders due to concrete process/file IOCs (msiexec -Embedding, GAC writes/loads, auth logs).  

Technical Focus:
- DCOM lateral movement via non-IDispatch COM interfaces
- Reverse engineering COM vtables/IIDs/CLSIDs in msi.dll (IDA)
- IMsiServer::CreateCustomActionServer and MSI custom action server spawning
- Remote file write via GAC/assembly cache APIs (IAssemblyCacheItem, IStream)
- DLL/assembly loading and export invocation (LoadLibrary, CallInitDLL)
- DCOM hardening / RPC security behavior (I_RpcBindingInqLocalClientPID, KB5004442)

Use Cases:
- Lateral movement without SMB file copy by writing payloads through Windows Installer COM
- Research methodology for discovering undocumented/non-scriptable DCOM abuse paths
- Building PoCs to validate DCOM exposure and default AppID permissions in enterprise fleets
- Defensive hunting for msiexec DCOM activation patterns and anomalous GAC modifications

Keywords:
DCOM, COM, RPC, AppID, CLSID, IID, IDispatch, IMsiServer, IMsiCustomAction, IMsiRemoteAPI, msi.dll, msiexec.exe, CreateCustomActionServer, LoadEmbeddedDLL, CallInitDLL, Global Assembly Cache, GAC, strong name, IAssemblyCacheItem, IStream, DllGetClassObject, IClassFactory, KB5004442, CVE-2021-26414, lateral movement, OleView.NET, IDA Pro