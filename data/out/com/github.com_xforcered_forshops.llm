Title:
ForsHops — Fileless DCOM Lateral Movement via Trapped COM Objects

Type:
GitHub Tool

Short Summary (4–8 sentences max):
ForsHops is a C++ proof-of-concept for fileless lateral movement over DCOM by abusing the “trapped COM object” bug class described by James Forshaw. It reflectively loads and executes a .NET assembly inside a remote target’s `svchost.exe` hosting the WaaS Medic Service (WaaSMedicSvc), enabling code execution without dropping a traditional payload on disk. The technique leverages COM/DCOM activation and registry-based COM redirection (notably `TreatAs` on the StandardFont CLSID) to influence object instantiation and execution flow. It is primarily useful for red teams and penetration testers researching stealthy Windows lateral movement and COM abuse, and for blue teams building detections around unusual CLR loads and COM registry tampering. The repo also includes defensive guidance and a basic YARA rule for identifying the stock PoC binary.

Technical Focus:
- DCOM-based lateral movement and remote COM activation
- Trapped COM objects / IDispatch abuse (Forshaw bug class)
- Reflective loading and in-memory execution of .NET assemblies
- Targeting `svchost.exe` (WaaSMedicSvc) for execution context
- COM registry manipulation (`HKLM\SOFTWARE\Classes\CLSID\...\TreatAs`)
- Detection opportunities: CLR load telemetry, registry/DACL changes, .NET Framework policy keys

Use Cases:
- Fileless lateral movement PoC development and operator tradecraft testing
- Researching COM/DCOM abuse paths and service-hosted execution contexts
- Building detections for anomalous CLR loads in service `svchost.exe` instances
- Threat hunting for `TreatAs` hijacks and related registry permission changes
- Validating firewall controls restricting DCOM ephemeral port access

Keywords:
DCOM, COM, trapped COM objects, IDispatch, lateral movement, svchost.exe, WaaSMedicSvc, reflective loading, in-memory execution, .NET assembly, CLR load, TreatAs, StandardFont CLSID, HKLM\SOFTWARE\Classes\CLSID, DACL manipulation, OnlyUseLatestCLR, AllowDCOMReflection, YARA, Visual Studio, James Forshaw