Title:
Dissecting DCOM (Part 1)

Type:
Blog Post

Short Summary (4â€“8 sentences max):
- This post introduces COM/DCOM fundamentals and then walks through a detailed, packet-level view of DCOM remote activation.  
- It clarifies core identifiers (CLSID, ProgID, AppID, IID), how COM components are registered, and practical enumeration via Registry/PowerShell and OleView.NET.  
- It covers multiple instantiation paths (PowerShell/.NET Activator, rundll32 CLSID helpers, Explorer shell CLSID shortcuts, scheduled task COM handlers) and maps them to underlying COM APIs (CoCreateInstance/Ex, CoGetClassObject).  
- The main technical value is the breakdown of out-of-proc/remote activation: RPCSS activator roles, IOXIDResolver::ServerAlive2 information leakage (hostnames/NIC IPs), and the IActivation vs IRemoteSCMActivator/ISystemActivator flows.  
- It explains how OBJREFs (STANDARD/CUSTOM/etc.), ORPCTHIS/ORPCTHAT, ScmReplyInfo, and IRemUnknown2/RemQueryInterface2 fit together to obtain proxies and call remote interfaces.  
- Useful for red teamers, pentesters, and vulnerability researchers needing a solid mental model for DCOM abuse, enumeration, and protocol-level auditing; also relevant to defenders analyzing DCOM/RPC traffic and exposure.

Technical Focus:
- COM/DCOM identifiers and registry registration (CLSID/ProgID/AppID/IID, LocalServer32/InProcServer32)
- Remote activation internals (RPCSS, IActivation, IRemoteSCMActivator/ISystemActivator)
- IOXIDResolver and ServerAlive2 enumeration behavior
- OBJREF marshalling formats and proxy creation (STANDARD vs CUSTOM, MEOW signature)
- DCE/RPC bindings, dynamic RPC ports, ORPCTHIS/ORPCTHAT metadata
- IRemUnknown2 and remote QueryInterface patterns

Use Cases:
- Enumerate COM/DCOM attack surface and interesting classes/interfaces on Windows hosts
- Perform/understand remote COM activation for lateral movement research and tooling
- Identify unauthenticated network interface/hostname disclosure via IOXIDResolver
- Build fuzzing/vulnerability research harnesses around activation and marshalling
- Investigate AppLocker bypass/persistence primitives involving COM instantiation and scheduled task COM handlers
- Create detections around suspicious DCOM activation sequences and RPC endpoint usage

Keywords:
DCOM, COM, RPCSS, DCE-RPC, IOXIDResolver, ServerAlive2, IActivation, IRemoteSCMActivator, ISystemActivator, IRemUnknown2, RemQueryInterface2, ORPCTHIS, ORPCTHAT, OBJREF, marshalling, CLSID, ProgID, AppID, IID, OleView.NET, CoCreateInstanceEx, CoGetClassObject, IClassFactory, scheduled task ComHandler, rundll32, ALPC, MIDL, type library (TLB)