# https://www.akamai.com/blog/security-research/rpc-toolkit-fantastic-interfaces-how-to-find

<!DOCTYPE html><html lang="en">
<body class="blogpage page basicpage" id="page-e020a58724" data-cmp-data-layer-enabled="">
<div class="cmp-amp-video-wrapper dynamic-amp-video" data-cmp-resource-path="/content/akamai/en/blog/security-research/rpc-toolkit-fantastic-interfaces-how-to-find/jcr:content">
    <div class="cmp-amp-video" data-cmp-is="cmp-dynamic-amp-video" endpoint="/site/locale/videos.videos.json" geolocationendpoint="/site/geolocation.geoinfo.json">
        <div class="akamai-social-share">
            <div class="at-share-btn-elements">
                <a role="button" class="cmp-social social-facebook"><span class="at-icon-wrapper"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" version="1.1" role="img" aria-labelledby="at-svg-facebook-5" class="at-icon at-icon-facebook" style="fill: rgb(255, 255, 255); width: 16px; height: 16px;"><g><path d="M22 5.16c-.406-.054-1.806-.16-3.43-.16-3.4 0-5.733 1.825-5.733 5.17v2.882H9v3.913h3.837V27h4.604V16.965h3.823l.587-3.913h-4.41v-2.5c0-1.123.347-1.903 2.198-1.903H22V5.16z" fill-rule="evenodd"></path></g></svg></span></a>
                <a role="button" class="cmp-social social-twitter"><span class="at-icon-wrapper"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="-5 -5 32 32" version="1.1" role="img" aria-labelledby="at-svg-twitter-6" class="at-icon at-icon-twitter" style="fill: rgb(255, 255, 255); width: 16px; height: 16px;"><title id="at-svg-twitter-6">Twitter</title><g><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path></g></svg></span></a>
                <a role="button" class="cmp-social social-linkedin"><span class="at-icon-wrapper"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" version="1.1" role="img" aria-labelledby="at-svg-linkedin-7" class="at-icon at-icon-linkedin" style="fill: rgb(255, 255, 255); width: 16px; height: 16px;"><title id="at-svg-linkedin-7">LinkedIn</title><g><path d="M26 25.963h-4.185v-6.55c0-1.56-.027-3.57-2.175-3.57-2.18 0-2.51 1.7-2.51 3.46v6.66h-4.182V12.495h4.012v1.84h.058c.558-1.058 1.924-2.174 3.96-2.174 4.24 0 5.022 2.79 5.022 6.417v7.386zM8.23 10.655a2.426 2.426 0 0 1 0-4.855 2.427 2.427 0 0 1 0 4.855zm-2.098 1.84h4.19v13.468h-4.19V12.495z" fill-rule="evenodd"></path></g></svg></span></a>
                <a role="button" class="cmp-social social-link"><span class="at-icon-wrapper"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" version="1.1" role="img" aria-labelledby="at-svg-email-6" title="Email" alt="Email" class="at-icon at-icon-email" style="fill: rgb(255, 255, 255); width: 16px; height: 16px;"><title id="at-svg-email-6">Email</title><g><g fill-rule="evenodd"></g><path d="M27 22.757c0 1.24-.988 2.243-2.19 2.243H7.19C5.98 25 5 23.994 5 22.757V13.67c0-.556.39-.773.855-.496l8.78 5.238c.782.467 1.95.467 2.73 0l8.78-5.238c.472-.28.855-.063.855.495v9.087z"></path><path d="M27 9.243C27 8.006 26.02 7 24.81 7H7.19C5.988 7 5 8.004 5 9.243v.465c0 .554.385 1.232.857 1.514l9.61 5.733c.267.16.8.16 1.067 0l9.61-5.733c.473-.283.856-.96.856-1.514v-.465z"></path></g></svg></span></a>
            </div>
        </div>
        <div class="amp-video-modal">
            <div class="modal-background"></div>
            
        </div>
    </div>
</div>
<div class="video-modal-main" style="height:0; width:0">
</div>
<div class="popup-image-show">
    
    <div class="img-container">
      <a class="img-popup-container">
        <span>X</span>
      </a>
    </div>
</div>


    

<div class="cmp-page__skiptomaincontent">
    <button class="cmp-page__skiptomaincontent-link" alt="Skip to main content link" data-href="akam-main-content">Skip to main content</button>
</div>
    



    
<main id="main" class="page-wrap blog-page" role="main">
  
  <div>
<div id="experiencefragment-ad43616d6a" class="cmp-experiencefragment cmp-experiencefragment--bcl---header">


    
	
	<div id="container-7b517eade7" class="bcl-container bcl-container--pt-lg bcl-container--pb-lg" data-component="bcl-container">
		
		
<div class="embed-unsafe embed">
<div id="embed-unsafe-02ba1561fd" class="cmp-embed">
    
    




    
</div>

    

</div>

		
	</div>

</div>

    

<span style="display:none"></span></div>
  <div data-scroll-to-id="akam-main-content">
    <div class="blog-page-heading-section">
      <div>


<div class="aem-Grid aem-Grid--12 aem-Grid--default--12 ">
    
    
    
</div>
</div>
    </div>
    <div class="blog-page-content content-section">
      <div class="wrapper">
        <section class="main-content">
          <div class="main-content__inner">
            <div>


<div class="aem-Grid aem-Grid--12 aem-Grid--default--12 ">
    
    <div class="breadcrumb aem-GridColumn aem-GridColumn--default--12">


    

</div>
<div class="title title__h1-h3 aem-GridColumn aem-GridColumn--default--12">
<div class="cmp-title" id="title-4c0737fb4b" data-cmp-data-layer="{&quot;title-4c0737fb4b&quot;:{&quot;@type&quot;:&quot;akamai/components/title&quot;,&quot;dc:title&quot;:&quot;Fantastic RPC Interfaces and How to Find Them | Akamai&quot;}}">
    
      <h1 class="cmp-title__text">Fantastic RPC Interfaces and How to Find Them</h1>
    
</div>

    


</div>
<div class="section section__vertical-center aem-GridColumn aem-GridColumn--default--12">

  
  
  
      

      

  <div class="cmp-section   " data-cmp-data-layer="{&quot;section-70dd59864e&quot;:{&quot;@type&quot;:&quot;akamai/components/section&quot;}}">
    
    
  
    
      <div class="cmp-section__row 1 cmp-section__2-columns">
        <div class="cmp-section__row-wrapper cmp-section__two-column--separate ">
          <div class="columns column-1  fifty-fifty">
            




    
    
    <div class="blogauthor">
<div class="cmp-blog-author" data-cmp-is="cmp-blog-author" id="blogauthor-b81d3edd9f" data-cmp-data-layer="{&quot;blogauthor-b81d3edd9f&quot;:{&quot;@type&quot;:&quot;akamai/components/blogauthor&quot;}}">

    <div class="cmp-blog-author__inline-section cmp-blog-author-details">
        <div class="cmp-blog-author__image-wrapper">
            <img src="https://www.akamai.com/site/en/images/blog/userpics/oryan-de-paz.png" alt="Oryan De Paz">
        </div>
        <div class="cmp-blog-author__info">
            <p class="cmp-blog-author__written-by">Written by</p>
            <p class="cmp-blog-author__name"><a href="https://www.akamai.com/blog?author=oryan-de-paz">Oryan De Paz</a></p>
            <p class="cmp-blog-author__date">February 22, 2023</p>
        </div>
    </div>

    
        <div class="cmp-blog-author-bio-section">
            <div class="cmp-blog-author__inline-section">
                <div class="cmp-blog-author__image-wrapper">
                    <img src="https://www.akamai.com/site/en/images/blog/userpics/oryan-de-paz.png" alt="Oryan De Paz">
                </div>
                <div class="cmp-blog-author__info">
                    <p class="cmp-blog-author__written-by">Written by</p>
                    <p class="cmp-blog-author__name"><a href="https://www.akamai.com/blog?author=oryan-de-paz">Oryan De Paz</a></p>
                </div>
            </div>
            <div class="cmp-blog-author__bio-wrapper">
                <div class="cmp-blog-author__bio"><p>Oryan De Paz is a Security Researcher in the Akamai Technologies Enterprise Security Group. In her daily job, she is doing multiple types of research, from vulnerability research to malware and internal mechanisms of the operating system. She is passionate about the Windows operating system internals, reverse engineering, and solving puzzles, which makes working in security research her dream job. In her free time, she likes to bake, travel, and spend time with her dog, Alice; and she is always up for learning new things.</p>
</div>
            </div>
        </div>
    

</div>

    
</div>



          </div>
        
          <div class="columns column-2  fifty-fifty">
            




    
    
    <div class="socialmedia">
<div class="cmp-socialmediashare cmp-socialmediashare__hide" data-cmp-data-layer="{&quot;socialmedia-b7a250e0f9&quot;:{&quot;@type&quot;:&quot;akamai/components/socialmedia&quot;}}">
  <p class="cmp-socialmediashare__title">Share</p>
  
  <div class="akamai-social-share">
    <div class="at-share-btn-elements">
        <a role="button" tabindex="0" class="cmp-social social-facebook" aria-label="Share via facebook">
            <span class="at-icon-wrapper">
                <span class="icon icon-facebook22"></span>
            </span>
        </a>

        <a role="button" tabindex="0" class="cmp-social social-twitter" aria-label="Share via twitter">
            <span class="at-icon-wrapper">
                <span class="icon icon-twitter"></span>
            </span>
        </a>

        <a role="button" tabindex="0" class="cmp-social social-linkedin" aria-label="Share via linkedin">
            <span class="at-icon-wrapper">
                <span class="icon icon-linkedin2"></span>
            </span>
        </a>

        <a role="button" tabindex="0" class="cmp-social social-link" aria-label="Share via email">
            <span class="at-icon-wrapper">
                <span class="icon icon-email"></span>
            </span>
        </a>
    </div>
  </div>

</div></div>



          </div>
        </div>
      </div>
    
  </div></div>
<div class="image aem-GridColumn aem-GridColumn--default--12">
<div class="cmp-image__wrapper    ">
  <div data-cmp-lazy="" data-title="We hope that our continued research and the tools in our repository will shed more light on this vector, and they will inspire other researchers to dig into it as well." class="cmp-image " itemscope="" itemtype="http://schema.org/ImageObject" data-cmp-data-layer="{&quot;image-d4fdb47bea&quot;:{&quot;@type&quot;:&quot;akamai/components/image&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T16:04:45Z&quot;,&quot;image&quot;:{&quot;repo:id&quot;:&quot;4b6cb287-6174-4d3b-8cac-81355ec7bae4&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T14:18:41Z&quot;,&quot;@type&quot;:&quot;image/png&quot;,&quot;repo:path&quot;:&quot;/content/dam/site/en/images/blog/2023/thumbnails/rpc-toolkit-fantastic-interfaces-how-to-find-main.png&quot;}}}">
    
      
        
          <img src="https://www.akamai.com/site/en/images/blog/2023/thumbnails/rpc-toolkit-fantastic-interfaces-how-to-find-main.png" loading="lazy" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt="We hope that our continued research and the tools in our repository will shed more light on this vector, and they will inspire other researchers to dig into it as well.">
        
        
      
    
    

    
    
    
  </div>
</div>

    

</div>
<div class="text text__pt-20 aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-32420200ce&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-03-10T16:10:36Z&quot;,&quot;xdm:text&quot;:&quot;<p>Editorial and additional contributions by Tricia Howard&amp;nbsp;</p>\r\n&quot;}}">
    <p>Editorial and additional contributions by Tricia Howard&nbsp;</p>

</div>

    

</div>
<div class="text text__pt-20 aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-21c7925c26&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-17T19:33:24Z&quot;,&quot;xdm:text&quot;:&quot;<h2>Introduction&amp;nbsp;</h2>\r\n&quot;}}">
    <h2>Introduction&nbsp;</h2>

</div>

    

</div>
<div class="text text__pb-20 aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-f547da298b&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-11-08T20:53:41Z&quot;,&quot;xdm:text&quot;:&quot;<p>Over the past few months, our team has put a lot of effort into MS-RPC research because of its complexity and largely underresearched nature. You may have seen the myriad posts about vulnerabilities we’ve discovered as a result of this work, such as <a href=\&quot;/content/akamai/en/blog/security-research/cold-hard-cache-bypassing-rpc-with-cache-abuse.html\&quot; target=\&quot;_self\&quot;><i>srvsvc</i></a> and <a href=\&quot;/content/akamai/en/blog/security-research/cant-wait-to-shut-you-down-msrpc-wininit.html\&quot; target=\&quot;_self\&quot;>Wininit.exe</a>, for example. With the sheer amount of data and tools we have amassed throughout this research, it only made sense to have it in one place: our <a href=\&quot;https://github.com/akamai/akamai-security-research/tree/main/rpc_toolkit\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer\&quot;>RPC Toolkit</a>.&amp;nbsp;</p>\r\n<p>This open source repository has anything and everything you would need to begin or further your journey into <a href=\&quot;/content/akamai/en/blog/security/guide-rpc-filter.html\&quot; target=\&quot;_self\&quot;>RPC</a>: tools, articles, blog posts, and conference talks, as well as RPC vulnerability information and exploit proofs of concepts. This repository was built in an effort to make RPC knowledge more accessible to defenders and researchers alike; we are all more secure when we work together, after all. To anyone who has read, used a tool, or shared some of our work: Thank you! We’re glad you are getting use out of it.&amp;nbsp;</p>\r\n<p>One of the tools in the toolkit is our RPC Interface Analyzer, which assists security professionals like you to quickly and easily identify leads to potentially vulnerable interfaces. This blog post is meant to guide you through its intended purpose and findings, as well as an overview of RPC and some of its security mechanisms for those who may not be familiar with them yet.&amp;nbsp;</p>\r\n&quot;}}">
    <p>Over the past few months, our team has put a lot of effort into MS-RPC research because of its complexity and largely underresearched nature. You may have seen the myriad posts about vulnerabilities we’ve discovered as a result of this work, such as <a href="https://www.akamai.com/blog/security-research/cold-hard-cache-bypassing-rpc-with-cache-abuse" target="_self"><i>srvsvc</i></a> and <a href="https://www.akamai.com/blog/security-research/cant-wait-to-shut-you-down-msrpc-wininit" target="_self">Wininit.exe</a>, for example. With the sheer amount of data and tools we have amassed throughout this research, it only made sense to have it in one place: our <a href="https://github.com/akamai/akamai-security-research/tree/main/rpc_toolkit" target="_blank" rel="nofollow noreferrer">RPC Toolkit</a>.&nbsp;</p>
<p>This open source repository has anything and everything you would need to begin or further your journey into <a href="https://www.akamai.com/blog/security/guide-rpc-filter" target="_self">RPC</a>: tools, articles, blog posts, and conference talks, as well as RPC vulnerability information and exploit proofs of concepts. This repository was built in an effort to make RPC knowledge more accessible to defenders and researchers alike; we are all more secure when we work together, after all. To anyone who has read, used a tool, or shared some of our work: Thank you! We’re glad you are getting use out of it.&nbsp;</p>
<p>One of the tools in the toolkit is our RPC Interface Analyzer, which assists security professionals like you to quickly and easily identify leads to potentially vulnerable interfaces. This blog post is meant to guide you through its intended purpose and findings, as well as an overview of RPC and some of its security mechanisms for those who may not be familiar with them yet.&nbsp;</p>

</div>

    

</div>
<div class="button button__large-button button__cta-blue button__white-text button__border-cta-blue button__dark-hover button__left aem-GridColumn aem-GridColumn--default--12">



  


<a class="cmp-button" data-cmp-data-layer="{&quot;button-05c93c51bd&quot;:{&quot;@type&quot;:&quot;akamai/components/button&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T16:04:51Z&quot;,&quot;dc:title&quot;:&quot;Take me to the walk-through&quot;,&quot;xdm:linkURL&quot;:&quot;#walk-through&quot;}}" href="https://www.akamai.com/blog/security-research/rpc-toolkit-fantastic-interfaces-how-to-find#walk-through" target="_self" data-cmp-clickable="">
    
    <span class="cmp-button__text">Take me to the walk-through</span>
    
</a>

  

</div>
<div class="text text__pt-20 aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-aa8d6d215f&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-17T19:36:49Z&quot;,&quot;xdm:text&quot;:&quot;<h2>What is RPC, and what are its security mechanisms?</h2>\r\n&quot;}}">
    <h2>What is RPC, and what are its security mechanisms?</h2>

</div>

    

</div>
<div class="text text__pb-20 aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-ccea22222c&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-22T15:28:52Z&quot;,&quot;xdm:text&quot;:&quot;<p>A remote procedure call (RPC) is a form of interprocess communication (IPC) that allows a client to invoke a procedure that is exposed by an RPC server. The client calls the function as if it were a normal procedure call, without (almost) any need to code the details for the remote interaction. The server can be hosted in a different process on the same machine or on a remote machine.</p>\n<p>MS-RPC, Microsoft’s implementation of RPC, is heavily used by Windows for many different services, such as task scheduling, service creation, printer and share settings, and the management of encrypted data stored remotely. This broad scope of uses and the remote nature of RPC as a vector is precisely why we are discussing this today, and why we have put so many resources into researching RPC. It holds a lot of functionality and, thus, gathers a lot of attention from a security point of view.</p>\n&quot;}}">
    <p>A remote procedure call (RPC) is a form of interprocess communication (IPC) that allows a client to invoke a procedure that is exposed by an RPC server. The client calls the function as if it were a normal procedure call, without (almost) any need to code the details for the remote interaction. The server can be hosted in a different process on the same machine or on a remote machine.</p>
<p>MS-RPC, Microsoft’s implementation of RPC, is heavily used by Windows for many different services, such as task scheduling, service creation, printer and share settings, and the management of encrypted data stored remotely. This broad scope of uses and the remote nature of RPC as a vector is precisely why we are discussing this today, and why we have put so many resources into researching RPC. It holds a lot of functionality and, thus, gathers a lot of attention from a security point of view.</p>

</div>

    

</div>
<div class="button button__large-button button__cta-blue button__white-text button__border-cta-blue button__dark-hover button__left aem-GridColumn aem-GridColumn--default--12">



  


<a class="cmp-button" data-cmp-data-layer="{&quot;button-c18957dda6&quot;:{&quot;@type&quot;:&quot;akamai/components/button&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T16:06:11Z&quot;,&quot;dc:title&quot;:&quot; See this onstage at DEF CON&quot;,&quot;xdm:linkURL&quot;:&quot;https://www.youtube.com/watch?v=lDvNKHGPsJg&quot;}}" href="https://www.youtube.com/watch?v=lDvNKHGPsJg" target="_blank" rel="nofollow noreferrer" data-cmp-clickable="">
    
    <span class="cmp-button__text"> See this onstage at DEF CON</span>
    
</a>

  

</div>
<div class="text text__pt-20 aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-befe500842&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T16:06:28Z&quot;,&quot;xdm:text&quot;:&quot;<p>In the following sections we’ll dive into <a href=\&quot;/content/akamai/en/blog/security-research/msrpc-security-mechanisms.html\&quot; target=\&quot;_self\&quot;>RPC security callbacks</a> and how you can use automation to analyze them and potentially generate new leads for security and vulnerability research.&nbsp;</p>\r\n&quot;}}">
    <p>In the following sections we’ll dive into <a href="https://www.akamai.com/blog/security-research/msrpc-security-mechanisms" target="_self">RPC security callbacks</a> and how you can use automation to analyze them and potentially generate new leads for security and vulnerability research.&nbsp;</p>

</div>

    

</div>
<div class="text text__pt-20 aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-4b2e4920f5&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-17T19:39:45Z&quot;,&quot;xdm:text&quot;:&quot;<h2>What is an RPC security callback and how does it work?</h2>\r\n&quot;}}">
    <h2>What is an RPC security callback and how does it work?</h2>

</div>

    

</div>
<div class="text aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-5929fd6494&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T16:06:48Z&quot;,&quot;xdm:text&quot;:&quot;<p>In short, a security callback is one of several ways to secure an RPC interface. It is a custom callback implemented by the RPC server developer. Its logic is up to the developer to decide, and it allows the developer to enforce user-based access control, authentication, transport types, or prevent access to specific functions that are exposed by the server.&nbsp;</p>\r\n<p>Eventually, the callback returns <i>RPC_S_OK </i>to allow the client's communication with the server, or one of the <a href=\&quot;https://learn.microsoft.com/en-us/windows/win32/rpc/rpc-return-values\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer\&quot;>RPC error codes</a>, such as RPC_S_ACCESS_DENIED, to deny it.</p>\r\n<p>The decision of accepting or rejecting a client’s request will usually rely on one attribute (or more than one) that we will explore below.</p>\r\n&quot;}}">
    <p>In short, a security callback is one of several ways to secure an RPC interface. It is a custom callback implemented by the RPC server developer. Its logic is up to the developer to decide, and it allows the developer to enforce user-based access control, authentication, transport types, or prevent access to specific functions that are exposed by the server.&nbsp;</p>
<p>Eventually, the callback returns <i>RPC_S_OK </i>to allow the client's communication with the server, or one of the <a href="https://learn.microsoft.com/en-us/windows/win32/rpc/rpc-return-values" target="_blank" rel="nofollow noreferrer">RPC error codes</a>, such as RPC_S_ACCESS_DENIED, to deny it.</p>
<p>The decision of accepting or rejecting a client’s request will usually rely on one attribute (or more than one) that we will explore below.</p>

</div>

    

</div>
<div class="text text__pt-20 aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-bc3e76b349&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T03:39:17Z&quot;,&quot;xdm:text&quot;:&quot;<h3>Protocol sequence</h3>\r\n&quot;}}">
    <h3>Protocol sequence</h3>

</div>

    

</div>
<div class="text aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-6f75c0163c&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-17T19:41:44Z&quot;,&quot;xdm:text&quot;:&quot;<p>The client can communicate with the server over several transports: TCP, Named Pipes, ALPC, and more. The security callback can check for this attribute to filter only local connection requests, only remote requests, TCP communication, etc.&amp;nbsp;</p>\r\n<p>While the protocol sequence values are undocumented, we mapped the protocol sequences that are being passed to the security callback within the RpcCallAttributes struct into the following values:</p>\r\n&quot;}}">
    <p>The client can communicate with the server over several transports: TCP, Named Pipes, ALPC, and more. The security callback can check for this attribute to filter only local connection requests, only remote requests, TCP communication, etc.&nbsp;</p>
<p>While the protocol sequence values are undocumented, we mapped the protocol sequences that are being passed to the security callback within the RpcCallAttributes struct into the following values:</p>

</div>

    

</div>
<div class="text aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-b92a07c950&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T03:40:29Z&quot;,&quot;xdm:text&quot;:&quot;<pre>\r\n#define ncacn_ip_tcp 1\r\n</pre>\r\n<pre>\r\n#define ncacn_np 2\r\n</pre>\r\n<pre>\r\n#define ncalrpc 3\r\n</pre>\r\n<pre>\r\n#define ncacn_http 4\r\n</pre>\r\n<p>Other protocol sequences (such as ncacn_hvsocket) can be tested by the security callback through a parsing of the&nbsp;<a href=\&quot;https://learn.microsoft.com/en-us/windows/win32/rpc/string-binding\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer\&quot;>string binding</a>.</p>\r\n&quot;}}">
    <pre>#define ncacn_ip_tcp 1
</pre>
<pre>#define ncacn_np 2
</pre>
<pre>#define ncalrpc 3
</pre>
<pre>#define ncacn_http 4
</pre>
<p>Other protocol sequences (such as ncacn_hvsocket) can be tested by the security callback through a parsing of the&nbsp;<a href="https://learn.microsoft.com/en-us/windows/win32/rpc/string-binding" target="_blank" rel="nofollow noreferrer">string binding</a>.</p>

</div>

    

</div>
<div class="text text__pt-20 aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-45947d1658&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T03:40:43Z&quot;,&quot;xdm:text&quot;:&quot;<h3>Authentication level</h3>\r\n&quot;}}">
    <h3>Authentication level</h3>

</div>

    

</div>
<div class="text aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-5b2ae64c2c&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T03:40:58Z&quot;,&quot;xdm:text&quot;:&quot;<p>Checking for the client’s <a href=\&quot;https://learn.microsoft.com/en-us/windows/win32/rpc/authentication-level-constants\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer\&quot;>authentication level</a> is pretty common in security callbacks. This way, the server can define the minimal authentication level it expects from its clients.</p>\r\n<p>There are multiple authentication levels, each one extends its previous level:<br />\r\n</p>\r\n&quot;}}">
    <p>Checking for the client’s <a href="https://learn.microsoft.com/en-us/windows/win32/rpc/authentication-level-constants" target="_blank" rel="nofollow noreferrer">authentication level</a> is pretty common in security callbacks. This way, the server can define the minimal authentication level it expects from its clients.</p>
<p>There are multiple authentication levels, each one extends its previous level:<br>
</p>

</div>

    

</div>
<div class="text text__pb-none aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-e4f815645e&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T03:41:42Z&quot;,&quot;xdm:text&quot;:&quot;<pre>\r\n#define RPC_C_AUTHN_LEVEL_DEFAULT 0\r\n</pre>\r\n<pre>\r\n#define RPC_C_AUTHN_LEVEL_NONE 1\r\n</pre>\r\n<pre>\r\n#define RPC_C_AUTHN_LEVEL_CONNECT 2\r\n</pre>\r\n<pre>\r\n#define RPC_C_AUTHN_LEVEL_CALL 3\r\n</pre>\r\n<pre>\r\n#define RPC_C_AUTHN_LEVEL_PKT  4\r\n</pre>\r\n<pre>\r\n#define RPC_C_AUTHN_LEVEL_PKT_INTEGRITY 5\r\n</pre>\r\n<pre>\r\n#define RPC_C_AUTHN_LEVEL_PKT_PRIVACY 6\r\n</pre>\r\n<p>For example, a server would expect an authentication level of&nbsp;<i>RPC_C_AUTHN_LEVEL_PKT_PRIVACY</i>&nbsp;to ensure that the communication data is only visible to the client and the server, or it would expect the authentication level of&nbsp;<i>RPC_C_AUTHN_LEVEL_NONE</i>&nbsp;to indicate no authentication.</p>\r\n&quot;}}">
    <pre>#define RPC_C_AUTHN_LEVEL_DEFAULT 0
</pre>
<pre>#define RPC_C_AUTHN_LEVEL_NONE 1
</pre>
<pre>#define RPC_C_AUTHN_LEVEL_CONNECT 2
</pre>
<pre>#define RPC_C_AUTHN_LEVEL_CALL 3
</pre>
<pre>#define RPC_C_AUTHN_LEVEL_PKT  4
</pre>
<pre>#define RPC_C_AUTHN_LEVEL_PKT_INTEGRITY 5
</pre>
<pre>#define RPC_C_AUTHN_LEVEL_PKT_PRIVACY 6
</pre>
<p>For example, a server would expect an authentication level of&nbsp;<i>RPC_C_AUTHN_LEVEL_PKT_PRIVACY</i>&nbsp;to ensure that the communication data is only visible to the client and the server, or it would expect the authentication level of&nbsp;<i>RPC_C_AUTHN_LEVEL_NONE</i>&nbsp;to indicate no authentication.</p>

</div>

    

</div>
<div class="text text__pt-20 aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-bca2632691&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T03:41:52Z&quot;,&quot;xdm:text&quot;:&quot;<h3>Authentication service</h3>\r\n&quot;}}">
    <h3>Authentication service</h3>

</div>

    

</div>
<div class="text aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-fedaa8b97b&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T03:42:04Z&quot;,&quot;xdm:text&quot;:&quot;<p>The <a href=\&quot;https://learn.microsoft.com/en-us/windows/win32/rpc/authentication-service-constants\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer\&quot;>authentication service</a> specifies the service that is in charge of validating the authentication policy provided by the authentication level.&nbsp;</p>\r\n<p>The authentication service constant values are:</p>\r\n&quot;}}">
    <p>The <a href="https://learn.microsoft.com/en-us/windows/win32/rpc/authentication-service-constants" target="_blank" rel="nofollow noreferrer">authentication service</a> specifies the service that is in charge of validating the authentication policy provided by the authentication level.&nbsp;</p>
<p>The authentication service constant values are:</p>

</div>

    

</div>
<div class="text aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-feef7913b8&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T03:43:04Z&quot;,&quot;xdm:text&quot;:&quot;<pre>\r\n#define RPC_C_AUTHN_NONE  0\r\n</pre>\r\n<pre>\r\n#define RPC_C_AUTHN_DCE_PRIVATE  1\r\n</pre>\r\n<pre>\r\n#define RPC_C_AUTHN_DCE_PUBLIC  2\r\n</pre>\r\n<pre>\r\n#define RPC_C_AUTHN_DEC_PUBLIC  4\r\n</pre>\r\n<pre>\r\n#define RPC_C_AUTHN_GSS_NEGOTIATE  9\r\n</pre>\r\n<pre>\r\n#define RPC_C_AUTHN_WINNT  10\r\n</pre>\r\n<pre>\r\n#define RPC_C_AUTHN_GSS_SCHANNEL  14\r\n</pre>\r\n<pre>\r\n#define RPC_C_AUTHN_GSS_KERBEROS  16\r\n</pre>\r\n<pre>\r\n#define RPC_C_AUTHN_DPA  17\r\n</pre>\r\n<pre>\r\n#define RPC_C_AUTHN_MSN  18\r\n</pre>\r\n<pre>\r\n#define RPC_C_AUTHN_DIGEST  21\r\n</pre>\r\n<pre>\r\n#define RPC_C_AUTHN_NEGO_EXTENDER  30\r\n</pre>\r\n<pre>\r\n#define RPC_C_NETLOGON   68 (Undocumented)\r\n</pre>\r\n<pre>\r\n#define RPC_C_AUTHN_MQ   100\r\n</pre>\r\n<pre>\r\n#define RPC_C_AUTHN_DEFAULT  0xffffffff\r\n</pre>\r\n<p><i>RPC_C_AUTHN_NONE</i>, for example, would turn off authentication, while&nbsp;<i>RPC_C_AUTHN_WINNT</i>&nbsp;will use the NTLM protocol.</p>\r\n<p>The full list of authentication services and their values can be found on this&nbsp;<a href=\&quot;https://github.com/akamai/akamai-security-research/blob/main/rpc_toolkit/pe_rpc_if_scraper/rpc_registration_lookup/dism_scripts/security_callback_analyzer/rpc_security_callback_consts.c\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer\&quot;>GitHub page</a>.&nbsp;</p>\r\n&quot;}}">
    <pre>#define RPC_C_AUTHN_NONE  0
</pre>
<pre>#define RPC_C_AUTHN_DCE_PRIVATE  1
</pre>
<pre>#define RPC_C_AUTHN_DCE_PUBLIC  2
</pre>
<pre>#define RPC_C_AUTHN_DEC_PUBLIC  4
</pre>
<pre>#define RPC_C_AUTHN_GSS_NEGOTIATE  9
</pre>
<pre>#define RPC_C_AUTHN_WINNT  10
</pre>
<pre>#define RPC_C_AUTHN_GSS_SCHANNEL  14
</pre>
<pre>#define RPC_C_AUTHN_GSS_KERBEROS  16
</pre>
<pre>#define RPC_C_AUTHN_DPA  17
</pre>
<pre>#define RPC_C_AUTHN_MSN  18
</pre>
<pre>#define RPC_C_AUTHN_DIGEST  21
</pre>
<pre>#define RPC_C_AUTHN_NEGO_EXTENDER  30
</pre>
<pre>#define RPC_C_NETLOGON   68 (Undocumented)
</pre>
<pre>#define RPC_C_AUTHN_MQ   100
</pre>
<pre>#define RPC_C_AUTHN_DEFAULT  0xffffffff
</pre>
<p><i>RPC_C_AUTHN_NONE</i>, for example, would turn off authentication, while&nbsp;<i>RPC_C_AUTHN_WINNT</i>&nbsp;will use the NTLM protocol.</p>
<p>The full list of authentication services and their values can be found on this&nbsp;<a href="https://github.com/akamai/akamai-security-research/blob/main/rpc_toolkit/pe_rpc_if_scraper/rpc_registration_lookup/dism_scripts/security_callback_analyzer/rpc_security_callback_consts.c" target="_blank" rel="nofollow noreferrer">GitHub page</a>.&nbsp;</p>

</div>

    

</div>
<div class="text text__pt-20 aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-4a0d10257a&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T03:44:10Z&quot;,&quot;xdm:text&quot;:&quot;<h3>NULL session</h3>\r\n&quot;}}">
    <h3>NULL session</h3>

</div>

    

</div>
<div class="text aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-2ca3986086&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-03-02T13:51:48Z&quot;,&quot;xdm:text&quot;:&quot;<p>A NULL session is an anonymous connection. In this case, the client communicates with the server with no authentication; that is, no user name or password.&amp;nbsp;</p>\r\n<p>In most cases, if a security callback is registered, then NULL sessions are blocked by default unless the flag RPC_IF_ALLOW_CALLBACKS_WITH_NO_AUTH is provided at the server registration (read about other cases <a href=\&quot;/content/akamai/en/blog/security-research/msrpc-security-mechanisms.html\&quot; target=\&quot;_self\&quot;>here</a>). Security callbacks can also check for NULL sessions.&amp;nbsp;</p>\r\n<p>By blocking access to these sessions, the security callback protects the RPC interface from unauthenticated users.&amp;nbsp;</p>\r\n&quot;}}">
    <p>A NULL session is an anonymous connection. In this case, the client communicates with the server with no authentication; that is, no user name or password.&nbsp;</p>
<p>In most cases, if a security callback is registered, then NULL sessions are blocked by default unless the flag RPC_IF_ALLOW_CALLBACKS_WITH_NO_AUTH is provided at the server registration (read about other cases <a href="https://www.akamai.com/blog/security-research/msrpc-security-mechanisms" target="_self">here</a>). Security callbacks can also check for NULL sessions.&nbsp;</p>
<p>By blocking access to these sessions, the security callback protects the RPC interface from unauthenticated users.&nbsp;</p>

</div>

    

</div>
<div class="text text__pt-20 aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-a9e52a17d6&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T03:44:59Z&quot;,&quot;xdm:text&quot;:&quot;<h3>Operation number (opnum)</h3>\r\n&quot;}}">
    <h3>Operation number (opnum)</h3>

</div>

    

</div>
<div class="text aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-b514a0a660&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T03:46:13Z&quot;,&quot;xdm:text&quot;:&quot;<p>The opnum represents the interface function that the client requests to run. More precisely, the opnum is the index into the RPC server’s function table.</p>\r\n<p>By checking the opnum value, the server can limit or block client access to specific functions, such as functions that handle sensitive data for remote clients, functions that access kernel memory and/or functionality for user-mode clients, etc.<br />\r\n</p>\r\n<p>Akamai Security Research published a blog post of <a href=\&quot;/content/akamai/en/blog/security-research/authentication-coercion-windows-server-service.html\&quot; target=\&quot;_self\&quot;>an example of an interesting security callback</a> that relies on this check.&nbsp;</p>\r\n<p>Other security callback checks can be:</p>\r\n<ul>\r\n<li><p><b>Caller origin</b> — to check if the caller comes from user mode or kernel mode</p>\r\n</li>\r\n<li><p><b>Client PID</b> — to allow only specific processes</p>\r\n</li>\r\n<li><p><a href=\&quot;https://learn.microsoft.com/en-us/windows/win32/rpc/string-binding\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer\&quot;><b>String binding</b></a> — to validate RPC connection attributes such as protocol sequence, network address, endpoint information, etc.</p>\r\n</li>\r\n<li><p><b>Impersonation</b> — to make sure the server can run the code in the client’s security context</p>\r\n</li>\r\n</ul>\r\n<p>There are also complex checks. For example, in LsaCapRpcIfCallbackFn callback on lsasrv.dll, if the authentication service is netlogon, the authentication level should be smaller than RPC_C_AUTHN_LEVEL_PKT_INTEGRITY.</p>\r\n&quot;}}">
    <p>The opnum represents the interface function that the client requests to run. More precisely, the opnum is the index into the RPC server’s function table.</p>
<p>By checking the opnum value, the server can limit or block client access to specific functions, such as functions that handle sensitive data for remote clients, functions that access kernel memory and/or functionality for user-mode clients, etc.<br>
</p>
<p>Akamai Security Research published a blog post of <a href="https://www.akamai.com/blog/security-research/authentication-coercion-windows-server-service" target="_self">an example of an interesting security callback</a> that relies on this check.&nbsp;</p>
<p>Other security callback checks can be:</p>
<ul>
<li><p><b>Caller origin</b> — to check if the caller comes from user mode or kernel mode</p>
</li>
<li><p><b>Client PID</b> — to allow only specific processes</p>
</li>
<li><p><a href="https://learn.microsoft.com/en-us/windows/win32/rpc/string-binding" target="_blank" rel="nofollow noreferrer"><b>String binding</b></a> — to validate RPC connection attributes such as protocol sequence, network address, endpoint information, etc.</p>
</li>
<li><p><b>Impersonation</b> — to make sure the server can run the code in the client’s security context</p>
</li>
</ul>
<p>There are also complex checks. For example, in LsaCapRpcIfCallbackFn callback on lsasrv.dll, if the authentication service is netlogon, the authentication level should be smaller than RPC_C_AUTHN_LEVEL_PKT_INTEGRITY.</p>

</div>

    

</div>
<div class="text text__pt-20 aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" id="walk-through" class="cmp-text" data-cmp-data-layer="{&quot;walk-through&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T03:46:56Z&quot;,&quot;xdm:text&quot;:&quot;<h2>RPC Interface Analyzer — a hands-on walk-through</h2>\r\n&quot;}}">
    <h2>RPC Interface Analyzer — a hands-on walk-through</h2>

</div>

    

</div>
<div class="text aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-4b994e7077&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-17T20:36:40Z&quot;,&quot;xdm:text&quot;:&quot;<p>The RPC Interface Analyzer is an automation tool for researching RPC interfaces. It allows researchers to find and analyze RPC interfaces from two different sources — either interface definition (IDL) files or PE files.</p>\r\n&quot;}}">
    <p>The RPC Interface Analyzer is an automation tool for researching RPC interfaces. It allows researchers to find and analyze RPC interfaces from two different sources — either interface definition (IDL) files or PE files.</p>

</div>

    

</div>
<div class="text text__pt-20 aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-2bf21bddd5&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T03:47:19Z&quot;,&quot;xdm:text&quot;:&quot;<h3>IDL files</h3>\r\n&quot;}}">
    <h3>IDL files</h3>

</div>

    

</div>
<div class="text aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-2964e72908&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T03:47:46Z&quot;,&quot;xdm:text&quot;:&quot;<p><a href=\&quot;https://learn.microsoft.com/en-us/windows/win32/midl/interface-definition-idl-file\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer\&quot;>IDL files</a> are the files that define an RPC interface and its functions. By analyzing publicly available IDL files, we can get information about an RPC interface and the functions that its server exposes, along with their parameters and their return value types. With this information, a researcher can look for potentially vulnerable functions; for example, functions that receive a path argument, such as in <a href=\&quot;https://github.com/topotam/PetitPotam\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer\&quot;>PetitPotam</a>’s case.&nbsp;</p>\r\n<p>In order to run our <a href=\&quot;https://github.com/akamai/akamai-security-research/tree/main/rpc_toolkit/idl_scraper\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer\&quot;>IDL analyzer</a>, run the following commands:</p>\r\n&quot;}}">
    <p><a href="https://learn.microsoft.com/en-us/windows/win32/midl/interface-definition-idl-file" target="_blank" rel="nofollow noreferrer">IDL files</a> are the files that define an RPC interface and its functions. By analyzing publicly available IDL files, we can get information about an RPC interface and the functions that its server exposes, along with their parameters and their return value types. With this information, a researcher can look for potentially vulnerable functions; for example, functions that receive a path argument, such as in <a href="https://github.com/topotam/PetitPotam" target="_blank" rel="nofollow noreferrer">PetitPotam</a>’s case.&nbsp;</p>
<p>In order to run our <a href="https://github.com/akamai/akamai-security-research/tree/main/rpc_toolkit/idl_scraper" target="_blank" rel="nofollow noreferrer">IDL analyzer</a>, run the following commands:</p>

</div>

    

</div>
<div class="text text__pb-20 aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-793061504d&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-17T21:08:40Z&quot;,&quot;xdm:text&quot;:&quot;<p style=\&quot;margin-left: 40.0px;\&quot;>1. Download all IDL files from Microsoft's website to your machine using the idl_scraper script:</p>\r\n<pre style=\&quot;margin-left: 40.0px;\&quot;>\r\nidl_scraper.py [-h] [-o OUTPUT] [-p PROTOCOL]\r\n</pre>\r\n<p style=\&quot;margin-left: 40.0px;\&quot;>2. Then run the idl_parser in order to analyze these IDL files:</p>\r\n<pre style=\&quot;margin-left: 40.0px;\&quot;>\r\nidl_parser.py [-h] [-r] input_path [output_path]\r\n</pre>\r\n<p>The output you’ll get in return is a CSV file containing the RPC interface names, universally unique identifiers (UUIDs), exposed function names, and signatures.</p>\r\n&quot;}}">
    <p style="margin-left: 40.0px;">1. Download all IDL files from Microsoft's website to your machine using the idl_scraper script:</p>
<pre style="margin-left: 40.0px;">idl_scraper.py [-h] [-o OUTPUT] [-p PROTOCOL]
</pre>
<p style="margin-left: 40.0px;">2. Then run the idl_parser in order to analyze these IDL files:</p>
<pre style="margin-left: 40.0px;">idl_parser.py [-h] [-r] input_path [output_path]
</pre>
<p>The output you’ll get in return is a CSV file containing the RPC interface names, universally unique identifiers (UUIDs), exposed function names, and signatures.</p>

</div>

    

</div>
<div class="image aem-GridColumn aem-GridColumn--default--12">
<div class="cmp-image__wrapper    ">
  <div data-cmp-lazy="" data-title="The output you’ll get in return is a CSV file containing the RPC interface names, universally unique identifiers (UUIDs), exposed function names, and signatures. " class="cmp-image " itemscope="" itemtype="http://schema.org/ImageObject" data-cmp-data-layer="{&quot;image-01e4fd3285&quot;:{&quot;@type&quot;:&quot;akamai/components/image&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T14:54:37Z&quot;,&quot;xdm:linkURL&quot;:&quot;/site/en/images/blog/2023/idl-funcs.jpg&quot;,&quot;image&quot;:{&quot;repo:id&quot;:&quot;cf449378-3f5a-4fe8-b0ca-f53ced5df2dc&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T01:50:27Z&quot;,&quot;@type&quot;:&quot;image/jpeg&quot;,&quot;repo:path&quot;:&quot;/content/dam/site/en/images/blog/2023/idl-funcs.jpg&quot;}}}">
    
      <a class="cmp-image__link" href="https://www.akamai.com/site/en/images/blog/2023/idl-funcs.jpg" target="_blank" rel="nofollow noreferrer" data-cmp-hook-image="link">
        
          <img src="https://www.akamai.com/site/en/images/blog/2023/idl-funcs.jpg" loading="lazy" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt="The output you’ll get in return is a CSV file containing the RPC interface names, universally unique identifiers (UUIDs), exposed function names, and signatures. ">
        
        
      </a>
    
    

    
    
    
  </div>
</div>

    

</div>
<div class="text text__pt-20 aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-9c0f866094&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T03:48:44Z&quot;,&quot;xdm:text&quot;:&quot;<h3>PE files</h3>\r\n&quot;}}">
    <h3>PE files</h3>

</div>

    

</div>
<div class="text text__pb-20 aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-a81de20f38&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T03:50:05Z&quot;,&quot;xdm:text&quot;:&quot;<p>Analyzing the IDL files can be useful, but we might miss some RPC interfaces since we only have access to the publicly available IDL files. Another approach is to look for RPC interfaces on our local filesystem — in PE files (either .exe or .dll files). We find this approach preferable to checking live processes, as this way we can’t miss RPC servers that aren’t live or are running in protected processes.</p>\r\n<p>The <a href=\&quot;https://github.com/akamai/akamai-security-research/tree/main/rpc_toolkit/pe_rpc_if_scraper\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer\&quot;>RPC PE Analyzer</a> will look for RPC interfaces registered by the <i>RpcServerRegisterIf</i> function (and its variants) and will analyze the arguments passed to it, in case there’s a disassembler provided. When running without it, in the default mode, the analyzer would find RPC interfaces using regex. This <a href=\&quot;https://www.youtube.com/watch?v=rrfI6dXMJQQ\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer\&quot;>talk</a> elaborates on the search process.&amp;nbsp;&amp;nbsp;</p>\r\n<p>In order to use the RPC PE Analyzer in its default mode, run the following command:</p>\r\n<pre>\r\npe_rpc_scraper.py &amp;lt;scrape_path&amp;gt; &amp;lt;output_path&amp;gt;\r\n</pre>\r\n<p>This command will give you the basic output that includes the interface UUID, its role (client/server), and its function names and addresses.</p>\r\n&quot;}}">
    <p>Analyzing the IDL files can be useful, but we might miss some RPC interfaces since we only have access to the publicly available IDL files. Another approach is to look for RPC interfaces on our local filesystem — in PE files (either .exe or .dll files). We find this approach preferable to checking live processes, as this way we can’t miss RPC servers that aren’t live or are running in protected processes.</p>
<p>The <a href="https://github.com/akamai/akamai-security-research/tree/main/rpc_toolkit/pe_rpc_if_scraper" target="_blank" rel="nofollow noreferrer">RPC PE Analyzer</a> will look for RPC interfaces registered by the <i>RpcServerRegisterIf</i> function (and its variants) and will analyze the arguments passed to it, in case there’s a disassembler provided. When running without it, in the default mode, the analyzer would find RPC interfaces using regex. This <a href="https://www.youtube.com/watch?v=rrfI6dXMJQQ" target="_blank" rel="nofollow noreferrer">talk</a> elaborates on the search process.&nbsp;&nbsp;</p>
<p>In order to use the RPC PE Analyzer in its default mode, run the following command:</p>
<pre>pe_rpc_scraper.py &lt;scrape_path&gt; &lt;output_path&gt;
</pre>
<p>This command will give you the basic output that includes the interface UUID, its role (client/server), and its function names and addresses.</p>

</div>

    

</div>
<div class="container responsivegrid cmp-container--section cmp-container--paddingLeftMedium cmp-container--paddingRightMedium aem-GridColumn aem-GridColumn--default--12">

    
    
    
   

    

          <div data-scroll-to-id="container-8a12a65184" class="cmp-container ">
          
               <div class="image">
<div class="cmp-image__wrapper    ">
  <div data-cmp-lazy="" data-title="Example of RPC PE Analyzer output when running on default mode" class="cmp-image " itemscope="" itemtype="http://schema.org/ImageObject" data-cmp-data-layer="{&quot;image-1cbc2c9958&quot;:{&quot;@type&quot;:&quot;akamai/components/image&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-22T16:27:27Z&quot;,&quot;xdm:linkURL&quot;:&quot;/site/en/images/blog/2023/output-before-sc-analayzer.jpg&quot;,&quot;image&quot;:{&quot;repo:id&quot;:&quot;51fd43cf-92de-4fe9-b05a-264d7c6a947f&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T02:07:48Z&quot;,&quot;@type&quot;:&quot;image/jpeg&quot;,&quot;repo:path&quot;:&quot;/content/dam/site/en/images/blog/2023/output-before-sc-analayzer.jpg&quot;}}}">
    
      <a class="cmp-image__link" href="https://www.akamai.com/site/en/images/blog/2023/output-before-sc-analayzer.jpg" target="_blank" rel="nofollow noreferrer" data-cmp-hook-image="link">
        
          <img src="https://www.akamai.com/site/en/images/blog/2023/output-before-sc-analayzer.jpg" loading="lazy" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt="Example of RPC PE Analyzer output when running on default mode">
        
        
      </a>
    
    

    
    
    
  </div>
</div>

    

</div>

               
          </div>

</div>
<div class="text text__pb-20 aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-eb1c67c784&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T03:51:40Z&quot;,&quot;xdm:text&quot;:&quot;<p>If you want more detailed information, you can provide a disassembler and its path (if it’s not the default one) to the script:</p>\r\n<pre>\r\npe_rpc_scraper.py [-d {idapro,radare}] [-P DISASSEMBLER_PATH] &amp;lt;scrape_path&amp;gt; &amp;lt;output_path&amp;gt;\r\n\r\n</pre>\r\n<p>Using the disassembler option will add also the interface registration information, including:</p>\r\n<ul>\r\n<li><p>Flags provided in the server registration</p>\r\n</li>\r\n<li><p>The interface’s security callback name and address</p>\r\n</li>\r\n<li><p>The security descriptor of the RPC server (if it has one)</p>\r\n</li>\r\n<li><p>Whether <a href=\&quot;/content/akamai/en/blog/security-research/cold-hard-cache-bypassing-rpc-with-cache-abuse.html\&quot; target=\&quot;_self\&quot;>global caching</a> is enabled for the security callback</p>\r\n</li>\r\n</ul>\r\n<p>Our latest feature that is released alongside this blog post also provides an analysis of the security callback itself.&nbsp;</p>\r\n&quot;}}">
    <p>If you want more detailed information, you can provide a disassembler and its path (if it’s not the default one) to the script:</p>
<pre>pe_rpc_scraper.py [-d {idapro,radare}] [-P DISASSEMBLER_PATH] &lt;scrape_path&gt; &lt;output_path&gt;

</pre>
<p>Using the disassembler option will add also the interface registration information, including:</p>
<ul>
<li><p>Flags provided in the server registration</p>
</li>
<li><p>The interface’s security callback name and address</p>
</li>
<li><p>The security descriptor of the RPC server (if it has one)</p>
</li>
<li><p>Whether <a href="https://www.akamai.com/blog/security-research/cold-hard-cache-bypassing-rpc-with-cache-abuse" target="_self">global caching</a> is enabled for the security callback</p>
</li>
</ul>
<p>Our latest feature that is released alongside this blog post also provides an analysis of the security callback itself.&nbsp;</p>

</div>

    

</div>
<div class="container responsivegrid cmp-container--paddingLeftSmall cmp-container--paddingRightSmall aem-GridColumn aem-GridColumn--default--12">

    
    
    
   

    

          <div data-scroll-to-id="container-d698da8960" class="cmp-container ">
          
               <div class="image">
<div class="cmp-image__wrapper    ">
  <div data-cmp-lazy="" data-title="Example of RPC PE Analyzer output when running with a disassembler" class="cmp-image " itemscope="" itemtype="http://schema.org/ImageObject" data-cmp-data-layer="{&quot;image-3944c6bb4b&quot;:{&quot;@type&quot;:&quot;akamai/components/image&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-22T15:46:32Z&quot;,&quot;xdm:linkURL&quot;:&quot;/site/en/images/blog/2023/output-w-sc-analayzer.jpg&quot;,&quot;image&quot;:{&quot;repo:id&quot;:&quot;809bd335-7589-4e77-a0c1-e506d97458ce&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T02:10:36Z&quot;,&quot;@type&quot;:&quot;image/jpeg&quot;,&quot;repo:path&quot;:&quot;/content/dam/site/en/images/blog/2023/output-w-sc-analayzer.jpg&quot;}}}">
    
      <a class="cmp-image__link" href="https://www.akamai.com/site/en/images/blog/2023/output-w-sc-analayzer.jpg" target="_blank" rel="nofollow noreferrer" data-cmp-hook-image="link">
        
          <img src="https://www.akamai.com/site/en/images/blog/2023/output-w-sc-analayzer.jpg" loading="lazy" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt="Example of RPC PE Analyzer output when running with a disassembler">
        
        
      </a>
    
    

    
    
    
  </div>
</div>

    

</div>

               
          </div>

</div>
<div class="text text__pt-20 aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-3142aa698b&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T03:51:59Z&quot;,&quot;xdm:text&quot;:&quot;<h3>Example usage</h3>\r\n&quot;}}">
    <h3>Example usage</h3>

</div>

    

</div>
<div class="text aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-20881efc4e&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T03:52:45Z&quot;,&quot;xdm:text&quot;:&quot;<p>Let’s say we want to scan all RPC interfaces available on our machine. We can run the RPC PE Analyzer, provide a copy of <i>C:\\Windows\\System32</i> as our scrape_path and go over the output.&nbsp;</p>\r\n<pre>\r\npe_rpc_scraper.py -d idapro “C:\\Users\\User\\Documents\\System32_Copy”\r\n</pre>\r\n<p>Since the output is in JSON format, it is easy to iterate on it and look for specific information. For example:</p>\r\n<ul>\r\n<li><p>Finding all RPC clients/servers in a DLL file</p>\r\n</li>\r\n<li><p>Finding all RPC clients/servers on a machine</p>\r\n</li>\r\n<li><p>Finding the clients of a specific RPC interface</p>\r\n</li>\r\n<li><p>Finding the RPC security callback of a certain RPC server</p>\r\n</li>\r\n<li><p>Finding which RPC interfaces use interface-level caching (read this <a href=\&quot;/content/akamai/en/blog/security-research/cold-hard-cache-bypassing-rpc-with-cache-abuse.html\&quot; target=\&quot;_self\&quot;>blog post</a> for more information on why this type of caching is problematic)</p>\r\n</li>\r\n</ul>\r\n<p>These are just a few out of many uses for this output. We are happy to hear about more usages and ideas.</p>\r\n&quot;}}">
    <p>Let’s say we want to scan all RPC interfaces available on our machine. We can run the RPC PE Analyzer, provide a copy of <i>C:\Windows\System32</i> as our scrape_path and go over the output.&nbsp;</p>
<pre>pe_rpc_scraper.py -d idapro “C:\Users\User\Documents\System32_Copy”
</pre>
<p>Since the output is in JSON format, it is easy to iterate on it and look for specific information. For example:</p>
<ul>
<li><p>Finding all RPC clients/servers in a DLL file</p>
</li>
<li><p>Finding all RPC clients/servers on a machine</p>
</li>
<li><p>Finding the clients of a specific RPC interface</p>
</li>
<li><p>Finding the RPC security callback of a certain RPC server</p>
</li>
<li><p>Finding which RPC interfaces use interface-level caching (read this <a href="https://www.akamai.com/blog/security-research/cold-hard-cache-bypassing-rpc-with-cache-abuse" target="_self">blog post</a> for more information on why this type of caching is problematic)</p>
</li>
</ul>
<p>These are just a few out of many uses for this output. We are happy to hear about more usages and ideas.</p>

</div>

    

</div>
<div class="text text__pt-20 aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-d40792f4da&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T03:54:32Z&quot;,&quot;xdm:text&quot;:&quot;<h2>New feature — security callback information</h2>\r\n&quot;}}">
    <h2>New feature — security callback information</h2>

</div>

    

</div>
<div class="text text__pt-20 aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-4119927092&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T03:54:36Z&quot;,&quot;xdm:text&quot;:&quot;<h3>RpcCallAttributes struct&nbsp;</h3>\r\n&quot;}}">
    <h3>RpcCallAttributes struct&nbsp;</h3>

</div>

    

</div>
<div class="text aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-df2a4e288d&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T03:55:33Z&quot;,&quot;xdm:text&quot;:&quot;<p><a href=\&quot;https://learn.microsoft.com/en-us/windows/win32/api/rpcasync/ns-rpcasync-rpc_call_attributes_v2_w\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer\&quot;>RPC_CALL_ATTRIBUTES</a> is a struct that holds data regarding the client's request. The interface security callback on the server side can obtain this information by calling the <i>RpcServerInqCallAttributes</i> function.&nbsp;</p>\r\n<p>typedef struct tagRPC_CALL_ATTRIBUTES_V3_W</p>\r\n<pre>\r\n{\r\n</pre>\r\n<pre>\r\n&nbsp;&nbsp;&nbsp;&nbsp;unsigned int Version;\r\n</pre>\r\n<pre>\r\n&nbsp;&nbsp;&nbsp;&nbsp;unsigned long Flags;\r\n</pre>\r\n<pre>\r\n&nbsp;&nbsp;&nbsp;&nbsp;unsigned long ServerPrincipalNameBufferLength;\r\n</pre>\r\n<pre>\r\n&nbsp;&nbsp;&nbsp;&nbsp;unsigned short *ServerPrincipalName;\r\n</pre>\r\n<pre>\r\n&nbsp;&nbsp;&nbsp;&nbsp;unsigned long ClientPrincipalNameBufferLength;\r\n</pre>\r\n<pre>\r\n&nbsp;&nbsp;&nbsp;&nbsp;unsigned short *ClientPrincipalName;\r\n</pre>\r\n<pre>\r\n&nbsp;&nbsp;&nbsp;&nbsp;unsigned long AuthenticationLevel;\r\n</pre>\r\n<pre>\r\n&nbsp;&nbsp;&nbsp;&nbsp;unsigned long AuthenticationService;\r\n</pre>\r\n<pre>\r\n&nbsp;&nbsp;&nbsp;&nbsp;BOOL NullSession;\r\n</pre>\r\n<pre>\r\n&nbsp;&nbsp;&nbsp;&nbsp;BOOL KernelModeCaller;\r\n</pre>\r\n<pre>\r\n&nbsp;&nbsp;&nbsp;&nbsp;unsigned long ProtocolSequence;\r\n</pre>\r\n<pre>\r\n&nbsp;&nbsp;&nbsp;&nbsp;RpcCallClientLocality IsClientLocal;\r\n</pre>\r\n<pre>\r\n&nbsp;&nbsp;&nbsp;&nbsp;HANDLE ClientPID;&nbsp;\r\n</pre>\r\n<pre>\r\n&nbsp;&nbsp;&nbsp;&nbsp;unsigned long CallStatus;\r\n</pre>\r\n<pre>\r\n&nbsp;&nbsp;&nbsp;&nbsp;RpcCallType CallType;\r\n</pre>\r\n<pre>\r\n&nbsp;&nbsp;&nbsp;&nbsp;RPC_CALL_LOCAL_ADDRESS_V1 *CallLocalAddress;\r\n</pre>\r\n<pre>\r\n&nbsp;&nbsp;&nbsp;&nbsp;unsigned short OpNum;\r\n</pre>\r\n<pre>\r\n&nbsp;&nbsp;&nbsp;&nbsp;UUID InterfaceUuid;\r\n</pre>\r\n<pre>\r\n&nbsp;&nbsp;&nbsp;&nbsp;unsigned long&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ClientIdentifierBufferLength;\r\n</pre>\r\n<pre>\r\n&nbsp;&nbsp;&nbsp;&nbsp;unsigned char&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *ClientIdentifier;\r\n</pre>\r\n<pre>\r\n} RPC_CALL_ATTRIBUTES_V3_W;\r\n</pre>\r\n<p>We’ve already mentioned the tests that security callbacks run. They can query some of these values individually (for example, <i>RpcStringBindingParseW </i>for receiving the protocol sequence, <i>RpcBindingInqAuthClient</i> for authentication information, and more), or use this struct that holds everything and requires only one function call. Indeed, in most security callbacks that we analyzed, they call <i>RpcServerInqCallAttributes</i> and use the RPC_CALL_ATTRIBUTES struct to query all attributes simultaneously. That makes this struct very interesting if you want to understand the security callback’s logic.</p>\r\n<p>The struct currently has three different versions — 1, 2, and 3 — and each one is an extension of its prior version and has ANSI and Unicode versions. You can find the different versions and their members on this <a href=\&quot;https://github.com/akamai/akamai-security-research/blob/main/rpc_toolkit/pe_rpc_if_scraper/rpc_registration_lookup/dism_scripts/security_callback_analyzer/rpc_security_callback_consts.c\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer\&quot;>GitHub page</a>.&nbsp;</p>\r\n&quot;}}">
    <p><a href="https://learn.microsoft.com/en-us/windows/win32/api/rpcasync/ns-rpcasync-rpc_call_attributes_v2_w" target="_blank" rel="nofollow noreferrer">RPC_CALL_ATTRIBUTES</a> is a struct that holds data regarding the client's request. The interface security callback on the server side can obtain this information by calling the <i>RpcServerInqCallAttributes</i> function.&nbsp;</p>
<p>typedef struct tagRPC_CALL_ATTRIBUTES_V3_W</p>
<pre>{
</pre>
<pre>&nbsp;&nbsp;&nbsp;&nbsp;unsigned int Version;
</pre>
<pre>&nbsp;&nbsp;&nbsp;&nbsp;unsigned long Flags;
</pre>
<pre>&nbsp;&nbsp;&nbsp;&nbsp;unsigned long ServerPrincipalNameBufferLength;
</pre>
<pre>&nbsp;&nbsp;&nbsp;&nbsp;unsigned short *ServerPrincipalName;
</pre>
<pre>&nbsp;&nbsp;&nbsp;&nbsp;unsigned long ClientPrincipalNameBufferLength;
</pre>
<pre>&nbsp;&nbsp;&nbsp;&nbsp;unsigned short *ClientPrincipalName;
</pre>
<pre>&nbsp;&nbsp;&nbsp;&nbsp;unsigned long AuthenticationLevel;
</pre>
<pre>&nbsp;&nbsp;&nbsp;&nbsp;unsigned long AuthenticationService;
</pre>
<pre>&nbsp;&nbsp;&nbsp;&nbsp;BOOL NullSession;
</pre>
<pre>&nbsp;&nbsp;&nbsp;&nbsp;BOOL KernelModeCaller;
</pre>
<pre>&nbsp;&nbsp;&nbsp;&nbsp;unsigned long ProtocolSequence;
</pre>
<pre>&nbsp;&nbsp;&nbsp;&nbsp;RpcCallClientLocality IsClientLocal;
</pre>
<pre>&nbsp;&nbsp;&nbsp;&nbsp;HANDLE ClientPID;&nbsp;
</pre>
<pre>&nbsp;&nbsp;&nbsp;&nbsp;unsigned long CallStatus;
</pre>
<pre>&nbsp;&nbsp;&nbsp;&nbsp;RpcCallType CallType;
</pre>
<pre>&nbsp;&nbsp;&nbsp;&nbsp;RPC_CALL_LOCAL_ADDRESS_V1 *CallLocalAddress;
</pre>
<pre>&nbsp;&nbsp;&nbsp;&nbsp;unsigned short OpNum;
</pre>
<pre>&nbsp;&nbsp;&nbsp;&nbsp;UUID InterfaceUuid;
</pre>
<pre>&nbsp;&nbsp;&nbsp;&nbsp;unsigned long&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ClientIdentifierBufferLength;
</pre>
<pre>&nbsp;&nbsp;&nbsp;&nbsp;unsigned char&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *ClientIdentifier;
</pre>
<pre>} RPC_CALL_ATTRIBUTES_V3_W;
</pre>
<p>We’ve already mentioned the tests that security callbacks run. They can query some of these values individually (for example, <i>RpcStringBindingParseW </i>for receiving the protocol sequence, <i>RpcBindingInqAuthClient</i> for authentication information, and more), or use this struct that holds everything and requires only one function call. Indeed, in most security callbacks that we analyzed, they call <i>RpcServerInqCallAttributes</i> and use the RPC_CALL_ATTRIBUTES struct to query all attributes simultaneously. That makes this struct very interesting if you want to understand the security callback’s logic.</p>
<p>The struct currently has three different versions — 1, 2, and 3 — and each one is an extension of its prior version and has ANSI and Unicode versions. You can find the different versions and their members on this <a href="https://github.com/akamai/akamai-security-research/blob/main/rpc_toolkit/pe_rpc_if_scraper/rpc_registration_lookup/dism_scripts/security_callback_analyzer/rpc_security_callback_consts.c" target="_blank" rel="nofollow noreferrer">GitHub page</a>.&nbsp;</p>

</div>

    

</div>
<div class="text text__pt-20 aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-cf4999ec7d&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T03:55:44Z&quot;,&quot;xdm:text&quot;:&quot;<h3>Security callback information</h3>\r\n&quot;}}">
    <h3>Security callback information</h3>

</div>

    

</div>
<div class="text aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-1fbd034419&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T03:56:28Z&quot;,&quot;xdm:text&quot;:&quot;<p>The new addition to our RPC Toolkit is the <b>security callback information</b>, which is part of the <a href=\&quot;https://github.com/akamai/akamai-security-research/tree/main/rpc_toolkit/pe_rpc_if_scraper\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer\&quot;>RPC PE Analyzer</a>. It provides a peek into the checks and verifications that the security callback does before it approves/denies clients requests.&nbsp;</p>\r\n<p>Analyzing an RPC interface’s security callback, and specifically its access to the RPC_CALL_ATTRIBUTES struct, can shed some light on the interface. This way, you can look for security callbacks that check the <b>authentication service</b> attribute if you want to filter RPC interfaces that use (or don’t use) a specific authentication protocol. You can also query RPC interfaces that don’t check for <b>NULL sessions</b> before they allow client requests and their server registration flags allow NULL sessions, to uncover potentially vulnerable RPC interfaces.</p>\r\n&quot;}}">
    <p>The new addition to our RPC Toolkit is the <b>security callback information</b>, which is part of the <a href="https://github.com/akamai/akamai-security-research/tree/main/rpc_toolkit/pe_rpc_if_scraper" target="_blank" rel="nofollow noreferrer">RPC PE Analyzer</a>. It provides a peek into the checks and verifications that the security callback does before it approves/denies clients requests.&nbsp;</p>
<p>Analyzing an RPC interface’s security callback, and specifically its access to the RPC_CALL_ATTRIBUTES struct, can shed some light on the interface. This way, you can look for security callbacks that check the <b>authentication service</b> attribute if you want to filter RPC interfaces that use (or don’t use) a specific authentication protocol. You can also query RPC interfaces that don’t check for <b>NULL sessions</b> before they allow client requests and their server registration flags allow NULL sessions, to uncover potentially vulnerable RPC interfaces.</p>

</div>

    

</div>
<div class="text text__pt-20 aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-4df413171a&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T03:56:37Z&quot;,&quot;xdm:text&quot;:&quot;<h3>How does it work?</h3>\r\n&quot;}}">
    <h3>How does it work?</h3>

</div>

    

</div>
<div class="text aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-69653396e5&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T03:56:50Z&quot;,&quot;xdm:text&quot;:&quot;<p>For each security callback, the analyzer will:</p>\r\n<ul>\r\n<li><p>Find what RPC_CALL_ATTRIBUTES struct version is being used and define the relevant struct in IDA’s local types</p>\r\n</li>\r\n<li><p>Locate the RpcCallAttribute local variable and apply the RPC_CALL_ATTRIBUTES struct as its type</p>\r\n</li>\r\n<li><p>Parse the checks that the security callback performs using this struct and output what member is being tested, the value that it is being compared to, and with what operator (== / != / &amp;gt; / &amp;lt; / etc.).</p>\r\n</li>\r\n</ul>\r\n&quot;}}">
    <p>For each security callback, the analyzer will:</p>
<ul>
<li><p>Find what RPC_CALL_ATTRIBUTES struct version is being used and define the relevant struct in IDA’s local types</p>
</li>
<li><p>Locate the RpcCallAttribute local variable and apply the RPC_CALL_ATTRIBUTES struct as its type</p>
</li>
<li><p>Parse the checks that the security callback performs using this struct and output what member is being tested, the value that it is being compared to, and with what operator (== / != / &gt; / &lt; / etc.).</p>
</li>
</ul>

</div>

    

</div>
<div class="text aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-bc4377c6e7&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T03:57:10Z&quot;,&quot;xdm:text&quot;:&quot;<h3>How can I use it?</h3>\r\n&quot;}}">
    <h3>How can I use it?</h3>

</div>

    

</div>
<div class="text aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-dde7ff142d&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T02:47:20Z&quot;,&quot;xdm:text&quot;:&quot;<p>The usage didn’t change: Every time you run the RPC PE Analyzer with the IDA disassembler flag, the output for each RPC interface will now include its security callback info — if it accesses to RpcCallAttributes struct members and what it tests.</p>\r\n<ul>\r\n<li><p>Note: This addition is currently available only for IDA, running the analyzer with the Radare option will not include security callback information.</p>\r\n</li>\r\n</ul>\r\n&quot;}}">
    <p>The usage didn’t change: Every time you run the RPC PE Analyzer with the IDA disassembler flag, the output for each RPC interface will now include its security callback info — if it accesses to RpcCallAttributes struct members and what it tests.</p>
<ul>
<li><p>Note: This addition is currently available only for IDA, running the analyzer with the Radare option will not include security callback information.</p>
</li>
</ul>

</div>

    

</div>
<div class="container responsivegrid cmp-container--paddingLeftSmall cmp-container--paddingRightSmall aem-GridColumn aem-GridColumn--default--12">

    
    
    
   

    

          <div data-scroll-to-id="container-34f0727641" class="cmp-container ">
          
               <div class="image">
<div class="cmp-image__wrapper    ">
  <div data-cmp-lazy="" data-title="Example of the new addition to the RPC PE Analyzer output - security callback information" class="cmp-image " itemscope="" itemtype="http://schema.org/ImageObject" data-cmp-data-layer="{&quot;image-eac8ce8797&quot;:{&quot;@type&quot;:&quot;akamai/components/image&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T14:54:56Z&quot;,&quot;xdm:linkURL&quot;:&quot;/site/en/images/blog/2023/security-callback-information.jpg&quot;,&quot;image&quot;:{&quot;repo:id&quot;:&quot;26318af4-6f5d-4b33-aa01-60d09ea8662b&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T02:50:59Z&quot;,&quot;@type&quot;:&quot;image/jpeg&quot;,&quot;repo:path&quot;:&quot;/content/dam/site/en/images/blog/2023/security-callback-information.jpg&quot;}}}">
    
      <a class="cmp-image__link" href="https://www.akamai.com/site/en/images/blog/2023/security-callback-information.jpg" target="_blank" rel="nofollow noreferrer" data-cmp-hook-image="link">
        
          <img src="https://www.akamai.com/site/en/images/blog/2023/security-callback-information.jpg" loading="lazy" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt="Example of the new addition to the RPC PE Analyzer output - security callback information">
        
        
      </a>
    
    

    
    
    
  </div>
</div>

    

</div>

               
          </div>

</div>
<div class="text aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-65f1a5a0f5&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T02:52:16Z&quot;,&quot;xdm:text&quot;:&quot;<p>Once you have the output, you can use it to find possibly vulnerable RPC interfaces and filter them according to your needs. Some examples include:</p>\r\n<ul>\r\n<li><p>Get an RPC interface that uses only the authentication level of RPC_C_AUTHN_LEVEL_PKT_PRIVACY</p>\r\n</li>\r\n<li><p>Get the RPC interfaces that expect local connections</p>\r\n</li>\r\n<li><p>Get the RPC interfaces that expect only kernel mode callers</p>\r\n</li>\r\n<li><p>Get RPC interfaces that checks for opnum, as in the caching vulnerability case</p>\r\n</li>\r\n</ul>\r\n&quot;}}">
    <p>Once you have the output, you can use it to find possibly vulnerable RPC interfaces and filter them according to your needs. Some examples include:</p>
<ul>
<li><p>Get an RPC interface that uses only the authentication level of RPC_C_AUTHN_LEVEL_PKT_PRIVACY</p>
</li>
<li><p>Get the RPC interfaces that expect local connections</p>
</li>
<li><p>Get the RPC interfaces that expect only kernel mode callers</p>
</li>
<li><p>Get RPC interfaces that checks for opnum, as in the caching vulnerability case</p>
</li>
</ul>

</div>

    

</div>
<div class="text aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-0e79b8354a&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T03:57:50Z&quot;,&quot;xdm:text&quot;:&quot;<h2>Summary</h2>\r\n&quot;}}">
    <h2>Summary</h2>

</div>

    

</div>
<div class="text text__pb-20 aem-GridColumn aem-GridColumn--default--12">
<div data-cmp-is="text" class="cmp-text" data-cmp-data-layer="{&quot;text-10e359ecc8&quot;:{&quot;@type&quot;:&quot;akamai/components/text&quot;,&quot;repo:modifyDate&quot;:&quot;2023-02-21T14:22:18Z&quot;,&quot;xdm:text&quot;:&quot;<p>It has become clear that RPC is ripe ground for research, especially considering how old and integrated it is into so many critical processes. We have been pooling resources in our repository for almost a year now, and there is still much more to wade through to fully realize the threat potential of RPC. It is still largely underresearched, and although it has garnered more attention recently, there is still much to discover about the myriad of ways attackers could abuse it.&amp;nbsp;</p>\r\n<p>The intrinsic nature of RPC warrants research into every potentially hazardous angle. We hope that our continued research and the tools in our repository will shed more light on this vector, and they will inspire other researchers to dig into it as well. Whether you are a defender who is responsible for securing RPC or a researcher looking for their next target, RPC is laden with potential for knowledge and insight.&amp;nbsp;</p>\r\n<p>Ready to get started? Check out the <a href=\&quot;https://github.com/akamai/akamai-security-research/tree/main/rpc_toolkit\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer\&quot;>repository</a>, and be sure to let us know on <a href=\&quot;https://twitter.com/Akamai_research\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer\&quot;>Twitter </a>what you find!&amp;nbsp;<br>\r\n</p>\r\n&quot;}}">
    <p>It has become clear that RPC is ripe ground for research, especially considering how old and integrated it is into so many critical processes. We have been pooling resources in our repository for almost a year now, and there is still much more to wade through to fully realize the threat potential of RPC. It is still largely underresearched, and although it has garnered more attention recently, there is still much to discover about the myriad of ways attackers could abuse it.&nbsp;</p>
<p>The intrinsic nature of RPC warrants research into every potentially hazardous angle. We hope that our continued research and the tools in our repository will shed more light on this vector, and they will inspire other researchers to dig into it as well. Whether you are a defender who is responsible for securing RPC or a researcher looking for their next target, RPC is laden with potential for knowledge and insight.&nbsp;</p>
<p>Ready to get started? Check out the <a href="https://github.com/akamai/akamai-security-research/tree/main/rpc_toolkit" target="_blank" rel="nofollow noreferrer">repository</a>, and be sure to let us know on <a href="https://twitter.com/Akamai_research" target="_blank" rel="nofollow noreferrer">Twitter </a>what you find!&nbsp;<br>
</p>

</div>

    

</div>
<div class="separator separator__solid-gray aem-GridColumn aem-GridColumn--default--12">
<div id="separator-4471368c18" class="cmp-separator">
    <hr class="cmp-separator__horizontal-rule">
</div></div>
<div class="section section__vertical-center aem-GridColumn aem-GridColumn--default--12">

  
  
  
      

      

  <div class="cmp-section   " data-cmp-data-layer="{&quot;section-31107807c1&quot;:{&quot;@type&quot;:&quot;akamai/components/section&quot;}}">
    
    
  
    
      <div class="cmp-section__row 1 cmp-section__2-columns">
        <div class="cmp-section__row-wrapper cmp-section__two-column--separate ">
          <div class="columns column-1  fifty-fifty">
            




    
    
    <div class="taglist">

<div class="cmp-tag-list" data-cmp-is="cmp-tag-list" data-cmp-data-layer="{&quot;taglist-5b785dd42a&quot;:{&quot;@type&quot;:&quot;akamai/components/taglist&quot;}}">
    <ul class="cmp-tag-list__list">
        <li class="cmp-tag-list__list-item"><a href="https://www.akamai.com/blog?filter=blogs/cyber-security" class="cmp-tag-list__list-item--link">Cyber Security</a></li>
    
        <li class="cmp-tag-list__list-item"><a href="https://www.akamai.com/blog?filter=blogs/research" class="cmp-tag-list__list-item--link">Research</a></li>
    
        <li class="cmp-tag-list__list-item"><a href="https://www.akamai.com/blog?filter=blogs/threat-intelligence" class="cmp-tag-list__list-item--link">Threat Intelligence</a></li>
    
        <li class="cmp-tag-list__list-item"><a href="https://www.akamai.com/blog?filter=blogs/security-research" class="cmp-tag-list__list-item--link">Security Research</a></li>
    </ul>
</div>

    

</div>



          </div>
        
          <div class="columns column-2  fifty-fifty">
            




    
    
    <div class="socialmedia">
<div class="cmp-socialmediashare cmp-socialmediashare__hide" data-cmp-data-layer="{&quot;socialmedia-a8f6443d13&quot;:{&quot;@type&quot;:&quot;akamai/components/socialmedia&quot;}}">
  <p class="cmp-socialmediashare__title">Share</p>
  
  <div class="akamai-social-share">
    <div class="at-share-btn-elements">
        <a role="button" tabindex="0" class="cmp-social social-facebook" aria-label="Share via facebook">
            <span class="at-icon-wrapper">
                <span class="icon icon-facebook22"></span>
            </span>
        </a>

        <a role="button" tabindex="0" class="cmp-social social-twitter" aria-label="Share via twitter">
            <span class="at-icon-wrapper">
                <span class="icon icon-twitter"></span>
            </span>
        </a>

        <a role="button" tabindex="0" class="cmp-social social-linkedin" aria-label="Share via linkedin">
            <span class="at-icon-wrapper">
                <span class="icon icon-linkedin2"></span>
            </span>
        </a>

        <a role="button" tabindex="0" class="cmp-social social-link" aria-label="Share via email">
            <span class="at-icon-wrapper">
                <span class="icon icon-email"></span>
            </span>
        </a>
    </div>
  </div>

</div></div>



          </div>
        </div>
      </div>
    
  </div></div>
<div class="separator separator__solid-gray aem-GridColumn aem-GridColumn--default--12">
<div id="separator-c6437d2356" class="cmp-separator">
    <hr class="cmp-separator__horizontal-rule">
</div></div>
<div class="blogauthor blog-author__large aem-GridColumn aem-GridColumn--default--12">
<div class="cmp-blog-author" data-cmp-is="cmp-blog-author" id="blogauthor-a23ef27c4b" data-cmp-data-layer="{&quot;blogauthor-a23ef27c4b&quot;:{&quot;@type&quot;:&quot;akamai/components/blogauthor&quot;}}">

    <div class="cmp-blog-author__inline-section cmp-blog-author-details">
        <div class="cmp-blog-author__image-wrapper">
            <img src="https://www.akamai.com/site/en/images/blog/userpics/oryan-de-paz.png" alt="Oryan De Paz">
        </div>
        <div class="cmp-blog-author__info">
            <p class="cmp-blog-author__written-by">Written by</p>
            <p class="cmp-blog-author__name"><a href="https://www.akamai.com/blog?author=oryan-de-paz">Oryan De Paz</a></p>
            <p class="cmp-blog-author__date">February 22, 2023</p>
        </div>
    </div>

    
        <div class="cmp-blog-author-bio-section">
            <div class="cmp-blog-author__inline-section">
                <div class="cmp-blog-author__image-wrapper">
                    <img src="https://www.akamai.com/site/en/images/blog/userpics/oryan-de-paz.png" alt="Oryan De Paz">
                </div>
                <div class="cmp-blog-author__info">
                    <p class="cmp-blog-author__written-by">Written by</p>
                    <p class="cmp-blog-author__name"><a href="https://www.akamai.com/blog?author=oryan-de-paz">Oryan De Paz</a></p>
                </div>
            </div>
            <div class="cmp-blog-author__bio-wrapper">
                <div class="cmp-blog-author__bio"><p>Oryan De Paz is a Security Researcher in the Akamai Technologies Enterprise Security Group. In her daily job, she is doing multiple types of research, from vulnerability research to malware and internal mechanisms of the operating system. She is passionate about the Windows operating system internals, reverse engineering, and solving puzzles, which makes working in security research her dream job. In her free time, she likes to bake, travel, and spend time with her dog, Alice; and she is always up for learning new things.</p>
</div>
            </div>
        </div>
    

</div>

    
</div>

    
</div>
</div>
          </div>
        </section>
      </div>
    </div>
  </div>
  <div>


<div class="aem-Grid aem-Grid--12 aem-Grid--default--12 ">
    
    <div class="container responsivegrid cmp-container--section aem-GridColumn aem-GridColumn--default--12">

    
    
    
   

    

          <div data-scroll-to-id="container-4b05ae39bc" class="cmp-container ">
          
               <div class="experiencefragment">
<div id="experiencefragment-1620a321fb" class="cmp-experiencefragment cmp-experiencefragment--blog-related-content">


    

  
   
      <div data-scroll-to-id="container-09f44236ff" class="cmp-container ">
          


<div class="aem-Grid aem-Grid--12 aem-Grid--default--12 ">
    
    <div class="container responsivegrid cmp-container--section cmp-container--paddingTopSmall cmp-container--paddingBottomMedium aem-GridColumn aem-GridColumn--default--12">

    
    
    
   

    

          <div data-scroll-to-id="container-2761df3edf" class="cmp-container " style="background-color:#f4f5f4;">
          
               <div class="title title__center">
<div class="cmp-title" id="title-ceddee8c2a" data-cmp-data-layer="{&quot;title-ceddee8c2a&quot;:{&quot;@type&quot;:&quot;akamai/components/title&quot;,&quot;repo:modifyDate&quot;:&quot;2022-10-18T20:30:18Z&quot;,&quot;dc:title&quot;:&quot;Related Blog Posts&quot;}}">
    
      <h2 class="cmp-title__text">Related Blog Posts</h2>
    
</div>

    


</div>
<div class="section">

  
  
  
      

      

  <div class="cmp-section   " data-cmp-data-layer="{&quot;section-4d6d1e0633&quot;:{&quot;@type&quot;:&quot;akamai/components/section&quot;,&quot;repo:modifyDate&quot;:&quot;2021-07-23T18:32:03Z&quot;}}">
    
    
  
    
      <div class="cmp-section__row 1 cmp-section__1-columns">
        <div class="cmp-section__row-wrapper  ">
          <div class="columns column-1 single-col-full-width ">
            




    
    
    <div class="relatedcontent cmp-teaser-light">
<div id="relatedcontent-86defbf7a1" class="cmp-teaser cmp-teaser__cardlist  ">
    <div class="cmp-teaser__cardlist--item  ">
        <div class="cmp-teaser__image cmp-image__wrapper fixed-ratio-16-9 ">

            <a class="cmp-teaser__image-link cmp-image  cmp-image-text-overlay-wrapper" href="https://www.akamai.com/blog/security-research/cve-2026-23864-react-nextjs-denial-of-service">
                <img src="https://www.akamai.com/site/en/images/blog/2025/thumbnail-image-varition-seven.png" loading="lazy" alt="A new rule within Akamai App &amp; API Protector has been deployed to protect our customers from this DoS threat.">
                
                <div class="cmp-image-text-overlay cmp-image-text-position-middle cmp-image-text-overlay-white-text">
                    <span>A new rule within Akamai App &amp; API Protector has been deployed to protect our customers from this DoS threat.</span>
                </div>
            </a>
        </div>
        <div class="cmp-teaser__content">
            
    
        <div class="cmp-teaser__label">Security Research</div>
    
    
    <h2 class="cmp-teaser__title">
        CVE-2026-23864: React and Next.js Denial of Service via Memory Exhaustion
    </h2>
    <div class="cmp-teaser__blog-date">January 26, 2026</div>
    <div class="cmp-teaser__description">A newly disclosed vulnerability that affects multiple React-based frameworks reveals a denial-of-service flaw.</div>
 
<div class="cmp-teaser__blog-authordetails">by Akamai Security Intelligence Group</div>

       <a class="cardlist__action-link" href="https://www.akamai.com/blog/security-research/cve-2026-23864-react-nextjs-denial-of-service">Read more<span class="cardlist__action-link_icon"></span></a>

        </div>
    </div>

    <div class="cmp-teaser__cardlist--item  ">
        <div class="cmp-teaser__image cmp-image__wrapper fixed-ratio-16-9 ">

            <a class="cmp-teaser__image-link cmp-image  cmp-image-text-overlay-wrapper" href="https://www.akamai.com/blog/security-research/command-injection-vivotek-legacy-firmware-need-to-know">
                <img src="https://www.akamai.com/site/en/images/blog/2025/thumbnail-image-varition-seven.png" loading="lazy" alt="We used cutting-edge AI-driven reverse engineering tools to discover a new vulnerability that’s impacting dozens of legacy camera models.">
                
                <div class="cmp-image-text-overlay cmp-image-text-position-middle cmp-image-text-overlay-white-text">
                    <span>We used cutting-edge AI-driven reverse engineering tools to discover a new vulnerability that’s impacting dozens of legacy camera models.</span>
                </div>
            </a>
        </div>
        <div class="cmp-teaser__content">
            
    
        <div class="cmp-teaser__label">Security Research</div>
    
    
    <h2 class="cmp-teaser__title">
        Command Injection in Vivotek Legacy Firmware: What You Need to Know
    </h2>
    <div class="cmp-teaser__blog-date">January 20, 2026</div>
    <div class="cmp-teaser__description">Stay ahead with the latest on the Vivotek upload_map.cgi vulnerability, CVE-2026-22755, and protect your legacy firmware from command injection attacks.</div>
 
<div class="cmp-teaser__blog-authordetails">by Larry Cashdollar</div>

       <a class="cardlist__action-link" href="https://www.akamai.com/blog/security-research/command-injection-vivotek-legacy-firmware-need-to-know">Read more<span class="cardlist__action-link_icon"></span></a>

        </div>
    </div>

    <div class="cmp-teaser__cardlist--item  ">
        <div class="cmp-teaser__image cmp-image__wrapper fixed-ratio-16-9 ">

            <a class="cmp-teaser__image-link cmp-image  cmp-image-text-overlay-wrapper" href="https://www.akamai.com/blog/security-research/cve-2025-14847-all-you-need-to-know-about-mongobleed">
                <img src="https://www.akamai.com/site/en/images/blog/2025/thumbnail-image-varition-seven.png" loading="lazy" alt="MongoBleed originates from how MongoDB processes compressed wire-protocol messages, a feature that is enabled by default.">
                
                <div class="cmp-image-text-overlay cmp-image-text-position-middle cmp-image-text-overlay-white-text">
                    <span>MongoBleed originates from how MongoDB processes compressed wire-protocol messages, a feature that is enabled by default.</span>
                </div>
            </a>
        </div>
        <div class="cmp-teaser__content">
            
    
        <div class="cmp-teaser__label">Security Research</div>
    
    
    <h2 class="cmp-teaser__title">
        CVE-2025-14847: All You Need to Know About MongoBleed
    </h2>
    <div class="cmp-teaser__blog-date">December 30, 2025</div>
    <div class="cmp-teaser__description">A vulnerability in MongoDB zlib compression allows a remote, unauthenticated attacker to remotely leak unallocated heap memory.</div>
 
<div class="cmp-teaser__blog-authordetails">by Akamai Security Intelligence Group</div>

       <a class="cardlist__action-link" href="https://www.akamai.com/blog/security-research/cve-2025-14847-all-you-need-to-know-about-mongobleed">Read more<span class="cardlist__action-link_icon"></span></a>

        </div>
    </div>
</div>

    
</div>



          </div>
        </div>
      </div>
    
  </div></div>

               
          </div>

</div>

    
</div>

      </div>

    
</div>

    

<span style="display:none"></span></div>

               
          </div>

</div>
<div class="experiencefragment aem-GridColumn aem-GridColumn--default--12">
<div id="experiencefragment-25c1896d54" class="cmp-experiencefragment cmp-experiencefragment--qualtrics-survey">


    

  
   
      <div data-scroll-to-id="container-d51bdfedb4" class="cmp-container ">
          


<div class="aem-Grid aem-Grid--12 aem-Grid--default--12 ">
    
    <div class="container responsivegrid cmp-container--section aem-GridColumn aem-GridColumn--default--12">

    
    
    
   

    

          <div data-scroll-to-id="container-d01cb44e52" class="cmp-container ">
          
               <div class="qualtrics">
  
<div class="cmp-qualtrics" survey-id="SV_9SK0IFHojuZCRnM" language="EN" placeholder-text="Rate the helpfulness of this page" submit-text="Submit" endpoint="/site/survey.qualtrics.json" data-cmp-is="qualtrics" data-cmp-data-layer="{&quot;qualtrics-08107a00d0&quot;:{&quot;@type&quot;:&quot;akamai/components/qualtrics&quot;,&quot;repo:modifyDate&quot;:&quot;2023-03-15T14:08:33Z&quot;}}" style="display: none;">
</div>
</div>

               
          </div>

</div>

    
</div>

      </div>

    
</div>

    

<span style="display:none"></span></div>

    
</div>
</div>
  <div>
<div id="experiencefragment-4f9ed6c9dd" class="cmp-experiencefragment cmp-experiencefragment--bcl---footer">


    
	
	<div id="container-d6078025fb" class="bcl-container bcl-container--bg-light-gray bcl-container--pt-sm bcl-container--pb-sm" data-component="bcl-container">
		
		<div class="bcl-footer-container"><div class="bcl-footer bcl-footer-masthead" id="footer-a29f5f9e0a">
	<div class="bcl-footer-masthead__wrapper">
        <div class="bcl-footer__list"><!-- SDI include (path: /content/experience-fragments/akamai/en/global/footer/bcl---footer/master/_jcr_content/root/footer/masthead-footer-links.mastfooter.html, resourceType: akamai/components/brand-cl/experiencefragment) -->

<div id="experiencefragment-f25f56ece1" class="cmp-experiencefragment cmp-experiencefragment--footer-list">


    
	
	<div id="container-f4fd979800" class="bcl-container bcl-container--pt-lg bcl-container--pb-lg" data-component="bcl-container">
		
		<div class="footer-list">
<div class="bcl-footer__top">
<div class="masthead-columns__wrapper footer-tablet__normal ">


    <div class="columns column1 f-5">
        <div class="subcolumn1">
            <div class="bcl-footer__title">
                
                
                    <div class="title">



  
    <button class="bcl-title__footercolumntitle bcl-title__text  js-collapse-trigger" aria-expanded="false">
        Products
    </button>
  


    

</div>

                
            </div>
            <div class="bcl-footer__list">
                <div class="bcl-list-container">
<ul class="bcl-list" id="list-0a6c18146d">
    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/cloud" target="_self">
        Cloud Computing
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/security" target="_self">
        Security
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/solutions/content-delivery-network" target="_self">
        Content Delivery
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/products" target="_self">
        All Products and Trials
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/global-services" target="_self">
        Global Services
    </a>
  
</li>
</ul>

    

</div>

            </div>
        </div>
    </div>





    <div class="columns column2 f-8">
        <div class="subcolumn1">
            <div class="bcl-footer__title">
                
                
                    <div class="title">



  
    <button class="bcl-title__footercolumntitle bcl-title__text bcl-title--align-left js-collapse-trigger" aria-expanded="false">
        Company
    </button>
  


    

</div>

                
            </div>
            <div class="bcl-footer__list">
                <div class="bcl-list-container">
<ul class="bcl-list" id="list-7221e6f233">
    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/company" target="_self">
        About Us
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/company/company-history" target="_self">
        History
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/company/leadership" target="_self">
        Leadership
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/company/facts-figures" target="_self">
        Facts and Figures
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/company/our-awards" target="_self">
        Awards
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/company/leadership/board-of-directors" target="_self">
        Board of Directors
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/why-akamai/infrastructure-for-innovation" target="_self">
        Infrastructure for Innovation
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.ir.akamai.com/" target="_blank">
        Investor Relations
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/company/corporate-responsibility" target="_self">
        Corporate Responsibility
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/company/ethics-and-compliance" target="_self">
        Ethics
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/company/locations" target="_self">
        Locations
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/global-services/support/vulnerability-reporting" target="_self">
        Vulnerability Reporting
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/accessibility-statement" target="_self">
        Accessibility Statement
    </a>
  
</li>
</ul>

    

</div>

            </div>
        </div>
    </div>







    <div class="columns column3 f-10">
        <div class="subcolumn1">
            <div class="bcl-footer__title">
                
                
                    <div class="title">



  
    <button class="bcl-title__footercolumntitle bcl-title__text bcl-title--align-left js-collapse-trigger" aria-expanded="false">
        Careers
    </button>
  


    

</div>

                
            </div>
            <div class="bcl-footer__list">
                <div class="bcl-list-container">
<ul class="bcl-list" id="list-788365ee29">
    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/careers" target="_self">
        Careers
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/careers/working-at-akamai" target="_self">
        Working at Akamai
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/careers/students-and-recent-graduates" target="_self">
        Students and Recent Grads
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/careers/workplace-diversity" target="_self">
        Workplace Diversity
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://jobs.akamai.com/en/sites/CX_1" target="_blank">
        Search Jobs
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/blog/culture" target="_self">
        Culture Blog
    </a>
  
</li>
</ul>

    

</div>

            </div>
        </div>
        <div class="subcolumn2">
            <div class="bcl-footer__title">
                
                
                    <div class="title">



  
    <button class="bcl-title__footercolumntitle bcl-title__text bcl-title--align-left js-collapse-trigger" aria-expanded="false">
        Newsroom
    </button>
  


    

</div>

                
            </div>
            <div class="bcl-footer__list">
                <div class="bcl-list-container">
<ul class="bcl-list" id="list-2e2847b281">
    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/newsroom" target="_self">
        Newsroom
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/newsroom/press-release" target="_self">
        Press Release
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/newsroom/in-the-news" target="_self">
        In the News
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/newsroom/media-resources" target="_self">
        Media Resources
    </a>
  
</li>
</ul>

    

</div>

            </div>
        </div>
    </div>



    <div class="columns column4 f-8">
        <div class="subcolumn1">
            <div class="bcl-footer__title">
                
                
                    <div class="title">



  
    <button class="bcl-title__footercolumntitle bcl-title__text bcl-title--align-left js-collapse-trigger" aria-expanded="false">
        Legal &amp; Compliance
    </button>
  


    

</div>

                
            </div>
            <div class="bcl-footer__list">
                <div class="bcl-list-container">
<ul class="bcl-list" id="list-bae5ec9aff">
    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/legal" target="_self">
        Legal
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://trust.akamai.com/" target="_blank">
        Information Security Compliance
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://trust.akamai.com/" target="_blank">
        Privacy Trust Center
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/legal/privacy-statement" target="_self">
        Privacy Statement
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/legal/manage-cookie-preferences" target="_self">
        Cookie Settings
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/legal/eu-digital-services-act" target="_self">
        EU Digital Services Act (DSA)
    </a>
  
</li>
</ul>

    

</div>

            </div>
        </div>
    </div>





    <div class="columns column5 f-8">
        <div class="subcolumn1">
            <div class="bcl-footer__title">
                
                
                    <div class="title">



  
    <button class="bcl-title__footercolumntitle bcl-title__text bcl-title--align-left js-collapse-trigger" aria-expanded="false">
        Glossary
    </button>
  


    

</div>

                
            </div>
            <div class="bcl-footer__list">
                <div class="bcl-list-container">
<ul class="bcl-list" id="list-3a1e50db40">
    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/glossary/what-is-api-security" target="_self">
        What Is API Security?
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/glossary/what-is-a-cdn" target="_self">
        What Is a CDN?
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/glossary/what-is-cloud-computing" target="_self">
        What Is Cloud Computing?
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/glossary/what-is-cybersecurity" target="_self">
        What Is Cybersecurity?
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/glossary/what-is-ddos" target="_self">
        What Is a DDoS attack?
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/glossary/what-is-microsegmentation" target="_self">
        What Is Microsegmentation?
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/glossary/what-is-waap" target="_self">
        What Is WAAP?
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/glossary/what-is-zero-trust" target="_self">
        What Is Zero Trust?
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/glossary" target="_self">
        See all
    </a>
  
</li>
</ul>

    

</div>

            </div>
        </div>
    </div>




            </div>

        </div>
        </div>

		
	</div>

</div>

    

<span style="display:none"></span></div>

		<div class="bcl-footer-masthead__bottom">
            <div class="bcl-footer-masthead__bottom--col1">
                <div class="bcl-footer-mh_bottom_s1">
                    <div class="bcl-footer__socialLink">
                        <div class="socialmedialinks">
</div>

                    </div>
                </div>
                <div class="bcl-footer-mh_bottom_s2">
                    <div class="bcl-horizontallist__list ">
                        <div class="bcl-list-container">
<ul class="bcl-list" id="list-39014159d6">
    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/legal/emea-legal-notices" target="_self">
        EMEA Legal Notice
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamaistatus.com/" target="_blank">
        Service Status
    </a>
  
</li>

    
    <li class="bcl-list__item">
    
    <a class="bcl-list__item-link bcl-typography--button-md" data-item="list-item" href="https://www.akamai.com/why-akamai/contact-us" target="_self">
        Contact Us
    </a>
  
</li>
</ul>

    

</div>

                        <div class="bcl-languagenavigation__langnavholder">
                            

     
     
    


                        </div>
                    </div>
                </div>
            </div>
            <div class="bcl-footer-masthead__bottom--col2">
                <div class="bcl-footer__navtext">
                    <div class="bcl-horizontallist__text ">
                        <div class="bcl-footer__image" data-tracking-value="logo">
                            


<div id="image-b07d7a3200" class="bcl-image " itemscope="" itemtype="http://schema.org/ImageObject" data-title="Akamai" data-component="bcl-image">

	
	<a class="bcl-image__link" href="https://www.akamai.com/" target="_self">

		<img src="https://www.akamai.com/site/en/images/logo/akamai-logo4.svg" loading="lazy" class="bcl-image__image" itemprop="contentUrl" alt="Akamai" width="300" height="150">

	</a>

	
	

	
	

</div>






    

                        </div>
                        <div class="text">
<div data-cmp-is="text" class="bcl-text   " data-cmp-data-layer="{&quot;text-1ab6310fc5&quot;:{&quot;@type&quot;:&quot;akamai/components/brand-cl/text&quot;,&quot;repo:modifyDate&quot;:&quot;2026-01-13T17:48:39Z&quot;,&quot;xdm:text&quot;:&quot;<p>© 2026 Akamai Technologies</p>\r\n&quot;}}">
    <p>© 2026 Akamai Technologies</p>

</div>

    


</div>

                        
                    </div>
                </div>
            </div>
		</div>
	</div>
</div>
</div>
<div class="embed-unsafe embed">
<div id="embed-unsafe-f46c8183b7" class="cmp-embed">
    
    
    
</div>

    

</div>

		
	</div>

</div>

    

<span style="display:none"></span></div>
</main>
    
    
    


    




  
  
    






  
    




  




    

    

    



    
    




    
    

    




    





<div id="qTeW4iVbaUJaOoBh" tabindex="-1" height="0" width="0" style="display: none; visibility: hidden;" data-original-tag="iframe"></div><div tabindex="-1" style="display: none; visibility: hidden;"></div></body></html>