# https://neodyme.io/en/blog/com_hijacking_1/#hijacking-a-com-interface

<!DOCTYPE html><html lang="en" class="2xl:text-[20px]"> <body class="antialiased text-gray-900 dark:text-slate-300 tracking-tight bg-white dark:bg-neutral-900">   <main>  <section class="py-8 sm:py-16 lg:py-20 mx-auto"> <article> <div class="flex"> <div class="grow"></div> <div class="grow" style="max-width: 100vw;">  <div class="container mx-auto px-6 sm:px-6 mt-4 max-w-5xl">
Authored by: <ul class="text-sm"><li class="bg-gray-100 dark:bg-slate-700 inline-flex items-center space-x-1 mr-2 mb-2 py-0.5 px-2 rounded"><a href="https://neodyme.io/en/blog/author/alain" class="font-semibold text-gray-800 dark:text-gray-100 pr-0.5">Alain</a><a class="text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 rounded-lg text-sm pl-1.0 inline-flex items-center" aria-label="x" href="https://x.com/0x4d5aC" target="_blank"><svg width="1em" height="1em" viewBox="0 0 24 24" class="w-3 h-3" data-icon="tabler:brand-x">  <use xlink:href="#ai:tabler:brand-x"></use>  </svg></a><a class="text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 rounded-lg text-sm pl-1.0 inline-flex items-center" aria-label="bluesky" href="https://bsky.app/profile/0x4d5a.bsky.social" target="_blank"><svg width="1em" height="1em" viewBox="0 0 24 24" class="w-3 h-3" data-icon="tabler:brand-bluesky">  <use xlink:href="#ai:tabler:brand-bluesky"></use>  </svg></a><a class="text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 rounded-lg text-sm pl-1.0 inline-flex items-center" aria-label="linkedin" href="https://www.linkedin.com/in/alain-r%C3%B6del-27ab42272/" target="_blank"><svg width="1em" height="1em" viewBox="0 0 24 24" class="w-3 h-3" data-icon="tabler:brand-linkedin">  <use xlink:href="#ai:tabler:brand-linkedin"></use>  </svg></a><a class="text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 rounded-lg text-sm pl-1.0 inline-flex items-center" aria-label="email" href="mailto:alain@neodyme.io" target="_blank"><svg width="1em" height="1em" viewBox="0 0 32 32" class="w-3 h-3" data-icon="carbon:email">  <symbol id="ai:carbon:email"><path fill="currentColor" d="M28 6H4a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h24a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2m-2.2 2L16 14.78L6.2 8ZM4 24V8.91l11.43 7.91a1 1 0 0 0 1.14 0L28 8.91V24Z"></path></symbol><use xlink:href="#ai:carbon:email"></use>  </svg></a></li><li class="bg-gray-100 dark:bg-slate-700 inline-flex items-center space-x-1 mr-2 mb-2 py-0.5 px-2 rounded"><a href="https://neodyme.io/en/blog/author/kolja" class="font-semibold text-gray-800 dark:text-gray-100 pr-0.5">Kolja</a><a class="text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 rounded-lg text-sm pl-1.0 inline-flex items-center" aria-label="linkedin" href="https://www.linkedin.com/in/kolja-grassmann-947b112b9/" target="_blank"><svg width="1em" height="1em" viewBox="0 0 24 24" class="w-3 h-3" data-icon="tabler:brand-linkedin">  <use xlink:href="#ai:tabler:brand-linkedin"></use>  </svg></a><a class="text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 rounded-lg text-sm pl-1.0 inline-flex items-center" aria-label="email" href="mailto:kolja@neodyme.io" target="_blank"><svg width="1em" height="1em" viewBox="0 0 32 32" class="w-3 h-3" data-icon="carbon:email">  <use xlink:href="#ai:carbon:email"></use>  </svg></a></li></ul> </div>  <div class="container mx-auto px-6 sm:px-6 prose prose-base dark:prose-invert dark:prose-headings:text-slate-300 prose-md prose-headings:font-heading prose-headings:leading-tighter prose-headings:tracking-tighter prose-headings:font-bold prose-a:text-primary-600 dark:prose-a:text-primary-400 prose-img:rounded-md prose-img:shadow-lg mt-8 max-w-5xl"> <h2 id="introduction">Introduction<a aria-hidden="true" tabindex="-1" style="text-decoration:none;padding-left:10px" href="https://neodyme.io/en/blog/com_hijacking_1/#introduction"><span class="visually-hidden">¶</span></a></h2>
<p>Antivirus (AV) and Endpoint Detection and Response (EDR) products are critical in securing systems in enterprise environments or personal setups.
These products are designed to protect devices, but their widespread use — particularly in enterprises — means vulnerabilities in these products can significantly impact overall security.
We previously analyzed <a href="https://neodyme.io/en/blog/wazuh_rce/">Wazuh</a> and found vulnerabilities that would have allowed lateral movement in the organization’s network.
In this series, we will discuss how we identified vulnerabilities in multiple security products that could, in theory, allow privilege escalation to <code>SYSTEM</code> on millions of devices, assuming initial access was gained.
We will introduce the general design of the targeted security products to give you some background information on the mechanisms that allowed us to escalate our privileges.</p>
<p>
					</p><div class="flex flex-row items-center gap-x-2 bg-gray-100 dark:bg-slate-700 rounded p-2">
						<svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-neodyme-blue" viewBox="0 0 24 24"><path fill="currentColor" d="M13 9h-2V7h2m0 10h-2v-6h2m-1-9A10 10 0 0 0 2 12a10 10 0 0 0 10 10a10 10 0 0 0 10-10A10 10 0 0 0 12 2Z"></path></svg>
						 We also held a talk about this blog content at the 38c3 conference in Hamburg, Germany. You can find the talk (in German) and slides (English) at the very end of this blogpost.
					</div>
				<p></p>
<p>
					</p><figure>
						<img src="https://neodyme.io/blog/com_hijacking_1/cve_list.png" alt="An overview of the CVEs we found during this research" style="width:100%;margin:0 auto">
						<figcaption>
							<p>
								An overview of the CVEs we found during this research
							</p>
						</figcaption>
					</figure>
					<p></p>
<h2 id="technical-background">Technical Background<a aria-hidden="true" tabindex="-1" style="text-decoration:none;padding-left:10px" href="https://neodyme.io/en/blog/com_hijacking_1/#technical-background"><span class="visually-hidden">¶</span></a></h2>
<p>All the security products we examined include a user interface, which typically allows users to perform actions such as triggering filesystem scans, initiating updates, or modifying settings like excluded files.
For example, setting an exclusion should require high privileges to prevent malware from excluding itself from scans.
However, the user interface usually operates in the context of the user executing it. Especially in an enterprise setting, this user often lacks high privileges, as granting such privileges would violate good security practices.</p>
<h3 id="how-does-a-low-privileged-user-change-settings">How does a low-privileged user change settings?<a aria-hidden="true" tabindex="-1" style="text-decoration:none;padding-left:10px" href="https://neodyme.io/en/blog/com_hijacking_1/#how-does-a-low-privileged-user-change-settings"><span class="visually-hidden">¶</span></a></h3>
<p>Since the user interface cannot directly perform privileged actions, such as setting exclusions, a separate system process with higher privileges is required to execute these changes on behalf of the user interface.
In our analysis, we will refer to:</p>
<ul>
<li>The user interface  as the <em>front-end process</em>.</li>
<li>The highly privileged system process as the <em>back-end process</em>.</li>
</ul>
<p>To coordinate actions, the front-end process must communicate with the back-end process. Depending on the product, this communication occurs through named pipes, Remote Procedure Calls (RPC), or Component Object Model (COM) interfaces.
Across all products we examined, the back-end process ran with <code>SYSTEM</code> privileges.</p>
<h3 id="security-risks-in-back-end-communication">Security risks in back-end communication<a aria-hidden="true" tabindex="-1" style="text-decoration:none;padding-left:10px" href="https://neodyme.io/en/blog/com_hijacking_1/#security-risks-in-back-end-communication"><span class="visually-hidden">¶</span></a></h3>
<p>A natural concern arises:
Could malware abuse this communication to perform privileged actions?
If malicious software could directly interact with the back-end process, it could exploit this pathway to, for example, modify the registry or other sensitive settings.</p>
<p>To mitigate this, security products typically verify that actions initiated by the back-end process originate from a trusted source.
For example, they might check the signature of the executable initiating communication.</p>
<p>However, this safeguard is insufficient on its own, as Windows lacks strict boundaries between processes running under the same user account.
A process can read or write to the memory of other processes in the same user context.
It can even execute code within those processes.
As a result, malware could potentially hijack a trusted process to abuse its connection with the back-end process.</p>
<h3 id="protections-against-code-injection">Protections against code injection<a aria-hidden="true" tabindex="-1" style="text-decoration:none;padding-left:10px" href="https://neodyme.io/en/blog/com_hijacking_1/#protections-against-code-injection"><span class="visually-hidden">¶</span></a></h3>
<p>To address this risk, security vendors implement additional protections to secure the front-end process:</p>
<ul>
<li><strong>Filter Drivers</strong>: These intercept system calls and prevent handles with privileges that could allow code injection from being created for the front-end process. This measure blocks many common code injection techniques, often relying on acquiring such handles.</li>
<li><strong>DLL Allowlist Validation</strong>: During our testing, we observed measures that verify the location of loaded DLLs against an allowlist to prevent loading of untrusted DLLs.</li>
</ul>
<p>These defences significantly reduce the risk of untrusted code injection.</p>
<h3 id="communication-between-front-end-and-back-end-processes">Communication between front-end and back-end processes<a aria-hidden="true" tabindex="-1" style="text-decoration:none;padding-left:10px" href="https://neodyme.io/en/blog/com_hijacking_1/#communication-between-front-end-and-back-end-processes"><span class="visually-hidden">¶</span></a></h3>
<p>The diagram below illustrates the components involved in the communication between front-end and back-end processes:</p>
<p>
					</p><figure>
						<img src="https://neodyme.io/blog/com_hijacking_1/process_overview.png" alt="Overview of the components involved in typical communication between different processes of an EDR" style="width:75%;margin:0 auto">
						<figcaption>
							<p>
								Overview of the components involved in typical communication between different processes of an EDR
							</p>
						</figcaption>
					</figure>
					<p></p>
<p>Communication with the back-end process remains an attractive attack surface.
For example, attackers could exploit it to trigger privileged actions, such as modifying the registry, from an unprivileged context.
Manufacturers are aware of these risks and have implemented safeguards to prevent direct communication with the back-end process.
However, previously discovered vulnerabilities, such as those in Avast [1,2], have demonstrated that bypassing these protections is possible.</p>
<h3 id="exploiting-back-end-communication">Exploiting back-end communication<a aria-hidden="true" tabindex="-1" style="text-decoration:none;padding-left:10px" href="https://neodyme.io/en/blog/com_hijacking_1/#exploiting-back-end-communication"><span class="visually-hidden">¶</span></a></h3>
<p>To abuse back-end communication, an attacker must first establish a way to interact with the back-end process.
There are two primary approaches:</p>
<ol>
<li><strong>Exploit validation logic flaws</strong>: Identify weaknesses in the logic used by the back-end process to verify that requests originate from the front-end process.</li>
<li><strong>Inject code into the front-end process</strong>: Attackers can indirectly communicate with the back-end process by executing code within the trusted front-end process.</li>
</ol>
<p>In our research, we pursued the second approach.
Using COM hijacking, we successfully injected code into the front-end process, enabling us to communicate with the back-end process from within the trusted front-end.</p>
<h2 id="com-hijacking">COM hijacking<a aria-hidden="true" tabindex="-1" style="text-decoration:none;padding-left:10px" href="https://neodyme.io/en/blog/com_hijacking_1/#com-hijacking"><span class="visually-hidden">¶</span></a></h2>
<p>Component Object Model (COM) interfaces provide additional functionality to applications, offering a framework for interprocess communication and object reuse.
For instance, Windows Runtime (WinRT) is implemented based on COM.
A key advantage of COM is its abstraction: developers using COM interfaces do not need to understand the underlying implementation, which could be written in another language, executed in a separate process, or even reside on a remote server in the case of Distributed COM (DCOM).</p>
<p>Some COM interfaces implement their functionality through DLLs that are dynamically loaded into the calling process when the interface is invoked.
Hijacking such a COM interface allows injecting a custom DLL into the calling process, enabling code execution within the process’s context.</p>
<p>To use a COM interface the developer invokes the <code>CoCreateInstance</code> with a GUID, which then leads to a search of the right COM interface and returns a COM object if the interface is found. The following graphic gives a high level overview of how this could work for the TaskScheduler interface:</p>
<p>
					</p><figure>
						<img src="https://neodyme.io/blog/com_hijacking_1/com_intro.png" alt="Example COM lookup of the ITaskScheduler COM object" style="width:75%;margin:0 auto">
						<figcaption>
							<p>
								Example COM lookup of the ITaskScheduler COM object
							</p>
						</figcaption>
					</figure>
					<p></p>
<p>The core idea of COM hijacking is to exploit the registry’s search order for COM interface definitions.
When a COM interface is accessed, the system first looks for its definition in the <code>HKEY_CURRENT_USER</code> (HKCU) registry hive before checking the  <code>HKEY_LOCAL_MACHINE</code> (HKLM) hive.
If the COM interface uses a DLL to provide its functionality, the registry entry will include the path to the implementing DLL.
Since the HKCU hive belongs to the current user, it can be modified by processes running with that user’s privileges.
This means that any process running in the user’s context — including the front-end process of an EDR product running in the context of our unprivileged user — will prioritize COM definitions in the HKCU hive and stop searching once a match is found.
The following diagram shows the registry accesses before and after a COM hijack:</p>
<p>
					</p><figure>
						<img src="https://neodyme.io/blog/com_hijacking_1/com-hijacking.png" alt="Overview of the involved components" style="width:60%;margin:0 auto">
						<figcaption>
							<p>
								Overview of the involved components
							</p>
						</figcaption>
					</figure>
					<p></p>
<p>COM hijacking is most often discussed as a persistence technique.
For instance, attackers could hijack a COM interface known to be invoked, ensuring their payload is executed.
In our research, however, we employed COM hijacking differently.
Rather than using it solely for persistence, we specifically targeted the front-end process of EDR products to load a custom DLL.
This allowed us to execute code within the process context, leveraging the elevated privileges of the back-end process during communication.
Interestingly, this approach proved effective against many EDR products. There was similar research in the past, which abused COM hijacking to bypass the self defense of similar products [5]
Futhermore James Forshaw previously demonstrated its use against VirtualBox [3].</p>
<p>In all the EDR products we examined, COM interfaces were used in the front-end process.
Most of these interfaces were located under the HKLM hive, so there was no need to overwrite any data.
However, overwriting an interface in the HKCU hive would also have been possible.</p>
<p>After hijacking a COM interface, every invocation of the targeted interface in the user’s context would trigger our hijacked COM interface.
For our purposes, this enabled us to load our custom DLL into the front-end process whenever specific actions were performed, such as opening a file dialogue in the user interface.</p>
<p>Now that we have discussed COM-hijacking in theory, the next question is how we identified COM interfaces of interest within the front-end process.</p>
<h2 id="identifying-a-hijackable-com-interface">Identifying a hijackable COM interface<a aria-hidden="true" tabindex="-1" style="text-decoration:none;padding-left:10px" href="https://neodyme.io/en/blog/com_hijacking_1/#identifying-a-hijackable-com-interface"><span class="visually-hidden">¶</span></a></h2>
<p>The initial step in all the vulnerabilities we discovered involved achieving code execution in a front-end process via COM hijacking.
As this was similar across all the products we analyzed, we will outline the general process here instead of repeating it for each specific product.</p>
<p>We can see that each COM lookup is performed via a GUID that matches to an <code>CLSID</code> (Class ID). Now we can hunt for those GUIDs and figure out what COM objects are used by the product.</p>
<p>For each product, the first task was to identify a COM Interface used by the front-end process.</p>
<p>This required considering several factors:</p>
<ul>
<li>When is the COM interface invoked?
<ul>
<li>During the start of the UI</li>
<li>When entering a specific menu</li>
</ul>
</li>
<li>Is the COM interface used by other processes?
<ul>
<li>To avoid unintended consequences (e.g., disrupting explorer.exe), we ensured the interface was unique to the target process or could be safely used in parallel.</li>
</ul>
</li>
</ul>
<p>We used the <code>Process Monitor</code> from the <code>SysInternals</code> suit to identify relevant COM interfaces.
We first identified the process we wanted to target.
Then, we used a filter to view only events triggered by this process.
Next, we created a filter for registry events where the path contained <code>CLSID</code> and <code>InProcServer32</code>, indicating that the process tries to load a DLL used for a COM interface.</p>
<p>The following screenshot demonstrates how <code>explorer.exe</code> queries the relevant registry keys, providing insight into the COM interfaces it accesses:</p>
<p>
					</p><figure>
						<img src="https://neodyme.io/blog/com_hijacking_1/process_monitor_com.png" alt="Accesses to COM interfaces by explorer.exe">
						<figcaption>
							<p>
								Accesses to COM interfaces by explorer.exe
							</p>
						</figcaption>
					</figure>
					<p></p>
<p>After identifying a potential COM interface, the next step was to confirm if the front-end process loaded the referenced DLL.
We monitored file interactions and filtered paths containing the DLL name to do this.
If the DLL was loaded, it would trigger a load event for the DLL specified in the registry:</p>
<p>
					</p><figure>
						<img src="https://neodyme.io/blog/com_hijacking_1/process_monitor_dll.png" alt="Loading a DLL related to COM">
						<figcaption>
							<p>
								Loading a DLL related to COM
							</p>
						</figcaption>
					</figure>
					<p></p>
<p>Once a suitable interface was identified, the next step was to hijack it.</p>
<h2 id="hijacking-a-com-interface">Hijacking a COM interface<a aria-hidden="true" tabindex="-1" style="text-decoration:none;padding-left:10px" href="https://neodyme.io/en/blog/com_hijacking_1/#hijacking-a-com-interface"><span class="visually-hidden">¶</span></a></h2>
<p>One registry key we targeted across multiple products was:</p>
<div class="expressive-code"><link rel="stylesheet" href="https://neodyme.io/_astro/ec.pupay.css"><figure class="frame"><pre data-language="plaintext"><code><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">Computer\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\CLSID\\{9FC8E510-A27C-4B3B-B9A3-BF65F00256A8}</span></div></div></code></pre></figure></div>
<p>This COM interface loads the <code>dataexchange.dll</code> into the calling process.
To hijack the DLL, we first exported it:</p>
<div class="expressive-code"><figure class="frame"><pre data-language="plaintext"><code><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">reg export "HKLM\\SOFTWARE\\Classes\\CLSID\\{9FC8E510-A27C-4B3B-B9A3-BF65F00256A8}" .\export.reg /reg:64</span></div></div></code></pre></figure></div>
<p>Then, we opened the exported file <code>export.reg</code> in a text editor and changed the paths to <code>HKEY_CURRENT_USER</code>.
We also changed the file path to point to our custom DLL:</p>
<div class="expressive-code"><figure class="frame"><pre data-language="plaintext"><code><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">Windows Registry Editor Version 5.00</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">[HKEY_CURRENT_USER\\SOFTWARE\\Classes\\CLSID\\{9FC8E510-A27C-4B3B-B9A3-BF65F00256A8}]</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">[HKEY_CURRENT_USER\\SOFTWARE\\Classes\\CLSID\\{9FC8E510-A27C-4B3B-B9A3-BF65F00256A8}\\InProcServer32]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">@="C:\\\\poc\\\\dataxchange.dll"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">"ThreadingModel"="Both"</span></div></div></code></pre></figure></div>
<p>Next, we imported the modified registry export:</p>
<div class="expressive-code"><figure class="frame"><pre data-language="plaintext"><code><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">reg import .\export.reg /reg:64</span></div></div></code></pre></figure></div>
<p>With these modifications, all calls to this COM interface from the context of our unprivileged user would invoke our custom DLL.
This might lead to problems with other processes, so we should remove the hijack when we are done with exploitation.</p>
<p>Our DLL must export the functions the original COM DLL would expose to ensure smooth operation.
This can be achieved by proxying calls to the original DLL using a template such as:</p>
<div class="expressive-code"><figure class="frame"><pre data-language="cpp"><code><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">#include</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">&lt;windows.h&gt;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">#include</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">&lt;combaseapi.h&gt;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">#pragma</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">comment</span><span style="--0:#E1E4E8;--1:#24292E">( </span><span style="--0:#B392F0;--1:#6F42C1">linker</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#9ECBFF;--1:#032F62">"/export:DllGetClassObject"</span><span style="--0:#E1E4E8;--1:#24292E"> )</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">#define</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">ORIGINAL_COM_DLL_PATH</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"C:</span><span style="--0:#79B8FF;--1:#005CC5">\\</span><span style="--0:#9ECBFF;--1:#032F62">Windows</span><span style="--0:#79B8FF;--1:#005CC5">\\</span><span style="--0:#9ECBFF;--1:#032F62">System32</span><span style="--0:#79B8FF;--1:#005CC5">\\</span><span style="--0:#9ECBFF;--1:#032F62">dataxchange.dll"</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">void</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">Go</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">void</span><span style="--0:#E1E4E8;--1:#24292E">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">// Our payload</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">BOOL APIENTRY </span><span style="--0:#B392F0;--1:#6F42C1">DllMain</span><span style="--0:#E1E4E8;--1:#24292E">(HMODULE hModule,  DWORD  ul_reason_for_call, LPVOID lpReserved) {</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">switch</span><span style="--0:#E1E4E8;--1:#24292E"> (ul_reason_for_call)  {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">case</span><span style="--0:#E1E4E8;--1:#24292E"> DLL_PROCESS_ATTACH:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">break</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">case</span><span style="--0:#E1E4E8;--1:#24292E"> DLL_THREAD_ATTACH:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">break</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">case</span><span style="--0:#E1E4E8;--1:#24292E"> DLL_THREAD_DETACH:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">break</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">case</span><span style="--0:#E1E4E8;--1:#24292E"> DLL_PROCESS_DETACH:</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#BF3441">break</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> TRUE;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">typedef</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">HRESULT</span><span style="--0:#E1E4E8;--1:#24292E">(WINAPI </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E"> tDllGetClassObject)(REFCLSID rclsid, REFIID riid, LPVOID</span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E"> ppv);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#B392F0;--1:#6F42C1">STDAPI</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">DllGetClassObject</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#B392F0;--1:#6F42C1">REFCLSID</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#FFAB70;--1:#AE4B07">rclsid</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#B392F0;--1:#6F42C1">REFIID</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#FFAB70;--1:#AE4B07">riid</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#B392F0;--1:#6F42C1">LPVOID</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">FAR</span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#FFAB70;--1:#AE4B07">ppv</span><span style="--0:#E1E4E8;--1:#24292E">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">// Start our payload</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#B392F0;--1:#6F42C1">Go</span><span style="--0:#E1E4E8;--1:#24292E">();</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">// Load the original DLL and proxy the function call to it</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">tDllGetClassObject pDllGetClassObject;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">HMODULE hOrigDLL </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">LoadLibrary</span><span style="--0:#E1E4E8;--1:#24292E">(ORIGINAL_COM_DLL_PATH);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">pDllGetClassObject </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> (tDllGetClassObject) </span><span style="--0:#B392F0;--1:#6F42C1">GetProcAddress</span><span style="--0:#E1E4E8;--1:#24292E">(hOrigDLL, </span><span style="--0:#9ECBFF;--1:#032F62">"DllGetClassObject"</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> (</span><span style="--0:#F97583;--1:#BF3441">!</span><span style="--0:#E1E4E8;--1:#24292E">pDllGetClassObject)</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> S_FALSE;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">HRESULT hRes </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">pDllGetClassObject</span><span style="--0:#E1E4E8;--1:#24292E">(rclsid, riid, ppv);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> hRes;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div></code></pre></figure></div>
<p>At this point, we achieved code execution in the context of the targeted product.
So, the next step was to analyze the communication between the front-end and back-end processes for the specific product to get an idea of how to abuse this primitive.</p>
<h2 id="named-pipe-communication">Named pipe communication<a aria-hidden="true" tabindex="-1" style="text-decoration:none;padding-left:10px" href="https://neodyme.io/en/blog/com_hijacking_1/#named-pipe-communication"><span class="visually-hidden">¶</span></a></h2>
<p>Named pipes are a common method for communication between a server and one or more clients.
They are accessible using a unique name (as the name suggests) and often serve as a communication channel between security products’ front-end and back-end processes.</p>
<p>
					</p><figure>
						<img src="https://neodyme.io/blog/com_hijacking_1/named_pipes.png" alt="Typical Named Pipe Communication via the WinAPI" style="width:75%;margin:0 auto">
						<figcaption>
							<p>
								Typical Named Pipe Communication via the WinAPI
							</p>
						</figcaption>
					</figure>
					<p></p>
<p>We found that the easiest way to find out if a product uses named pipes was to use IONinja’s Pipe Monitor feature.
For this, you click “New Session”, select “Pipe Monitor” and enable “Run as administrator”.
You can click the “Capture” button in the top-right corner to start capturing named pipe traffic:</p>
<p>
					</p><figure>
						<img src="https://neodyme.io/blog/com_hijacking_1/ioninja_start.png" alt="Starting IONinja" style="width:75%;margin:0 auto">
						<figcaption>
							<p>
								Starting IONinja
							</p>
						</figcaption>
					</figure>
					<p></p>
<p>
					</p><figure>
						<img src="https://neodyme.io/blog/com_hijacking_1/ioninja_listen.png" alt="Listening to named pipes with IONinja" style="width:75%;margin:0 auto">
						<figcaption>
							<p>
								Listening to named pipes with IONinja
							</p>
						</figcaption>
					</figure>
					<p></p>
<p>With this, you can interact with the product’s user interface to generate pipe traffic and watch for captured named pipe traffic that corresponds to the interaction.
In our experience, there should be little named pipe communication on a vanilla system, so identifying the relevant communication should be straightforward if you have installed the product on a dedicated system.</p>
<p>Having identified the communication in <code>IONinja</code>, we have a pipe name and a process that opens the named pipe or writes to it.
We now need to identify the logic.
For this, we can look for strings beginning with <code>\\.\pipe\</code>, used when creating a named pipe.
The logic that interacts with the named pipe will likely reference this string.
You will also see calls to the <code>CreateNamedPipe</code> and <code>ConnectNamedPipe</code> functions.</p>
<p>For our initial target, all of this turned out to be unnecessary:  When capturing data over a named pipe, we observed plaintext communication, including what appeared to be a registry key:</p>
<p>
					</p><figure>
						<img src="https://neodyme.io/blog/com_hijacking_1/ioninja_registry.png" alt="Registry path in named pipe traffic" style="width:75%;margin:0 auto">
						<figcaption>
							<p>
								Registry path in named pipe traffic
							</p>
						</figcaption>
					</figure>
					<p></p>
<p>The next section will detail how we exploited this communication to gain high privileges.</p>
<h2 id="replaying-a-recorded-message">Replaying a recorded message<a aria-hidden="true" tabindex="-1" style="text-decoration:none;padding-left:10px" href="https://neodyme.io/en/blog/com_hijacking_1/#replaying-a-recorded-message"><span class="visually-hidden">¶</span></a></h2>
<p>As shown in the screenshot above, the traffic on the named pipe for our first target contained a registry path and was not obfuscated.
This message was sent every time we opened the front-end process.</p>
<p>Using <code>Process Monitor</code>, we observed that the back-end process accessed the registry key running as <code>SYSTEM</code>.
This seemed promising, as writing a registry key as <code>SYSTEM</code> could lead to privilege escalation…</p>
<p>To test this theory, we implemented the following steps:</p>
<ol>
<li><strong>Prepare the Payload</strong>: We wrote a small program and converted it into shellcode using <a href="https://github.com/TheWover/donut">donut</a>.</li>
<li><strong>Inject the Payload</strong>: Using our previously via COM hijacking loaded DLL, we injected the shellcode into the process. In the shellcode, we unloaded the DLL after a short sleep and then sent the modified data. This approach bypassed logic in the target process that appeared to validate loaded DLLs.  Although we didn’t confirm whether bypassing this validation was essential, avoiding an unsigned DLL during communication helped minimize suspicion.</li>
<li><strong>Initial Testing</strong>: To confirm our ability to replay the message, we modified the registry path in the recorded message. The modified path was successfully written to the registry:</li>
</ol>
<p>
					</p><figure>
						<img src="https://neodyme.io/blog/com_hijacking_1/registry_test_write.png" alt="Modified registry key written">
						<figcaption>
							<p>
								Modified registry key written
							</p>
						</figcaption>
					</figure>
					<p></p>
<p>We discovered that our ability to write registry keys was restricted to locations under the manufacturer’s designated registry path.
This limitation prevented us from writing keys like <code>RunOnce</code>, which could enable privilege escalation.</p>
<p>However, we identified a promising registry key named <code>Application Path</code>.
This key pointed to an application folder under <code>C:\Program Files (x86)</code>.
By modifying this path to one writable by us, we hypothesized that any high-privilege process loading from this path could execute our files, granting high privileges.</p>
<p>So, we modified the message again, choosing a path that would fit into the message without modifying any offsets.
After injecting our DLL into the process, we replayed the modified message to overwrite the <code>Application Path</code>.
Following a system restart, we observed that one of the privileged EDR processes executed files from the modified <code>Application Path</code>.
By placing our payload in this directory, we successfully gained <code>SYSTEM</code> privileges:</p>
<p>
					</p><figure>
						<img src="https://neodyme.io/blog/com_hijacking_1/process_start.png" alt="Processes being started from modified path as SYSTEM">
						<figcaption>
							<p>
								Processes being started from modified path as SYSTEM
							</p>
						</figcaption>
					</figure>
					<p></p>
<center><video controls="" width="900"><source src="https://neodyme.io/blog/com_hijacking_1/tm_lpe_poc.mp4" type="video/mp4"></video></center>
<h2 id="conclusion">Conclusion<a aria-hidden="true" tabindex="-1" style="text-decoration:none;padding-left:10px" href="https://neodyme.io/en/blog/com_hijacking_1/#conclusion"><span class="visually-hidden">¶</span></a></h2>
<p>This blog post explored the attack surface associated with the interaction between an AV/EDR’s front-end and back-end processes.
Key takeaways are:</p>
<ul>
<li><strong>Breaking Trust Assumptions</strong>: Using COM hijacking, we demonstrated how the assumption that the front-end process is inherently trusted can be exploited.</li>
<li><strong>Finding Hijackable Interfaces</strong>: We described our methodology for identifying and hijacking COM interfaces.</li>
<li><strong>Privilege Escalation via Named Pipes</strong>: We detailed how one target product communicated via named pipes and how replaying recorded messages enabled us to escalate privileges to SYSTEM.</li>
</ul>
<p>In the next blog post, we will explore reversing RPC via COM and present a more complex exploit to achieve <code>SYSTEM</code> privileges by targeting another security product.</p>
<h2 id="38c3-talk-and-slides">38c3 Talk and Slides<a aria-hidden="true" tabindex="-1" style="text-decoration:none;padding-left:10px" href="https://neodyme.io/en/blog/com_hijacking_1/#38c3-talk-and-slides"><span class="visually-hidden">¶</span></a></h2>
<p>We also gave a talk about this research at 38c3, which you can checkout here (note that at the time of writing it is only available in German):</p>
<gdpr-embed content="https://media.ccc.de/v/38c3-der-schlssel-zur-compromittierung-local-privilege-escalation-schwachstellen-in-av-edrs/oembed" props="allowfullscreen frameborder=0" class="w-full aspect-video"><div class="rounded-md bg-gray flex justify-center items-center flex-col h-64"><div class="block p-8"><p>By revealing the content you are aware that third-parties may collect personal information</p></div><button class="block rounded-md bg-neodyme py-3 px-4 font-medium text-white shadow hover:bg-neodyme focus:outline-none focus:ring-2 focus:ring-neodyme focus:ring-offset-2 focus:ring-offset-gray-900"><p>Reveal media.ccc.de stream</p></button></div></gdpr-embed>
<p>The slides for the talk can be found <a href="https://github.com/neodyme-labs/38c3_com_talk">on our GitHub</a>.</p>
<h2 id="resources">Resources<a aria-hidden="true" tabindex="-1" style="text-decoration:none;padding-left:10px" href="https://neodyme.io/en/blog/com_hijacking_1/#resources"><span class="visually-hidden">¶</span></a></h2>
<ol>
<li><a href="https://the-deniss.github.io/posts/2023/04/26/avast-privileged-arbitrary-file-create-on-quarantine.html">https://the-deniss.github.io/posts/2023/04/26/avast-privileged-arbitrary-file-create-on-quarantine.html</a></li>
<li><a href="https://the-deniss.github.io/posts/avast-privileged-arbitrary-file-create-on-restore/">https://the-deniss.github.io/posts/avast-privileged-arbitrary-file-create-on-restore/</a></li>
<li><a href="https://googleprojectzero.blogspot.com/2017/08/bypassing-virtualbox-process-hardening.html">https://googleprojectzero.blogspot.com/2017/08/bypassing-virtualbox-process-hardening.html</a></li>
<li><a href="https://pentestlab.blog/2020/05/20/persistence-com-hijacking/">https://pentestlab.blog/2020/05/20/persistence-com-hijacking/</a></li>
<li><a href="https://blog.silentsignal.eu/2018/01/08/bare-knuckled-antivirus-breaking/">https://blog.silentsignal.eu/2018/01/08/bare-knuckled-antivirus-breaking/</a></li>
</ol> </div>  </div> <div class="grow hidden md:block"> <div class="sticky right-0 toc"> <div class="ml-4 rounded-s-md pr-2 overflow-y-auto"> <div class="text-slate-400 text-sm pb-3">On this page</div> <ol class="pl-6"> <li class="toc"><div class="toc-link"><a class="text-slate-400 hover:text-slate-300 target:text-primary-400 toc_entries" href="https://neodyme.io/en/blog/com_hijacking_1/#introduction">Introduction</a></div></li><li class="toc"><div class="toc-link"><a class="text-slate-400 hover:text-slate-300 target:text-primary-400 toc_entries" href="https://neodyme.io/en/blog/com_hijacking_1/#technical-background">Technical Background</a></div><ol class="pl-6"> <li class="toc"><div class="toc-link"><a class="text-slate-400 hover:text-slate-300 target:text-primary-400 toc_entries" href="https://neodyme.io/en/blog/com_hijacking_1/#how-does-a-low-privileged-user-change-settings">How does a low-privileged user change settings?</a></div></li><li class="toc"><div class="toc-link"><a class="text-slate-400 hover:text-slate-300 target:text-primary-400 toc_entries" href="https://neodyme.io/en/blog/com_hijacking_1/#security-risks-in-back-end-communication">Security risks in back-end communication</a></div></li><li class="toc"><div class="toc-link"><a class="text-slate-400 hover:text-slate-300 target:text-primary-400 toc_entries" href="https://neodyme.io/en/blog/com_hijacking_1/#protections-against-code-injection">Protections against code injection</a></div></li><li class="toc"><div class="toc-link"><a class="text-slate-400 hover:text-slate-300 target:text-primary-400 toc_entries" href="https://neodyme.io/en/blog/com_hijacking_1/#communication-between-front-end-and-back-end-processes">Communication between front-end and back-end processes</a></div></li><li class="toc"><div class="toc-link"><a class="text-slate-400 hover:text-slate-300 target:text-primary-400 toc_entries" href="https://neodyme.io/en/blog/com_hijacking_1/#exploiting-back-end-communication">Exploiting back-end communication</a></div></li> </ol></li><li class="toc"><div class="toc-link"><a class="text-slate-400 hover:text-slate-300 target:text-primary-400 toc_entries" href="https://neodyme.io/en/blog/com_hijacking_1/#com-hijacking">COM hijacking</a></div></li><li class="toc"><div class="toc-link"><a class="text-slate-400 hover:text-slate-300 target:text-primary-400 toc_entries" href="https://neodyme.io/en/blog/com_hijacking_1/#identifying-a-hijackable-com-interface">Identifying a hijackable COM interface</a></div></li><li class="toc"><div class="toc-link"><a class="text-slate-400 hover:text-slate-300 target:text-primary-400 toc_entries hilight_toc" href="https://neodyme.io/en/blog/com_hijacking_1/#hijacking-a-com-interface">Hijacking a COM interface</a></div></li><li class="toc"><div class="toc-link"><a class="text-slate-400 hover:text-slate-300 target:text-primary-400 toc_entries" href="https://neodyme.io/en/blog/com_hijacking_1/#named-pipe-communication">Named pipe communication</a></div></li><li class="toc"><div class="toc-link"><a class="text-slate-400 hover:text-slate-300 target:text-primary-400 toc_entries" href="https://neodyme.io/en/blog/com_hijacking_1/#replaying-a-recorded-message">Replaying a recorded message</a></div></li><li class="toc"><div class="toc-link"><a class="text-slate-400 hover:text-slate-300 target:text-primary-400 toc_entries" href="https://neodyme.io/en/blog/com_hijacking_1/#conclusion">Conclusion</a></div></li><li class="toc"><div class="toc-link"><a class="text-slate-400 hover:text-slate-300 target:text-primary-400 toc_entries" href="https://neodyme.io/en/blog/com_hijacking_1/#38c3-talk-and-slides">38c3 Talk and Slides</a></div></li><li class="toc"><div class="toc-link"><a class="text-slate-400 hover:text-slate-300 target:text-primary-400 toc_entries" href="https://neodyme.io/en/blog/com_hijacking_1/#resources">Resources</a></div></li> </ol> </div> </div> <toc-helper data-headings="introduction,technical-background,how-does-a-low-privileged-user-change-settings,security-risks-in-back-end-communication,protections-against-code-injection,communication-between-front-end-and-back-end-processes,exploiting-back-end-communication,com-hijacking,identifying-a-hijackable-com-interface,hijacking-a-com-interface,named-pipe-communication,replaying-a-recorded-message,conclusion,38c3-talk-and-slides,resources"></toc-helper>  </div> </div>  <div class="container mx-auto px-6 sm:px-6 mt-8 flex justify-between flex-col sm:flex-row max-w-5xl"> <div> <ul class="mr-5"><li class="bg-gray-100 dark:bg-slate-700 inline-block mr-2 mb-2 py-0.5 px-2"><a class="capitalize" href="https://neodyme.io/en/blog/tag/com">COM</a></li><li class="bg-gray-100 dark:bg-slate-700 inline-block mr-2 mb-2 py-0.5 px-2"><a class="capitalize" href="https://neodyme.io/en/blog/tag/lpe">LPE</a></li><li class="bg-gray-100 dark:bg-slate-700 inline-block mr-2 mb-2 py-0.5 px-2"><a class="capitalize" href="https://neodyme.io/en/blog/tag/windows">Windows</a></li></ul> </div> <div class="mt-5 sm:mt-1 align-middle text-gray-500 dark:text-slate-600"> <span class="align-super font-bold">Share:</span> <button class="ml-2" title="Twitter Share" data-aw-social-share="twitter" data-aw-url="https://neodyme.io/en/blog/com_hijacking_1" data-aw-text="The Key to COMpromise - Pwning AVs and EDRs by Hijacking COM Interfaces, Part 1"><svg width="1.23em" height="1em" viewBox="0 0 256 209" class="w-6 h-6" data-icon="logos:twitter">  <symbol id="ai:logos:twitter"><path fill="#55acee" d="M256 25.45a105.04 105.04 0 0 1-30.166 8.27c10.845-6.5 19.172-16.793 23.093-29.057a105.183 105.183 0 0 1-33.351 12.745C205.995 7.201 192.346.822 177.239.822c-29.006 0-52.523 23.516-52.523 52.52c0 4.117.465 8.125 1.36 11.97c-43.65-2.191-82.35-23.1-108.255-54.876c-4.52 7.757-7.11 16.78-7.11 26.404c0 18.222 9.273 34.297 23.365 43.716a52.312 52.312 0 0 1-23.79-6.57c-.003.22-.003.44-.003.661c0 25.447 18.104 46.675 42.13 51.5a52.592 52.592 0 0 1-23.718.9c6.683 20.866 26.08 36.05 49.062 36.475c-17.975 14.086-40.622 22.483-65.228 22.483c-4.24 0-8.42-.249-12.529-.734c23.243 14.902 50.85 23.597 80.51 23.597c96.607 0 149.434-80.031 149.434-149.435c0-2.278-.05-4.543-.152-6.795A106.748 106.748 0 0 0 256 25.45"></path></symbol><use xlink:href="#ai:logos:twitter"></use>  </svg> </button> <button class="ml-2" title="Facebook Share" data-aw-social-share="facebook" data-aw-url="https://neodyme.io/en/blog/com_hijacking_1"><svg width="1em" height="1em" viewBox="0 0 256 256" class="w-6 h-6" data-icon="logos:facebook">  <symbol id="ai:logos:facebook"><path fill="#1877F2" d="M256 128C256 57.308 198.692 0 128 0C57.308 0 0 57.308 0 128c0 63.888 46.808 116.843 108 126.445V165H75.5v-37H108V99.8c0-32.08 19.11-49.8 48.348-49.8C170.352 50 185 52.5 185 52.5V84h-16.14C152.959 84 148 93.867 148 103.99V128h35.5l-5.675 37H148v89.445c61.192-9.602 108-62.556 108-126.445"></path><path fill="#FFF" d="m177.825 165l5.675-37H148v-24.01C148 93.866 152.959 84 168.86 84H185V52.5S170.352 50 156.347 50C127.11 50 108 67.72 108 99.8V128H75.5v37H108v89.445A128.959 128.959 0 0 0 128 256a128.9 128.9 0 0 0 20-1.555V165z"></path></symbol><use xlink:href="#ai:logos:facebook"></use>  </svg></button> <button class="ml-2" title="Linkedin Share" data-aw-social-share="linkedin" data-aw-url="https://neodyme.io/en/blog/com_hijacking_1" data-aw-text="The Key to COMpromise - Pwning AVs and EDRs by Hijacking COM Interfaces, Part 1"><svg width="1em" height="1em" viewBox="0 0 256 256" class="w-6 h-6" data-icon="logos:linkedin-icon">  <symbol id="ai:logos:linkedin-icon"><path fill="#0A66C2" d="M218.123 218.127h-37.931v-59.403c0-14.165-.253-32.4-19.728-32.4c-19.756 0-22.779 15.434-22.779 31.369v60.43h-37.93V95.967h36.413v16.694h.51a39.907 39.907 0 0 1 35.928-19.733c38.445 0 45.533 25.288 45.533 58.186zM56.955 79.27c-12.157.002-22.014-9.852-22.016-22.009c-.002-12.157 9.851-22.014 22.008-22.016c12.157-.003 22.014 9.851 22.016 22.008A22.013 22.013 0 0 1 56.955 79.27m18.966 138.858H37.95V95.967h37.97zM237.033.018H18.89C8.58-.098.125 8.161-.001 18.471v219.053c.122 10.315 8.576 18.582 18.89 18.474h218.144c10.336.128 18.823-8.139 18.966-18.474V18.454c-.147-10.33-8.635-18.588-18.966-18.453"></path></symbol><use xlink:href="#ai:logos:linkedin-icon"></use>  </svg> </button> <button class="ml-2" title="Whatsapp Share" data-aw-social-share="whatsapp" data-aw-url="https://neodyme.io/en/blog/com_hijacking_1" data-aw-text="The Key to COMpromise - Pwning AVs and EDRs by Hijacking COM Interfaces, Part 1"><svg width="1em" height="1em" viewBox="0 0 256 258" class="w-6 h-6" data-icon="logos:whatsapp-monochrome-icon">  <symbol id="ai:logos:whatsapp-monochrome-icon"><path fill="#455A64" d="M128.534 0c34.098.017 66.102 13.29 90.167 37.383c24.066 24.092 37.312 56.12 37.299 90.174c-.028 69.579-56.076 126.318-125.36 127.446l-2.103.017h-.053c-21.005-.007-41.65-5.194-60.051-15.045l-.86-.466L0 257.233l18.083-66.055C6.93 171.852 1.061 149.922 1.07 127.455C1.098 57.178 58.279 0 128.534 0m.044 21.53c-58.437 0-105.964 47.523-105.987 105.936c-.008 19.712 5.424 38.921 15.719 55.612l.478.769l2.52 4.009l-10.703 39.093l40.097-10.517l3.869 2.294c16.007 9.499 34.32 14.599 53.017 14.764l.905.004h.044c58.392 0 105.918-47.526 105.942-105.943c.01-28.308-10.998-54.927-31.001-74.952c-20.003-20.024-46.603-31.06-74.9-31.07m-45.17 47.063c2.122 0 4.25.02 6.104.115c1.956.096 4.581-.743 7.165 5.466c.992 2.38 2.5 6.057 4.044 9.813l.331.805c2.485 6.045 4.969 12.072 5.447 13.029c.795 1.593 1.325 3.455.264 5.579c-1.06 2.127-1.593 3.454-3.184 5.316c-1.593 1.858-3.344 4.153-4.777 5.579a57.05 57.05 0 0 0-.234.233l-.232.237c-1.42 1.469-2.608 3.153-.93 6.027c1.857 3.19 8.248 13.622 17.716 22.066c12.165 10.85 22.428 14.214 25.613 15.809c3.184 1.594 5.043 1.328 6.9-.8c1.859-2.124 7.961-9.298 10.085-12.487c2.123-3.188 4.246-2.655 7.166-1.593c1.387.505 5.654 2.511 10.092 4.649l1.38.666c4.443 2.15 8.776 4.288 10.29 5.046c3.185 1.595 5.309 2.392 6.104 3.719c.796 1.33.796 7.705-1.858 15.145c-2.653 7.44-15.378 14.23-21.497 15.146c-5.487.818-12.43 1.16-20.06-1.262c-4.624-1.47-10.558-3.429-18.157-6.71c-31.948-13.794-52.815-45.966-54.406-48.09l-.108-.144c-1.941-2.594-12.898-17.445-12.898-32.804c0-15.675 8.229-23.38 11.147-26.569c2.92-3.186 6.37-3.986 8.493-3.986"></path></symbol><use xlink:href="#ai:logos:whatsapp-monochrome-icon"></use>  </svg> </button> <button class="ml-2" title="Email Share" data-aw-social-share="mail" data-aw-url="https://neodyme.io/en/blog/com_hijacking_1" data-aw-text="The Key to COMpromise - Pwning AVs and EDRs by Hijacking COM Interfaces, Part 1"><svg width="1em" height="1em" viewBox="0 0 24 24" class="w-6 h-6" data-icon="tabler:mail">  <symbol id="ai:tabler:mail"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M3 7a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><path d="m3 7l9 6l9-6"></path></g></symbol><use xlink:href="#ai:tabler:mail"></use>  </svg> </button> </div> </div> </article> </section>  </main>      </body></html>