Title:
Windows is and always will be a Potatoland

Type:
Blog Post

Short Summary (4–8 sentences max):
- The post is an overview of “Potato” techniques in 2025: abusing COM/DCOM activation and RPC internals to coerce NTLM/Kerberos authentication and relay it for escalation and lateral movement.  
- It explains DCOM fundamentals (SCM, CLSID/AppID, RPCSS, OXID/OXID Resolver, EPM) and why registering/abusing a (fake) OXID Resolver enables inbound authentication from privileged COM servers (often SYSTEM or INTERACTIVE).  
- It surveys and compares modern tools and flows: ADCSCoercePotato and potato.py for CertifiedDCOM-style coercion against ADCS, RemotePotato0 for cross-session authentication coercion on multi-user hosts, and KrbRelay/RemoteKrbRelay for Kerberos-based relaying.  
- A key theme is that while LDAP relay paths were largely mitigated (RPC hardening / fixes), relaying to SMB and especially ADCS HTTP (ESC8) remains impactful, with Kerberos relaying being more “future-proof” as NTLM is deprecated.  
- The content is useful for red teams/pentesters to choose the right coercion/relay primitive per environment, and for defenders/admins to understand prerequisites and hardening priorities.  
- Mitigations emphasized include SMB signing, LDAP channel binding/RPC hardening effects, enforcing EPA on ADCS web enrollment (or disabling it), and moving toward Kerberos-only/NTLM disablement, plus relevant Windows event monitoring.

Technical Focus:
- COM/DCOM activation internals (SCM, CLSID/AppID, RPCSS, EPM, OXID Resolver)
- Authentication coercion via DCOM and fake OXID Resolver
- NTLM relay vs Kerberos relay tradeoffs
- ADCS ESC8 abuse via web enrollment (certsrv) and certificate-based takeover
- Cross-session authentication (session ID manipulation via ISpecialSystemProperties / SetSessionID)
- Hardening controls: SMB signing, EPA, channel binding, NTLM deprecation

Use Cases:
- Coerce machine account auth from ADCS (CertSrv DCOM) and relay to ADCS HTTP to obtain machine/DC certificates (ESC8)
- Cross-session capture/relay of another logged-in user’s authentication on RDP/terminal servers
- Kerberos relaying to SMB for remote execution, SAM/secrets dumping, or interactive share access
- Assess enterprise exposure: DCOM RemoteActivation permissions, ADCS web enrollment posture, SMB signing/EPA enforcement
- Build detections around logon/share/certificate issuance events tied to relay activity

Keywords:
DCOM, COM, RPCSS, Service Control Manager, CoCreateInstanceEx, CoGetInstanceFromIStorage, CLSID, AppID, OXID Resolver, RPC Endpoint Mapper, MSRPC, NTLM relay, Kerberos relay, ADCS, ESC8, certsrv, Extended Protection for Authentication (EPA), SMB signing, ISpecialSystemProperties, SetSessionID, RemotePotato0, KrbRelay, RemoteKrbRelay, ADCSCoercePotato, potato.py, ntlmrelayx, CVE-2015-2370, CVE-2017-0298