Title:
A dive into the PE file format – PE file structure (Part 4): Data Directories, Section Headers and Sections

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post explains key Portable Executable (PE) components: the Optional Header’s DataDirectory array, PE sections, and the IMAGE_SECTION_HEADER structure.  
- It clarifies what data directories are (RVA + size pointers to loader-relevant tables) and enumerates common directory types like Import, Export, Relocations, TLS, and Load Config.  
- It then describes common section purposes (.text, .data, .rdata, .rsrc, .reloc, .tls) and how section headers map file offsets to in-memory RVAs.  
- The article highlights practical nuances such as why VirtualSize and SizeOfRawData differ (file alignment padding vs. uninitialized data expansion in memory).  
- Useful for reverse engineers, malware analysts, exploit devs, and red teamers who need to parse/modify PE files or understand loader behavior.

Technical Focus:
- IMAGE_OPTIONAL_HEADER.DataDirectory / IMAGE_DATA_DIRECTORY (RVA, Size)
- PE data directory types (Import, Export, Reloc, TLS, Load Config, IAT, etc.)
- PE sections and “special section” semantics (.text, .rdata, .rsrc, .reloc, .tls)
- IMAGE_SECTION_HEADER fields (VirtualAddress, PointerToRawData, VirtualSize, SizeOfRawData)
- FileAlignment effects and disk-vs-memory layout differences
- Section Characteristics flags (R/W/X permissions)

Use Cases:
- Building or validating a PE parser (custom tooling, triage scripts)
- Manual PE inspection during malware analysis or incident response
- Modifying PE layout/sections for packers, loaders, or implants
- Understanding how imports/relocations/TLS are located via data directories
- Debugging mapping issues caused by alignment and size mismatches

Keywords:
PE, Portable Executable, winnt.h, IMAGE_OPTIONAL_HEADER, IMAGE_DATA_DIRECTORY, IMAGE_NUMBEROF_DIRECTORY_ENTRIES, IMAGE_DIRECTORY_ENTRY_IMPORT, IMAGE_DIRECTORY_ENTRY_EXPORT, IMAGE_DIRECTORY_ENTRY_BASERELOC, IMAGE_DIRECTORY_ENTRY_TLS, IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG, IMAGE_SECTION_HEADER, RVA, VirtualAddress, PointerToRawData, VirtualSize, SizeOfRawData, FileAlignment, section characteristics, .text, .rdata, .rsrc, .reloc, IAT