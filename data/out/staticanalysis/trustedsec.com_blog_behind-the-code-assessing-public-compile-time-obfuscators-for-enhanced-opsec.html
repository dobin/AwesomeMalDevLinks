# https://trustedsec.com/blog/behind-the-code-assessing-public-compile-time-obfuscators-for-enhanced-opsec

<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
  <body class="mx-auto lang-en section-blog type-blog antialiased overscroll-none">


	

    

<!-- Global Header -->

<!-- End Global Header -->
		<main id="main" class="main overflow-x-hidden">

			

   



<section class="c-page-header relative bg-code text-white">

    <div class="px-p24 mq768:px-p48 mq1024:px-p56 c-header-wrap v-blog-header">
    <div class="max-w-p1440 mx-auto">
      <div class="flex flex-col mq768:flex-row">
        <div class="flex relative z-20 items-center mq768:w-1/2 order-1 py-p48 mq1024:py-p56 mq768:pr-p64 mq1024:pr-p56">

          <div class="w-full">

            

  
<ul class="mb-p64 mq1024:mb-p80 flex flex-wrap text-white">
                <li class="after:content-['/'] last:after:hidden after:mx-p8"><a class="text-sm hover:underline focus:underline" href="https://trustedsec.com/blog">Blog</a></li>
            <li class="after:content-['/'] last:after:hidden after:mx-p8"><a class="text-sm hover:underline focus:underline" href="https://trustedsec.com/blog/behind-the-code-assessing-public-compile-time-obfuscators-for-enhanced-opsec">Behind the Code: Assessing Public Compile-Time Obfuscators for Enhanced OPSEC</a></li>
     </ul>
                        <div class="mb-p32">

                              <div class="mb-p16">
                  <span class="font-mono text-sm">March 05, 2024</span>
                </div>
              
                                                                <h1 class="text-h1 mq1280:text-title-xl">Behind the Code: Assessing Public Compile-Time Obfuscators for Enhanced&nbsp;OPSEC</h1>
                              
                                        </div>

                          <div class="mb-p16">
                <span class="text-h3 inline-block">
                  Written by
                                                            Christopher Paschen
                                                      </span>
              </div>
            


            
            
            
            <div class="mt-p64">
                              <span class="c-tag inline-block py-p6 px-p4 border border-gibson rounded-p6 text-gibson text-bd mr-p12 mb-p12 whitespace-nowrap">Research</span>
                          </div>
          </div>
        </div>

        <div class="mq768:flex overflow-hidden items-center mq768:justify-end mq768:w-paired-img max-w-p1080 -mx-p24 mq768:mx-none order-2 mq768:absolute inset-y-0 left-paired-img-plus" x-data="" x-fx-cloak="" x-fx.left.1200="2rem">
          <div class="relative mq768:static mq768:w-full h-full pt-full -mx-p24 mq768:mx-none">
                          <picture class=" w-full"><source type="image/webp" media="(min-width: 64rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-Covers/BehindTheCode_WebHero.jpg?w=600&amp;h=600&amp;q=90&amp;fm=webp&amp;fit=crop&amp;dm=1767064616&amp;s=9d544f69d271c7b82970bdb4a331dcb3, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-Covers/BehindTheCode_WebHero.jpg?w=900&amp;h=900&amp;q=90&amp;fm=webp&amp;fit=crop&amp;dm=1767064616&amp;s=3580e2d0e29a49ed49a10d97e2ef4f0a 1.5x"><source type="image/webp" media="(min-width: 64rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-Covers/BehindTheCode_WebHero.jpg?w=600&amp;h=600&amp;q=90&amp;auto=format&amp;fit=crop&amp;dm=1767064616&amp;s=7735082ee49eb42336902a43e87e75e1, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-Covers/BehindTheCode_WebHero.jpg?w=900&amp;h=900&amp;q=90&amp;auto=format&amp;fit=crop&amp;dm=1767064616&amp;s=ceb9609e493d131876b40ce45aaa3d37 1.5x"><source type="image/webp" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-Covers/BehindTheCode_WebHero.jpg?w=320&amp;h=320&amp;q=90&amp;fm=webp&amp;fit=crop&amp;dm=1767064616&amp;s=d345d63887f84c517da0390551def380, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-Covers/BehindTheCode_WebHero.jpg?w=480&amp;h=480&amp;q=90&amp;fm=webp&amp;fit=crop&amp;dm=1767064616&amp;s=87a4247991666fb7f5c2d51cd14d1f55 1.5x"><source type="image/webp" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-Covers/BehindTheCode_WebHero.jpg?w=320&amp;h=320&amp;q=90&amp;auto=format&amp;fit=crop&amp;dm=1767064616&amp;s=336fe63dd3a9b64214fe55c8c7bd3855, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-Covers/BehindTheCode_WebHero.jpg?w=480&amp;h=480&amp;q=90&amp;auto=format&amp;fit=crop&amp;dm=1767064616&amp;s=f20d86e60a47f43c82318253be8b6143 1.5x"><img class="c-img opacity-0 transition-all duration-300 absolute inset-0 object-cover w-full h-full object-center" src="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-Covers/BehindTheCode_WebHero.jpg?w=320&amp;h=320&amp;q=90&amp;auto=format&amp;fit=crop&amp;dm=1767064616&amp;s=336fe63dd3a9b64214fe55c8c7bd3855" loading="eager" x-data="image({mq1024:{width:600,height:600},DEFAULT:{width:320,height:320}})" :width="getSize()" :height="getSize('height')" alt=""></picture>                      </div>
        </div>
      </div>
    </div>
  </div>

</section>


      
			
						<div class="relative"><section id="contentWell-0" class="c-module relative bg-white text-black py-p64 mq768:py-p96" data-module-num="1" style="z-index: 0;"><div class="px-p24 mq768:px-p48 mq1024:px-p56"><div class="max-w-p1440 mx-auto"><div class="flex flex-col mq1024:flex-row" x-data="{ mobile: ! $breakpoint('mq1024') }" @resize.window="mobile = ! $breakpoint('mq1024')"><div class="mq1024:w-p320 mq1024:pr-p64 grow-0 shrink-0 mq1024:order-1"><div><div class="w-full"><p id="share-label" class="text-xs font-mono mb-p16">Share</p><ul id="share-icons" class="flex items-center" aria-describedby="share-label"><li class="ml-p12"><a href="https://trustedsec.com/blog/behind-the-code-assessing-public-compile-time-obfuscators-for-enhanced-opsec" target="_blank" title="Share URL" data-target="https://trustedsec.com/blog/behind-the-code-assessing-public-compile-time-obfuscators-for-enhanced-opsec"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-share"></use></svg></span><span class="sr-only">Share URL</span></a></li><li class="ml-p12"><a href="mailto:?subject=Check%20out%20this%20article%20from%20TrustedSec%21&amp;body=Behind%20the%20Code%3A%20Assessing%20Public%20Compile-Time%20Obfuscators%20for%20Enhanced%20OPSEC%3A%20https%3A%2F%2Ftrustedsec.com%2Fblog%2Fbehind-the-code-assessing-public-compile-time-obfuscators-for-enhanced-opsec" target="_blank" title="Share via Email" data-target="https://trustedsec.com/blog/behind-the-code-assessing-public-compile-time-obfuscators-for-enhanced-opsec"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-email"></use></svg></span><span class="sr-only">Share via Email</span></a></li><li class="ml-p12"><a href="http://www.facebook.com/sharer.php?u=https%3A%2F%2Ftrustedsec.com%2Fblog%2Fbehind-the-code-assessing-public-compile-time-obfuscators-for-enhanced-opsec" target="_blank" title="Share on Facebook" data-target="https://trustedsec.com/blog/behind-the-code-assessing-public-compile-time-obfuscators-for-enhanced-opsec"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-facebook"></use></svg></span><span class="sr-only">Share on Facebook</span></a></li><li class="ml-p12"><a href="http://twitter.com/share?text=Behind%20the%20Code%3A%20Assessing%20Public%20Compile-Time%20Obfuscators%20for%20Enhanced%20OPSEC%3A%20https%3A%2F%2Ftrustedsec.com%2Fblog%2Fbehind-the-code-assessing-public-compile-time-obfuscators-for-enhanced-opsec" title="Share on X" rel="nofollow" data-target="https://trustedsec.com/blog/behind-the-code-assessing-public-compile-time-obfuscators-for-enhanced-opsec"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-twitter"></use></svg></span><span class="sr-only">Share on X</span></a></li><li class="ml-p12"><a href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Ftrustedsec.com%2Fblog%2Fbehind-the-code-assessing-public-compile-time-obfuscators-for-enhanced-opsec&amp;mini=true" target="_blank" title="Share on LinkedIn" data-target="https://trustedsec.com/blog/behind-the-code-assessing-public-compile-time-obfuscators-for-enhanced-opsec"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-linkedin"></use></svg></span><span class="sr-only">Share on LinkedIn</span></a></li></ul></div></div></div><div class="w-full mq1024:w-content-well mq1024:order-2 flex-1"><div class="c-content"><p class="MsoNormal">Recently, I’ve seen an uptick in interest in compile-time obfuscation of native code through the use of <a href="https://llvm.org/">LLVM</a>. Many of the base primitives used to perform these obfuscation methods are themselves over a year old, and some of the initial research that I’m aware of is over a decade old at this point.</p><p class="MsoNormal">Given the prevalence of heuristics-based detections in a variety of AV engines, I wanted to attempt to find and perform a basic pass on whether compile-time obfuscation for native code yielded decreased or increased detection rates. I wanted to approach this from a naive point of view to see if large changes in detection rates could be observed with minimal input effort. This means that I will not be diving into how to interpret and understand LLVM IR/MIR formats (intermediate formats that optimization passes are performed on) nor how to write your own obfuscator.</p><p class="MsoNormal">Throughout this post, we will also be touching on creating an LLVM-based toolchain that compiles against the Microsoft SDK similar to cl.exe. This included compiling and statically linking against the C runtime used using the <em>/MT</em> option instead of always depending on dynamically linking to msvcrt.dll.</p><p class="MsoNormal">If you want to skip ahead, links to the various test results are available in the appendix at the end of this post.</p><h2>Environment Setup</h2><p class="MsoNormal">The primary obfuscation tool for native code that I am aware of is via obfuscation passes introduced into LLVM. We will examine public passes and their effects on the detection rates of native executables.</p><p class="MsoNormal">I must convey how the environment for these compilations are created such that you, as a reader, can recreate these experiments or potentially introduce compile-time obfuscation into your workflow.</p><h3><span>Native Code Obfuscation Setup</span></h3><p class="MsoNormal">To set up our obfuscation toolchain, we need to complete five (5) steps:</p><ol start="1"><li>Install LLVM/Clang from the system repository</li><li>Use xwin to download and set up the Windows SDK</li><li>Validate that we can produce a functional Windows binary</li><li>Download and modify a set of public LLVM obfuscation passes</li><li>Compile these passes and create a template makefile for future use</li><li>Validate that we can produce an obfuscated, functional binary</li></ol><p>For this blog post's purposes, the environment being used will consist of a Fedora 39 machine, using a LLVM-17-based toolchain with out-of-tree plugin passes. This toolchain will be configured to utilize the Visual Studio SDK and headers directly. Acquisition and layout of the visual studio environment is performed by <a href="https://github.com/Jake-Shadle/xwin">xwin</a>.</p><p class="MsoNormal">To install LLVM and the clang-cl front-end, open a command terminal on a Fedora-based Linux machine and execute:</p><pre><code>dnf install clang clang-libs clang-resource-filesystem llvm llvm-libs llvm-devel</code></pre><p class="MsoNormal">This will install LLVM and our clang-cl front-end, which will drive the compilation process. If you have not heard of clang-cl before, it is the MSVC (Microsoft Visual C++) compatible front-end for clang. When we intermix this with the SDK/headers we will download using xwin, it gives us an environment that creates executables as though you compiled it with Visual Studio on a Windows machine using clang. Note that the produced executable is different from when produced using cl.exe proper (e.g., the rich header is missing), but it will get us close enough and follows the format of what is now a drop-down option available in the foremost Windows native executable IDE.</p><p class="MsoNormal">With clang installed, we need to acquire and set up our Windows SDK. Copying the Windows SDK from a Visual Studio install and creating symlinks to deal with common differences such as file case sensitivity is possible but time consuming. Fortunately for us, xwin exists and will ease us through this process. <a href="https://github.com/Jake-Shadle/xwin/releases/tag/0.5.0">Download the latest xwin release from GitHub.</a> If you are using an x86-based Fedora Linux machine, you will want xwin-*-x86_64-unknown-linux-musl.tar.gz. Otherwise, you need to match the format for the host you will be running the xwin tool on.</p><p class="MsoNormal">After the download is complete, open a terminal in the directory of the extracted folder and execute the following commands to download the Microsoft SDK:</p><pre><code>mv xwin-* /&lt;final_home_partition&gt;
cd &lt;where you moved xwin to&gt;
./xwin --arch x86,x86_64 --accept-license splat --output &lt;final_home&gt; --preserve-ms-arch-notation</code></pre><p>In my case, &lt; final_home &gt; is /opt/winsdk.</p><p class="MsoNormal">Finally, we can test that we have created a working toolchain by making a basic message box program. The source code for this basic program, along with links to the rest of our code, is available <a href="https://github.com/trustedsec/LLVM-Obfuscation-Experiments/tree/main/goodware/MessageBox_Only">here</a>.</p><p class="MsoNormal">The message box code can be compiled against our clang setup using the following command:</p><pre><code> clang-cl /winsdkdir /opt/winsdk/sdk /vctoolsdir /opt/winsdk/crt /MT -fuse-ld=lld-link test.cpp user32.lib</code></pre><p class="MsoNormal">This executable can be transferred and tested on a Windows machine. As of this writing, the executable successfully executed on a Windows 10 system. With our working compiler, it is now possible to locate and configure some out-of-tree passes to use in our obfuscation testing.</p><p class="MsoNormal">For this experiment, the obfuscation passes will be a lightly modified fork of <span>&nbsp;</span><a href="https://github.com/AimiP02/BronyaObfus">https://github.com/AimiP02/BronyaObfus</a>. This repository was selected because the passes are already compatible with LLVM’s new pass manager. It is also relatively easy to split up the passes such that each can be fed individually into our compilation process. The modified fork used in the tests associated with this post is available <a href="https://github.com/freefirex/BronyaObfus">here</a>.</p><p class="MsoNormal">To compile the obfuscation passes, we will use cmake and a Unix makefile by running the following commands:</p><pre><code>git clone https://github.com/freefirex/BronyaObfus
cd BronyaObfus
mkdir build
cd build
cmake ..
make&nbsp;</code></pre><p class="MsoNormal">If you list the directory now, you should see a collection of .so files, namely libBogusControlFlow.so, libFlattening.so, libIndirectCall.so, libMBAObfuscation.so, and libStringObfuscation.so. With these shared object files, we can now introduce obfuscation passes to compilation.</p><p class="MsoNormal">Our last step is to validate that the passes we have just created can be used. First, let's create a template makefile that will assist with any future compilation work, as we’re about to have many different compilation flags. The template I created is available <a href="https://github.com/trustedsec/LLVM-Obfuscation-Experiments/blob/main/makefile.template">here</a>. At its core, it will compile all the files in src and optionally add obfuscation passes if obf(bogus|flat|indirect|mba|str) are added to the make command line. General usage might look like:</p><pre><code> make all obfbogus obfflat</code></pre><p class="MsoNormal">This will make all the files under src, adding bogus control flow and flattening.</p><h2>Test Setup</h2><p class="MsoNormal">All code being tested for this experiment will be housed under a GitHub repository <a href="https://github.com/trustedsec/LLVM-Obfuscation-Experiments">here.</a></p><p class="MsoNormal">The procedure is simple: create or find a code repository, compile it, and then upload the various iterations to VirusTotal to see how detection rates compare. This is not super scientific, and as the obfuscators have some degree of randomness in how they perform, it may not even be repeatable to the exact specification. For my part, though, I feel that this will give a good idea on the relationship between LLVM obfuscation passes and anti-virus detection rates.</p><p class="MsoNormal">I’ve split my tests into two (2) primary passes under the names Goodware and Malware. The Goodware pass focuses on how an obfuscation pass affects the detection of known “good” software. The presence of detections in this category represents false positives, either with the original source or introduced due to the use of obfuscation passes.</p><p class="MsoNormal">The second category, Malware, includes known open-source tools used by bad actors. Here, we’re looking more closely at the change in detection rates from the original compilation of the source. One item to note is that simply changing the compiler from what is normally used (mingw -&gt; clang-cl, msvc -&gt; clang-cl, etc.) already affects the detection ratio.</p><p class="MsoNormal">&nbsp;In all of these tests, if N/A or failed is present in a category, that means either the obfuscation pass outright failed (i.e., caused a segfault while running) or caused errors later in the linking pass.</p><p class="MsoNormal">&nbsp;Reasoning for each tested program was as follows:</p><p class="MsoNormal">Goodware:</p><ul><li>MessageBox -&gt; Exceedingly basic test to baseline from</li><li>SHA-256 -&gt; A legitimate but cryptographic operation</li><li>AES-256 -&gt; A legitimate but cryptographic operation</li><li>PuTTY -&gt; Well-known program that is capable of network communications</li><li>Capstone -&gt; Well-known library that would perform “odd” examination of machine code</li></ul><p class="MsoNormal">Malware:</p><ul><li>Arsenal Kit (Cobalt Strike) -&gt; Specifically was a test of the artifact kit portion, which in its base form should be well detected</li><li>Mimikatz -&gt; “We detect Mimikatz” is a phrase used by legitimate defenders</li><li>Throwback -&gt; One of the first C-based open-source implants I encountered</li><li>TrevorC2 -&gt; Another simple, open-source, C-based agent</li><li>COFFLoader -&gt; While not normally run standalone from disk, the technique used has been incorporated into multiple projects&nbsp;</li></ul><h2>Test Results</h2><p class="MsoNormal">Below are the results of the tests performed. I was honestly surprised at the lack of meaningful changes in detection rates both for Goodware and Malware. The only case where a meaningful reduction occurred was with Mimikatz, where at most eight (8) detections were dropped. In most other cases, detections were +- 2.<span>&nbsp; </span>For the malware samples specifically, detections were normally reduced, although we can see an increase of detections in the TrevorC2 agent.</p><p class="MsoNormal">I find it notable that PuTTY went from a standard compilation having zero (0) detections to causing false positives when obfuscation was used. In most other Goodware samples, existing false positives were either increased or decreased seemingly randomly by the use of obfuscation.</p><p class="MsoNormal">I also want to point out that the use of obfuscation passes caused the AES test suite to fail (image in appendix). I did not debug why these failures occurred, but it is a strong reminder that modifying code at compile time can introduce errors or conditions that would not normally be present. The possibility of such modifications should be strongly considered by teams looking to leverage this technology.</p><p class="MsoNormal">If you would like to see more information about the actual executables uploaded and discover if the detection rates of these samples have changed over time, I’ve included links to all of my VirusTotal uploads in the appendix.</p><div class="my-p56 flex justify-start"><figure class="inline-block"><picture class=" inline-block"><source type="image/webp" media="(min-width: 64rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig1_Paschen.png?w=1280&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1709217220&amp;s=61430452dfe6e51f3db4a424e4f7aa99, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig1_Paschen.png?w=912&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1709217220&amp;s=e1af1d304f1428a727cdc655e5a1b41b 1.5x"><source type="image/webp" media="(min-width: 64rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig1_Paschen.png?w=1280&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1709217220&amp;s=ea168d69d8b6c198fd84470ae5185ba4, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig1_Paschen.png?w=912&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1709217220&amp;s=a66f163d523c916c2d9e0a1b5b9569ae 1.5x"><source type="image/webp" media="(min-width: 48rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig1_Paschen.png?w=1024&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1709217220&amp;s=e60675dd8cf05c58ce131903ee09ec69, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig1_Paschen.png?w=912&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1709217220&amp;s=e1af1d304f1428a727cdc655e5a1b41b 1.5x"><source type="image/webp" media="(min-width: 48rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig1_Paschen.png?w=1024&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1709217220&amp;s=fd4836c17efdf01df63c3c532ddc2918, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig1_Paschen.png?w=912&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1709217220&amp;s=a66f163d523c916c2d9e0a1b5b9569ae 1.5x"><source type="image/webp" media="(min-width: 20rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig1_Paschen.png?w=720&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1709217220&amp;s=97391f13f02e3f90001a49b9dbe2322e, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig1_Paschen.png?w=912&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1709217220&amp;s=e1af1d304f1428a727cdc655e5a1b41b 1.5x"><source type="image/webp" media="(min-width: 20rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig1_Paschen.png?w=720&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1709217220&amp;s=30057f1028816fabae937e69d23e4991, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig1_Paschen.png?w=912&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1709217220&amp;s=a66f163d523c916c2d9e0a1b5b9569ae 1.5x"><source type="image/webp" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig1_Paschen.png?w=320&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1709217220&amp;s=40fa4cd1ea8fde0e7e0ea52478fb2352, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig1_Paschen.png?w=480&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1709217220&amp;s=b57dc79e36f6960608b30034877b5221 1.5x"><source type="image/webp" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig1_Paschen.png?w=320&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1709217220&amp;s=7fce82b2a7e0ca2e4c46ba4a1c750870, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig1_Paschen.png?w=480&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1709217220&amp;s=274c69912fe1e72840249c8e744e4a3b 1.5x"><img class="c-img opacity-0 transition-all duration-300" src="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig1_Paschen.png?w=320&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1709217220&amp;s=7fce82b2a7e0ca2e4c46ba4a1c750870" loading="lazy" x-data="image({mq1024:{width:608,height:378},mq768:{width:608,height:378},mq320:{width:608,height:378},DEFAULT:{width:320,height:199}})" :width="getSize()" :height="getSize('height')" alt=""></picture><figcaption class="c-caption font-mono text-xs">Figure 1 - Malware Detections</figcaption></figure></div><div class="my-p56 flex justify-start"><figure class="inline-block"><picture class=" inline-block"><source type="image/webp" media="(min-width: 64rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig2_Paschen.png?w=1280&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1709217221&amp;s=7158bade8e245e96afb70e5b008f2e71, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig2_Paschen.png?w=840&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1709217221&amp;s=69fbf2b7877a6bf3ac26abb5136d124d 1.5x"><source type="image/webp" media="(min-width: 64rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig2_Paschen.png?w=1280&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1709217221&amp;s=dea3af84d1fa51a57afaeef0e3bef7f8, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig2_Paschen.png?w=840&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1709217221&amp;s=814bf971ac6ac3bf34d733bf99eac3ae 1.5x"><source type="image/webp" media="(min-width: 48rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig2_Paschen.png?w=1024&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1709217221&amp;s=254d8cb70ed3ec8902c5a2a2af1fbd7e, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig2_Paschen.png?w=840&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1709217221&amp;s=69fbf2b7877a6bf3ac26abb5136d124d 1.5x"><source type="image/webp" media="(min-width: 48rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig2_Paschen.png?w=1024&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1709217221&amp;s=c7f09a5e5e5aceacbadc13074327072d, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig2_Paschen.png?w=840&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1709217221&amp;s=814bf971ac6ac3bf34d733bf99eac3ae 1.5x"><source type="image/webp" media="(min-width: 20rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig2_Paschen.png?w=720&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1709217221&amp;s=5c24a8db3d2598d4ad712d909ddae66f, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig2_Paschen.png?w=840&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1709217221&amp;s=69fbf2b7877a6bf3ac26abb5136d124d 1.5x"><source type="image/webp" media="(min-width: 20rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig2_Paschen.png?w=720&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1709217221&amp;s=7c98ce0078e38c5deacf54c4850683e1, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig2_Paschen.png?w=840&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1709217221&amp;s=814bf971ac6ac3bf34d733bf99eac3ae 1.5x"><source type="image/webp" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig2_Paschen.png?w=320&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1709217221&amp;s=33b4d1a723da07f1e1b19917285dde91, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig2_Paschen.png?w=479&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1709217221&amp;s=3115d3d014b09bd42c295a85c62a40e9 1.5x"><source type="image/webp" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig2_Paschen.png?w=320&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1709217221&amp;s=34666650499022d74e8bf28254196ff4, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig2_Paschen.png?w=479&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1709217221&amp;s=4eda387b41569e09814b1523df379228 1.5x"><img class="c-img opacity-0 transition-all duration-300" src="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig2_Paschen.png?w=320&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1709217221&amp;s=34666650499022d74e8bf28254196ff4" loading="lazy" x-data="image({mq1024:{width:560,height:440},mq768:{width:560,height:440},mq320:{width:560,height:440},DEFAULT:{width:319,height:251}})" :width="getSize()" :height="getSize('height')" alt=""></picture><figcaption class="c-caption font-mono text-xs">Figure 2 - Goodware Detections</figcaption></figure></div><h2><span>Conclusion</span></h2><p class="MsoNormal">I do not feel that adding LLVM obfuscation passes meaningfully impacts the detection ratio of native executables when considering disk scanning. It is entirely possible that when attempting to avoid a known signature use of LLVM obfuscation, passes could be effectively deployed to modify the machine code in such a way that either disk or memory-based scans would be defeated. I’m now of the opinion that if you want/need to use a technique and you know there are specific detections in place, then modifying the bad code manually is largely effective. In a world where ML/heuristic detections are seemingly more prevalent than static signatures, I do not believe LLVM-based obfuscation can be effectively leveraged without putting in a large initial effort to develop custom passes that are not designed to simply bypass static detections but rather target the nature of heuristic detections. Given that most of those algorithms are proprietary, developing such a pass is likely more time-consuming than it is worth for most organizations.</p><h2><span>Appendix</span>:</h2><h3>VT Scan Links:</h3><h4><span>Messagebox_Only</span>:</h4><ul><li><a href="https://www.virustotal.com/gui/file/fb789c1d51baea4c3a9529dfc8498f5ec2ee4c0e3b31a98f15149090351681b4?nocache=1">none &amp; mba</a></li><li><a href="https://www.virustotal.com/gui/file/92ec228e6bd3cb0cdb259b7340ddaf44e4351cfebc3242e1e9ff367a2a1611b9?nocache=1">str</a></li><li><a href="https://www.virustotal.com/gui/file/2f68e0f7ffb083d0c0c79667a06552c19589a79c9156beff2c9474c9b7596706?nocache=1">indirect</a></li><li><a href="https://www.virustotal.com/gui/file/bc5fb951e2e05620e0276879c5d61fa10578d555ef3fd660ffe3c5591c28bd1d?nocache=1">flat &amp; bogus</a></li><li><a href="https://www.virustotal.com/gui/file/2839679b0212c38135123cd937db0a7a5f7cee0551d7139114a047c53d96ff37?nocache=1">all</a></li></ul><h4><span>SHA-256:</span></h4><ul><li><a href="https://www.virustotal.com/gui/file/1654a75d7575117bf58d46a75385708100778c1a6128357cf4da3502f058c4e5/detection">none</a></li><li><a href="https://www.virustotal.com/gui/file/650ad0bcd7300bfe5f85126fa9181e7be4612d89ee0a2cb4bc438bf762ead9f2?nocache=1">mba</a></li><li><a href="https://www.virustotal.com/gui/file/94a8402cbb0a97f2f670059e44fe6198a1624aea11568ebe80a1424efaba3398?nocache=1">str</a></li><li><a href="https://www.virustotal.com/gui/file/9bc5d501173ab289d3159f92a6357cfc090676b7446031a94a5af4f1167474c0?nocache=1">indirect</a></li><li><a href="https://www.virustotal.com/gui/file/b04c9fff7ca2278821e28db8c840bbe59599549464bdda007311721af829eb33?nocache=1">flat</a></li><li><a href="https://www.virustotal.com/gui/file/7c3006c7fc766279b714e6b5f79488d7f5a8894d51904802e46f499e78f2548c?nocache=1">bogus</a></li><li><a href="https://www.virustotal.com/gui/file/a07069ab3b18d5af9e3a7dd8f964540a5cbb6532d13c817e3d938d1126465d14?nocache=1">all</a></li></ul><h4>PuTTY:</h4><ul><li><a href="https://www.virustotal.com/gui/file/890f715532b5ce6960e56f5743927afe6634fd8478a619669a403347da153e4f?nocache=1">none</a></li><li><a href="https://www.virustotal.com/gui/file/1f776af50d0616843a3f41e59f901a234c23a3af8c4321b9e3ebef389afbdcd7?nocache=1">mba</a></li><li>str - failed</li><li><a href="https://www.virustotal.com/gui/file/81a608e8f0b59afd00d4a6309a0b115fa59043a4ee75f1edcbdd521196fc428e?nocache=1">indirect</a></li><li><a href="https://www.virustotal.com/gui/file/5f4af2a6f9e33204c132ba5468af4e301da93098662b27336438a09806e2b0bf?nocache=1">flat</a></li><li><a href="https://www.virustotal.com/gui/file/ec21b0933a6c9ea4922abbbb4aeeec154e042bbe2dee425f9621882545223433">bogus</a></li><li><a href="https://www.virustotal.com/gui/file/db7ec5b451af694ad5b4f9f29c2d9256c92fdadb2d0d306d13c45db148b5acfd?nocache=1">all</a></li></ul><h4><span>Capstone</span>:</h4><ul><li><a href="https://www.virustotal.com/gui/file/88f265a416f21d92c5b79e1fadfe7ba290f3a2dcb6b25ffd606266708035989e?nocache=1">none</a></li><li><a href="https://www.virustotal.com/gui/file/f65c7192fb1724c967ca2e9a808fa0fff85ef92fb8bb78d568536daff5a3d6f9?nocache=1">mba</a></li><li>str - failed</li><li><a href="https://www.virustotal.com/gui/file/1d9686e5783300bea17ca2eea2c7ebee51ebe2c0a0107fb78123e4c55de6bc92?nocache=1">indirect</a></li><li><a href="https://www.virustotal.com/gui/file/ef3f48af7a5c778d0fdaec438a81973d6e9fe9306fcd68a4fc74497edc7e7f46?nocache=1">flat</a></li><li><a href="https://www.virustotal.com/gui/file-analysis/NTQ5MDFjYTlmZmUzMzI4YzMxNmJiYTFkZGQ0NmFhOWQ6MTcwNzQ5Mjc5NA==">bogus</a></li><li><a href="https://www.virustotal.com/gui/file/3598590510e86700f5df3e78f4f8b73ebdb1ded0a9aebbd05e7fb26a897e1eb9">all</a></li></ul><h4><span>AES-256:</span></h4><ul><li><a href="https://www.virustotal.com/gui/file/5a2ddc1de7cca18c4bf48c667fbb1e300ac4562d1de6bca4c00e8e373f932ad3?nocache=1">none</a></li><li><a href="https://www.virustotal.com/gui/file/a406d1924e5ddc3eb1aab78d56e78ea901c8072f204acb88d9f30e9dcf3797fc?nocache=1">mba</a></li><li>str - failed</li><li><a href="https://www.virustotal.com/gui/file/c0d42f57fa750a86aa32b6e4c915c53e1d6bfe6f1af9d9521b07814d4d61d13c?nocache=1">indirect</a></li><li><a href="https://www.virustotal.com/gui/file/64012f8a73059277a42f45f4b88e4f07f22672573e8823073596b664e8b3fea1?nocache=1">flat</a></li><li><a href="https://www.virustotal.com/gui/file/cd4907acce0a108ec2277350478dac34c734d76e992ddba11530b8957b1bc4d6?nocache=1">bogus</a></li><li><a href="https://www.virustotal.com/gui/file/145d58f258c9a6c9ef4c5aff16896af7d62ce6366ceb2f218de9928ed87cac1b?nocache=1">all</a><span>&nbsp;</span></li></ul><h4>Arsenal Kit:</h4><ul><li><a href="https://www.virustotal.com/gui/file/45f4f1b77b163015de5c7c9db5b2ea40ac8c0ba303d4b695c6478598eafd7d22">none</a></li><li><a href="https://www.virustotal.com/gui/file/19687e3e08616c34d0ba53bec0b71d429beb8c3f77cadc2e413ae3f1455bbb62?nocache=1">mba</a></li><li>str - failed</li><li><a href="https://www.virustotal.com/gui/file/a9e83476a151ac5615ccd72104e463fdc5e32886aa079170e6d6ecc54accb509?nocache=1">indirect</a></li><li><a href="https://www.virustotal.com/gui/file/7ff193c4e523722654362b7fcf0638c88978991bad709280224e494b61a0f505?nocache=1">flat</a></li><li><a href="https://www.virustotal.com/gui/file/78aaaa7d142a4175e5af288cb892f9c14955b269d6e17182b416193f1817516f?nocache=1">bogus</a></li><li><a href="https://www.virustotal.com/gui/file/7a44b67d7dc78da8ab4cf72b8684b71c7729a94106b53e480e52cde2fc47ec88">all</a></li><li><a href="https://www.virustotal.com/gui/file/ab28f977a4fee368eab15970a0135bf4df88c1b267bebd66bda3dbf02698b396?nocache=1">mingw compile</a></li></ul><h4>Mimikatz:</h4><ul><li><a href="https://www.virustotal.com/gui/file/1514ac9beb2abc42a6edd78843507576d0d9047461d3a73cc30d2057d7292d97">none</a></li><li>bogus - failed segfault</li><li>str - failed</li><li>indirect - failed</li><li><a href="https://www.virustotal.com/gui/file/d75bfaec3b4a373bf25614579f29802aee9d35d73b956ac5b7d061c5997bc36a?nocache=1">mba</a></li><li><a href="https://www.virustotal.com/gui/file/cb029be4b728c69ab32ecc04d45dfb394a5243f0f6d22710a32c60a4271d7f85?nocache=1">flattening</a></li><li><a href="https://www.virustotal.com/gui/file/69c63840787d75e471fc92a756543d0d502307150f4fad2ca29950f6e5d2bfcc?nocache=1">all</a></li></ul><h4>TrevorC2:</h4><ul><li><a href="https://www.virustotal.com/gui/file/b21dee59cc3236c228c2e2592c5b77a35f4b4ea074eeb94de469795f6861dcfa?nocache=1">none</a></li><li><a href="https://www.virustotal.com/gui/file/2c4b232605851053ecaa886dc6842a2cdeeb0982945f4f167b91b8c84d3e4449?nocache=1">bogus</a></li><li><a href="https://www.virustotal.com/gui/file/8a92ca149f1229855706943309f24e92c1f34ac3f4d0bb89a86f3e22ae2a6d30?nocache=1">str</a></li><li><a href="https://www.virustotal.com/gui/file/a7f6181008d48917773a3e9c01f4d235b7283b06225e5bdaa0a969ad0a381957?nocache=1">indirect</a></li><li><a href="https://www.virustotal.com/gui/file/e67efcf157af3c6a6363c9f2976b63ca2d68eeca6aea606c9ff6dd6caf6ffffe?nocache=1">mba</a></li><li><a href="https://www.virustotal.com/gui/file/8e4dafbc0abf2ca2c20a529c262140911d630ffabcfb79d0517cd1512342cebf?nocache=1">flat</a></li><li><a href="https://www.virustotal.com/gui/file/38805a6a44bae437bf8c8b868fe19282a00b42630c84fcd50f319c212c81c4a9?nocache=1">all</a></li></ul><h4>COFFLoader:</h4><ul><li><a href="https://www.virustotal.com/gui/file/5e7ef4503891932ea4e6f112b3cbf80f63dd2246ed7937af3a821278461b5dcd?nocache=1">none</a></li><li><a href="https://www.virustotal.com/gui/file/e6cf5058f4190cd23071abbedebbf20072fb931ec82e38f40442c644752c746b?nocache=1">bogus</a></li><li><a href="https://www.virustotal.com/gui/file/9214bb80fee16143078c3509e078d18612e3d9c808bde5488ddb8074770fd752?nocache=1">str</a></li><li><a href="https://www.virustotal.com/gui/file/c4116de73e3f73b796e6a3f7d94f6b996c0173c35bef44d47f7f34303da3c230?nocache=1">indirect</a></li><li><a href="https://www.virustotal.com/gui/file/6a180aec38a076b44329a17b70f0060400595adcfbaa1c77ff2faf6e2f179b2e?nocache=1">mba</a></li><li><a href="https://www.virustotal.com/gui/file/49e48ada2326d387503f8b98390b7d0879c944437b5bc836ecd07c79b1d6f045?nocache=1">flat</a></li><li><a href="https://www.virustotal.com/gui/file/496cc26a5eb7844c37e42d9b5f8bbe16d2888341a0793766e2a38ae82b5c65a6?nocache=1">all</a></li></ul><h4>Throwback:</h4><ul><li><a href="https://www.virustotal.com/gui/file/843a263ae0593e98fa9481a19b86d966f08f0ffd7dcffc88927563b91e6a8a5b?nocache=1">none</a></li><li>bogus - failed</li><li><span>str<a class="msocomanchor" href="https://trustedsec.com/blog/behind-the-code-assessing-public-compile-time-obfuscators-for-enhanced-opsec#_msocom_1">[BS1]</a>&nbsp;</span> - failed</li><li><a href="https://www.virustotal.com/gui/file/049afb36f3e633ed0f831b098c9142802f4ace0edb080ac8965bc8cdbdcfe312?nocache=1">indirect</a></li><li><a href="https://www.virustotal.com/gui/file/d44e57388d7a8758665cabfeae7ab2fddfce9330a04f3099e8d6cd756f4b51ab?nocache=1">mba</a></li><li><a href="https://www.virustotal.com/gui/file/a97fb9b93d85466d4a9aa2d1ae9a5178b70e7fbc426a25715d94325dd6ed35d0?nocache=1">flat</a></li><li><a href="https://www.virustotal.com/gui/file/7911517078addcb82c786ee30dfd917ac70ff8ee8abc566a67915bfab62f592d?nocache=1">all</a></li></ul><div class="my-p56 flex justify-start"><figure class="inline-block"><picture class=" inline-block"><source type="image/webp" media="(min-width: 64rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig3_Paschen.png?w=1280&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1709217223&amp;s=155fb3a7db3cf561d6e42a8c2a6de632, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig3_Paschen.png?w=720&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1709217223&amp;s=3ebba0856f5d1e8edaa71c2f6a51d149 1.5x"><source type="image/webp" media="(min-width: 64rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig3_Paschen.png?w=1280&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1709217223&amp;s=daa419b70820c763969a86278f655d08, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig3_Paschen.png?w=720&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1709217223&amp;s=430f099ce1bb246e61f65709aec0f9a4 1.5x"><source type="image/webp" media="(min-width: 48rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig3_Paschen.png?w=1024&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1709217223&amp;s=2323466a90ef088ce074b15a5fe3a286, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig3_Paschen.png?w=720&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1709217223&amp;s=3ebba0856f5d1e8edaa71c2f6a51d149 1.5x"><source type="image/webp" media="(min-width: 48rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig3_Paschen.png?w=1024&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1709217223&amp;s=d5cf5212b8af883f0d3c9667f937c1e7, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig3_Paschen.png?w=720&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1709217223&amp;s=430f099ce1bb246e61f65709aec0f9a4 1.5x"><source type="image/webp" media="(min-width: 20rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig3_Paschen.png?w=720&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1709217223&amp;s=3ebba0856f5d1e8edaa71c2f6a51d149, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig3_Paschen.png?w=720&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1709217223&amp;s=3ebba0856f5d1e8edaa71c2f6a51d149 1.5x"><source type="image/webp" media="(min-width: 20rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig3_Paschen.png?w=720&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1709217223&amp;s=430f099ce1bb246e61f65709aec0f9a4, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig3_Paschen.png?w=720&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1709217223&amp;s=430f099ce1bb246e61f65709aec0f9a4 1.5x"><source type="image/webp" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig3_Paschen.png?w=320&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1709217223&amp;s=5f1d373c408fdcfd275efa41e8a9f2a0, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig3_Paschen.png?w=480&amp;q=90&amp;fm=webp&amp;fit=max&amp;dm=1709217223&amp;s=c2bc9f06511cb36416ded97a7305d0f4 1.5x"><source type="image/webp" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig3_Paschen.png?w=320&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1709217223&amp;s=caa1e79313f79db0da201effe0ff2fc9, https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig3_Paschen.png?w=480&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1709217223&amp;s=e426761c6fe132627b3b9cb74bacc50e 1.5x"><img class="c-img opacity-0 transition-all duration-300" src="https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/BehindCode_Paschen/Fig3_Paschen.png?w=320&amp;q=90&amp;auto=format&amp;fit=max&amp;dm=1709217223&amp;s=caa1e79313f79db0da201effe0ff2fc9" loading="lazy" x-data="image({mq1024:{width:480,height:336},mq768:{width:480,height:336},mq320:{width:480,height:336},DEFAULT:{width:320,height:224}})" :width="getSize()" :height="getSize('height')" alt=""></picture><figcaption class="c-caption font-mono text-xs">Figure 3 - AES Test Suite Failing&nbsp;</figcaption></figure></div><h3>References:</h3><p class="MsoNoSpacing"><a href="https://github.com/B-Con/crypto-algorithms/tree/master">https://github.com/B-Con/crypto-algorithms/tree/master</a></p><p class="MsoNoSpacing"><a href="https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html">https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html</a></p><p class="MsoNoSpacing"><a href="https://github.com/capstone-engine/capstone/archive/5.0.tar.gz">https://github.com/capstone-engine/capstone/archive/5.0.tar.gz</a></p><p class="MsoNoSpacing"><a href="https://download.cobaltstrike.com/scripts">https://download.cobaltstrike.com/scripts</a></p><p class="MsoNoSpacing"><a href="https://github.com/gentilkiwi/mimikatz">https://github.com/gentilkiwi/mimikatz</a></p><p class="MsoNoSpacing"><a href="https://github.com/trustedsec/COFFLoader">https://github.com/trustedsec/COFFLoader</a></p><p class="MsoNoSpacing"><a href="https://github.com/trustedsec/trevorc2">https://github.com/trustedsec/trevorc2</a></p><p class="MsoNoSpacing"><a href="https://github.com/silentbreaksec/Throwback%EF%BF%BChttps://github.com/pavelliavonau/cmakeconverter">https://github.com/silentbreaksec/Throwback</a></p><p class="MsoNoSpacing"><a href="https://github.com/silentbreaksec/Throwback%EF%BF%BChttps://github.com/pavelliavonau/cmakeconverter">https://github.com/pavelliavonau/cmakeconverter</a></p></div><div class="mb-p24 mt-p56 pt-p32 border-t first:border-t-none"><div class="w-full"><p id="share-label" class="text-xs font-mono mb-p16">Share</p><ul id="share-icons" class="flex items-center" aria-describedby="share-label"><li class="ml-p12"><a href="https://trustedsec.com/blog/behind-the-code-assessing-public-compile-time-obfuscators-for-enhanced-opsec" target="_blank" title="Share URL" data-target="https://trustedsec.com/blog/behind-the-code-assessing-public-compile-time-obfuscators-for-enhanced-opsec"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-share"></use></svg></span><span class="sr-only">Share URL</span></a></li><li class="ml-p12"><a href="mailto:?subject=Check%20out%20this%20article%20from%20TrustedSec%21&amp;body=Behind%20the%20Code%3A%20Assessing%20Public%20Compile-Time%20Obfuscators%20for%20Enhanced%20OPSEC%3A%20https%3A%2F%2Ftrustedsec.com%2Fblog%2Fbehind-the-code-assessing-public-compile-time-obfuscators-for-enhanced-opsec" target="_blank" title="Share via Email" data-target="https://trustedsec.com/blog/behind-the-code-assessing-public-compile-time-obfuscators-for-enhanced-opsec"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-email"></use></svg></span><span class="sr-only">Share via Email</span></a></li><li class="ml-p12"><a href="http://www.facebook.com/sharer.php?u=https%3A%2F%2Ftrustedsec.com%2Fblog%2Fbehind-the-code-assessing-public-compile-time-obfuscators-for-enhanced-opsec" target="_blank" title="Share on Facebook" data-target="https://trustedsec.com/blog/behind-the-code-assessing-public-compile-time-obfuscators-for-enhanced-opsec"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-facebook"></use></svg></span><span class="sr-only">Share on Facebook</span></a></li><li class="ml-p12"><a href="http://twitter.com/share?text=Behind%20the%20Code%3A%20Assessing%20Public%20Compile-Time%20Obfuscators%20for%20Enhanced%20OPSEC%3A%20https%3A%2F%2Ftrustedsec.com%2Fblog%2Fbehind-the-code-assessing-public-compile-time-obfuscators-for-enhanced-opsec" title="Share on X" rel="nofollow" data-target="https://trustedsec.com/blog/behind-the-code-assessing-public-compile-time-obfuscators-for-enhanced-opsec"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-twitter"></use></svg></span><span class="sr-only">Share on X</span></a></li><li class="ml-p12"><a href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Ftrustedsec.com%2Fblog%2Fbehind-the-code-assessing-public-compile-time-obfuscators-for-enhanced-opsec&amp;mini=true" target="_blank" title="Share on LinkedIn" data-target="https://trustedsec.com/blog/behind-the-code-assessing-public-compile-time-obfuscators-for-enhanced-opsec"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-linkedin"></use></svg></span><span class="sr-only">Share on LinkedIn</span></a></li></ul></div></div></div></div></div></div></section></div>
		</main>

		
		




  
<div class="c-modal fixed inset-0 z-100 hidden" x-comp="modal" x-data="modal({id:'modal-component'})" x-show="$store.modal.show" x-trap="$store.modal.show" x-bind:aria-hidden="!$store.modal.show" @keydown="keyPress($event)" x-transition:enter="c-modal-enter" x-transition:enter-start="c-modal-enter-start" x-transition:enter-end="c-modal-enter-end" x-transition:leave="c-modal-leave" x-transition:leave-start="c-modal-leave-start" x-transition:leave-end="c-modal-leave-end">
    <div class="w-full h-full bg-overlay fixed inset-0 z-0" tabindex="-1">

    <div class="relative z-10 flex flex-col w-full h-full justify-center items-center p-p12 mq768:p-none">
      <div id="modal-component" class="c-modal-box relative outline-none" :class="modalClass(true)" :tabindex="($store.modal.show) ? '-1' : false" :aria-labelledby="showHeading() ? 'modal-component-title' : false" :aria-label="getLabel()" @focus="activate()" aria-role="dialog" x-ref="dialog">
        
          
        
        
          <div class="c-content p-p32" tabindex="-1" x-ref="content"></div>
        
        <button class="absolute z-50 overflow-hidden w-p24 h-p24 flex items-center justify-center border-black border top-p24 right-p24 group hover:bg-black" @click="closeModal()">
          <svg role="presentation" class="c-icon h-p12 w-p12 group-hover:fill-white"><use xlink:href="/ui/icons.svg?1.26#icon-close"></use></svg>
          <span class="sr-only">Close</span>
        </button>
        <button x-show="$store.modal.transcript" class="text-btn text-white uppercase tracking-widest px-p8 py-p16" @click="showTranscript($event)" x-text="$store.modal.showTranscript ? 'Hide Transcript' : 'Show Transcript'">Show Transcript</button>
      </div>
      <div x-show="$store.modal.showTranscript" class="relative -top-ms bg-white text-segment w-full max-w-p768 mx-auto overflow-auto px-sm" :class="modalClass()" x-ref="transcript">
        <div x-collapse.duration.700ms="">
          <div class="py-p32 mq768:px-p32" id="modal-transcript" tabindex="0"></div>
        </div>
      </div>
    </div>

  </div>
  </div>
		<!-- Start cookieyes banner --> 
 
<!-- End cookieyes banner -->

		
	</body></html>