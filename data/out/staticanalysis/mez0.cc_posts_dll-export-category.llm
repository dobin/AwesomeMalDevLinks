Title:
Categorising DLL Exports with an LLM

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post describes building a dataset of Windows DLL exported functions and using an LLM to categorize each export into malware-relevant technique buckets.  
- The goal is to support future work on classifying software (goodware/malware) based on import/export patterns, similar in spirit to malapi.io’s technique groupings.  
- The author extracts exports from `C:\Windows\System32` using `pefile`, selects a focused set of common DLLs (plus WinHTTP/WinINet), and enriches function names with offline Microsoft Win32 API markdown documentation cloned from GitHub.  
- A structured prompt is used to have ChatGPT/Claude assign each function a short description and one of several categories (e.g., injection, registry, network), with ChatGPT preferred due to better adherence to output format and cost.  
- Results are stored as JSON/CSV, summarized by category counts, and proposed as a feature-engineering approach for later machine learning (category frequency vectors per sample).  
- Useful for malware analysts, threat researchers, and defenders building static-analysis features, as well as red teamers interested in import-based behavioral clustering.

Technical Focus:
- PE export parsing with Python (`pefile`) and dataset construction
- Offline Win32 API documentation ingestion (MicrosoftDocs markdown)
- LLM prompt engineering for structured classification (ChatGPT vs Claude)
- Technique/category taxonomy for Windows API usage (injection, registry, network, etc.)
- Feature engineering for ML from import/category counts
- Data quality issues: missing docs/failed lookups and normalization

Use Cases:
- Build import/export-based malware family clustering features
- Generate technique-labeled Windows API datasets for static analysis
- Create ML-ready vectors from API category frequencies per binary
- Assist triage by mapping suspicious imports to behavioral categories
- Compare/validate LLMs for structured enrichment of reverse-engineering metadata

Keywords:
Windows DLL exports, PE parsing, pefile, System32, Win32 API, MicrosoftDocs, SDK API markdown, offline documentation, LLM, prompt engineering, ChatGPT, Claude, gpt-4o-mini, malware analysis, import analysis, static analysis, API categorization, DLL injection, registry operations, network operations, feature engineering, machine learning dataset