Title:
GoStringUngarbler: Deobfuscating Strings in Garbled Binaries

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post analyzes how the Go obfuscator/compiler wrapper **garble** encrypts string literals (via `-literals`) and why that breaks static string-based reverse engineering of Go malware.  
- It breaks down garble’s literal transformation families—**stack** (simple/swap/shuffle), **seed** (chained evolving seed), and **split** (chunking + switch-based state machine)—and shows what their decryptor stubs look like in decompiled/disassembled output.  
- The authors introduce **GoStringUngarbler**, an open-source Python CLI that automatically finds garble string-decrypting subroutines by matching instruction patterns around the call to `runtime_slicebytetostring`, then uses **Unicorn** emulation to recover plaintext strings.  
- Beyond extraction, the tool can **patch** each decryptor subroutine into a minimal stub and store recovered strings in-place, producing a functionally equivalent binary with plaintext strings for easier static analysis.  
- It also derives a **YARA rule** to detect garble literal obfuscation and discusses version sensitivity (Go 1.21–1.23) handled via a plugin architecture.  
- Useful primarily for **malware reverse engineers** and **threat intel/DFIR** teams dealing with Go malware, and secondarily for **detection engineers** building signatures.

Technical Focus:
- Garble `-literals` string obfuscation internals (AST-based transformations)
- Decryptor subroutine identification via `runtime_slicebytetostring` call-site patterns
- Instruction-pattern/regex matching for Go x64 prologues/epilogues
- Unicorn-based instruction-level emulation for string recovery
- Binary patching of decryptor routines + in-place plaintext string storage
- YARA detection for garble-obfuscated Go binaries

Use Cases:
- Rapidly recover plaintext strings from garble-obfuscated Go malware (PE/ELF)
- Produce “deobfuscated” binaries to improve IDA/Ghidra static analysis workflows
- Build/validate YARA detections for garble literal obfuscation
- Triage and classify Go samples when symbols are stripped and names mangled
- Automate string recovery at scale in malware pipelines

Keywords:
Go, garble, -literals, string encryption, deobfuscation, runtime_slicebytetostring, Go compiler 1.21, Go compiler 1.22, Go compiler 1.23, PE, ELF, x64, Unicorn Engine, emulation, binary patching, IDA Pro, YARA, AST manipulation, reverse engineering, malware analysis