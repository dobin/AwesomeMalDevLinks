Title:
A dive into the PE file format – PE file structure (Part 5): PE Imports (Import Directory Table, ILT, IAT)

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post explains how Windows PE files represent and resolve imported DLL functions via the `.idata` section.  
- It breaks down the Import Directory Table as an array of `IMAGE_IMPORT_DESCRIPTOR` entries (one per imported DLL) and how these point to the Import Lookup Table (ILT/INT) and Import Address Table (IAT).  
- It covers how ILT entries encode “import by name” vs “import by ordinal” and how `IMAGE_IMPORT_BY_NAME` (Hint/Name table) is used by the loader to find exports efficiently.  
- It also introduces bound imports and the Bound Import Data Directory (`IMAGE_BOUND_IMPORT_DESCRIPTOR`), explaining how precomputed addresses can speed loading but may be re-resolved at runtime if mismatched.  
- The post finishes with a practical walkthrough using a PE viewer (PE-bear) to locate an import (e.g., `USER32.dll!MessageBoxA`) and interpret the raw structures.  
- Useful for reverse engineers, malware analysts, exploit devs, and red teamers who need to parse/modify imports or understand loader behavior.

Technical Focus:
- PE `.idata` layout and Data Directories
- `IMAGE_IMPORT_DESCRIPTOR` (Import Directory Table)
- ILT/INT encoding (name vs ordinal imports)
- `IMAGE_IMPORT_BY_NAME` Hint/Name resolution mechanics
- IAT population at load time (thunk patching)
- Bound imports (`IMAGE_BOUND_IMPORT_DESCRIPTOR`) and timestamps

Use Cases:
- Manually parsing PE imports during reverse engineering
- Building/understanding custom PE loaders and reflective loading logic
- IAT hooking and import table patching for instrumentation or implants
- Detecting/triaging suspicious import patterns (e.g., unusual ordinals, tampered tables)
- Understanding bound import artifacts when analyzing binaries

Keywords:
PE, Portable Executable, .idata, Import Directory Table, IMAGE_IMPORT_DESCRIPTOR, Import Lookup Table, ILT, Import Name Table, INT, Import Address Table, IAT, thunk, IMAGE_IMPORT_BY_NAME, Hint/Name table, import by ordinal, import by name, bound imports, IMAGE_BOUND_IMPORT_DESCRIPTOR, TimeDateStamp, PE-bear