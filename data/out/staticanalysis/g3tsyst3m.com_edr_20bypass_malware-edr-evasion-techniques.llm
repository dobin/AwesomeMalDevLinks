Title:
Malware EDR Evasion Techniques (Obfuscated JavaScript Dropper + Static Debugging)

Type:
Blog Post

Short Summary (4–8 sentences max):
- This write-up analyzes an obfuscated Windows Script Host JavaScript (.js) “first-stage” dropper and explains why .js is still effective against many EDR stacks compared to .exe/.ps1.  
- The sample uses simple XOR string encoding, scrambled variable names, and WSH `ActiveXObject('WScript.Shell')` execution to build and run a command line at runtime.  
- The payload retrieval is “living off the land” by invoking `curl` to download a secondary file from a GitHub raw URL into `C:\Users\Public\`.  
- The author demonstrates safe static analysis by commenting out ActiveX execution and using Node.js Inspector (`node inspect`) with watchers/breakpoints to decode the strings without detonating the script.  
- It includes example encoder/decoder scripts showing how the XOR obfuscation is generated and reversed.  
- Useful for red teamers/pentesters building or analyzing initial access droppers, and for blue teamers understanding a common low-sophistication-but-effective evasion pattern and where to apply controls (e.g., WDAC/GPO).

Technical Focus:
- Windows Script Host (WSH) JScript execution and `WScript.Shell` ActiveX usage
- XOR-based string obfuscation and runtime deobfuscation (`String.fromCharCode`, `^`)
- LOLBin/LOLBAS-style payload retrieval via `curl`
- Static debugging/deobfuscation with Node.js Inspector (watchers, breakpoints)
- Staged downloaders and GitHub raw content as payload hosting
- Basic defensive guidance: WDAC / application control for script execution

Use Cases:
- Deobfuscate and triage suspicious .js droppers without executing network actions
- Build quick-and-dirty staged downloaders that avoid obvious PowerShell patterns
- Create detection logic for WSH spawning `curl` and writing to public/user-writable paths
- Validate EDR coverage gaps around script-based initial access and LOLBin chaining
- Harden endpoints by restricting WSH/.js execution via WDAC/AppLocker/GPO

Keywords:
Windows Script Host, JScript, .js dropper, ActiveXObject, WScript.Shell, cscript, wscript, XOR obfuscation, String.fromCharCode, Node.js Inspector, node inspect, breakpoints, watchers, LOLBin, curl, staged downloader, GitHub raw, C:\\Users\\Public, WDAC, AppLocker, EDR evasion