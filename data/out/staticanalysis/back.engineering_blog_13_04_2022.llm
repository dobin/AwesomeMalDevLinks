Title:
Writing a Mutation Engine and breaking Aimware (PERSES)

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post describes PERSES, an x86/x64 mutation (code obfuscation) engine that rewrites selected x86 instructions inside PE files into larger semantically-equivalent instruction sequences.  
- It focuses on operand encryption/decryption at runtime, mixed boolean arithmetic (MBA) expansions for ADD/XOR, and control-flow disruption (e.g., transforming CALL semantics into PUSH+JMP/RET patterns) to degrade decompiler analysis.  
- The author covers practical engineering challenges: preserving registers/EFLAGS, fixing relative branches, handling relocations, repairing RIP-relative addressing on x64, and updating jump tables after code growth.  
- PERSES uses Zydis for disassembly/segment parsing and AsmJit for re-assembly/label-based fixups, then links mutated code into a new PE section and detours original routines to the mutated versions.  
- A case study mutates large portions of CS:GO/engine.dll (17k+ routines), significantly reducing IDA’s function recognition and breaking Aimware due to failed signature scanning expectations.  
- Useful for reverse engineers, malware/packer developers, anti-cheat/DRM engineers, and defenders studying obfuscation and deobfuscation tradeoffs.

Technical Focus:
- x86/x64 instruction-level mutation and semantic-preserving transforms  
- Mixed Boolean Arithmetic (MBA) obfuscation for arithmetic/bitwise ops  
- PE relocations, RVAs, and base address recovery (PEB usage)  
- Control-flow obfuscation (CALL/JMP/RET manipulation, stub explosion)  
- Jump table recovery and fixups after code layout changes  
- Disassembly/assembly toolchains (Zydis instruction segments, AsmJit labels)

Use Cases:
- Obfuscating proprietary Windows binaries at the PE level without source changes
- Breaking signature-based scanners (e.g., cheat loaders, static byte-pattern detection)
- Researching decompiler failure modes and control-flow recovery techniques
- Building custom packers/protectors and evaluating commercial protector limitations
- Generating obfuscated samples to test reverse-engineering and analysis pipelines

Keywords:
PERSES, mutation engine, code obfuscation, x86, x64, Portable Executable, PE relocations, RVA, PEB, Zydis, ZydisGetInstructionSegments, AsmJit, mixed boolean arithmetic, MBA, control-flow obfuscation, CALL transformation, EFLAGS preservation, PUSHFD, PUSHFQ, RIP-relative addressing, jump tables, IDA Pro, Ghidra, detours, .reloc section, anti-cheat, CS:GO, Aimware, signature scanning