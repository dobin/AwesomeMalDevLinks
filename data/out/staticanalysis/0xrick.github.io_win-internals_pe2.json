"title='A dive into the PE file format - PE file structure - Part 1: Overview - 0xRick’s Blog' description='A dive into the PE file format - PE file structure - Part 1: Overview  Introduction  The aim of this post is to provide a basic introduction to the PE file structure without talking about any details.    PE files  PE stands for Portable Executable, it’s a file format for executables used in Windows operating systems, it’s based on the COFF file format (Common Object File Format).  Not only .exe files are PE files, dynamic link libraries (.dll), Kernel modules (.srv), Control panel applications (.cpl) and many others are also PE files.  A PE file is a data structure that holds information necessary for the OS loader to be able to load that executable into memory and execute it.    Structure Overview  A typical PE file follows the structure outlined in the following figure:    If we open an executable file with PE-bear we’ll see the same thing:    DOS Header  Every PE file starts with a 64-bytes-long structure called the DOS header, it’s what makes the PE file an MS-DOS executable.  DOS Stub  After the DOS header comes the DOS stub which is a small MS-DOS 2.0 compatible executable that just prints an error message saying “This program cannot be run in DOS mode” when the program is run in DOS mode.  NT Headers  The NT Headers part contains three main parts:     PE signature: A 4-byte signature that identifies the file as a PE file.   File Header: A standard COFF File Header. It holds some information about the PE file.   Optional Header: The most important header of the NT Headers, its name is the Optional Header because some files like object files don’t have it, however it’s required for image files (files like .exe files). This header provides important information to the OS loader.   Section Table  The section table follows the Optional Header immediately, it is an array of Image Section Headers, there’s a section header for every section in the PE file. Each header contains information about the section it refers to.  Sections  Sections are where the actual contents of the file are stored, these include things like data and resources that the program uses, and also the actual code of the program, there are several sections each one with its own purpose.    Conclusion  In this post we looked at a very basic overview of the PE file structure and talked briefly about the main parts of a PE files. In the upcoming posts we’ll talk about each one of these parts in much more detail., A dive into the PE file format - PE file structure - Part 1: OverviewIntroductionThe aim of this post is to provide a basic introduction to the PE file structure without talking about any details.PE filesPE stands for Portable Executable, it’s a file format for executables used in Windows operating systems, it’s based on the COFF file format (Common Object File Format).Not only .exe files are PE files, dynamic link libraries (.dll), Kernel modules (.srv), Control panel applications (.cpl) and many others are also PE files.A PE file is a data structure that holds information necessary for the OS loader to be able to load that executable into memory and execute it.Structure OverviewA typical PE file follows the structure outlined in the following figure:If we open an executable file with PE-bear we’ll see the same thing:DOS HeaderEvery PE file starts with a 64-bytes-long structure called the DOS header, it’s what makes the PE file an MS-DOS executable.DOS StubAfter the DOS header comes the DOS stub which is a small MS-DOS 2.0 compatible executable that just prints an error message saying “This program cannot be run in DOS mode” when the program is run in DOS mode.NT HeadersThe NT Headers part contains three main parts:  PE signature: A 4-byte signature that identifies the file as a PE file.  File Header: A standard COFF File Header. It holds some information about the PE file.  Optional Header: The most important header of the NT Headers, its name is the Optional Header because some files like object files don’t have it, however it’s required for image files (files like .exe files). This header provides important information to the OS loader.Section TableThe section table follows the Optional Header immediately, it is an array of Image Section Headers, there’s a section header for every section in the PE file.Each header contains information about the section it refers to.SectionsSections are where the actual contents of the file are stored, these include things like data and resources that the program uses, and also the actual code of the program, there are several sections each one with its own purpose.ConclusionIn this post we looked at a very basic overview of the PE file structure and talked briefly about the main parts of a PE files.In the upcoming posts we’ll talk about each one of these parts in much more detail.' url='https://0xrick.github.io/win-internals/pe2/' language='en' keywords=None robots=None og_title='A dive into the PE file format - PE file structure - Part 1: Overview' og_description='A dive into the PE file format - PE file structure - Part 1: Overview  Introduction  The aim of this post is to provide a basic introduction to the PE file structure without talking about any details.    PE files  PE stands for Portable Executable, it’s a file format for executables used in Windows operating systems, it’s based on the COFF file format (Common Object File Format).  Not only .exe files are PE files, dynamic link libraries (.dll), Kernel modules (.srv), Control panel applications (.cpl) and many others are also PE files.  A PE file is a data structure that holds information necessary for the OS loader to be able to load that executable into memory and execute it.    Structure Overview  A typical PE file follows the structure outlined in the following figure:    If we open an executable file with PE-bear we’ll see the same thing:    DOS Header  Every PE file starts with a 64-bytes-long structure called the DOS header, it’s what makes the PE file an MS-DOS executable.  DOS Stub  After the DOS header comes the DOS stub which is a small MS-DOS 2.0 compatible executable that just prints an error message saying “This program cannot be run in DOS mode” when the program is run in DOS mode.  NT Headers  The NT Headers part contains three main parts:     PE signature: A 4-byte signature that identifies the file as a PE file.   File Header: A standard COFF File Header. It holds some information about the PE file.   Optional Header: The most important header of the NT Headers, its name is the Optional Header because some files like object files don’t have it, however it’s required for image files (files like .exe files). This header provides important information to the OS loader.   Section Table  The section table follows the Optional Header immediately, it is an array of Image Section Headers, there’s a section header for every section in the PE file. Each header contains information about the section it refers to.  Sections  Sections are where the actual contents of the file are stored, these include things like data and resources that the program uses, and also the actual code of the program, there are several sections each one with its own purpose.    Conclusion  In this post we looked at a very basic overview of the PE file structure and talked briefly about the main parts of a PE files. In the upcoming posts we’ll talk about each one of these parts in much more detail.' og_url='https://0xrick.github.io/win-internals/pe2/' og_image=None og_audio=None og_determiner=None og_locale='en' og_locale_alternate=None og_site_name=\"0xRick's Blog\" og_video=None favicon=None dc_terms_created=None dc_date_created=None dc_date=None dc_terms_type=None dc_type=None dc_terms_audience=None dc_terms_subject=None dc_subject=None dc_description=None dc_terms_keywords=None modified_time=None published_time='2021-10-22T03:01:00+02:00' article_tag=None article_section=None source_url='https://0xrick.github.io/win-internals/pe2/' status_code=200 scrape_id='019c7071-3c07-77cc-990e-a239a5c14cf4' num_pages=None content_type='text/html; charset=utf-8' proxy_used='basic' timezone='America/New_York' cache_state='miss' cached_at=None credits_used=1 concurrency_limited=False concurrency_queue_duration_ms=None error=None og:description='A dive into the PE file format - PE file structure - Part 1: Overview  Introduction  The aim of this post is to provide a basic introduction to the PE file structure without talking about any details.    PE files  PE stands for Portable Executable, it’s a file format for executables used in Windows operating systems, it’s based on the COFF file format (Common Object File Format).  Not only .exe files are PE files, dynamic link libraries (.dll), Kernel modules (.srv), Control panel applications (.cpl) and many others are also PE files.  A PE file is a data structure that holds information necessary for the OS loader to be able to load that executable into memory and execute it.    Structure Overview  A typical PE file follows the structure outlined in the following figure:    If we open an executable file with PE-bear we’ll see the same thing:    DOS Header  Every PE file starts with a 64-bytes-long structure called the DOS header, it’s what makes the PE file an MS-DOS executable.  DOS Stub  After the DOS header comes the DOS stub which is a small MS-DOS 2.0 compatible executable that just prints an error message saying “This program cannot be run in DOS mode” when the program is run in DOS mode.  NT Headers  The NT Headers part contains three main parts:     PE signature: A 4-byte signature that identifies the file as a PE file.   File Header: A standard COFF File Header. It holds some information about the PE file.   Optional Header: The most important header of the NT Headers, its name is the Optional Header because some files like object files don’t have it, however it’s required for image files (files like .exe files). This header provides important information to the OS loader.   Section Table  The section table follows the Optional Header immediately, it is an array of Image Section Headers, there’s a section header for every section in the PE file. Each header contains information about the section it refers to.  Sections  Sections are where the actual contents of the file are stored, these include things like data and resources that the program uses, and also the actual code of the program, there are several sections each one with its own purpose.    Conclusion  In this post we looked at a very basic overview of the PE file structure and talked briefly about the main parts of a PE files. In the upcoming posts we’ll talk about each one of these parts in much more detail.' headline='A dive into the PE file format - PE file structure - Part 1: Overview' og:locale='en' twitter:site='@ahm3d_h3sham' og:site_name=\"0xRick's Blog\" og:url='https://0xrick.github.io/win-internals/pe2/' viewport='width=device-width, initial-scale=1.0' twitter:card='summary' article:published_time='2021-10-22T03:01:00+02:00' author='0xRick' twitter:description='A dive into the PE file format - PE file structure - Part 1: Overview  Introduction  The aim of this post is to provide a basic introduction to the PE file structure without talking about any details.    PE files  PE stands for Portable Executable, it’s a file format for executables used in Windows operating systems, it’s based on the COFF file format (Common Object File Format).  Not only .exe files are PE files, dynamic link libraries (.dll), Kernel modules (.srv), Control panel applications (.cpl) and many others are also PE files.  A PE file is a data structure that holds information necessary for the OS loader to be able to load that executable into memory and execute it.    Structure Overview  A typical PE file follows the structure outlined in the following figure:    If we open an executable file with PE-bear we’ll see the same thing:    DOS Header  Every PE file starts with a 64-bytes-long structure called the DOS header, it’s what makes the PE file an MS-DOS executable.  DOS Stub  After the DOS header comes the DOS stub which is a small MS-DOS 2.0 compatible executable that just prints an error message saying “This program cannot be run in DOS mode” when the program is run in DOS mode.  NT Headers  The NT Headers part contains three main parts:     PE signature: A 4-byte signature that identifies the file as a PE file.   File Header: A standard COFF File Header. It holds some information about the PE file.   Optional Header: The most important header of the NT Headers, its name is the Optional Header because some files like object files don’t have it, however it’s required for image files (files like .exe files). This header provides important information to the OS loader.   Section Table  The section table follows the Optional Header immediately, it is an array of Image Section Headers, there’s a section header for every section in the PE file. Each header contains information about the section it refers to.  Sections  Sections are where the actual contents of the file are stored, these include things like data and resources that the program uses, and also the actual code of the program, there are several sections each one with its own purpose.    Conclusion  In this post we looked at a very basic overview of the PE file structure and talked briefly about the main parts of a PE files. In the upcoming posts we’ll talk about each one of these parts in much more detail.' twitter:url='https://0xrick.github.io/win-internals/pe2/' article:author='0xRick' og:type='article' twitter:title='A dive into the PE file format - PE file structure - Part 1: Overview' datePublished='2021-10-22T03:01:00+02:00' og:title='A dive into the PE file format - PE file structure - Part 1: Overview' indexId='f07cbc68-c6fe-4879-8f1d-ff1933314fab'"