# https://0xrick.github.io/win-internals/pe2/

<!DOCTYPE html><!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
--><html lang="en" class=" js ">

  <body class="layout--single wide">
    

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  


  <article class="page h-entry" itemscope="" itemtype="https://schema.org/CreativeWork">
    
    
    
    

    <div class="page__inner-wrap">
      
        
      

      <section class="page__content e-content" itemprop="text">
        <div>
          
                <br>   
           
                <br>
        </div>
        
          
        
        <h2 id="a-dive-into-the-pe-file-format---pe-file-structure---part-1-overview">A dive into the PE file format - PE file structure - Part 1: Overview<a class="header-link" href="https://0xrick.github.io/win-internals/pe2/#a-dive-into-the-pe-file-format---pe-file-structure---part-1-overview" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h2>

<h3 id="introduction">Introduction<a class="header-link" href="https://0xrick.github.io/win-internals/pe2/#introduction" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h3>

<p>The aim of this post is to provide a basic introduction to the PE file structure without talking about any details.</p>

<hr>

<h3 id="pe-files">PE files<a class="header-link" href="https://0xrick.github.io/win-internals/pe2/#pe-files" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h3>

<p>PE stands for Portable Executable, it’s a file format for executables used in Windows operating systems, it’s based on the <code class="language-plaintext highlighter-rouge">COFF</code> file format (Common Object File Format).</p>

<p>Not only <code class="language-plaintext highlighter-rouge">.exe</code> files are PE files, dynamic link libraries (<code class="language-plaintext highlighter-rouge">.dll</code>), Kernel modules (<code class="language-plaintext highlighter-rouge">.srv</code>), Control panel applications (<code class="language-plaintext highlighter-rouge">.cpl</code>) and many others are also PE files.</p>

<p>A PE file is a data structure that holds information necessary for the OS loader to be able to load that executable into memory and execute it.</p>

<hr>

<h3 id="structure-overview">Structure Overview<a class="header-link" href="https://0xrick.github.io/win-internals/pe2/#structure-overview" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h3>

<p>A typical PE file follows the structure outlined in the following figure:</p>

<p><img src="https://0xrick.github.io/images/wininternals/pe2/1.png" alt="" class="align-center"></p>

<p>If we open an executable file with <code class="language-plaintext highlighter-rouge">PE-bear</code> we’ll see the same thing:</p>

<p><img src="https://0xrick.github.io/images/wininternals/pe2/2.png" alt="" class="align-center"></p>

<h4 id="dos-header">DOS Header<a class="header-link" href="https://0xrick.github.io/win-internals/pe2/#dos-header" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h4>

<p>Every PE file starts with a 64-bytes-long structure called the DOS header, it’s what makes the PE file an MS-DOS executable.</p>

<h4 id="dos-stub">DOS Stub<a class="header-link" href="https://0xrick.github.io/win-internals/pe2/#dos-stub" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h4>

<p>After the DOS header comes the DOS stub which is a small MS-DOS 2.0 compatible executable that just prints an error message saying “This program cannot be run in DOS mode” when the program is run in DOS mode.</p>

<h4 id="nt-headers">NT Headers<a class="header-link" href="https://0xrick.github.io/win-internals/pe2/#nt-headers" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h4>

<p>The NT Headers part contains three main parts:</p>

<ul>
  <li>
<strong>PE signature:</strong> A 4-byte signature that identifies the file as a PE file.</li>
  <li>
<strong>File Header:</strong> A standard <code class="language-plaintext highlighter-rouge">COFF</code> File Header. It holds some information about the PE file.</li>
  <li>
<strong>Optional Header:</strong> The most important header of the NT Headers, its name is the Optional Header because some files like object files don’t have it, however it’s required for image files (files like <code class="language-plaintext highlighter-rouge">.exe</code> files). This header provides important information to the OS loader.</li>
</ul>

<h4 id="section-table">Section Table<a class="header-link" href="https://0xrick.github.io/win-internals/pe2/#section-table" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h4>

<p>The section table follows the Optional Header immediately, it is an array of Image Section Headers, there’s a section header for every section in the PE file.
<br>Each header contains information about the section it refers to.</p>

<h4 id="sections">Sections<a class="header-link" href="https://0xrick.github.io/win-internals/pe2/#sections" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h4>

<p>Sections are where the actual contents of the file are stored, these include things like data and resources that the program uses, and also the actual code of the program, there are several sections each one with its own purpose.</p>

<hr>

<h3 id="conclusion" class="active">Conclusion<a class="header-link" href="https://0xrick.github.io/win-internals/pe2/#conclusion" title="Permalink"><span class="sr-only">Permalink</span><i class="fas fa-link"></i></a></h3>

<p>In this post we looked at a very basic overview of the PE file structure and talked briefly about the main parts of a PE files.
<br>In the upcoming posts we’ll talk about each one of these parts in much more detail.</p>

        
      </section>

      

      

      
  

    </div>

    
  </article>

  
  
</div>
    </div>

    

    

    
  







  <!-- Global site tag (gtag.js) - Google Analytics -->











  

</body></html>