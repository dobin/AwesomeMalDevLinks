Title:
Citadel: Binary Static Analysis Framework

Type:
Blog Post (with linked GitHub Tool)

Short Summary (4–8 sentences max):
Citadel is a static analysis framework designed to help identify why Windows payloads/implants are being detected by Microsoft Defender without needing to manually copy samples into a VM where they may be quarantined immediately. It uses a Python (Quart) API/UI backed by MongoDB plus a Windows C# agent that polls for tasks, downloads samples, and performs Defender scanning via MpCmdRun.exe with chunking logic to isolate “bad bytes” (0→X, X→Y, and a thorough region-matching mode). The framework also performs PE metadata extraction using LIEF, pefile, radare2, and Detect-It-Easy, and runs capa to map capabilities to MBC and MITRE ATT&CK. It adds similarity context via TLSH fuzzy hashing against an ingested dataset to find near-neighbor samples. The UI aggregates results (entropy, imports, toolchain/packer hints, function-category mapping, TLSH matches, and detected byte regions) for quick triage. It’s primarily useful for red teams and malware researchers iterating on payloads, and for defenders doing rapid static triage and clustering.

Technical Focus:
- Microsoft Defender static detection triage via MpCmdRun.exe and file chunking
- PE parsing and feature extraction (imports/exports/sections/strings/certificates)
- Capability identification with capa + MBC/MITRE ATT&CK mapping
- TLSH fuzzy hashing and distance-based similarity search in MongoDB
- Client/agent architecture (Python Quart API + C# polling agent)
- Toolchain/packer identification with Detect-It-Easy (DIE)

Use Cases:
- Pinpointing byte sequences that trigger Defender static signatures during payload development
- Building repeatable static triage reports for malware samples with a centralized UI
- Clustering/relating unknown binaries to known malware/goodware via TLSH distance
- Extracting PE metadata (signing, timestamps, imports, strings) for attribution and analysis
- Mapping observed capabilities to ATT&CK techniques for reporting and prioritization

Keywords:
Citadel, static analysis, Microsoft Defender, MpCmdRun.exe, ThreatCheck, chunking, signature trigger bytes, PE parsing, LIEF, pefile, radare2, Detect-It-Easy, capa, MBC, MITRE ATT&CK, TLSH, fuzzy hashing, MongoDB, Quart API, C# agent, entropy, imports, code signing certificates