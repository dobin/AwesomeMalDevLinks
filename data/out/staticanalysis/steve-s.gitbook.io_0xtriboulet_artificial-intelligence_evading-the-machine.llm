Title:
Evading the Machine

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post walks through building a deliberately simple PE malware classifier and then evading it by modifying a shellcode loader’s static properties.  
- It uses a low-dimensional feature set (size-weighted section entropy, printable strings density, and log(file size)) extracted from scraped malware and benign Windows binaries, then trains a scaled logistic regression model.  
- The author visualizes the decision boundary in 3D feature space to build intuition about how linear classifiers separate samples and why feature scaling matters.  
- Evasion is demonstrated by making a functionally equivalent loader that dynamically resolves WinAPI calls and reduces binary bloat (e.g., `-nostdlib`), shifting features (notably strings density/size) across the boundary to get a “benign” classification.  
- It highlights brittleness of simplistic static-feature ML and notes that real-world products add many more features plus dynamic telemetry, correlation, and sandboxing.  
- Useful for red teamers/pentesters learning practical ML evasion intuition and for defenders evaluating feature robustness and attacker manipulation cost.

Technical Focus:
- Static PE feature engineering (section entropy, strings density, file size)
- Logistic regression decision boundaries and feature scaling (StandardScaler)
- Dataset creation/labeling and train/test splitting for malware classification
- Adversarial manipulation of static features to induce misclassification
- Windows shellcode loader implementation and API usage patterns
- Dynamic API resolution (`GetProcAddress`, `GetModuleHandleA`) and binary size trade-offs

Use Cases:
- Prototyping and visualizing simple malware classifiers to understand model behavior
- Testing how easily static PE features can be manipulated for evasion
- Building red-team PoCs for “ML-based detection” bypass demonstrations (educational)
- Defender feature-hardening exercises (identify brittle/static-only signals)
- Creating baseline pipelines for PE feature extraction and model training

Keywords:
machine learning evasion, malware classifier, logistic regression, decision boundary, StandardScaler, PE file, pefile, section entropy, Shannon entropy, strings density, feature engineering, adversarial examples, static analysis, shellcode loader, VirtualAlloc, CreateThread, WaitForSingleObject, GetProcAddress, GetModuleHandleA, -nostdlib, vx-underground