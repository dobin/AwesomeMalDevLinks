Title:
Ryūjin — Writing a Bin2Bin Obfuscator from Scratch for Windows PE x64 and Fully Deobfuscating It

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post walks through building a binary-to-binary (bin2bin) obfuscator for Windows PE x64 executables and then demonstrates how to fully reverse/deobfuscate the produced output.  
- It focuses on practical PE rewriting: transforming code while preserving functionality, and handling the constraints of x64 instruction encoding, relocations, and control-flow integrity.  
- The author covers typical obfuscation building blocks (e.g., instruction substitution, junk insertion, control-flow flattening/rewriting, basic block shuffling) and the engineering required to apply them safely to real PE files.  
- The deobfuscation section shows how an analyst can recover the original logic by undoing transformations, reconstructing control flow, and leveraging disassembly/analysis tooling.  
- Useful for red teamers and malware developers interested in custom obfuscation, and for reverse engineers/blue team analysts who need to recognize and peel back bin2bin protections.  
- Interesting because it treats obfuscation and deobfuscation as two sides of the same problem, highlighting what actually survives static analysis and what doesn’t.

Technical Focus:
- Windows PE x64 rewriting (sections, headers, relocations)
- x86-64 instruction decoding/rewriting and control-flow patching
- Obfuscation primitives (junk code, substitution, block shuffling/CFG transforms)
- Deobfuscation workflows (CFG recovery, pattern-based undoing, normalization)
- Static analysis tooling and automation (disassemblers, scripting)

Use Cases:
- Creating custom PE x64 obfuscation for payloads/tools to resist static triage
- Studying how bin2bin obfuscation breaks and how to design around it
- Building deobfuscation scripts to recover readable control flow from protected binaries
- Developing detection heuristics for common bin2bin transformation artifacts
- Training reverse engineers on modern obfuscation/anti-analysis patterns

Keywords:
Windows PE, x64, bin2bin, obfuscator, deobfuscation, control-flow graph, basic blocks, instruction rewriting, disassembly, relocations, section rewriting, code transformation, junk instructions, instruction substitution, CFG recovery, reverse engineering, static analysis, anti-analysis