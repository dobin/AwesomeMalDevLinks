Title:
Citadel 2.0: Predicting Maliciousness

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post describes an update to “Citadel,” a local static-analysis triage framework for assessing whether a file is likely malicious before using it on an engagement.  
- The main improvement is integrating EMBER2024 LightGBM malware-classification models (downloaded from Hugging Face) to produce a probabilistic maliciousness score instead of relying primarily on a Defender yes/no outcome.  
- It walks through file-type detection (PE/.NET/APK/ELF/PDF), model selection, feature extraction via thrember/EMBER, and scoring with LightGBM’s Booster.predict.  
- Citadel also adds an optional LLM-generated narrative summary (OpenAI API) that contextualizes metadata, Defender/AMSI results, YARA, capa, TLSH similarity, imports, and toolchain/cert info.  
- A new Next.js dashboard visualizes results (key metrics, import/function grouping, TLSH, “malicious bytes,” PE details, capa matches) to make triage faster.  
- Useful for red teams/pentesters doing payload QA, and for malware analysts/blue teams who want quick static triage and reporting; interesting because it operationalizes modern benchmark ML models (EMBER2024) in a practical workflow.

Technical Focus:
- Static malware triage and PE profiling
- EMBER2024 feature extraction (thrember / PEFeatureExtractor) and LightGBM inference
- File-type detection (python-magic, PE header parsing, .NET COM descriptor)
- Integration of Defender/AMSI, YARA, capa, TLSH similarity
- LLM-assisted summarization of multi-signal analysis
- Web UI/visualization pipeline (Python API + Next.js frontend)

Use Cases:
- Pre-deployment payload risk scoring (OPSEC/engagement QA)
- Rapid static triage of suspicious binaries/documents across formats (PE, .NET, ELF, PDF, APK)
- Correlating ML score with Defender/AMSI, YARA, capa, and similarity hashes for analyst review
- Generating analyst-friendly summaries for reports or internal handoff
- Building a local “maliciousness dashboard” for sample intake and prioritization

Keywords:
Citadel, EMBER2024, LightGBM, thrember, PEFeatureExtractor, static analysis, malware classification, Windows PE, LIEF, pefile, python-magic, Hugging Face Hub, hf_hub_download, Windows Defender, AMSI, YARA, capa, TLSH, import analysis, Next.js, OpenAI API, Booster.predict, feature_vector, entropy, Authenticode certificates