Title:
Malware development part 4 – anti static analysis tricks

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post covers practical anti–static analysis techniques for Windows x64 malware, using a simple shellcode injector as the running example.  
- It explains how Visual Studio compiler/linker settings affect portability, size, and reverse-engineering difficulty (e.g., static CRT, optimization, and stripping/debug path hygiene).  
- The core focus is reducing static indicators in PE files by mutating binaries to change hashes, hiding suspicious imports via dynamic API resolution, and using API hashing to avoid plaintext function names.  
- It also demonstrates “shellcode-style” bootstrapping by walking the PEB/LDR module lists to locate kernel32.dll and parse its export table without relying on GetModuleHandle/GetProcAddress imports.  
- The article discusses PE structure indicators (sections, resources, timestamps) and how entropy analysis can reveal encrypted/compressed payloads embedded in sections like .rsrc.  
- Useful primarily for red teamers, malware developers, and reverse engineers; also relevant to blue teams for understanding common static indicators and evasion patterns.

Technical Focus:
- Visual Studio build configuration for payloads (CRT selection, optimization, linker/debug artifacts)
- PE static indicators (IAT/imports, sections, resources, timestamps)
- Dynamic API resolution (GetProcAddress/GetModuleHandle) and import hiding
- API hashing and manual export table parsing
- PEB/LDR traversal for module discovery (x64 GS:[0x60])
- Entropy-based detection of packed/encrypted data

Use Cases:
- Building smaller/more portable Windows payload executables
- Reducing static IOCs (imports, strings, PDB paths) in droppers/loaders
- Implementing custom API resolvers for loaders/packers
- Creating polymorphic on-disk variants to evade hash-based detections
- Blue-team validation: hunting for PEB-walking/API-hashing patterns and anomalous PE metadata

Keywords:
Windows x64, Portable Executable, PE headers, IAT, Import Address Table, Visual Studio, linker options, /MT, /NODEFAULTLIB, PDB path, TimeDateStamp, section entropy, .text, .rsrc, resource encryption, VirtualAlloc, CreateThread, WaitForSingleObject, GetProcAddress, GetModuleHandle, API hashing, djb2, export table parsing, PEB, LDR_DATA_TABLE_ENTRY, GS:[0x60]