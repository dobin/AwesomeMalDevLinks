Title:
Evading Static Analysis

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post covers practical techniques to reduce static-analysis visibility of Windows malware/loader binaries by minimizing obvious PE artifacts.  
- It focuses on keeping the Import Address Table (IAT) “clean” by resolving WinAPI functions dynamically (LoadLibrary/GetProcAddress) and then further by implementing custom module/export resolution to avoid importing even those resolver APIs.  
- It discusses string-based indicators (DLL/function names) and introduces API/string hashing to remove cleartext artifacts.  
- For payload signature evasion, it compares encrypting/obfuscating shellcode (and pitfalls of using Windows CryptAPI due to detectable ALG_ID usage) versus custom crypto and how static detection can key off constants and algorithmic “flow.”  
- It also covers staging payloads over the network, PE section placement (.text/.rdata), entropy considerations, and entropy-reduction tricks/tools.  
- Finally, it highlights compilation/linking choices (e.g., stripping symbols, -nostdlib, size optimizations) to reduce “garbage” and static indicators.  
- Useful primarily for red team operators, malware developers, and reverse engineers; secondarily for blue teams to understand what artifacts remain when IAT/strings are minimized.

Technical Focus:
- PE Import Address Table (IAT) minimization and dynamic API resolution
- Custom PEB/module walking and export table parsing (manual GetProcAddress/LoadLibrary equivalents)
- API hashing / string hashing for import and string indicator removal
- Payload encryption/obfuscation tradeoffs and static detection via constants/flow
- Entropy analysis per PE section and entropy-reduction strategies
- Compiler/linker options to reduce static artifacts (strip symbols, no CRT, size opts)

Use Cases:
- Build Windows loaders that avoid obvious imported APIs in the IAT
- Replace cleartext DLL/function strings with hashed lookups
- Package shellcode with runtime decryption to evade signature-based scanning
- Reduce PE entropy spikes caused by embedded encrypted payloads
- Produce smaller, less “noisy” binaries via custom compilation/linking flags
- Develop defensive detections around residual indicators (dynamic resolution patterns, hashing loops, entropy anomalies)

Keywords:
Windows, PE, Import Address Table, IAT, LoadLibraryA, GetProcAddress, GetModuleHandle, PEB walking, export table parsing, API hashing, string hashing, static analysis evasion, shellcode, payload encryption, CryptAPI, CryptGenKey, CryptCreateHash, ALG_ID, entropy, .text section, .rdata section, staging, mingw-w64-gcc, -nostdlib, symbol stripping