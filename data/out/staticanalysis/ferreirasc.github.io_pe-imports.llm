Title:
PE Internals Part 2: Exploring PE import tables (IDT, ILT, IAT, Hint/Name tables)

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post explains how Windows PE files represent and resolve imported DLL functions using the Import Directory Table (IDT), Import Lookup Table (ILT), Hint/Name table, and Import Address Table (IAT).  
- It breaks down the `IMAGE_IMPORT_DESCRIPTOR` structure and how each descriptor maps a specific imported DLL to its ILT and IAT via RVAs.  
- The article details how ILT entries encode either ordinals (via the high-bit “ordinal flag”) or RVAs to `IMAGE_IMPORT_BY_NAME` records (Hint + function name).  
- A key point is the on-disk vs in-memory difference: the IAT initially mirrors the ILT on disk, then the loader overwrites IAT entries with resolved function addresses at runtime.  
- It includes a practical x64dbg walkthrough using notepad.exe to observe IAT population during DLL load and confirm resolution to a concrete API (e.g., `kernel32!InitializeCriticalSectionEx`).  
- Useful for malware analysts, reverse engineers, exploit devs, and red teamers who need to understand import resolution, IAT-based analysis, or hooking/patching implications.

Technical Focus:
- PE `.idata` layout and import data structures (`IMAGE_IMPORT_DESCRIPTOR`, `IMAGE_IMPORT_BY_NAME`)
- IDT/ILT/IAT relationships and RVA/VA translation
- Import-by-name vs import-by-ordinal (ordinal flag semantics)
- Loader behavior: resolving imports via DLL Export Address Table (EAT) and patching the IAT
- Runtime inspection of import resolution with x64dbg (breakpoints on DLL load)

Use Cases:
- Reverse engineering how a binary resolves and calls external APIs
- Malware analysis of import behavior and identifying dynamically resolved functions
- Implementing or detecting IAT hooking / import table patching
- Writing PE parsers/loaders or tooling that reconstructs imports from disk images
- Debugging loader-stage issues (broken imports, bound import artifacts)

Keywords:
Portable Executable, PE, .idata, Import Directory Table, IDT, IMAGE_IMPORT_DESCRIPTOR, Import Lookup Table, ILT, Import Name Table, Import Address Table, IAT, Hint/Name table, IMAGE_IMPORT_BY_NAME, RVA, VA, ordinal import, import by name, Windows loader, Export Address Table, EAT, x64dbg, kernel32.dll, InitializeCriticalSectionEx