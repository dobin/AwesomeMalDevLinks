Title:
Build-time String Encryption for Position-Independent Code (enc_pic_str)

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post describes a build-time approach to encrypting/obfuscating string literals in position-independent code (PIC) / shellcode-like payloads written in C.  
- It targets the common problem where embedded plaintext strings (e.g., DLL names, API names, UI text) become easy static signatures or leak intent in PIC payloads.  
- The author’s method replaces `pic_str("...")` occurrences with generated inline code that embeds encrypted bytes and a per-build XOR key inside the instruction stream, then decrypts at runtime into a stack/local buffer.  
- It uses inline assembly with RIP-relative addressing plus `volatile` to reduce compiler “helpfulness” that might re-materialize plaintext strings or optimize away the decrypt loop.  
- A simple external preprocessor (regex + codegen) performs source-to-source transformation rather than relying on C++ templates/constexpr or heavy AST tooling.  
- Useful for red teamers, exploit devs, and malware developers building PIC payloads who want debuggable, single-step-friendly string hiding without adopting a full custom loader.

Technical Focus:
- Position-independent code (PIC) string handling and embedding data in `.text`
- Build-time source-to-source transformation (macro marker + regex codegen)
- Inline assembly (GCC/Clang) with RIP-relative `lea`/`mov` to locate embedded blobs
- Runtime XOR string decryption with per-build polymorphic keys
- Compiler-optimization resistance using `volatile` and statement expressions (`({ ... })`)
- Windows x64 shellcode conventions (context via msfvenom example)

Use Cases:
- Obfuscate API/DLL/command strings in C-based shellcode/PIC payloads
- Reduce static signatures/YARA hits caused by plaintext embedded strings
- Generate per-build unique payloads via fresh encryption keys (“polymorphism”)
- Keep payloads debuggable while avoiding C++ template-based string crypto
- Integrate into “unity build” single-compilation-unit PIC projects

Keywords:
PIC, shellcode, string encryption, string obfuscation, build-time code generation, source-to-source transformation, regex preprocessor, inline assembly, RIP-relative addressing, XOR cipher, volatile, GNU statement expression, _Generic, msfvenom, Windows x64 calling convention, MessageBoxA, .text section, .rdata section, FLOSS, YARA signatures