Title:
AV Evasion with Chisel (Chisel Client: From 16/65 to 1/65 flagged on VirusTotal)

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post documents modifying the Go-based tunneling tool Chisel to reduce static AV/VirusTotal detections for the client binary.  
- It starts from a baseline of 16/65 VT detections and iteratively applies source-level changes plus build-time obfuscation to reach 1/65.  
- Techniques include removing server-mode code to shrink functionality, stripping/replacing user-facing strings (help/version/log banners), adding “junk” functions to perturb signatures, and refactoring code structure to alter recognizable call flows and symbol layouts.  
- The largest detection drop comes from compiling with Garble (symbol renaming/obfuscation, `--tiny`, `--literals`, random seed) combined with linker flags (`-s -w`, `-trimpath`, `-buildid=`) and optional static linking flags.  
- It validates that the modified client still connects to an unmodified Chisel server and supports reverse SOCKS tunneling.  
- Useful for red teams/pentesters experimenting with AV signature evasion on commodity tooling and for defenders understanding how minor source/build changes can break static detections.

Technical Focus:
- Go binary AV evasion via source modification
- Chisel client/server feature reduction (client-only build)
- String/banners/help-text removal to evade signature/YARA hits
- Control-flow and structural refactoring to disrupt pattern matching
- Garble obfuscation (`--tiny`, `--literals`, `--seed=random`)
- Go build/linker hardening flags (`-s -w`, `-trimpath`, `-buildid=`; optional `-extldflags=-static`)

Use Cases:
- Produce a lower-detection Chisel client for internal red team operations
- Test how VT/static engines react to string changes vs structural refactors vs obfuscation
- Build a repeatable pipeline for customizing commodity Go tooling before deployment
- Defensive research: create variants to evaluate robustness of YARA/static signatures for Go tunneling tools

Keywords:
Chisel, jpillora/chisel, Go, garble, obfuscation, AV evasion, EDR, VirusTotal, filescan.io, reverse tunneling, SOCKS5, WebSocket, static detection, YARA, string stripping, symbol renaming, -ldflags, -trimpath, -buildid, refactoring