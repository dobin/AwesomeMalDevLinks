# https://github.com/Fatmike-GH/Fatpack

[Skip to content](https://github.com/Fatmike-GH/Fatpack#start-of-content)

You signed in with another tab or window. [Reload](https://github.com/Fatmike-GH/Fatpack) to refresh your session.You signed out in another tab or window. [Reload](https://github.com/Fatmike-GH/Fatpack) to refresh your session.You switched accounts on another tab or window. [Reload](https://github.com/Fatmike-GH/Fatpack) to refresh your session.Dismiss alert

{{ message }}

[Fatmike-GH](https://github.com/Fatmike-GH)/ **[Fatpack](https://github.com/Fatmike-GH/Fatpack)** Public

- [Notifications](https://github.com/login?return_to=%2FFatmike-GH%2FFatpack) You must be signed in to change notification settings
- [Fork\\
12](https://github.com/login?return_to=%2FFatmike-GH%2FFatpack)
- [Star\\
93](https://github.com/login?return_to=%2FFatmike-GH%2FFatpack)


A Windows PE packer for executables (x64) with LZMA compression and with full TLS (Thread Local Storage) support.


### License

[MIT license](https://github.com/Fatmike-GH/Fatpack/blob/main/LICENSE)

[93\\
stars](https://github.com/Fatmike-GH/Fatpack/stargazers) [12\\
forks](https://github.com/Fatmike-GH/Fatpack/forks) [Branches](https://github.com/Fatmike-GH/Fatpack/branches) [Tags](https://github.com/Fatmike-GH/Fatpack/tags) [Activity](https://github.com/Fatmike-GH/Fatpack/activity)

[Star](https://github.com/login?return_to=%2FFatmike-GH%2FFatpack)

[Notifications](https://github.com/login?return_to=%2FFatmike-GH%2FFatpack) You must be signed in to change notification settings

# Fatmike-GH/Fatpack

main

[**1** Branch](https://github.com/Fatmike-GH/Fatpack/branches) [**9** Tags](https://github.com/Fatmike-GH/Fatpack/tags)

[Go to Branches page](https://github.com/Fatmike-GH/Fatpack/branches)[Go to Tags page](https://github.com/Fatmike-GH/Fatpack/tags)

Go to file

Code

Open more actions menu

## Folders and files

| Name | Name | Last commit message | Last commit date |
| --- | --- | --- | --- |
| ## Latest commit<br>![author](https://github.githubassets.com/images/gravatars/gravatar-user-420.png?size=40)<br>Fatmike<br>[Update README.md](https://github.com/Fatmike-GH/Fatpack/commit/0d04dfa2011a1173dda30b0ff2d6095b6c8261a8)<br>4 months agoOct 27, 2025<br>[0d04dfa](https://github.com/Fatmike-GH/Fatpack/commit/0d04dfa2011a1173dda30b0ff2d6095b6c8261a8) · 4 months agoOct 27, 2025<br>## History<br>[59 Commits](https://github.com/Fatmike-GH/Fatpack/commits/main/) <br>Open commit details<br>[View commit history for this file.](https://github.com/Fatmike-GH/Fatpack/commits/main/) 59 Commits |
| [Fatpack](https://github.com/Fatmike-GH/Fatpack/tree/main/Fatpack "Fatpack") | [Fatpack](https://github.com/Fatmike-GH/Fatpack/tree/main/Fatpack "Fatpack") | [Minor changes](https://github.com/Fatmike-GH/Fatpack/commit/c4e35d227d50d10f575955c78797e22106925129 "Minor changes") | 8 months agoJun 17, 2025 |
| [Images](https://github.com/Fatmike-GH/Fatpack/tree/main/Images "Images") | [Images](https://github.com/Fatmike-GH/Fatpack/tree/main/Images "Images") | [Version 1.5.0 : Documentation](https://github.com/Fatmike-GH/Fatpack/commit/2d1a73d9277aac463a40afc811c6099aabe6e672 "Version 1.5.0 : Documentation") | 8 months agoJun 15, 2025 |
| [Licenses](https://github.com/Fatmike-GH/Fatpack/tree/main/Licenses "Licenses") | [Licenses](https://github.com/Fatmike-GH/Fatpack/tree/main/Licenses "Licenses") | [Initial commit](https://github.com/Fatmike-GH/Fatpack/commit/e1e21ca12b6d05810b14ecc91ebb5ef6ab407103 "Initial commit") | 9 months agoJun 2, 2025 |
| [Loader\_Console\_Resource](https://github.com/Fatmike-GH/Fatpack/tree/main/Loader_Console_Resource "Loader_Console_Resource") | [Loader\_Console\_Resource](https://github.com/Fatmike-GH/Fatpack/tree/main/Loader_Console_Resource "Loader_Console_Resource") | [Splitted PELoaderStubs](https://github.com/Fatmike-GH/Fatpack/commit/7a4d406c67b7bd8669de01e92d2e23c0edc5aae6 "Splitted PELoaderStubs") | 8 months agoJun 17, 2025 |
| [Loader\_Console\_Section](https://github.com/Fatmike-GH/Fatpack/tree/main/Loader_Console_Section "Loader_Console_Section") | [Loader\_Console\_Section](https://github.com/Fatmike-GH/Fatpack/tree/main/Loader_Console_Section "Loader_Console_Section") | [Splitted PELoaderStubs](https://github.com/Fatmike-GH/Fatpack/commit/7a4d406c67b7bd8669de01e92d2e23c0edc5aae6 "Splitted PELoaderStubs") | 8 months agoJun 17, 2025 |
| [Loader\_Windows\_Resource](https://github.com/Fatmike-GH/Fatpack/tree/main/Loader_Windows_Resource "Loader_Windows_Resource") | [Loader\_Windows\_Resource](https://github.com/Fatmike-GH/Fatpack/tree/main/Loader_Windows_Resource "Loader_Windows_Resource") | [Splitted PELoaderStubs](https://github.com/Fatmike-GH/Fatpack/commit/7a4d406c67b7bd8669de01e92d2e23c0edc5aae6 "Splitted PELoaderStubs") | 8 months agoJun 17, 2025 |
| [Loader\_Windows\_Section](https://github.com/Fatmike-GH/Fatpack/tree/main/Loader_Windows_Section "Loader_Windows_Section") | [Loader\_Windows\_Section](https://github.com/Fatmike-GH/Fatpack/tree/main/Loader_Windows_Section "Loader_Windows_Section") | [Splitted PELoaderStubs](https://github.com/Fatmike-GH/Fatpack/commit/7a4d406c67b7bd8669de01e92d2e23c0edc5aae6 "Splitted PELoaderStubs") | 8 months agoJun 17, 2025 |
| [ResourceAdder](https://github.com/Fatmike-GH/Fatpack/tree/main/ResourceAdder "ResourceAdder") | [ResourceAdder](https://github.com/Fatmike-GH/Fatpack/tree/main/ResourceAdder "ResourceAdder") | [Added rebasing support](https://github.com/Fatmike-GH/Fatpack/commit/87d19970156730259b8ee6ff1f78d858427897d7 "Added rebasing support") | 9 months agoJun 5, 2025 |
| [Shared](https://github.com/Fatmike-GH/Fatpack/tree/main/Shared "Shared") | [Shared](https://github.com/Fatmike-GH/Fatpack/tree/main/Shared "Shared") | [Bugfix: Compile error](https://github.com/Fatmike-GH/Fatpack/commit/3e6ea0f5bc2f592d16d693aabd31be3056d43419 "Bugfix: Compile error") | 4 months agoOct 17, 2025 |
| [.gitignore](https://github.com/Fatmike-GH/Fatpack/blob/main/.gitignore ".gitignore") | [.gitignore](https://github.com/Fatmike-GH/Fatpack/blob/main/.gitignore ".gitignore") | [Initial commit](https://github.com/Fatmike-GH/Fatpack/commit/e1e21ca12b6d05810b14ecc91ebb5ef6ab407103 "Initial commit") | 9 months agoJun 2, 2025 |
| [Concept.odp](https://github.com/Fatmike-GH/Fatpack/blob/main/Concept.odp "Concept.odp") | [Concept.odp](https://github.com/Fatmike-GH/Fatpack/blob/main/Concept.odp "Concept.odp") | [Version 1.5.0 : Documentation](https://github.com/Fatmike-GH/Fatpack/commit/2d1a73d9277aac463a40afc811c6099aabe6e672 "Version 1.5.0 : Documentation") | 8 months agoJun 15, 2025 |
| [Fatpack.sln](https://github.com/Fatmike-GH/Fatpack/blob/main/Fatpack.sln "Fatpack.sln") | [Fatpack.sln](https://github.com/Fatmike-GH/Fatpack/blob/main/Fatpack.sln "Fatpack.sln") | [Splitted PELoaderStubs](https://github.com/Fatmike-GH/Fatpack/commit/7a4d406c67b7bd8669de01e92d2e23c0edc5aae6 "Splitted PELoaderStubs") | 8 months agoJun 17, 2025 |
| [LICENSE](https://github.com/Fatmike-GH/Fatpack/blob/main/LICENSE "LICENSE") | [LICENSE](https://github.com/Fatmike-GH/Fatpack/blob/main/LICENSE "LICENSE") | [Initial commit](https://github.com/Fatmike-GH/Fatpack/commit/e1e21ca12b6d05810b14ecc91ebb5ef6ab407103 "Initial commit") | 9 months agoJun 2, 2025 |
| [README.md](https://github.com/Fatmike-GH/Fatpack/blob/main/README.md "README.md") | [README.md](https://github.com/Fatmike-GH/Fatpack/blob/main/README.md "README.md") | [Update README.md](https://github.com/Fatmike-GH/Fatpack/commit/0d04dfa2011a1173dda30b0ff2d6095b6c8261a8 "Update README.md") | 4 months agoOct 27, 2025 |
| View all files |

## Repository files navigation

# Fatpack

[Permalink: Fatpack](https://github.com/Fatmike-GH/Fatpack#fatpack)

A Windows PE packer for executables (x64) with LZMA compression and with full TLS (Thread Local Storage) support.

Keywords: PE packer, PE loader, executable packer, manual mapping, manual mapper, portable executable, LZMA, UPX, EXE

## Motivation

[Permalink: Motivation](https://github.com/Fatmike-GH/Fatpack#motivation)

A practical application of my PE loader (manual mapper): [https://github.com/Fatmike-GH/PELoader](https://github.com/Fatmike-GH/PELoader)

## Usage

[Permalink: Usage](https://github.com/Fatmike-GH/Fatpack#usage)

`Fatpack.exe inputfile.exe outputfile.exe [OPTIONS]`

`[OPTIONS]`

`-r, --resource : Packs inputfile.exe as resource (DEFAULT)`

`-s, --section  : Packs inputfile.exe as section (EXPERIMENTAL)`

## Features

[Permalink: Features](https://github.com/Fatmike-GH/Fatpack#features)

### Functional Features

[Permalink: Functional Features](https://github.com/Fatmike-GH/Fatpack#functional-features)

- Support for native Console- and Windows executables (x64 only, no .NET support)
- LZMA compression
- Full TLS (Thread Local Storage) support
  - Therefore supports Rust- and Delphi exectuables for example
- No CRT usage in Fatpack.exe and Stubs (WinAPI only) and therefore no C/C++ redistributables are required
- Icon extraction
- Packing options
  - Resource Packing : The packed target is embedded as a resource in the loader stub, including rebasing if necessary.
  - Section Packing : The packed target is appended as section within the loader stub.

### Technical Features

[Permalink: Technical Features](https://github.com/Fatmike-GH/Fatpack#technical-features)

- Relocations
- Imports
- Delay Imports
- Exception Handlers
- Proper Memory Section Protection
- Full TLS (Thread Local Storage) support
  - TLS Callbacks
    - DLL\_PROCESS\_ATTACH
    - DLL\_THREAD\_ATTACH
    - DLL\_THREAD\_DETACH
    - DLL\_PROCESS\_DETACH
  - TLS Data
- Manifest extraction (required, if specfic module versions of the target executable are specified)

## Solution Overview

[Permalink: Solution Overview](https://github.com/Fatmike-GH/Fatpack#solution-overview)

The solution consists of four projects:

- `Fatpack`
  - The console application `Fatpack.exe`, which the user employs to pack their target executable.
- Loader stubs
  - The loader stubs serve as containers for the packed target executable and are responsible for loading and executing it.
  - `Loader_Console`
  - `Loader_Windows`
- `ResourceAdder`
  - `ResourceAdder.exe`, a helper executable that adds the loader stubs to `Fatpack.exe` as post-build step, using the scripts `PostBuildStep_Debug.bat` and `PostBuildStep_Release.bat`.

### Loader Stubs

[Permalink: Loader Stubs](https://github.com/Fatmike-GH/Fatpack#loader-stubs)

Both `Loader_Console` and `Loader_Windows` serve as loader stubs. Upon startup, they retrieve the packed target executable from their embedded resources (`-r` option), or from `.fpack` section (`-s` option), unpack it in memory, and execute it.

The loader logic is available at: [https://github.com/Fatmike-GH/PELoader](https://github.com/Fatmike-GH/PELoader)

- `Loader_Console`: The loader stub for loading console applications.
- `Loader_Windows`: The loader stub for loading windows applications.

### ResourceAdder

[Permalink: ResourceAdder](https://github.com/Fatmike-GH/Fatpack#resourceadder)

A simple console application used to embed the loader stubs into `Fatpack.exe` as post-build step. This integration is handled via the scripts `PostBuildStep_Debug.bat` and `PostBuildStep_Release.bat`.

> **Note:** Always use **"Rebuild Solution"** after making changes to ensure that the post-build steps execute correctly.

### Fatpack

[Permalink: Fatpack](https://github.com/Fatmike-GH/Fatpack#fatpack-1)

The console application (`Fatpack.exe`) is used by the user to package their target executable. Its main responsibilities include:

- Determining the appropriate loader stub (Loader\_Console or Loader\_Windows) based on the type of the target executable, loading it from an embedded resource, and saving it to disk.
- Rebasing the loader stub if the target does not have a relocation table and there is an image base conflict.
- Extracting the icon from the target executable and embedding it into the selected loader stub.
- Extracting and embedding the application manifest from the target executable. This step is essential, as the manifest may specify specific module versions required for correct execution.
- Compressing the target executable using the LZMA algorithm and appending it to the loader stub.
- Depending on the selected option (`--resource` or `--section`), the packed target is appended to the loader stub in different ways:


  - Option `--resource`

    [![image](https://github.com/Fatmike-GH/Fatpack/raw/main/Images/Concept_01.PNG)](https://github.com/Fatmike-GH/Fatpack/blob/main/Images/Concept_01.PNG)


    The packed target is appended to the loader stub as a resource. It remains in memory, while the unpacked target is mapped to a new memory location (allocated using _VirtualAlloc_) and executed from there.

  - Option `--section`

    [![image](https://github.com/Fatmike-GH/Fatpack/raw/main/Images/Concept_02.PNG)](https://github.com/Fatmike-GH/Fatpack/blob/main/Images/Concept_02.PNG)


    The loader stub is rebased so that its `.reloc` section aligns with the image base of the target executable. The virtual size of the `.reloc` section is adjusted to match the image size of the unpacked target, allowing it to fit entirely within this section at runtime after unpacking. As a result, no additional memory allocation is necessary. As a final step, the `.reloc` section is renamed to `.fpack`.


> This is the preferred option as it requires less memory at runtime. However, it may cause issues with certain targets in specific cases.

## Fatpack vs UPX 5.0.1

[Permalink: Fatpack vs UPX 5.0.1](https://github.com/Fatmike-GH/Fatpack#fatpack-vs-upx-501)

| Target size | UPX | UPX -9 | Fatpack | Target info |
| --- | --- | --- | --- | --- |
| 6744 kb | 1735 kb | 1669 kb | **1608 kb** | Embarcadero Delphi(XE3-X4)\[Professional\] |
| 2728 kb | 1052 kb | **1034 kb** | 1035 kb | Rust |
| 611 kb | 86 kb | 83 kb | **80 kb** | Microsoft Visual C/C++(19.36.34808)\[C++\] |
| 533 kb | 213 kb | 210 kb | **199 kb** | Rust |
| 448 kb | - | - | **193 kb** | Rust |
| 233 kb | 89 kb | 89 kb | **85 kb** | Microsoft Visual C/C++(19.36.34436)\[LTCG/C++\] |
| 32 kb | **9 kb** | **9 kb** | 16 kb | Microsoft Visual C/C++(19.29.30139)\[LTCG/C\] |
| 20 kb | **11 kb** | **11 kb** | 18 kb | Microsoft Visual C/C++(19.36.34808)\[LTCG/C++\] |
| 15 kb | **10 kb** | **10 kb** | 17 kb | Microsoft Visual C/C++(19.36.34808)\[LTCG/C++\] |

Since the loader stubs (`Loader_Console` and `Loader_Windows`) are relatively large,approximately 10 KB each, the compression ratio is less favorable when packing very small target executables. However, for larger executables, the results are significantly more efficient, yielding much better overall compression ratios.

> **Note:** UPX did not support the 448 kb target

## Third Party Software

[Permalink: Third Party Software](https://github.com/Fatmike-GH/Fatpack#third-party-software)

### EasyLZMA

[Permalink: EasyLZMA](https://github.com/Fatmike-GH/Fatpack#easylzma)

[https://github.com/lloyd/easylzma](https://github.com/lloyd/easylzma)

### TinyZZZ

[Permalink: TinyZZZ](https://github.com/Fatmike-GH/Fatpack#tinyzzz)

[https://github.com/WangXuan95/TinyZZZ](https://github.com/WangXuan95/TinyZZZ)

### Fatmike's PE Loader

[Permalink: Fatmike's PE Loader](https://github.com/Fatmike-GH/Fatpack#fatmikes-pe-loader)

[https://github.com/Fatmike-GH/PELoader](https://github.com/Fatmike-GH/PELoader)

## About

A Windows PE packer for executables (x64) with LZMA compression and with full TLS (Thread Local Storage) support.


### Topics

[windows](https://github.com/topics/windows "Topic: windows") [packer](https://github.com/topics/packer "Topic: packer") [reverse-engineering](https://github.com/topics/reverse-engineering "Topic: reverse-engineering") [executable](https://github.com/topics/executable "Topic: executable") [compressor](https://github.com/topics/compressor "Topic: compressor") [upx](https://github.com/topics/upx "Topic: upx") [lzma](https://github.com/topics/lzma "Topic: lzma") [pe-format](https://github.com/topics/pe-format "Topic: pe-format") [portable-executable](https://github.com/topics/portable-executable "Topic: portable-executable") [pe-loader](https://github.com/topics/pe-loader "Topic: pe-loader") [pe-file](https://github.com/topics/pe-file "Topic: pe-file") [exe-packer](https://github.com/topics/exe-packer "Topic: exe-packer") [manual-mapping](https://github.com/topics/manual-mapping "Topic: manual-mapping") [manualmap](https://github.com/topics/manualmap "Topic: manualmap") [upx-packer](https://github.com/topics/upx-packer "Topic: upx-packer") [thread-local-storage](https://github.com/topics/thread-local-storage "Topic: thread-local-storage") [pe-packer](https://github.com/topics/pe-packer "Topic: pe-packer") [manual-mapper](https://github.com/topics/manual-mapper "Topic: manual-mapper") [executable-packing](https://github.com/topics/executable-packing "Topic: executable-packing") [executable-compressor](https://github.com/topics/executable-compressor "Topic: executable-compressor")

### Resources

[Readme](https://github.com/Fatmike-GH/Fatpack#readme-ov-file)

### License

[MIT license](https://github.com/Fatmike-GH/Fatpack#MIT-1-ov-file)

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/Fatmike-GH/Fatpack).

[Activity](https://github.com/Fatmike-GH/Fatpack/activity)

### Stars

[**93**\\
stars](https://github.com/Fatmike-GH/Fatpack/stargazers)

### Watchers

[**6**\\
watching](https://github.com/Fatmike-GH/Fatpack/watchers)

### Forks

[**12**\\
forks](https://github.com/Fatmike-GH/Fatpack/forks)

[Report repository](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FFatmike-GH%2FFatpack&report=Fatmike-GH+%28user%29)

## [Releases\  9](https://github.com/Fatmike-GH/Fatpack/releases)

[Version 1.5.2\\
Latest\\
\\
on Jun 17, 2025Jun 17, 2025](https://github.com/Fatmike-GH/Fatpack/releases/tag/1.5.2)

[\+ 8 releases](https://github.com/Fatmike-GH/Fatpack/releases)

## [Packages\  0](https://github.com/users/Fatmike-GH/packages?repo_name=Fatpack)

No packages published

## Languages

- [C65.6%](https://github.com/Fatmike-GH/Fatpack/search?l=c)
- [C++34.1%](https://github.com/Fatmike-GH/Fatpack/search?l=c%2B%2B)
- [Batchfile0.3%](https://github.com/Fatmike-GH/Fatpack/search?l=batchfile)

You can’t perform that action at this time.