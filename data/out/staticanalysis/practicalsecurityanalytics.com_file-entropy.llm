Title:
Threat Hunting with File Entropy

Type:
Blog Post

Short Summary (4–8 sentences max):
- Explains Shannon entropy (0–8 scale) and how file entropy can be used as a static feature for intrusion detection and malware triage, especially for Windows PE files.  
- Shows that packing, compression, and encryption typically increase entropy, and presents dataset-driven observations where high-entropy binaries (e.g., ≥7.2, near 8.0) are disproportionately malicious compared to legitimate software.  
- Demonstrates how to calculate entropy on a single file using Sysinternals Sigcheck (`sigcheck -h -a`) and discusses common packers (e.g., UPX, Armadillo, Yoda’s Protector) and their differing false-positive rates.  
- Emphasizes that entropy alone is insufficient due to legitimate packed/obfuscated software, recommending follow-on steps like PEiD packer signatures, unpacking (e.g., UnpacMe), and dynamic sandboxing (Cuckoo/FireEye/WildFire).  
- Covers adversary countermeasures to evade entropy-based detection, such as single-byte XOR (minimal entropy change), encrypting only small portions of the file, or padding with benign code/strings to lower overall entropy and confuse ML-based AV.  

Technical Focus:
- Shannon entropy for binary/static analysis
- Windows Portable Executable (PE) malware triage
- Packer detection (PEiD signatures) and common packers (UPX, Armadillo, Yoda’s Protector)
- False positives and feature correlation in threat hunting
- Unpacking workflows and automated sandbox detonation
- Evasion strategies against entropy/ML-based detection

Use Cases:
- Prioritizing suspicious PE files in large-scale hunting pipelines using entropy thresholds
- Rapid triage of unknown binaries with Sigcheck entropy output
- Identifying likely packed/encrypted malware and routing to unpacking/sandbox analysis
- Building detection logic that combines entropy with packer signatures to reduce false positives
- Red-team/malware-dev evaluation of how packing/encryption choices affect detectability

Keywords:
Shannon entropy, file entropy, PE files, Portable Executable, static analysis, malware triage, packers, UPX, Armadillo, Yoda’s Protector, PEiD, Sysinternals Sigcheck, unpacking, UnpacMe, Cuckoo Sandbox, FireEye sandbox, WildFire, obfuscation, encryption, compression, XOR encoding