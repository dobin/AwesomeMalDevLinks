Title:
Behind the Code: Assessing Public Compile-Time Obfuscators for Enhanced OPSEC

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post evaluates whether public LLVM compile-time obfuscation passes meaningfully change antivirus detection rates for native Windows executables.  
- It builds a reproducible Linux-based clang-cl toolchain that targets the Microsoft SDK (via xwin) and tests multiple out-of-tree LLVM obfuscation plugins (e.g., flattening, bogus control flow, MBA, string obfuscation, indirect calls).  
- The author compiles both “goodware” (MessageBox, SHA/AES, PuTTY, Capstone) and commonly abused offensive tooling (Arsenal Kit artifacts, Mimikatz, TrevorC2, COFFLoader, Throwback), then compares VirusTotal detection deltas across obfuscation configurations.  
- Results show mostly negligible changes (often ±2 detections), with one modest improvement for Mimikatz (up to ~8 fewer detections) and notable false positives introduced for PuTTY when obfuscated.  
- Several passes fail or break builds/tests (e.g., AES test suite failures, segfaults on some targets), highlighting reliability and engineering risk.  
- The conclusion is that public, generic LLVM obfuscation is unlikely to provide strong OPSEC benefits against modern heuristic/ML detections without significant custom pass development.  

Technical Focus:
- LLVM obfuscation passes (flattening, bogus control flow, MBA, string obfuscation, indirect calls)
- clang-cl cross-compilation to Windows using Microsoft SDK on Linux
- Static vs heuristic/ML AV detections and VirusTotal-based measurement
- Out-of-tree LLVM pass plugins and new pass manager compatibility
- Build/linking considerations (MSVC-like toolchain, /MT static CRT, lld-link)
- Operational tradeoffs: false positives, instability, and reproducibility

Use Cases:
- Benchmarking whether LLVM obfuscation changes AV/VT detection for a given payload/tool
- Building a Linux-based Windows-native compilation pipeline (clang-cl + xwin + lld-link)
- Evaluating obfuscation-induced reliability regressions before operational use
- Creating a baseline methodology for comparing compiler/toolchain changes on detections
- Informing decisions on whether to invest in custom LLVM passes vs manual code changes

Keywords:
LLVM, Clang, clang-cl, LLVM-17, obfuscation passes, bogus control flow, control-flow flattening, MBA obfuscation, string obfuscation, indirect calls, new pass manager, out-of-tree plugin, xwin, Windows SDK, MSVC compatibility, /MT static CRT, lld-link, VirusTotal, heuristic detection, Mimikatz, Cobalt Strike Arsenal Kit, COFFLoader, TrevorC2, PuTTY, Capstone