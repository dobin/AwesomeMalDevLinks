Title:
Silently Install Chrome Extension For Persistence

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post describes a method to silently install a Google Chrome extension on Windows for persistence without using Chrome command-line flags, registry edits, or GUI interaction.  
- The technique works by modifying Chrome’s `%LOCALAPPDATA%\Google\Chrome\User Data\Default\Secure Preferences` (or sometimes `Preferences`) file to add an extension entry and the associated integrity fields Chrome expects.  
- It details the required JSON additions under `extensions.settings`, plus recalculating `protection.macs.extensions.settings` and the file-wide `protection.super_mac`.  
- The integrity values are HMAC-SHA256 over specific JSON paths/values using the user SID and a hard-coded Chrome seed, based on prior academic work and existing PoC code.  
- A Python PoC demonstrates adding an unpacked extension (example: Crux) from a chosen disk path and computing the necessary MACs so Chrome accepts it on next restart.  
- Useful for red teams/post-exploitation operators targeting browser-based credential/session theft and persistence; also relevant to defenders for file-integrity and extension-hunting detections.

Technical Focus:
- Chrome/Chromium Secure Preferences file structure (`extensions.settings`, `protection.macs`, `super_mac`)
- HMAC-SHA256 integrity computation tied to user SID and a hard-coded seed
- Silent extension persistence via on-disk profile manipulation
- ProcMon-based change discovery / reverse engineering workflow
- Detection ideas for non-Chrome processes editing profile preference files

Use Cases:
- Establish user-level persistence by planting a malicious Chrome extension
- Deploy cookie/session theft or web traffic manipulation via extension permissions
- Post-exploitation capability staging without suspicious Chrome launch arguments
- Blue-team detection engineering for preference-file tampering and anomalous extension paths

Keywords:
Chrome, Chromium, Secure Preferences, Preferences, Chrome extensions, persistence, HMAC, HMAC-SHA256, super_mac, protection.macs, extensions.settings, Windows SID, LocalAppData, ProcMon, Crux, CursedChrome, cookie theft, profile tampering, extension allowlist, integrity bypass