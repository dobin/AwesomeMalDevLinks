Title:
MoveEDR (MoveEdr.ps1)

Type:
GitHub Tool

Short Summary (4–8 sentences max):
MoveEDR is a PowerShell script that disables AV/EDR products by scheduling file/folder moves or deletions to occur at next boot, before the target services and drivers start. It leverages Windows Session Manager’s `PendingFileRenameOperations` mechanism (the same underlying behavior as Sysinternals PendMoves / `MoveFileEx`) to rename/move EDR binaries and directories so they cannot load. The repo documents how the registry value is formatted (`REG_MULTI_SZ` with NULL-terminated src/dst strings) and automates generating correct entries for multiple vendors, with options to customize paths, suffixes, and to undo changes. It includes operational flags for dumping/loading the registry state, printing human-readable entries, and more aggressive Defender handling (moving the whole Defender folder). This is primarily useful for red teams/pentesters with local admin who need to neutralize endpoint controls without using vendor tamper-protection passwords. Notably, it warns of potential CrowdStrike-induced boot loops (“INACCESSIBLE_BOOT_DEVICE”) under some conditions, highlighting real-world stability risk.

Technical Focus:
- `MoveFileEx` / boot-time rename-delete semantics
- `HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\PendingFileRenameOperations`
- `REG_MULTI_SZ` NULL-terminated string formatting for pending operations
- Pre-service boot execution order (Session Manager behavior)
- PowerShell automation for mass path moves + rollback (undo)
- EDR/AV tamper-resistance bypass via offline/early-boot file displacement

Use Cases:
- Disable EDR/AV components on next reboot when local admin cannot uninstall/stop them normally
- Temporarily “move aside” Defender/EDR to run tooling, then restore via `-Undo`
- Test resilience of EDR deployments against boot-time file displacement
- Incident response / lab reproduction of EDR failure modes caused by missing binaries
- Validate defensive monitoring around Session Manager pending rename operations

Keywords:
PowerShell, MoveFileEx, PendingFileRenameOperations, Session Manager, REG_MULTI_SZ, HKLM\SYSTEM, boot-time rename, pre-boot persistence, tamper protection bypass, EDR disablement, Windows Defender, Microsoft Defender for Endpoint, CrowdStrike, Elastic Agent, Trellix, McAfee, Trend Micro, Sysinternals PendMoves, INACCESSIBLE_BOOT_DEVICE