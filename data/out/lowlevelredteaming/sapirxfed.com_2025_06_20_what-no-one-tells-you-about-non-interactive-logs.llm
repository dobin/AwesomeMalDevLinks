Title:
What No One Tells You About Non-Interactive Logs

Type:
Blog Post

Short Summary (4–8 sentences max):
- The post explains Microsoft Entra ID (Azure AD) non-interactive sign-in logs, why they’re commonly misunderstood, and how to correctly retrieve them.  
- It shows that filtering the “IsInteractive” field in the portal is not sufficient; instead you must query `signInEventTypes` (example provided via Microsoft Graph beta), and notes the UI uses the legacy AADGraph endpoint for these events.  
- The author highlights that non-interactive logs include more than refresh-token activity, covering flows like auth code redemption, SSO on Entra-joined devices, and FOCI-based app sign-ins—some of which are user-driven.  
- A key case study is “non-interactive” failed logons (error 50126) with “Other clients,” tied to brute-force campaigns (e.g., `fasthttp` UA) that can appear only in non-interactive logs.  
- The root cause is the legacy RST2 (SOAP) flow that uses basic auth (username/password per request) and can bypass MFA because basic auth doesn’t support MFA.  
- It demonstrates how AADInternals can exercise this behavior (e.g., outsider user enumeration using the RST2 endpoint), making the logging nuance operationally relevant for both detection and offensive testing.

Technical Focus:
- Microsoft Entra ID non-interactive sign-in telemetry (`signInEventTypes`)
- Microsoft Graph beta auditLogs/signIns querying and filtering
- Legacy authentication: RST2 (SOAP) + Basic Authentication
- MFA bypass conditions via legacy/basic auth flows
- Brute-force/user enumeration visibility in “Other clients” sign-ins
- AADInternals tooling and RST2 endpoint usage

Use Cases:
- Hunt for password-spray/brute-force attempts that only surface in non-interactive logs
- Detect legacy auth usage (“Other clients”) and enforce blocking/conditional access hardening
- Validate whether MFA can be bypassed via deprecated auth paths in a tenant
- Build SIEM detections around `signInEventTypes=nonInteractiveUser` and error codes (e.g., 50126)
- Red team simulation of outsider enumeration and legacy auth abuse using AADInternals

Keywords:
Microsoft Entra ID, Azure AD, non-interactive sign-in logs, auditLogs/signIns, Microsoft Graph beta, AADGraph, signInEventTypes, nonInteractiveUser, OAuth2 refresh token, authorization code, SSO, FOCI, legacy authentication, Basic Auth, RST2, SOAP, AADInternals, Invoke-AADIntUserEnumerationAsOutsider, password spray, brute force, error 50126, Other clients, MFA bypass, Conditional Access