Title:
The Renaissance of NTLM Relay Attacks: Everything You Need to Know

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post is a deep technical refresher on NTLM authentication and why NTLM relay remains one of the most reliable paths to compromise domain-joined Windows hosts.  
- It explains NTLMv1/NTLMv2 mechanics, why relay works (authentication without cracking), and how modern coercion primitives (e.g., Printer Bug, PetitPotam) make relay precise rather than opportunistic.  
- Key mitigations and failure modes are covered in detail: session security (sign/seal), MIC, channel binding/EPA, SMB signing, LDAP signing, and LDAP channel binding—plus common bypass conditions and configuration pitfalls.  
- The article ties tradecraft to BloodHound by introducing new “NTLM relay edges” that model coercion+relay paths from Authenticated Users to compromise via SMB, ADCS ESC8, and LDAP/LDAPS (often leading to RBCD or Shadow Credentials).  
- It highlights practical enablers like WebDAV/Web Client service behavior, Intranet Zone “dotless hostname” rules, and abusing AD-integrated DNS record creation to make WebDAV-based relay viable.  
- Useful for red teams/pentesters planning lateral movement and for defenders prioritizing hardening (SMB signing required, EPA on IIS/ADCS, LDAP signing+channel binding enforcement, NTLM restrictions, Protected Users).  

Technical Focus:
- NTLM protocol internals (Type1/2/3, NTLMv1 vs NTLMv2, NTOWFv2/NTProofStr)
- NTLM relay prerequisites and mitigations (MIC, session key exchange, signing/sealing, channel binding/EPA)
- Authentication coercion primitives (Printer Bug/SpoolSample, PetitPotam/EFSRPC)
- Relay targets and post-relay actions (SMB, ADCS ESC8, LDAP/LDAPS)
- WebDAV/Web Client service + Intranet Zone mapping + ADIDNS record abuse
- BloodHound/SharpHound modeling of relay attack paths (new relay edges and collection logic)

Use Cases:
- Identify and prioritize NTLM relay attack paths in AD using BloodHound relay edges
- Coerce machine authentication and relay to SMB for admin share access, remote secrets dumping, or lateral movement
- Relay to ADCS web enrollment (ESC8) to mint machine certs and authenticate via PKINIT (e.g., Rubeus), including UnPAC-the-Hash follow-on
- Relay to LDAP/LDAPS to set RBCD (msDS-AllowedToActOnBehalfOfOtherIdentity) or perform Shadow Credentials (msDS-KeyCredentialLink)
- Assess and validate mitigations: SMB signing required, IIS EPA, LDAP signing + channel binding, NTLM restrictions, Protected Users coverage

Keywords:
NTLM relay, NTLMv1, NTLMv2, MIC, Extended Protection for Authentication, EPA, channel binding token, SMB signing, LDAP signing, LDAP channel binding, LDAPS, StartTLS, ADCS, ESC8, PKINIT, Rubeus, UnPAC the Hash, PetitPotam, Printer Bug, SpoolSample, EFSRPC, WebDAV, Web Client service, Intranet Zone, MapUrlToZoneEx2, ADIDNS, Powermad, BloodHound, SharpHound, RBCD, msDS-AllowedToActOnBehalfOfOtherIdentity, Shadow Credentials, msDS-KeyCredentialLink, SCCM takeover