Title:
BOF Spawn – Process Injection (Cobalt Strike BOF)

Type:
GitHub Tool

Short Summary (4–8 sentences max):
BOF_Spawn is a Cobalt Strike Beacon Object File that spawns a new process (typically suspended) and injects either a Beacon or arbitrary shellcode using a “fork & run” style workflow. It focuses on evasion by combining Draugr synthetic stack frames (stack spoofing) with indirect syscalls to reduce exposure to userland API hooks and call-stack based detections. The tool supports PPID spoofing and optional process mitigation policies (e.g., BlockDLL and disabling CFG) to influence monitoring and execution constraints. Multiple execution methods are implemented, including direct RIP hijack, ntdll gadget-based jumps (JMP RAX/RBX), and callback-based execution via a Windows API callback. The README also documents realistic detection surfaces (ETW-TI, kernel callbacks, RWX/unbacked executable memory) and tradeoffs of each option. It’s primarily useful for red teams and malware developers building injection tradecraft within Cobalt Strike, and secondarily for blue teams modeling detections around these behaviors.

Technical Focus:
- Cobalt Strike BOF development and CNA integration
- NtCreateUserProcess-based spawning (NT path usage) and suspended process injection
- Indirect syscalls (syscall resolution/VxTable) to bypass userland hooks
- Draugr synthetic stack frames / call stack spoofing
- Thread context manipulation (NtGetContextThread/NtSetContextThread) and gadget-based execution
- Process mitigation policies (CFG disable, BlockDLL) and memory protection (RW→RX vs RWX)

Use Cases:
- Spawn-and-inject Beacon into a new process with configurable parent/command line
- Execute arbitrary shellcode in a spawned target with different thread start strategies
- Reduce userland-hook visibility using indirect syscalls and stack spoofing
- Test/validate EDR detections for ETW-TI context changes, suspicious mitigations, and unbacked RX memory
- Build customizable injection workflows inside Cobalt Strike via CNA menus/commands

Keywords:
Cobalt Strike, BOF, Beacon Object File, CNA script, process injection, fork and run, NtCreateUserProcess, NT path, PPID spoofing, indirect syscalls, syscall resolution, VxTable, Draugr, synthetic stack frames, stack spoofing, NtGetContextThread, NtSetContextThread, RIP hijacking, ntdll gadgets, JMP RAX, JMP RBX, EnumResourceTypesW callback, CFG, BlockDLL, RWX, RW to RX, ETW-TI, PsSetCreateProcessNotifyRoutine, kernel callbacks, memory scanning, CET