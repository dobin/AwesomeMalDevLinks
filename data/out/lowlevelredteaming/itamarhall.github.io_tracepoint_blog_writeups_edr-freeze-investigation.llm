Title:
EDR-Freeze – Forensic Analysis of an EDR Coma Attack

Type:
Blog Post

Short Summary (4–8 sentences max):
- This write-up analyzes the “EDR-Freeze” PoC technique that temporarily suspends EDR/AV processes from user mode by abusing Windows Error Reporting (WerFaultSecure.exe) and dbghelp’s MiniDumpWriteDump side effects.  
- Instead of BYOVD or kernel exploits, it uses legitimate Windows components plus timing/race behavior to suspend target threads, leaving the security process running but inert for a configurable interval and then resuming it cleanly.  
- The post focuses on memory-forensic artifacts left behind when freezing Windows Defender (MsMpEng.exe), using Volatility3 and MemProcFS to correlate suspended threads, handle access rights, and process relationships.  
- It highlights concrete indicators such as WerFaultSecure.exe holding PROCESS_SUSPEND_RESUME and THREAD_ALL_ACCESS handles into the target, specific command-line arguments (/pid, /tid, /encfile, /cancel, /type), and transient file artifacts (e.g., t.txt).  
- It also demonstrates static evidence via IAT inspection (MiniDumpWriteDump import) and provides YARA rules for both tool-specific and behavior-cluster detection in memory.  
- Useful primarily for DFIR and Blue Teams hunting defense-impairment tradecraft, but also relevant to red teamers studying user-mode EDR disruption and LOLBin-style abuse.

Technical Focus:
- Windows Error Reporting (WER) abuse via WerFaultSecure.exe
- MiniDumpWriteDump (dbghelp.dll) and thread-suspension side effects
- Memory forensics with Volatility3 and MemProcFS (threads, handles, cmdline, IAT)
- Handle rights analysis (PROCESS_SUSPEND_RESUME, THREAD_ALL_ACCESS, etc.)
- Artifact correlation (timestamps, PID/TID linkage, transient file creation/deletion)
- YARA detection for binaries and in-memory behavioral indicators

Use Cases:
- Investigate suspected “EDR/AV went blind” incidents via memory images
- Hunt for WerFaultSecure.exe misuse against security tooling (Defender/EDR agents)
- Build detections based on handle access patterns and suspicious WER command lines
- Create YARA rules to identify freeze/dump tooling and related memory artifacts
- Validate red-team simulations of defense impairment without kernel drivers

Keywords:
EDR-Freeze, WerFaultSecure.exe, Windows Error Reporting, WER, dbghelp.dll, MiniDumpWriteDump, MsMpEng.exe, Windows Defender, thread suspension, NtSuspendThread, PROCESS_SUSPEND_RESUME, THREAD_ALL_ACCESS, handle table, IAT, Volatility3, MemProcFS, windows.handles, windows.cmdline, YARA, T1562.001, PPL (Protected Process Light)