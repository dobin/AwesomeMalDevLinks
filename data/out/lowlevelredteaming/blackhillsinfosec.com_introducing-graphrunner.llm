Title:
Introducing GraphRunner: A Post-Exploitation Toolset for Microsoft 365

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post introduces GraphRunner, an offensive post-compromise toolset for interacting with Microsoft Graph to recon, persist, and pillage data from Microsoft Entra ID (Azure AD) / Microsoft 365 tenants.  
- It targets scenarios where an operator has a standard user foothold (e.g., via phishing/spraying) and the Azure portal is restricted, but Graph API access remains available.  
- The toolset includes a PowerShell module collection, an HTML GUI that operates with a bearer token, and OAuth redirector/automation helpers to capture authorization codes and mint/refresh tokens.  
- Techniques covered include tenant recon (users/groups, conditional access policies, app registrations/consents), group abuse (modifiable groups, dynamic group rule abuse, group cloning for “watering hole” mistakes), and data collection from Outlook, SharePoint/OneDrive, and Teams via Graph Search/KQL.  
- Notable research/abuse paths include leveraging an undocumented “Estimate Access” API for permission enumeration, brute-testing client IDs to find Conditional Access bypass opportunities, and using SharePoint “Immersive Reader” endpoints to read files even when unmanaged-device download/view restrictions are enabled.  
- Useful for red teams/pentesters doing M365 post-exploitation and for defenders validating exposure (app consent risk, group misconfigurations, CAP gaps, data access paths).

Technical Focus:
- Microsoft Graph API token acquisition/refresh (device code, delegated OAuth, service principal flows)
- Tenant reconnaissance (users, groups, authorization policy, directory sync settings)
- Conditional Access Policy and app consent/app registration enumeration
- Group abuse: self-service group joins, modifiable groups, dynamic membership rule exploitation, group cloning
- Data pillaging via Graph Search API + KQL (mail, SharePoint/OneDrive, Teams)
- SharePoint unmanaged-device restriction bypass via Immersive Reader endpoints

Use Cases:
- Rapid post-compromise M365 recon when Azure portal access is blocked
- Enumerate and validate Conditional Access Policies and app consent posture
- Identify privilege escalation paths via modifiable/dynamic groups
- Establish persistence via injected OAuth app registrations and refresh tokens
- Search/export sensitive data from email, Teams chats, and SharePoint/OneDrive at scale
- Test CAP bypasses by swapping OAuth client IDs and enumerating effective permissions

Keywords:
Microsoft Graph, Microsoft 365, Entra ID, Azure AD, OAuth 2.0, delegated permissions, refresh token, device code flow, service principal, Conditional Access Policy, app registration, consent grant, Graph Search API, KQL, Teams chat export, SharePoint Online, OneDrive, dynamic groups, Estimate Access API, Immersive Reader bypass, client_id brute force