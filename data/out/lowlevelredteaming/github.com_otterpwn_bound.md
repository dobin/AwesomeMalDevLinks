# https://github.com/otterpwn/bound

[Skip to content](https://github.com/otterpwn/bound#start-of-content)

You signed in with another tab or window. [Reload](https://github.com/otterpwn/bound) to refresh your session.You signed out in another tab or window. [Reload](https://github.com/otterpwn/bound) to refresh your session.You switched accounts on another tab or window. [Reload](https://github.com/otterpwn/bound) to refresh your session.Dismiss alert

{{ message }}

[otterpwn](https://github.com/otterpwn)/ **[bound](https://github.com/otterpwn/bound)** Public

- [Notifications](https://github.com/login?return_to=%2Fotterpwn%2Fbound) You must be signed in to change notification settings
- [Fork\\
1](https://github.com/login?return_to=%2Fotterpwn%2Fbound)
- [Star\\
8](https://github.com/login?return_to=%2Fotterpwn%2Fbound)


Blind AV solutions by setting firewall rules to block outgoing connections


[8\\
stars](https://github.com/otterpwn/bound/stargazers) [1\\
fork](https://github.com/otterpwn/bound/forks) [Branches](https://github.com/otterpwn/bound/branches) [Tags](https://github.com/otterpwn/bound/tags) [Activity](https://github.com/otterpwn/bound/activity)

[Star](https://github.com/login?return_to=%2Fotterpwn%2Fbound)

[Notifications](https://github.com/login?return_to=%2Fotterpwn%2Fbound) You must be signed in to change notification settings

# otterpwn/bound

main

[**1** Branch](https://github.com/otterpwn/bound/branches) [**1** Tag](https://github.com/otterpwn/bound/tags)

[Go to Branches page](https://github.com/otterpwn/bound/branches)[Go to Tags page](https://github.com/otterpwn/bound/tags)

Go to file

Code

Open more actions menu

## Folders and files

| Name | Name | Last commit message | Last commit date |
| --- | --- | --- | --- |
| ## Latest commit<br>[![otterpwn](https://avatars.githubusercontent.com/u/54770684?v=4&size=40)](https://github.com/otterpwn)[otterpwn](https://github.com/otterpwn/bound/commits?author=otterpwn)<br>[README.md](https://github.com/otterpwn/bound/commit/fc95b37304c2b73e1aa11471e5670098691e855f)<br>2 years agoJun 9, 2024<br>[fc95b37](https://github.com/otterpwn/bound/commit/fc95b37304c2b73e1aa11471e5670098691e855f) · 2 years agoJun 9, 2024<br>## History<br>[7 Commits](https://github.com/otterpwn/bound/commits/main/) <br>Open commit details<br>[View commit history for this file.](https://github.com/otterpwn/bound/commits/main/) 7 Commits |
| [assets](https://github.com/otterpwn/bound/tree/main/assets "assets") | [assets](https://github.com/otterpwn/bound/tree/main/assets "assets") | [added kleenscan and vt results](https://github.com/otterpwn/bound/commit/3d1c1af591ad458be72431468535de99b8668168 "added kleenscan and vt results") | 2 years agoJun 9, 2024 |
| [cmake-build-debug](https://github.com/otterpwn/bound/tree/main/cmake-build-debug "cmake-build-debug") | [cmake-build-debug](https://github.com/otterpwn/bound/tree/main/cmake-build-debug "cmake-build-debug") | [refactored code](https://github.com/otterpwn/bound/commit/23b22be6a010be4f5e4918c8639b98b046de2747 "refactored code") | 2 years agoJun 9, 2024 |
| [cmake-build-release](https://github.com/otterpwn/bound/tree/main/cmake-build-release "cmake-build-release") | [cmake-build-release](https://github.com/otterpwn/bound/tree/main/cmake-build-release "cmake-build-release") | [refactored code](https://github.com/otterpwn/bound/commit/23b22be6a010be4f5e4918c8639b98b046de2747 "refactored code") | 2 years agoJun 9, 2024 |
| [.gitignore](https://github.com/otterpwn/bound/blob/main/.gitignore ".gitignore") | [.gitignore](https://github.com/otterpwn/bound/blob/main/.gitignore ".gitignore") | [ignore .idea folder](https://github.com/otterpwn/bound/commit/533faaec90b57de3003b191f43d1b31c106f4666 "ignore .idea folder") | 2 years agoJun 9, 2024 |
| [CMakeLists.txt](https://github.com/otterpwn/bound/blob/main/CMakeLists.txt "CMakeLists.txt") | [CMakeLists.txt](https://github.com/otterpwn/bound/blob/main/CMakeLists.txt "CMakeLists.txt") | [refactored code](https://github.com/otterpwn/bound/commit/23b22be6a010be4f5e4918c8639b98b046de2747 "refactored code") | 2 years agoJun 9, 2024 |
| [README.md](https://github.com/otterpwn/bound/blob/main/README.md "README.md") | [README.md](https://github.com/otterpwn/bound/blob/main/README.md "README.md") | [README.md](https://github.com/otterpwn/bound/commit/fc95b37304c2b73e1aa11471e5670098691e855f "README.md") | 2 years agoJun 9, 2024 |
| [bound.cpp](https://github.com/otterpwn/bound/blob/main/bound.cpp "bound.cpp") | [bound.cpp](https://github.com/otterpwn/bound/blob/main/bound.cpp "bound.cpp") | [refactored code](https://github.com/otterpwn/bound/commit/23b22be6a010be4f5e4918c8639b98b046de2747 "refactored code") | 2 years agoJun 9, 2024 |
| [bound.h](https://github.com/otterpwn/bound/blob/main/bound.h "bound.h") | [bound.h](https://github.com/otterpwn/bound/blob/main/bound.h "bound.h") | [refactored code](https://github.com/otterpwn/bound/commit/23b22be6a010be4f5e4918c8639b98b046de2747 "refactored code") | 2 years agoJun 9, 2024 |
| View all files |

## Repository files navigation

# bound

[Permalink: bound](https://github.com/otterpwn/bound#bound)

`bound` is a **PoC** for a high-privilege evasion technique that consists in blocking outbound connections made by AV solutions by setting firewall rules.

The project includes several documented functions, here is a rundown:

- `enumConnectionsWMI` \- enumerate all the active network connections using the Windows Management Instrumentation (WMI)
- `getImageFileName` \- get image filename of a given process (`getImageFileName(3912) returns "C:\Windows\System32\svchost.exe"`)
- `ipToRange` \- convert IP to CIDR range (`ipToRange("192.168.1.8") returns -> "192.168.0.0/16"`)
- `getRandomRule` \- get a random firewall rule (both name and description) in a Rule object from a vector of rules
- `filterConnections` \- check if vector of all active connections contain the PIDs of the processes to block
- `filterProcesses` \- filter running processes to get vector of PIDs of a list of processes
- `setFWRule` \- add a new firewall rule using the Windows Firewall with Advanced Security API

The provided `main` function shows a typical use of the library

```
int main() {
	printf("[~] starting bound\n");

	std::vector<NetworkConnection> allConnections;
	std::vector<NetworkConnection> connectionsToBlock;
	std::vector<DWORD> foundPIDs;

	// fill this vector will all the processes to block
	std::vector<std::wstring> processesToBlock = { L"svchost.exe" };

	if (!enumConnectionsWMI(allConnections)) {
		std::cout << "[!] Error while enumerating WMI connections" << std::endl;
		return 1;
	}

	if (!filterProcesses(processesToBlock, foundPIDs) || foundPIDs.empty()) {
		std::cout << "[!] Error while filtering processes" << std::endl;
		return 1;
	}

	filterConnections(foundPIDs, allConnections, connectionsToBlock);
	std::cout << "[~] Found " << connectionsToBlock.size() << " connections to block" << std::endl;

	for (const auto& connection : connectionsToBlock) {
		std::wstring fullPath = getImageFileName(connection.owningProcess);
		std::wstring ipRange = ipToRange(connection.remoteAddress);
		std::wcout << "[~] Setting rule for " << fullPath << " and range " << ipRange << std::endl;

		if (!setFWRule(fullPath, ipRange))
			std::wcout << "[!] Failed setting rule for " << fullPath << " and range " << ipRange << std::endl;
	}

	return 0;
}
```

1. Enumerate **all** the active connections using WMI
2. Find the PID of all the processes to block
3. Filter the network connections related to these processes
4. Set firewall rules for the resulting connections

* * *

[![Virustotal results](https://github.com/otterpwn/bound/raw/main/assets/vt_results.png)](https://github.com/otterpwn/bound/blob/main/assets/vt_results.png)

[![Kleenscan results](https://github.com/otterpwn/bound/raw/main/assets/kleenscan_results.png)](https://github.com/otterpwn/bound/blob/main/assets/kleenscan_results.png)

## About

Blind AV solutions by setting firewall rules to block outgoing connections


### Resources

[Readme](https://github.com/otterpwn/bound#readme-ov-file)

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/otterpwn/bound).

[Activity](https://github.com/otterpwn/bound/activity)

### Stars

[**8**\\
stars](https://github.com/otterpwn/bound/stargazers)

### Watchers

[**1**\\
watching](https://github.com/otterpwn/bound/watchers)

### Forks

[**1**\\
fork](https://github.com/otterpwn/bound/forks)

[Report repository](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fotterpwn%2Fbound&report=otterpwn+%28user%29)

## [Releases\  1](https://github.com/otterpwn/bound/releases)

[first\_release\\
Latest\\
\\
on Jun 9, 2024Jun 9, 2024](https://github.com/otterpwn/bound/releases/tag/first_release)

### Uh oh!

There was an error while loading. [Please reload this page](https://github.com/otterpwn/bound).

## Languages

- [C++99.3%](https://github.com/otterpwn/bound/search?l=c%2B%2B)
- [CMake0.7%](https://github.com/otterpwn/bound/search?l=cmake)

You can’t perform that action at this time.