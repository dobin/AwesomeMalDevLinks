Title:
EV code signing with PFX in 2024 (bypassing USB token pickup workflow)

Type:
Blog Post

Short Summary (4–8 sentences max):
- This post documents the author’s attempt to obtain and use an EV Code Signing certificate for Windows driver signing, and the friction caused by mandatory hardware token (FIPS) “certificate pickup” workflows.  
- It covers vendor vetting, token shipping, and the practical failure modes of SafeNet/eToken tooling (including lockout and buggy “initialize token” behavior), leading the author to reverse the pickup process instead of relying on the token software.  
- The author intercepts and modifies legacy IE-compat certificate pickup pages/JavaScript with mitmproxy, inspects hidden form fields (CN, keyLength=4096, token), and attempts to submit a custom CSR.  
- After discovering constraints (e.g., RSA4096 requirement and YubiKey limitations for certain configurations), they generate a compliant CSR with OpenSSL, inject it into the pickup flow, and recover the server’s PKCS#7 response from process memory.  
- Finally, they convert the PKCS#7 output into a usable PFX and successfully sign a binary, demonstrating that the “token-required” flow can be worked around at the web/app layer.  
- Useful for red teamers, malware devs, and researchers interested in code-signing supply chain abuse, legacy enrollment flows, and practical reverse engineering of certificate issuance tooling.

Technical Focus:
- EV code signing & Windows driver signing prerequisites
- Legacy certificate enrollment/pickup flows (IE compatibility, form-based PKCS#10/PKCS#7)
- CSR generation and formats (PKCS#10, PKCS#7, PFX/PKCS#12)
- TLS interception and client-side JS tampering (mitmproxy/mitmdump)
- Hardware token ecosystems (SafeNet/eToken, FIPS 140-2 constraints, YubiKey PIV)
- Process memory inspection/debugging (CheatEngine, x64dbg)

Use Cases:
- Reproducing EV certificate pickup without vendor token middleware
- Auditing/assessing certificate issuance and enrollment workflow weaknesses
- Building automation around CSR submission and cert retrieval
- Researching code-signing abuse paths and operational bottlenecks for driver signing
- Troubleshooting token lockouts and broken vendor tooling during cert enrollment

Keywords:
EV code signing, Windows driver signing, Microsoft driver signing, GlobalSign, certificate pickup, hardware token, SafeNet Authentication Client, eToken, FIPS 140-2, YubiKey PIV, RSA4096, PKCS#10, CSR, PKCS#7, PFX, PKCS#12, OpenSSL, mitmproxy, mitmdump, JavaScript injection, IE compatibility mode, x64dbg, CheatEngine