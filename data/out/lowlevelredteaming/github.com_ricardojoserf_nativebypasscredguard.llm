Title:
NativeBypassCredGuard

Type:
GitHub Tool

Short Summary (4–8 sentences max):
- NativeBypassCredGuard is a Windows post-exploitation tool that bypasses Credential Guard by patching in-memory variables inside WDigest.dll in the LSASS process using only NTAPI calls from ntdll.dll.  
- It searches for a stable byte pattern in the on-disk WDigest.dll to locate code/offsets, then computes the corresponding addresses in LSASS and modifies two globals: `_g_fParameter_UseLogonCredential` (set to 1) and `_g_IsCredGuardEnabled` (set to 0).  
- This forces future logons to cache credentials in plaintext, so subsequent LSASS dumps may contain cleartext passwords.  
- The implementation emphasizes “native” syscalls/NTAPI usage and includes an optional ntdll remapping technique to evade user-mode hooks (by obtaining a clean ntdll from a suspended process).  
- It’s primarily useful for red teams and pentesters validating Credential Guard resilience and for defenders studying detection opportunities around LSASS/Wdigest tampering.

Technical Focus:
- Credential Guard bypass via WDigest credential caching re-enable
- LSASS process memory read/write and module base discovery
- NTAPI-only implementation (ntdll exports) and privilege adjustment (SeDebugPrivilege)
- Pattern scanning of PE/.text to derive offsets across Windows versions
- User-mode hook evasion via clean ntdll remapping/unhooking

Use Cases:
- Enable plaintext credential caching to support later credential extraction from LSASS dumps
- Research/demonstrate Credential Guard limitations and WDigest attack surface
- Develop detections for LSASS memory modification and WDigest variable tampering
- Compare NTAPI-only tradecraft vs Win32 API usage in EDR-monitored environments

Keywords:
Credential Guard, WDigest.dll, LSASS, plaintext credentials, NTAPI, ntdll.dll, SeDebugPrivilege, NtOpenProcessToken, NtAdjustPrivilegesToken, NtGetNextProcess, NtQueryInformationProcess, NtReadVirtualMemory, NtWriteProcessMemory, NtCreateFile, NtReadFile, PEB, module base address, pattern scanning, ntdll unhooking, suspended process, credential caching