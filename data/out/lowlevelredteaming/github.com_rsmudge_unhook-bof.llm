Title:
unhook-bof (Beacon Object File for Universal Unhooking)

Type:
GitHub Tool

Short Summary (4–8 sentences max):
- This repository provides a Cobalt Strike Beacon Object File (BOF) that “refreshes” loaded DLLs in the Beacon process to remove userland API hooks commonly placed by EDR/AV.  
- It is based on Cylance/BlackBerry’s “Universal Unhooking” technique, restoring hooked code sections by reloading/repairing module contents so inline patches and trampoline hooks are removed.  
- The repo includes an Aggressor script (`unhook.cna`) to load into Cobalt Strike and a Beacon command (`unhook`) to execute the unhooking routine in-process.  
- It targets operational issues where security products hook NTDLL/Win32 APIs to monitor or block post-exploitation actions, potentially improving stealth and reliability of subsequent tooling.  
- Useful primarily for red teams and penetration testers using Cobalt Strike, and also for defenders studying common unhooking tradecraft and how in-memory tampering is performed.

Technical Focus:
- Userland API unhooking / “DLL refreshing”
- In-process memory patching of loaded modules (text/code section restoration)
- EDR/AV inline hook and trampoline removal
- Cobalt Strike BOF + Aggressor Script integration
- Reflective loading / techniques derived from ReflectiveDLLInjection lineage

Use Cases:
- Remove EDR userland hooks from a running Beacon prior to sensitive actions (e.g., injection, credential access, syscall stubs usage)
- Increase stability of post-exploitation tooling that breaks under hooked APIs
- Research and reproduce “universal unhooking” behavior for detection engineering
- Build/modify BOF-based evasion modules for controlled assessments

Keywords:
Cobalt Strike, Beacon Object File, BOF, Aggressor Script, unhooking, Universal Unhooking, Cylance, BlackBerry research, EDR bypass, userland hooks, inline hooks, trampoline, NTDLL, Win32 API, DLL refresh, in-memory patching, reflective DLL injection, ReflectiveDLLRefresher, Meterpreter unhook extension