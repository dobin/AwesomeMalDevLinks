Title:
PhantomTask

Type:
GitHub Tool

Short Summary (4–8 sentences max):
PhantomTask is a Windows CLI utility written in Rust that creates and immediately executes Scheduled Tasks while targeting a specific Terminal Services (RDP/console) session. It solves the problem of reliably launching a process in a chosen user session (including elevated “run with highest privileges”) using the Task Scheduler COM API rather than ad-hoc service/process tricks. The tool includes session enumeration to map session IDs to users, and supports both interactive-token style execution and password-based credentials for task principals. Tasks are created hidden by default and are scheduled with a near-future trigger then manually run right after registration. It’s useful for red teams and pentesters for post-exploitation execution in the correct desktop/session context, and for defenders/researchers to understand and test Task Scheduler–based tradecraft and telemetry. Notable limitation: session 0 / SYSTEM handling is localization-dependent and requires code adjustment.

Technical Focus:
- Windows Task Scheduler COM interfaces (task definition, registration, run)
- Terminal Services / session enumeration and session-to-user resolution
- Task principal configuration (logon type, “run with highest privileges”)
- Hidden scheduled task creation and immediate triggering
- Rust Windows API bindings (`windows` crate), COM initialization (MTA)

Use Cases:
- Execute payloads/tools in a specific logged-on user’s session (RDP or console)
- Create hidden scheduled tasks for persistence or one-shot execution during ops
- Validate EDR/SIEM detections around task creation/registration/run events
- Automate session-aware tasking on multi-user Windows servers (jump boxes, RDS)

Keywords:
Windows Task Scheduler, COM, ITaskService, ITaskDefinition, RegisteredTask, TaskFolder, scheduled task, hidden task, run with highest privileges, session ID, Terminal Services, Remote Desktop Services, RDP, WTS APIs, session enumeration, SYSTEM session 0, Rust, windows crate, clap, post-exploitation execution, persistence