# https://hnsecurity.it/blog/customizing-sliver-part-3/

<!DOCTYPE html><html class="no-touch webkit chrome chrome142 linux js no-hidpi datauri lenis screen-lg screen-md screen-sm screen-xs screen-xxs orientation_portrait" lang="en-US" xmlns="http://www.w3.org/1999/xhtml">
<body class="wp-singular post-template-default single single-post postid-2548 single-format-standard wp-theme-uncode wp-child-theme-uncode-child style-color-wayh-bg cookies-not-set group-blog hormenu-position-left megamenu-full-submenu hmenu hmenu-position-center header-full-width main-center-align menu-mobile-transparent menu-custom-padding menu-sticky-mobile menu-mobile-centered menu-mobile-off-canvas mobile-parallax-not-allowed ilb-no-bounce unreg qw-body-scroll-disabled megamenu-side-to-side no-qty-fx uncode-accessible wpb-js-composer js-comp-ver-8.7.1.2 vc_responsive uncode-loaded" data-border="0" style="margin-top: 0px; padding-top: 0px;">

		<a href="https://hnsecurity.it/blog/customizing-sliver-part-3/#sections-container" class="screen-reader-shortcut btn btn-hover-nobg btn-accent btn-shadow btn-shadow-lg">Skip to main content</a>
			<div id="vh_layout_help"></div><div class="body-borders" data-border="0"><div class="top-border body-border-shadow"></div><div class="right-border body-border-shadow"></div><div class="bottom-border body-border-shadow"></div><div class="left-border body-border-shadow"></div><div class="top-border style-color-xsdn-bg"></div><div class="right-border style-color-xsdn-bg"></div><div class="bottom-border style-color-xsdn-bg"></div><div class="left-border style-color-xsdn-bg"></div></div>	<div class="box-wrapper">
		<div class="box-container" style="width: 1920px; margin-left: 0px;">
		
		<div class="menu-wrapper menu-sticky-mobile menu-no-arrows no-header" style="height: 957px;">
													
													
												</div>			
						<div class="main-wrapper">
				<div class="main-container">
					<div class="page-wrapper" role="main">
						<div class="sections-container" id="sections-container">
<article id="post-2548" class="page-body style-color-xsdn-bg post-2548 post type-post status-publish format-standard has-post-thumbnail hentry category-articles category-tools tag-golang tag-windows tag-c2 tag-red-teaming tag-sliver">
          <div class="post-wrapper">
          	<div class="post-body"><div class="post-content un-no-sidebar-layout"><div data-parent="true" class="vc_row has-bg need-focus style-color-wayh-bg row-container" id="row-unique-0"><div class="row-background background-element">
											<div class="background-wrapper">
												<div class="background-inner srcset-bg srcset-bg-async srcset-bg-init" style="background-repeat: no-repeat; background-position: center top; background-attachment: scroll; background-size: cover; background-image: url(&quot;https://hnsecurity.it/wp-content/uploads/2025/07/195503.jpg&quot;);" data-background-image="https://hnsecurity.it/wp-content/uploads/2025/07/195503.jpg" data-mobile-background-image="https://hnsecurity.it/wp-content/uploads/2025/07/195503-uai-900x507.jpg"></div>
												
											</div>
										</div><div class="row double-top-padding double-bottom-padding single-h-padding limit-width row-parent" data-imgready="true"><div class="wpb_row row-inner"><div class="wpb_column pos-middle pos-center align_center column_parent col-lg-12 single-internal-gutter"><div class="uncol style-light"><div class="uncoltable"><div class="uncell no-block-padding"><div class="uncont"><div class="uncode-single-media text-center animate_when_almost_visible zoom-in start_animation"><div class="single-wrapper" style="max-width: 200px;"><div class="tmb tmb-light  img-circle tmb-bordered tmb-shadowed tmb-shadowed-darker-std tmb-img-ratio tmb-media-first tmb-media-last tmb-content-overlay tmb-no-bg"><div class="t-inside"><div class="t-entry-visual"><div class="t-entry-visual-tc"><div class="uncode-single-media-wrapper img-circle img-thumbnail"><div class="dummy" style="padding-top: 100%;"></div><img decoding="async" class="srcset-auto wp-image-159957 srcset-sizes-done" src="https://hnsecurity.it/wp-content/uploads/2025/09/SILVER-uai-836x836.jpg" width="836" height="836" alt="Silver Framework logo" data-no-bp="" data-bp="720" data-uniqueid="159957-110013" data-guid="https://hnsecurity.it/wp-content/uploads/2025/09/SILVER.jpg" data-path="2025/09/SILVER.jpg" data-width="1600" data-height="836" data-singlew="200" data-singleh="200" data-crop="1" loading="lazy"></div>
					</div>
				</div></div></div></div></div><div class="vc_custom_heading_wrap "><div class="heading-text el-text"><h1 class="h2 text-color-lxmt-color"><span>Customizing Sliver – Part 3</span></h1></div><div class="clear"></div></div></div></div></div></div></div></div></div></div><div data-parent="true" class="vc_row row-container" id="row-unique-1"><div class="row limit-width row-parent" data-imgready="true"><div class="wpb_row row-inner"><div class="wpb_column pos-top pos-center align_left column_parent col-lg-6 single-internal-gutter"><div class="uncol style-light"><div class="uncoltable"><div class="uncell no-block-padding"><div class="uncont"><div class="uncode-info-box  font-weight-500"><span class="date-info">October 24, 2023</span><span class="uncode-ib-separator uncode-ib-separator-symbol">|</span><span class="author-wrap"><a href="https://hnsecurity.it/blog/author/ale98/"><span class="uncode-ib-avatar uncode-ib-avatar-size-md"><img alt="Alessandro Iandoli" src="https://secure.gravatar.com/avatar/644822f5d8329ca419a50c1f39c97de5ccd163d1932e4cdc60a6cc8cb64ed29e?s=40&amp;d=mm&amp;r=g" class="avatar avatar-40 photo" height="40" width="40" loading="lazy" decoding="async"></span></a><span class="author-info">By <a href="https://hnsecurity.it/blog/author/ale98/">Alessandro Iandoli</a></span></span></div></div></div></div></div></div><div class="wpb_column pos-top pos-center align_right align_left_tablet align_left_mobile column_parent col-lg-6 single-internal-gutter"><div class="uncol style-light"><div class="uncoltable"><div class="uncell no-block-padding"><div class="uncont"><div class="uncode-info-box container-text font-weight-500"><span class="category-info"> <a href="https://hnsecurity.it/blog/category/articles/" title="View all posts in Articles" class="">Articles</a>, <a href="https://hnsecurity.it/blog/category/tools/" title="View all posts in Tools" class="">Tools</a></span></div></div></div></div></div></div></div></div></div><div data-parent="true" class="vc_row has-bg need-focus style-color-xsdn-bg row-container" id="row-unique-2"><div class="row no-top-padding double-bottom-padding single-h-padding limit-width row-parent" data-imgready="true"><div class="wpb_row row-inner"><div class="wpb_column pos-top pos-center align_left column_parent col-lg-12 custom-tag-box single-internal-gutter"><div class="uncol style-light"><div class="uncoltable"><div class="uncell  vc_custom_1758437089857 no-block-padding" style="padding-top: 0px ;"><div class="uncont"><div class="uncode_text_column container-text"><p class="graf graf--p">In this third and final post in the <a href="https://hnsecurity.it/tag/sliver/">series</a> about <a href="https://github.com/BishopFox/sliver">Sliver C2</a> I’ll provide a tutorial for creating a simple command, named <em>helloworld</em>, that will take some parameters in input, send them to the implant, and then print back a string coming from the implant. You can find the <strong class="markup--strong markup--p-strong">full code</strong>&nbsp;implementing the <em>helloworld</em> command <a href="https://github.com/MrAle98/sliver/tree/hello_world">here</a> at the <strong class="markup--strong markup--p-strong">branch hello_world </strong>of my fork of Sliver.</p>
<h2 class="graf graf--h3">Creating the Hello World command</h2>
<p class="graf graf--p">The process for creating the command can be split in three phases:</p>
<ol class="postList">
<li class="graf graf--li">Define protobuf messages for server, client, and implant in sliver.proto/client.proto and the rpc functions inside services.proto.</li>
<li class="graf graf--li">Develop/debug the interaction betweeen client-side command and server handler.</li>
<li class="graf graf--li">Develop the implant handler and debug all the flow.</li>
</ol>
<h3 class="graf graf--h4">Defining protobuf messages</h3>
<p class="graf graf--p">First of all, we need to define the format of requests and responses that will be exchanged during client-server interaction and server-implant interaction, and the gRPC function for client-server communication.</p>
<p class="graf graf--p">Here are the definitions in sliver.proto and services.proto:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-generic enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">sliver.</span><span class="enlighter-m3">proto</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">...</span></div></div><div class=""><div><span class="enlighter-text">...</span></div></div><div class=""><div><span class="enlighter-text">message HelloWorldReq </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  string param1 = </span><span class="enlighter-n1">1</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">  uint32 param2 = </span><span class="enlighter-n1">2</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">  bool param3 = </span><span class="enlighter-n1">3</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">commonpb.</span><span class="enlighter-m3">Request</span><span class="enlighter-text"> Request = </span><span class="enlighter-n1">9</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">message HelloWorld </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  string output = </span><span class="enlighter-n1">1</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">  commonpb.</span><span class="enlighter-m3">Response</span><span class="enlighter-text"> Response = </span><span class="enlighter-n1">9</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">...</span></div></div><div class=""><div><span class="enlighter-text">...</span></div></div><div class=""><div><span class="enlighter-text">-------------------------------------------</span></div></div><div class=""><div><span class="enlighter-text">services.</span><span class="enlighter-m3">proto</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">...</span></div></div><div class=""><div><span class="enlighter-text">...</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-c0">// *** Hello World ***</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">rpc </span><span class="enlighter-m0">HelloWorld</span><span class="enlighter-g1">(</span><span class="enlighter-text">sliverpb.</span><span class="enlighter-m3">HelloWorldReq</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-m0">returns</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">sliverpb.</span><span class="enlighter-m3">HelloWorld</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div></div><div class="enlighter-raw">sliver.proto
...
...
message HelloWorldReq {
  string param1 = 1;
  uint32 param2 = 2;
  bool param3 = 3;
commonpb.Request Request = 9;
}
message HelloWorld {
  string output = 1;
  commonpb.Response Response = 9;
}
...
...
-------------------------------------------
services.proto
...
...
// *** Hello World ***
rpc HelloWorld(sliverpb.HelloWorldReq) returns (sliverpb.HelloWorld);</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">sliver.proto
...
...
message HelloWorldReq {
  string param1 = 1;
  uint32 param2 = 2;
  bool param3 = 3;
commonpb.Request Request = 9;
}
message HelloWorld {
  string output = 1;
  commonpb.Response Response = 9;
}
...
...
-------------------------------------------
services.proto
...
...
// *** Hello World ***
rpc HelloWorld(sliverpb.HelloWorldReq) returns (sliverpb.HelloWorld);</pre>
<p class="graf graf--p">The <strong class="markup--strong markup--p-strong">request is HelloWorldReq</strong> and contains a string, a uint32, and a boolean field. In addition, it embeds commonpb.Request as all the other request messages in the file.</p>
<p class="graf graf--p">The <strong class="markup--strong markup--p-strong">response is HelloWorld </strong>and contains just a string. In addition it embeds commonpb.Response as all the other response messages in the file.</p>
<p class="graf graf--p">You can give a look at the other messages in order to find more field types that you can embed in your messages.</p>
<p class="graf graf--p">Finally, in services.proto we defined the<strong class="markup--strong markup--p-strong"> gRPC function HelloWorld</strong> that takes as input a <strong class="markup--strong markup--p-strong">sliverpb.HelloWorldReq</strong> message and returns a <strong class="markup--strong markup--p-strong">sliverpb.HelloWorld</strong> message, the ones defined in sliverpb.proto.</p>
<p class="graf graf--p">Now, run the command <em>make pb</em> in a terminal under the sliver main folder:</p>
<div>
<div>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-shell enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">┌──(kali㉿kali)-[~/sliver]</span></div></div><div class=""><div><span class="enlighter-text">└─$ make pb</span></div></div><div class=""><div><span class="enlighter-text">protoc -I protobuf/ protobuf/commonpb/common.proto --go_out=paths=source_relative:protobuf/</span></div></div><div class=""><div><span class="enlighter-text">protoc -I protobuf/ protobuf/sliverpb/sliver.proto --go_out=paths=source_relative:protobuf/</span></div></div><div class=""><div><span class="enlighter-text">protoc -I protobuf/ protobuf/clientpb/client.proto --go_out=paths=source_relative:protobuf/</span></div></div><div class=""><div><span class="enlighter-text">protoc -I protobuf/ protobuf/dnspb/dns.proto --go_out=paths=source_relative:protobuf/</span></div></div><div class=""><div><span class="enlighter-text">protoc -I protobuf/ protobuf/rpcpb/services.proto --go_out=paths=source_relative:protobuf/ --go-grpc_out=protobuf/ --go-grpc_opt=paths=source_relative </span></div></div><div class=""><div><span class="enlighter-text">┌──(kali㉿kali)-[~/sliver]</span></div></div><div class=""><div><span class="enlighter-text">└─$</span></div></div></div><div class="enlighter-raw">┌──(kali㉿kali)-[~/sliver]
└─$ make pb
protoc -I protobuf/ protobuf/commonpb/common.proto --go_out=paths=source_relative:protobuf/
protoc -I protobuf/ protobuf/sliverpb/sliver.proto --go_out=paths=source_relative:protobuf/
protoc -I protobuf/ protobuf/clientpb/client.proto --go_out=paths=source_relative:protobuf/
protoc -I protobuf/ protobuf/dnspb/dns.proto --go_out=paths=source_relative:protobuf/
protoc -I protobuf/ protobuf/rpcpb/services.proto --go_out=paths=source_relative:protobuf/ --go-grpc_out=protobuf/ --go-grpc_opt=paths=source_relative 
┌──(kali㉿kali)-[~/sliver]
└─$</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="bash">┌──(kali㉿kali)-[~/sliver]
└─$&nbsp;make&nbsp;pb
protoc&nbsp;-I&nbsp;protobuf/&nbsp;protobuf/commonpb/common.proto&nbsp;--go_out=paths=source_relative:protobuf/
protoc&nbsp;-I&nbsp;protobuf/&nbsp;protobuf/sliverpb/sliver.proto&nbsp;--go_out=paths=source_relative:protobuf/
protoc&nbsp;-I&nbsp;protobuf/&nbsp;protobuf/clientpb/client.proto&nbsp;--go_out=paths=source_relative:protobuf/
protoc&nbsp;-I&nbsp;protobuf/&nbsp;protobuf/dnspb/dns.proto&nbsp;--go_out=paths=source_relative:protobuf/
protoc&nbsp;-I&nbsp;protobuf/&nbsp;protobuf/rpcpb/services.proto&nbsp;--go_out=paths=source_relative:protobuf/&nbsp;--go-grpc_out=protobuf/&nbsp;--go-grpc_opt=paths=source_relative&nbsp;
┌──(kali㉿kali)-[~/sliver]
└─$</pre>
<p>This is going to rebuild all the go files under the protobuf folder such as sliver.pb.go, client.pb.go, and so on. By now they contain the go struct and functions corresponding to messages and gRPC functions previously defined. You can browse to <strong class="markup--strong markup--p-strong">protobuf/sliver.pb.go </strong>in order to notice that now a <strong class="markup--strong markup--p-strong">HelloWorldReq struct</strong> is present with associated methods.</p>
</div>
</div>
<figure class="graf graf--figure">
<p></p><figure style="width: 1000px" class="wp-caption aligncenter"><img fetchpriority="high" decoding="async" class="graf-image" src="https://cdn-images-1.medium.com/max/1000/1*RQP1mCDOLQ1V6L29CMPQww.png" alt="" width="1000" height="502" data-image-id="1*RQP1mCDOLQ1V6L29CMPQww.png" data-width="1207" data-height="606"><figcaption class="wp-caption-text">The sliver.pb.go file containing HelloWorldReq</figcaption></figure></figure>
<h3 class="graf graf--h4">Developing the client-side command</h3>
<p class="graf graf--p">Here we are going to define a new HelloWorld command in the client component of the framework. First, we need to add the command definition in <a href="https://github.com/MrAle98/sliver/blob/hello_world/client/command/sliver.go">client/command/sliver.go</a>. Here’s the definition I’ve written:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-go enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-c0">// [ Hello World] ------------------------------------------</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  helloWorldCmd := &amp;cobra.</span><span class="enlighter-m3">Command</span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">   Use:   consts.</span><span class="enlighter-m3">HelloWorldStr</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">   Short: </span><span class="enlighter-s0">"Hello World command"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">   Long:  help.</span><span class="enlighter-m3">GetHelpFor</span><span class="enlighter-g1">([]</span><span class="enlighter-k5">string</span><span class="enlighter-g1">{</span><span class="enlighter-text">consts.</span><span class="enlighter-m3">HelloWorldStr</span><span class="enlighter-g1">})</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">   Args:  cobra.</span><span class="enlighter-m3">ExactArgs</span><span class="enlighter-g1">(</span><span class="enlighter-n1">1</span><span class="enlighter-g1">)</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">   Run: </span><span class="enlighter-k0">func</span><span class="enlighter-g1">(</span><span class="enlighter-text">cmd *cobra.</span><span class="enlighter-m3">Command</span><span class="enlighter-text">, args </span><span class="enlighter-g1">[]</span><span class="enlighter-k5">string</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    helloworld.</span><span class="enlighter-m3">HelloWorldCmd</span><span class="enlighter-g1">(</span><span class="enlighter-text">cmd, con, args</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">   </span><span class="enlighter-g1">}</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">   GroupID: consts.</span><span class="enlighter-m3">FilesystemHelpGroup</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  sliver.</span><span class="enlighter-m3">AddCommand</span><span class="enlighter-g1">(</span><span class="enlighter-text">helloWorldCmd</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-m0">Flags</span><span class="enlighter-g1">(</span><span class="enlighter-s0">""</span><span class="enlighter-text">, </span><span class="enlighter-e0">false</span><span class="enlighter-text">, helloWorldCmd, </span><span class="enlighter-k0">func</span><span class="enlighter-g1">(</span><span class="enlighter-text">f *pflag.</span><span class="enlighter-m3">FlagSet</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">   f.</span><span class="enlighter-m3">Uint32P</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"intflag"</span><span class="enlighter-text">, </span><span class="enlighter-s0">"i"</span><span class="enlighter-text">, </span><span class="enlighter-n1">0</span><span class="enlighter-text">, </span><span class="enlighter-s0">"parameter 2"</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">   f.</span><span class="enlighter-m3">BoolP</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"boolflag"</span><span class="enlighter-text">, </span><span class="enlighter-s0">"x"</span><span class="enlighter-text">, </span><span class="enlighter-e0">false</span><span class="enlighter-text">, </span><span class="enlighter-s0">"parameter 3"</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">   f.</span><span class="enlighter-m3">Int64P</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"timeout"</span><span class="enlighter-text">, </span><span class="enlighter-s0">"t"</span><span class="enlighter-text">, defaultTimeout, </span><span class="enlighter-s0">"grpc timeout in seconds"</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-g1">})</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  carapace.</span><span class="enlighter-m3">Gen</span><span class="enlighter-g1">(</span><span class="enlighter-text">helloWorldCmd</span><span class="enlighter-g1">)</span><span class="enlighter-text">.</span><span class="enlighter-m3">PositionalCompletion</span><span class="enlighter-g1">(</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">   carapace.</span><span class="enlighter-m3">ActionValues</span><span class="enlighter-g1">()</span><span class="enlighter-text">.</span><span class="enlighter-m3">Usage</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"parameter1"</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-g1">)</span></div></div></div><div class="enlighter-raw">// [ Hello World] ------------------------------------------
  helloWorldCmd := &amp;cobra.Command{
   Use:   consts.HelloWorldStr,
   Short: "Hello World command",
   Long:  help.GetHelpFor([]string{consts.HelloWorldStr}),
   Args:  cobra.ExactArgs(1),
   Run: func(cmd *cobra.Command, args []string) {
    helloworld.HelloWorldCmd(cmd, con, args)
   },
   GroupID: consts.FilesystemHelpGroup,
  }
  sliver.AddCommand(helloWorldCmd)
  Flags("", false, helloWorldCmd, func(f *pflag.FlagSet) {
   f.Uint32P("intflag", "i", 0, "parameter 2")
   f.BoolP("boolflag", "x", false, "parameter 3")
   f.Int64P("timeout", "t", defaultTimeout, "grpc timeout in seconds")
  })
  carapace.Gen(helloWorldCmd).PositionalCompletion(
   carapace.ActionValues().Usage("parameter1")
  )</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="golang">// [ Hello World] ------------------------------------------
  helloWorldCmd := &amp;cobra.Command{
   Use:   consts.HelloWorldStr,
   Short: "Hello World command",
   Long:  help.GetHelpFor([]string{consts.HelloWorldStr}),
   Args:  cobra.ExactArgs(1),
   Run: func(cmd *cobra.Command, args []string) {
    helloworld.HelloWorldCmd(cmd, con, args)
   },
   GroupID: consts.FilesystemHelpGroup,
  }
  sliver.AddCommand(helloWorldCmd)
  Flags("", false, helloWorldCmd, func(f *pflag.FlagSet) {
   f.Uint32P("intflag", "i", 0, "parameter 2")
   f.BoolP("boolflag", "x", false, "parameter 3")
   f.Int64P("timeout", "t", defaultTimeout, "grpc timeout in seconds")
  })
  carapace.Gen(helloWorldCmd).PositionalCompletion(
   carapace.ActionValues().Usage("parameter1")
  )</pre>
<p class="graf graf--p">First I created a cobra.Command struct having with the following fields:</p>
<ul class="postList">
<li class="graf graf--li">Use: set to <strong class="markup--strong markup--li-strong">consts.HelloWorldStr</strong>. This is a string I defined inside <strong class="markup--strong markup--li-strong">client/constants/constants.go </strong>in this way: <code class="markup--code markup--li-code">HelloWorldStr = "helloworld"</code></li>
<li class="graf graf--li">Short: another string</li>
<li class="graf graf--li">Long: the full description of the command. In <strong class="markup--strong markup--li-strong">client/help/long-help.go</strong> add the entry <code class="markup--code markup--li-code">consts.HelloWorldStr: helloWorldHelp</code>to the map <code class="markup--code markup--li-code">cmdHelp</code>, and add the string <code class="markup--code markup--li-code">helloWorldHelp</code> containing the full help for the command.</li>
<li class="graf graf--li">Run: contains a callback that calls <code class="markup--code markup--li-code">helloworld.HelloWorldCmd()</code> . This is the function that will actually send the request to the server and print the response. We will define it later.</li>
</ul>
<p class="graf graf--p">Then I added the command and I defined two flags for the command. A boolean flag <code class="markup--code markup--p-code">-X</code> and a timeout flag <code class="markup--code markup--p-code">-t</code> (timeout is present in all commands).</p>
<p class="graf graf--p">I’m not sure about what the last part involving the carapace library does, but I think that BishopFox added it quite recently to improve user experience. I just copy/pasted it from another command and then modified the relevant parts.</p>
<p class="graf graf--p">At the end, the <strong class="markup--strong markup--p-strong">helloworld </strong>command takes as input <strong class="markup--strong markup--p-strong">one positional parameter in the form of string</strong>, and<strong class="markup--strong markup--p-strong"> three flags</strong>:&nbsp;an <strong class="markup--strong markup--p-strong">integer</strong>, a <strong class="markup--strong markup--p-strong">boolean</strong>, and <strong>another integer</strong> indicating a timeout. The <strong class="markup--strong markup--p-strong">boolean and the integer will be embedded in the request</strong> sent to the server, just for showing how to pass data through flags to the server and eventually to the implant.</p>
<p class="graf graf--p">Now it is required to define the function helloworld.HelloWorldCmd(). In order to do this I’ll create a folder called <strong class="markup--strong markup--p-strong">helloworld </strong>under <strong class="markup--strong markup--p-strong">client/command</strong> and inside it, I will create a source file named <a href="https://github.com/MrAle98/sliver/blob/hello_world/client/command/helloworld/helloworld.go">helloworld.go</a> containing the definition of helloworld.HelloWorldCmd() and the package <strong class="markup--strong markup--p-strong">helloworld</strong>.</p>
<p class="graf graf--p">The contents of my <strong class="markup--strong markup--p-strong">helloworld.go</strong>&nbsp;are:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-go enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-k0">package</span><span class="enlighter-text"> helloworld</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">import</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> ...</span></div></div><div class=""><div><span class="enlighter-text">...</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">func</span><span class="enlighter-text"> </span><span class="enlighter-m0">HelloWorldCmd</span><span class="enlighter-g1">(</span><span class="enlighter-text">cmd *cobra.</span><span class="enlighter-m3">Command</span><span class="enlighter-text">, con *console.</span><span class="enlighter-m3">SliverConsoleClient</span><span class="enlighter-text">, args </span><span class="enlighter-g1">[]</span><span class="enlighter-k5">string</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">err error</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> session, beacon := con.</span><span class="enlighter-m3">ActiveTarget</span><span class="enlighter-text">.</span><span class="enlighter-m3">GetInteractive</span><span class="enlighter-g1">()</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-k1">if</span><span class="enlighter-text"> session == </span><span class="enlighter-e1">nil</span><span class="enlighter-text"> &amp;&amp; beacon == </span><span class="enlighter-e1">nil</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-k0">return</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-m0">len</span><span class="enlighter-g1">(</span><span class="enlighter-text">args</span><span class="enlighter-g1">)</span><span class="enlighter-text"> != </span><span class="enlighter-n1">1</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  con.</span><span class="enlighter-m3">PrintErrorf</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"Please specify an argument for param1.\n"</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-k0">return</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> param1 := args</span><span class="enlighter-g1">[</span><span class="enlighter-n1">0</span><span class="enlighter-g1">]</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> param2, _ := cmd.</span><span class="enlighter-m3">Flags</span><span class="enlighter-g1">()</span><span class="enlighter-text">.</span><span class="enlighter-m3">GetUint32</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"intflag"</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> param3, _ := cmd.</span><span class="enlighter-m3">Flags</span><span class="enlighter-g1">()</span><span class="enlighter-text">.</span><span class="enlighter-m3">GetBool</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"boolflag"</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> out, err := con.</span><span class="enlighter-m3">Rpc</span><span class="enlighter-text">.</span><span class="enlighter-m3">HelloWorld</span><span class="enlighter-g1">(</span><span class="enlighter-text">context.</span><span class="enlighter-m3">Background</span><span class="enlighter-g1">()</span><span class="enlighter-text">, &amp;sliverpb.</span><span class="enlighter-m3">HelloWorldReq</span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  Request: con.</span><span class="enlighter-m3">ActiveTarget</span><span class="enlighter-text">.</span><span class="enlighter-m3">Request</span><span class="enlighter-g1">(</span><span class="enlighter-text">cmd</span><span class="enlighter-g1">)</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  Param1:  param1,</span></div></div><div class=""><div><span class="enlighter-text">  Param2:  param2,</span></div></div><div class=""><div><span class="enlighter-text">  Param3:  param3,</span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-g1">})</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-k1">if</span><span class="enlighter-text"> err != </span><span class="enlighter-e1">nil</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  con.</span><span class="enlighter-m3">PrintErrorf</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"%s\n"</span><span class="enlighter-text">, err</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-k0">return</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-k1">if</span><span class="enlighter-text"> out.</span><span class="enlighter-m3">Response</span><span class="enlighter-text"> != </span><span class="enlighter-e1">nil</span><span class="enlighter-text"> &amp;&amp; out.</span><span class="enlighter-m3">Response</span><span class="enlighter-text">.</span><span class="enlighter-m3">Async</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  con.</span><span class="enlighter-m3">AddBeaconCallback</span><span class="enlighter-g1">(</span><span class="enlighter-text">out.</span><span class="enlighter-m3">Response</span><span class="enlighter-text">.</span><span class="enlighter-m3">TaskID</span><span class="enlighter-text">, </span><span class="enlighter-k0">func</span><span class="enlighter-g1">(</span><span class="enlighter-text">task *clientpb.</span><span class="enlighter-m3">BeaconTask</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">   err = proto.</span><span class="enlighter-m3">Unmarshal</span><span class="enlighter-g1">(</span><span class="enlighter-text">task.</span><span class="enlighter-m3">Response</span><span class="enlighter-text">, out</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">   </span><span class="enlighter-k1">if</span><span class="enlighter-text"> err != </span><span class="enlighter-e1">nil</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    con.</span><span class="enlighter-m3">PrintErrorf</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"Failed to decode response %s\n"</span><span class="enlighter-text">, err</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-k0">return</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">   </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">   </span><span class="enlighter-m0">PrintHelloWorld</span><span class="enlighter-g1">(</span><span class="enlighter-text">out,con</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-g1">})</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  con.</span><span class="enlighter-m3">PrintAsyncResponse</span><span class="enlighter-g1">(</span><span class="enlighter-text">out.</span><span class="enlighter-m3">Response</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span><span class="enlighter-k1">else</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-m0">PrintHelloWorld</span><span class="enlighter-g1">(</span><span class="enlighter-text">out, con</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-k0">return</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">func</span><span class="enlighter-text"> </span><span class="enlighter-m0">PrintHelloWorld</span><span class="enlighter-g1">(</span><span class="enlighter-text">hw *sliverpb.</span><span class="enlighter-m3">HelloWorld</span><span class="enlighter-text">, con *console.</span><span class="enlighter-m3">SliverConsoleClient</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-k1">if</span><span class="enlighter-text"> hw.</span><span class="enlighter-m3">Response</span><span class="enlighter-text"> != </span><span class="enlighter-e1">nil</span><span class="enlighter-text"> &amp;&amp; hw.</span><span class="enlighter-m3">Response</span><span class="enlighter-text">.</span><span class="enlighter-m3">Err</span><span class="enlighter-text"> != </span><span class="enlighter-s0">""</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  con.</span><span class="enlighter-m3">PrintErrorf</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"%s\n"</span><span class="enlighter-text">, hw.</span><span class="enlighter-m3">Response</span><span class="enlighter-text">.</span><span class="enlighter-m3">Err</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-k0">return</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> con.</span><span class="enlighter-m3">PrintInfof</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"Here the output coming from the implant: %s\n"</span><span class="enlighter-text">, hw.</span><span class="enlighter-m3">Output</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">package helloworld

import (
 ...
...
)
func HelloWorldCmd(cmd *cobra.Command, con *console.SliverConsoleClient, args []string) (err error) {
 session, beacon := con.ActiveTarget.GetInteractive()
 if session == nil &amp;&amp; beacon == nil {
  return
 }
 if len(args) != 1 {
  con.PrintErrorf("Please specify an argument for param1.\n")
  return
 }
 param1 := args[0]
 param2, _ := cmd.Flags().GetUint32("intflag")
 param3, _ := cmd.Flags().GetBool("boolflag")
 out, err := con.Rpc.HelloWorld(context.Background(), &amp;sliverpb.HelloWorldReq{
  Request: con.ActiveTarget.Request(cmd),
  Param1:  param1,
  Param2:  param2,
  Param3:  param3,
 })
 if err != nil {
  con.PrintErrorf("%s\n", err)
  return
 }
 if out.Response != nil &amp;&amp; out.Response.Async {
  con.AddBeaconCallback(out.Response.TaskID, func(task *clientpb.BeaconTask) {
   err = proto.Unmarshal(task.Response, out)
   if err != nil {
    con.PrintErrorf("Failed to decode response %s\n", err)
    return
   }
   PrintHelloWorld(out,con)
  })
  con.PrintAsyncResponse(out.Response)
 } else {
  PrintHelloWorld(out, con)
 }
 return
}
func PrintHelloWorld(hw *sliverpb.HelloWorld, con *console.SliverConsoleClient) {
 if hw.Response != nil &amp;&amp; hw.Response.Err != "" {
  con.PrintErrorf("%s\n", hw.Response.Err)
  return
 }
 con.PrintInfof("Here the output coming from the implant: %s\n", hw.Output)
}</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="golang">package helloworld

import (
 ...
...
)
func HelloWorldCmd(cmd *cobra.Command, con *console.SliverConsoleClient, args []string) (err error) {
 session, beacon := con.ActiveTarget.GetInteractive()
 if session == nil &amp;&amp; beacon == nil {
  return
 }
 if len(args) != 1 {
  con.PrintErrorf("Please specify an argument for param1.\n")
  return
 }
 param1 := args[0]
 param2, _ := cmd.Flags().GetUint32("intflag")
 param3, _ := cmd.Flags().GetBool("boolflag")
 out, err := con.Rpc.HelloWorld(context.Background(), &amp;sliverpb.HelloWorldReq{
  Request: con.ActiveTarget.Request(cmd),
  Param1:  param1,
  Param2:  param2,
  Param3:  param3,
 })
 if err != nil {
  con.PrintErrorf("%s\n", err)
  return
 }
 if out.Response != nil &amp;&amp; out.Response.Async {
  con.AddBeaconCallback(out.Response.TaskID, func(task *clientpb.BeaconTask) {
   err = proto.Unmarshal(task.Response, out)
   if err != nil {
    con.PrintErrorf("Failed to decode response %s\n", err)
    return
   }
   PrintHelloWorld(out,con)
  })
  con.PrintAsyncResponse(out.Response)
 } else {
  PrintHelloWorld(out, con)
 }
 return
}
func PrintHelloWorld(hw *sliverpb.HelloWorld, con *console.SliverConsoleClient) {
 if hw.Response != nil &amp;&amp; hw.Response.Err != "" {
  con.PrintErrorf("%s\n", hw.Response.Err)
  return
 }
 con.PrintInfof("Here the output coming from the implant: %s\n", hw.Output)
}</pre>
<p class="graf graf--p">In HelloWorldCmd I just take the 3 parameters: <strong class="markup--strong markup--p-strong">args[0]</strong> the string passed as positional parameter, the integer flag <strong class="markup--strong markup--p-strong">cmd.Flags().GetUint32(“intflag”)</strong>, and the boolean flag <strong class="markup--strong markup--p-strong">cmd.Flags().GetBool(“boolflag”)</strong>. Then I create the <strong class="markup--strong markup--p-strong">HelloWorldReq struct</strong>, populate its fields with the parameters and send the request to the server calling<strong class="markup--strong markup--p-strong"> con.Rpc.HelloWorld().</strong></p>
<p class="graf graf--p">Later there are some if statements checking if the request is for a beacon or for a session. In both cases we are going to execute <strong class="markup--strong markup--p-strong">PrintHelloWorld() </strong>to print the result coming from the server.</p>
<p class="graf graf--p">Finally, go back to <strong class="markup--strong markup--p-strong">sliver.go</strong> and add the import <strong class="markup--strong markup--p-strong">“github.com/bishopfox/sliver/client/command/helloworld”</strong>, in case VSCode doesn’t automatically adds it for you, after saving all files.</p>
<p class="graf graf--p">Now we will define the server-side handler for our HelloWorldReq request. We can create <a href="https://github.com/MrAle98/sliver/blob/hello_world/server/rpc/rpc-helloworld.go">server/rpc/rpc-helloworld.go</a> and define here the handler, in order to be coherent with the project structure.</p>
<p class="graf graf--p">The contents of my <strong>rpc-helloworld.go</strong> file are:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-go enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-k0">package</span><span class="enlighter-text"> rpc</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">import</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-s0">"context"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-s0">"github.com/bishopfox/sliver/protobuf/commonpb"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-s0">"github.com/bishopfox/sliver/protobuf/sliverpb"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-c0">// HelloWorld - HelloWorld command</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">func</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">rpc *Server</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-m0">HelloWorld</span><span class="enlighter-g1">(</span><span class="enlighter-text">ctx context.</span><span class="enlighter-m3">Context</span><span class="enlighter-text">, req *sliverpb.</span><span class="enlighter-m3">HelloWorldReq</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">*sliverpb.</span><span class="enlighter-m3">HelloWorld</span><span class="enlighter-text">, error</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> resp := &amp;sliverpb.</span><span class="enlighter-m3">HelloWorld</span><span class="enlighter-g1">{</span><span class="enlighter-text">Response: &amp;commonpb.</span><span class="enlighter-m3">Response</span><span class="enlighter-g1">{}}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> err := rpc.</span><span class="enlighter-m3">GenericHandler</span><span class="enlighter-g1">(</span><span class="enlighter-text">req, resp</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-k1">if</span><span class="enlighter-text"> err != </span><span class="enlighter-e1">nil</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-k0">return</span><span class="enlighter-text"> </span><span class="enlighter-e1">nil</span><span class="enlighter-text">, err</span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-k0">return</span><span class="enlighter-text"> resp, </span><span class="enlighter-e1">nil</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">package rpc

import (
 "context"
 "github.com/bishopfox/sliver/protobuf/commonpb"
 "github.com/bishopfox/sliver/protobuf/sliverpb"
)
// HelloWorld - HelloWorld command
func (rpc *Server) HelloWorld(ctx context.Context, req *sliverpb.HelloWorldReq) (*sliverpb.HelloWorld, error) {
 resp := &amp;sliverpb.HelloWorld{Response: &amp;commonpb.Response{}}
 err := rpc.GenericHandler(req, resp)
 if err != nil {
  return nil, err
 }
 return resp, nil
}</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="golang">package rpc

import (
 "context"
 "github.com/bishopfox/sliver/protobuf/commonpb"
 "github.com/bishopfox/sliver/protobuf/sliverpb"
)
// HelloWorld - HelloWorld command
func (rpc *Server) HelloWorld(ctx context.Context, req *sliverpb.HelloWorldReq) (*sliverpb.HelloWorld, error) {
 resp := &amp;sliverpb.HelloWorld{Response: &amp;commonpb.Response{}}
 err := rpc.GenericHandler(req, resp)
 if err != nil {
  return nil, err
 }
 return resp, nil
}</pre>
<p class="graf graf--p">The defined function falls under the rpc package. As defined in <strong class="markup--strong markup--p-strong">services.proto</strong>, <strong class="markup--strong markup--p-strong">HelloWorld() </strong>is our function handling the request server-side; it&nbsp;takes as input a struct of type <strong class="markup--strong markup--p-strong">sliverpb.HelloWorldReq</strong> and returns a struct of type <strong class="markup--strong markup--p-strong">sliverpb.HelloWorld</strong>. We defined the structs previously in sliverpb.proto.</p>
<p class="graf graf--p"><em class="markup--em markup--p-em">If you are unsure about what the signature of the function you have to define should be, I suggest you to take a simple rpc handler function, such as </em><strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">Ls(),</em></strong><em class="markup--em markup--p-em"> defined in </em><strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">rpc-filesystem</em></strong><em class="markup--em markup--p-em">, and modify it accordingly, by checking your definitions inside services.proto/sliver.proto.</em></p>
<p class="graf graf--p">The function simply creates a <strong class="markup--strong markup--p-strong">struct of type sliverpb.HelloWorld</strong>, stores it in the <strong class="markup--strong markup--p-strong">resp</strong> variable and then calls<strong class="markup--strong markup--p-strong"> rpc.GenericHandler()</strong> passing the initial request coming from the client and the resp variable. When rpc.GenericHandler() returns, we will find <strong class="markup--strong markup--p-strong">the response from the implant in the resp variable</strong>. Therefore, resp is returned to the caller with the <code class="markup--code markup--p-code">return resp, nil</code> statement, and finally sent to the client.</p>
<p class="graf graf--p">Let’s debug what we have done so far in order to check that the client successfully sends the request to the server.</p>
<h3 class="graf graf--h4">Debugging client-server interaction</h3>
<p class="graf graf--p">You must first launch both client and server in debug mode, inside VSCode, as shown in <a href="https://hnsecurity.it/blog/customizing-sliver-part-1/">part 1</a>, Setting up the Environment section.</p>
<p class="graf graf--p">Then just create an implant, move it to your Windows machine and run it.</p>
<p class="graf graf--p">When you receive the callback from the implant, interact with it and check that the helloworld command is available.</p>
<figure class="graf graf--figure">
<p></p><figure style="width: 1000px" class="wp-caption aligncenter"><img decoding="async" class="graf-image" src="https://cdn-images-1.medium.com/max/1000/1*nZXil29MTzXDgAgJSDTlmA.png" alt="" width="1000" height="171" data-image-id="1*nZXil29MTzXDgAgJSDTlmA.png" data-width="1199" data-height="205"><figcaption class="wp-caption-text">Running helloworld</figcaption></figure></figure>
<p class="graf graf--p">Now put a breakpoint on HelloWorldCmd() in the client and on HelloWorld() in the server. Then run your newly created helloworld command like this:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-generic enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> helloworld -i </span><span class="enlighter-n1">30</span><span class="enlighter-text"> -x firstparam</span></div></div></div><div class="enlighter-raw">&gt; helloworld -i 30 -x firstparam</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">&gt; helloworld -i 30 -x firstparam</pre>
<p class="graf graf--p">You should see the first breakpoint on HelloWorldCmd() got hit.</p>
<figure class="graf graf--figure">
<p></p><figure style="width: 1000px" class="wp-caption aligncenter"><img decoding="async" class="graf-image" src="https://cdn-images-1.medium.com/max/1000/1*o4OirgDRIX_0wUBiqumo0w.png" alt="" width="1000" height="531" data-image-id="1*o4OirgDRIX_0wUBiqumo0w.png" data-width="1588" data-height="843"><figcaption class="wp-caption-text">First breakpoint</figcaption></figure></figure>
<p class="graf graf--p">Stepping with the debugger you should reach the second breakpoint on the server.</p>
<figure class="graf graf--figure">
<p></p><figure style="width: 1000px" class="wp-caption aligncenter"><img decoding="async" class="graf-image" src="https://cdn-images-1.medium.com/max/1000/1*dRUiN9TPZcCWSuhZ_ZW2cA.png" alt="" width="1000" height="535" data-image-id="1*dRUiN9TPZcCWSuhZ_ZW2cA.png" data-width="1586" data-height="848"><figcaption class="wp-caption-text">Second breakpoint</figcaption></figure></figure>
<p class="graf graf--p">Notice, with the help of the right upper pane, that the <strong class="markup--strong markup--p-strong">req parameter contains param1, param2, and param3 </strong>with the <strong class="markup--strong markup--p-strong">values sent through the command line</strong>.</p>
<p class="graf graf--p">We managed to create a command that sends a request from the client to the server. In the the next phase we are going to let the server forward the request to the implant, and the implant will process the request and answer to the server.</p>
<h3 class="graf graf--h4">Developing the implant&nbsp;handler</h3>
<p class="graf graf--p">In this phase we will customize the implant, by defining a handler function that is in charge of handling the HelloWorldReq message coming from the server.</p>
<p class="graf graf--p">In order to do that, move to the folder containing the source code of one of your generated implants (recall from <a href="https://hnsecurity.it/blog/customizing-sliver-part-1/">part 1</a> that the folder is of type ~/.sliver/slivers/windows/amd64/&lt;IMPLANT_NAME&gt;/src) and add the .vscode folder as shown in <a href="https://hnsecurity.it/blog/customizing-sliver-part-1/">part 1</a>. Finally, open the folder in VSCode.</p>
<p class="graf graf--p">We are going to add our handler function in <a href="https://github.com/MrAle98/sliver/blob/hello_world/implant/sliver/handlers/handlers.go#L449">implant/sliver/handlers/handlers.go</a>. Since the HelloWorld task can be executed on any OS, we can place our handler in handlers.go. On the other hand, if the task can be executed for example only on Windows, the handler should be placed in handlers_windows.go. The same applies to Linux and macOS as already outlined in <a href="https://hnsecurity.it/blog/customizing-sliver-part-2/">part 2</a>.</p>
<p class="graf graf--p">The code for the handler function is:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-go enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-k0">func</span><span class="enlighter-text"> </span><span class="enlighter-m0">helloWorldHandler</span><span class="enlighter-g1">(</span><span class="enlighter-text">data </span><span class="enlighter-g1">[]</span><span class="enlighter-k5">byte</span><span class="enlighter-text">, resp RPCResponse</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> helloworldReq := &amp;sliverpb.</span><span class="enlighter-m3">HelloWorldReq</span><span class="enlighter-g1">{}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> err := proto.</span><span class="enlighter-m3">Unmarshal</span><span class="enlighter-g1">(</span><span class="enlighter-text">data, helloworldReq</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k1">if</span><span class="enlighter-text"> err != </span><span class="enlighter-e1">nil</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-c0">//</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  log.</span><span class="enlighter-m3">Printf</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"error decoding message: %v"</span><span class="enlighter-text">, err</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-c0">//</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-k0">return</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-c0">//</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> helloworldResp := &amp;sliverpb.</span><span class="enlighter-m3">HelloWorld</span><span class="enlighter-g1">{}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> p3 := </span><span class="enlighter-s0">""</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-k1">if</span><span class="enlighter-text"> helloworldReq.</span><span class="enlighter-m3">Param3</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  p3 = </span><span class="enlighter-s0">"FALSE"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span><span class="enlighter-k1">else</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  p3 = </span><span class="enlighter-s0">"TRUE"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> helloworldResp.</span><span class="enlighter-m3">Output</span><span class="enlighter-text"> = fmt.</span><span class="enlighter-m3">Sprintf</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"I'm your implant and i received the following:\nparam1: %s\nparam2: %d\nparam3: %s"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  helloworldReq.</span><span class="enlighter-m3">Param1</span><span class="enlighter-text">, helloworldReq.</span><span class="enlighter-m3">Param2</span><span class="enlighter-text">, p3</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-c0">//log.Printf("ping id = %d", ping.Nonce)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-c0">//</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> data, err = proto.</span><span class="enlighter-m3">Marshal</span><span class="enlighter-g1">(</span><span class="enlighter-text">helloworldResp</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-m0">resp</span><span class="enlighter-g1">(</span><span class="enlighter-text">data, err</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">func helloWorldHandler(data []byte, resp RPCResponse) {
 helloworldReq := &amp;sliverpb.HelloWorldReq{}
 err := proto.Unmarshal(data, helloworldReq)

if err != nil {
  //
  log.Printf("error decoding message: %v", err)
  //
  return
 }
 //
 helloworldResp := &amp;sliverpb.HelloWorld{}
 p3 := ""
 if helloworldReq.Param3 {
  p3 = "FALSE"
 } else {
  p3 = "TRUE"
 }
 helloworldResp.Output = fmt.Sprintf("I'm your implant and i received the following:\nparam1: %s\nparam2: %d\nparam3: %s",
  helloworldReq.Param1, helloworldReq.Param2, p3)
 //log.Printf("ping id = %d", ping.Nonce)
 //
 data, err = proto.Marshal(helloworldResp)
 resp(data, err)
}</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="golang">func helloWorldHandler(data []byte, resp RPCResponse) {
 helloworldReq := &amp;sliverpb.HelloWorldReq{}
 err := proto.Unmarshal(data, helloworldReq)

if err != nil {
  //
  log.Printf("error decoding message: %v", err)
  //
  return
 }
 //
 helloworldResp := &amp;sliverpb.HelloWorld{}
 p3 := ""
 if helloworldReq.Param3 {
  p3 = "FALSE"
 } else {
  p3 = "TRUE"
 }
 helloworldResp.Output = fmt.Sprintf("I'm your implant and i received the following:\nparam1: %s\nparam2: %d\nparam3: %s",
  helloworldReq.Param1, helloworldReq.Param2, p3)
 //log.Printf("ping id = %d", ping.Nonce)
 //
 data, err = proto.Marshal(helloworldResp)
 resp(data, err)
}</pre>
<p class="graf graf--p">The function simply <strong class="markup--strong markup--p-strong">unserializes the incoming data request in the sliverpb.HelloWorldReq struct</strong>, then <strong class="markup--strong markup--p-strong">creates the sliverpb.HelloWorld struct that will store the response</strong>.</p>
<p class="graf graf--p">In helloworldResp.Output I just store a string that shows the data received in the request. This will be printed on console client-side.</p>
<p class="graf graf--p">Finally, I <strong class="markup--strong markup--p-strong">serialize the response helloworldResp</strong> and <strong class="markup--strong markup--p-strong">invoke the callback resp()</strong> in order to send the response back to the C2 server.</p>
<p class="graf graf--p">Lastly, we need to <strong class="markup--strong markup--p-strong">add our handler to the list of handlers in a map</strong>. This is required so that the implant, during the main loop, will invoke our handler when required. Since this is a “generic” handler, meaning that the implant can get executed on any OS, we can add our handler to the map <strong class="markup--strong markup--p-strong">systemHandlers</strong>, where <strong class="markup--strong markup--p-strong"><a href="https://github.com/MrAle98/sliver/blob/hello_world/implant/sliver/handlers/handlers_windows.go#L52C1-L52C1">handlers_windows.go</a>, handler_linux.go, and handlers_darwin.go define systemHandlers</strong>.</p>
<p class="graf graf--p">So I’ll add the following entry to the handlers map in the three files already mentioned:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-generic enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">sliverpb.</span><span class="enlighter-m3">MsgHelloWorldReq</span><span class="enlighter-text">: helloWorldHandler,</span></div></div></div><div class="enlighter-raw">sliverpb.MsgHelloWorldReq: helloWorldHandler,</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">sliverpb.MsgHelloWorldReq: helloWorldHandler,</pre>
<p class="graf graf--p">As shown in the screenshot:</p>
<figure class="graf graf--figure">
<p></p><figure style="width: 1000px" class="wp-caption aligncenter"><img decoding="async" class="graf-image" src="https://cdn-images-1.medium.com/max/1000/1*ktF6YMDG9U8sv84fJG4h5Q.png" alt="" width="1000" height="582" data-image-id="1*ktF6YMDG9U8sv84fJG4h5Q.png" data-width="1355" data-height="788"><figcaption class="wp-caption-text">Adding handler to map</figcaption></figure></figure>
<p class="graf graf--p">Notice that we still have to define the uint32 <strong class="markup--strong markup--p-strong">sliverpb.MsgHelloWorldReq. </strong>This must be defined in <a href="https://github.com/MrAle98/sliver/blob/hello_world/protobuf/sliverpb/constants.go#L344">protobuf/sliverpb/constants.go</a>.</p>
<p class="graf graf--p"><em class="markup--em markup--p-em">You need to add the definition to </em><strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">both the constants.go file in the sliver main folder and the implant folder</em></strong><em class="markup--em markup--p-em">.</em></p>
<p class="graf graf--p">So here’s the updated <strong>constants.go</strong>:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-go enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-k0">package</span><span class="enlighter-text"> sliverpb</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">import</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-s0">"google.golang.org/protobuf/proto"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">...</span></div></div><div class=""><div><span class="enlighter-text">...</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k8">const</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-c0">// MsgRegister - Initial message from sliver with metadata</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> MsgRegister = </span><span class="enlighter-k5">uint32</span><span class="enlighter-g1">(</span><span class="enlighter-n1">1</span><span class="enlighter-text"> + </span><span class="enlighter-k9">iota</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-c0">// MsgTaskReq - A local shellcode injection task</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> MsgTaskReq</span></div></div><div class=""><div><span class="enlighter-text">...</span></div></div><div class=""><div><span class="enlighter-text">...</span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-c0">//MsgHelloWorldReq</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> MsgHelloWorldReq</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">...</span></div></div><div class=""><div><span class="enlighter-text">...</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-c0">// MsgNumber - Get a message number of type</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">func</span><span class="enlighter-text"> </span><span class="enlighter-m0">MsgNumber</span><span class="enlighter-g1">(</span><span class="enlighter-text">request proto.</span><span class="enlighter-m3">Message</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-k5">uint32</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-k1">switch</span><span class="enlighter-text"> request.</span><span class="enlighter-g1">(</span><span class="enlighter-k2">type</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-k1">case</span><span class="enlighter-text"> *Register:</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-k0">return</span><span class="enlighter-text"> MsgRegister</span></div></div><div class=""><div><span class="enlighter-text">...</span></div></div><div class=""><div><span class="enlighter-text">...</span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-k1">case</span><span class="enlighter-text"> *HelloWorldReq:</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-k0">return</span><span class="enlighter-text"> MsgHelloWorldReq</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-k0">return</span><span class="enlighter-text"> </span><span class="enlighter-k5">uint32</span><span class="enlighter-g1">(</span><span class="enlighter-n1">0</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">package sliverpb

import (
 "google.golang.org/protobuf/proto"
)
...
...
const (
 // MsgRegister - Initial message from sliver with metadata
 MsgRegister = uint32(1 + iota)
 // MsgTaskReq - A local shellcode injection task
 MsgTaskReq
...
...
 //MsgHelloWorldReq
 MsgHelloWorldReq
)
...
...
// MsgNumber - Get a message number of type
func MsgNumber(request proto.Message) uint32 {
 switch request.(type) {
 case *Register:
  return MsgRegister
...
...
 case *HelloWorldReq:
  return MsgHelloWorldReq
}
 return uint32(0)
}</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="golang">package sliverpb

import (
 "google.golang.org/protobuf/proto"
)
...
...
const (
 // MsgRegister - Initial message from sliver with metadata
 MsgRegister = uint32(1 + iota)
 // MsgTaskReq - A local shellcode injection task
 MsgTaskReq
...
...
 //MsgHelloWorldReq
 MsgHelloWorldReq
)
...
...
// MsgNumber - Get a message number of type
func MsgNumber(request proto.Message) uint32 {
 switch request.(type) {
 case *Register:
  return MsgRegister
...
...
 case *HelloWorldReq:
  return MsgHelloWorldReq
}
 return uint32(0)
}</pre>
<p class="graf graf--p">Basically I just added:</p>
<ul class="postList">
<li class="graf graf--li"><em class="markup--em markup--li-em">MsgHelloWorldReq</em> <strong class="markup--strong markup--li-strong">at the end </strong>of the first list of consts.</li>
<li class="graf graf--li">The <code class="markup--code markup--li-code">case *HelloWorldReq</code> to the switch statement at the bottom.</li>
</ul>
<p class="graf graf--p">Be careful to <strong>add the definition always </strong><strong class="markup--strong markup--p-strong">at the end</strong>. In fact, the developers specified in constants.go, in the comment at the top, that <strong class="markup--strong markup--p-strong">you can modify the constants by appending only</strong>.</p>
<h3 class="graf graf--h4">Rebuilding and debugging</h3>
<p class="graf graf--p">Now we have to rebuild our implant and start client, server, and implant in debug mode in order to check that everything works.</p>
<p class="graf graf--p">Let’s first rebuild our implant. In our main implant folder let’s move to src/github.com/bishopfox/sliver (the folder containing sliver.go, main.go, and so on), and rebuild our implant issuing the following commands:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-shell enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">┌──(kali㉿kali)-[~/.sliver/slivers/windows/amd64/RUNNING_WEAKNESS/src/github.com/bishopfox/sliver]</span></div></div><div class=""><div><span class="enlighter-text">└─$ export GOOS=windows</span></div></div><div class=""><div><span class="enlighter-text">┌──(kali㉿kali)-[~/.sliver/slivers/windows/amd64/RUNNING_WEAKNESS/src/github.com/bishopfox/sliver]</span></div></div><div class=""><div><span class="enlighter-text">└─$ /home/kali/.sliver/go/bin/go  build -trimpath -gcflags=all=-N  -o agent.exe .</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">┌──(kali㉿kali)-[~/.sliver/slivers/windows/amd64/RUNNING_WEAKNESS/src/github.com/bishopfox/sliver]</span></div></div><div class=""><div><span class="enlighter-text">└─$ ls</span></div></div><div class=""><div><span class="enlighter-text">agent.exe  go.mod  go.sum  implant  protobuf  sliver.go  vendor</span></div></div><div class=""><div><span class="enlighter-text">┌──(kali㉿kali)-[~/.sliver/slivers/windows/amd64/RUNNING_WEAKNESS/src/github.com/bishopfox/sliver]</span></div></div><div class=""><div><span class="enlighter-text">└─$</span></div></div></div><div class="enlighter-raw">┌──(kali㉿kali)-[~/.sliver/slivers/windows/amd64/RUNNING_WEAKNESS/src/github.com/bishopfox/sliver]
└─$ export GOOS=windows
┌──(kali㉿kali)-[~/.sliver/slivers/windows/amd64/RUNNING_WEAKNESS/src/github.com/bishopfox/sliver]
└─$ /home/kali/.sliver/go/bin/go  build -trimpath -gcflags=all=-N  -o agent.exe .

┌──(kali㉿kali)-[~/.sliver/slivers/windows/amd64/RUNNING_WEAKNESS/src/github.com/bishopfox/sliver]
└─$ ls
agent.exe  go.mod  go.sum  implant  protobuf  sliver.go  vendor
┌──(kali㉿kali)-[~/.sliver/slivers/windows/amd64/RUNNING_WEAKNESS/src/github.com/bishopfox/sliver]
└─$</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="bash">┌──(kali㉿kali)-[~/.sliver/slivers/windows/amd64/RUNNING_WEAKNESS/src/github.com/bishopfox/sliver]
└─$ export GOOS=windows
┌──(kali㉿kali)-[~/.sliver/slivers/windows/amd64/RUNNING_WEAKNESS/src/github.com/bishopfox/sliver]
└─$ /home/kali/.sliver/go/bin/go  build -trimpath -gcflags=all=-N  -o agent.exe .

┌──(kali㉿kali)-[~/.sliver/slivers/windows/amd64/RUNNING_WEAKNESS/src/github.com/bishopfox/sliver]
└─$ ls
agent.exe  go.mod  go.sum  implant  protobuf  sliver.go  vendor
┌──(kali㉿kali)-[~/.sliver/slivers/windows/amd64/RUNNING_WEAKNESS/src/github.com/bishopfox/sliver]
└─$</pre>
<p class="graf graf--p">First I set the environment variable GOOS to the target running environment for the implant, in this case “windows”. Then I build the implant. In this case the final executable is named <strong class="markup--strong markup--p-strong">agent.exe</strong>.</p>
<p class="graf graf--p">Now perform the following:</p>
<ol>
<li>in the VSCode window containing the sliver main folder, save all files and then restart server and client in debugging mode.</li>
<li>move the agent.exe to your Windows machine, then run agent.exe with <strong class="markup--strong markup--li-strong">dlv</strong> as shown during <a href="https://hnsecurity.it/blog/customizing-sliver-part-1/">part 1</a> (needed for debugging purposes).</li>
</ol>
<p class="graf graf--p">Now that you are running everything in debugging mode, let’s move to the VSCode window debugging the implant and let’s put a breakpoint at <strong class="markup--strong markup--p-strong">helloWorldHandler()</strong> in <strong class="markup--strong markup--p-strong">handlers.go.</strong></p>
<figure class="graf graf--figure">
<p></p><figure style="width: 1000px" class="wp-caption aligncenter"><img decoding="async" class="graf-image" src="https://cdn-images-1.medium.com/max/1000/1*Seh642GsSH1lXH6RD9dc2g.png" alt="" width="1000" height="353" data-image-id="1*Seh642GsSH1lXH6RD9dc2g.png" data-width="1088" data-height="384"><figcaption class="wp-caption-text">Breakpoint on helloWorldHandler</figcaption></figure></figure>
<p class="graf graf--p">Let’s put an additional breakpoint on the client in <strong class="markup--strong markup--p-strong">helloWorldCmd</strong> in <strong class="markup--strong markup--p-strong">helloworld.go</strong>, at the line of code after calling conRpc.HelloWorld(). So, when reaching this breakpoint, the <strong class="markup--strong markup--p-strong">out variable will contain the response from the implant</strong>.</p>
<figure class="graf graf--figure">
<p></p><figure style="width: 1000px" class="wp-caption aligncenter"><img decoding="async" class="graf-image" src="https://cdn-images-1.medium.com/max/1000/1*d7pqGbBpkRYc8Ckdfj40FQ.png" alt="" width="1000" height="401" data-image-id="1*d7pqGbBpkRYc8Ckdfj40FQ.png" data-width="1452" data-height="582"><figcaption class="wp-caption-text">Breakpoint in helloWorldCmd</figcaption></figure></figure>
<p class="graf graf--p">Now let’s move to the Sliver client console, select the agent session and run our newly created command this way:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-generic enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> Session 2b7aa1e7 RUNNING_WEAKNESS - </span><span class="enlighter-n0">192.168</span><span class="enlighter-text">.</span><span class="enlighter-m3">157</span><span class="enlighter-text">.</span><span class="enlighter-m3">131</span><span class="enlighter-text">:</span><span class="enlighter-m0">59650</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">DESKTOP-URP43TK</span><span class="enlighter-g1">)</span><span class="enlighter-text"> - windows/amd64 - Sun, </span><span class="enlighter-n1">10</span><span class="enlighter-text"> Sep </span><span class="enlighter-n1">2023</span><span class="enlighter-text"> </span><span class="enlighter-n1">22</span><span class="enlighter-text">:</span><span class="enlighter-n1">27</span><span class="enlighter-text">:</span><span class="enlighter-n1">26</span><span class="enlighter-text"> CEST</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-m0">sliver</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">RUNNING_WEAKNESS</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> use 2b7</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> Active session </span><span class="enlighter-m0">RUNNING_WEAKNESS</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">2b7aa1e7-1b67-</span><span class="enlighter-n1">4174</span><span class="enlighter-text">-a532-9ff9976a6df3</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-m0">sliver</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">RUNNING_WEAKNESS</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> helloworld -x -i </span><span class="enlighter-n1">30</span><span class="enlighter-text"> myparam -t </span><span class="enlighter-n1">4000</span></div></div></div><div class="enlighter-raw">[*] Session 2b7aa1e7 RUNNING_WEAKNESS - 192.168.157.131:59650 (DESKTOP-URP43TK) - windows/amd64 - Sun, 10 Sep 2023 22:27:26 CEST

sliver (RUNNING_WEAKNESS) &gt; use 2b7
[*] Active session RUNNING_WEAKNESS (2b7aa1e7-1b67-4174-a532-9ff9976a6df3)
sliver (RUNNING_WEAKNESS) &gt; helloworld -x -i 30 myparam -t 4000</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">[*] Session 2b7aa1e7 RUNNING_WEAKNESS - 192.168.157.131:59650 (DESKTOP-URP43TK) - windows/amd64 - Sun, 10 Sep 2023 22:27:26 CEST

sliver (RUNNING_WEAKNESS) &gt; use 2b7
[*] Active session RUNNING_WEAKNESS (2b7aa1e7-1b67-4174-a532-9ff9976a6df3)
sliver (RUNNING_WEAKNESS) &gt; helloworld -x -i 30 myparam -t 4000</pre>
<p class="graf graf--p">After running the command you should hit the breakpoint at <strong>helloWorldHandler()</strong>. If you step through the code you can see what happens step by step.</p>
<p class="graf graf--p">Now, if you resume the execution, you should hit the second breakpoint on the client. The execution will finally land in <strong class="markup--strong markup--p-strong">PrintHelloWorld() </strong>that prints the result coming from the implant, as you can see by looking at the Sliver client console.</p>
<figure class="graf graf--figure">
<p></p><figure style="width: 1000px" class="wp-caption aligncenter"><img decoding="async" class="graf-image" src="https://cdn-images-1.medium.com/max/1000/1*9rfGv8jp6BwfQUW3Ewf00Q.png" alt="" width="1000" height="492" data-image-id="1*9rfGv8jp6BwfQUW3Ewf00Q.png" data-width="1237" data-height="608"><figcaption class="wp-caption-text">Output coming from the implant</figcaption></figure></figure>
<p class="graf graf--p">So you can see the implant successfully took parameters passed through the command-line and inserted them in a string that was sent back to the client. The client finally printed the string on the console.</p>
<p class="graf graf--p">Now that you tested your code on the implant-side, and it works successfully, you just need to insert your code under the sliver main folder at <em class="markup--em markup--p-em">sliver/implant/sliver.</em></p>
<p class="graf graf--p">If you rebuild server and client with the <code class="markup--code markup--p-code">make</code> command, as outlined <a href="https://github.com/BishopFox/sliver/wiki/Compile-From-Source#compile-from-source-no-docker">here</a>, the server will generate implants that are able to process your helloworld command.</p>
<p class="graf graf--p">By now you should have an idea about how to add your own commands to Sliver C2!</p>
<h4 class="graf graf--h4">Exercise for the&nbsp;reader</h4>
<p class="graf graf--p">Many C2s implement what is called a <strong class="markup--strong markup--p-strong">token vault</strong>. You can think about it as an <strong class="markup--strong markup--p-strong">array of token handles</strong>, stored in the implant process, obtained by calling <a class="markup--anchor markup--p-anchor" href="https://learn.microsoft.com/it-it/windows/win32/api/securitybaseapi/nf-securitybaseapi-duplicatetokenex" target="_blank" rel="noopener" data-href="https://learn.microsoft.com/it-it/windows/win32/api/securitybaseapi/nf-securitybaseapi-duplicatetokenex">DuplicateTokenEx()</a> on tokens assigned to other processes.</p>
<p class="graf graf--p">I leave as an exercise to the reader the implementation of the following commands:</p>
<ul class="postList">
<li class="graf graf--li"><em class="markup--em markup--li-em">grab_token</em>: command that calls DuplicateTokenEx() on the process primary token and stores it in a map called <strong class="markup--strong markup--li-strong">tokenVaultMap.</strong></li>
<li class="graf graf--li"><em class="markup--em markup--li-em">list_token_vault</em>: command that lists tokens in the vault in the form of a map id - token owner.</li>
<li class="graf graf--li"><em class="markup--em markup--li-em">impersonate_token_vault</em>: command that impersonates a token in the vault given the id.</li>
<li class="graf graf--li"><em class="markup--em markup--li-em">remove_token_vault</em>: command that removes a token from the vault given the id.</li>
</ul>
<p class="graf graf--p">I encourage you to read the code defined under <a class="markup--anchor markup--p-anchor" href="https://github.com/BishopFox/sliver/tree/master/implant/sliver/priv" target="_blank" rel="noopener" data-href="https://github.com/BishopFox/sliver/tree/master/implant/sliver/priv">sliver/implant/sliver/priv</a> to understand token management in Sliver C2 implants. That’s all for now, thank you for reading!</p>
</div><div class="uncode_text_column mt-5"><span class="post-tags"><a class="custom-tag-box" href="https://hnsecurity.it/blog/tag/golang/">golang</a><a class="custom-tag-box" href="https://hnsecurity.it/blog/tag/windows/">windows</a><a class="custom-tag-box" href="https://hnsecurity.it/blog/tag/c2/">c2</a><a class="custom-tag-box" href="https://hnsecurity.it/blog/tag/red-teaming/">red teaming</a><a class="custom-tag-box" href="https://hnsecurity.it/blog/tag/sliver/">sliver</a></span>
</div></div></div></div></div></div></div></div></div><div data-parent="true" class="vc_row has-bg need-focus style-color-lxmt-bg row-container" id="row-unique-3"><div class="row double-top-padding double-bottom-padding single-h-padding full-width row-parent" data-imgready="true"><div class="wpb_row row-inner"><div class="wpb_column pos-top pos-center align_center column_parent col-lg-12 single-internal-gutter"><div class="uncol style-light"><div class="uncoltable"><div class="uncell no-block-padding"><div class="uncont"><div class="owl-carousel-wrapper">
													<div class="owl-carousel-container single-gutter test-init">												<div id="index-177493092" class="owl-carousel owl-element owl-height-equal owl-dots-outside owl-dots-single-block-padding owl-dots-align-center owl-loaded owl-drag showControls" data-dots="true" data-dotsmobile="true" data-navmobile="false" data-navspeed="400" data-autoplay="false" data-stagepadding="0" data-lg="5" data-md="3" data-sm="1" data-vp-height="false"><div class="owl-stage-outer"><div class="owl-stage" style="transform: translate3d(0px, 0px, 0px); transition: all; width: 3456px;"><div class="owl-item active index-active" data-index="1" style="width: 384px;"><div class="tmb tmb-carousel atc-typography-inherit tmb-iso-h33 tmb-round img-round-lg tmb-light tmb-text-showed tmb-overlay-anim tmb-content-left  grid-cat-88 grid-cat-91 tmb-id-161180 tmb-content-under tmb-media-first" style="transition-delay: 120ms; transition-duration: 320ms;"><div class="t-inside style-color-xsdn-bg no-anim srcset-lazy-animations start_animation" data-test="0 100"><div class="t-entry-visual"><div class="t-entry-visual-tc"><div class="t-entry-visual-cont"><div class="dummy" style="padding-top: 52.3%;"></div><a role="button" tabindex="-1" href="https://hnsecurity.it/blog/extending-burp-suite-for-fun-and-profit-the-montoya-way-part-9/?media_link=1" class="pushed" target="_self" data-lb-index="0"><div class="t-entry-visual-overlay"><div class="t-entry-visual-overlay-in style-color-wayh-bg" style="opacity: 0.5;"></div></div><img decoding="async" class="srcset-auto srcset-on-layout wp-image-159898 srcset-sizes-done" src="https://hnsecurity.it/wp-content/uploads/2025/09/BURP.jpg" width="1600" height="836" alt="" data-no-bp="" data-bp="720" data-uniqueid="159898-174066" data-guid="https://hnsecurity.it/wp-content/uploads/2025/09/BURP.jpg" data-path="2025/09/BURP.jpg" data-width="1600" data-height="836" data-singlew="2" data-singleh="33" data-crop="" loading="lazy"></a></div>
					</div>
				</div><div class="t-entry-text">
									<div class="t-entry-text-tc half-block-padding"><div class="t-entry"><p class="t-entry-meta"><span class="t-entry-category t-entry-category-88 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/tools/">Tools</a></span><span class="t-entry-category t-entry-category-91 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/articles/">Articles</a></span></p><p class="t-entry-meta"><span class="t-entry-date">December 10, 2025</span></p><h3 class="t-entry-title h5 title-scale "><a href="https://hnsecurity.it/blog/extending-burp-suite-for-fun-and-profit-the-montoya-way-part-9/" target="_self">Extending Burp Suite for fun and profit – The Montoya way – Part 9</a></h3><div class="t-entry-excerpt " style="transform: translateY(16.001px);"></div></div></div>
							</div></div></div></div><div class="owl-item active index-active" data-index="2" style="width: 384px;"><div class="tmb tmb-carousel atc-typography-inherit tmb-iso-h33 tmb-round img-round-lg tmb-light tmb-text-showed tmb-overlay-anim tmb-content-left  grid-cat-78 grid-cat-91 tmb-id-5100 tmb-content-under tmb-media-first" style="transition-delay: 120ms; transition-duration: 320ms;"><div class="t-inside style-color-xsdn-bg no-anim srcset-lazy-animations"><div class="t-entry-visual"><div class="t-entry-visual-tc"><div class="t-entry-visual-cont"><div class="dummy" style="padding-top: 52.3%;"></div><a role="button" tabindex="-1" href="https://hnsecurity.it/blog/groovy-template-engine-exploitation-part-2/?media_link=1" class="pushed" aria-label="Groovy logo" target="_self" data-lb-index="1"><div class="t-entry-visual-overlay"><div class="t-entry-visual-overlay-in style-color-wayh-bg" style="opacity: 0.5;"></div></div><img decoding="async" class="srcset-auto srcset-on-layout wp-image-159919 srcset-sizes-done" src="https://hnsecurity.it/wp-content/uploads/2025/09/GROOVY.jpg" width="1600" height="836" alt="Groovy logo" data-no-bp="" data-bp="720" data-uniqueid="159919-200119" data-guid="https://hnsecurity.it/wp-content/uploads/2025/09/GROOVY.jpg" data-path="2025/09/GROOVY.jpg" data-width="1600" data-height="836" data-singlew="2" data-singleh="33" data-crop="" loading="lazy"></a></div>
					</div>
				</div><div class="t-entry-text">
									<div class="t-entry-text-tc half-block-padding"><div class="t-entry"><p class="t-entry-meta"><span class="t-entry-category t-entry-category-78 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/exploits/">Exploits</a></span><span class="t-entry-category t-entry-category-91 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/articles/">Articles</a></span></p><p class="t-entry-meta"><span class="t-entry-date">November 11, 2025</span></p><h3 class="t-entry-title h5 title-scale "><a href="https://hnsecurity.it/blog/groovy-template-engine-exploitation-part-2/" target="_self">Groovy Template Engine Exploitation – Notes from a real case scenario, part 2</a></h3><div class="t-entry-excerpt " style="transform: translateY(16.001px);"></div></div></div>
							</div></div></div></div><div class="owl-item active index-active" data-index="3" style="width: 384px;"><div class="tmb tmb-carousel atc-typography-inherit tmb-iso-h33 tmb-round img-round-lg tmb-light tmb-text-showed tmb-overlay-anim tmb-content-left  grid-cat-88 grid-cat-91 tmb-id-161164 tmb-content-under tmb-media-first" style="transition-delay: 120ms; transition-duration: 320ms;"><div class="t-inside style-color-xsdn-bg no-anim srcset-lazy-animations"><div class="t-entry-visual"><div class="t-entry-visual-tc"><div class="t-entry-visual-cont"><div class="dummy" style="padding-top: 52.3%;"></div><a role="button" tabindex="-1" href="https://hnsecurity.it/blog/brida-0-6-released/?media_link=1" class="pushed" aria-label="Brida logo" target="_self" data-lb-index="2"><div class="t-entry-visual-overlay"><div class="t-entry-visual-overlay-in style-color-wayh-bg" style="opacity: 0.5;"></div></div><img decoding="async" class="srcset-auto srcset-on-layout wp-image-161178 srcset-sizes-done" src="https://hnsecurity.it/wp-content/uploads/2025/10/BRIDA_2.png" width="1600" height="836" alt="Brida logo" data-no-bp="" data-bp="720" data-uniqueid="161178-212375" data-guid="https://hnsecurity.it/wp-content/uploads/2025/10/BRIDA_2.png" data-path="2025/10/BRIDA_2.png" data-width="1600" data-height="836" data-singlew="2" data-singleh="33" data-crop="" loading="lazy"></a></div>
					</div>
				</div><div class="t-entry-text">
									<div class="t-entry-text-tc half-block-padding"><div class="t-entry"><p class="t-entry-meta"><span class="t-entry-category t-entry-category-88 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/tools/">Tools</a></span><span class="t-entry-category t-entry-category-91 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/articles/">Articles</a></span></p><p class="t-entry-meta"><span class="t-entry-date">October 28, 2025</span></p><h3 class="t-entry-title h5 title-scale "><a href="https://hnsecurity.it/blog/brida-0-6-released/" target="_self">Brida 0.6 released!</a></h3><div class="t-entry-excerpt " style="transform: translateY(16.0012px);"></div></div></div>
							</div></div></div></div><div class="owl-item active index-active" data-index="4" style="width: 384px;"><div class="tmb tmb-carousel atc-typography-inherit tmb-iso-h33 tmb-round img-round-lg tmb-light tmb-text-showed tmb-overlay-anim tmb-content-left  grid-cat-88 grid-cat-91 tmb-id-161068 tmb-content-under tmb-media-first" style="transition-delay: 120ms; transition-duration: 320ms;"><div class="t-inside style-color-xsdn-bg no-anim srcset-lazy-animations"><div class="t-entry-visual"><div class="t-entry-visual-tc"><div class="t-entry-visual-cont"><div class="dummy" style="padding-top: 52.3%;"></div><a role="button" tabindex="-1" href="https://hnsecurity.it/blog/streamlining-vulnerability-research-with-the-idalib-rust-bindings-for-ida-9-2/?media_link=1" class="pushed" aria-label="hex-rays logo" target="_self" data-lb-index="3"><div class="t-entry-visual-overlay"><div class="t-entry-visual-overlay-in style-color-wayh-bg" style="opacity: 0.5;"></div></div><img decoding="async" class="srcset-auto srcset-on-layout wp-image-161156 srcset-sizes-done" src="https://hnsecurity.it/wp-content/uploads/2025/10/HEX-RAYS_4.png" width="1600" height="836" alt="hex-rays logo" data-no-bp="" data-bp="720" data-uniqueid="161156-156687" data-guid="https://hnsecurity.it/wp-content/uploads/2025/10/HEX-RAYS_4.png" data-path="2025/10/HEX-RAYS_4.png" data-width="1600" data-height="836" data-singlew="2" data-singleh="33" data-crop="" loading="lazy"></a></div>
					</div>
				</div><div class="t-entry-text">
									<div class="t-entry-text-tc half-block-padding"><div class="t-entry"><p class="t-entry-meta"><span class="t-entry-category t-entry-category-88 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/tools/">Tools</a></span><span class="t-entry-category t-entry-category-91 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/articles/">Articles</a></span></p><p class="t-entry-meta"><span class="t-entry-date">October 14, 2025</span></p><h3 class="t-entry-title h5 title-scale "><a href="https://hnsecurity.it/blog/streamlining-vulnerability-research-with-the-idalib-rust-bindings-for-ida-9-2/" target="_self">Streamlining Vulnerability Research with the idalib Rust Bindings for IDA 9.2</a></h3><div class="t-entry-excerpt " style="transform: translateY(16.001px);"></div></div></div>
							</div></div></div></div><div class="owl-item active index-active" data-index="5" style="width: 384px;"><div class="tmb tmb-carousel atc-typography-inherit tmb-iso-h33 tmb-round img-round-lg tmb-light tmb-text-showed tmb-overlay-anim tmb-content-left  grid-cat-91 tmb-id-5879 tmb-content-under tmb-media-first" style="transition-delay: 120ms; transition-duration: 320ms;"><div class="t-inside style-color-xsdn-bg no-anim srcset-lazy-animations"><div class="t-entry-visual"><div class="t-entry-visual-tc"><div class="t-entry-visual-cont"><div class="dummy" style="padding-top: 52.3%;"></div><a role="button" tabindex="-1" href="https://hnsecurity.it/blog/attacking-genai-applications-and-llms-sometimes-all-it-takes-is-to-ask-nicely/?media_link=1" class="pushed" aria-label="LLM Icon" target="_self" data-lb-index="4"><div class="t-entry-visual-overlay"><div class="t-entry-visual-overlay-in style-color-wayh-bg" style="opacity: 0.5;"></div></div><img decoding="async" class="srcset-auto srcset-on-layout wp-image-159933 srcset-sizes-done" src="https://hnsecurity.it/wp-content/uploads/2025/09/LLM.jpg" width="1600" height="836" alt="LLM Icon" data-no-bp="" data-bp="720" data-uniqueid="159933-106219" data-guid="https://hnsecurity.it/wp-content/uploads/2025/09/LLM.jpg" data-path="2025/09/LLM.jpg" data-width="1600" data-height="836" data-singlew="2" data-singleh="33" data-crop="" loading="lazy"></a></div>
					</div>
				</div><div class="t-entry-text">
									<div class="t-entry-text-tc half-block-padding"><div class="t-entry"><p class="t-entry-meta"><span class="t-entry-category t-entry-category-91 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/articles/">Articles</a></span></p><p class="t-entry-meta"><span class="t-entry-date">July 29, 2025</span></p><h3 class="t-entry-title h5 title-scale "><a href="https://hnsecurity.it/blog/attacking-genai-applications-and-llms-sometimes-all-it-takes-is-to-ask-nicely/" target="_self">Attacking GenAI applications and LLMs – Sometimes all it takes is to ask nicely!</a></h3><div class="t-entry-excerpt " style="transform: translateY(16.001px);"></div></div></div>
							</div></div></div></div><div class="owl-item" data-index="6" style="width: 384px;"><div class="tmb tmb-carousel atc-typography-inherit tmb-iso-h33 tmb-round img-round-lg tmb-light tmb-text-showed tmb-overlay-anim tmb-content-left  grid-cat-91 tmb-id-5842 tmb-content-under tmb-media-first" style="transition-delay: 120ms; transition-duration: 320ms;"><div class="t-inside style-color-xsdn-bg no-anim srcset-lazy-animations"><div class="t-entry-visual"><div class="t-entry-visual-tc"><div class="t-entry-visual-cont"><div class="dummy" style="padding-top: 52.3%;"></div><a role="button" tabindex="-1" href="https://hnsecurity.it/blog/fault-injection-follow-the-white-rabbit/?media_link=1" class="pushed" target="_self" data-lb-index="5"><div class="t-entry-visual-overlay"><div class="t-entry-visual-overlay-in style-color-wayh-bg" style="opacity: 0.5;"></div></div><img decoding="async" class="srcset-auto srcset-on-layout wp-image-159901 srcset-sizes-done" src="https://hnsecurity.it/wp-content/uploads/2025/09/CIRCUITI.jpg" width="1600" height="836" alt="" data-no-bp="" data-bp="720" data-uniqueid="159901-160255" data-guid="https://hnsecurity.it/wp-content/uploads/2025/09/CIRCUITI.jpg" data-path="2025/09/CIRCUITI.jpg" data-width="1600" data-height="836" data-singlew="2" data-singleh="33" data-crop="" loading="lazy"></a></div>
					</div>
				</div><div class="t-entry-text">
									<div class="t-entry-text-tc half-block-padding"><div class="t-entry"><p class="t-entry-meta"><span class="t-entry-category t-entry-category-91 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/articles/">Articles</a></span></p><p class="t-entry-meta"><span class="t-entry-date">June 18, 2025</span></p><h3 class="t-entry-title h5 title-scale "><a href="https://hnsecurity.it/blog/fault-injection-follow-the-white-rabbit/" target="_self">Fault Injection – Follow the White Rabbit</a></h3><div class="t-entry-excerpt " style="transform: translateY(16.0012px);"></div></div></div>
							</div></div></div></div><div class="owl-item" data-index="7" style="width: 384px;"><div class="tmb tmb-carousel atc-typography-inherit tmb-iso-h33 tmb-round img-round-lg tmb-light tmb-text-showed tmb-overlay-anim tmb-content-left  grid-cat-76 grid-cat-81 grid-cat-91 tmb-id-5512 tmb-content-under tmb-media-first" style="transition-delay: 120ms; transition-duration: 320ms;"><div class="t-inside style-color-xsdn-bg no-anim srcset-lazy-animations"><div class="t-entry-visual"><div class="t-entry-visual-tc"><div class="t-entry-visual-cont"><div class="dummy" style="padding-top: 52.3%;"></div><a role="button" tabindex="-1" href="https://hnsecurity.it/blog/my-zero-day-quest-bluehat-podcast/?media_link=1" class="pushed" aria-label="ZeroDay logo" target="_self" data-lb-index="6"><div class="t-entry-visual-overlay"><div class="t-entry-visual-overlay-in style-color-wayh-bg" style="opacity: 0.5;"></div></div><img decoding="async" class="srcset-auto srcset-on-layout wp-image-159967 srcset-sizes-done" src="https://hnsecurity.it/wp-content/uploads/2025/09/ZERODAY.jpg" width="1600" height="836" alt="ZeroDay logo" data-no-bp="" data-bp="720" data-uniqueid="159967-425755" data-guid="https://hnsecurity.it/wp-content/uploads/2025/09/ZERODAY.jpg" data-path="2025/09/ZERODAY.jpg" data-width="1600" data-height="836" data-singlew="2" data-singleh="33" data-crop="" loading="lazy"></a></div>
					</div>
				</div><div class="t-entry-text">
									<div class="t-entry-text-tc half-block-padding"><div class="t-entry"><p class="t-entry-meta"><span class="t-entry-category t-entry-category-76 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/events/">Events</a></span><span class="t-entry-category t-entry-category-81 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/vulnerabilities/">Vulnerabilities</a></span><span class="t-entry-category t-entry-category-91 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/articles/">Articles</a></span></p><p class="t-entry-meta"><span class="t-entry-date">May 6, 2025</span></p><h3 class="t-entry-title h5 title-scale "><a href="https://hnsecurity.it/blog/my-zero-day-quest-bluehat-podcast/" target="_self">My Zero Day Quest &amp; BlueHat Podcast</a></h3><div class="t-entry-excerpt " style="transform: translateY(16.0012px);"></div></div></div>
							</div></div></div></div><div class="owl-item" data-index="8" style="width: 384px;"><div class="tmb tmb-carousel atc-typography-inherit tmb-iso-h33 tmb-round img-round-lg tmb-light tmb-text-showed tmb-overlay-anim tmb-content-left  grid-cat-88 grid-cat-91 tmb-id-5276 tmb-content-under tmb-media-first" style="transition-delay: 120ms; transition-duration: 320ms;"><div class="t-inside style-color-xsdn-bg no-anim srcset-lazy-animations"><div class="t-entry-visual"><div class="t-entry-visual-tc"><div class="t-entry-visual-cont"><div class="dummy" style="padding-top: 52.3%;"></div><a role="button" tabindex="-1" href="https://hnsecurity.it/blog/aiding-reverse-engineering-with-rust-and-a-local-llm/?media_link=1" class="pushed" aria-label="Rust logo" target="_self" data-lb-index="7"><div class="t-entry-visual-overlay"><div class="t-entry-visual-overlay-in style-color-wayh-bg" style="opacity: 0.5;"></div></div><img decoding="async" class="srcset-auto srcset-on-layout wp-image-159953 srcset-sizes-done" src="https://hnsecurity.it/wp-content/uploads/2025/09/RUST.jpg" width="1600" height="836" alt="Rust logo" data-no-bp="" data-bp="720" data-uniqueid="159953-125434" data-guid="https://hnsecurity.it/wp-content/uploads/2025/09/RUST.jpg" data-path="2025/09/RUST.jpg" data-width="1600" data-height="836" data-singlew="2" data-singleh="33" data-crop="" loading="lazy"></a></div>
					</div>
				</div><div class="t-entry-text">
									<div class="t-entry-text-tc half-block-padding"><div class="t-entry"><p class="t-entry-meta"><span class="t-entry-category t-entry-category-88 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/tools/">Tools</a></span><span class="t-entry-category t-entry-category-91 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/articles/">Articles</a></span></p><p class="t-entry-meta"><span class="t-entry-date">April 15, 2025</span></p><h3 class="t-entry-title h5 title-scale "><a href="https://hnsecurity.it/blog/aiding-reverse-engineering-with-rust-and-a-local-llm/" target="_self">Aiding reverse engineering with Rust and a local LLM</a></h3><div class="t-entry-excerpt " style="transform: translateY(16.001px);"></div></div></div>
							</div></div></div></div><div class="owl-item" data-index="9" style="width: 384px;"><div class="tmb tmb-carousel atc-typography-inherit tmb-iso-h33 tmb-round img-round-lg tmb-light tmb-text-showed tmb-overlay-anim tmb-content-left  grid-cat-91 grid-cat-88 tmb-id-4418 tmb-content-under tmb-media-first" style="transition-delay: 120ms; transition-duration: 320ms;"><div class="t-inside style-color-xsdn-bg no-anim srcset-lazy-animations"><div class="t-entry-visual"><div class="t-entry-visual-tc"><div class="t-entry-visual-cont"><div class="dummy" style="padding-top: 52.3%;"></div><a role="button" tabindex="-1" href="https://hnsecurity.it/blog/streamlining-vulnerability-research-with-ida-pro-and-rust/?media_link=1" class="pushed" aria-label="Rust logo" target="_self" data-lb-index="8"><div class="t-entry-visual-overlay"><div class="t-entry-visual-overlay-in style-color-wayh-bg" style="opacity: 0.5;"></div></div><img decoding="async" class="srcset-auto srcset-on-layout wp-image-159953 srcset-sizes-done" src="https://hnsecurity.it/wp-content/uploads/2025/09/RUST.jpg" width="1600" height="836" alt="Rust logo" data-no-bp="" data-bp="720" data-uniqueid="159953-786936" data-guid="https://hnsecurity.it/wp-content/uploads/2025/09/RUST.jpg" data-path="2025/09/RUST.jpg" data-width="1600" data-height="836" data-singlew="2" data-singleh="33" data-crop="" loading="lazy"></a></div>
					</div>
				</div><div class="t-entry-text">
									<div class="t-entry-text-tc half-block-padding"><div class="t-entry"><p class="t-entry-meta"><span class="t-entry-category t-entry-category-91 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/articles/">Articles</a></span><span class="t-entry-category t-entry-category-88 t-entry-tax"><a class="bordered-cat tmb-term-evidence font-ui" href="https://hnsecurity.it/blog/category/tools/">Tools</a></span></p><p class="t-entry-meta"><span class="t-entry-date">February 25, 2025</span></p><h3 class="t-entry-title h5 title-scale "><a href="https://hnsecurity.it/blog/streamlining-vulnerability-research-with-ida-pro-and-rust/" target="_self">Streamlining vulnerability research with IDA Pro and Rust</a></h3><div class="t-entry-excerpt " style="transform: translateY(16.001px);"></div></div></div>
							</div></div></div></div></div></div>					<div class="owl-nav disabled"><button type="button" aria-label="Previous" class="owl-prev style-light style-override" style="margin-left: -16px;"><div class="owl-nav-container btn-default btn-hover-nobg" tabindex="0"><i class="fa fa-fw fa-angle-left"></i></div></button><button type="button" aria-label="Next" class="owl-next style-light style-override" style="margin-right: -16px;"><div class="owl-nav-container btn-default btn-hover-nobg" aria-label="Next" tabindex="0"><i class="fa fa-fw fa-angle-right"></i></div></button></div><div class="owl-dots uncode_index-dot_classes limit-width owl-dots-classes"><button class="owl-dot active" aria-label="Slide 1"><span></span></button><button class="owl-dot" aria-label="Slide 2"><span></span></button></div></div>	
	

	</div>				</div>
</div></div></div></div></div></div></div></div></div><div class="post-footer post-footer-light row-container"><div class="row-container">
		  					<div class="row row-parent style-light no-top-padding double-bottom-padding" style="max-width: 804px; margin: auto;">
									<div class="post-share">
	          						<div class="detail-container margin-auto">
													<div class="share-button share-buttons share-inline only-icon sharer-0" style="display: block;"><label class="social-export"><span></span></label></div>
												</div>
											</div>
								</div>
							</div></div></div>
          </div>
        </article>								</div><!-- sections container -->
							</div><!-- page wrapper -->
												
												<div class="overlay-menu-focus style-dark-bg "></div>					</div><!-- main container -->
				</div><!-- main wrapper -->
							</div><!-- box container -->
					</div><!-- box wrapper -->
		<div class="style-light footer-scroll-top footer-scroll-higher"><a href="https://hnsecurity.it/blog/customizing-sliver-part-3/#" class="scroll-top" aria-label="Scroll to top"><i class="fa fa-angle-up fa-stack btn-default btn-hover-nobg"></i></a></div>
	

































		
		
	
		<!-- Cookie Notice plugin v2.5.12 by Hu-manity.co https://hu-manity.co/ -->
		<div id="cookie-notice" role="dialog" class="cookie-notice-hidden cookie-revoke-hidden cn-position-bottom" aria-label="Cookie Notice" style="background-color: rgba(255,255,255,1);"><div class="cookie-notice-container" style="color: #2d2d2d"><span id="cn-notice-text" class="cn-text-container">We use cookies to improve your browsing experience and analyze our traffic. By clicking "Accept all", you consent to the use of cookies.</span><span id="cn-notice-buttons" class="cn-buttons-container"><button id="cn-accept-cookie" data-cookie-set="accept" class="cn-set-cookie cn-button cn-button-custom custom-link btn btn-cookiebanner border-width-0 btn-accent btn-circle" aria-label="Accept All">Accept All</button><button data-link-url="https://hnsecurity.it/privacy-policy/" data-link-target="_blank" id="cn-more-info" class="cn-more-info cn-button cn-button-custom custom-link btn btn-cookiebanner border-width-0 btn-accent btn-circle" aria-label="Privacy policy">Privacy policy</button></span><button type="button" id="cn-close-notice" data-cookie-set="accept" class="cn-close-icon" aria-label="Reject All"></button></div>
			
		</div>
		<!-- / Cookie Notice plugin -->

</body></html>